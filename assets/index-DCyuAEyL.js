(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const b of c)if(b.type==="childList")for(const S of b.addedNodes)S.tagName==="LINK"&&S.rel==="modulepreload"&&o(S)}).observe(document,{childList:!0,subtree:!0});function a(c){const b={};return c.integrity&&(b.integrity=c.integrity),c.referrerPolicy&&(b.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?b.credentials="include":c.crossOrigin==="anonymous"?b.credentials="omit":b.credentials="same-origin",b}function o(c){if(c.ep)return;c.ep=!0;const b=a(c);fetch(c.href,b)}})();var j1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function fa(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var BS={exports:{}},$v={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mk;function bG(){if(mk)return $v;mk=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function a(o,c,b){var S=null;if(b!==void 0&&(S=""+b),c.key!==void 0&&(S=""+c.key),"key"in c){b={};for(var i in c)i!=="key"&&(b[i]=c[i])}else b=c;return c=b.ref,{$$typeof:e,type:o,key:S,ref:c!==void 0?c:null,props:b}}return $v.Fragment=t,$v.jsx=a,$v.jsxs=a,$v}var gk;function wG(){return gk||(gk=1,BS.exports=bG()),BS.exports}var nn=wG(),FS={exports:{}},li={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yk;function SG(){if(yk)return li;yk=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),b=Symbol.for("react.consumer"),S=Symbol.for("react.context"),i=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),L=Symbol.for("react.memo"),U=Symbol.for("react.lazy"),V=Symbol.iterator;function H(Ze){return Ze===null||typeof Ze!="object"?null:(Ze=V&&Ze[V]||Ze["@@iterator"],typeof Ze=="function"?Ze:null)}var ee={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ie=Object.assign,le={};function ue(Ze,Xt,an){this.props=Ze,this.context=Xt,this.refs=le,this.updater=an||ee}ue.prototype.isReactComponent={},ue.prototype.setState=function(Ze,Xt){if(typeof Ze!="object"&&typeof Ze!="function"&&Ze!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Ze,Xt,"setState")},ue.prototype.forceUpdate=function(Ze){this.updater.enqueueForceUpdate(this,Ze,"forceUpdate")};function ge(){}ge.prototype=ue.prototype;function Se(Ze,Xt,an){this.props=Ze,this.context=Xt,this.refs=le,this.updater=an||ee}var ve=Se.prototype=new ge;ve.constructor=Se,ie(ve,ue.prototype),ve.isPureReactComponent=!0;var Ee=Array.isArray,me={H:null,A:null,T:null,S:null},Ae=Object.prototype.hasOwnProperty;function Oe(Ze,Xt,an,qt,cn,rr){return an=rr.ref,{$$typeof:e,type:Ze,key:Xt,ref:an!==void 0?an:null,props:rr}}function Ye(Ze,Xt){return Oe(Ze.type,Xt,void 0,void 0,void 0,Ze.props)}function He(Ze){return typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===e}function st(Ze){var Xt={"=":"=0",":":"=2"};return"$"+Ze.replace(/[=:]/g,function(an){return Xt[an]})}var Ke=/\/+/g;function Ot(Ze,Xt){return typeof Ze=="object"&&Ze!==null&&Ze.key!=null?st(""+Ze.key):Xt.toString(36)}function Bt(){}function Tt(Ze){switch(Ze.status){case"fulfilled":return Ze.value;case"rejected":throw Ze.reason;default:switch(typeof Ze.status=="string"?Ze.then(Bt,Bt):(Ze.status="pending",Ze.then(function(Xt){Ze.status==="pending"&&(Ze.status="fulfilled",Ze.value=Xt)},function(Xt){Ze.status==="pending"&&(Ze.status="rejected",Ze.reason=Xt)})),Ze.status){case"fulfilled":return Ze.value;case"rejected":throw Ze.reason}}throw Ze}function mt(Ze,Xt,an,qt,cn){var rr=typeof Ze;(rr==="undefined"||rr==="boolean")&&(Ze=null);var mr=!1;if(Ze===null)mr=!0;else switch(rr){case"bigint":case"string":case"number":mr=!0;break;case"object":switch(Ze.$$typeof){case e:case t:mr=!0;break;case U:return mr=Ze._init,mt(mr(Ze._payload),Xt,an,qt,cn)}}if(mr)return cn=cn(Ze),mr=qt===""?"."+Ot(Ze,0):qt,Ee(cn)?(an="",mr!=null&&(an=mr.replace(Ke,"$&/")+"/"),mt(cn,Xt,an,"",function(Ln){return Ln})):cn!=null&&(He(cn)&&(cn=Ye(cn,an+(cn.key==null||Ze&&Ze.key===cn.key?"":(""+cn.key).replace(Ke,"$&/")+"/")+mr)),Xt.push(cn)),1;mr=0;var Ci=qt===""?".":qt+":";if(Ee(Ze))for(var Et=0;Et<Ze.length;Et++)qt=Ze[Et],rr=Ci+Ot(qt,Et),mr+=mt(qt,Xt,an,rr,cn);else if(Et=H(Ze),typeof Et=="function")for(Ze=Et.call(Ze),Et=0;!(qt=Ze.next()).done;)qt=qt.value,rr=Ci+Ot(qt,Et++),mr+=mt(qt,Xt,an,rr,cn);else if(rr==="object"){if(typeof Ze.then=="function")return mt(Tt(Ze),Xt,an,qt,cn);throw Xt=String(Ze),Error("Objects are not valid as a React child (found: "+(Xt==="[object Object]"?"object with keys {"+Object.keys(Ze).join(", ")+"}":Xt)+"). If you meant to render a collection of children, use an array instead.")}return mr}function bt(Ze,Xt,an){if(Ze==null)return Ze;var qt=[],cn=0;return mt(Ze,qt,"","",function(rr){return Xt.call(an,rr,cn++)}),qt}function Ft(Ze){if(Ze._status===-1){var Xt=Ze._result;Xt=Xt(),Xt.then(function(an){(Ze._status===0||Ze._status===-1)&&(Ze._status=1,Ze._result=an)},function(an){(Ze._status===0||Ze._status===-1)&&(Ze._status=2,Ze._result=an)}),Ze._status===-1&&(Ze._status=0,Ze._result=Xt)}if(Ze._status===1)return Ze._result.default;throw Ze._result}var Zt=typeof reportError=="function"?reportError:function(Ze){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Xt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Ze=="object"&&Ze!==null&&typeof Ze.message=="string"?String(Ze.message):String(Ze),error:Ze});if(!window.dispatchEvent(Xt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Ze);return}console.error(Ze)};function Vt(){}return li.Children={map:bt,forEach:function(Ze,Xt,an){bt(Ze,function(){Xt.apply(this,arguments)},an)},count:function(Ze){var Xt=0;return bt(Ze,function(){Xt++}),Xt},toArray:function(Ze){return bt(Ze,function(Xt){return Xt})||[]},only:function(Ze){if(!He(Ze))throw Error("React.Children.only expected to receive a single React element child.");return Ze}},li.Component=ue,li.Fragment=a,li.Profiler=c,li.PureComponent=Se,li.StrictMode=o,li.Suspense=P,li.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=me,li.act=function(){throw Error("act(...) is not supported in production builds of React.")},li.cache=function(Ze){return function(){return Ze.apply(null,arguments)}},li.cloneElement=function(Ze,Xt,an){if(Ze==null)throw Error("The argument must be a React element, but you passed "+Ze+".");var qt=ie({},Ze.props),cn=Ze.key,rr=void 0;if(Xt!=null)for(mr in Xt.ref!==void 0&&(rr=void 0),Xt.key!==void 0&&(cn=""+Xt.key),Xt)!Ae.call(Xt,mr)||mr==="key"||mr==="__self"||mr==="__source"||mr==="ref"&&Xt.ref===void 0||(qt[mr]=Xt[mr]);var mr=arguments.length-2;if(mr===1)qt.children=an;else if(1<mr){for(var Ci=Array(mr),Et=0;Et<mr;Et++)Ci[Et]=arguments[Et+2];qt.children=Ci}return Oe(Ze.type,cn,void 0,void 0,rr,qt)},li.createContext=function(Ze){return Ze={$$typeof:S,_currentValue:Ze,_currentValue2:Ze,_threadCount:0,Provider:null,Consumer:null},Ze.Provider=Ze,Ze.Consumer={$$typeof:b,_context:Ze},Ze},li.createElement=function(Ze,Xt,an){var qt,cn={},rr=null;if(Xt!=null)for(qt in Xt.key!==void 0&&(rr=""+Xt.key),Xt)Ae.call(Xt,qt)&&qt!=="key"&&qt!=="__self"&&qt!=="__source"&&(cn[qt]=Xt[qt]);var mr=arguments.length-2;if(mr===1)cn.children=an;else if(1<mr){for(var Ci=Array(mr),Et=0;Et<mr;Et++)Ci[Et]=arguments[Et+2];cn.children=Ci}if(Ze&&Ze.defaultProps)for(qt in mr=Ze.defaultProps,mr)cn[qt]===void 0&&(cn[qt]=mr[qt]);return Oe(Ze,rr,void 0,void 0,null,cn)},li.createRef=function(){return{current:null}},li.forwardRef=function(Ze){return{$$typeof:i,render:Ze}},li.isValidElement=He,li.lazy=function(Ze){return{$$typeof:U,_payload:{_status:-1,_result:Ze},_init:Ft}},li.memo=function(Ze,Xt){return{$$typeof:L,type:Ze,compare:Xt===void 0?null:Xt}},li.startTransition=function(Ze){var Xt=me.T,an={};me.T=an;try{var qt=Ze(),cn=me.S;cn!==null&&cn(an,qt),typeof qt=="object"&&qt!==null&&typeof qt.then=="function"&&qt.then(Vt,Zt)}catch(rr){Zt(rr)}finally{me.T=Xt}},li.unstable_useCacheRefresh=function(){return me.H.useCacheRefresh()},li.use=function(Ze){return me.H.use(Ze)},li.useActionState=function(Ze,Xt,an){return me.H.useActionState(Ze,Xt,an)},li.useCallback=function(Ze,Xt){return me.H.useCallback(Ze,Xt)},li.useContext=function(Ze){return me.H.useContext(Ze)},li.useDebugValue=function(){},li.useDeferredValue=function(Ze,Xt){return me.H.useDeferredValue(Ze,Xt)},li.useEffect=function(Ze,Xt){return me.H.useEffect(Ze,Xt)},li.useId=function(){return me.H.useId()},li.useImperativeHandle=function(Ze,Xt,an){return me.H.useImperativeHandle(Ze,Xt,an)},li.useInsertionEffect=function(Ze,Xt){return me.H.useInsertionEffect(Ze,Xt)},li.useLayoutEffect=function(Ze,Xt){return me.H.useLayoutEffect(Ze,Xt)},li.useMemo=function(Ze,Xt){return me.H.useMemo(Ze,Xt)},li.useOptimistic=function(Ze,Xt){return me.H.useOptimistic(Ze,Xt)},li.useReducer=function(Ze,Xt,an){return me.H.useReducer(Ze,Xt,an)},li.useRef=function(Ze){return me.H.useRef(Ze)},li.useState=function(Ze){return me.H.useState(Ze)},li.useSyncExternalStore=function(Ze,Xt,an){return me.H.useSyncExternalStore(Ze,Xt,an)},li.useTransition=function(){return me.H.useTransition()},li.version="19.0.0",li}var _k;function vC(){return _k||(_k=1,FS.exports=SG()),FS.exports}var Jt=vC();const kt=fa(Jt);var jS={exports:{}},Hv={},US={exports:{}},VS={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vk;function TG(){return vk||(vk=1,function(e){function t(bt,Ft){var Zt=bt.length;bt.push(Ft);e:for(;0<Zt;){var Vt=Zt-1>>>1,Ze=bt[Vt];if(0<c(Ze,Ft))bt[Vt]=Ft,bt[Zt]=Ze,Zt=Vt;else break e}}function a(bt){return bt.length===0?null:bt[0]}function o(bt){if(bt.length===0)return null;var Ft=bt[0],Zt=bt.pop();if(Zt!==Ft){bt[0]=Zt;e:for(var Vt=0,Ze=bt.length,Xt=Ze>>>1;Vt<Xt;){var an=2*(Vt+1)-1,qt=bt[an],cn=an+1,rr=bt[cn];if(0>c(qt,Zt))cn<Ze&&0>c(rr,qt)?(bt[Vt]=rr,bt[cn]=Zt,Vt=cn):(bt[Vt]=qt,bt[an]=Zt,Vt=an);else if(cn<Ze&&0>c(rr,Zt))bt[Vt]=rr,bt[cn]=Zt,Vt=cn;else break e}}return Ft}function c(bt,Ft){var Zt=bt.sortIndex-Ft.sortIndex;return Zt!==0?Zt:bt.id-Ft.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var b=performance;e.unstable_now=function(){return b.now()}}else{var S=Date,i=S.now();e.unstable_now=function(){return S.now()-i}}var P=[],L=[],U=1,V=null,H=3,ee=!1,ie=!1,le=!1,ue=typeof setTimeout=="function"?setTimeout:null,ge=typeof clearTimeout=="function"?clearTimeout:null,Se=typeof setImmediate<"u"?setImmediate:null;function ve(bt){for(var Ft=a(L);Ft!==null;){if(Ft.callback===null)o(L);else if(Ft.startTime<=bt)o(L),Ft.sortIndex=Ft.expirationTime,t(P,Ft);else break;Ft=a(L)}}function Ee(bt){if(le=!1,ve(bt),!ie)if(a(P)!==null)ie=!0,Tt();else{var Ft=a(L);Ft!==null&&mt(Ee,Ft.startTime-bt)}}var me=!1,Ae=-1,Oe=5,Ye=-1;function He(){return!(e.unstable_now()-Ye<Oe)}function st(){if(me){var bt=e.unstable_now();Ye=bt;var Ft=!0;try{e:{ie=!1,le&&(le=!1,ge(Ae),Ae=-1),ee=!0;var Zt=H;try{t:{for(ve(bt),V=a(P);V!==null&&!(V.expirationTime>bt&&He());){var Vt=V.callback;if(typeof Vt=="function"){V.callback=null,H=V.priorityLevel;var Ze=Vt(V.expirationTime<=bt);if(bt=e.unstable_now(),typeof Ze=="function"){V.callback=Ze,ve(bt),Ft=!0;break t}V===a(P)&&o(P),ve(bt)}else o(P);V=a(P)}if(V!==null)Ft=!0;else{var Xt=a(L);Xt!==null&&mt(Ee,Xt.startTime-bt),Ft=!1}}break e}finally{V=null,H=Zt,ee=!1}Ft=void 0}}finally{Ft?Ke():me=!1}}}var Ke;if(typeof Se=="function")Ke=function(){Se(st)};else if(typeof MessageChannel<"u"){var Ot=new MessageChannel,Bt=Ot.port2;Ot.port1.onmessage=st,Ke=function(){Bt.postMessage(null)}}else Ke=function(){ue(st,0)};function Tt(){me||(me=!0,Ke())}function mt(bt,Ft){Ae=ue(function(){bt(e.unstable_now())},Ft)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(bt){bt.callback=null},e.unstable_continueExecution=function(){ie||ee||(ie=!0,Tt())},e.unstable_forceFrameRate=function(bt){0>bt||125<bt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Oe=0<bt?Math.floor(1e3/bt):5},e.unstable_getCurrentPriorityLevel=function(){return H},e.unstable_getFirstCallbackNode=function(){return a(P)},e.unstable_next=function(bt){switch(H){case 1:case 2:case 3:var Ft=3;break;default:Ft=H}var Zt=H;H=Ft;try{return bt()}finally{H=Zt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(bt,Ft){switch(bt){case 1:case 2:case 3:case 4:case 5:break;default:bt=3}var Zt=H;H=bt;try{return Ft()}finally{H=Zt}},e.unstable_scheduleCallback=function(bt,Ft,Zt){var Vt=e.unstable_now();switch(typeof Zt=="object"&&Zt!==null?(Zt=Zt.delay,Zt=typeof Zt=="number"&&0<Zt?Vt+Zt:Vt):Zt=Vt,bt){case 1:var Ze=-1;break;case 2:Ze=250;break;case 5:Ze=1073741823;break;case 4:Ze=1e4;break;default:Ze=5e3}return Ze=Zt+Ze,bt={id:U++,callback:Ft,priorityLevel:bt,startTime:Zt,expirationTime:Ze,sortIndex:-1},Zt>Vt?(bt.sortIndex=Zt,t(L,bt),a(P)===null&&bt===a(L)&&(le?(ge(Ae),Ae=-1):le=!0,mt(Ee,Zt-Vt))):(bt.sortIndex=Ze,t(P,bt),ie||ee||(ie=!0,Tt())),bt},e.unstable_shouldYield=He,e.unstable_wrapCallback=function(bt){var Ft=H;return function(){var Zt=H;H=Ft;try{return bt.apply(this,arguments)}finally{H=Zt}}}}(VS)),VS}var xk;function EG(){return xk||(xk=1,US.exports=TG()),US.exports}var qS={exports:{}},_l={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bk;function AG(){if(bk)return _l;bk=1;var e=vC();function t(P){var L="https://react.dev/errors/"+P;if(1<arguments.length){L+="?args[]="+encodeURIComponent(arguments[1]);for(var U=2;U<arguments.length;U++)L+="&args[]="+encodeURIComponent(arguments[U])}return"Minified React error #"+P+"; visit "+L+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var o={d:{f:a,r:function(){throw Error(t(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},c=Symbol.for("react.portal");function b(P,L,U){var V=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:V==null?null:""+V,children:P,containerInfo:L,implementation:U}}var S=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function i(P,L){if(P==="font")return"";if(typeof L=="string")return L==="use-credentials"?L:""}return _l.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,_l.createPortal=function(P,L){var U=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!L||L.nodeType!==1&&L.nodeType!==9&&L.nodeType!==11)throw Error(t(299));return b(P,L,null,U)},_l.flushSync=function(P){var L=S.T,U=o.p;try{if(S.T=null,o.p=2,P)return P()}finally{S.T=L,o.p=U,o.d.f()}},_l.preconnect=function(P,L){typeof P=="string"&&(L?(L=L.crossOrigin,L=typeof L=="string"?L==="use-credentials"?L:"":void 0):L=null,o.d.C(P,L))},_l.prefetchDNS=function(P){typeof P=="string"&&o.d.D(P)},_l.preinit=function(P,L){if(typeof P=="string"&&L&&typeof L.as=="string"){var U=L.as,V=i(U,L.crossOrigin),H=typeof L.integrity=="string"?L.integrity:void 0,ee=typeof L.fetchPriority=="string"?L.fetchPriority:void 0;U==="style"?o.d.S(P,typeof L.precedence=="string"?L.precedence:void 0,{crossOrigin:V,integrity:H,fetchPriority:ee}):U==="script"&&o.d.X(P,{crossOrigin:V,integrity:H,fetchPriority:ee,nonce:typeof L.nonce=="string"?L.nonce:void 0})}},_l.preinitModule=function(P,L){if(typeof P=="string")if(typeof L=="object"&&L!==null){if(L.as==null||L.as==="script"){var U=i(L.as,L.crossOrigin);o.d.M(P,{crossOrigin:U,integrity:typeof L.integrity=="string"?L.integrity:void 0,nonce:typeof L.nonce=="string"?L.nonce:void 0})}}else L==null&&o.d.M(P)},_l.preload=function(P,L){if(typeof P=="string"&&typeof L=="object"&&L!==null&&typeof L.as=="string"){var U=L.as,V=i(U,L.crossOrigin);o.d.L(P,U,{crossOrigin:V,integrity:typeof L.integrity=="string"?L.integrity:void 0,nonce:typeof L.nonce=="string"?L.nonce:void 0,type:typeof L.type=="string"?L.type:void 0,fetchPriority:typeof L.fetchPriority=="string"?L.fetchPriority:void 0,referrerPolicy:typeof L.referrerPolicy=="string"?L.referrerPolicy:void 0,imageSrcSet:typeof L.imageSrcSet=="string"?L.imageSrcSet:void 0,imageSizes:typeof L.imageSizes=="string"?L.imageSizes:void 0,media:typeof L.media=="string"?L.media:void 0})}},_l.preloadModule=function(P,L){if(typeof P=="string")if(L){var U=i(L.as,L.crossOrigin);o.d.m(P,{as:typeof L.as=="string"&&L.as!=="script"?L.as:void 0,crossOrigin:U,integrity:typeof L.integrity=="string"?L.integrity:void 0})}else o.d.m(P)},_l.requestFormReset=function(P){o.d.r(P)},_l.unstable_batchedUpdates=function(P,L){return P(L)},_l.useFormState=function(P,L,U){return S.H.useFormState(P,L,U)},_l.useFormStatus=function(){return S.H.useHostTransitionStatus()},_l.version="19.0.0",_l}var wk;function MG(){if(wk)return qS.exports;wk=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),qS.exports=AG(),qS.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sk;function OG(){if(Sk)return Hv;Sk=1;var e=EG(),t=vC(),a=MG();function o(f){var _="https://react.dev/errors/"+f;if(1<arguments.length){_+="?args[]="+encodeURIComponent(arguments[1]);for(var A=2;A<arguments.length;A++)_+="&args[]="+encodeURIComponent(arguments[A])}return"Minified React error #"+f+"; visit "+_+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function c(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)}var b=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),i=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),U=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),H=Symbol.for("react.consumer"),ee=Symbol.for("react.context"),ie=Symbol.for("react.forward_ref"),le=Symbol.for("react.suspense"),ue=Symbol.for("react.suspense_list"),ge=Symbol.for("react.memo"),Se=Symbol.for("react.lazy"),ve=Symbol.for("react.offscreen"),Ee=Symbol.for("react.memo_cache_sentinel"),me=Symbol.iterator;function Ae(f){return f===null||typeof f!="object"?null:(f=me&&f[me]||f["@@iterator"],typeof f=="function"?f:null)}var Oe=Symbol.for("react.client.reference");function Ye(f){if(f==null)return null;if(typeof f=="function")return f.$$typeof===Oe?null:f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case P:return"Fragment";case i:return"Portal";case U:return"Profiler";case L:return"StrictMode";case le:return"Suspense";case ue:return"SuspenseList"}if(typeof f=="object")switch(f.$$typeof){case ee:return(f.displayName||"Context")+".Provider";case H:return(f._context.displayName||"Context")+".Consumer";case ie:var _=f.render;return f=f.displayName,f||(f=_.displayName||_.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case ge:return _=f.displayName||null,_!==null?_:Ye(f.type)||"Memo";case Se:_=f._payload,f=f._init;try{return Ye(f(_))}catch{}}return null}var He=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,st=Object.assign,Ke,Ot;function Bt(f){if(Ke===void 0)try{throw Error()}catch(A){var _=A.stack.trim().match(/\n( *(at )?)/);Ke=_&&_[1]||"",Ot=-1<A.stack.indexOf(`
    at`)?" (<anonymous>)":-1<A.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ke+f+Ot}var Tt=!1;function mt(f,_){if(!f||Tt)return"";Tt=!0;var A=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var F={DetermineComponentFrameRoot:function(){try{if(_){var Dn=function(){throw Error()};if(Object.defineProperty(Dn.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Dn,[])}catch(gn){var rn=gn}Reflect.construct(f,[],Dn)}else{try{Dn.call()}catch(gn){rn=gn}f.call(Dn.prototype)}}else{try{throw Error()}catch(gn){rn=gn}(Dn=f())&&typeof Dn.catch=="function"&&Dn.catch(function(){})}}catch(gn){if(gn&&rn&&typeof gn.stack=="string")return[gn.stack,rn.stack]}return[null,null]}};F.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var Y=Object.getOwnPropertyDescriptor(F.DetermineComponentFrameRoot,"name");Y&&Y.configurable&&Object.defineProperty(F.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var re=F.DetermineComponentFrameRoot(),Me=re[0],Ge=re[1];if(Me&&Ge){var dt=Me.split(`
`),Nt=Ge.split(`
`);for(Y=F=0;F<dt.length&&!dt[F].includes("DetermineComponentFrameRoot");)F++;for(;Y<Nt.length&&!Nt[Y].includes("DetermineComponentFrameRoot");)Y++;if(F===dt.length||Y===Nt.length)for(F=dt.length-1,Y=Nt.length-1;1<=F&&0<=Y&&dt[F]!==Nt[Y];)Y--;for(;1<=F&&0<=Y;F--,Y--)if(dt[F]!==Nt[Y]){if(F!==1||Y!==1)do if(F--,Y--,0>Y||dt[F]!==Nt[Y]){var yn=`
`+dt[F].replace(" at new "," at ");return f.displayName&&yn.includes("<anonymous>")&&(yn=yn.replace("<anonymous>",f.displayName)),yn}while(1<=F&&0<=Y);break}}}finally{Tt=!1,Error.prepareStackTrace=A}return(A=f?f.displayName||f.name:"")?Bt(A):""}function bt(f){switch(f.tag){case 26:case 27:case 5:return Bt(f.type);case 16:return Bt("Lazy");case 13:return Bt("Suspense");case 19:return Bt("SuspenseList");case 0:case 15:return f=mt(f.type,!1),f;case 11:return f=mt(f.type.render,!1),f;case 1:return f=mt(f.type,!0),f;default:return""}}function Ft(f){try{var _="";do _+=bt(f),f=f.return;while(f);return _}catch(A){return`
Error generating stack: `+A.message+`
`+A.stack}}function Zt(f){var _=f,A=f;if(f.alternate)for(;_.return;)_=_.return;else{f=_;do _=f,(_.flags&4098)!==0&&(A=_.return),f=_.return;while(f)}return _.tag===3?A:null}function Vt(f){if(f.tag===13){var _=f.memoizedState;if(_===null&&(f=f.alternate,f!==null&&(_=f.memoizedState)),_!==null)return _.dehydrated}return null}function Ze(f){if(Zt(f)!==f)throw Error(o(188))}function Xt(f){var _=f.alternate;if(!_){if(_=Zt(f),_===null)throw Error(o(188));return _!==f?null:f}for(var A=f,F=_;;){var Y=A.return;if(Y===null)break;var re=Y.alternate;if(re===null){if(F=Y.return,F!==null){A=F;continue}break}if(Y.child===re.child){for(re=Y.child;re;){if(re===A)return Ze(Y),f;if(re===F)return Ze(Y),_;re=re.sibling}throw Error(o(188))}if(A.return!==F.return)A=Y,F=re;else{for(var Me=!1,Ge=Y.child;Ge;){if(Ge===A){Me=!0,A=Y,F=re;break}if(Ge===F){Me=!0,F=Y,A=re;break}Ge=Ge.sibling}if(!Me){for(Ge=re.child;Ge;){if(Ge===A){Me=!0,A=re,F=Y;break}if(Ge===F){Me=!0,F=re,A=Y;break}Ge=Ge.sibling}if(!Me)throw Error(o(189))}}if(A.alternate!==F)throw Error(o(190))}if(A.tag!==3)throw Error(o(188));return A.stateNode.current===A?f:_}function an(f){var _=f.tag;if(_===5||_===26||_===27||_===6)return f;for(f=f.child;f!==null;){if(_=an(f),_!==null)return _;f=f.sibling}return null}var qt=Array.isArray,cn=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,rr={pending:!1,data:null,method:null,action:null},mr=[],Ci=-1;function Et(f){return{current:f}}function Ln(f){0>Ci||(f.current=mr[Ci],mr[Ci]=null,Ci--)}function Ne(f,_){Ci++,mr[Ci]=f.current,f.current=_}var An=Et(null),qe=Et(null),jr=Et(null),$t=Et(null);function Ur(f,_){switch(Ne(jr,_),Ne(qe,f),Ne(An,null),f=_.nodeType,f){case 9:case 11:_=(_=_.documentElement)&&(_=_.namespaceURI)?tv(_):0;break;default:if(f=f===8?_.parentNode:_,_=f.tagName,f=f.namespaceURI)f=tv(f),_=uy(f,_);else switch(_){case"svg":_=1;break;case"math":_=2;break;default:_=0}}Ln(An),Ne(An,_)}function Wr(){Ln(An),Ln(qe),Ln(jr)}function Qi(f){f.memoizedState!==null&&Ne($t,f);var _=An.current,A=uy(_,f.type);_!==A&&(Ne(qe,f),Ne(An,A))}function hr(f){qe.current===f&&(Ln(An),Ln(qe)),$t.current===f&&(Ln($t),kd._currentValue=rr)}var vn=Object.prototype.hasOwnProperty,wa=e.unstable_scheduleCallback,La=e.unstable_cancelCallback,ya=e.unstable_shouldYield,ks=e.unstable_requestPaint,Mn=e.unstable_now,no=e.unstable_getCurrentPriorityLevel,To=e.unstable_ImmediatePriority,Ds=e.unstable_UserBlockingPriority,ar=e.unstable_NormalPriority,Ls=e.unstable_LowPriority,Kr=e.unstable_IdlePriority,Rr=e.log,ec=e.unstable_setDisableYieldValue,Ui=null,$a=null;function Er(f){if($a&&typeof $a.onCommitFiberRoot=="function")try{$a.onCommitFiberRoot(Ui,f,void 0,(f.current.flags&128)===128)}catch{}}function Sa(f){if(typeof Rr=="function"&&ec(f),$a&&typeof $a.setStrictMode=="function")try{$a.setStrictMode(Ui,f)}catch{}}var za=Math.clz32?Math.clz32:Kl,lr=Math.log,_a=Math.LN2;function Kl(f){return f>>>=0,f===0?32:31-(lr(f)/_a|0)|0}var $i=128,Zo=4194304;function Eo(f){var _=f&42;if(_!==0)return _;switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return f&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return f}}function Al(f,_){var A=f.pendingLanes;if(A===0)return 0;var F=0,Y=f.suspendedLanes,re=f.pingedLanes,Me=f.warmLanes;f=f.finishedLanes!==0;var Ge=A&134217727;return Ge!==0?(A=Ge&~Y,A!==0?F=Eo(A):(re&=Ge,re!==0?F=Eo(re):f||(Me=Ge&~Me,Me!==0&&(F=Eo(Me))))):(Ge=A&~Y,Ge!==0?F=Eo(Ge):re!==0?F=Eo(re):f||(Me=A&~Me,Me!==0&&(F=Eo(Me)))),F===0?0:_!==0&&_!==F&&(_&Y)===0&&(Y=F&-F,Me=_&-_,Y>=Me||Y===32&&(Me&4194176)!==0)?_:F}function zs(f,_){return(f.pendingLanes&~(f.suspendedLanes&~f.pingedLanes)&_)===0}function nl(f,_){switch(f){case 1:case 2:case 4:case 8:return _+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Bn(){var f=$i;return $i<<=1,($i&4194176)===0&&($i=128),f}function Jl(){var f=Zo;return Zo<<=1,(Zo&62914560)===0&&(Zo=4194304),f}function Ml(f){for(var _=[],A=0;31>A;A++)_.push(f);return _}function Mi(f,_){f.pendingLanes|=_,_!==268435456&&(f.suspendedLanes=0,f.pingedLanes=0,f.warmLanes=0)}function tc(f,_,A,F,Y,re){var Me=f.pendingLanes;f.pendingLanes=A,f.suspendedLanes=0,f.pingedLanes=0,f.warmLanes=0,f.expiredLanes&=A,f.entangledLanes&=A,f.errorRecoveryDisabledLanes&=A,f.shellSuspendCounter=0;var Ge=f.entanglements,dt=f.expirationTimes,Nt=f.hiddenUpdates;for(A=Me&~A;0<A;){var yn=31-za(A),Dn=1<<yn;Ge[yn]=0,dt[yn]=-1;var rn=Nt[yn];if(rn!==null)for(Nt[yn]=null,yn=0;yn<rn.length;yn++){var gn=rn[yn];gn!==null&&(gn.lane&=-536870913)}A&=~Dn}F!==0&&Tu(f,F,0),re!==0&&Y===0&&f.tag!==0&&(f.suspendedLanes|=re&~(Me&~_))}function Tu(f,_,A){f.pendingLanes|=_,f.suspendedLanes&=~_;var F=31-za(_);f.entangledLanes|=_,f.entanglements[F]=f.entanglements[F]|1073741824|A&4194218}function Eu(f,_){var A=f.entangledLanes|=_;for(f=f.entanglements;A;){var F=31-za(A),Y=1<<F;Y&_|f[F]&_&&(f[F]|=_),A&=~Y}}function ea(f){return f&=-f,2<f?8<f?(f&134217727)!==0?32:268435456:8:2}function ls(){var f=cn.p;return f!==0?f:(f=window.event,f===void 0?32:l1(f.type))}function wt(f,_){var A=cn.p;try{return cn.p=f,_()}finally{cn.p=A}}var de=Math.random().toString(36).slice(2),xe="__reactFiber$"+de,Ie="__reactProps$"+de,Fe="__reactContainer$"+de,Xe="__reactEvents$"+de,nt="__reactListeners$"+de,ct="__reactHandles$"+de,rt="__reactResources$"+de,vt="__reactMarker$"+de;function gt(f){delete f[xe],delete f[Ie],delete f[Xe],delete f[nt],delete f[ct]}function xt(f){var _=f[xe];if(_)return _;for(var A=f.parentNode;A;){if(_=A[Fe]||A[xe]){if(A=_.alternate,_.child!==null||A!==null&&A.child!==null)for(f=Jx(f);f!==null;){if(A=f[xe])return A;f=Jx(f)}return _}f=A,A=f.parentNode}return null}function Ct(f){if(f=f[xe]||f[Fe]){var _=f.tag;if(_===5||_===6||_===13||_===26||_===27||_===3)return f}return null}function un(f){var _=f.tag;if(_===5||_===26||_===27||_===6)return f.stateNode;throw Error(o(33))}function hn(f){var _=f[rt];return _||(_=f[rt]={hoistableStyles:new Map,hoistableScripts:new Map}),_}function Rn(f){f[vt]=!0}var $n=new Set,Xn={};function Fn(f,_){yr(f,_),yr(f+"Capture",_)}function yr(f,_){for(Xn[f]=_,f=0;f<_.length;f++)$n.add(_[f])}var Tr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),or=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Or={},Nr={};function Pi(f){return vn.call(Nr,f)?!0:vn.call(Or,f)?!1:or.test(f)?Nr[f]=!0:(Or[f]=!0,!1)}function Ao(f,_,A){if(Pi(_))if(A===null)f.removeAttribute(_);else{switch(typeof A){case"undefined":case"function":case"symbol":f.removeAttribute(_);return;case"boolean":var F=_.toLowerCase().slice(0,5);if(F!=="data-"&&F!=="aria-"){f.removeAttribute(_);return}}f.setAttribute(_,""+A)}}function ta(f,_,A){if(A===null)f.removeAttribute(_);else{switch(typeof A){case"undefined":case"function":case"symbol":case"boolean":f.removeAttribute(_);return}f.setAttribute(_,""+A)}}function Ri(f,_,A,F){if(F===null)f.removeAttribute(A);else{switch(typeof F){case"undefined":case"function":case"symbol":case"boolean":f.removeAttribute(A);return}f.setAttributeNS(_,A,""+F)}}function Vi(f){switch(typeof f){case"bigint":case"boolean":case"number":case"string":case"undefined":return f;case"object":return f;default:return""}}function Au(f){var _=f.type;return(f=f.nodeName)&&f.toLowerCase()==="input"&&(_==="checkbox"||_==="radio")}function rl(f){var _=Au(f)?"checked":"value",A=Object.getOwnPropertyDescriptor(f.constructor.prototype,_),F=""+f[_];if(!f.hasOwnProperty(_)&&typeof A<"u"&&typeof A.get=="function"&&typeof A.set=="function"){var Y=A.get,re=A.set;return Object.defineProperty(f,_,{configurable:!0,get:function(){return Y.call(this)},set:function(Me){F=""+Me,re.call(this,Me)}}),Object.defineProperty(f,_,{enumerable:A.enumerable}),{getValue:function(){return F},setValue:function(Me){F=""+Me},stopTracking:function(){f._valueTracker=null,delete f[_]}}}}function Ns(f){f._valueTracker||(f._valueTracker=rl(f))}function us(f){if(!f)return!1;var _=f._valueTracker;if(!_)return!0;var A=_.getValue(),F="";return f&&(F=Au(f)?f.checked?"true":"false":f.value),f=F,f!==A?(_.setValue(f),!0):!1}function cs(f){if(f=f||(typeof document<"u"?document:void 0),typeof f>"u")return null;try{return f.activeElement||f.body}catch{return f.body}}var Lh=/[\n"\\]/g;function Na(f){return f.replace(Lh,function(_){return"\\"+_.charCodeAt(0).toString(16)+" "})}function Ha(f,_,A,F,Y,re,Me,Ge){f.name="",Me!=null&&typeof Me!="function"&&typeof Me!="symbol"&&typeof Me!="boolean"?f.type=Me:f.removeAttribute("type"),_!=null?Me==="number"?(_===0&&f.value===""||f.value!=_)&&(f.value=""+Vi(_)):f.value!==""+Vi(_)&&(f.value=""+Vi(_)):Me!=="submit"&&Me!=="reset"||f.removeAttribute("value"),_!=null?Bs(f,Me,Vi(_)):A!=null?Bs(f,Me,Vi(A)):F!=null&&f.removeAttribute("value"),Y==null&&re!=null&&(f.defaultChecked=!!re),Y!=null&&(f.checked=Y&&typeof Y!="function"&&typeof Y!="symbol"),Ge!=null&&typeof Ge!="function"&&typeof Ge!="symbol"&&typeof Ge!="boolean"?f.name=""+Vi(Ge):f.removeAttribute("name")}function hs(f,_,A,F,Y,re,Me,Ge){if(re!=null&&typeof re!="function"&&typeof re!="symbol"&&typeof re!="boolean"&&(f.type=re),_!=null||A!=null){if(!(re!=="submit"&&re!=="reset"||_!=null))return;A=A!=null?""+Vi(A):"",_=_!=null?""+Vi(_):A,Ge||_===f.value||(f.value=_),f.defaultValue=_}F=F??Y,F=typeof F!="function"&&typeof F!="symbol"&&!!F,f.checked=Ge?f.checked:!!F,f.defaultChecked=!!F,Me!=null&&typeof Me!="function"&&typeof Me!="symbol"&&typeof Me!="boolean"&&(f.name=Me)}function Bs(f,_,A){_==="number"&&cs(f.ownerDocument)===f||f.defaultValue===""+A||(f.defaultValue=""+A)}function Mo(f,_,A,F){if(f=f.options,_){_={};for(var Y=0;Y<A.length;Y++)_["$"+A[Y]]=!0;for(A=0;A<f.length;A++)Y=_.hasOwnProperty("$"+f[A].value),f[A].selected!==Y&&(f[A].selected=Y),Y&&F&&(f[A].defaultSelected=!0)}else{for(A=""+Vi(A),_=null,Y=0;Y<f.length;Y++){if(f[Y].value===A){f[Y].selected=!0,F&&(f[Y].defaultSelected=!0);return}_!==null||f[Y].disabled||(_=f[Y])}_!==null&&(_.selected=!0)}}function Wo(f,_,A){if(_!=null&&(_=""+Vi(_),_!==f.value&&(f.value=_),A==null)){f.defaultValue!==_&&(f.defaultValue=_);return}f.defaultValue=A!=null?""+Vi(A):""}function Oo(f,_,A,F){if(_==null){if(F!=null){if(A!=null)throw Error(o(92));if(qt(F)){if(1<F.length)throw Error(o(93));F=F[0]}A=F}A==null&&(A=""),_=A}A=Vi(_),f.defaultValue=A,F=f.textContent,F===A&&F!==""&&F!==null&&(f.value=F)}function il(f,_){if(_){var A=f.firstChild;if(A&&A===f.lastChild&&A.nodeType===3){A.nodeValue=_;return}}f.textContent=_}var Gf=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function al(f,_,A){var F=_.indexOf("--")===0;A==null||typeof A=="boolean"||A===""?F?f.setProperty(_,""):_==="float"?f.cssFloat="":f[_]="":F?f.setProperty(_,A):typeof A!="number"||A===0||Gf.has(_)?_==="float"?f.cssFloat=A:f[_]=(""+A).trim():f[_]=A+"px"}function Ol(f,_,A){if(_!=null&&typeof _!="object")throw Error(o(62));if(f=f.style,A!=null){for(var F in A)!A.hasOwnProperty(F)||_!=null&&_.hasOwnProperty(F)||(F.indexOf("--")===0?f.setProperty(F,""):F==="float"?f.cssFloat="":f[F]="");for(var Y in _)F=_[Y],_.hasOwnProperty(Y)&&A[Y]!==F&&al(f,Y,F)}else for(var re in _)_.hasOwnProperty(re)&&al(f,re,_[re])}function nc(f){if(f.indexOf("-")===-1)return!1;switch(f){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hi=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Xa=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Vr(f){return Xa.test(""+f)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":f}var Mu=null;function Nn(f){return f=f.target||f.srcElement||window,f.correspondingUseElement&&(f=f.correspondingUseElement),f.nodeType===3?f.parentNode:f}var Ya=null,fs=null;function Yc(f){var _=Ct(f);if(_&&(f=_.stateNode)){var A=f[Ie]||null;e:switch(f=_.stateNode,_.type){case"input":if(Ha(f,A.value,A.defaultValue,A.defaultValue,A.checked,A.defaultChecked,A.type,A.name),_=A.name,A.type==="radio"&&_!=null){for(A=f;A.parentNode;)A=A.parentNode;for(A=A.querySelectorAll('input[name="'+Na(""+_)+'"][type="radio"]'),_=0;_<A.length;_++){var F=A[_];if(F!==f&&F.form===f.form){var Y=F[Ie]||null;if(!Y)throw Error(o(90));Ha(F,Y.value,Y.defaultValue,Y.defaultValue,Y.checked,Y.defaultChecked,Y.type,Y.name)}}for(_=0;_<A.length;_++)F=A[_],F.form===f.form&&us(F)}break e;case"textarea":Wo(f,A.value,A.defaultValue);break e;case"select":_=A.value,_!=null&&Mo(f,!!A.multiple,_,!1)}}}var _r=!1;function rc(f,_,A){if(_r)return f(_,A);_r=!0;try{var F=f(_);return F}finally{if(_r=!1,(Ya!==null||fs!==null)&&(Rm(),Ya&&(_=Ya,f=fs,fs=Ya=null,Yc(_),f)))for(_=0;_<f.length;_++)Yc(f[_])}}function Lo(f,_){var A=f.stateNode;if(A===null)return null;var F=A[Ie]||null;if(F===null)return null;A=F[_];e:switch(_){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(F=!F.disabled)||(f=f.type,F=!(f==="button"||f==="input"||f==="select"||f==="textarea")),f=!F;break e;default:f=!1}if(f)return null;if(A&&typeof A!="function")throw Error(o(231,_,typeof A));return A}var kn=!1;if(Tr)try{var qr={};Object.defineProperty(qr,"passive",{get:function(){kn=!0}}),window.addEventListener("test",qr,qr),window.removeEventListener("test",qr,qr)}catch{kn=!1}var Vn=null,zi=null,zo=null;function Br(){if(zo)return zo;var f,_=zi,A=_.length,F,Y="value"in Vn?Vn.value:Vn.textContent,re=Y.length;for(f=0;f<A&&_[f]===Y[f];f++);var Me=A-f;for(F=1;F<=Me&&_[A-F]===Y[re-F];F++);return zo=Y.slice(f,1<F?1-F:void 0)}function ds(f){var _=f.keyCode;return"charCode"in f?(f=f.charCode,f===0&&_===13&&(f=13)):f=_,f===10&&(f=13),32<=f||f===13?f:0}function No(){return!0}function Ta(){return!1}function di(f){function _(A,F,Y,re,Me){this._reactName=A,this._targetInst=Y,this.type=F,this.nativeEvent=re,this.target=Me,this.currentTarget=null;for(var Ge in f)f.hasOwnProperty(Ge)&&(A=f[Ge],this[Ge]=A?A(re):re[Ge]);return this.isDefaultPrevented=(re.defaultPrevented!=null?re.defaultPrevented:re.returnValue===!1)?No:Ta,this.isPropagationStopped=Ta,this}return st(_.prototype,{preventDefault:function(){this.defaultPrevented=!0;var A=this.nativeEvent;A&&(A.preventDefault?A.preventDefault():typeof A.returnValue!="unknown"&&(A.returnValue=!1),this.isDefaultPrevented=No)},stopPropagation:function(){var A=this.nativeEvent;A&&(A.stopPropagation?A.stopPropagation():typeof A.cancelBubble!="unknown"&&(A.cancelBubble=!0),this.isPropagationStopped=No)},persist:function(){},isPersistent:No}),_}var ui={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(f){return f.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ou=di(ui),Ea=st({},ui,{view:0,detail:0}),zh=di(Ea),Ql,Bo,ps,Aa=st({},Ea,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xf,button:0,buttons:0,relatedTarget:function(f){return f.relatedTarget===void 0?f.fromElement===f.srcElement?f.toElement:f.fromElement:f.relatedTarget},movementX:function(f){return"movementX"in f?f.movementX:(f!==ps&&(ps&&f.type==="mousemove"?(Ql=f.screenX-ps.screenX,Bo=f.screenY-ps.screenY):Bo=Ql=0,ps=f),Ql)},movementY:function(f){return"movementY"in f?f.movementY:Bo}}),da=di(Aa),la=st({},Aa,{dataTransfer:0}),$f=di(la),Fo=st({},Ea,{relatedTarget:0}),Oi=di(Fo),ro=st({},ui,{animationName:0,elapsedTime:0,pseudoElement:0}),Ba=di(ro),pi=st({},ui,{clipboardData:function(f){return"clipboardData"in f?f.clipboardData:window.clipboardData}}),ic=di(pi),Fs=st({},ui,{data:0}),eu=di(Fs),Zc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},js={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Hf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Il(f){var _=this.nativeEvent;return _.getModifierState?_.getModifierState(f):(f=Hf[f])?!!_[f]:!1}function Xf(){return Il}var Cl=st({},Ea,{key:function(f){if(f.key){var _=Zc[f.key]||f.key;if(_!=="Unidentified")return _}return f.type==="keypress"?(f=ds(f),f===13?"Enter":String.fromCharCode(f)):f.type==="keydown"||f.type==="keyup"?js[f.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xf,charCode:function(f){return f.type==="keypress"?ds(f):0},keyCode:function(f){return f.type==="keydown"||f.type==="keyup"?f.keyCode:0},which:function(f){return f.type==="keypress"?ds(f):f.type==="keydown"||f.type==="keyup"?f.keyCode:0}}),qi=di(Cl),Yf=st({},Aa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ac=di(Yf),Wc=st({},Ea,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xf}),Iu=di(Wc),np=st({},ui,{propertyName:0,elapsedTime:0,pseudoElement:0}),Zf=di(np),oc=st({},Aa,{deltaX:function(f){return"deltaX"in f?f.deltaX:"wheelDeltaX"in f?-f.wheelDeltaX:0},deltaY:function(f){return"deltaY"in f?f.deltaY:"wheelDeltaY"in f?-f.wheelDeltaY:"wheelDelta"in f?-f.wheelDelta:0},deltaZ:0,deltaMode:0}),Io=di(oc),rp=st({},ui,{newState:0,oldState:0}),Za=di(rp),Cu=[9,13,27,32],Us=Tr&&"CompositionEvent"in window,Ko=null;Tr&&"documentMode"in document&&(Ko=document.documentMode);var ip=Tr&&"TextEvent"in window&&!Ko,Kc=Tr&&(!Us||Ko&&8<Ko&&11>=Ko),Nh=" ",Wf=!1;function ap(f,_){switch(f){case"keyup":return Cu.indexOf(_.keyCode)!==-1;case"keydown":return _.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bh(f){return f=f.detail,typeof f=="object"&&"data"in f?f.data:null}var ms=!1;function vr(f,_){switch(f){case"compositionend":return Bh(_);case"keypress":return _.which!==32?null:(Wf=!0,Nh);case"textInput":return f=_.data,f===Nh&&Wf?null:f;default:return null}}function qn(f,_){if(ms)return f==="compositionend"||!Us&&ap(f,_)?(f=Br(),zo=zi=Vn=null,ms=!1,f):null;switch(f){case"paste":return null;case"keypress":if(!(_.ctrlKey||_.altKey||_.metaKey)||_.ctrlKey&&_.altKey){if(_.char&&1<_.char.length)return _.char;if(_.which)return String.fromCharCode(_.which)}return null;case"compositionend":return Kc&&_.locale!=="ko"?null:_.data;default:return null}}var Fh={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Qn(f){var _=f&&f.nodeName&&f.nodeName.toLowerCase();return _==="input"?!!Fh[f.type]:_==="textarea"}function tu(f,_,A,F){Ya?fs?fs.push(F):fs=[F]:Ya=F,_=Nm(_,"onChange"),0<_.length&&(A=new Ou("onChange","change",null,A,F),f.push({event:A,listeners:_}))}var nu=null,Wn=null;function sc(f){Hx(f,0)}function ol(f){var _=un(f);if(us(_))return f}function jh(f,_){if(f==="change")return _}var Jc=!1;if(Tr){var io;if(Tr){var Ma="oninput"in document;if(!Ma){var pn=document.createElement("div");pn.setAttribute("oninput","return;"),Ma=typeof pn.oninput=="function"}io=Ma}else io=!1;Jc=io&&(!document.documentMode||9<document.documentMode)}function Qc(){nu&&(nu.detachEvent("onpropertychange",lc),Wn=nu=null)}function lc(f){if(f.propertyName==="value"&&ol(Wn)){var _=[];tu(_,Wn,f,Nn(f)),rc(sc,_)}}function uc(f,_,A){f==="focusin"?(Qc(),nu=_,Wn=A,nu.attachEvent("onpropertychange",lc)):f==="focusout"&&Qc()}function ru(f){if(f==="selectionchange"||f==="keyup"||f==="keydown")return ol(Wn)}function Oa(f,_){if(f==="click")return ol(_)}function Vs(f,_){if(f==="input"||f==="change")return ol(_)}function Kf(f,_){return f===_&&(f!==0||1/f===1/_)||f!==f&&_!==_}var Ia=typeof Object.is=="function"?Object.is:Kf;function gs(f,_){if(Ia(f,_))return!0;if(typeof f!="object"||f===null||typeof _!="object"||_===null)return!1;var A=Object.keys(f),F=Object.keys(_);if(A.length!==F.length)return!1;for(F=0;F<A.length;F++){var Y=A[F];if(!vn.call(_,Y)||!Ia(f[Y],_[Y]))return!1}return!0}function iu(f){for(;f&&f.firstChild;)f=f.firstChild;return f}function Uh(f,_){var A=iu(f);f=0;for(var F;A;){if(A.nodeType===3){if(F=f+A.textContent.length,f<=_&&F>=_)return{node:A,offset:_-f};f=F}e:{for(;A;){if(A.nextSibling){A=A.nextSibling;break e}A=A.parentNode}A=void 0}A=iu(A)}}function Pu(f,_){return f&&_?f===_?!0:f&&f.nodeType===3?!1:_&&_.nodeType===3?Pu(f,_.parentNode):"contains"in f?f.contains(_):f.compareDocumentPosition?!!(f.compareDocumentPosition(_)&16):!1:!1}function Vh(f){f=f!=null&&f.ownerDocument!=null&&f.ownerDocument.defaultView!=null?f.ownerDocument.defaultView:window;for(var _=cs(f.document);_ instanceof f.HTMLIFrameElement;){try{var A=typeof _.contentWindow.location.href=="string"}catch{A=!1}if(A)f=_.contentWindow;else break;_=cs(f.document)}return _}function qh(f){var _=f&&f.nodeName&&f.nodeName.toLowerCase();return _&&(_==="input"&&(f.type==="text"||f.type==="search"||f.type==="tel"||f.type==="url"||f.type==="password")||_==="textarea"||f.contentEditable==="true")}function Jo(f,_){var A=Vh(_);_=f.focusedElem;var F=f.selectionRange;if(A!==_&&_&&_.ownerDocument&&Pu(_.ownerDocument.documentElement,_)){if(F!==null&&qh(_)){if(f=F.start,A=F.end,A===void 0&&(A=f),"selectionStart"in _)_.selectionStart=f,_.selectionEnd=Math.min(A,_.value.length);else if(A=(f=_.ownerDocument||document)&&f.defaultView||window,A.getSelection){A=A.getSelection();var Y=_.textContent.length,re=Math.min(F.start,Y);F=F.end===void 0?re:Math.min(F.end,Y),!A.extend&&re>F&&(Y=F,F=re,re=Y),Y=Uh(_,re);var Me=Uh(_,F);Y&&Me&&(A.rangeCount!==1||A.anchorNode!==Y.node||A.anchorOffset!==Y.offset||A.focusNode!==Me.node||A.focusOffset!==Me.offset)&&(f=f.createRange(),f.setStart(Y.node,Y.offset),A.removeAllRanges(),re>F?(A.addRange(f),A.extend(Me.node,Me.offset)):(f.setEnd(Me.node,Me.offset),A.addRange(f)))}}for(f=[],A=_;A=A.parentNode;)A.nodeType===1&&f.push({element:A,left:A.scrollLeft,top:A.scrollTop});for(typeof _.focus=="function"&&_.focus(),_=0;_<f.length;_++)A=f[_],A.element.scrollLeft=A.left,A.element.scrollTop=A.top}}var ys=Tr&&"documentMode"in document&&11>=document.documentMode,C=null,g=null,x=null,O=!1;function $(f,_,A){var F=A.window===A?A.document:A.nodeType===9?A:A.ownerDocument;O||C==null||C!==cs(F)||(F=C,"selectionStart"in F&&qh(F)?F={start:F.selectionStart,end:F.selectionEnd}:(F=(F.ownerDocument&&F.ownerDocument.defaultView||window).getSelection(),F={anchorNode:F.anchorNode,anchorOffset:F.anchorOffset,focusNode:F.focusNode,focusOffset:F.focusOffset}),x&&gs(x,F)||(x=F,F=Nm(g,"onSelect"),0<F.length&&(_=new Ou("onSelect","select",null,_,A),f.push({event:_,listeners:F}),_.target=C)))}function te(f,_){var A={};return A[f.toLowerCase()]=_.toLowerCase(),A["Webkit"+f]="webkit"+_,A["Moz"+f]="moz"+_,A}var he={animationend:te("Animation","AnimationEnd"),animationiteration:te("Animation","AnimationIteration"),animationstart:te("Animation","AnimationStart"),transitionrun:te("Transition","TransitionRun"),transitionstart:te("Transition","TransitionStart"),transitioncancel:te("Transition","TransitionCancel"),transitionend:te("Transition","TransitionEnd")},Te={},Be={};Tr&&(Be=document.createElement("div").style,"AnimationEvent"in window||(delete he.animationend.animation,delete he.animationiteration.animation,delete he.animationstart.animation),"TransitionEvent"in window||delete he.transitionend.transition);function et(f){if(Te[f])return Te[f];if(!he[f])return f;var _=he[f],A;for(A in _)if(_.hasOwnProperty(A)&&A in Be)return Te[f]=_[A];return f}var Dt=et("animationend"),Ht=et("animationiteration"),bn=et("animationstart"),Hn=et("transitionrun"),sr=et("transitionstart"),xr=et("transitioncancel"),Jr=et("transitionend"),Qr=new Map,xi="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function Si(f,_){Qr.set(f,_),Fn(_,[f])}var mi=[],Wa=0,_s=0;function Pl(){for(var f=Wa,_=_s=Wa=0;_<f;){var A=mi[_];mi[_++]=null;var F=mi[_];mi[_++]=null;var Y=mi[_];mi[_++]=null;var re=mi[_];if(mi[_++]=null,F!==null&&Y!==null){var Me=F.pending;Me===null?Y.next=Y:(Y.next=Me.next,Me.next=Y),F.pending=Y}re!==0&&Rl(A,Y,re)}}function au(f,_,A,F){mi[Wa++]=f,mi[Wa++]=_,mi[Wa++]=A,mi[Wa++]=F,_s|=F,f.lanes|=F,f=f.alternate,f!==null&&(f.lanes|=F)}function ou(f,_,A,F){return au(f,_,A,F),Ar(f)}function jo(f,_){return au(f,null,null,_),Ar(f)}function Rl(f,_,A){f.lanes|=A;var F=f.alternate;F!==null&&(F.lanes|=A);for(var Y=!1,re=f.return;re!==null;)re.childLanes|=A,F=re.alternate,F!==null&&(F.childLanes|=A),re.tag===22&&(f=re.stateNode,f===null||f._visibility&1||(Y=!0)),f=re,re=re.return;Y&&_!==null&&f.tag===3&&(re=f.stateNode,Y=31-za(A),re=re.hiddenUpdates,f=re[Y],f===null?re[Y]=[_]:f.push(_),_.lane=A|536870912)}function Ar(f){if(50<Pc)throw Pc=0,wd=null,Error(o(185));for(var _=f.return;_!==null;)f=_,_=f.return;return f.tag===3?f.stateNode:null}var kl={},Dl=new WeakMap;function qs(f,_){if(typeof f=="object"&&f!==null){var A=Dl.get(f);return A!==void 0?A:(_={value:f,source:_,stack:Ft(_)},Dl.set(f,_),_)}return{value:f,source:_,stack:Ft(_)}}var eh=[],Gh=0,gi=null,$h=0,vs=[],xs=0,Ru=null,su=1,lu="";function th(f,_){eh[Gh++]=$h,eh[Gh++]=gi,gi=f,$h=_}function Hh(f,_,A){vs[xs++]=su,vs[xs++]=lu,vs[xs++]=Ru,Ru=f;var F=su;f=lu;var Y=32-za(F)-1;F&=~(1<<Y),A+=1;var re=32-za(_)+Y;if(30<re){var Me=Y-Y%5;re=(F&(1<<Me)-1).toString(32),F>>=Me,Y-=Me,su=1<<32-za(_)+Y|A<<Y|F,lu=re+f}else su=1<<re|A<<Y|F,lu=f}function nh(f){f.return!==null&&(th(f,1),Hh(f,1,0))}function op(f){for(;f===gi;)gi=eh[--Gh],eh[Gh]=null,$h=eh[--Gh],eh[Gh]=null;for(;f===Ru;)Ru=vs[--xs],vs[xs]=null,lu=vs[--xs],vs[xs]=null,su=vs[--xs],vs[xs]=null}var Xi=null,ao=null,yi=!1,bs=null,sl=!1,Jf=Error(o(519));function uu(f){var _=Error(o(418,""));throw Yh(qs(_,f)),Jf}function sp(f){var _=f.stateNode,A=f.type,F=f.memoizedProps;switch(_[xe]=f,_[Ie]=F,A){case"dialog":Ei("cancel",_),Ei("close",_);break;case"iframe":case"object":case"embed":Ei("load",_);break;case"video":case"audio":for(A=0;A<zm.length;A++)Ei(zm[A],_);break;case"source":Ei("error",_);break;case"img":case"image":case"link":Ei("error",_),Ei("load",_);break;case"details":Ei("toggle",_);break;case"input":Ei("invalid",_),hs(_,F.value,F.defaultValue,F.checked,F.defaultChecked,F.type,F.name,!0),Ns(_);break;case"select":Ei("invalid",_);break;case"textarea":Ei("invalid",_),Oo(_,F.value,F.defaultValue,F.children),Ns(_)}A=F.children,typeof A!="string"&&typeof A!="number"&&typeof A!="bigint"||_.textContent===""+A||F.suppressHydrationWarning===!0||Od(_.textContent,A)?(F.popover!=null&&(Ei("beforetoggle",_),Ei("toggle",_)),F.onScroll!=null&&Ei("scroll",_),F.onScrollEnd!=null&&Ei("scrollend",_),F.onClick!=null&&(_.onclick=Dc),_=!0):_=!1,_||uu(f)}function lp(f){for(Xi=f.return;Xi;)switch(Xi.tag){case 3:case 27:sl=!0;return;case 5:case 13:sl=!1;return;default:Xi=Xi.return}}function cc(f){if(f!==Xi)return!1;if(!yi)return lp(f),yi=!0,!1;var _=!1,A;if((A=f.tag!==3&&f.tag!==27)&&((A=f.tag===5)&&(A=f.type,A=!(A!=="form"&&A!=="button")||Fm(f.type,f.memoizedProps)),A=!A),A&&(_=!0),_&&ao&&uu(f),lp(f),f.tag===13){if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(o(317));e:{for(f=f.nextSibling,_=0;f;){if(f.nodeType===8)if(A=f.data,A==="/$"){if(_===0){ao=Hu(f.nextSibling);break e}_--}else A!=="$"&&A!=="$!"&&A!=="$?"||_++;f=f.nextSibling}ao=null}}else ao=Xi?Hu(f.stateNode.nextSibling):null;return!0}function Xh(){ao=Xi=null,yi=!1}function Yh(f){bs===null?bs=[f]:bs.push(f)}var cu=Error(o(460)),Dg=Error(o(474)),gm={then:function(){}};function Lg(f){return f=f.status,f==="fulfilled"||f==="rejected"}function up(){}function zg(f,_,A){switch(A=f[A],A===void 0?f.push(_):A!==_&&(_.then(up,up),_=A),_.status){case"fulfilled":return _.value;case"rejected":throw f=_.reason,f===cu?Error(o(483)):f;default:if(typeof _.status=="string")_.then(up,up);else{if(f=Kn,f!==null&&100<f.shellSuspendCounter)throw Error(o(482));f=_,f.status="pending",f.then(function(F){if(_.status==="pending"){var Y=_;Y.status="fulfilled",Y.value=F}},function(F){if(_.status==="pending"){var Y=_;Y.status="rejected",Y.reason=F}})}switch(_.status){case"fulfilled":return _.value;case"rejected":throw f=_.reason,f===cu?Error(o(483)):f}throw Qf=_,cu}}var Qf=null;function cp(){if(Qf===null)throw Error(o(459));var f=Qf;return Qf=null,f}var hc=null,fc=0;function ku(f){var _=fc;return fc+=1,hc===null&&(hc=[]),zg(hc,f,_)}function rh(f,_){_=_.props.ref,f.ref=_!==void 0?_:null}function ed(f,_){throw _.$$typeof===b?Error(o(525)):(f=Object.prototype.toString.call(_),Error(o(31,f==="[object Object]"?"object with keys {"+Object.keys(_).join(", ")+"}":f)))}function ym(f){var _=f._init;return _(f._payload)}function hp(f){function _(Gt,Pt){if(f){var Kt=Gt.deletions;Kt===null?(Gt.deletions=[Pt],Gt.flags|=16):Kt.push(Pt)}}function A(Gt,Pt){if(!f)return null;for(;Pt!==null;)_(Gt,Pt),Pt=Pt.sibling;return null}function F(Gt){for(var Pt=new Map;Gt!==null;)Gt.key!==null?Pt.set(Gt.key,Gt):Pt.set(Gt.index,Gt),Gt=Gt.sibling;return Pt}function Y(Gt,Pt){return Gt=ln(Gt,Pt),Gt.index=0,Gt.sibling=null,Gt}function re(Gt,Pt,Kt){return Gt.index=Kt,f?(Kt=Gt.alternate,Kt!==null?(Kt=Kt.index,Kt<Pt?(Gt.flags|=33554434,Pt):Kt):(Gt.flags|=33554434,Pt)):(Gt.flags|=1048576,Pt)}function Me(Gt){return f&&Gt.alternate===null&&(Gt.flags|=33554434),Gt}function Ge(Gt,Pt,Kt,On){return Pt===null||Pt.tag!==6?(Pt=wn(Kt,Gt.mode,On),Pt.return=Gt,Pt):(Pt=Y(Pt,Kt),Pt.return=Gt,Pt)}function dt(Gt,Pt,Kt,On){var fr=Kt.type;return fr===P?yn(Gt,Pt,Kt.props.children,On,Kt.key):Pt!==null&&(Pt.elementType===fr||typeof fr=="object"&&fr!==null&&fr.$$typeof===Se&&ym(fr)===Pt.type)?(Pt=Y(Pt,Kt.props),rh(Pt,Kt),Pt.return=Gt,Pt):(Pt=Ut(Kt.type,Kt.key,Kt.props,null,Gt.mode,On),rh(Pt,Kt),Pt.return=Gt,Pt)}function Nt(Gt,Pt,Kt,On){return Pt===null||Pt.tag!==4||Pt.stateNode.containerInfo!==Kt.containerInfo||Pt.stateNode.implementation!==Kt.implementation?(Pt=Cn(Kt,Gt.mode,On),Pt.return=Gt,Pt):(Pt=Y(Pt,Kt.children||[]),Pt.return=Gt,Pt)}function yn(Gt,Pt,Kt,On,fr){return Pt===null||Pt.tag!==7?(Pt=tn(Kt,Gt.mode,On,fr),Pt.return=Gt,Pt):(Pt=Y(Pt,Kt),Pt.return=Gt,Pt)}function Dn(Gt,Pt,Kt){if(typeof Pt=="string"&&Pt!==""||typeof Pt=="number"||typeof Pt=="bigint")return Pt=wn(""+Pt,Gt.mode,Kt),Pt.return=Gt,Pt;if(typeof Pt=="object"&&Pt!==null){switch(Pt.$$typeof){case S:return Kt=Ut(Pt.type,Pt.key,Pt.props,null,Gt.mode,Kt),rh(Kt,Pt),Kt.return=Gt,Kt;case i:return Pt=Cn(Pt,Gt.mode,Kt),Pt.return=Gt,Pt;case Se:var On=Pt._init;return Pt=On(Pt._payload),Dn(Gt,Pt,Kt)}if(qt(Pt)||Ae(Pt))return Pt=tn(Pt,Gt.mode,Kt,null),Pt.return=Gt,Pt;if(typeof Pt.then=="function")return Dn(Gt,ku(Pt),Kt);if(Pt.$$typeof===ee)return Dn(Gt,Cp(Gt,Pt),Kt);ed(Gt,Pt)}return null}function rn(Gt,Pt,Kt,On){var fr=Pt!==null?Pt.key:null;if(typeof Kt=="string"&&Kt!==""||typeof Kt=="number"||typeof Kt=="bigint")return fr!==null?null:Ge(Gt,Pt,""+Kt,On);if(typeof Kt=="object"&&Kt!==null){switch(Kt.$$typeof){case S:return Kt.key===fr?dt(Gt,Pt,Kt,On):null;case i:return Kt.key===fr?Nt(Gt,Pt,Kt,On):null;case Se:return fr=Kt._init,Kt=fr(Kt._payload),rn(Gt,Pt,Kt,On)}if(qt(Kt)||Ae(Kt))return fr!==null?null:yn(Gt,Pt,Kt,On,null);if(typeof Kt.then=="function")return rn(Gt,Pt,ku(Kt),On);if(Kt.$$typeof===ee)return rn(Gt,Pt,Cp(Gt,Kt),On);ed(Gt,Kt)}return null}function gn(Gt,Pt,Kt,On,fr){if(typeof On=="string"&&On!==""||typeof On=="number"||typeof On=="bigint")return Gt=Gt.get(Kt)||null,Ge(Pt,Gt,""+On,fr);if(typeof On=="object"&&On!==null){switch(On.$$typeof){case S:return Gt=Gt.get(On.key===null?Kt:On.key)||null,dt(Pt,Gt,On,fr);case i:return Gt=Gt.get(On.key===null?Kt:On.key)||null,Nt(Pt,Gt,On,fr);case Se:var Zr=On._init;return On=Zr(On._payload),gn(Gt,Pt,Kt,On,fr)}if(qt(On)||Ae(On))return Gt=Gt.get(Kt)||null,yn(Pt,Gt,On,fr,null);if(typeof On.then=="function")return gn(Gt,Pt,Kt,ku(On),fr);if(On.$$typeof===ee)return gn(Gt,Pt,Kt,Cp(Pt,On),fr);ed(Pt,On)}return null}function br(Gt,Pt,Kt,On){for(var fr=null,Zr=null,Mr=Pt,Fr=Pt=0,ko=null;Mr!==null&&Fr<Kt.length;Fr++){Mr.index>Fr?(ko=Mr,Mr=null):ko=Mr.sibling;var Di=rn(Gt,Mr,Kt[Fr],On);if(Di===null){Mr===null&&(Mr=ko);break}f&&Mr&&Di.alternate===null&&_(Gt,Mr),Pt=re(Di,Pt,Fr),Zr===null?fr=Di:Zr.sibling=Di,Zr=Di,Mr=ko}if(Fr===Kt.length)return A(Gt,Mr),yi&&th(Gt,Fr),fr;if(Mr===null){for(;Fr<Kt.length;Fr++)Mr=Dn(Gt,Kt[Fr],On),Mr!==null&&(Pt=re(Mr,Pt,Fr),Zr===null?fr=Mr:Zr.sibling=Mr,Zr=Mr);return yi&&th(Gt,Fr),fr}for(Mr=F(Mr);Fr<Kt.length;Fr++)ko=gn(Mr,Gt,Fr,Kt[Fr],On),ko!==null&&(f&&ko.alternate!==null&&Mr.delete(ko.key===null?Fr:ko.key),Pt=re(ko,Pt,Fr),Zr===null?fr=ko:Zr.sibling=ko,Zr=ko);return f&&Mr.forEach(function(Mf){return _(Gt,Mf)}),yi&&th(Gt,Fr),fr}function ni(Gt,Pt,Kt,On){if(Kt==null)throw Error(o(151));for(var fr=null,Zr=null,Mr=Pt,Fr=Pt=0,ko=null,Di=Kt.next();Mr!==null&&!Di.done;Fr++,Di=Kt.next()){Mr.index>Fr?(ko=Mr,Mr=null):ko=Mr.sibling;var Mf=rn(Gt,Mr,Di.value,On);if(Mf===null){Mr===null&&(Mr=ko);break}f&&Mr&&Mf.alternate===null&&_(Gt,Mr),Pt=re(Mf,Pt,Fr),Zr===null?fr=Mf:Zr.sibling=Mf,Zr=Mf,Mr=ko}if(Di.done)return A(Gt,Mr),yi&&th(Gt,Fr),fr;if(Mr===null){for(;!Di.done;Fr++,Di=Kt.next())Di=Dn(Gt,Di.value,On),Di!==null&&(Pt=re(Di,Pt,Fr),Zr===null?fr=Di:Zr.sibling=Di,Zr=Di);return yi&&th(Gt,Fr),fr}for(Mr=F(Mr);!Di.done;Fr++,Di=Kt.next())Di=gn(Mr,Gt,Fr,Di.value,On),Di!==null&&(f&&Di.alternate!==null&&Mr.delete(Di.key===null?Fr:Di.key),Pt=re(Di,Pt,Fr),Zr===null?fr=Di:Zr.sibling=Di,Zr=Di);return f&&Mr.forEach(function(X2){return _(Gt,X2)}),yi&&th(Gt,Fr),fr}function ja(Gt,Pt,Kt,On){if(typeof Kt=="object"&&Kt!==null&&Kt.type===P&&Kt.key===null&&(Kt=Kt.props.children),typeof Kt=="object"&&Kt!==null){switch(Kt.$$typeof){case S:e:{for(var fr=Kt.key;Pt!==null;){if(Pt.key===fr){if(fr=Kt.type,fr===P){if(Pt.tag===7){A(Gt,Pt.sibling),On=Y(Pt,Kt.props.children),On.return=Gt,Gt=On;break e}}else if(Pt.elementType===fr||typeof fr=="object"&&fr!==null&&fr.$$typeof===Se&&ym(fr)===Pt.type){A(Gt,Pt.sibling),On=Y(Pt,Kt.props),rh(On,Kt),On.return=Gt,Gt=On;break e}A(Gt,Pt);break}else _(Gt,Pt);Pt=Pt.sibling}Kt.type===P?(On=tn(Kt.props.children,Gt.mode,On,Kt.key),On.return=Gt,Gt=On):(On=Ut(Kt.type,Kt.key,Kt.props,null,Gt.mode,On),rh(On,Kt),On.return=Gt,Gt=On)}return Me(Gt);case i:e:{for(fr=Kt.key;Pt!==null;){if(Pt.key===fr)if(Pt.tag===4&&Pt.stateNode.containerInfo===Kt.containerInfo&&Pt.stateNode.implementation===Kt.implementation){A(Gt,Pt.sibling),On=Y(Pt,Kt.children||[]),On.return=Gt,Gt=On;break e}else{A(Gt,Pt);break}else _(Gt,Pt);Pt=Pt.sibling}On=Cn(Kt,Gt.mode,On),On.return=Gt,Gt=On}return Me(Gt);case Se:return fr=Kt._init,Kt=fr(Kt._payload),ja(Gt,Pt,Kt,On)}if(qt(Kt))return br(Gt,Pt,Kt,On);if(Ae(Kt)){if(fr=Ae(Kt),typeof fr!="function")throw Error(o(150));return Kt=fr.call(Kt),ni(Gt,Pt,Kt,On)}if(typeof Kt.then=="function")return ja(Gt,Pt,ku(Kt),On);if(Kt.$$typeof===ee)return ja(Gt,Pt,Cp(Gt,Kt),On);ed(Gt,Kt)}return typeof Kt=="string"&&Kt!==""||typeof Kt=="number"||typeof Kt=="bigint"?(Kt=""+Kt,Pt!==null&&Pt.tag===6?(A(Gt,Pt.sibling),On=Y(Pt,Kt),On.return=Gt,Gt=On):(A(Gt,Pt),On=wn(Kt,Gt.mode,On),On.return=Gt,Gt=On),Me(Gt)):A(Gt,Pt)}return function(Gt,Pt,Kt,On){try{fc=0;var fr=ja(Gt,Pt,Kt,On);return hc=null,fr}catch(Mr){if(Mr===cu)throw Mr;var Zr=zt(29,Mr,null,Gt.mode);return Zr.lanes=On,Zr.return=Gt,Zr}finally{}}}var ws=hp(!0),fp=hp(!1),go=Et(null),ih=Et(0);function Zh(f,_){f=ua,Ne(ih,f),Ne(go,_),ua=f|_.baseLanes}function dp(){Ne(ih,ua),Ne(go,go.current)}function Wh(){ua=ih.current,Ln(go),Ln(ih)}var Uo=Et(null),ll=null;function dc(f){var _=f.alternate;Ne(oo,oo.current&1),Ne(Uo,f),ll===null&&(_===null||go.current!==null||_.memoizedState!==null)&&(ll=f)}function pp(f){if(f.tag===22){if(Ne(oo,oo.current),Ne(Uo,f),ll===null){var _=f.alternate;_!==null&&_.memoizedState!==null&&(ll=f)}}else Gs()}function Gs(){Ne(oo,oo.current),Ne(Uo,Uo.current)}function Du(f){Ln(Uo),ll===f&&(ll=null),Ln(oo)}var oo=Et(0);function td(f){for(var _=f;_!==null;){if(_.tag===13){var A=_.memoizedState;if(A!==null&&(A=A.dehydrated,A===null||A.data==="$?"||A.data==="$!"))return _}else if(_.tag===19&&_.memoizedProps.revealOrder!==void 0){if((_.flags&128)!==0)return _}else if(_.child!==null){_.child.return=_,_=_.child;continue}if(_===f)break;for(;_.sibling===null;){if(_.return===null||_.return===f)return null;_=_.return}_.sibling.return=_.return,_=_.sibling}return null}var Ng=typeof AbortController<"u"?AbortController:function(){var f=[],_=this.signal={aborted:!1,addEventListener:function(A,F){f.push(F)}};this.abort=function(){_.aborted=!0,f.forEach(function(A){return A()})}},mp=e.unstable_scheduleCallback,Kh=e.unstable_NormalPriority,pa={$$typeof:ee,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Jh(){return{controller:new Ng,data:new Map,refCount:0}}function Lu(f){f.refCount--,f.refCount===0&&mp(Kh,function(){f.controller.abort()})}var Qh=null,ah=0,hu=0,pc=null;function Bg(f,_){if(Qh===null){var A=Qh=[];ah=0,hu=ry(),pc={status:"pending",value:void 0,then:function(F){A.push(F)}}}return ah++,_.then(Fg,Fg),_}function Fg(){if(--ah===0&&Qh!==null){pc!==null&&(pc.status="fulfilled");var f=Qh;Qh=null,hu=0,pc=null;for(var _=0;_<f.length;_++)(0,f[_])()}}function oh(f,_){var A=[],F={status:"pending",value:null,reason:null,then:function(Y){A.push(Y)}};return f.then(function(){F.status="fulfilled",F.value=_;for(var Y=0;Y<A.length;Y++)(0,A[Y])(_)},function(Y){for(F.status="rejected",F.reason=Y,Y=0;Y<A.length;Y++)(0,A[Y])(void 0)}),F}var nd=He.S;He.S=function(f,_){typeof _=="object"&&_!==null&&typeof _.then=="function"&&Bg(f,_),nd!==null&&nd(f,_)};var In=Et(null);function rd(){var f=In.current;return f!==null?f:Kn.pooledCache}function ef(f,_){_===null?Ne(In,In.current):Ne(In,_.pool)}function zu(){var f=rd();return f===null?null:{parent:pa._currentValue,pool:f}}var Ss=0,dn=null,Ni=null,Ka=null,gp=!1,Nu=!1,Bu=!1,tf=0,nf=0,mc=null,id=0;function ma(){throw Error(o(321))}function ad(f,_){if(_===null)return!1;for(var A=0;A<_.length&&A<f.length;A++)if(!Ia(f[A],_[A]))return!1;return!0}function ul(f,_,A,F,Y,re){return Ss=re,dn=_,_.memoizedState=null,_.updateQueue=null,_.lanes=0,He.H=f===null||f.memoizedState===null?Nl:es,Bu=!1,re=A(F,Y),Bu=!1,Nu&&(re=Fu(_,A,F,Y)),Qo(f),re}function Qo(f){He.H=fl;var _=Ni!==null&&Ni.next!==null;if(Ss=0,Ka=Ni=dn=null,gp=!1,nf=0,mc=null,_)throw Error(o(300));f===null||lo||(f=f.dependencies,f!==null&&gu(f)&&(lo=!0))}function Fu(f,_,A,F){dn=f;var Y=0;do{if(Nu&&(mc=null),nf=0,Nu=!1,25<=Y)throw Error(o(301));if(Y+=1,Ka=Ni=null,f.updateQueue!=null){var re=f.updateQueue;re.lastEffect=null,re.events=null,re.stores=null,re.memoCache!=null&&(re.memoCache.index=0)}He.H=pu,re=_(A,F)}while(Nu);return re}function _m(){var f=He.H,_=f.useState()[0];return _=typeof _.then=="function"?yc(_):_,f=f.useState()[0],(Ni!==null?Ni.memoizedState:null)!==f&&(dn.flags|=1024),_}function od(){var f=tf!==0;return tf=0,f}function gc(f,_,A){_.updateQueue=f.updateQueue,_.flags&=-2053,f.lanes&=~A}function rf(f){if(gp){for(f=f.memoizedState;f!==null;){var _=f.queue;_!==null&&(_.pending=null),f=f.next}gp=!1}Ss=0,Ka=Ni=dn=null,Nu=!1,nf=tf=0,mc=null}function yo(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ka===null?dn.memoizedState=Ka=f:Ka=Ka.next=f,Ka}function Ii(){if(Ni===null){var f=dn.alternate;f=f!==null?f.memoizedState:null}else f=Ni.next;var _=Ka===null?dn.memoizedState:Ka.next;if(_!==null)Ka=_,Ni=f;else{if(f===null)throw dn.alternate===null?Error(o(467)):Error(o(310));Ni=f,f={memoizedState:Ni.memoizedState,baseState:Ni.baseState,baseQueue:Ni.baseQueue,queue:Ni.queue,next:null},Ka===null?dn.memoizedState=Ka=f:Ka=Ka.next=f}return Ka}var ci;ci=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function yc(f){var _=nf;return nf+=1,mc===null&&(mc=[]),f=zg(mc,f,_),_=dn,(Ka===null?_.memoizedState:Ka.next)===null&&(_=_.alternate,He.H=_===null||_.memoizedState===null?Nl:es),f}function _c(f){if(f!==null&&typeof f=="object"){if(typeof f.then=="function")return yc(f);if(f.$$typeof===ee)return Vo(f)}throw Error(o(438,String(f)))}function af(f){var _=null,A=dn.updateQueue;if(A!==null&&(_=A.memoCache),_==null){var F=dn.alternate;F!==null&&(F=F.updateQueue,F!==null&&(F=F.memoCache,F!=null&&(_={data:F.data.map(function(Y){return Y.slice()}),index:0})))}if(_==null&&(_={data:[],index:0}),A===null&&(A=ci(),dn.updateQueue=A),A.memoCache=_,A=_.data[_.index],A===void 0)for(A=_.data[_.index]=Array(f),F=0;F<f;F++)A[F]=Ee;return _.index++,A}function Ll(f,_){return typeof _=="function"?_(f):_}function vc(f){var _=Ii();return xc(_,Ni,f)}function xc(f,_,A){var F=f.queue;if(F===null)throw Error(o(311));F.lastRenderedReducer=A;var Y=f.baseQueue,re=F.pending;if(re!==null){if(Y!==null){var Me=Y.next;Y.next=re.next,re.next=Me}_.baseQueue=Y=re,F.pending=null}if(re=f.baseState,Y===null)f.memoizedState=re;else{_=Y.next;var Ge=Me=null,dt=null,Nt=_,yn=!1;do{var Dn=Nt.lane&-536870913;if(Dn!==Nt.lane?(Jn&Dn)===Dn:(Ss&Dn)===Dn){var rn=Nt.revertLane;if(rn===0)dt!==null&&(dt=dt.next={lane:0,revertLane:0,action:Nt.action,hasEagerState:Nt.hasEagerState,eagerState:Nt.eagerState,next:null}),Dn===hu&&(yn=!0);else if((Ss&rn)===rn){Nt=Nt.next,rn===hu&&(yn=!0);continue}else Dn={lane:0,revertLane:Nt.revertLane,action:Nt.action,hasEagerState:Nt.hasEagerState,eagerState:Nt.eagerState,next:null},dt===null?(Ge=dt=Dn,Me=re):dt=dt.next=Dn,dn.lanes|=rn,ti|=rn;Dn=Nt.action,Bu&&A(re,Dn),re=Nt.hasEagerState?Nt.eagerState:A(re,Dn)}else rn={lane:Dn,revertLane:Nt.revertLane,action:Nt.action,hasEagerState:Nt.hasEagerState,eagerState:Nt.eagerState,next:null},dt===null?(Ge=dt=rn,Me=re):dt=dt.next=rn,dn.lanes|=Dn,ti|=Dn;Nt=Nt.next}while(Nt!==null&&Nt!==_);if(dt===null?Me=re:dt.next=Ge,!Ia(re,f.memoizedState)&&(lo=!0,yn&&(A=pc,A!==null)))throw A;f.memoizedState=re,f.baseState=Me,f.baseQueue=dt,F.lastRenderedState=re}return Y===null&&(F.lanes=0),[f.memoizedState,F.dispatch]}function bc(f){var _=Ii(),A=_.queue;if(A===null)throw Error(o(311));A.lastRenderedReducer=f;var F=A.dispatch,Y=A.pending,re=_.memoizedState;if(Y!==null){A.pending=null;var Me=Y=Y.next;do re=f(re,Me.action),Me=Me.next;while(Me!==Y);Ia(re,_.memoizedState)||(lo=!0),_.memoizedState=re,_.baseQueue===null&&(_.baseState=re),A.lastRenderedState=re}return[re,F]}function sh(f,_,A){var F=dn,Y=Ii(),re=yi;if(re){if(A===void 0)throw Error(o(407));A=A()}else A=_();var Me=!Ia((Ni||Y).memoizedState,A);if(Me&&(Y.memoizedState=A,lo=!0),Y=Y.queue,Ca(lh.bind(null,F,Y,f),[f]),Y.getSnapshot!==_||Me||Ka!==null&&Ka.memoizedState.tag&1){if(F.flags|=2048,cl(9,En.bind(null,F,Y,A,_),{destroy:void 0},null),Kn===null)throw Error(o(349));re||(Ss&60)!==0||sn(F,_,A)}return A}function sn(f,_,A){f.flags|=16384,f={getSnapshot:_,value:A},_=dn.updateQueue,_===null?(_=ci(),dn.updateQueue=_,_.stores=[f]):(A=_.stores,A===null?_.stores=[f]:A.push(f))}function En(f,_,A,F){_.value=A,_.getSnapshot=F,Bi(_)&&_t(f)}function lh(f,_,A){return A(function(){Bi(_)&&_t(f)})}function Bi(f){var _=f.getSnapshot;f=f.value;try{var A=_();return!Ia(f,A)}catch{return!0}}function _t(f){var _=jo(f,2);_!==null&&Js(_,f,2)}function yp(f){var _=yo();if(typeof f=="function"){var A=f;if(f=A(),Bu){Sa(!0);try{A()}finally{Sa(!1)}}}return _.memoizedState=_.baseState=f,_.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ll,lastRenderedState:f},_}function sd(f,_,A,F){return f.baseState=A,xc(f,Ni,typeof F=="function"?F:Ll)}function vm(f,_,A,F,Y){if(uf(f))throw Error(o(485));if(f=_.action,f!==null){var re={payload:Y,action:f,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Me){re.listeners.push(Me)}};He.T!==null?A(!0):re.isTransition=!1,F(re),A=_.pending,A===null?(re.next=_.pending=re,xm(_,re)):(re.next=A.next,_.pending=A.next=re)}}function xm(f,_){var A=_.action,F=_.payload,Y=f.state;if(_.isTransition){var re=He.T,Me={};He.T=Me;try{var Ge=A(Y,F),dt=He.S;dt!==null&&dt(Me,Ge),bm(f,_,Ge)}catch(Nt){wc(f,_,Nt)}finally{He.T=re}}else try{re=A(Y,F),bm(f,_,re)}catch(Nt){wc(f,_,Nt)}}function bm(f,_,A){A!==null&&typeof A=="object"&&typeof A.then=="function"?A.then(function(F){wm(f,_,F)},function(F){return wc(f,_,F)}):wm(f,_,A)}function wm(f,_,A){_.status="fulfilled",_.value=A,jg(_),f.state=A,_=f.pending,_!==null&&(A=_.next,A===_?f.pending=null:(A=A.next,_.next=A,xm(f,A)))}function wc(f,_,A){var F=f.pending;if(f.pending=null,F!==null){F=F.next;do _.status="rejected",_.reason=A,jg(_),_=_.next;while(_!==F)}f.action=null}function jg(f){f=f.listeners;for(var _=0;_<f.length;_++)(0,f[_])()}function Ug(f,_){return _}function Sm(f,_){if(yi){var A=Kn.formState;if(A!==null){e:{var F=dn;if(yi){if(ao){t:{for(var Y=ao,re=sl;Y.nodeType!==8;){if(!re){Y=null;break t}if(Y=Hu(Y.nextSibling),Y===null){Y=null;break t}}re=Y.data,Y=re==="F!"||re==="F"?Y:null}if(Y){ao=Hu(Y.nextSibling),F=Y.data==="F!";break e}}uu(F)}F=!1}F&&(_=A[0])}}return A=yo(),A.memoizedState=A.baseState=_,F={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ug,lastRenderedState:_},A.queue=F,A=bp.bind(null,dn,F),F.dispatch=A,F=yp(!1),re=dd.bind(null,dn,!1,F.queue),F=yo(),Y={state:_,dispatch:null,action:f,pending:null},F.queue=Y,A=vm.bind(null,dn,Y,re,A),Y.dispatch=A,F.memoizedState=f,[_,A,!1]}function ld(f){var _=Ii();return ju(_,Ni,f)}function ju(f,_,A){_=xc(f,_,Ug)[0],f=vc(Ll)[0],_=typeof _=="object"&&_!==null&&typeof _.then=="function"?yc(_):_;var F=Ii(),Y=F.queue,re=Y.dispatch;return A!==F.memoizedState&&(dn.flags|=2048,cl(9,Tm.bind(null,Y,A),{destroy:void 0},null)),[_,re,f]}function Tm(f,_){f.action=_}function _p(f){var _=Ii(),A=Ni;if(A!==null)return ju(_,A,f);Ii(),_=_.memoizedState,A=Ii();var F=A.queue.dispatch;return A.memoizedState=f,[_,F,!1]}function cl(f,_,A,F){return f={tag:f,create:_,inst:A,deps:F,next:null},_=dn.updateQueue,_===null&&(_=ci(),dn.updateQueue=_),A=_.lastEffect,A===null?_.lastEffect=f.next=f:(F=A.next,A.next=f,f.next=F,_.lastEffect=f),f}function ud(){return Ii().memoizedState}function $s(f,_,A,F){var Y=yo();dn.flags|=f,Y.memoizedState=cl(1|_,A,{destroy:void 0},F===void 0?null:F)}function hl(f,_,A,F){var Y=Ii();F=F===void 0?null:F;var re=Y.memoizedState.inst;Ni!==null&&F!==null&&ad(F,Ni.memoizedState.deps)?Y.memoizedState=cl(_,A,re,F):(dn.flags|=f,Y.memoizedState=cl(1|_,A,re,F))}function Em(f,_){$s(8390656,8,f,_)}function Ca(f,_){hl(2048,8,f,_)}function Vg(f,_){return hl(4,2,f,_)}function of(f,_){return hl(4,4,f,_)}function bi(f,_){if(typeof _=="function"){f=f();var A=_(f);return function(){typeof A=="function"?A():_(null)}}if(_!=null)return f=f(),_.current=f,function(){_.current=null}}function Yr(f,_,A){A=A!=null?A.concat([f]):null,hl(4,4,bi.bind(null,_,f),A)}function vp(){}function fu(f,_){var A=Ii();_=_===void 0?null:_;var F=A.memoizedState;return _!==null&&ad(_,F[1])?F[0]:(A.memoizedState=[f,_],f)}function uh(f,_){var A=Ii();_=_===void 0?null:_;var F=A.memoizedState;if(_!==null&&ad(_,F[1]))return F[0];if(F=f(),Bu){Sa(!0);try{f()}finally{Sa(!1)}}return A.memoizedState=[F,_],F}function zl(f,_,A){return A===void 0||(Ss&1073741824)!==0?f.memoizedState=_:(f.memoizedState=A,f=Nx(),dn.lanes|=f,ti|=f,A)}function cd(f,_,A,F){return Ia(A,_)?A:go.current!==null?(f=zl(f,A,F),Ia(f,_)||(lo=!0),f):(Ss&42)===0?(lo=!0,f.memoizedState=A):(f=Nx(),dn.lanes|=f,ti|=f,_)}function sf(f,_,A,F,Y){var re=cn.p;cn.p=re!==0&&8>re?re:8;var Me=He.T,Ge={};He.T=Ge,dd(f,!1,_,A);try{var dt=Y(),Nt=He.S;if(Nt!==null&&Nt(Ge,dt),dt!==null&&typeof dt=="object"&&typeof dt.then=="function"){var yn=oh(dt,F);Ec(f,_,yn,yl(f))}else Ec(f,_,F,yl(f))}catch(Dn){Ec(f,_,{then:function(){},status:"rejected",reason:Dn},yl())}finally{cn.p=re,He.T=Me}}function du(){}function so(f,_,A,F){if(f.tag!==5)throw Error(o(476));var Y=hd(f).queue;sf(f,Y,_,rr,A===null?du:function(){return lf(f),A(F)})}function hd(f){var _=f.memoizedState;if(_!==null)return _;_={memoizedState:rr,baseState:rr,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ll,lastRenderedState:rr},next:null};var A={};return _.next={memoizedState:A,baseState:A,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ll,lastRenderedState:A},next:null},f.memoizedState=_,f=f.alternate,f!==null&&(f.memoizedState=_),_}function lf(f){var _=hd(f).next.queue;Ec(f,_,{},yl())}function fd(){return Vo(kd)}function xp(){return Ii().memoizedState}function Sc(){return Ii().memoizedState}function Am(f){for(var _=f.return;_!==null;){switch(_.tag){case 24:case 3:var A=yl();f=Ys(A);var F=qu(_,f,A);F!==null&&(Js(F,_,A),mf(F,_,A)),_={cache:Jh()},f.payload=_;return}_=_.return}}function Tc(f,_,A){var F=yl();A={lane:F,revertLane:0,action:A,hasEagerState:!1,eagerState:null,next:null},uf(f)?Ja(_,A):(A=ou(f,_,A,F),A!==null&&(Js(A,f,F),wp(A,_,F)))}function bp(f,_,A){var F=yl();Ec(f,_,A,F)}function Ec(f,_,A,F){var Y={lane:F,revertLane:0,action:A,hasEagerState:!1,eagerState:null,next:null};if(uf(f))Ja(_,Y);else{var re=f.alternate;if(f.lanes===0&&(re===null||re.lanes===0)&&(re=_.lastRenderedReducer,re!==null))try{var Me=_.lastRenderedState,Ge=re(Me,A);if(Y.hasEagerState=!0,Y.eagerState=Ge,Ia(Ge,Me))return au(f,_,Y,0),Kn===null&&Pl(),!1}catch{}finally{}if(A=ou(f,_,Y,F),A!==null)return Js(A,f,F),wp(A,_,F),!0}return!1}function dd(f,_,A,F){if(F={lane:2,revertLane:ry(),action:F,hasEagerState:!1,eagerState:null,next:null},uf(f)){if(_)throw Error(o(479))}else _=ou(f,A,F,2),_!==null&&Js(_,f,2)}function uf(f){var _=f.alternate;return f===dn||_!==null&&_===dn}function Ja(f,_){Nu=gp=!0;var A=f.pending;A===null?_.next=_:(_.next=A.next,A.next=_),f.pending=_}function wp(f,_,A){if((A&4194176)!==0){var F=_.lanes;F&=f.pendingLanes,A|=F,_.lanes=A,Eu(f,A)}}var fl={readContext:Vo,use:_c,useCallback:ma,useContext:ma,useEffect:ma,useImperativeHandle:ma,useLayoutEffect:ma,useInsertionEffect:ma,useMemo:ma,useReducer:ma,useRef:ma,useState:ma,useDebugValue:ma,useDeferredValue:ma,useTransition:ma,useSyncExternalStore:ma,useId:ma};fl.useCacheRefresh=ma,fl.useMemoCache=ma,fl.useHostTransitionStatus=ma,fl.useFormState=ma,fl.useActionState=ma,fl.useOptimistic=ma;var Nl={readContext:Vo,use:_c,useCallback:function(f,_){return yo().memoizedState=[f,_===void 0?null:_],f},useContext:Vo,useEffect:Em,useImperativeHandle:function(f,_,A){A=A!=null?A.concat([f]):null,$s(4194308,4,bi.bind(null,_,f),A)},useLayoutEffect:function(f,_){return $s(4194308,4,f,_)},useInsertionEffect:function(f,_){$s(4,2,f,_)},useMemo:function(f,_){var A=yo();_=_===void 0?null:_;var F=f();if(Bu){Sa(!0);try{f()}finally{Sa(!1)}}return A.memoizedState=[F,_],F},useReducer:function(f,_,A){var F=yo();if(A!==void 0){var Y=A(_);if(Bu){Sa(!0);try{A(_)}finally{Sa(!1)}}}else Y=_;return F.memoizedState=F.baseState=Y,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:Y},F.queue=f,f=f.dispatch=Tc.bind(null,dn,f),[F.memoizedState,f]},useRef:function(f){var _=yo();return f={current:f},_.memoizedState=f},useState:function(f){f=yp(f);var _=f.queue,A=bp.bind(null,dn,_);return _.dispatch=A,[f.memoizedState,A]},useDebugValue:vp,useDeferredValue:function(f,_){var A=yo();return zl(A,f,_)},useTransition:function(){var f=yp(!1);return f=sf.bind(null,dn,f.queue,!0,!1),yo().memoizedState=f,[!1,f]},useSyncExternalStore:function(f,_,A){var F=dn,Y=yo();if(yi){if(A===void 0)throw Error(o(407));A=A()}else{if(A=_(),Kn===null)throw Error(o(349));(Jn&60)!==0||sn(F,_,A)}Y.memoizedState=A;var re={value:A,getSnapshot:_};return Y.queue=re,Em(lh.bind(null,F,re,f),[f]),F.flags|=2048,cl(9,En.bind(null,F,re,A,_),{destroy:void 0},null),A},useId:function(){var f=yo(),_=Kn.identifierPrefix;if(yi){var A=lu,F=su;A=(F&~(1<<32-za(F)-1)).toString(32)+A,_=":"+_+"R"+A,A=tf++,0<A&&(_+="H"+A.toString(32)),_+=":"}else A=id++,_=":"+_+"r"+A.toString(32)+":";return f.memoizedState=_},useCacheRefresh:function(){return yo().memoizedState=Am.bind(null,dn)}};Nl.useMemoCache=af,Nl.useHostTransitionStatus=fd,Nl.useFormState=Sm,Nl.useActionState=Sm,Nl.useOptimistic=function(f){var _=yo();_.memoizedState=_.baseState=f;var A={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return _.queue=A,_=dd.bind(null,dn,!0,A),A.dispatch=_,[f,_]};var es={readContext:Vo,use:_c,useCallback:fu,useContext:Vo,useEffect:Ca,useImperativeHandle:Yr,useInsertionEffect:Vg,useLayoutEffect:of,useMemo:uh,useReducer:vc,useRef:ud,useState:function(){return vc(Ll)},useDebugValue:vp,useDeferredValue:function(f,_){var A=Ii();return cd(A,Ni.memoizedState,f,_)},useTransition:function(){var f=vc(Ll)[0],_=Ii().memoizedState;return[typeof f=="boolean"?f:yc(f),_]},useSyncExternalStore:sh,useId:xp};es.useCacheRefresh=Sc,es.useMemoCache=af,es.useHostTransitionStatus=fd,es.useFormState=ld,es.useActionState=ld,es.useOptimistic=function(f,_){var A=Ii();return sd(A,Ni,f,_)};var pu={readContext:Vo,use:_c,useCallback:fu,useContext:Vo,useEffect:Ca,useImperativeHandle:Yr,useInsertionEffect:Vg,useLayoutEffect:of,useMemo:uh,useReducer:bc,useRef:ud,useState:function(){return bc(Ll)},useDebugValue:vp,useDeferredValue:function(f,_){var A=Ii();return Ni===null?zl(A,f,_):cd(A,Ni.memoizedState,f,_)},useTransition:function(){var f=bc(Ll)[0],_=Ii().memoizedState;return[typeof f=="boolean"?f:yc(f),_]},useSyncExternalStore:sh,useId:xp};pu.useCacheRefresh=Sc,pu.useMemoCache=af,pu.useHostTransitionStatus=fd,pu.useFormState=_p,pu.useActionState=_p,pu.useOptimistic=function(f,_){var A=Ii();return Ni!==null?sd(A,Ni,f,_):(A.baseState=f,[f,A.queue.dispatch])};function dl(f,_,A,F){_=f.memoizedState,A=A(F,_),A=A==null?_:st({},_,A),f.memoizedState=A,f.lanes===0&&(f.updateQueue.baseState=A)}var cf={isMounted:function(f){return(f=f._reactInternals)?Zt(f)===f:!1},enqueueSetState:function(f,_,A){f=f._reactInternals;var F=yl(),Y=Ys(F);Y.payload=_,A!=null&&(Y.callback=A),_=qu(f,Y,F),_!==null&&(Js(_,f,F),mf(_,f,F))},enqueueReplaceState:function(f,_,A){f=f._reactInternals;var F=yl(),Y=Ys(F);Y.tag=1,Y.payload=_,A!=null&&(Y.callback=A),_=qu(f,Y,F),_!==null&&(Js(_,f,F),mf(_,f,F))},enqueueForceUpdate:function(f,_){f=f._reactInternals;var A=yl(),F=Ys(A);F.tag=2,_!=null&&(F.callback=_),_=qu(f,F,A),_!==null&&(Js(_,f,A),mf(_,f,A))}};function ch(f,_,A,F,Y,re,Me){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(F,re,Me):_.prototype&&_.prototype.isPureReactComponent?!gs(A,F)||!gs(Y,re):!0}function Sp(f,_,A,F){f=_.state,typeof _.componentWillReceiveProps=="function"&&_.componentWillReceiveProps(A,F),typeof _.UNSAFE_componentWillReceiveProps=="function"&&_.UNSAFE_componentWillReceiveProps(A,F),_.state!==f&&cf.enqueueReplaceState(_,_.state,null)}function Uu(f,_){var A=_;if("ref"in _){A={};for(var F in _)F!=="ref"&&(A[F]=_[F])}if(f=f.defaultProps){A===_&&(A=st({},A));for(var Y in f)A[Y]===void 0&&(A[Y]=f[Y])}return A}var Ac=typeof reportError=="function"?reportError:function(f){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var _=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof f=="object"&&f!==null&&typeof f.message=="string"?String(f.message):String(f),error:f});if(!window.dispatchEvent(_))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",f);return}console.error(f)};function hf(f){Ac(f)}function Tp(f){console.error(f)}function pd(f){Ac(f)}function md(f,_){try{var A=f.onUncaughtError;A(_.value,{componentStack:_.stack})}catch(F){setTimeout(function(){throw F})}}function Ep(f,_,A){try{var F=f.onCaughtError;F(A.value,{componentStack:A.stack,errorBoundary:_.tag===1?_.stateNode:null})}catch(Y){setTimeout(function(){throw Y})}}function hh(f,_,A){return A=Ys(A),A.tag=3,A.payload={element:null},A.callback=function(){md(f,_)},A}function Mm(f){return f=Ys(f),f.tag=3,f}function Om(f,_,A,F){var Y=A.type.getDerivedStateFromError;if(typeof Y=="function"){var re=F.value;f.payload=function(){return Y(re)},f.callback=function(){Ep(_,A,F)}}var Me=A.stateNode;Me!==null&&typeof Me.componentDidCatch=="function"&&(f.callback=function(){Ep(_,A,F),typeof Y!="function"&&(uo===null?uo=new Set([this]):uo.add(this));var Ge=F.stack;this.componentDidCatch(F.value,{componentStack:Ge!==null?Ge:""})})}function qg(f,_,A,F,Y){if(A.flags|=32768,F!==null&&typeof F=="object"&&typeof F.then=="function"){if(_=A.alternate,_!==null&&ml(_,A,Y,!0),A=Uo.current,A!==null){switch(A.tag){case 13:return ll===null?Sd():A.alternate===null&&zr===0&&(zr=3),A.flags&=-257,A.flags|=65536,A.lanes=Y,F===gm?A.flags|=16384:(_=A.updateQueue,_===null?A.updateQueue=new Set([F]):_.add(F),vf(f,F,Y)),!1;case 22:return A.flags|=65536,F===gm?A.flags|=16384:(_=A.updateQueue,_===null?(_={transitions:null,markerInstances:null,retryQueue:new Set([F])},A.updateQueue=_):(A=_.retryQueue,A===null?_.retryQueue=new Set([F]):A.add(F)),vf(f,F,Y)),!1}throw Error(o(435,A.tag))}return vf(f,F,Y),Sd(),!1}if(yi)return _=Uo.current,_!==null?((_.flags&65536)===0&&(_.flags|=256),_.flags|=65536,_.lanes=Y,F!==Jf&&(f=Error(o(422),{cause:F}),Yh(qs(f,A)))):(F!==Jf&&(_=Error(o(423),{cause:F}),Yh(qs(_,A))),f=f.current.alternate,f.flags|=65536,Y&=-Y,f.lanes|=Y,F=qs(F,A),Y=hh(f.stateNode,F,Y),Oc(f,Y),zr!==4&&(zr=2)),!1;var re=Error(o(520),{cause:F});if(re=qs(re,A),ii===null?ii=[re]:ii.push(re),zr!==4&&(zr=2),_===null)return!0;F=qs(F,A),A=_;do{switch(A.tag){case 3:return A.flags|=65536,f=Y&-Y,A.lanes|=f,f=hh(A.stateNode,F,f),Oc(A,f),!1;case 1:if(_=A.type,re=A.stateNode,(A.flags&128)===0&&(typeof _.getDerivedStateFromError=="function"||re!==null&&typeof re.componentDidCatch=="function"&&(uo===null||!uo.has(re))))return A.flags|=65536,Y&=-Y,A.lanes|=Y,Y=Mm(Y),Om(Y,f,A,F),Oc(A,Y),!1}A=A.return}while(A!==null);return!1}var Im=Error(o(461)),lo=!1;function Fa(f,_,A,F){_.child=f===null?fp(_,null,A,F):ws(_,f.child,A,F)}function ff(f,_,A,F,Y){A=A.render;var re=_.ref;if("ref"in F){var Me={};for(var Ge in F)Ge!=="ref"&&(Me[Ge]=F[Ge])}else Me=F;return Es(_),F=ul(f,_,A,Me,re,Y),Ge=od(),f!==null&&!lo?(gc(f,_,Y),mu(f,_,Y)):(yi&&Ge&&nh(_),_.flags|=1,Fa(f,_,F,Y),_.child)}function ts(f,_,A,F,Y){if(f===null){var re=A.type;return typeof re=="function"&&!Mt(re)&&re.defaultProps===void 0&&A.compare===null?(_.tag=15,_.type=re,df(f,_,re,F,Y)):(f=Ut(A.type,null,F,_,_.mode,Y),f.ref=_.ref,f.return=_,_.child=f)}if(re=f.child,!Op(f,Y)){var Me=re.memoizedProps;if(A=A.compare,A=A!==null?A:gs,A(Me,F)&&f.ref===_.ref)return mu(f,_,Y)}return _.flags|=1,f=ln(re,F),f.ref=_.ref,f.return=_,_.child=f}function df(f,_,A,F,Y){if(f!==null){var re=f.memoizedProps;if(gs(re,F)&&f.ref===_.ref)if(lo=!1,_.pendingProps=F=re,Op(f,Y))(f.flags&131072)!==0&&(lo=!0);else return _.lanes=f.lanes,mu(f,_,Y)}return Yi(f,_,A,F,Y)}function Cm(f,_,A){var F=_.pendingProps,Y=F.children,re=(_.stateNode._pendingVisibility&2)!==0,Me=f!==null?f.memoizedState:null;if(gd(f,_),F.mode==="hidden"||re){if((_.flags&128)!==0){if(F=Me!==null?Me.baseLanes|A:A,f!==null){for(Y=_.child=f.child,re=0;Y!==null;)re=re|Y.lanes|Y.childLanes,Y=Y.sibling;_.childLanes=re&~F}else _.childLanes=0,_.child=null;return Gg(f,_,F,A)}if((A&536870912)!==0)_.memoizedState={baseLanes:0,cachePool:null},f!==null&&ef(_,Me!==null?Me.cachePool:null),Me!==null?Zh(_,Me):dp(),pp(_);else return _.lanes=_.childLanes=536870912,Gg(f,_,Me!==null?Me.baseLanes|A:A,A)}else Me!==null?(ef(_,Me.cachePool),Zh(_,Me),Gs(),_.memoizedState=null):(f!==null&&ef(_,null),dp(),Gs());return Fa(f,_,Y,A),_.child}function Gg(f,_,A,F){var Y=rd();return Y=Y===null?null:{parent:pa._currentValue,pool:Y},_.memoizedState={baseLanes:A,cachePool:Y},f!==null&&ef(_,null),dp(),pp(_),f!==null&&ml(f,_,F,!0),null}function gd(f,_){var A=_.ref;if(A===null)f!==null&&f.ref!==null&&(_.flags|=2097664);else{if(typeof A!="function"&&typeof A!="object")throw Error(o(284));(f===null||f.ref!==A)&&(_.flags|=2097664)}}function Yi(f,_,A,F,Y){return Es(_),A=ul(f,_,A,F,void 0,Y),F=od(),f!==null&&!lo?(gc(f,_,Y),mu(f,_,Y)):(yi&&F&&nh(_),_.flags|=1,Fa(f,_,A,Y),_.child)}function yd(f,_,A,F,Y,re){return Es(_),_.updateQueue=null,A=Fu(_,F,A,Y),Qo(f),F=od(),f!==null&&!lo?(gc(f,_,re),mu(f,_,re)):(yi&&F&&nh(_),_.flags|=1,Fa(f,_,A,re),_.child)}function $g(f,_,A,F,Y){if(Es(_),_.stateNode===null){var re=kl,Me=A.contextType;typeof Me=="object"&&Me!==null&&(re=Vo(Me)),re=new A(F,re),_.memoizedState=re.state!==null&&re.state!==void 0?re.state:null,re.updater=cf,_.stateNode=re,re._reactInternals=_,re=_.stateNode,re.props=F,re.state=_.memoizedState,re.refs={},Pp(_),Me=A.contextType,re.context=typeof Me=="object"&&Me!==null?Vo(Me):kl,re.state=_.memoizedState,Me=A.getDerivedStateFromProps,typeof Me=="function"&&(dl(_,A,Me,F),re.state=_.memoizedState),typeof A.getDerivedStateFromProps=="function"||typeof re.getSnapshotBeforeUpdate=="function"||typeof re.UNSAFE_componentWillMount!="function"&&typeof re.componentWillMount!="function"||(Me=re.state,typeof re.componentWillMount=="function"&&re.componentWillMount(),typeof re.UNSAFE_componentWillMount=="function"&&re.UNSAFE_componentWillMount(),Me!==re.state&&cf.enqueueReplaceState(re,re.state,null),Po(_,F,re,Y),Co(),re.state=_.memoizedState),typeof re.componentDidMount=="function"&&(_.flags|=4194308),F=!0}else if(f===null){re=_.stateNode;var Ge=_.memoizedProps,dt=Uu(A,Ge);re.props=dt;var Nt=re.context,yn=A.contextType;Me=kl,typeof yn=="object"&&yn!==null&&(Me=Vo(yn));var Dn=A.getDerivedStateFromProps;yn=typeof Dn=="function"||typeof re.getSnapshotBeforeUpdate=="function",Ge=_.pendingProps!==Ge,yn||typeof re.UNSAFE_componentWillReceiveProps!="function"&&typeof re.componentWillReceiveProps!="function"||(Ge||Nt!==Me)&&Sp(_,re,F,Me),jl=!1;var rn=_.memoizedState;re.state=rn,Po(_,F,re,Y),Co(),Nt=_.memoizedState,Ge||rn!==Nt||jl?(typeof Dn=="function"&&(dl(_,A,Dn,F),Nt=_.memoizedState),(dt=jl||ch(_,A,dt,F,rn,Nt,Me))?(yn||typeof re.UNSAFE_componentWillMount!="function"&&typeof re.componentWillMount!="function"||(typeof re.componentWillMount=="function"&&re.componentWillMount(),typeof re.UNSAFE_componentWillMount=="function"&&re.UNSAFE_componentWillMount()),typeof re.componentDidMount=="function"&&(_.flags|=4194308)):(typeof re.componentDidMount=="function"&&(_.flags|=4194308),_.memoizedProps=F,_.memoizedState=Nt),re.props=F,re.state=Nt,re.context=Me,F=dt):(typeof re.componentDidMount=="function"&&(_.flags|=4194308),F=!1)}else{re=_.stateNode,_o(f,_),Me=_.memoizedProps,yn=Uu(A,Me),re.props=yn,Dn=_.pendingProps,rn=re.context,Nt=A.contextType,dt=kl,typeof Nt=="object"&&Nt!==null&&(dt=Vo(Nt)),Ge=A.getDerivedStateFromProps,(Nt=typeof Ge=="function"||typeof re.getSnapshotBeforeUpdate=="function")||typeof re.UNSAFE_componentWillReceiveProps!="function"&&typeof re.componentWillReceiveProps!="function"||(Me!==Dn||rn!==dt)&&Sp(_,re,F,dt),jl=!1,rn=_.memoizedState,re.state=rn,Po(_,F,re,Y),Co();var gn=_.memoizedState;Me!==Dn||rn!==gn||jl||f!==null&&f.dependencies!==null&&gu(f.dependencies)?(typeof Ge=="function"&&(dl(_,A,Ge,F),gn=_.memoizedState),(yn=jl||ch(_,A,yn,F,rn,gn,dt)||f!==null&&f.dependencies!==null&&gu(f.dependencies))?(Nt||typeof re.UNSAFE_componentWillUpdate!="function"&&typeof re.componentWillUpdate!="function"||(typeof re.componentWillUpdate=="function"&&re.componentWillUpdate(F,gn,dt),typeof re.UNSAFE_componentWillUpdate=="function"&&re.UNSAFE_componentWillUpdate(F,gn,dt)),typeof re.componentDidUpdate=="function"&&(_.flags|=4),typeof re.getSnapshotBeforeUpdate=="function"&&(_.flags|=1024)):(typeof re.componentDidUpdate!="function"||Me===f.memoizedProps&&rn===f.memoizedState||(_.flags|=4),typeof re.getSnapshotBeforeUpdate!="function"||Me===f.memoizedProps&&rn===f.memoizedState||(_.flags|=1024),_.memoizedProps=F,_.memoizedState=gn),re.props=F,re.state=gn,re.context=dt,F=yn):(typeof re.componentDidUpdate!="function"||Me===f.memoizedProps&&rn===f.memoizedState||(_.flags|=4),typeof re.getSnapshotBeforeUpdate!="function"||Me===f.memoizedProps&&rn===f.memoizedState||(_.flags|=1024),F=!1)}return re=F,gd(f,_),F=(_.flags&128)!==0,re||F?(re=_.stateNode,A=F&&typeof A.getDerivedStateFromError!="function"?null:re.render(),_.flags|=1,f!==null&&F?(_.child=ws(_,f.child,null,Y),_.child=ws(_,null,A,Y)):Fa(f,_,A,Y),_.memoizedState=re.state,f=_.child):f=mu(f,_,Y),f}function Ap(f,_,A,F){return Xh(),_.flags|=256,Fa(f,_,A,F),_.child}var fh={dehydrated:null,treeContext:null,retryLane:0};function Mp(f){return{baseLanes:f,cachePool:zu()}}function dh(f,_,A){return f=f!==null?f.childLanes&~A:0,_&&(f|=fi),f}function _d(f,_,A){var F=_.pendingProps,Y=!1,re=(_.flags&128)!==0,Me;if((Me=re)||(Me=f!==null&&f.memoizedState===null?!1:(oo.current&2)!==0),Me&&(Y=!0,_.flags&=-129),Me=(_.flags&32)!==0,_.flags&=-33,f===null){if(yi){if(Y?dc(_):Gs(),yi){var Ge=ao,dt;if(dt=Ge){e:{for(dt=Ge,Ge=sl;dt.nodeType!==8;){if(!Ge){Ge=null;break e}if(dt=Hu(dt.nextSibling),dt===null){Ge=null;break e}}Ge=dt}Ge!==null?(_.memoizedState={dehydrated:Ge,treeContext:Ru!==null?{id:su,overflow:lu}:null,retryLane:536870912},dt=zt(18,null,null,0),dt.stateNode=Ge,dt.return=_,_.child=dt,Xi=_,ao=null,dt=!0):dt=!1}dt||uu(_)}if(Ge=_.memoizedState,Ge!==null&&(Ge=Ge.dehydrated,Ge!==null))return Ge.data==="$!"?_.lanes=16:_.lanes=536870912,null;Du(_)}return Ge=F.children,F=F.fallback,Y?(Gs(),Y=_.mode,Ge=ph({mode:"hidden",children:Ge},Y),F=tn(F,Y,A,null),Ge.return=_,F.return=_,Ge.sibling=F,_.child=Ge,Y=_.child,Y.memoizedState=Mp(A),Y.childLanes=dh(f,Me,A),_.memoizedState=fh,F):(dc(_),pl(_,Ge))}if(dt=f.memoizedState,dt!==null&&(Ge=dt.dehydrated,Ge!==null)){if(re)_.flags&256?(dc(_),_.flags&=-257,_=na(f,_,A)):_.memoizedState!==null?(Gs(),_.child=f.child,_.flags|=128,_=null):(Gs(),Y=F.fallback,Ge=_.mode,F=ph({mode:"visible",children:F.children},Ge),Y=tn(Y,Ge,A,null),Y.flags|=2,F.return=_,Y.return=_,F.sibling=Y,_.child=F,ws(_,f.child,null,A),F=_.child,F.memoizedState=Mp(A),F.childLanes=dh(f,Me,A),_.memoizedState=fh,_=Y);else if(dc(_),Ge.data==="$!"){if(Me=Ge.nextSibling&&Ge.nextSibling.dataset,Me)var Nt=Me.dgst;Me=Nt,F=Error(o(419)),F.stack="",F.digest=Me,Yh({value:F,source:null,stack:null}),_=na(f,_,A)}else if(lo||ml(f,_,A,!1),Me=(A&f.childLanes)!==0,lo||Me){if(Me=Kn,Me!==null){if(F=A&-A,(F&42)!==0)F=1;else switch(F){case 2:F=1;break;case 8:F=4;break;case 32:F=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:F=64;break;case 268435456:F=134217728;break;default:F=0}if(F=(F&(Me.suspendedLanes|A))!==0?0:F,F!==0&&F!==dt.retryLane)throw dt.retryLane=F,jo(f,F),Js(Me,f,F),Im}Ge.data==="$?"||Sd(),_=na(f,_,A)}else Ge.data==="$?"?(_.flags|=128,_.child=f.child,_=Kg.bind(null,f),Ge._reactRetry=_,_=null):(f=dt.treeContext,ao=Hu(Ge.nextSibling),Xi=_,yi=!0,bs=null,sl=!1,f!==null&&(vs[xs++]=su,vs[xs++]=lu,vs[xs++]=Ru,su=f.id,lu=f.overflow,Ru=_),_=pl(_,F.children),_.flags|=4096);return _}return Y?(Gs(),Y=F.fallback,Ge=_.mode,dt=f.child,Nt=dt.sibling,F=ln(dt,{mode:"hidden",children:F.children}),F.subtreeFlags=dt.subtreeFlags&31457280,Nt!==null?Y=ln(Nt,Y):(Y=tn(Y,Ge,A,null),Y.flags|=2),Y.return=_,F.return=_,F.sibling=Y,_.child=F,F=Y,Y=_.child,Ge=f.child.memoizedState,Ge===null?Ge=Mp(A):(dt=Ge.cachePool,dt!==null?(Nt=pa._currentValue,dt=dt.parent!==Nt?{parent:Nt,pool:Nt}:dt):dt=zu(),Ge={baseLanes:Ge.baseLanes|A,cachePool:dt}),Y.memoizedState=Ge,Y.childLanes=dh(f,Me,A),_.memoizedState=fh,F):(dc(_),A=f.child,f=A.sibling,A=ln(A,{mode:"visible",children:F.children}),A.return=_,A.sibling=null,f!==null&&(Me=_.deletions,Me===null?(_.deletions=[f],_.flags|=16):Me.push(f)),_.child=A,_.memoizedState=null,A)}function pl(f,_){return _=ph({mode:"visible",children:_},f.mode),_.return=f,f.child=_}function ph(f,_){return fn(f,_,0,null)}function na(f,_,A){return ws(_,f.child,null,A),f=pl(_,_.pendingProps.children),f.flags|=2,_.memoizedState=null,f}function Hs(f,_,A){f.lanes|=_;var F=f.alternate;F!==null&&(F.lanes|=_),Fl(f.return,_,A)}function Mc(f,_,A,F,Y){var re=f.memoizedState;re===null?f.memoizedState={isBackwards:_,rendering:null,renderingStartTime:0,last:F,tail:A,tailMode:Y}:(re.isBackwards=_,re.rendering=null,re.renderingStartTime=0,re.last=F,re.tail=A,re.tailMode=Y)}function pf(f,_,A){var F=_.pendingProps,Y=F.revealOrder,re=F.tail;if(Fa(f,_,F.children,A),F=oo.current,(F&2)!==0)F=F&1|2,_.flags|=128;else{if(f!==null&&(f.flags&128)!==0)e:for(f=_.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&Hs(f,A,_);else if(f.tag===19)Hs(f,A,_);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===_)break e;for(;f.sibling===null;){if(f.return===null||f.return===_)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}F&=1}switch(Ne(oo,F),Y){case"forwards":for(A=_.child,Y=null;A!==null;)f=A.alternate,f!==null&&td(f)===null&&(Y=A),A=A.sibling;A=Y,A===null?(Y=_.child,_.child=null):(Y=A.sibling,A.sibling=null),Mc(_,!1,Y,A,re);break;case"backwards":for(A=null,Y=_.child,_.child=null;Y!==null;){if(f=Y.alternate,f!==null&&td(f)===null){_.child=Y;break}f=Y.sibling,Y.sibling=A,A=Y,Y=f}Mc(_,!0,A,null,re);break;case"together":Mc(_,!1,null,null,void 0);break;default:_.memoizedState=null}return _.child}function mu(f,_,A){if(f!==null&&(_.dependencies=f.dependencies),ti|=_.lanes,(A&_.childLanes)===0)if(f!==null){if(ml(f,_,A,!1),(A&_.childLanes)===0)return null}else return null;if(f!==null&&_.child!==f.child)throw Error(o(153));if(_.child!==null){for(f=_.child,A=ln(f,f.pendingProps),_.child=A,A.return=_;f.sibling!==null;)f=f.sibling,A=A.sibling=ln(f,f.pendingProps),A.return=_;A.sibling=null}return _.child}function Op(f,_){return(f.lanes&_)!==0?!0:(f=f.dependencies,!!(f!==null&&gu(f)))}function vd(f,_,A){switch(_.tag){case 3:Ur(_,_.stateNode.containerInfo),Ts(_,pa,f.memoizedState.cache),Xh();break;case 27:case 5:Qi(_);break;case 4:Ur(_,_.stateNode.containerInfo);break;case 10:Ts(_,_.type,_.memoizedProps.value);break;case 13:var F=_.memoizedState;if(F!==null)return F.dehydrated!==null?(dc(_),_.flags|=128,null):(A&_.child.childLanes)!==0?_d(f,_,A):(dc(_),f=mu(f,_,A),f!==null?f.sibling:null);dc(_);break;case 19:var Y=(f.flags&128)!==0;if(F=(A&_.childLanes)!==0,F||(ml(f,_,A,!1),F=(A&_.childLanes)!==0),Y){if(F)return pf(f,_,A);_.flags|=128}if(Y=_.memoizedState,Y!==null&&(Y.rendering=null,Y.tail=null,Y.lastEffect=null),Ne(oo,oo.current),F)break;return null;case 22:case 23:return _.lanes=0,Cm(f,_,A);case 24:Ts(_,pa,f.memoizedState.cache)}return mu(f,_,A)}function Ip(f,_,A){if(f!==null)if(f.memoizedProps!==_.pendingProps)lo=!0;else{if(!Op(f,A)&&(_.flags&128)===0)return lo=!1,vd(f,_,A);lo=(f.flags&131072)!==0}else lo=!1,yi&&(_.flags&1048576)!==0&&Hh(_,$h,_.index);switch(_.lanes=0,_.tag){case 16:e:{f=_.pendingProps;var F=_.elementType,Y=F._init;if(F=Y(F._payload),_.type=F,typeof F=="function")Mt(F)?(f=Uu(F,f),_.tag=1,_=$g(null,_,F,f,A)):(_.tag=0,_=Yi(null,_,F,f,A));else{if(F!=null){if(Y=F.$$typeof,Y===ie){_.tag=11,_=ff(null,_,F,f,A);break e}else if(Y===ge){_.tag=14,_=ts(null,_,F,f,A);break e}}throw _=Ye(F)||F,Error(o(306,_,""))}}return _;case 0:return Yi(f,_,_.type,_.pendingProps,A);case 1:return F=_.type,Y=Uu(F,_.pendingProps),$g(f,_,F,Y,A);case 3:e:{if(Ur(_,_.stateNode.containerInfo),f===null)throw Error(o(387));var re=_.pendingProps;Y=_.memoizedState,F=Y.element,_o(f,_),Po(_,re,null,A);var Me=_.memoizedState;if(re=Me.cache,Ts(_,pa,re),re!==Y.cache&&Xs(_,[pa],A,!0),Co(),re=Me.element,Y.isDehydrated)if(Y={element:re,isDehydrated:!1,cache:Me.cache},_.updateQueue.baseState=Y,_.memoizedState=Y,_.flags&256){_=Ap(f,_,re,A);break e}else if(re!==F){F=qs(Error(o(424)),_),Yh(F),_=Ap(f,_,re,A);break e}else for(ao=Hu(_.stateNode.containerInfo.firstChild),Xi=_,yi=!0,bs=null,sl=!0,A=fp(_,null,re,A),_.child=A;A;)A.flags=A.flags&-3|4096,A=A.sibling;else{if(Xh(),re===F){_=mu(f,_,A);break e}Fa(f,_,re,A)}_=_.child}return _;case 26:return gd(f,_),f===null?(A=sv(_.type,null,_.pendingProps,null))?_.memoizedState=A:yi||(A=_.type,f=_.pendingProps,F=Id(jr.current).createElement(A),F[xe]=_,F[Ie]=f,Ho(F,A,f),Rn(F),_.stateNode=F):_.memoizedState=sv(_.type,f.memoizedProps,_.pendingProps,f.memoizedState),null;case 27:return Qi(_),f===null&&yi&&(F=_.stateNode=av(_.type,_.pendingProps,jr.current),Xi=_,sl=!0,ao=Hu(F.firstChild)),F=_.pendingProps.children,f!==null||yi?Fa(f,_,F,A):_.child=ws(_,null,F,A),gd(f,_),_.child;case 5:return f===null&&yi&&((Y=F=ao)&&(F=L2(F,_.type,_.pendingProps,sl),F!==null?(_.stateNode=F,Xi=_,ao=Hu(F.firstChild),sl=!1,Y=!0):Y=!1),Y||uu(_)),Qi(_),Y=_.type,re=_.pendingProps,Me=f!==null?f.memoizedProps:null,F=re.children,Fm(Y,re)?F=null:Me!==null&&Fm(Y,Me)&&(_.flags|=32),_.memoizedState!==null&&(Y=ul(f,_,_m,null,null,A),kd._currentValue=Y),gd(f,_),Fa(f,_,F,A),_.child;case 6:return f===null&&yi&&((f=A=ao)&&(A=z2(A,_.pendingProps,sl),A!==null?(_.stateNode=A,Xi=_,ao=null,f=!0):f=!1),f||uu(_)),null;case 13:return _d(f,_,A);case 4:return Ur(_,_.stateNode.containerInfo),F=_.pendingProps,f===null?_.child=ws(_,null,F,A):Fa(f,_,F,A),_.child;case 11:return ff(f,_,_.type,_.pendingProps,A);case 7:return Fa(f,_,_.pendingProps,A),_.child;case 8:return Fa(f,_,_.pendingProps.children,A),_.child;case 12:return Fa(f,_,_.pendingProps.children,A),_.child;case 10:return F=_.pendingProps,Ts(_,_.type,F.value),Fa(f,_,F.children,A),_.child;case 9:return Y=_.type._context,F=_.pendingProps.children,Es(_),Y=Vo(Y),F=F(Y),_.flags|=1,Fa(f,_,F,A),_.child;case 14:return ts(f,_,_.type,_.pendingProps,A);case 15:return df(f,_,_.type,_.pendingProps,A);case 19:return pf(f,_,A);case 22:return Cm(f,_,A);case 24:return Es(_),F=Vo(pa),f===null?(Y=rd(),Y===null&&(Y=Kn,re=Jh(),Y.pooledCache=re,re.refCount++,re!==null&&(Y.pooledCacheLanes|=A),Y=re),_.memoizedState={parent:F,cache:Y},Pp(_),Ts(_,pa,Y)):((f.lanes&A)!==0&&(_o(f,_),Po(_,null,null,A),Co()),Y=f.memoizedState,re=_.memoizedState,Y.parent!==F?(Y={parent:F,cache:F},_.memoizedState=Y,_.lanes===0&&(_.memoizedState=_.updateQueue.baseState=Y),Ts(_,pa,F)):(F=re.cache,Ts(_,pa,F),F!==Y.cache&&Xs(_,[pa],A,!0))),Fa(f,_,_.pendingProps.children,A),_.child;case 29:throw _.pendingProps}throw Error(o(156,_.tag))}var Pm=Et(null),Vu=null,Bl=null;function Ts(f,_,A){Ne(Pm,_._currentValue),_._currentValue=A}function ns(f){f._currentValue=Pm.current,Ln(Pm)}function Fl(f,_,A){for(;f!==null;){var F=f.alternate;if((f.childLanes&_)!==_?(f.childLanes|=_,F!==null&&(F.childLanes|=_)):F!==null&&(F.childLanes&_)!==_&&(F.childLanes|=_),f===A)break;f=f.return}}function Xs(f,_,A,F){var Y=f.child;for(Y!==null&&(Y.return=f);Y!==null;){var re=Y.dependencies;if(re!==null){var Me=Y.child;re=re.firstContext;e:for(;re!==null;){var Ge=re;re=Y;for(var dt=0;dt<_.length;dt++)if(Ge.context===_[dt]){re.lanes|=A,Ge=re.alternate,Ge!==null&&(Ge.lanes|=A),Fl(re.return,A,f),F||(Me=null);break e}re=Ge.next}}else if(Y.tag===18){if(Me=Y.return,Me===null)throw Error(o(341));Me.lanes|=A,re=Me.alternate,re!==null&&(re.lanes|=A),Fl(Me,A,f),Me=null}else Me=Y.child;if(Me!==null)Me.return=Y;else for(Me=Y;Me!==null;){if(Me===f){Me=null;break}if(Y=Me.sibling,Y!==null){Y.return=Me.return,Me=Y;break}Me=Me.return}Y=Me}}function ml(f,_,A,F){f=null;for(var Y=_,re=!1;Y!==null;){if(!re){if((Y.flags&524288)!==0)re=!0;else if((Y.flags&262144)!==0)break}if(Y.tag===10){var Me=Y.alternate;if(Me===null)throw Error(o(387));if(Me=Me.memoizedProps,Me!==null){var Ge=Y.type;Ia(Y.pendingProps.value,Me.value)||(f!==null?f.push(Ge):f=[Ge])}}else if(Y===$t.current){if(Me=Y.alternate,Me===null)throw Error(o(387));Me.memoizedState.memoizedState!==Y.memoizedState.memoizedState&&(f!==null?f.push(kd):f=[kd])}Y=Y.return}f!==null&&Xs(_,f,A,F),_.flags|=262144}function gu(f){for(f=f.firstContext;f!==null;){if(!Ia(f.context._currentValue,f.memoizedValue))return!0;f=f.next}return!1}function Es(f){Vu=f,Bl=null,f=f.dependencies,f!==null&&(f.firstContext=null)}function Vo(f){return Hg(Vu,f)}function Cp(f,_){return Vu===null&&Es(f),Hg(f,_)}function Hg(f,_){var A=_._currentValue;if(_={context:_,memoizedValue:A,next:null},Bl===null){if(f===null)throw Error(o(308));Bl=_,f.dependencies={lanes:0,firstContext:_},f.flags|=524288}else Bl=Bl.next=_;return A}var jl=!1;function Pp(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function _o(f,_){f=f.updateQueue,_.updateQueue===f&&(_.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,callbacks:null})}function Ys(f){return{lane:f,tag:0,payload:null,callback:null,next:null}}function qu(f,_,A){var F=f.updateQueue;if(F===null)return null;if(F=F.shared,(Sn&2)!==0){var Y=F.pending;return Y===null?_.next=_:(_.next=Y.next,Y.next=_),F.pending=_,_=Ar(f),Rl(f,null,A),_}return au(f,F,_,A),Ar(f)}function mf(f,_,A){if(_=_.updateQueue,_!==null&&(_=_.shared,(A&4194176)!==0)){var F=_.lanes;F&=f.pendingLanes,A|=F,_.lanes=A,Eu(f,A)}}function Oc(f,_){var A=f.updateQueue,F=f.alternate;if(F!==null&&(F=F.updateQueue,A===F)){var Y=null,re=null;if(A=A.firstBaseUpdate,A!==null){do{var Me={lane:A.lane,tag:A.tag,payload:A.payload,callback:null,next:null};re===null?Y=re=Me:re=re.next=Me,A=A.next}while(A!==null);re===null?Y=re=_:re=re.next=_}else Y=re=_;A={baseState:F.baseState,firstBaseUpdate:Y,lastBaseUpdate:re,shared:F.shared,callbacks:F.callbacks},f.updateQueue=A;return}f=A.lastBaseUpdate,f===null?A.firstBaseUpdate=_:f.next=_,A.lastBaseUpdate=_}var gf=!1;function Co(){if(gf){var f=pc;if(f!==null)throw f}}function Po(f,_,A,F){gf=!1;var Y=f.updateQueue;jl=!1;var re=Y.firstBaseUpdate,Me=Y.lastBaseUpdate,Ge=Y.shared.pending;if(Ge!==null){Y.shared.pending=null;var dt=Ge,Nt=dt.next;dt.next=null,Me===null?re=Nt:Me.next=Nt,Me=dt;var yn=f.alternate;yn!==null&&(yn=yn.updateQueue,Ge=yn.lastBaseUpdate,Ge!==Me&&(Ge===null?yn.firstBaseUpdate=Nt:Ge.next=Nt,yn.lastBaseUpdate=dt))}if(re!==null){var Dn=Y.baseState;Me=0,yn=Nt=dt=null,Ge=re;do{var rn=Ge.lane&-536870913,gn=rn!==Ge.lane;if(gn?(Jn&rn)===rn:(F&rn)===rn){rn!==0&&rn===hu&&(gf=!0),yn!==null&&(yn=yn.next={lane:0,tag:Ge.tag,payload:Ge.payload,callback:null,next:null});e:{var br=f,ni=Ge;rn=_;var ja=A;switch(ni.tag){case 1:if(br=ni.payload,typeof br=="function"){Dn=br.call(ja,Dn,rn);break e}Dn=br;break e;case 3:br.flags=br.flags&-65537|128;case 0:if(br=ni.payload,rn=typeof br=="function"?br.call(ja,Dn,rn):br,rn==null)break e;Dn=st({},Dn,rn);break e;case 2:jl=!0}}rn=Ge.callback,rn!==null&&(f.flags|=64,gn&&(f.flags|=8192),gn=Y.callbacks,gn===null?Y.callbacks=[rn]:gn.push(rn))}else gn={lane:rn,tag:Ge.tag,payload:Ge.payload,callback:Ge.callback,next:null},yn===null?(Nt=yn=gn,dt=Dn):yn=yn.next=gn,Me|=rn;if(Ge=Ge.next,Ge===null){if(Ge=Y.shared.pending,Ge===null)break;gn=Ge,Ge=gn.next,gn.next=null,Y.lastBaseUpdate=gn,Y.shared.pending=null}}while(!0);yn===null&&(dt=Dn),Y.baseState=dt,Y.firstBaseUpdate=Nt,Y.lastBaseUpdate=yn,re===null&&(Y.shared.lanes=0),ti|=Me,f.lanes=Me,f.memoizedState=Dn}}function mh(f,_){if(typeof f!="function")throw Error(o(191,f));f.call(_)}function Ic(f,_){var A=f.callbacks;if(A!==null)for(f.callbacks=null,f=0;f<A.length;f++)mh(A[f],_)}function Ul(f,_){try{var A=_.updateQueue,F=A!==null?A.lastEffect:null;if(F!==null){var Y=F.next;A=Y;do{if((A.tag&f)===f){F=void 0;var re=A.create,Me=A.inst;F=re(),Me.destroy=F}A=A.next}while(A!==Y)}}catch(Ge){ca(_,_.return,Ge)}}function yu(f,_,A){try{var F=_.updateQueue,Y=F!==null?F.lastEffect:null;if(Y!==null){var re=Y.next;F=re;do{if((F.tag&f)===f){var Me=F.inst,Ge=Me.destroy;if(Ge!==void 0){Me.destroy=void 0,Y=_;var dt=A;try{Ge()}catch(Nt){ca(Y,dt,Nt)}}}F=F.next}while(F!==re)}}catch(Nt){ca(_,_.return,Nt)}}function Gr(f){var _=f.updateQueue;if(_!==null){var A=f.stateNode;try{Ic(_,A)}catch(F){ca(f,f.return,F)}}}function Gu(f,_,A){A.props=Uu(f.type,f.memoizedProps),A.state=f.memoizedState;try{A.componentWillUnmount()}catch(F){ca(f,_,F)}}function gh(f,_){try{var A=f.ref;if(A!==null){var F=f.stateNode;switch(f.tag){case 26:case 27:case 5:var Y=F;break;default:Y=F}typeof A=="function"?f.refCleanup=A(Y):A.current=Y}}catch(re){ca(f,_,re)}}function Zs(f,_){var A=f.ref,F=f.refCleanup;if(A!==null)if(typeof F=="function")try{F()}catch(Y){ca(f,_,Y)}finally{f.refCleanup=null,f=f.alternate,f!=null&&(f.refCleanup=null)}else if(typeof A=="function")try{A(null)}catch(Y){ca(f,_,Y)}else A.current=null}function xd(f){var _=f.type,A=f.memoizedProps,F=f.stateNode;try{e:switch(_){case"button":case"input":case"select":case"textarea":A.autoFocus&&F.focus();break e;case"img":A.src?F.src=A.src:A.srcSet&&(F.srcset=A.srcSet)}}catch(Y){ca(f,f.return,Y)}}function Vl(f,_,A){try{var F=f.stateNode;Zx(F,f.type,A,_),F[Ie]=_}catch(Y){ca(f,f.return,Y)}}function gl(f){return f.tag===5||f.tag===3||f.tag===26||f.tag===27||f.tag===4}function vo(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||gl(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==27&&f.tag!==18;){if(f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function qo(f,_,A){var F=f.tag;if(F===5||F===6)f=f.stateNode,_?A.nodeType===8?A.parentNode.insertBefore(f,_):A.insertBefore(f,_):(A.nodeType===8?(_=A.parentNode,_.insertBefore(f,A)):(_=A,_.appendChild(f)),A=A._reactRootContainer,A!=null||_.onclick!==null||(_.onclick=Dc));else if(F!==4&&F!==27&&(f=f.child,f!==null))for(qo(f,_,A),f=f.sibling;f!==null;)qo(f,_,A),f=f.sibling}function Pa(f,_,A){var F=f.tag;if(F===5||F===6)f=f.stateNode,_?A.insertBefore(f,_):A.appendChild(f);else if(F!==4&&F!==27&&(f=f.child,f!==null))for(Pa(f,_,A),f=f.sibling;f!==null;)Pa(f,_,A),f=f.sibling}var _u=!1,hi=!1,bd=!1,yh=typeof WeakSet=="function"?WeakSet:Set,p=null,r=!1;function l(f,_){if(f=f.containerInfo,Np=Hm,f=Vh(f),qh(f)){if("selectionStart"in f)var A={start:f.selectionStart,end:f.selectionEnd};else e:{A=(A=f.ownerDocument)&&A.defaultView||window;var F=A.getSelection&&A.getSelection();if(F&&F.rangeCount!==0){A=F.anchorNode;var Y=F.anchorOffset,re=F.focusNode;F=F.focusOffset;try{A.nodeType,re.nodeType}catch{A=null;break e}var Me=0,Ge=-1,dt=-1,Nt=0,yn=0,Dn=f,rn=null;t:for(;;){for(var gn;Dn!==A||Y!==0&&Dn.nodeType!==3||(Ge=Me+Y),Dn!==re||F!==0&&Dn.nodeType!==3||(dt=Me+F),Dn.nodeType===3&&(Me+=Dn.nodeValue.length),(gn=Dn.firstChild)!==null;)rn=Dn,Dn=gn;for(;;){if(Dn===f)break t;if(rn===A&&++Nt===Y&&(Ge=Me),rn===re&&++yn===F&&(dt=Me),(gn=Dn.nextSibling)!==null)break;Dn=rn,rn=Dn.parentNode}Dn=gn}A=Ge===-1||dt===-1?null:{start:Ge,end:dt}}else A=null}A=A||{start:0,end:0}}else A=null;for(ly={focusedElem:f,selectionRange:A},Hm=!1,p=_;p!==null;)if(_=p,f=_.child,(_.subtreeFlags&1028)!==0&&f!==null)f.return=_,p=f;else for(;p!==null;){switch(_=p,re=_.alternate,f=_.flags,_.tag){case 0:break;case 11:case 15:break;case 1:if((f&1024)!==0&&re!==null){f=void 0,A=_,Y=re.memoizedProps,re=re.memoizedState,F=A.stateNode;try{var br=Uu(A.type,Y,A.elementType===A.type);f=F.getSnapshotBeforeUpdate(br,re),F.__reactInternalSnapshotBeforeUpdate=f}catch(ni){ca(A,A.return,ni)}}break;case 3:if((f&1024)!==0){if(f=_.stateNode.containerInfo,A=f.nodeType,A===9)jm(f);else if(A===1)switch(f.nodeName){case"HEAD":case"HTML":case"BODY":jm(f);break;default:f.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((f&1024)!==0)throw Error(o(163))}if(f=_.sibling,f!==null){f.return=_.return,p=f;break}p=_.return}return br=r,r=!1,br}function m(f,_,A){var F=A.flags;switch(A.tag){case 0:case 11:case 15:_e(f,A),F&4&&Ul(5,A);break;case 1:if(_e(f,A),F&4)if(f=A.stateNode,_===null)try{f.componentDidMount()}catch(Ge){ca(A,A.return,Ge)}else{var Y=Uu(A.type,_.memoizedProps);_=_.memoizedState;try{f.componentDidUpdate(Y,_,f.__reactInternalSnapshotBeforeUpdate)}catch(Ge){ca(A,A.return,Ge)}}F&64&&Gr(A),F&512&&gh(A,A.return);break;case 3:if(_e(f,A),F&64&&(F=A.updateQueue,F!==null)){if(f=null,A.child!==null)switch(A.child.tag){case 27:case 5:f=A.child.stateNode;break;case 1:f=A.child.stateNode}try{Ic(F,f)}catch(Ge){ca(A,A.return,Ge)}}break;case 26:_e(f,A),F&512&&gh(A,A.return);break;case 27:case 5:_e(f,A),_===null&&F&4&&xd(A),F&512&&gh(A,A.return);break;case 12:_e(f,A);break;case 13:_e(f,A),F&4&&X(f,A);break;case 22:if(Y=A.memoizedState!==null||_u,!Y){_=_!==null&&_.memoizedState!==null||hi;var re=_u,Me=hi;_u=Y,(hi=_)&&!Me?ze(f,A,(A.subtreeFlags&8772)!==0):_e(f,A),_u=re,hi=Me}F&512&&(A.memoizedProps.mode==="manual"?gh(A,A.return):Zs(A,A.return));break;default:_e(f,A)}}function w(f){var _=f.alternate;_!==null&&(f.alternate=null,w(_)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(_=f.stateNode,_!==null&&gt(_)),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}var T=null,I=!1;function N(f,_,A){for(A=A.child;A!==null;)G(f,_,A),A=A.sibling}function G(f,_,A){if($a&&typeof $a.onCommitFiberUnmount=="function")try{$a.onCommitFiberUnmount(Ui,A)}catch{}switch(A.tag){case 26:hi||Zs(A,_),N(f,_,A),A.memoizedState?A.memoizedState.count--:A.stateNode&&(A=A.stateNode,A.parentNode.removeChild(A));break;case 27:hi||Zs(A,_);var F=T,Y=I;for(T=A.stateNode,N(f,_,A),A=A.stateNode,_=A.attributes;_.length;)A.removeAttributeNode(_[0]);gt(A),T=F,I=Y;break;case 5:hi||Zs(A,_);case 6:Y=T;var re=I;if(T=null,N(f,_,A),T=Y,I=re,T!==null)if(I)try{f=T,F=A.stateNode,f.nodeType===8?f.parentNode.removeChild(F):f.removeChild(F)}catch(Me){ca(A,_,Me)}else try{T.removeChild(A.stateNode)}catch(Me){ca(A,_,Me)}break;case 18:T!==null&&(I?(_=T,A=A.stateNode,_.nodeType===8?hy(_.parentNode,A):_.nodeType===1&&hy(_,A),Zm(_)):hy(T,A.stateNode));break;case 4:F=T,Y=I,T=A.stateNode.containerInfo,I=!0,N(f,_,A),T=F,I=Y;break;case 0:case 11:case 14:case 15:hi||yu(2,A,_),hi||yu(4,A,_),N(f,_,A);break;case 1:hi||(Zs(A,_),F=A.stateNode,typeof F.componentWillUnmount=="function"&&Gu(A,_,F)),N(f,_,A);break;case 21:N(f,_,A);break;case 22:hi||Zs(A,_),hi=(F=hi)||A.memoizedState!==null,N(f,_,A),hi=F;break;default:N(f,_,A)}}function X(f,_){if(_.memoizedState===null&&(f=_.alternate,f!==null&&(f=f.memoizedState,f!==null&&(f=f.dehydrated,f!==null))))try{Zm(f)}catch(A){ca(_,_.return,A)}}function Z(f){switch(f.tag){case 13:case 19:var _=f.stateNode;return _===null&&(_=f.stateNode=new yh),_;case 22:return f=f.stateNode,_=f._retryCache,_===null&&(_=f._retryCache=new yh),_;default:throw Error(o(435,f.tag))}}function J(f,_){var A=Z(f);_.forEach(function(F){var Y=qx.bind(null,f,F);A.has(F)||(A.add(F),F.then(Y,Y))})}function Q(f,_){var A=_.deletions;if(A!==null)for(var F=0;F<A.length;F++){var Y=A[F],re=f,Me=_,Ge=Me;e:for(;Ge!==null;){switch(Ge.tag){case 27:case 5:T=Ge.stateNode,I=!1;break e;case 3:T=Ge.stateNode.containerInfo,I=!0;break e;case 4:T=Ge.stateNode.containerInfo,I=!0;break e}Ge=Ge.return}if(T===null)throw Error(o(160));G(re,Me,Y),T=null,I=!1,re=Y.alternate,re!==null&&(re.return=null),Y.return=null}if(_.subtreeFlags&13878)for(_=_.child;_!==null;)ye(_,f),_=_.sibling}var ae=null;function ye(f,_){var A=f.alternate,F=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:Q(_,f),fe(f),F&4&&(yu(3,f,f.return),Ul(3,f),yu(5,f,f.return));break;case 1:Q(_,f),fe(f),F&512&&(hi||A===null||Zs(A,A.return)),F&64&&_u&&(f=f.updateQueue,f!==null&&(F=f.callbacks,F!==null&&(A=f.shared.hiddenCallbacks,f.shared.hiddenCallbacks=A===null?F:A.concat(F))));break;case 26:var Y=ae;if(Q(_,f),fe(f),F&512&&(hi||A===null||Zs(A,A.return)),F&4){var re=A!==null?A.memoizedState:null;if(F=f.memoizedState,A===null)if(F===null)if(f.stateNode===null){e:{F=f.type,A=f.memoizedProps,Y=Y.ownerDocument||Y;t:switch(F){case"title":re=Y.getElementsByTagName("title")[0],(!re||re[vt]||re[xe]||re.namespaceURI==="http://www.w3.org/2000/svg"||re.hasAttribute("itemprop"))&&(re=Y.createElement(F),Y.head.insertBefore(re,Y.querySelector("head > title"))),Ho(re,F,A),re[xe]=f,Rn(re),F=re;break e;case"link":var Me=uv("link","href",Y).get(F+(A.href||""));if(Me){for(var Ge=0;Ge<Me.length;Ge++)if(re=Me[Ge],re.getAttribute("href")===(A.href==null?null:A.href)&&re.getAttribute("rel")===(A.rel==null?null:A.rel)&&re.getAttribute("title")===(A.title==null?null:A.title)&&re.getAttribute("crossorigin")===(A.crossOrigin==null?null:A.crossOrigin)){Me.splice(Ge,1);break t}}re=Y.createElement(F),Ho(re,F,A),Y.head.appendChild(re);break;case"meta":if(Me=uv("meta","content",Y).get(F+(A.content||""))){for(Ge=0;Ge<Me.length;Ge++)if(re=Me[Ge],re.getAttribute("content")===(A.content==null?null:""+A.content)&&re.getAttribute("name")===(A.name==null?null:A.name)&&re.getAttribute("property")===(A.property==null?null:A.property)&&re.getAttribute("http-equiv")===(A.httpEquiv==null?null:A.httpEquiv)&&re.getAttribute("charset")===(A.charSet==null?null:A.charSet)){Me.splice(Ge,1);break t}}re=Y.createElement(F),Ho(re,F,A),Y.head.appendChild(re);break;default:throw Error(o(468,F))}re[xe]=f,Rn(re),F=re}f.stateNode=F}else a1(Y,f.type,f.stateNode);else f.stateNode=i1(Y,F,f.memoizedProps);else re!==F?(re===null?A.stateNode!==null&&(A=A.stateNode,A.parentNode.removeChild(A)):re.count--,F===null?a1(Y,f.type,f.stateNode):i1(Y,F,f.memoizedProps)):F===null&&f.stateNode!==null&&Vl(f,f.memoizedProps,A.memoizedProps)}break;case 27:if(F&4&&f.alternate===null){Y=f.stateNode,re=f.memoizedProps;try{for(var dt=Y.firstChild;dt;){var Nt=dt.nextSibling,yn=dt.nodeName;dt[vt]||yn==="HEAD"||yn==="BODY"||yn==="SCRIPT"||yn==="STYLE"||yn==="LINK"&&dt.rel.toLowerCase()==="stylesheet"||Y.removeChild(dt),dt=Nt}for(var Dn=f.type,rn=Y.attributes;rn.length;)Y.removeAttributeNode(rn[0]);Ho(Y,Dn,re),Y[xe]=f,Y[Ie]=re}catch(br){ca(f,f.return,br)}}case 5:if(Q(_,f),fe(f),F&512&&(hi||A===null||Zs(A,A.return)),f.flags&32){Y=f.stateNode;try{il(Y,"")}catch(br){ca(f,f.return,br)}}F&4&&f.stateNode!=null&&(Y=f.memoizedProps,Vl(f,Y,A!==null?A.memoizedProps:Y)),F&1024&&(bd=!0);break;case 6:if(Q(_,f),fe(f),F&4){if(f.stateNode===null)throw Error(o(162));F=f.memoizedProps,A=f.stateNode;try{A.nodeValue=F}catch(br){ca(f,f.return,br)}}break;case 3:if(qm=null,Y=ae,ae=xf(_.containerInfo),Q(_,f),ae=Y,fe(f),F&4&&A!==null&&A.memoizedState.isDehydrated)try{Zm(_.containerInfo)}catch(br){ca(f,f.return,br)}bd&&(bd=!1,be(f));break;case 4:F=ae,ae=xf(f.stateNode.containerInfo),Q(_,f),fe(f),ae=F;break;case 12:Q(_,f),fe(f);break;case 13:Q(_,f),fe(f),f.child.flags&8192&&f.memoizedState!==null!=(A!==null&&A.memoizedState!==null)&&(Go=Mn()),F&4&&(F=f.updateQueue,F!==null&&(f.updateQueue=null,J(f,F)));break;case 22:if(F&512&&(hi||A===null||Zs(A,A.return)),dt=f.memoizedState!==null,Nt=A!==null&&A.memoizedState!==null,yn=_u,Dn=hi,_u=yn||dt,hi=Dn||Nt,Q(_,f),hi=Dn,_u=yn,fe(f),_=f.stateNode,_._current=f,_._visibility&=-3,_._visibility|=_._pendingVisibility&2,F&8192&&(_._visibility=dt?_._visibility&-2:_._visibility|1,dt&&(_=_u||hi,A===null||Nt||_||Ce(f)),f.memoizedProps===null||f.memoizedProps.mode!=="manual"))e:for(A=null,_=f;;){if(_.tag===5||_.tag===26||_.tag===27){if(A===null){Nt=A=_;try{if(Y=Nt.stateNode,dt)re=Y.style,typeof re.setProperty=="function"?re.setProperty("display","none","important"):re.display="none";else{Me=Nt.stateNode,Ge=Nt.memoizedProps.style;var gn=Ge!=null&&Ge.hasOwnProperty("display")?Ge.display:null;Me.style.display=gn==null||typeof gn=="boolean"?"":(""+gn).trim()}}catch(br){ca(Nt,Nt.return,br)}}}else if(_.tag===6){if(A===null){Nt=_;try{Nt.stateNode.nodeValue=dt?"":Nt.memoizedProps}catch(br){ca(Nt,Nt.return,br)}}}else if((_.tag!==22&&_.tag!==23||_.memoizedState===null||_===f)&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===f)break e;for(;_.sibling===null;){if(_.return===null||_.return===f)break e;A===_&&(A=null),_=_.return}A===_&&(A=null),_.sibling.return=_.return,_=_.sibling}F&4&&(F=f.updateQueue,F!==null&&(A=F.retryQueue,A!==null&&(F.retryQueue=null,J(f,A))));break;case 19:Q(_,f),fe(f),F&4&&(F=f.updateQueue,F!==null&&(f.updateQueue=null,J(f,F)));break;case 21:break;default:Q(_,f),fe(f)}}function fe(f){var _=f.flags;if(_&2){try{if(f.tag!==27){e:{for(var A=f.return;A!==null;){if(gl(A)){var F=A;break e}A=A.return}throw Error(o(160))}switch(F.tag){case 27:var Y=F.stateNode,re=vo(f);Pa(f,re,Y);break;case 5:var Me=F.stateNode;F.flags&32&&(il(Me,""),F.flags&=-33);var Ge=vo(f);Pa(f,Ge,Me);break;case 3:case 4:var dt=F.stateNode.containerInfo,Nt=vo(f);qo(f,Nt,dt);break;default:throw Error(o(161))}}}catch(yn){ca(f,f.return,yn)}f.flags&=-3}_&4096&&(f.flags&=-4097)}function be(f){if(f.subtreeFlags&1024)for(f=f.child;f!==null;){var _=f;be(_),_.tag===5&&_.flags&1024&&_.stateNode.reset(),f=f.sibling}}function _e(f,_){if(_.subtreeFlags&8772)for(_=_.child;_!==null;)m(f,_.alternate,_),_=_.sibling}function Ce(f){for(f=f.child;f!==null;){var _=f;switch(_.tag){case 0:case 11:case 14:case 15:yu(4,_,_.return),Ce(_);break;case 1:Zs(_,_.return);var A=_.stateNode;typeof A.componentWillUnmount=="function"&&Gu(_,_.return,A),Ce(_);break;case 26:case 27:case 5:Zs(_,_.return),Ce(_);break;case 22:Zs(_,_.return),_.memoizedState===null&&Ce(_);break;default:Ce(_)}f=f.sibling}}function ze(f,_,A){for(A=A&&(_.subtreeFlags&8772)!==0,_=_.child;_!==null;){var F=_.alternate,Y=f,re=_,Me=re.flags;switch(re.tag){case 0:case 11:case 15:ze(Y,re,A),Ul(4,re);break;case 1:if(ze(Y,re,A),F=re,Y=F.stateNode,typeof Y.componentDidMount=="function")try{Y.componentDidMount()}catch(Nt){ca(F,F.return,Nt)}if(F=re,Y=F.updateQueue,Y!==null){var Ge=F.stateNode;try{var dt=Y.shared.hiddenCallbacks;if(dt!==null)for(Y.shared.hiddenCallbacks=null,Y=0;Y<dt.length;Y++)mh(dt[Y],Ge)}catch(Nt){ca(F,F.return,Nt)}}A&&Me&64&&Gr(re),gh(re,re.return);break;case 26:case 27:case 5:ze(Y,re,A),A&&F===null&&Me&4&&xd(re),gh(re,re.return);break;case 12:ze(Y,re,A);break;case 13:ze(Y,re,A),A&&Me&4&&X(Y,re);break;case 22:re.memoizedState===null&&ze(Y,re,A),gh(re,re.return);break;default:ze(Y,re,A)}_=_.sibling}}function De(f,_){var A=null;f!==null&&f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(A=f.memoizedState.cachePool.pool),f=null,_.memoizedState!==null&&_.memoizedState.cachePool!==null&&(f=_.memoizedState.cachePool.pool),f!==A&&(f!=null&&f.refCount++,A!=null&&Lu(A))}function $e(f,_){f=null,_.alternate!==null&&(f=_.alternate.memoizedState.cache),_=_.memoizedState.cache,_!==f&&(_.refCount++,f!=null&&Lu(f))}function je(f,_,A,F){if(_.subtreeFlags&10256)for(_=_.child;_!==null;)Ve(f,_,A,F),_=_.sibling}function Ve(f,_,A,F){var Y=_.flags;switch(_.tag){case 0:case 11:case 15:je(f,_,A,F),Y&2048&&Ul(9,_);break;case 3:je(f,_,A,F),Y&2048&&(f=null,_.alternate!==null&&(f=_.alternate.memoizedState.cache),_=_.memoizedState.cache,_!==f&&(_.refCount++,f!=null&&Lu(f)));break;case 12:if(Y&2048){je(f,_,A,F),f=_.stateNode;try{var re=_.memoizedProps,Me=re.id,Ge=re.onPostCommit;typeof Ge=="function"&&Ge(Me,_.alternate===null?"mount":"update",f.passiveEffectDuration,-0)}catch(dt){ca(_,_.return,dt)}}else je(f,_,A,F);break;case 23:break;case 22:re=_.stateNode,_.memoizedState!==null?re._visibility&4?je(f,_,A,F):Qe(f,_):re._visibility&4?je(f,_,A,F):(re._visibility|=4,Ue(f,_,A,F,(_.subtreeFlags&10256)!==0)),Y&2048&&De(_.alternate,_);break;case 24:je(f,_,A,F),Y&2048&&$e(_.alternate,_);break;default:je(f,_,A,F)}}function Ue(f,_,A,F,Y){for(Y=Y&&(_.subtreeFlags&10256)!==0,_=_.child;_!==null;){var re=f,Me=_,Ge=A,dt=F,Nt=Me.flags;switch(Me.tag){case 0:case 11:case 15:Ue(re,Me,Ge,dt,Y),Ul(8,Me);break;case 23:break;case 22:var yn=Me.stateNode;Me.memoizedState!==null?yn._visibility&4?Ue(re,Me,Ge,dt,Y):Qe(re,Me):(yn._visibility|=4,Ue(re,Me,Ge,dt,Y)),Y&&Nt&2048&&De(Me.alternate,Me);break;case 24:Ue(re,Me,Ge,dt,Y),Y&&Nt&2048&&$e(Me.alternate,Me);break;default:Ue(re,Me,Ge,dt,Y)}_=_.sibling}}function Qe(f,_){if(_.subtreeFlags&10256)for(_=_.child;_!==null;){var A=f,F=_,Y=F.flags;switch(F.tag){case 22:Qe(A,F),Y&2048&&De(F.alternate,F);break;case 24:Qe(A,F),Y&2048&&$e(F.alternate,F);break;default:Qe(A,F)}_=_.sibling}}var at=8192;function St(f){if(f.subtreeFlags&at)for(f=f.child;f!==null;)yt(f),f=f.sibling}function yt(f){switch(f.tag){case 26:St(f),f.flags&at&&f.memoizedState!==null&&V2(ae,f.memoizedState,f.memoizedProps);break;case 5:St(f);break;case 3:case 4:var _=ae;ae=xf(f.stateNode.containerInfo),St(f),ae=_;break;case 22:f.memoizedState===null&&(_=f.alternate,_!==null&&_.memoizedState!==null?(_=at,at=16777216,St(f),at=_):St(f));break;default:St(f)}}function jt(f){var _=f.alternate;if(_!==null&&(f=_.child,f!==null)){_.child=null;do _=f.sibling,f.sibling=null,f=_;while(f!==null)}}function It(f){var _=f.deletions;if((f.flags&16)!==0){if(_!==null)for(var A=0;A<_.length;A++){var F=_[A];p=F,Qt(F,f)}jt(f)}if(f.subtreeFlags&10256)for(f=f.child;f!==null;)ft(f),f=f.sibling}function ft(f){switch(f.tag){case 0:case 11:case 15:It(f),f.flags&2048&&yu(9,f,f.return);break;case 3:It(f);break;case 12:It(f);break;case 22:var _=f.stateNode;f.memoizedState!==null&&_._visibility&4&&(f.return===null||f.return.tag!==13)?(_._visibility&=-5,At(f)):It(f);break;default:It(f)}}function At(f){var _=f.deletions;if((f.flags&16)!==0){if(_!==null)for(var A=0;A<_.length;A++){var F=_[A];p=F,Qt(F,f)}jt(f)}for(f=f.child;f!==null;){switch(_=f,_.tag){case 0:case 11:case 15:yu(8,_,_.return),At(_);break;case 22:A=_.stateNode,A._visibility&4&&(A._visibility&=-5,At(_));break;default:At(_)}f=f.sibling}}function Qt(f,_){for(;p!==null;){var A=p;switch(A.tag){case 0:case 11:case 15:yu(8,A,_);break;case 23:case 22:if(A.memoizedState!==null&&A.memoizedState.cachePool!==null){var F=A.memoizedState.cachePool.pool;F!=null&&F.refCount++}break;case 24:Lu(A.memoizedState.cache)}if(F=A.child,F!==null)F.return=A,p=F;else e:for(A=f;p!==null;){F=p;var Y=F.sibling,re=F.return;if(w(F),F===A){p=null;break e}if(Y!==null){Y.return=re,p=Y;break e}p=re}}}function ht(f,_,A,F){this.tag=f,this.key=A,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=_,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=F,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zt(f,_,A,F){return new ht(f,_,A,F)}function Mt(f){return f=f.prototype,!(!f||!f.isReactComponent)}function ln(f,_){var A=f.alternate;return A===null?(A=zt(f.tag,_,f.key,f.mode),A.elementType=f.elementType,A.type=f.type,A.stateNode=f.stateNode,A.alternate=f,f.alternate=A):(A.pendingProps=_,A.type=f.type,A.flags=0,A.subtreeFlags=0,A.deletions=null),A.flags=f.flags&31457280,A.childLanes=f.childLanes,A.lanes=f.lanes,A.child=f.child,A.memoizedProps=f.memoizedProps,A.memoizedState=f.memoizedState,A.updateQueue=f.updateQueue,_=f.dependencies,A.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext},A.sibling=f.sibling,A.index=f.index,A.ref=f.ref,A.refCleanup=f.refCleanup,A}function Yt(f,_){f.flags&=31457282;var A=f.alternate;return A===null?(f.childLanes=0,f.lanes=_,f.child=null,f.subtreeFlags=0,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=A.childLanes,f.lanes=A.lanes,f.child=A.child,f.subtreeFlags=0,f.deletions=null,f.memoizedProps=A.memoizedProps,f.memoizedState=A.memoizedState,f.updateQueue=A.updateQueue,f.type=A.type,_=A.dependencies,f.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext}),f}function Ut(f,_,A,F,Y,re){var Me=0;if(F=f,typeof f=="function")Mt(f)&&(Me=1);else if(typeof f=="string")Me=j2(f,A,An.current)?26:f==="html"||f==="head"||f==="body"?27:5;else e:switch(f){case P:return tn(A.children,Y,re,_);case L:Me=8,Y|=24;break;case U:return f=zt(12,A,_,Y|2),f.elementType=U,f.lanes=re,f;case le:return f=zt(13,A,_,Y),f.elementType=le,f.lanes=re,f;case ue:return f=zt(19,A,_,Y),f.elementType=ue,f.lanes=re,f;case ve:return fn(A,Y,re,_);default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case V:case ee:Me=10;break e;case H:Me=9;break e;case ie:Me=11;break e;case ge:Me=14;break e;case Se:Me=16,F=null;break e}Me=29,A=Error(o(130,f===null?"null":typeof f,"")),F=null}return _=zt(Me,A,_,Y),_.elementType=f,_.type=F,_.lanes=re,_}function tn(f,_,A,F){return f=zt(7,f,F,_),f.lanes=A,f}function fn(f,_,A,F){f=zt(22,f,F,_),f.elementType=ve,f.lanes=A;var Y={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var re=Y._current;if(re===null)throw Error(o(456));if((Y._pendingVisibility&2)===0){var Me=jo(re,2);Me!==null&&(Y._pendingVisibility|=2,Js(Me,re,2))}},attach:function(){var re=Y._current;if(re===null)throw Error(o(456));if((Y._pendingVisibility&2)!==0){var Me=jo(re,2);Me!==null&&(Y._pendingVisibility&=-3,Js(Me,re,2))}}};return f.stateNode=Y,f}function wn(f,_,A){return f=zt(6,f,null,_),f.lanes=A,f}function Cn(f,_,A){return _=zt(4,f.children!==null?f.children:[],f.key,_),_.lanes=A,_.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},_}function Yn(f){f.flags|=4}function Gn(f,_){if(_.type!=="stylesheet"||(_.state.loading&4)!==0)f.flags&=-16777217;else if(f.flags|=16777216,!o1(_)){if(_=Uo.current,_!==null&&((Jn&4194176)===Jn?ll!==null:(Jn&62914560)!==Jn&&(Jn&536870912)===0||_!==ll))throw Qf=gm,Dg;f.flags|=8192}}function Un(f,_){_!==null&&(f.flags|=4),f.flags&16384&&(_=f.tag!==22?Jl():536870912,f.lanes|=_,aa|=_)}function tr(f,_){if(!yi)switch(f.tailMode){case"hidden":_=f.tail;for(var A=null;_!==null;)_.alternate!==null&&(A=_),_=_.sibling;A===null?f.tail=null:A.sibling=null;break;case"collapsed":A=f.tail;for(var F=null;A!==null;)A.alternate!==null&&(F=A),A=A.sibling;F===null?_||f.tail===null?f.tail=null:f.tail.sibling=null:F.sibling=null}}function nr(f){var _=f.alternate!==null&&f.alternate.child===f.child,A=0,F=0;if(_)for(var Y=f.child;Y!==null;)A|=Y.lanes|Y.childLanes,F|=Y.subtreeFlags&31457280,F|=Y.flags&31457280,Y.return=f,Y=Y.sibling;else for(Y=f.child;Y!==null;)A|=Y.lanes|Y.childLanes,F|=Y.subtreeFlags,F|=Y.flags,Y.return=f,Y=Y.sibling;return f.subtreeFlags|=F,f.childLanes=A,_}function ri(f,_,A){var F=_.pendingProps;switch(op(_),_.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nr(_),null;case 1:return nr(_),null;case 3:return A=_.stateNode,F=null,f!==null&&(F=f.memoizedState.cache),_.memoizedState.cache!==F&&(_.flags|=2048),ns(pa),Wr(),A.pendingContext&&(A.context=A.pendingContext,A.pendingContext=null),(f===null||f.child===null)&&(cc(_)?Yn(_):f===null||f.memoizedState.isDehydrated&&(_.flags&256)===0||(_.flags|=1024,bs!==null&&(Xg(bs),bs=null))),nr(_),null;case 26:return A=_.memoizedState,f===null?(Yn(_),A!==null?(nr(_),Gn(_,A)):(nr(_),_.flags&=-16777217)):A?A!==f.memoizedState?(Yn(_),nr(_),Gn(_,A)):(nr(_),_.flags&=-16777217):(f.memoizedProps!==F&&Yn(_),nr(_),_.flags&=-16777217),null;case 27:hr(_),A=jr.current;var Y=_.type;if(f!==null&&_.stateNode!=null)f.memoizedProps!==F&&Yn(_);else{if(!F){if(_.stateNode===null)throw Error(o(166));return nr(_),null}f=An.current,cc(_)?sp(_):(f=av(Y,F,A),_.stateNode=f,Yn(_))}return nr(_),null;case 5:if(hr(_),A=_.type,f!==null&&_.stateNode!=null)f.memoizedProps!==F&&Yn(_);else{if(!F){if(_.stateNode===null)throw Error(o(166));return nr(_),null}if(f=An.current,cc(_))sp(_);else{switch(Y=Id(jr.current),f){case 1:f=Y.createElementNS("http://www.w3.org/2000/svg",A);break;case 2:f=Y.createElementNS("http://www.w3.org/1998/Math/MathML",A);break;default:switch(A){case"svg":f=Y.createElementNS("http://www.w3.org/2000/svg",A);break;case"math":f=Y.createElementNS("http://www.w3.org/1998/Math/MathML",A);break;case"script":f=Y.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof F.is=="string"?Y.createElement("select",{is:F.is}):Y.createElement("select"),F.multiple?f.multiple=!0:F.size&&(f.size=F.size);break;default:f=typeof F.is=="string"?Y.createElement(A,{is:F.is}):Y.createElement(A)}}f[xe]=_,f[Ie]=F;e:for(Y=_.child;Y!==null;){if(Y.tag===5||Y.tag===6)f.appendChild(Y.stateNode);else if(Y.tag!==4&&Y.tag!==27&&Y.child!==null){Y.child.return=Y,Y=Y.child;continue}if(Y===_)break e;for(;Y.sibling===null;){if(Y.return===null||Y.return===_)break e;Y=Y.return}Y.sibling.return=Y.return,Y=Y.sibling}_.stateNode=f;e:switch(Ho(f,A,F),A){case"button":case"input":case"select":case"textarea":f=!!F.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&Yn(_)}}return nr(_),_.flags&=-16777217,null;case 6:if(f&&_.stateNode!=null)f.memoizedProps!==F&&Yn(_);else{if(typeof F!="string"&&_.stateNode===null)throw Error(o(166));if(f=jr.current,cc(_)){if(f=_.stateNode,A=_.memoizedProps,F=null,Y=Xi,Y!==null)switch(Y.tag){case 27:case 5:F=Y.memoizedProps}f[xe]=_,f=!!(f.nodeValue===A||F!==null&&F.suppressHydrationWarning===!0||Od(f.nodeValue,A)),f||uu(_)}else f=Id(f).createTextNode(F),f[xe]=_,_.stateNode=f}return nr(_),null;case 13:if(F=_.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(Y=cc(_),F!==null&&F.dehydrated!==null){if(f===null){if(!Y)throw Error(o(318));if(Y=_.memoizedState,Y=Y!==null?Y.dehydrated:null,!Y)throw Error(o(317));Y[xe]=_}else Xh(),(_.flags&128)===0&&(_.memoizedState=null),_.flags|=4;nr(_),Y=!1}else bs!==null&&(Xg(bs),bs=null),Y=!0;if(!Y)return _.flags&256?(Du(_),_):(Du(_),null)}if(Du(_),(_.flags&128)!==0)return _.lanes=A,_;if(A=F!==null,f=f!==null&&f.memoizedState!==null,A){F=_.child,Y=null,F.alternate!==null&&F.alternate.memoizedState!==null&&F.alternate.memoizedState.cachePool!==null&&(Y=F.alternate.memoizedState.cachePool.pool);var re=null;F.memoizedState!==null&&F.memoizedState.cachePool!==null&&(re=F.memoizedState.cachePool.pool),re!==Y&&(F.flags|=2048)}return A!==f&&A&&(_.child.flags|=8192),Un(_,_.updateQueue),nr(_),null;case 4:return Wr(),f===null&&ay(_.stateNode.containerInfo),nr(_),null;case 10:return ns(_.type),nr(_),null;case 19:if(Ln(oo),Y=_.memoizedState,Y===null)return nr(_),null;if(F=(_.flags&128)!==0,re=Y.rendering,re===null)if(F)tr(Y,!1);else{if(zr!==0||f!==null&&(f.flags&128)!==0)for(f=_.child;f!==null;){if(re=td(f),re!==null){for(_.flags|=128,tr(Y,!1),f=re.updateQueue,_.updateQueue=f,Un(_,f),_.subtreeFlags=0,f=A,A=_.child;A!==null;)Yt(A,f),A=A.sibling;return Ne(oo,oo.current&1|2),_.child}f=f.sibling}Y.tail!==null&&Mn()>xo&&(_.flags|=128,F=!0,tr(Y,!1),_.lanes=4194304)}else{if(!F)if(f=td(re),f!==null){if(_.flags|=128,F=!0,f=f.updateQueue,_.updateQueue=f,Un(_,f),tr(Y,!0),Y.tail===null&&Y.tailMode==="hidden"&&!re.alternate&&!yi)return nr(_),null}else 2*Mn()-Y.renderingStartTime>xo&&A!==536870912&&(_.flags|=128,F=!0,tr(Y,!1),_.lanes=4194304);Y.isBackwards?(re.sibling=_.child,_.child=re):(f=Y.last,f!==null?f.sibling=re:_.child=re,Y.last=re)}return Y.tail!==null?(_=Y.tail,Y.rendering=_,Y.tail=_.sibling,Y.renderingStartTime=Mn(),_.sibling=null,f=oo.current,Ne(oo,F?f&1|2:f&1),_):(nr(_),null);case 22:case 23:return Du(_),Wh(),F=_.memoizedState!==null,f!==null?f.memoizedState!==null!==F&&(_.flags|=8192):F&&(_.flags|=8192),F?(A&536870912)!==0&&(_.flags&128)===0&&(nr(_),_.subtreeFlags&6&&(_.flags|=8192)):nr(_),A=_.updateQueue,A!==null&&Un(_,A.retryQueue),A=null,f!==null&&f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(A=f.memoizedState.cachePool.pool),F=null,_.memoizedState!==null&&_.memoizedState.cachePool!==null&&(F=_.memoizedState.cachePool.pool),F!==A&&(_.flags|=2048),f!==null&&Ln(In),null;case 24:return A=null,f!==null&&(A=f.memoizedState.cache),_.memoizedState.cache!==A&&(_.flags|=2048),ns(pa),nr(_),null;case 25:return null}throw Error(o(156,_.tag))}function Zi(f,_){switch(op(_),_.tag){case 1:return f=_.flags,f&65536?(_.flags=f&-65537|128,_):null;case 3:return ns(pa),Wr(),f=_.flags,(f&65536)!==0&&(f&128)===0?(_.flags=f&-65537|128,_):null;case 26:case 27:case 5:return hr(_),null;case 13:if(Du(_),f=_.memoizedState,f!==null&&f.dehydrated!==null){if(_.alternate===null)throw Error(o(340));Xh()}return f=_.flags,f&65536?(_.flags=f&-65537|128,_):null;case 19:return Ln(oo),null;case 4:return Wr(),null;case 10:return ns(_.type),null;case 22:case 23:return Du(_),Wh(),f!==null&&Ln(In),f=_.flags,f&65536?(_.flags=f&-65537|128,_):null;case 24:return ns(pa),null;case 25:return null;default:return null}}function wi(f,_){switch(op(_),_.tag){case 3:ns(pa),Wr();break;case 26:case 27:case 5:hr(_);break;case 4:Wr();break;case 13:Du(_);break;case 19:Ln(oo);break;case 10:ns(_.type);break;case 22:case 23:Du(_),Wh(),f!==null&&Ln(In);break;case 24:ns(pa)}}var ur={getCacheForType:function(f){var _=Vo(pa),A=_.data.get(f);return A===void 0&&(A=f(),_.data.set(f,A)),A}},$r=typeof WeakMap=="function"?WeakMap:Map,Sn=0,Kn=null,Zn=null,Jn=0,Ir=0,Ti=null,ki=!1,Wi=!1,rs=!1,ua=0,zr=0,ti=0,ei=0,Dr=0,fi=0,aa=0,ii=null,oa=null,As=!1,Go=0,xo=1/0,Ws=null,uo=null,$o=!1,Ks=null,Ms=0,$u=0,Cc=null,Pc=0,wd=null;function yl(){if((Sn&2)!==0&&Jn!==0)return Jn&-Jn;if(He.T!==null){var f=hu;return f!==0?f:ry()}return ls()}function Nx(){fi===0&&(fi=(Jn&536870912)===0||yi?Bn():536870912);var f=Uo.current;return f!==null&&(f.flags|=32),fi}function Js(f,_,A){(f===Kn&&Ir===2||f.cancelPendingCommit!==null)&&(yf(f,0),Rc(f,Jn,fi,!1)),Mi(f,A),((Sn&2)===0||f!==Kn)&&(f===Kn&&((Sn&2)===0&&(ei|=A),zr===4&&Rc(f,Jn,fi,!1)),ql(f))}function H_(f,_,A){if((Sn&6)!==0)throw Error(o(327));var F=!A&&(_&60)===0&&(_&f.expiredLanes)===0||zs(f,_),Y=F?km(f,_):Z_(f,_,!0),re=F;do{if(Y===0){Wi&&!F&&Rc(f,_,0,!1);break}else if(Y===6)Rc(f,_,0,!ki);else{if(A=f.current.alternate,re&&!Bx(A)){Y=Z_(f,_,!1),re=!1;continue}if(Y===2){if(re=_,f.errorRecoveryDisabledLanes&re)var Me=0;else Me=f.pendingLanes&-536870913,Me=Me!==0?Me:Me&536870912?536870912:0;if(Me!==0){_=Me;e:{var Ge=f;Y=ii;var dt=Ge.current.memoizedState.isDehydrated;if(dt&&(yf(Ge,Me).flags|=256),Me=Z_(Ge,Me,!1),Me!==2){if(rs&&!dt){Ge.errorRecoveryDisabledLanes|=re,ei|=re,Y=4;break e}re=oa,oa=Y,re!==null&&Xg(re)}Y=Me}if(re=!1,Y!==2)continue}}if(Y===1){yf(f,0),Rc(f,_,0,!0);break}e:{switch(F=f,Y){case 0:case 1:throw Error(o(345));case 4:if((_&4194176)===_){Rc(F,_,fi,!ki);break e}break;case 2:oa=null;break;case 3:case 5:break;default:throw Error(o(329))}if(F.finishedWork=A,F.finishedLanes=_,(_&62914560)===_&&(re=Go+300-Mn(),10<re)){if(Rc(F,_,fi,!ki),Al(F,0)!==0)break e;F.timeoutHandle=nv(X_.bind(null,F,A,oa,Ws,As,_,fi,ei,aa,ki,2,-0,0),re);break e}X_(F,A,oa,Ws,As,_,fi,ei,aa,ki,0,-0,0)}}break}while(!0);ql(f)}function Xg(f){oa===null?oa=f:oa.push.apply(oa,f)}function X_(f,_,A,F,Y,re,Me,Ge,dt,Nt,yn,Dn,rn){var gn=_.subtreeFlags;if((gn&8192||(gn&16785408)===16785408)&&(Gm={stylesheets:null,count:0,unsuspend:U2},yt(_),_=q2(),_!==null)){f.cancelPendingCommit=_(Ux.bind(null,f,A,F,Y,Me,Ge,dt,1,Dn,rn)),Rc(f,re,Me,!Nt);return}Ux(f,A,F,Y,Me,Ge,dt,yn,Dn,rn)}function Bx(f){for(var _=f;;){var A=_.tag;if((A===0||A===11||A===15)&&_.flags&16384&&(A=_.updateQueue,A!==null&&(A=A.stores,A!==null)))for(var F=0;F<A.length;F++){var Y=A[F],re=Y.getSnapshot;Y=Y.value;try{if(!Ia(re(),Y))return!1}catch{return!1}}if(A=_.child,_.subtreeFlags&16384&&A!==null)A.return=_,_=A;else{if(_===f)break;for(;_.sibling===null;){if(_.return===null||_.return===f)return!0;_=_.return}_.sibling.return=_.return,_=_.sibling}}return!0}function Rc(f,_,A,F){_&=~Dr,_&=~ei,f.suspendedLanes|=_,f.pingedLanes&=~_,F&&(f.warmLanes|=_),F=f.expirationTimes;for(var Y=_;0<Y;){var re=31-za(Y),Me=1<<re;F[re]=-1,Y&=~Me}A!==0&&Tu(f,A,_)}function Rm(){return(Sn&6)===0?(Lm(0),!1):!0}function Yg(){if(Zn!==null){if(Ir===0)var f=Zn.return;else f=Zn,Bl=Vu=null,rf(f),hc=null,fc=0,f=Zn;for(;f!==null;)wi(f.alternate,f),f=f.return;Zn=null}}function yf(f,_){f.finishedWork=null,f.finishedLanes=0;var A=f.timeoutHandle;A!==-1&&(f.timeoutHandle=-1,Wx(A)),A=f.cancelPendingCommit,A!==null&&(f.cancelPendingCommit=null,A()),Yg(),Kn=f,Zn=A=ln(f.current,null),Jn=_,Ir=0,Ti=null,ki=!1,Wi=zs(f,_),rs=!1,aa=fi=Dr=ei=ti=zr=0,oa=ii=null,As=!1,(_&8)!==0&&(_|=_&32);var F=f.entangledLanes;if(F!==0)for(f=f.entanglements,F&=_;0<F;){var Y=31-za(F),re=1<<Y;_|=f[Y],F&=~re}return ua=_,Pl(),A}function _h(f,_){dn=null,He.H=fl,_===cu?(_=cp(),Ir=3):_===Dg?(_=cp(),Ir=4):Ir=_===Im?8:_!==null&&typeof _=="object"&&typeof _.then=="function"?6:1,Ti=_,Zn===null&&(zr=1,md(f,qs(_,f.current)))}function co(){var f=He.H;return He.H=fl,f===null?fl:f}function Y_(){var f=He.A;return He.A=ur,f}function Sd(){zr=4,ki||(Jn&4194176)!==Jn&&Uo.current!==null||(Wi=!0),(ti&134217727)===0&&(ei&134217727)===0||Kn===null||Rc(Kn,Jn,fi,!1)}function Z_(f,_,A){var F=Sn;Sn|=2;var Y=co(),re=Y_();(Kn!==f||Jn!==_)&&(Ws=null,yf(f,_)),_=!1;var Me=zr;e:do try{if(Ir!==0&&Zn!==null){var Ge=Zn,dt=Ti;switch(Ir){case 8:Yg(),Me=6;break e;case 3:case 2:case 6:Uo.current===null&&(_=!0);var Nt=Ir;if(Ir=0,Ti=null,kp(f,Ge,dt,Nt),A&&Wi){Me=0;break e}break;default:Nt=Ir,Ir=0,Ti=null,kp(f,Ge,dt,Nt)}}O2(),Me=zr;break}catch(yn){_h(f,yn)}while(!0);return _&&f.shellSuspendCounter++,Bl=Vu=null,Sn=F,He.H=Y,He.A=re,Zn===null&&(Kn=null,Jn=0,Pl()),Me}function O2(){for(;Zn!==null;)_f(Zn)}function km(f,_){var A=Sn;Sn|=2;var F=co(),Y=Y_();Kn!==f||Jn!==_?(Ws=null,xo=Mn()+500,yf(f,_)):Wi=zs(f,_);e:do try{if(Ir!==0&&Zn!==null){_=Zn;var re=Ti;t:switch(Ir){case 1:Ir=0,Ti=null,kp(f,_,re,1);break;case 2:if(Lg(re)){Ir=0,Ti=null,Rp(_);break}_=function(){Ir===2&&Kn===f&&(Ir=7),ql(f)},re.then(_,_);break e;case 3:Ir=7;break e;case 4:Ir=5;break e;case 7:Lg(re)?(Ir=0,Ti=null,Rp(_)):(Ir=0,Ti=null,kp(f,_,re,7));break;case 5:var Me=null;switch(Zn.tag){case 26:Me=Zn.memoizedState;case 5:case 27:var Ge=Zn;if(!Me||o1(Me)){Ir=0,Ti=null;var dt=Ge.sibling;if(dt!==null)Zn=dt;else{var Nt=Ge.return;Nt!==null?(Zn=Nt,Zg(Nt)):Zn=null}break t}}Ir=0,Ti=null,kp(f,_,re,5);break;case 6:Ir=0,Ti=null,kp(f,_,re,6);break;case 8:Yg(),zr=6;break e;default:throw Error(o(462))}}Fx();break}catch(yn){_h(f,yn)}while(!0);return Bl=Vu=null,He.H=F,He.A=Y,Sn=A,Zn!==null?0:(Kn=null,Jn=0,Pl(),zr)}function Fx(){for(;Zn!==null&&!ya();)_f(Zn)}function _f(f){var _=Ip(f.alternate,f,ua);f.memoizedProps=f.pendingProps,_===null?Zg(f):Zn=_}function Rp(f){var _=f,A=_.alternate;switch(_.tag){case 15:case 0:_=yd(A,_,_.pendingProps,_.type,void 0,Jn);break;case 11:_=yd(A,_,_.pendingProps,_.type.render,_.ref,Jn);break;case 5:rf(_);default:wi(A,_),_=Zn=Yt(_,ua),_=Ip(A,_,ua)}f.memoizedProps=f.pendingProps,_===null?Zg(f):Zn=_}function kp(f,_,A,F){Bl=Vu=null,rf(_),hc=null,fc=0;var Y=_.return;try{if(qg(f,Y,_,A,Jn)){zr=1,md(f,qs(A,f.current)),Zn=null;return}}catch(re){if(Y!==null)throw Zn=Y,re;zr=1,md(f,qs(A,f.current)),Zn=null;return}_.flags&32768?(yi||F===1?f=!0:Wi||(Jn&536870912)!==0?f=!1:(ki=f=!0,(F===2||F===3||F===6)&&(F=Uo.current,F!==null&&F.tag===13&&(F.flags|=16384))),jx(_,f)):Zg(_)}function Zg(f){var _=f;do{if((_.flags&32768)!==0){jx(_,ki);return}f=_.return;var A=ri(_.alternate,_,ua);if(A!==null){Zn=A;return}if(_=_.sibling,_!==null){Zn=_;return}Zn=_=f}while(_!==null);zr===0&&(zr=5)}function jx(f,_){do{var A=Zi(f.alternate,f);if(A!==null){A.flags&=32767,Zn=A;return}if(A=f.return,A!==null&&(A.flags|=32768,A.subtreeFlags=0,A.deletions=null),!_&&(f=f.sibling,f!==null)){Zn=f;return}Zn=f=A}while(f!==null);zr=6,Zn=null}function Ux(f,_,A,F,Y,re,Me,Ge,dt,Nt){var yn=He.T,Dn=cn.p;try{cn.p=2,He.T=null,I2(f,_,A,F,Dn,Y,re,Me,Ge,dt,Nt)}finally{He.T=yn,cn.p=Dn}}function I2(f,_,A,F,Y,re,Me,Ge){do Dp();while(Ks!==null);if((Sn&6)!==0)throw Error(o(327));var dt=f.finishedWork;if(F=f.finishedLanes,dt===null)return null;if(f.finishedWork=null,f.finishedLanes=0,dt===f.current)throw Error(o(177));f.callbackNode=null,f.callbackPriority=0,f.cancelPendingCommit=null;var Nt=dt.lanes|dt.childLanes;if(Nt|=_s,tc(f,F,Nt,re,Me,Ge),f===Kn&&(Zn=Kn=null,Jn=0),(dt.subtreeFlags&10256)===0&&(dt.flags&10256)===0||$o||($o=!0,$u=Nt,Cc=A,Jg(ar,function(){return Dp(),null})),A=(dt.flags&15990)!==0,(dt.subtreeFlags&15990)!==0||A?(A=He.T,He.T=null,re=cn.p,cn.p=2,Me=Sn,Sn|=4,l(f,dt),ye(dt,f),Jo(ly,f.containerInfo),Hm=!!Np,ly=Np=null,f.current=dt,m(f,dt.alternate,dt),ks(),Sn=Me,cn.p=re,He.T=A):f.current=dt,$o?($o=!1,Ks=f,Ms=F):Vx(f,Nt),Nt=f.pendingLanes,Nt===0&&(uo=null),Er(dt.stateNode),ql(f),_!==null)for(Y=f.onRecoverableError,dt=0;dt<_.length;dt++)Nt=_[dt],Y(Nt.value,{componentStack:Nt.stack});return(Ms&3)!==0&&Dp(),Nt=f.pendingLanes,(F&4194218)!==0&&(Nt&42)!==0?f===wd?Pc++:(Pc=0,wd=f):Pc=0,Lm(0),null}function Vx(f,_){(f.pooledCacheLanes&=_)===0&&(_=f.pooledCache,_!=null&&(f.pooledCache=null,Lu(_)))}function Dp(){if(Ks!==null){var f=Ks,_=$u;$u=0;var A=ea(Ms),F=He.T,Y=cn.p;try{if(cn.p=32>A?32:A,He.T=null,Ks===null)var re=!1;else{A=Cc,Cc=null;var Me=Ks,Ge=Ms;if(Ks=null,Ms=0,(Sn&6)!==0)throw Error(o(331));var dt=Sn;if(Sn|=4,ft(Me.current),Ve(Me,Me.current,Ge,A),Sn=dt,Lm(0,!1),$a&&typeof $a.onPostCommitFiberRoot=="function")try{$a.onPostCommitFiberRoot(Ui,Me)}catch{}re=!0}return re}finally{cn.p=Y,He.T=F,Vx(f,_)}}return!1}function Wg(f,_,A){_=qs(A,_),_=hh(f.stateNode,_,2),f=qu(f,_,2),f!==null&&(Mi(f,2),ql(f))}function ca(f,_,A){if(f.tag===3)Wg(f,f,A);else for(;_!==null;){if(_.tag===3){Wg(_,f,A);break}else if(_.tag===1){var F=_.stateNode;if(typeof _.type.getDerivedStateFromError=="function"||typeof F.componentDidCatch=="function"&&(uo===null||!uo.has(F))){f=qs(A,f),A=Mm(2),F=qu(_,A,2),F!==null&&(Om(A,F,_,f),Mi(F,2),ql(F));break}}_=_.return}}function vf(f,_,A){var F=f.pingCache;if(F===null){F=f.pingCache=new $r;var Y=new Set;F.set(_,Y)}else Y=F.get(_),Y===void 0&&(Y=new Set,F.set(_,Y));Y.has(A)||(rs=!0,Y.add(A),f=C2.bind(null,f,_,A),_.then(f,f))}function C2(f,_,A){var F=f.pingCache;F!==null&&F.delete(_),f.pingedLanes|=f.suspendedLanes&A,f.warmLanes&=~A,Kn===f&&(Jn&A)===A&&(zr===4||zr===3&&(Jn&62914560)===Jn&&300>Mn()-Go?(Sn&2)===0&&yf(f,0):Dr|=A,aa===Jn&&(aa=0)),ql(f)}function Ra(f,_){_===0&&(_=Jl()),f=jo(f,_),f!==null&&(Mi(f,_),ql(f))}function Kg(f){var _=f.memoizedState,A=0;_!==null&&(A=_.retryLane),Ra(f,A)}function qx(f,_){var A=0;switch(f.tag){case 13:var F=f.stateNode,Y=f.memoizedState;Y!==null&&(A=Y.retryLane);break;case 19:F=f.stateNode;break;case 22:F=f.stateNode._retryCache;break;default:throw Error(o(314))}F!==null&&F.delete(_),Ra(f,A)}function Jg(f,_){return wa(f,_)}var Td=null,kc=null,Qg=!1,Dm=!1,Ed=!1,vh=0;function ql(f){f!==kc&&f.next===null&&(kc===null?Td=kc=f:kc=kc.next=f),Dm=!0,Qg||(Qg=!0,$x(Gx))}function Lm(f,_){if(!Ed&&Dm){Ed=!0;do for(var A=!1,F=Td;F!==null;){if(f!==0){var Y=F.pendingLanes;if(Y===0)var re=0;else{var Me=F.suspendedLanes,Ge=F.pingedLanes;re=(1<<31-za(42|f)+1)-1,re&=Y&~(Me&~Ge),re=re&201326677?re&201326677|1:re?re|2:0}re!==0&&(A=!0,ny(F,re))}else re=Jn,re=Al(F,F===Kn?re:0),(re&3)===0||zs(F,re)||(A=!0,ny(F,re));F=F.next}while(A);Ed=!1}}function Gx(){Dm=Qg=!1;var f=0;vh!==0&&(D2()&&(f=vh),vh=0);for(var _=Mn(),A=null,F=Td;F!==null;){var Y=F.next,re=ey(F,_);re===0?(F.next=null,A===null?Td=Y:A.next=Y,Y===null&&(kc=A)):(A=F,(f!==0||(re&3)!==0)&&(Dm=!0)),F=Y}Lm(f)}function ey(f,_){for(var A=f.suspendedLanes,F=f.pingedLanes,Y=f.expirationTimes,re=f.pendingLanes&-62914561;0<re;){var Me=31-za(re),Ge=1<<Me,dt=Y[Me];dt===-1?((Ge&A)===0||(Ge&F)!==0)&&(Y[Me]=nl(Ge,_)):dt<=_&&(f.expiredLanes|=Ge),re&=~Ge}if(_=Kn,A=Jn,A=Al(f,f===_?A:0),F=f.callbackNode,A===0||f===_&&Ir===2||f.cancelPendingCommit!==null)return F!==null&&F!==null&&La(F),f.callbackNode=null,f.callbackPriority=0;if((A&3)===0||zs(f,A)){if(_=A&-A,_===f.callbackPriority)return _;switch(F!==null&&La(F),ea(A)){case 2:case 8:A=Ds;break;case 32:A=ar;break;case 268435456:A=Kr;break;default:A=ar}return F=ty.bind(null,f),A=wa(A,F),f.callbackPriority=_,f.callbackNode=A,_}return F!==null&&F!==null&&La(F),f.callbackPriority=2,f.callbackNode=null,2}function ty(f,_){var A=f.callbackNode;if(Dp()&&f.callbackNode!==A)return null;var F=Jn;return F=Al(f,f===Kn?F:0),F===0?null:(H_(f,F,_),ey(f,Mn()),f.callbackNode!=null&&f.callbackNode===A?ty.bind(null,f):null)}function ny(f,_){if(Dp())return null;H_(f,_,!0)}function $x(f){Kx(function(){(Sn&6)!==0?wa(To,f):f()})}function ry(){return vh===0&&(vh=Bn()),vh}function W_(f){return f==null||typeof f=="symbol"||typeof f=="boolean"?null:typeof f=="function"?f:Vr(""+f)}function K_(f,_){var A=_.ownerDocument.createElement("input");return A.name=_.name,A.value=_.value,f.id&&A.setAttribute("form",f.id),_.parentNode.insertBefore(A,_),f=new FormData(f),A.parentNode.removeChild(A),f}function J_(f,_,A,F,Y){if(_==="submit"&&A&&A.stateNode===Y){var re=W_((Y[Ie]||null).action),Me=F.submitter;Me&&(_=(_=Me[Ie]||null)?W_(_.formAction):Me.getAttribute("formAction"),_!==null&&(re=_,Me=null));var Ge=new Ou("action","action",null,F,Y);f.push({event:Ge,listeners:[{instance:null,listener:function(){if(F.defaultPrevented){if(vh!==0){var dt=Me?K_(Y,Me):new FormData(Y);so(A,{pending:!0,data:dt,method:Y.method,action:re},null,dt)}}else typeof re=="function"&&(Ge.preventDefault(),dt=Me?K_(Y,Me):new FormData(Y),so(A,{pending:!0,data:dt,method:Y.method,action:re},re,dt))},currentTarget:Y}]})}}for(var vu=0;vu<xi.length;vu++){var iy=xi[vu],P2=iy.toLowerCase(),R2=iy[0].toUpperCase()+iy.slice(1);Si(P2,"on"+R2)}Si(Dt,"onAnimationEnd"),Si(Ht,"onAnimationIteration"),Si(bn,"onAnimationStart"),Si("dblclick","onDoubleClick"),Si("focusin","onFocus"),Si("focusout","onBlur"),Si(Hn,"onTransitionRun"),Si(sr,"onTransitionStart"),Si(xr,"onTransitionCancel"),Si(Jr,"onTransitionEnd"),yr("onMouseEnter",["mouseout","mouseover"]),yr("onMouseLeave",["mouseout","mouseover"]),yr("onPointerEnter",["pointerout","pointerover"]),yr("onPointerLeave",["pointerout","pointerover"]),Fn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Fn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Fn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Fn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Fn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Fn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),k2=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(zm));function Hx(f,_){_=(_&4)!==0;for(var A=0;A<f.length;A++){var F=f[A],Y=F.event;F=F.listeners;e:{var re=void 0;if(_)for(var Me=F.length-1;0<=Me;Me--){var Ge=F[Me],dt=Ge.instance,Nt=Ge.currentTarget;if(Ge=Ge.listener,dt!==re&&Y.isPropagationStopped())break e;re=Ge,Y.currentTarget=Nt;try{re(Y)}catch(yn){Ac(yn)}Y.currentTarget=null,re=dt}else for(Me=0;Me<F.length;Me++){if(Ge=F[Me],dt=Ge.instance,Nt=Ge.currentTarget,Ge=Ge.listener,dt!==re&&Y.isPropagationStopped())break e;re=Ge,Y.currentTarget=Nt;try{re(Y)}catch(yn){Ac(yn)}Y.currentTarget=null,re=dt}}}}function Ei(f,_){var A=_[Xe];A===void 0&&(A=_[Xe]=new Set);var F=f+"__bubble";A.has(F)||(oy(_,f,2,!1),A.add(F))}function Q_(f,_,A){var F=0;_&&(F|=4),oy(A,f,F,_)}var Lp="_reactListening"+Math.random().toString(36).slice(2);function ay(f){if(!f[Lp]){f[Lp]=!0,$n.forEach(function(A){A!=="selectionchange"&&(k2.has(A)||Q_(A,!1,f),Q_(A,!0,f))});var _=f.nodeType===9?f:f.ownerDocument;_===null||_[Lp]||(_[Lp]=!0,Q_("selectionchange",!1,_))}}function oy(f,_,A,F){switch(l1(_)){case 2:var Y=s1;break;case 8:Y=yv;break;default:Y=gy}A=Y.bind(null,_,A,f),Y=void 0,!kn||_!=="touchstart"&&_!=="touchmove"&&_!=="wheel"||(Y=!0),F?Y!==void 0?f.addEventListener(_,A,{capture:!0,passive:Y}):f.addEventListener(_,A,!0):Y!==void 0?f.addEventListener(_,A,{passive:Y}):f.addEventListener(_,A,!1)}function sy(f,_,A,F,Y){var re=F;if((_&1)===0&&(_&2)===0&&F!==null)e:for(;;){if(F===null)return;var Me=F.tag;if(Me===3||Me===4){var Ge=F.stateNode.containerInfo;if(Ge===Y||Ge.nodeType===8&&Ge.parentNode===Y)break;if(Me===4)for(Me=F.return;Me!==null;){var dt=Me.tag;if((dt===3||dt===4)&&(dt=Me.stateNode.containerInfo,dt===Y||dt.nodeType===8&&dt.parentNode===Y))return;Me=Me.return}for(;Ge!==null;){if(Me=xt(Ge),Me===null)return;if(dt=Me.tag,dt===5||dt===6||dt===26||dt===27){F=re=Me;continue e}Ge=Ge.parentNode}}F=F.return}rc(function(){var Nt=re,yn=Nn(A),Dn=[];e:{var rn=Qr.get(f);if(rn!==void 0){var gn=Ou,br=f;switch(f){case"keypress":if(ds(A)===0)break e;case"keydown":case"keyup":gn=qi;break;case"focusin":br="focus",gn=Oi;break;case"focusout":br="blur",gn=Oi;break;case"beforeblur":case"afterblur":gn=Oi;break;case"click":if(A.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":gn=da;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":gn=$f;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":gn=Iu;break;case Dt:case Ht:case bn:gn=Ba;break;case Jr:gn=Zf;break;case"scroll":case"scrollend":gn=zh;break;case"wheel":gn=Io;break;case"copy":case"cut":case"paste":gn=ic;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":gn=ac;break;case"toggle":case"beforetoggle":gn=Za}var ni=(_&4)!==0,ja=!ni&&(f==="scroll"||f==="scrollend"),Gt=ni?rn!==null?rn+"Capture":null:rn;ni=[];for(var Pt=Nt,Kt;Pt!==null;){var On=Pt;if(Kt=On.stateNode,On=On.tag,On!==5&&On!==26&&On!==27||Kt===null||Gt===null||(On=Lo(Pt,Gt),On!=null&&ni.push(Ad(Pt,On,Kt))),ja)break;Pt=Pt.return}0<ni.length&&(rn=new gn(rn,br,null,A,yn),Dn.push({event:rn,listeners:ni}))}}if((_&7)===0){e:{if(rn=f==="mouseover"||f==="pointerover",gn=f==="mouseout"||f==="pointerout",rn&&A!==Mu&&(br=A.relatedTarget||A.fromElement)&&(xt(br)||br[Fe]))break e;if((gn||rn)&&(rn=yn.window===yn?yn:(rn=yn.ownerDocument)?rn.defaultView||rn.parentWindow:window,gn?(br=A.relatedTarget||A.toElement,gn=Nt,br=br?xt(br):null,br!==null&&(ja=Zt(br),ni=br.tag,br!==ja||ni!==5&&ni!==27&&ni!==6)&&(br=null)):(gn=null,br=Nt),gn!==br)){if(ni=da,On="onMouseLeave",Gt="onMouseEnter",Pt="mouse",(f==="pointerout"||f==="pointerover")&&(ni=ac,On="onPointerLeave",Gt="onPointerEnter",Pt="pointer"),ja=gn==null?rn:un(gn),Kt=br==null?rn:un(br),rn=new ni(On,Pt+"leave",gn,A,yn),rn.target=ja,rn.relatedTarget=Kt,On=null,xt(yn)===Nt&&(ni=new ni(Gt,Pt+"enter",br,A,yn),ni.target=Kt,ni.relatedTarget=ja,On=ni),ja=On,gn&&br)t:{for(ni=gn,Gt=br,Pt=0,Kt=ni;Kt;Kt=Md(Kt))Pt++;for(Kt=0,On=Gt;On;On=Md(On))Kt++;for(;0<Pt-Kt;)ni=Md(ni),Pt--;for(;0<Kt-Pt;)Gt=Md(Gt),Kt--;for(;Pt--;){if(ni===Gt||Gt!==null&&ni===Gt.alternate)break t;ni=Md(ni),Gt=Md(Gt)}ni=null}else ni=null;gn!==null&&Bm(Dn,rn,gn,ni,!1),br!==null&&ja!==null&&Bm(Dn,ja,br,ni,!0)}}e:{if(rn=Nt?un(Nt):window,gn=rn.nodeName&&rn.nodeName.toLowerCase(),gn==="select"||gn==="input"&&rn.type==="file")var fr=jh;else if(Qn(rn))if(Jc)fr=Vs;else{fr=ru;var Zr=uc}else gn=rn.nodeName,!gn||gn.toLowerCase()!=="input"||rn.type!=="checkbox"&&rn.type!=="radio"?Nt&&nc(Nt.elementType)&&(fr=jh):fr=Oa;if(fr&&(fr=fr(f,Nt))){tu(Dn,fr,A,yn);break e}Zr&&Zr(f,rn,Nt),f==="focusout"&&Nt&&rn.type==="number"&&Nt.memoizedProps.value!=null&&Bs(rn,"number",rn.value)}switch(Zr=Nt?un(Nt):window,f){case"focusin":(Qn(Zr)||Zr.contentEditable==="true")&&(C=Zr,g=Nt,x=null);break;case"focusout":x=g=C=null;break;case"mousedown":O=!0;break;case"contextmenu":case"mouseup":case"dragend":O=!1,$(Dn,A,yn);break;case"selectionchange":if(ys)break;case"keydown":case"keyup":$(Dn,A,yn)}var Mr;if(Us)e:{switch(f){case"compositionstart":var Fr="onCompositionStart";break e;case"compositionend":Fr="onCompositionEnd";break e;case"compositionupdate":Fr="onCompositionUpdate";break e}Fr=void 0}else ms?ap(f,A)&&(Fr="onCompositionEnd"):f==="keydown"&&A.keyCode===229&&(Fr="onCompositionStart");Fr&&(Kc&&A.locale!=="ko"&&(ms||Fr!=="onCompositionStart"?Fr==="onCompositionEnd"&&ms&&(Mr=Br()):(Vn=yn,zi="value"in Vn?Vn.value:Vn.textContent,ms=!0)),Zr=Nm(Nt,Fr),0<Zr.length&&(Fr=new eu(Fr,f,null,A,yn),Dn.push({event:Fr,listeners:Zr}),Mr?Fr.data=Mr:(Mr=Bh(A),Mr!==null&&(Fr.data=Mr)))),(Mr=ip?vr(f,A):qn(f,A))&&(Fr=Nm(Nt,"onBeforeInput"),0<Fr.length&&(Zr=new eu("onBeforeInput","beforeinput",null,A,yn),Dn.push({event:Zr,listeners:Fr}),Zr.data=Mr)),J_(Dn,f,Nt,A,yn)}Hx(Dn,_)})}function Ad(f,_,A){return{instance:f,listener:_,currentTarget:A}}function Nm(f,_){for(var A=_+"Capture",F=[];f!==null;){var Y=f,re=Y.stateNode;Y=Y.tag,Y!==5&&Y!==26&&Y!==27||re===null||(Y=Lo(f,A),Y!=null&&F.unshift(Ad(f,Y,re)),Y=Lo(f,_),Y!=null&&F.push(Ad(f,Y,re))),f=f.return}return F}function Md(f){if(f===null)return null;do f=f.return;while(f&&f.tag!==5&&f.tag!==27);return f||null}function Bm(f,_,A,F,Y){for(var re=_._reactName,Me=[];A!==null&&A!==F;){var Ge=A,dt=Ge.alternate,Nt=Ge.stateNode;if(Ge=Ge.tag,dt!==null&&dt===F)break;Ge!==5&&Ge!==26&&Ge!==27||Nt===null||(dt=Nt,Y?(Nt=Lo(A,re),Nt!=null&&Me.unshift(Ad(A,Nt,dt))):Y||(Nt=Lo(A,re),Nt!=null&&Me.push(Ad(A,Nt,dt)))),A=A.return}Me.length!==0&&f.push({event:_,listeners:Me})}var Xx=/\r\n?/g,Yx=/\u0000|\uFFFD/g;function ev(f){return(typeof f=="string"?f:""+f).replace(Xx,`
`).replace(Yx,"")}function Od(f,_){return _=ev(_),ev(f)===_}function Dc(){}function ra(f,_,A,F,Y,re){switch(A){case"children":typeof F=="string"?_==="body"||_==="textarea"&&F===""||il(f,F):(typeof F=="number"||typeof F=="bigint")&&_!=="body"&&il(f,""+F);break;case"className":ta(f,"class",F);break;case"tabIndex":ta(f,"tabindex",F);break;case"dir":case"role":case"viewBox":case"width":case"height":ta(f,A,F);break;case"style":Ol(f,F,re);break;case"data":if(_!=="object"){ta(f,"data",F);break}case"src":case"href":if(F===""&&(_!=="a"||A!=="href")){f.removeAttribute(A);break}if(F==null||typeof F=="function"||typeof F=="symbol"||typeof F=="boolean"){f.removeAttribute(A);break}F=Vr(""+F),f.setAttribute(A,F);break;case"action":case"formAction":if(typeof F=="function"){f.setAttribute(A,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof re=="function"&&(A==="formAction"?(_!=="input"&&ra(f,_,"name",Y.name,Y,null),ra(f,_,"formEncType",Y.formEncType,Y,null),ra(f,_,"formMethod",Y.formMethod,Y,null),ra(f,_,"formTarget",Y.formTarget,Y,null)):(ra(f,_,"encType",Y.encType,Y,null),ra(f,_,"method",Y.method,Y,null),ra(f,_,"target",Y.target,Y,null)));if(F==null||typeof F=="symbol"||typeof F=="boolean"){f.removeAttribute(A);break}F=Vr(""+F),f.setAttribute(A,F);break;case"onClick":F!=null&&(f.onclick=Dc);break;case"onScroll":F!=null&&Ei("scroll",f);break;case"onScrollEnd":F!=null&&Ei("scrollend",f);break;case"dangerouslySetInnerHTML":if(F!=null){if(typeof F!="object"||!("__html"in F))throw Error(o(61));if(A=F.__html,A!=null){if(Y.children!=null)throw Error(o(60));f.innerHTML=A}}break;case"multiple":f.multiple=F&&typeof F!="function"&&typeof F!="symbol";break;case"muted":f.muted=F&&typeof F!="function"&&typeof F!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(F==null||typeof F=="function"||typeof F=="boolean"||typeof F=="symbol"){f.removeAttribute("xlink:href");break}A=Vr(""+F),f.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",A);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":F!=null&&typeof F!="function"&&typeof F!="symbol"?f.setAttribute(A,""+F):f.removeAttribute(A);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":F&&typeof F!="function"&&typeof F!="symbol"?f.setAttribute(A,""):f.removeAttribute(A);break;case"capture":case"download":F===!0?f.setAttribute(A,""):F!==!1&&F!=null&&typeof F!="function"&&typeof F!="symbol"?f.setAttribute(A,F):f.removeAttribute(A);break;case"cols":case"rows":case"size":case"span":F!=null&&typeof F!="function"&&typeof F!="symbol"&&!isNaN(F)&&1<=F?f.setAttribute(A,F):f.removeAttribute(A);break;case"rowSpan":case"start":F==null||typeof F=="function"||typeof F=="symbol"||isNaN(F)?f.removeAttribute(A):f.setAttribute(A,F);break;case"popover":Ei("beforetoggle",f),Ei("toggle",f),Ao(f,"popover",F);break;case"xlinkActuate":Ri(f,"http://www.w3.org/1999/xlink","xlink:actuate",F);break;case"xlinkArcrole":Ri(f,"http://www.w3.org/1999/xlink","xlink:arcrole",F);break;case"xlinkRole":Ri(f,"http://www.w3.org/1999/xlink","xlink:role",F);break;case"xlinkShow":Ri(f,"http://www.w3.org/1999/xlink","xlink:show",F);break;case"xlinkTitle":Ri(f,"http://www.w3.org/1999/xlink","xlink:title",F);break;case"xlinkType":Ri(f,"http://www.w3.org/1999/xlink","xlink:type",F);break;case"xmlBase":Ri(f,"http://www.w3.org/XML/1998/namespace","xml:base",F);break;case"xmlLang":Ri(f,"http://www.w3.org/XML/1998/namespace","xml:lang",F);break;case"xmlSpace":Ri(f,"http://www.w3.org/XML/1998/namespace","xml:space",F);break;case"is":Ao(f,"is",F);break;case"innerText":case"textContent":break;default:(!(2<A.length)||A[0]!=="o"&&A[0]!=="O"||A[1]!=="n"&&A[1]!=="N")&&(A=Hi.get(A)||A,Ao(f,A,F))}}function zp(f,_,A,F,Y,re){switch(A){case"style":Ol(f,F,re);break;case"dangerouslySetInnerHTML":if(F!=null){if(typeof F!="object"||!("__html"in F))throw Error(o(61));if(A=F.__html,A!=null){if(Y.children!=null)throw Error(o(60));f.innerHTML=A}}break;case"children":typeof F=="string"?il(f,F):(typeof F=="number"||typeof F=="bigint")&&il(f,""+F);break;case"onScroll":F!=null&&Ei("scroll",f);break;case"onScrollEnd":F!=null&&Ei("scrollend",f);break;case"onClick":F!=null&&(f.onclick=Dc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Xn.hasOwnProperty(A))e:{if(A[0]==="o"&&A[1]==="n"&&(Y=A.endsWith("Capture"),_=A.slice(2,Y?A.length-7:void 0),re=f[Ie]||null,re=re!=null?re[A]:null,typeof re=="function"&&f.removeEventListener(_,re,Y),typeof F=="function")){typeof re!="function"&&re!==null&&(A in f?f[A]=null:f.hasAttribute(A)&&f.removeAttribute(A)),f.addEventListener(_,F,Y);break e}A in f?f[A]=F:F===!0?f.setAttribute(A,""):Ao(f,A,F)}}}function Ho(f,_,A){switch(_){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ei("error",f),Ei("load",f);var F=!1,Y=!1,re;for(re in A)if(A.hasOwnProperty(re)){var Me=A[re];if(Me!=null)switch(re){case"src":F=!0;break;case"srcSet":Y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,_));default:ra(f,_,re,Me,A,null)}}Y&&ra(f,_,"srcSet",A.srcSet,A,null),F&&ra(f,_,"src",A.src,A,null);return;case"input":Ei("invalid",f);var Ge=re=Me=Y=null,dt=null,Nt=null;for(F in A)if(A.hasOwnProperty(F)){var yn=A[F];if(yn!=null)switch(F){case"name":Y=yn;break;case"type":Me=yn;break;case"checked":dt=yn;break;case"defaultChecked":Nt=yn;break;case"value":re=yn;break;case"defaultValue":Ge=yn;break;case"children":case"dangerouslySetInnerHTML":if(yn!=null)throw Error(o(137,_));break;default:ra(f,_,F,yn,A,null)}}hs(f,re,Ge,dt,Nt,Me,Y,!1),Ns(f);return;case"select":Ei("invalid",f),F=Me=re=null;for(Y in A)if(A.hasOwnProperty(Y)&&(Ge=A[Y],Ge!=null))switch(Y){case"value":re=Ge;break;case"defaultValue":Me=Ge;break;case"multiple":F=Ge;default:ra(f,_,Y,Ge,A,null)}_=re,A=Me,f.multiple=!!F,_!=null?Mo(f,!!F,_,!1):A!=null&&Mo(f,!!F,A,!0);return;case"textarea":Ei("invalid",f),re=Y=F=null;for(Me in A)if(A.hasOwnProperty(Me)&&(Ge=A[Me],Ge!=null))switch(Me){case"value":F=Ge;break;case"defaultValue":Y=Ge;break;case"children":re=Ge;break;case"dangerouslySetInnerHTML":if(Ge!=null)throw Error(o(91));break;default:ra(f,_,Me,Ge,A,null)}Oo(f,F,Y,re),Ns(f);return;case"option":for(dt in A)if(A.hasOwnProperty(dt)&&(F=A[dt],F!=null))switch(dt){case"selected":f.selected=F&&typeof F!="function"&&typeof F!="symbol";break;default:ra(f,_,dt,F,A,null)}return;case"dialog":Ei("cancel",f),Ei("close",f);break;case"iframe":case"object":Ei("load",f);break;case"video":case"audio":for(F=0;F<zm.length;F++)Ei(zm[F],f);break;case"image":Ei("error",f),Ei("load",f);break;case"details":Ei("toggle",f);break;case"embed":case"source":case"link":Ei("error",f),Ei("load",f);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Nt in A)if(A.hasOwnProperty(Nt)&&(F=A[Nt],F!=null))switch(Nt){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,_));default:ra(f,_,Nt,F,A,null)}return;default:if(nc(_)){for(yn in A)A.hasOwnProperty(yn)&&(F=A[yn],F!==void 0&&zp(f,_,yn,F,A,void 0));return}}for(Ge in A)A.hasOwnProperty(Ge)&&(F=A[Ge],F!=null&&ra(f,_,Ge,F,A,null))}function Zx(f,_,A,F){switch(_){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var Y=null,re=null,Me=null,Ge=null,dt=null,Nt=null,yn=null;for(gn in A){var Dn=A[gn];if(A.hasOwnProperty(gn)&&Dn!=null)switch(gn){case"checked":break;case"value":break;case"defaultValue":dt=Dn;default:F.hasOwnProperty(gn)||ra(f,_,gn,null,F,Dn)}}for(var rn in F){var gn=F[rn];if(Dn=A[rn],F.hasOwnProperty(rn)&&(gn!=null||Dn!=null))switch(rn){case"type":re=gn;break;case"name":Y=gn;break;case"checked":Nt=gn;break;case"defaultChecked":yn=gn;break;case"value":Me=gn;break;case"defaultValue":Ge=gn;break;case"children":case"dangerouslySetInnerHTML":if(gn!=null)throw Error(o(137,_));break;default:gn!==Dn&&ra(f,_,rn,gn,F,Dn)}}Ha(f,Me,Ge,dt,Nt,yn,re,Y);return;case"select":gn=Me=Ge=rn=null;for(re in A)if(dt=A[re],A.hasOwnProperty(re)&&dt!=null)switch(re){case"value":break;case"multiple":gn=dt;default:F.hasOwnProperty(re)||ra(f,_,re,null,F,dt)}for(Y in F)if(re=F[Y],dt=A[Y],F.hasOwnProperty(Y)&&(re!=null||dt!=null))switch(Y){case"value":rn=re;break;case"defaultValue":Ge=re;break;case"multiple":Me=re;default:re!==dt&&ra(f,_,Y,re,F,dt)}_=Ge,A=Me,F=gn,rn!=null?Mo(f,!!A,rn,!1):!!F!=!!A&&(_!=null?Mo(f,!!A,_,!0):Mo(f,!!A,A?[]:"",!1));return;case"textarea":gn=rn=null;for(Ge in A)if(Y=A[Ge],A.hasOwnProperty(Ge)&&Y!=null&&!F.hasOwnProperty(Ge))switch(Ge){case"value":break;case"children":break;default:ra(f,_,Ge,null,F,Y)}for(Me in F)if(Y=F[Me],re=A[Me],F.hasOwnProperty(Me)&&(Y!=null||re!=null))switch(Me){case"value":rn=Y;break;case"defaultValue":gn=Y;break;case"children":break;case"dangerouslySetInnerHTML":if(Y!=null)throw Error(o(91));break;default:Y!==re&&ra(f,_,Me,Y,F,re)}Wo(f,rn,gn);return;case"option":for(var br in A)if(rn=A[br],A.hasOwnProperty(br)&&rn!=null&&!F.hasOwnProperty(br))switch(br){case"selected":f.selected=!1;break;default:ra(f,_,br,null,F,rn)}for(dt in F)if(rn=F[dt],gn=A[dt],F.hasOwnProperty(dt)&&rn!==gn&&(rn!=null||gn!=null))switch(dt){case"selected":f.selected=rn&&typeof rn!="function"&&typeof rn!="symbol";break;default:ra(f,_,dt,rn,F,gn)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ni in A)rn=A[ni],A.hasOwnProperty(ni)&&rn!=null&&!F.hasOwnProperty(ni)&&ra(f,_,ni,null,F,rn);for(Nt in F)if(rn=F[Nt],gn=A[Nt],F.hasOwnProperty(Nt)&&rn!==gn&&(rn!=null||gn!=null))switch(Nt){case"children":case"dangerouslySetInnerHTML":if(rn!=null)throw Error(o(137,_));break;default:ra(f,_,Nt,rn,F,gn)}return;default:if(nc(_)){for(var ja in A)rn=A[ja],A.hasOwnProperty(ja)&&rn!==void 0&&!F.hasOwnProperty(ja)&&zp(f,_,ja,void 0,F,rn);for(yn in F)rn=F[yn],gn=A[yn],!F.hasOwnProperty(yn)||rn===gn||rn===void 0&&gn===void 0||zp(f,_,yn,rn,F,gn);return}}for(var Gt in A)rn=A[Gt],A.hasOwnProperty(Gt)&&rn!=null&&!F.hasOwnProperty(Gt)&&ra(f,_,Gt,null,F,rn);for(Dn in F)rn=F[Dn],gn=A[Dn],!F.hasOwnProperty(Dn)||rn===gn||rn==null&&gn==null||ra(f,_,Dn,rn,F,gn)}var Np=null,ly=null;function Id(f){return f.nodeType===9?f:f.ownerDocument}function tv(f){switch(f){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function uy(f,_){if(f===0)switch(_){case"svg":return 1;case"math":return 2;default:return 0}return f===1&&_==="foreignObject"?0:f}function Fm(f,_){return f==="textarea"||f==="noscript"||typeof _.children=="string"||typeof _.children=="number"||typeof _.children=="bigint"||typeof _.dangerouslySetInnerHTML=="object"&&_.dangerouslySetInnerHTML!==null&&_.dangerouslySetInnerHTML.__html!=null}var cy=null;function D2(){var f=window.event;return f&&f.type==="popstate"?f===cy?!1:(cy=f,!0):(cy=null,!1)}var nv=typeof setTimeout=="function"?setTimeout:void 0,Wx=typeof clearTimeout=="function"?clearTimeout:void 0,rv=typeof Promise=="function"?Promise:void 0,Kx=typeof queueMicrotask=="function"?queueMicrotask:typeof rv<"u"?function(f){return rv.resolve(null).then(f).catch(iv)}:nv;function iv(f){setTimeout(function(){throw f})}function hy(f,_){var A=_,F=0;do{var Y=A.nextSibling;if(f.removeChild(A),Y&&Y.nodeType===8)if(A=Y.data,A==="/$"){if(F===0){f.removeChild(Y),Zm(_);return}F--}else A!=="$"&&A!=="$?"&&A!=="$!"||F++;A=Y}while(A);Zm(_)}function jm(f){var _=f.firstChild;for(_&&_.nodeType===10&&(_=_.nextSibling);_;){var A=_;switch(_=_.nextSibling,A.nodeName){case"HTML":case"HEAD":case"BODY":jm(A),gt(A);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(A.rel.toLowerCase()==="stylesheet")continue}f.removeChild(A)}}function L2(f,_,A,F){for(;f.nodeType===1;){var Y=A;if(f.nodeName.toLowerCase()!==_.toLowerCase()){if(!F&&(f.nodeName!=="INPUT"||f.type!=="hidden"))break}else if(F){if(!f[vt])switch(_){case"meta":if(!f.hasAttribute("itemprop"))break;return f;case"link":if(re=f.getAttribute("rel"),re==="stylesheet"&&f.hasAttribute("data-precedence"))break;if(re!==Y.rel||f.getAttribute("href")!==(Y.href==null?null:Y.href)||f.getAttribute("crossorigin")!==(Y.crossOrigin==null?null:Y.crossOrigin)||f.getAttribute("title")!==(Y.title==null?null:Y.title))break;return f;case"style":if(f.hasAttribute("data-precedence"))break;return f;case"script":if(re=f.getAttribute("src"),(re!==(Y.src==null?null:Y.src)||f.getAttribute("type")!==(Y.type==null?null:Y.type)||f.getAttribute("crossorigin")!==(Y.crossOrigin==null?null:Y.crossOrigin))&&re&&f.hasAttribute("async")&&!f.hasAttribute("itemprop"))break;return f;default:return f}}else if(_==="input"&&f.type==="hidden"){var re=Y.name==null?null:""+Y.name;if(Y.type==="hidden"&&f.getAttribute("name")===re)return f}else return f;if(f=Hu(f.nextSibling),f===null)break}return null}function z2(f,_,A){if(_==="")return null;for(;f.nodeType!==3;)if((f.nodeType!==1||f.nodeName!=="INPUT"||f.type!=="hidden")&&!A||(f=Hu(f.nextSibling),f===null))return null;return f}function Hu(f){for(;f!=null;f=f.nextSibling){var _=f.nodeType;if(_===1||_===3)break;if(_===8){if(_=f.data,_==="$"||_==="$!"||_==="$?"||_==="F!"||_==="F")break;if(_==="/$")return null}}return f}function Jx(f){f=f.previousSibling;for(var _=0;f;){if(f.nodeType===8){var A=f.data;if(A==="$"||A==="$!"||A==="$?"){if(_===0)return f;_--}else A==="/$"&&_++}f=f.previousSibling}return null}function av(f,_,A){switch(_=Id(A),f){case"html":if(f=_.documentElement,!f)throw Error(o(452));return f;case"head":if(f=_.head,!f)throw Error(o(453));return f;case"body":if(f=_.body,!f)throw Error(o(454));return f;default:throw Error(o(451))}}var Ro=new Map,Bp=new Set;function xf(f){return typeof f.getRootNode=="function"?f.getRootNode():f.ownerDocument}var xu=cn.d;cn.d={f:Um,r:Qx,D:e1,C:N2,L:B2,m:t1,X:n1,S:fy,M:F2};function Um(){var f=xu.f(),_=Rm();return f||_}function Qx(f){var _=Ct(f);_!==null&&_.tag===5&&_.type==="form"?lf(_):xu.r(f)}var Cd=typeof document>"u"?null:document;function ov(f,_,A){var F=Cd;if(F&&typeof _=="string"&&_){var Y=Na(_);Y='link[rel="'+f+'"][href="'+Y+'"]',typeof A=="string"&&(Y+='[crossorigin="'+A+'"]'),Bp.has(Y)||(Bp.add(Y),f={rel:f,crossOrigin:A,href:_},F.querySelector(Y)===null&&(_=F.createElement("link"),Ho(_,"link",f),Rn(_),F.head.appendChild(_)))}}function e1(f){xu.D(f),ov("dns-prefetch",f,null)}function N2(f,_){xu.C(f,_),ov("preconnect",f,_)}function B2(f,_,A){xu.L(f,_,A);var F=Cd;if(F&&f&&_){var Y='link[rel="preload"][as="'+Na(_)+'"]';_==="image"&&A&&A.imageSrcSet?(Y+='[imagesrcset="'+Na(A.imageSrcSet)+'"]',typeof A.imageSizes=="string"&&(Y+='[imagesizes="'+Na(A.imageSizes)+'"]')):Y+='[href="'+Na(f)+'"]';var re=Y;switch(_){case"style":re=bf(f);break;case"script":re=Pd(f)}Ro.has(re)||(f=st({rel:"preload",href:_==="image"&&A&&A.imageSrcSet?void 0:f,as:_},A),Ro.set(re,f),F.querySelector(Y)!==null||_==="style"&&F.querySelector(Fp(re))||_==="script"&&F.querySelector(jp(re))||(_=F.createElement("link"),Ho(_,"link",f),Rn(_),F.head.appendChild(_)))}}function t1(f,_){xu.m(f,_);var A=Cd;if(A&&f){var F=_&&typeof _.as=="string"?_.as:"script",Y='link[rel="modulepreload"][as="'+Na(F)+'"][href="'+Na(f)+'"]',re=Y;switch(F){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":re=Pd(f)}if(!Ro.has(re)&&(f=st({rel:"modulepreload",href:f},_),Ro.set(re,f),A.querySelector(Y)===null)){switch(F){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(A.querySelector(jp(re)))return}F=A.createElement("link"),Ho(F,"link",f),Rn(F),A.head.appendChild(F)}}}function fy(f,_,A){xu.S(f,_,A);var F=Cd;if(F&&f){var Y=hn(F).hoistableStyles,re=bf(f);_=_||"default";var Me=Y.get(re);if(!Me){var Ge={loading:0,preload:null};if(Me=F.querySelector(Fp(re)))Ge.loading=5;else{f=st({rel:"stylesheet",href:f,"data-precedence":_},A),(A=Ro.get(re))&&dy(f,A);var dt=Me=F.createElement("link");Rn(dt),Ho(dt,"link",f),dt._p=new Promise(function(Nt,yn){dt.onload=Nt,dt.onerror=yn}),dt.addEventListener("load",function(){Ge.loading|=1}),dt.addEventListener("error",function(){Ge.loading|=2}),Ge.loading|=4,Vm(Me,_,F)}Me={type:"stylesheet",instance:Me,count:1,state:Ge},Y.set(re,Me)}}}function n1(f,_){xu.X(f,_);var A=Cd;if(A&&f){var F=hn(A).hoistableScripts,Y=Pd(f),re=F.get(Y);re||(re=A.querySelector(jp(Y)),re||(f=st({src:f,async:!0},_),(_=Ro.get(Y))&&Rd(f,_),re=A.createElement("script"),Rn(re),Ho(re,"link",f),A.head.appendChild(re)),re={type:"script",instance:re,count:1,state:null},F.set(Y,re))}}function F2(f,_){xu.M(f,_);var A=Cd;if(A&&f){var F=hn(A).hoistableScripts,Y=Pd(f),re=F.get(Y);re||(re=A.querySelector(jp(Y)),re||(f=st({src:f,async:!0,type:"module"},_),(_=Ro.get(Y))&&Rd(f,_),re=A.createElement("script"),Rn(re),Ho(re,"link",f),A.head.appendChild(re)),re={type:"script",instance:re,count:1,state:null},F.set(Y,re))}}function sv(f,_,A,F){var Y=(Y=jr.current)?xf(Y):null;if(!Y)throw Error(o(446));switch(f){case"meta":case"title":return null;case"style":return typeof A.precedence=="string"&&typeof A.href=="string"?(_=bf(A.href),A=hn(Y).hoistableStyles,F=A.get(_),F||(F={type:"style",instance:null,count:0,state:null},A.set(_,F)),F):{type:"void",instance:null,count:0,state:null};case"link":if(A.rel==="stylesheet"&&typeof A.href=="string"&&typeof A.precedence=="string"){f=bf(A.href);var re=hn(Y).hoistableStyles,Me=re.get(f);if(Me||(Y=Y.ownerDocument||Y,Me={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},re.set(f,Me),(re=Y.querySelector(Fp(f)))&&!re._p&&(Me.instance=re,Me.state.loading=5),Ro.has(f)||(A={rel:"preload",as:"style",href:A.href,crossOrigin:A.crossOrigin,integrity:A.integrity,media:A.media,hrefLang:A.hrefLang,referrerPolicy:A.referrerPolicy},Ro.set(f,A),re||r1(Y,f,A,Me.state))),_&&F===null)throw Error(o(528,""));return Me}if(_&&F!==null)throw Error(o(529,""));return null;case"script":return _=A.async,A=A.src,typeof A=="string"&&_&&typeof _!="function"&&typeof _!="symbol"?(_=Pd(A),A=hn(Y).hoistableScripts,F=A.get(_),F||(F={type:"script",instance:null,count:0,state:null},A.set(_,F)),F):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,f))}}function bf(f){return'href="'+Na(f)+'"'}function Fp(f){return'link[rel="stylesheet"]['+f+"]"}function lv(f){return st({},f,{"data-precedence":f.precedence,precedence:null})}function r1(f,_,A,F){f.querySelector('link[rel="preload"][as="style"]['+_+"]")?F.loading=1:(_=f.createElement("link"),F.preload=_,_.addEventListener("load",function(){return F.loading|=1}),_.addEventListener("error",function(){return F.loading|=2}),Ho(_,"link",A),Rn(_),f.head.appendChild(_))}function Pd(f){return'[src="'+Na(f)+'"]'}function jp(f){return"script[async]"+f}function i1(f,_,A){if(_.count++,_.instance===null)switch(_.type){case"style":var F=f.querySelector('style[data-href~="'+Na(A.href)+'"]');if(F)return _.instance=F,Rn(F),F;var Y=st({},A,{"data-href":A.href,"data-precedence":A.precedence,href:null,precedence:null});return F=(f.ownerDocument||f).createElement("style"),Rn(F),Ho(F,"style",Y),Vm(F,A.precedence,f),_.instance=F;case"stylesheet":Y=bf(A.href);var re=f.querySelector(Fp(Y));if(re)return _.state.loading|=4,_.instance=re,Rn(re),re;F=lv(A),(Y=Ro.get(Y))&&dy(F,Y),re=(f.ownerDocument||f).createElement("link"),Rn(re);var Me=re;return Me._p=new Promise(function(Ge,dt){Me.onload=Ge,Me.onerror=dt}),Ho(re,"link",F),_.state.loading|=4,Vm(re,A.precedence,f),_.instance=re;case"script":return re=Pd(A.src),(Y=f.querySelector(jp(re)))?(_.instance=Y,Rn(Y),Y):(F=A,(Y=Ro.get(re))&&(F=st({},A),Rd(F,Y)),f=f.ownerDocument||f,Y=f.createElement("script"),Rn(Y),Ho(Y,"link",F),f.head.appendChild(Y),_.instance=Y);case"void":return null;default:throw Error(o(443,_.type))}else _.type==="stylesheet"&&(_.state.loading&4)===0&&(F=_.instance,_.state.loading|=4,Vm(F,A.precedence,f));return _.instance}function Vm(f,_,A){for(var F=A.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),Y=F.length?F[F.length-1]:null,re=Y,Me=0;Me<F.length;Me++){var Ge=F[Me];if(Ge.dataset.precedence===_)re=Ge;else if(re!==Y)break}re?re.parentNode.insertBefore(f,re.nextSibling):(_=A.nodeType===9?A.head:A,_.insertBefore(f,_.firstChild))}function dy(f,_){f.crossOrigin==null&&(f.crossOrigin=_.crossOrigin),f.referrerPolicy==null&&(f.referrerPolicy=_.referrerPolicy),f.title==null&&(f.title=_.title)}function Rd(f,_){f.crossOrigin==null&&(f.crossOrigin=_.crossOrigin),f.referrerPolicy==null&&(f.referrerPolicy=_.referrerPolicy),f.integrity==null&&(f.integrity=_.integrity)}var qm=null;function uv(f,_,A){if(qm===null){var F=new Map,Y=qm=new Map;Y.set(A,F)}else Y=qm,F=Y.get(A),F||(F=new Map,Y.set(A,F));if(F.has(f))return F;for(F.set(f,null),A=A.getElementsByTagName(f),Y=0;Y<A.length;Y++){var re=A[Y];if(!(re[vt]||re[xe]||f==="link"&&re.getAttribute("rel")==="stylesheet")&&re.namespaceURI!=="http://www.w3.org/2000/svg"){var Me=re.getAttribute(_)||"";Me=f+Me;var Ge=F.get(Me);Ge?Ge.push(re):F.set(Me,[re])}}return F}function a1(f,_,A){f=f.ownerDocument||f,f.head.insertBefore(A,_==="title"?f.querySelector("head > title"):null)}function j2(f,_,A){if(A===1||_.itemProp!=null)return!1;switch(f){case"meta":case"title":return!0;case"style":if(typeof _.precedence!="string"||typeof _.href!="string"||_.href==="")break;return!0;case"link":if(typeof _.rel!="string"||typeof _.href!="string"||_.href===""||_.onLoad||_.onError)break;switch(_.rel){case"stylesheet":return f=_.disabled,typeof _.precedence=="string"&&f==null;default:return!0}case"script":if(_.async&&typeof _.async!="function"&&typeof _.async!="symbol"&&!_.onLoad&&!_.onError&&_.src&&typeof _.src=="string")return!0}return!1}function o1(f){return!(f.type==="stylesheet"&&(f.state.loading&3)===0)}var Gm=null;function U2(){}function V2(f,_,A){if(Gm===null)throw Error(o(475));var F=Gm;if(_.type==="stylesheet"&&(typeof A.media!="string"||matchMedia(A.media).matches!==!1)&&(_.state.loading&4)===0){if(_.instance===null){var Y=bf(A.href),re=f.querySelector(Fp(Y));if(re){f=re._p,f!==null&&typeof f=="object"&&typeof f.then=="function"&&(F.count++,F=$m.bind(F),f.then(F,F)),_.state.loading|=4,_.instance=re,Rn(re);return}re=f.ownerDocument||f,A=lv(A),(Y=Ro.get(Y))&&dy(A,Y),re=re.createElement("link"),Rn(re);var Me=re;Me._p=new Promise(function(Ge,dt){Me.onload=Ge,Me.onerror=dt}),Ho(re,"link",A),_.instance=re}F.stylesheets===null&&(F.stylesheets=new Map),F.stylesheets.set(_,f),(f=_.state.preload)&&(_.state.loading&3)===0&&(F.count++,_=$m.bind(F),f.addEventListener("load",_),f.addEventListener("error",_))}}function q2(){if(Gm===null)throw Error(o(475));var f=Gm;return f.stylesheets&&f.count===0&&cv(f,f.stylesheets),0<f.count?function(_){var A=setTimeout(function(){if(f.stylesheets&&cv(f,f.stylesheets),f.unsuspend){var F=f.unsuspend;f.unsuspend=null,F()}},6e4);return f.unsuspend=_,function(){f.unsuspend=null,clearTimeout(A)}}:null}function $m(){if(this.count--,this.count===0){if(this.stylesheets)cv(this,this.stylesheets);else if(this.unsuspend){var f=this.unsuspend;this.unsuspend=null,f()}}}var py=null;function cv(f,_){f.stylesheets=null,f.unsuspend!==null&&(f.count++,py=new Map,_.forEach(G2,f),py=null,$m.call(f))}function G2(f,_){if(!(_.state.loading&4)){var A=py.get(f);if(A)var F=A.get(null);else{A=new Map,py.set(f,A);for(var Y=f.querySelectorAll("link[data-precedence],style[data-precedence]"),re=0;re<Y.length;re++){var Me=Y[re];(Me.nodeName==="LINK"||Me.getAttribute("media")!=="not all")&&(A.set(Me.dataset.precedence,Me),F=Me)}F&&A.set(null,F)}Y=_.instance,Me=Y.getAttribute("data-precedence"),re=A.get(Me)||F,re===F&&A.set(null,Y),A.set(Me,Y),this.count++,F=$m.bind(this),Y.addEventListener("load",F),Y.addEventListener("error",F),re?re.parentNode.insertBefore(Y,re.nextSibling):(f=f.nodeType===9?f.head:f,f.insertBefore(Y,f.firstChild)),_.state.loading|=4}}var kd={$$typeof:ee,Provider:null,Consumer:null,_currentValue:rr,_currentValue2:rr,_threadCount:0};function hv(f,_,A,F,Y,re,Me,Ge){this.tag=1,this.containerInfo=f,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ml(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ml(0),this.hiddenUpdates=Ml(null),this.identifierPrefix=F,this.onUncaughtError=Y,this.onCaughtError=re,this.onRecoverableError=Me,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Ge,this.incompleteTransitions=new Map}function fv(f,_,A,F,Y,re,Me,Ge,dt,Nt,yn,Dn){return f=new hv(f,_,A,Me,Ge,dt,Nt,Dn),_=1,re===!0&&(_|=24),re=zt(3,null,null,_),f.current=re,re.stateNode=f,_=Jh(),_.refCount++,f.pooledCache=_,_.refCount++,re.memoizedState={element:F,isDehydrated:A,cache:_},Pp(re),f}function dv(f){return f?(f=kl,f):kl}function pv(f,_,A,F,Y,re){Y=dv(Y),F.context===null?F.context=Y:F.pendingContext=Y,F=Ys(_),F.payload={element:A},re=re===void 0?null:re,re!==null&&(F.callback=re),A=qu(f,F,_),A!==null&&(Js(A,f,_),mf(A,f,_))}function mv(f,_){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var A=f.retryLane;f.retryLane=A!==0&&A<_?A:_}}function my(f,_){mv(f,_),(f=f.alternate)&&mv(f,_)}function gv(f){if(f.tag===13){var _=jo(f,67108864);_!==null&&Js(_,f,67108864),my(f,67108864)}}var Hm=!0;function s1(f,_,A,F){var Y=He.T;He.T=null;var re=cn.p;try{cn.p=2,gy(f,_,A,F)}finally{cn.p=re,He.T=Y}}function yv(f,_,A,F){var Y=He.T;He.T=null;var re=cn.p;try{cn.p=8,gy(f,_,A,F)}finally{cn.p=re,He.T=Y}}function gy(f,_,A,F){if(Hm){var Y=_v(F);if(Y===null)sy(f,_,F,wf,A),bo(f,F);else if(xv(Y,f,_,A,F))F.stopPropagation();else if(bo(f,F),_&4&&-1<$2.indexOf(f)){for(;Y!==null;){var re=Ct(Y);if(re!==null)switch(re.tag){case 3:if(re=re.stateNode,re.current.memoizedState.isDehydrated){var Me=Eo(re.pendingLanes);if(Me!==0){var Ge=re;for(Ge.pendingLanes|=2,Ge.entangledLanes|=2;Me;){var dt=1<<31-za(Me);Ge.entanglements[1]|=dt,Me&=~dt}ql(re),(Sn&6)===0&&(xo=Mn()+500,Lm(0))}}break;case 13:Ge=jo(re,2),Ge!==null&&Js(Ge,re,2),Rm(),my(re,2)}if(re=_v(F),re===null&&sy(f,_,F,wf,A),re===Y)break;Y=re}Y!==null&&F.stopPropagation()}else sy(f,_,F,null,A)}}function _v(f){return f=Nn(f),yy(f)}var wf=null;function yy(f){if(wf=null,f=xt(f),f!==null){var _=Zt(f);if(_===null)f=null;else{var A=_.tag;if(A===13){if(f=Vt(_),f!==null)return f;f=null}else if(A===3){if(_.stateNode.current.memoizedState.isDehydrated)return _.tag===3?_.stateNode.containerInfo:null;f=null}else _!==f&&(f=null)}}return wf=f,null}function l1(f){switch(f){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(no()){case To:return 2;case Ds:return 8;case ar:case Ls:return 32;case Kr:return 268435456;default:return 32}default:return 32}}var vv=!1,Sf=null,Tf=null,Ef=null,Xm=new Map,Ym=new Map,xh=[],$2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function bo(f,_){switch(f){case"focusin":case"focusout":Sf=null;break;case"dragenter":case"dragleave":Tf=null;break;case"mouseover":case"mouseout":Ef=null;break;case"pointerover":case"pointerout":Xm.delete(_.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ym.delete(_.pointerId)}}function Qs(f,_,A,F,Y,re){return f===null||f.nativeEvent!==re?(f={blockedOn:_,domEventName:A,eventSystemFlags:F,nativeEvent:re,targetContainers:[Y]},_!==null&&(_=Ct(_),_!==null&&gv(_)),f):(f.eventSystemFlags|=F,_=f.targetContainers,Y!==null&&_.indexOf(Y)===-1&&_.push(Y),f)}function xv(f,_,A,F,Y){switch(_){case"focusin":return Sf=Qs(Sf,f,_,A,F,Y),!0;case"dragenter":return Tf=Qs(Tf,f,_,A,F,Y),!0;case"mouseover":return Ef=Qs(Ef,f,_,A,F,Y),!0;case"pointerover":var re=Y.pointerId;return Xm.set(re,Qs(Xm.get(re)||null,f,_,A,F,Y)),!0;case"gotpointercapture":return re=Y.pointerId,Ym.set(re,Qs(Ym.get(re)||null,f,_,A,F,Y)),!0}return!1}function _y(f){var _=xt(f.target);if(_!==null){var A=Zt(_);if(A!==null){if(_=A.tag,_===13){if(_=Vt(A),_!==null){f.blockedOn=_,wt(f.priority,function(){if(A.tag===13){var F=yl(),Y=jo(A,F);Y!==null&&Js(Y,A,F),my(A,F)}});return}}else if(_===3&&A.stateNode.current.memoizedState.isDehydrated){f.blockedOn=A.tag===3?A.stateNode.containerInfo:null;return}}}f.blockedOn=null}function Dd(f){if(f.blockedOn!==null)return!1;for(var _=f.targetContainers;0<_.length;){var A=_v(f.nativeEvent);if(A===null){A=f.nativeEvent;var F=new A.constructor(A.type,A);Mu=F,A.target.dispatchEvent(F),Mu=null}else return _=Ct(A),_!==null&&gv(_),f.blockedOn=A,!1;_.shift()}return!0}function Ld(f,_,A){Dd(f)&&A.delete(_)}function H2(){vv=!1,Sf!==null&&Dd(Sf)&&(Sf=null),Tf!==null&&Dd(Tf)&&(Tf=null),Ef!==null&&Dd(Ef)&&(Ef=null),Xm.forEach(Ld),Ym.forEach(Ld)}function vy(f,_){f.blockedOn===_&&(f.blockedOn=null,vv||(vv=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,H2)))}var Af=null;function u1(f){Af!==f&&(Af=f,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Af===f&&(Af=null);for(var _=0;_<f.length;_+=3){var A=f[_],F=f[_+1],Y=f[_+2];if(typeof F!="function"){if(yy(F||A)===null)continue;break}var re=Ct(A);re!==null&&(f.splice(_,3),_-=3,so(re,{pending:!0,data:Y,method:A.method,action:F},F,Y))}}))}function Zm(f){function _(dt){return vy(dt,f)}Sf!==null&&vy(Sf,f),Tf!==null&&vy(Tf,f),Ef!==null&&vy(Ef,f),Xm.forEach(_),Ym.forEach(_);for(var A=0;A<xh.length;A++){var F=xh[A];F.blockedOn===f&&(F.blockedOn=null)}for(;0<xh.length&&(A=xh[0],A.blockedOn===null);)_y(A),A.blockedOn===null&&xh.shift();if(A=(f.ownerDocument||f).$$reactFormReplay,A!=null)for(F=0;F<A.length;F+=3){var Y=A[F],re=A[F+1],Me=Y[Ie]||null;if(typeof re=="function")Me||u1(A);else if(Me){var Ge=null;if(re&&re.hasAttribute("formAction")){if(Y=re,Me=re[Ie]||null)Ge=Me.formAction;else if(yy(Y)!==null)continue}else Ge=Me.action;typeof Ge=="function"?A[F+1]=Ge:(A.splice(F,3),F-=3),u1(A)}}}function xy(f){this._internalRoot=f}Up.prototype.render=xy.prototype.render=function(f){var _=this._internalRoot;if(_===null)throw Error(o(409));var A=_.current,F=yl();pv(A,F,f,_,null,null)},Up.prototype.unmount=xy.prototype.unmount=function(){var f=this._internalRoot;if(f!==null){this._internalRoot=null;var _=f.containerInfo;f.tag===0&&Dp(),pv(f.current,2,null,f,null,null),Rm(),_[Fe]=null}};function Up(f){this._internalRoot=f}Up.prototype.unstable_scheduleHydration=function(f){if(f){var _=ls();f={blockedOn:null,target:f,priority:_};for(var A=0;A<xh.length&&_!==0&&_<xh[A].priority;A++);xh.splice(A,0,f),A===0&&_y(f)}};var bv=t.version;if(bv!=="19.0.0")throw Error(o(527,bv,"19.0.0"));cn.findDOMNode=function(f){var _=f._reactInternals;if(_===void 0)throw typeof f.render=="function"?Error(o(188)):(f=Object.keys(f).join(","),Error(o(268,f)));return f=Xt(_),f=f!==null?an(f):null,f=f===null?null:f.stateNode,f};var wv={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:He,findFiberByHostInstance:xt,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var by=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!by.isDisabled&&by.supportsFiber)try{Ui=by.inject(wv),$a=by}catch{}}return Hv.createRoot=function(f,_){if(!c(f))throw Error(o(299));var A=!1,F="",Y=hf,re=Tp,Me=pd,Ge=null;return _!=null&&(_.unstable_strictMode===!0&&(A=!0),_.identifierPrefix!==void 0&&(F=_.identifierPrefix),_.onUncaughtError!==void 0&&(Y=_.onUncaughtError),_.onCaughtError!==void 0&&(re=_.onCaughtError),_.onRecoverableError!==void 0&&(Me=_.onRecoverableError),_.unstable_transitionCallbacks!==void 0&&(Ge=_.unstable_transitionCallbacks)),_=fv(f,1,!1,null,null,A,F,Y,re,Me,Ge,null),f[Fe]=_.current,ay(f.nodeType===8?f.parentNode:f),new xy(_)},Hv.hydrateRoot=function(f,_,A){if(!c(f))throw Error(o(299));var F=!1,Y="",re=hf,Me=Tp,Ge=pd,dt=null,Nt=null;return A!=null&&(A.unstable_strictMode===!0&&(F=!0),A.identifierPrefix!==void 0&&(Y=A.identifierPrefix),A.onUncaughtError!==void 0&&(re=A.onUncaughtError),A.onCaughtError!==void 0&&(Me=A.onCaughtError),A.onRecoverableError!==void 0&&(Ge=A.onRecoverableError),A.unstable_transitionCallbacks!==void 0&&(dt=A.unstable_transitionCallbacks),A.formState!==void 0&&(Nt=A.formState)),_=fv(f,1,!0,_,A??null,F,Y,re,Me,Ge,dt,Nt),_.context=dv(null),A=_.current,F=yl(),Y=Ys(F),Y.callback=null,qu(A,Y,F),_.current.lanes=F,Mi(_,F),ql(_),f[Fe]=_.current,ay(f),new Up(_)},Hv.version="19.0.0",Hv}var Tk;function IG(){if(Tk)return jS.exports;Tk=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),jS.exports=OG(),jS.exports}var CG=IG();const Nj=Jt.createContext({});function t_(e){const t=Jt.useRef(null);return t.current===null&&(t.current=e()),t.current}const xC=Jt.createContext(null),Nw=Jt.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function PG(e=!0){const t=Jt.useContext(xC);if(t===null)return[!0,null];const{isPresent:a,onExitComplete:o,register:c}=t,b=Jt.useId();Jt.useEffect(()=>{if(e)return c(b)},[e]);const S=Jt.useCallback(()=>e&&o&&o(b),[b,o,e]);return!a&&o?[!1,S]:[!0]}const bC=typeof window<"u",Bw=bC?Jt.useLayoutEffect:Jt.useEffect,Tl=e=>e;let RG=Tl,Bj=Tl;function wC(e){let t;return()=>(t===void 0&&(t=e()),t)}const xg=(e,t,a)=>{const o=t-e;return o===0?1:(a-e)/o},jd=e=>e*1e3,Ud=e=>e/1e3,kG={useManualTiming:!1},U1=["read","resolveKeyframes","update","preRender","render","postRender"];function DG(e,t){let a=new Set,o=new Set,c=!1,b=!1;const S=new WeakSet;let i={delta:0,timestamp:0,isProcessing:!1};function P(U){S.has(U)&&(L.schedule(U),e()),U(i)}const L={schedule:(U,V=!1,H=!1)=>{const ie=H&&c?a:o;return V&&S.add(U),ie.has(U)||ie.add(U),U},cancel:U=>{o.delete(U),S.delete(U)},process:U=>{if(i=U,c){b=!0;return}c=!0,[a,o]=[o,a],a.forEach(P),a.clear(),c=!1,b&&(b=!1,L.process(U))}};return L}const LG=40;function Fj(e,t){let a=!1,o=!0;const c={delta:0,timestamp:0,isProcessing:!1},b=()=>a=!0,S=U1.reduce((ge,Se)=>(ge[Se]=DG(b),ge),{}),{read:i,resolveKeyframes:P,update:L,preRender:U,render:V,postRender:H}=S,ee=()=>{const ge=performance.now();a=!1,c.delta=o?1e3/60:Math.max(Math.min(ge-c.timestamp,LG),1),c.timestamp=ge,c.isProcessing=!0,i.process(c),P.process(c),L.process(c),U.process(c),V.process(c),H.process(c),c.isProcessing=!1,a&&t&&(o=!1,e(ee))},ie=()=>{a=!0,o=!0,c.isProcessing||e(ee)};return{schedule:U1.reduce((ge,Se)=>{const ve=S[Se];return ge[Se]=(Ee,me=!1,Ae=!1)=>(a||ie(),ve.schedule(Ee,me,Ae)),ge},{}),cancel:ge=>{for(let Se=0;Se<U1.length;Se++)S[U1[Se]].cancel(ge)},state:c,steps:S}}const{schedule:Gi,cancel:kh,state:Os,steps:GS}=Fj(typeof requestAnimationFrame<"u"?requestAnimationFrame:Tl,!0),jj=Jt.createContext({strict:!1}),Ek={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},n_={};for(const e in Ek)n_[e]={isEnabled:t=>Ek[e].some(a=>!!t[a])};function zG(e){for(const t in e)n_[t]={...n_[t],...e[t]}}const NG=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Eb(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||NG.has(e)}let Uj=e=>!Eb(e);function BG(e){e&&(Uj=t=>t.startsWith("on")?!Eb(t):e(t))}try{BG(require("@emotion/is-prop-valid").default)}catch{}function FG(e,t,a){const o={};for(const c in e)c==="values"&&typeof e.values=="object"||(Uj(c)||a===!0&&Eb(c)||!t&&!Eb(c)||e.draggable&&c.startsWith("onDrag"))&&(o[c]=e[c]);return o}function jG(e){if(typeof Proxy>"u")return e;const t=new Map,a=(...o)=>e(...o);return new Proxy(a,{get:(o,c)=>c==="create"?e:(t.has(c)||t.set(c,e(c)),t.get(c))})}const Fw=Jt.createContext({});function jw(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function E0(e){return typeof e=="string"||Array.isArray(e)}const SC=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],TC=["initial",...SC];function Uw(e){return jw(e.animate)||TC.some(t=>E0(e[t]))}function Vj(e){return!!(Uw(e)||e.variants)}function UG(e,t){if(Uw(e)){const{initial:a,animate:o}=e;return{initial:a===!1||E0(a)?a:void 0,animate:E0(o)?o:void 0}}return e.inherit!==!1?t:{}}function VG(e){const{initial:t,animate:a}=UG(e,Jt.useContext(Fw));return Jt.useMemo(()=>({initial:t,animate:a}),[Ak(t),Ak(a)])}function Ak(e){return Array.isArray(e)?e.join(" "):e}const qG=Symbol.for("motionComponentSymbol");function By(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function GG(e,t,a){return Jt.useCallback(o=>{o&&e.onMount&&e.onMount(o),t&&(o?t.mount(o):t.unmount()),a&&(typeof a=="function"?a(o):By(a)&&(a.current=o))},[t])}const EC=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),$G="framerAppearId",qj="data-"+EC($G),{schedule:AC}=Fj(queueMicrotask,!1),Gj=Jt.createContext({});function HG(e,t,a,o,c){var b,S;const{visualElement:i}=Jt.useContext(Fw),P=Jt.useContext(jj),L=Jt.useContext(xC),U=Jt.useContext(Nw).reducedMotion,V=Jt.useRef(null);o=o||P.renderer,!V.current&&o&&(V.current=o(e,{visualState:t,parent:i,props:a,presenceContext:L,blockInitialAnimation:L?L.initial===!1:!1,reducedMotionConfig:U}));const H=V.current,ee=Jt.useContext(Gj);H&&!H.projection&&c&&(H.type==="html"||H.type==="svg")&&XG(V.current,a,c,ee);const ie=Jt.useRef(!1);Jt.useInsertionEffect(()=>{H&&ie.current&&H.update(a,L)});const le=a[qj],ue=Jt.useRef(!!le&&!(!((b=window.MotionHandoffIsComplete)===null||b===void 0)&&b.call(window,le))&&((S=window.MotionHasOptimisedAnimation)===null||S===void 0?void 0:S.call(window,le)));return Bw(()=>{H&&(ie.current=!0,window.MotionIsMounted=!0,H.updateFeatures(),AC.render(H.render),ue.current&&H.animationState&&H.animationState.animateChanges())}),Jt.useEffect(()=>{H&&(!ue.current&&H.animationState&&H.animationState.animateChanges(),ue.current&&(queueMicrotask(()=>{var ge;(ge=window.MotionHandoffMarkAsComplete)===null||ge===void 0||ge.call(window,le)}),ue.current=!1))}),H}function XG(e,t,a,o){const{layoutId:c,layout:b,drag:S,dragConstraints:i,layoutScroll:P,layoutRoot:L}=t;e.projection=new a(e.latestValues,t["data-framer-portal-id"]?void 0:$j(e.parent)),e.projection.setOptions({layoutId:c,layout:b,alwaysMeasureLayout:!!S||i&&By(i),visualElement:e,animationType:typeof b=="string"?b:"both",initialPromotionConfig:o,layoutScroll:P,layoutRoot:L})}function $j(e){if(e)return e.options.allowProjection!==!1?e.projection:$j(e.parent)}function YG({preloadedFeatures:e,createVisualElement:t,useRender:a,useVisualState:o,Component:c}){var b,S;e&&zG(e);function i(L,U){let V;const H={...Jt.useContext(Nw),...L,layoutId:ZG(L)},{isStatic:ee}=H,ie=VG(L),le=o(L,ee);if(!ee&&bC){WG();const ue=KG(H);V=ue.MeasureLayout,ie.visualElement=HG(c,le,H,t,ue.ProjectionNode)}return nn.jsxs(Fw.Provider,{value:ie,children:[V&&ie.visualElement?nn.jsx(V,{visualElement:ie.visualElement,...H}):null,a(c,L,GG(le,ie.visualElement,U),le,ee,ie.visualElement)]})}i.displayName=`motion.${typeof c=="string"?c:`create(${(S=(b=c.displayName)!==null&&b!==void 0?b:c.name)!==null&&S!==void 0?S:""})`}`;const P=Jt.forwardRef(i);return P[qG]=c,P}function ZG({layoutId:e}){const t=Jt.useContext(Nj).id;return t&&e!==void 0?t+"-"+e:e}function WG(e,t){Jt.useContext(jj).strict}function KG(e){const{drag:t,layout:a}=n_;if(!t&&!a)return{};const o={...t,...a};return{MeasureLayout:t!=null&&t.isEnabled(e)||a!=null&&a.isEnabled(e)?o.MeasureLayout:void 0,ProjectionNode:o.ProjectionNode}}const Hj=e=>t=>typeof t=="string"&&t.startsWith(e),MC=Hj("--"),JG=Hj("var(--"),OC=e=>JG(e)?QG.test(e.split("/*")[0].trim()):!1,QG=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,A0={};function e$(e){for(const t in e)A0[t]=e[t],MC(t)&&(A0[t].isCSSVariable=!0)}const R_=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Og=new Set(R_);function Xj(e,{layout:t,layoutId:a}){return Og.has(e)||e.startsWith("origin")||(t||a!==void 0)&&(!!A0[e]||e==="opacity")}const Cs=e=>!!(e&&e.getVelocity),Yj=(e,t)=>t&&typeof e=="number"?t.transform(e):e,jf=(e,t,a)=>a>t?t:a<e?e:a,k_={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},M0={...k_,transform:e=>jf(0,1,e)},V1={...k_,default:1},yx=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Wp=yx("deg"),zf=yx("%"),Xr=yx("px"),t$=yx("vh"),n$=yx("vw"),Mk={...zf,parse:e=>zf.parse(e)/100,transform:e=>zf.transform(e*100)},r$={borderWidth:Xr,borderTopWidth:Xr,borderRightWidth:Xr,borderBottomWidth:Xr,borderLeftWidth:Xr,borderRadius:Xr,radius:Xr,borderTopLeftRadius:Xr,borderTopRightRadius:Xr,borderBottomRightRadius:Xr,borderBottomLeftRadius:Xr,width:Xr,maxWidth:Xr,height:Xr,maxHeight:Xr,top:Xr,right:Xr,bottom:Xr,left:Xr,padding:Xr,paddingTop:Xr,paddingRight:Xr,paddingBottom:Xr,paddingLeft:Xr,margin:Xr,marginTop:Xr,marginRight:Xr,marginBottom:Xr,marginLeft:Xr,backgroundPositionX:Xr,backgroundPositionY:Xr},i$={rotate:Wp,rotateX:Wp,rotateY:Wp,rotateZ:Wp,scale:V1,scaleX:V1,scaleY:V1,scaleZ:V1,skew:Wp,skewX:Wp,skewY:Wp,distance:Xr,translateX:Xr,translateY:Xr,translateZ:Xr,x:Xr,y:Xr,z:Xr,perspective:Xr,transformPerspective:Xr,opacity:M0,originX:Mk,originY:Mk,originZ:Xr},Ok={...k_,transform:Math.round},IC={...r$,...i$,zIndex:Ok,size:Xr,fillOpacity:M0,strokeOpacity:M0,numOctaves:Ok},a$={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},o$=R_.length;function s$(e,t,a){let o="",c=!0;for(let b=0;b<o$;b++){const S=R_[b],i=e[S];if(i===void 0)continue;let P=!0;if(typeof i=="number"?P=i===(S.startsWith("scale")?1:0):P=parseFloat(i)===0,!P||a){const L=Yj(i,IC[S]);if(!P){c=!1;const U=a$[S]||S;o+=`${U}(${L}) `}a&&(t[S]=L)}}return o=o.trim(),a?o=a(t,c?"":o):c&&(o="none"),o}function CC(e,t,a){const{style:o,vars:c,transformOrigin:b}=e;let S=!1,i=!1;for(const P in t){const L=t[P];if(Og.has(P)){S=!0;continue}else if(MC(P)){c[P]=L;continue}else{const U=Yj(L,IC[P]);P.startsWith("origin")?(i=!0,b[P]=U):o[P]=U}}if(t.transform||(S||a?o.transform=s$(t,e.transform,a):o.transform&&(o.transform="none")),i){const{originX:P="50%",originY:L="50%",originZ:U=0}=b;o.transformOrigin=`${P} ${L} ${U}`}}const PC=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Zj(e,t,a){for(const o in t)!Cs(t[o])&&!Xj(o,a)&&(e[o]=t[o])}function l$({transformTemplate:e},t){return Jt.useMemo(()=>{const a=PC();return CC(a,t,e),Object.assign({},a.vars,a.style)},[t])}function u$(e,t){const a=e.style||{},o={};return Zj(o,a,e),Object.assign(o,l$(e,t)),o}function c$(e,t){const a={},o=u$(e,t);return e.drag&&e.dragListener!==!1&&(a.draggable=!1,o.userSelect=o.WebkitUserSelect=o.WebkitTouchCallout="none",o.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(a.tabIndex=0),a.style=o,a}const h$=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function RC(e){return typeof e!="string"||e.includes("-")?!1:!!(h$.indexOf(e)>-1||/[A-Z]/u.test(e))}const f$={offset:"stroke-dashoffset",array:"stroke-dasharray"},d$={offset:"strokeDashoffset",array:"strokeDasharray"};function p$(e,t,a=1,o=0,c=!0){e.pathLength=1;const b=c?f$:d$;e[b.offset]=Xr.transform(-o);const S=Xr.transform(t),i=Xr.transform(a);e[b.array]=`${S} ${i}`}function Ik(e,t,a){return typeof e=="string"?e:Xr.transform(t+a*e)}function m$(e,t,a){const o=Ik(t,e.x,e.width),c=Ik(a,e.y,e.height);return`${o} ${c}`}function kC(e,{attrX:t,attrY:a,attrScale:o,originX:c,originY:b,pathLength:S,pathSpacing:i=1,pathOffset:P=0,...L},U,V){if(CC(e,L,V),U){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:H,style:ee,dimensions:ie}=e;H.transform&&(ie&&(ee.transform=H.transform),delete H.transform),ie&&(c!==void 0||b!==void 0||ee.transform)&&(ee.transformOrigin=m$(ie,c!==void 0?c:.5,b!==void 0?b:.5)),t!==void 0&&(H.x=t),a!==void 0&&(H.y=a),o!==void 0&&(H.scale=o),S!==void 0&&p$(H,S,i,P,!1)}const Wj=()=>({...PC(),attrs:{}}),DC=e=>typeof e=="string"&&e.toLowerCase()==="svg";function g$(e,t,a,o){const c=Jt.useMemo(()=>{const b=Wj();return kC(b,t,DC(o),e.transformTemplate),{...b.attrs,style:{...b.style}}},[t]);if(e.style){const b={};Zj(b,e.style,e),c.style={...b,...c.style}}return c}function y$(e=!1){return(a,o,c,{latestValues:b},S)=>{const P=(RC(a)?g$:c$)(o,b,S,a),L=FG(o,typeof a=="string",e),U=a!==Jt.Fragment?{...L,...P,ref:c}:{},{children:V}=o,H=Jt.useMemo(()=>Cs(V)?V.get():V,[V]);return Jt.createElement(a,{...U,children:H})}}function Ck(e){const t=[{},{}];return e==null||e.values.forEach((a,o)=>{t[0][o]=a.get(),t[1][o]=a.getVelocity()}),t}function LC(e,t,a,o){if(typeof t=="function"){const[c,b]=Ck(o);t=t(a!==void 0?a:e.custom,c,b)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[c,b]=Ck(o);t=t(a!==void 0?a:e.custom,c,b)}return t}const fO=e=>Array.isArray(e),_$=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),v$=e=>fO(e)?e[e.length-1]||0:e;function pb(e){const t=Cs(e)?e.get():e;return _$(t)?t.toValue():t}function x$({scrapeMotionValuesFromProps:e,createRenderState:t,onUpdate:a},o,c,b){const S={latestValues:b$(o,c,b,e),renderState:t()};return a&&(S.onMount=i=>a({props:o,current:i,...S}),S.onUpdate=i=>a(i)),S}const Kj=e=>(t,a)=>{const o=Jt.useContext(Fw),c=Jt.useContext(xC),b=()=>x$(e,t,o,c);return a?b():t_(b)};function b$(e,t,a,o){const c={},b=o(e,{});for(const H in b)c[H]=pb(b[H]);let{initial:S,animate:i}=e;const P=Uw(e),L=Vj(e);t&&L&&!P&&e.inherit!==!1&&(S===void 0&&(S=t.initial),i===void 0&&(i=t.animate));let U=a?a.initial===!1:!1;U=U||S===!1;const V=U?i:S;if(V&&typeof V!="boolean"&&!jw(V)){const H=Array.isArray(V)?V:[V];for(let ee=0;ee<H.length;ee++){const ie=LC(e,H[ee]);if(ie){const{transitionEnd:le,transition:ue,...ge}=ie;for(const Se in ge){let ve=ge[Se];if(Array.isArray(ve)){const Ee=U?ve.length-1:0;ve=ve[Ee]}ve!==null&&(c[Se]=ve)}for(const Se in le)c[Se]=le[Se]}}}return c}function zC(e,t,a){var o;const{style:c}=e,b={};for(const S in c)(Cs(c[S])||t.style&&Cs(t.style[S])||Xj(S,e)||((o=a==null?void 0:a.getValue(S))===null||o===void 0?void 0:o.liveStyle)!==void 0)&&(b[S]=c[S]);return b}const w$={useVisualState:Kj({scrapeMotionValuesFromProps:zC,createRenderState:PC})};function Jj(e,t){try{t.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{t.dimensions={x:0,y:0,width:0,height:0}}}function Qj(e,{style:t,vars:a},o,c){Object.assign(e.style,t,c&&c.getProjectionStyles(o));for(const b in a)e.style.setProperty(b,a[b])}const e6=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function t6(e,t,a,o){Qj(e,t,void 0,o);for(const c in t.attrs)e.setAttribute(e6.has(c)?c:EC(c),t.attrs[c])}function n6(e,t,a){const o=zC(e,t,a);for(const c in e)if(Cs(e[c])||Cs(t[c])){const b=R_.indexOf(c)!==-1?"attr"+c.charAt(0).toUpperCase()+c.substring(1):c;o[b]=e[c]}return o}const Pk=["x","y","width","height","cx","cy","r"],S$={useVisualState:Kj({scrapeMotionValuesFromProps:n6,createRenderState:Wj,onUpdate:({props:e,prevProps:t,current:a,renderState:o,latestValues:c})=>{if(!a)return;let b=!!e.drag;if(!b){for(const i in c)if(Og.has(i)){b=!0;break}}if(!b)return;let S=!t;if(t)for(let i=0;i<Pk.length;i++){const P=Pk[i];e[P]!==t[P]&&(S=!0)}S&&Gi.read(()=>{Jj(a,o),Gi.render(()=>{kC(o,c,DC(a.tagName),e.transformTemplate),t6(a,o)})})}})};function T$(e,t){return function(o,{forwardMotionProps:c}={forwardMotionProps:!1}){const S={...RC(o)?S$:w$,preloadedFeatures:e,useRender:y$(c),createVisualElement:t,Component:o};return YG(S)}}function O0(e,t,a){const o=e.getProps();return LC(o,t,a!==void 0?a:o.custom,e)}const r6=wC(()=>window.ScrollTimeline!==void 0);class E${constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}get finished(){return Promise.all(this.animations.map(t=>"finished"in t?t.finished:t))}getAll(t){return this.animations[0][t]}setAll(t,a){for(let o=0;o<this.animations.length;o++)this.animations[o][t]=a}attachTimeline(t,a){const o=this.animations.map(c=>{if(r6()&&c.attachTimeline)return c.attachTimeline(t);if(typeof a=="function")return a(c)});return()=>{o.forEach((c,b)=>{c&&c(),this.animations[b].stop()})}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get startTime(){return this.getAll("startTime")}get duration(){let t=0;for(let a=0;a<this.animations.length;a++)t=Math.max(t,this.animations[a].duration);return t}runAll(t){this.animations.forEach(a=>a[t]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class A$ extends E${then(t,a){return Promise.all(this.animations).then(t).catch(a)}}function NC(e,t){return e?e[t]||e.default||e:void 0}const dO=2e4;function i6(e){let t=0;const a=50;let o=e.next(t);for(;!o.done&&t<dO;)t+=a,o=e.next(t);return t>=dO?1/0:t}function BC(e){return typeof e=="function"}function Rk(e,t){e.timeline=t,e.onfinish=null}const FC=e=>Array.isArray(e)&&typeof e[0]=="number",M$={linearEasing:void 0};function O$(e,t){const a=wC(e);return()=>{var o;return(o=M$[t])!==null&&o!==void 0?o:a()}}const Ab=O$(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),a6=(e,t,a=10)=>{let o="";const c=Math.max(Math.round(t/a),2);for(let b=0;b<c;b++)o+=e(xg(0,c-1,b))+", ";return`linear(${o.substring(0,o.length-2)})`};function o6(e){return!!(typeof e=="function"&&Ab()||!e||typeof e=="string"&&(e in pO||Ab())||FC(e)||Array.isArray(e)&&e.every(o6))}const i0=([e,t,a,o])=>`cubic-bezier(${e}, ${t}, ${a}, ${o})`,pO={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:i0([0,.65,.55,1]),circOut:i0([.55,0,1,.45]),backIn:i0([.31,.01,.66,-.59]),backOut:i0([.33,1.53,.69,.99])};function s6(e,t){if(e)return typeof e=="function"&&Ab()?a6(e,t):FC(e)?i0(e):Array.isArray(e)?e.map(a=>s6(a,t)||pO.easeOut):pO[e]}const Oh={x:!1,y:!1};function l6(){return Oh.x||Oh.y}function u6(e,t,a){var o;if(e instanceof EventTarget)return[e];if(typeof e=="string"){let c=document;const b=(o=void 0)!==null&&o!==void 0?o:c.querySelectorAll(e);return b?Array.from(b):[]}return Array.from(e)}function c6(e,t){const a=u6(e),o=new AbortController,c={passive:!0,...t,signal:o.signal};return[a,c,()=>o.abort()]}function kk(e){return!(e.pointerType==="touch"||l6())}function I$(e,t,a={}){const[o,c,b]=c6(e,a),S=i=>{if(!kk(i))return;const{target:P}=i,L=t(P,i);if(typeof L!="function"||!P)return;const U=V=>{kk(V)&&(L(V),P.removeEventListener("pointerleave",U))};P.addEventListener("pointerleave",U,c)};return o.forEach(i=>{i.addEventListener("pointerenter",S,c)}),b}function Mb(e,t){const a=`${t}PointerCapture`;if(e.target instanceof Element&&a in e.target&&e.pointerId!==void 0)try{e.target[a](e.pointerId)}catch{}}const h6=(e,t)=>t?e===t?!0:h6(e,t.parentElement):!1,jC=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,C$=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function P$(e){return C$.has(e.tagName)||e.tabIndex!==-1}const a0=new WeakSet;function Dk(e){return t=>{t.key==="Enter"&&e(t)}}function $S(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const R$=(e,t)=>{const a=e.currentTarget;if(!a)return;const o=Dk(()=>{if(a0.has(a))return;$S(a,"down");const c=Dk(()=>{$S(a,"up")}),b=()=>$S(a,"cancel");a.addEventListener("keyup",c,t),a.addEventListener("blur",b,t)});a.addEventListener("keydown",o,t),a.addEventListener("blur",()=>a.removeEventListener("keydown",o),t)};function Lk(e){return jC(e)&&!l6()}function k$(e,t,a={}){const[o,c,b]=c6(e,a),S=i=>{const P=i.currentTarget;if(!P||!Lk(i)||a0.has(P))return;a0.add(P),Mb(i,"set");const L=t(P,i),U=(ee,ie)=>{P.removeEventListener("pointerup",V),P.removeEventListener("pointercancel",H),Mb(ee,"release"),!(!Lk(ee)||!a0.has(P))&&(a0.delete(P),typeof L=="function"&&L(ee,{success:ie}))},V=ee=>{(ee.isTrusted?D$(ee,P instanceof Element?P.getBoundingClientRect():{left:0,top:0,right:window.innerWidth,bottom:window.innerHeight}):!1)?U(ee,!1):U(ee,!(P instanceof Element)||h6(P,ee.target))},H=ee=>{U(ee,!1)};P.addEventListener("pointerup",V,c),P.addEventListener("pointercancel",H,c),P.addEventListener("lostpointercapture",H,c)};return o.forEach(i=>{i=a.useGlobalTarget?window:i;let P=!1;i instanceof HTMLElement&&(P=!0,!P$(i)&&i.getAttribute("tabindex")===null&&(i.tabIndex=0)),i.addEventListener("pointerdown",S,c),P&&i.addEventListener("focus",L=>R$(L,c),c)}),b}function D$(e,t){return e.clientX<t.left||e.clientX>t.right||e.clientY<t.top||e.clientY>t.bottom}function L$(e){return e==="x"||e==="y"?Oh[e]?null:(Oh[e]=!0,()=>{Oh[e]=!1}):Oh.x||Oh.y?null:(Oh.x=Oh.y=!0,()=>{Oh.x=Oh.y=!1})}const f6=new Set(["width","height","top","left","right","bottom",...R_]);let mb;function z$(){mb=void 0}const Nf={now:()=>(mb===void 0&&Nf.set(Os.isProcessing||kG.useManualTiming?Os.timestamp:performance.now()),mb),set:e=>{mb=e,queueMicrotask(z$)}};function UC(e,t){e.indexOf(t)===-1&&e.push(t)}function VC(e,t){const a=e.indexOf(t);a>-1&&e.splice(a,1)}class qC{constructor(){this.subscriptions=[]}add(t){return UC(this.subscriptions,t),()=>VC(this.subscriptions,t)}notify(t,a,o){const c=this.subscriptions.length;if(c)if(c===1)this.subscriptions[0](t,a,o);else for(let b=0;b<c;b++){const S=this.subscriptions[b];S&&S(t,a,o)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function GC(e,t){return t?e*(1e3/t):0}const zk=30,N$=e=>!isNaN(parseFloat(e)),h0={current:void 0};class B${constructor(t,a={}){this.version="12.4.7",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(o,c=!0)=>{const b=Nf.now();this.updatedAt!==b&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(o),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),c&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(t),this.owner=a.owner}setCurrent(t){this.current=t,this.updatedAt=Nf.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=N$(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,a){this.events[t]||(this.events[t]=new qC);const o=this.events[t].add(a);return t==="change"?()=>{o(),Gi.read(()=>{this.events.change.getSize()||this.stop()})}:o}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,a){this.passiveEffect=t,this.stopPassiveEffect=a}set(t,a=!0){!a||!this.passiveEffect?this.updateAndNotify(t,a):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,a,o){this.set(a),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-o}jump(t,a=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,a&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return h0.current&&h0.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const t=Nf.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>zk)return 0;const a=Math.min(this.updatedAt-this.prevUpdatedAt,zk);return GC(parseFloat(this.current)-parseFloat(this.prevFrameValue),a)}start(t){return this.stop(),new Promise(a=>{this.hasAnimated=!0,this.animation=t(a),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Pf(e,t){return new B$(e,t)}function F$(e,t,a){e.hasValue(t)?e.getValue(t).set(a):e.addValue(t,Pf(a))}function j$(e,t){const a=O0(e,t);let{transitionEnd:o={},transition:c={},...b}=a||{};b={...b,...o};for(const S in b){const i=v$(b[S]);F$(e,S,i)}}function U$(e){return!!(Cs(e)&&e.add)}function mO(e,t){const a=e.getValue("willChange");if(U$(a))return a.add(t)}function d6(e){return e.props[qj]}const p6=(e,t,a)=>(((1-3*a+3*t)*e+(3*a-6*t))*e+3*t)*e,V$=1e-7,q$=12;function G$(e,t,a,o,c){let b,S,i=0;do S=t+(a-t)/2,b=p6(S,o,c)-e,b>0?a=S:t=S;while(Math.abs(b)>V$&&++i<q$);return S}function _x(e,t,a,o){if(e===t&&a===o)return Tl;const c=b=>G$(b,0,1,e,a);return b=>b===0||b===1?b:p6(c(b),t,o)}const m6=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,g6=e=>t=>1-e(1-t),y6=_x(.33,1.53,.69,.99),$C=g6(y6),_6=m6($C),v6=e=>(e*=2)<1?.5*$C(e):.5*(2-Math.pow(2,-10*(e-1))),HC=e=>1-Math.sin(Math.acos(e)),x6=g6(HC),b6=m6(HC),w6=e=>/^0[^.\s]+$/u.test(e);function $$(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||w6(e):!0}const f0=e=>Math.round(e*1e5)/1e5,XC=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function H$(e){return e==null}const X$=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,YC=(e,t)=>a=>!!(typeof a=="string"&&X$.test(a)&&a.startsWith(e)||t&&!H$(a)&&Object.prototype.hasOwnProperty.call(a,t)),S6=(e,t,a)=>o=>{if(typeof o!="string")return o;const[c,b,S,i]=o.match(XC);return{[e]:parseFloat(c),[t]:parseFloat(b),[a]:parseFloat(S),alpha:i!==void 0?parseFloat(i):1}},Y$=e=>jf(0,255,e),HS={...k_,transform:e=>Math.round(Y$(e))},cg={test:YC("rgb","red"),parse:S6("red","green","blue"),transform:({red:e,green:t,blue:a,alpha:o=1})=>"rgba("+HS.transform(e)+", "+HS.transform(t)+", "+HS.transform(a)+", "+f0(M0.transform(o))+")"};function Z$(e){let t="",a="",o="",c="";return e.length>5?(t=e.substring(1,3),a=e.substring(3,5),o=e.substring(5,7),c=e.substring(7,9)):(t=e.substring(1,2),a=e.substring(2,3),o=e.substring(3,4),c=e.substring(4,5),t+=t,a+=a,o+=o,c+=c),{red:parseInt(t,16),green:parseInt(a,16),blue:parseInt(o,16),alpha:c?parseInt(c,16)/255:1}}const gO={test:YC("#"),parse:Z$,transform:cg.transform},Fy={test:YC("hsl","hue"),parse:S6("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:a,alpha:o=1})=>"hsla("+Math.round(e)+", "+zf.transform(f0(t))+", "+zf.transform(f0(a))+", "+f0(M0.transform(o))+")"},xl={test:e=>cg.test(e)||gO.test(e)||Fy.test(e),parse:e=>cg.test(e)?cg.parse(e):Fy.test(e)?Fy.parse(e):gO.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?cg.transform(e):Fy.transform(e)},W$=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function K$(e){var t,a;return isNaN(e)&&typeof e=="string"&&(((t=e.match(XC))===null||t===void 0?void 0:t.length)||0)+(((a=e.match(W$))===null||a===void 0?void 0:a.length)||0)>0}const T6="number",E6="color",J$="var",Q$="var(",Nk="${}",eH=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function I0(e){const t=e.toString(),a=[],o={color:[],number:[],var:[]},c=[];let b=0;const i=t.replace(eH,P=>(xl.test(P)?(o.color.push(b),c.push(E6),a.push(xl.parse(P))):P.startsWith(Q$)?(o.var.push(b),c.push(J$),a.push(P)):(o.number.push(b),c.push(T6),a.push(parseFloat(P))),++b,Nk)).split(Nk);return{values:a,split:i,indexes:o,types:c}}function A6(e){return I0(e).values}function M6(e){const{split:t,types:a}=I0(e),o=t.length;return c=>{let b="";for(let S=0;S<o;S++)if(b+=t[S],c[S]!==void 0){const i=a[S];i===T6?b+=f0(c[S]):i===E6?b+=xl.transform(c[S]):b+=c[S]}return b}}const tH=e=>typeof e=="number"?0:e;function nH(e){const t=A6(e);return M6(e)(t.map(tH))}const im={test:K$,parse:A6,createTransformer:M6,getAnimatableNone:nH},rH=new Set(["brightness","contrast","saturate","opacity"]);function iH(e){const[t,a]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[o]=a.match(XC)||[];if(!o)return e;const c=a.replace(o,"");let b=rH.has(t)?1:0;return o!==a&&(b*=100),t+"("+b+c+")"}const aH=/\b([a-z-]*)\(.*?\)/gu,yO={...im,getAnimatableNone:e=>{const t=e.match(aH);return t?t.map(iH).join(" "):e}},oH={...IC,color:xl,backgroundColor:xl,outlineColor:xl,fill:xl,stroke:xl,borderColor:xl,borderTopColor:xl,borderRightColor:xl,borderBottomColor:xl,borderLeftColor:xl,filter:yO,WebkitFilter:yO},ZC=e=>oH[e];function O6(e,t){let a=ZC(e);return a!==yO&&(a=im),a.getAnimatableNone?a.getAnimatableNone(t):void 0}const sH=new Set(["auto","none","0"]);function lH(e,t,a){let o=0,c;for(;o<e.length&&!c;){const b=e[o];typeof b=="string"&&!sH.has(b)&&I0(b).values.length&&(c=e[o]),o++}if(c&&a)for(const b of t)e[b]=O6(a,c)}const Bk=e=>e===k_||e===Xr,Fk=(e,t)=>parseFloat(e.split(", ")[t]),jk=(e,t)=>(a,{transform:o})=>{if(o==="none"||!o)return 0;const c=o.match(/^matrix3d\((.+)\)$/u);if(c)return Fk(c[1],t);{const b=o.match(/^matrix\((.+)\)$/u);return b?Fk(b[1],e):0}},uH=new Set(["x","y","z"]),cH=R_.filter(e=>!uH.has(e));function hH(e){const t=[];return cH.forEach(a=>{const o=e.getValue(a);o!==void 0&&(t.push([a,o.get()]),o.set(a.startsWith("scale")?1:0))}),t}const r_={width:({x:e},{paddingLeft:t="0",paddingRight:a="0"})=>e.max-e.min-parseFloat(t)-parseFloat(a),height:({y:e},{paddingTop:t="0",paddingBottom:a="0"})=>e.max-e.min-parseFloat(t)-parseFloat(a),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:jk(4,13),y:jk(5,14)};r_.translateX=r_.x;r_.translateY=r_.y;const yg=new Set;let _O=!1,vO=!1;function I6(){if(vO){const e=Array.from(yg).filter(o=>o.needsMeasurement),t=new Set(e.map(o=>o.element)),a=new Map;t.forEach(o=>{const c=hH(o);c.length&&(a.set(o,c),o.render())}),e.forEach(o=>o.measureInitialState()),t.forEach(o=>{o.render();const c=a.get(o);c&&c.forEach(([b,S])=>{var i;(i=o.getValue(b))===null||i===void 0||i.set(S)})}),e.forEach(o=>o.measureEndState()),e.forEach(o=>{o.suspendedScrollY!==void 0&&window.scrollTo(0,o.suspendedScrollY)})}vO=!1,_O=!1,yg.forEach(e=>e.complete()),yg.clear()}function C6(){yg.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(vO=!0)})}function fH(){C6(),I6()}class WC{constructor(t,a,o,c,b,S=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=a,this.name=o,this.motionValue=c,this.element=b,this.isAsync=S}scheduleResolve(){this.isScheduled=!0,this.isAsync?(yg.add(this),_O||(_O=!0,Gi.read(C6),Gi.resolveKeyframes(I6))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:a,element:o,motionValue:c}=this;for(let b=0;b<t.length;b++)if(t[b]===null)if(b===0){const S=c==null?void 0:c.get(),i=t[t.length-1];if(S!==void 0)t[0]=S;else if(o&&a){const P=o.readValue(a,i);P!=null&&(t[0]=P)}t[0]===void 0&&(t[0]=i),c&&S===void 0&&c.set(t[0])}else t[b]=t[b-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),yg.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,yg.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const P6=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),dH=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function pH(e){const t=dH.exec(e);if(!t)return[,];const[,a,o,c]=t;return[`--${a??o}`,c]}function R6(e,t,a=1){const[o,c]=pH(e);if(!o)return;const b=window.getComputedStyle(t).getPropertyValue(o);if(b){const S=b.trim();return P6(S)?parseFloat(S):S}return OC(c)?R6(c,t,a+1):c}const k6=e=>t=>t.test(e),mH={test:e=>e==="auto",parse:e=>e},D6=[k_,Xr,zf,Wp,n$,t$,mH],Uk=e=>D6.find(k6(e));class L6 extends WC{constructor(t,a,o,c,b){super(t,a,o,c,b,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:a,name:o}=this;if(!a||!a.current)return;super.readKeyframes();for(let P=0;P<t.length;P++){let L=t[P];if(typeof L=="string"&&(L=L.trim(),OC(L))){const U=R6(L,a.current);U!==void 0&&(t[P]=U),P===t.length-1&&(this.finalKeyframe=L)}}if(this.resolveNoneKeyframes(),!f6.has(o)||t.length!==2)return;const[c,b]=t,S=Uk(c),i=Uk(b);if(S!==i)if(Bk(S)&&Bk(i))for(let P=0;P<t.length;P++){const L=t[P];typeof L=="string"&&(t[P]=parseFloat(L))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:a}=this,o=[];for(let c=0;c<t.length;c++)$$(t[c])&&o.push(c);o.length&&lH(t,o,a)}measureInitialState(){const{element:t,unresolvedKeyframes:a,name:o}=this;if(!t||!t.current)return;o==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=r_[o](t.measureViewportBox(),window.getComputedStyle(t.current)),a[0]=this.measuredOrigin;const c=a[a.length-1];c!==void 0&&t.getValue(o,c).jump(c,!1)}measureEndState(){var t;const{element:a,name:o,unresolvedKeyframes:c}=this;if(!a||!a.current)return;const b=a.getValue(o);b&&b.jump(this.measuredOrigin,!1);const S=c.length-1,i=c[S];c[S]=r_[o](a.measureViewportBox(),window.getComputedStyle(a.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),!((t=this.removedTransforms)===null||t===void 0)&&t.length&&this.removedTransforms.forEach(([P,L])=>{a.getValue(P).set(L)}),this.resolveNoneKeyframes()}}const Vk=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(im.test(e)||e==="0")&&!e.startsWith("url("));function gH(e){const t=e[0];if(e.length===1)return!0;for(let a=0;a<e.length;a++)if(e[a]!==t)return!0}function yH(e,t,a,o){const c=e[0];if(c===null)return!1;if(t==="display"||t==="visibility")return!0;const b=e[e.length-1],S=Vk(c,t),i=Vk(b,t);return!S||!i?!1:gH(e)||(a==="spring"||BC(a))&&o}const _H=e=>e!==null;function Vw(e,{repeat:t,repeatType:a="loop"},o){const c=e.filter(_H),b=t&&a!=="loop"&&t%2===1?0:c.length-1;return!b||o===void 0?c[b]:o}const vH=40;class z6{constructor({autoplay:t=!0,delay:a=0,type:o="keyframes",repeat:c=0,repeatDelay:b=0,repeatType:S="loop",...i}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Nf.now(),this.options={autoplay:t,delay:a,type:o,repeat:c,repeatDelay:b,repeatType:S,...i},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>vH?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&fH(),this._resolved}onKeyframesResolved(t,a){this.resolvedAt=Nf.now(),this.hasAttemptedResolve=!0;const{name:o,type:c,velocity:b,delay:S,onComplete:i,onUpdate:P,isGenerator:L}=this.options;if(!L&&!yH(t,o,c,b))if(S)this.options.duration=0;else{P&&P(Vw(t,this.options,a)),i&&i(),this.resolveFinishedPromise();return}const U=this.initPlayback(t,a);U!==!1&&(this._resolved={keyframes:t,finalKeyframe:a,...U},this.onPostResolved())}onPostResolved(){}then(t,a){return this.currentFinishedPromise.then(t,a)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(t=>{this.resolveFinishedPromise=t})}}const po=(e,t,a)=>e+(t-e)*a;function XS(e,t,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?e+(t-e)*6*a:a<1/2?t:a<2/3?e+(t-e)*(2/3-a)*6:e}function xH({hue:e,saturation:t,lightness:a,alpha:o}){e/=360,t/=100,a/=100;let c=0,b=0,S=0;if(!t)c=b=S=a;else{const i=a<.5?a*(1+t):a+t-a*t,P=2*a-i;c=XS(P,i,e+1/3),b=XS(P,i,e),S=XS(P,i,e-1/3)}return{red:Math.round(c*255),green:Math.round(b*255),blue:Math.round(S*255),alpha:o}}function Ob(e,t){return a=>a>0?t:e}const YS=(e,t,a)=>{const o=e*e,c=a*(t*t-o)+o;return c<0?0:Math.sqrt(c)},bH=[gO,cg,Fy],wH=e=>bH.find(t=>t.test(e));function qk(e){const t=wH(e);if(!t)return!1;let a=t.parse(e);return t===Fy&&(a=xH(a)),a}const Gk=(e,t)=>{const a=qk(e),o=qk(t);if(!a||!o)return Ob(e,t);const c={...a};return b=>(c.red=YS(a.red,o.red,b),c.green=YS(a.green,o.green,b),c.blue=YS(a.blue,o.blue,b),c.alpha=po(a.alpha,o.alpha,b),cg.transform(c))},SH=(e,t)=>a=>t(e(a)),vx=(...e)=>e.reduce(SH),xO=new Set(["none","hidden"]);function TH(e,t){return xO.has(e)?a=>a<=0?e:t:a=>a>=1?t:e}function EH(e,t){return a=>po(e,t,a)}function KC(e){return typeof e=="number"?EH:typeof e=="string"?OC(e)?Ob:xl.test(e)?Gk:OH:Array.isArray(e)?N6:typeof e=="object"?xl.test(e)?Gk:AH:Ob}function N6(e,t){const a=[...e],o=a.length,c=e.map((b,S)=>KC(b)(b,t[S]));return b=>{for(let S=0;S<o;S++)a[S]=c[S](b);return a}}function AH(e,t){const a={...e,...t},o={};for(const c in a)e[c]!==void 0&&t[c]!==void 0&&(o[c]=KC(e[c])(e[c],t[c]));return c=>{for(const b in o)a[b]=o[b](c);return a}}function MH(e,t){var a;const o=[],c={color:0,var:0,number:0};for(let b=0;b<t.values.length;b++){const S=t.types[b],i=e.indexes[S][c[S]],P=(a=e.values[i])!==null&&a!==void 0?a:0;o[b]=P,c[S]++}return o}const OH=(e,t)=>{const a=im.createTransformer(t),o=I0(e),c=I0(t);return o.indexes.var.length===c.indexes.var.length&&o.indexes.color.length===c.indexes.color.length&&o.indexes.number.length>=c.indexes.number.length?xO.has(e)&&!c.values.length||xO.has(t)&&!o.values.length?TH(e,t):vx(N6(MH(o,c),c.values),a):Ob(e,t)};function B6(e,t,a){return typeof e=="number"&&typeof t=="number"&&typeof a=="number"?po(e,t,a):KC(e)(e,t)}const IH=5;function F6(e,t,a){const o=Math.max(t-IH,0);return GC(a-e(o),t-o)}const wo={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},$k=.001;function CH({duration:e=wo.duration,bounce:t=wo.bounce,velocity:a=wo.velocity,mass:o=wo.mass}){let c,b,S=1-t;S=jf(wo.minDamping,wo.maxDamping,S),e=jf(wo.minDuration,wo.maxDuration,Ud(e)),S<1?(c=L=>{const U=L*S,V=U*e,H=U-a,ee=bO(L,S),ie=Math.exp(-V);return $k-H/ee*ie},b=L=>{const V=L*S*e,H=V*a+a,ee=Math.pow(S,2)*Math.pow(L,2)*e,ie=Math.exp(-V),le=bO(Math.pow(L,2),S);return(-c(L)+$k>0?-1:1)*((H-ee)*ie)/le}):(c=L=>{const U=Math.exp(-L*e),V=(L-a)*e+1;return-.001+U*V},b=L=>{const U=Math.exp(-L*e),V=(a-L)*(e*e);return U*V});const i=5/e,P=RH(c,b,i);if(e=jd(e),isNaN(P))return{stiffness:wo.stiffness,damping:wo.damping,duration:e};{const L=Math.pow(P,2)*o;return{stiffness:L,damping:S*2*Math.sqrt(o*L),duration:e}}}const PH=12;function RH(e,t,a){let o=a;for(let c=1;c<PH;c++)o=o-e(o)/t(o);return o}function bO(e,t){return e*Math.sqrt(1-t*t)}const kH=["duration","bounce"],DH=["stiffness","damping","mass"];function Hk(e,t){return t.some(a=>e[a]!==void 0)}function LH(e){let t={velocity:wo.velocity,stiffness:wo.stiffness,damping:wo.damping,mass:wo.mass,isResolvedFromDuration:!1,...e};if(!Hk(e,DH)&&Hk(e,kH))if(e.visualDuration){const a=e.visualDuration,o=2*Math.PI/(a*1.2),c=o*o,b=2*jf(.05,1,1-(e.bounce||0))*Math.sqrt(c);t={...t,mass:wo.mass,stiffness:c,damping:b}}else{const a=CH(e);t={...t,...a,mass:wo.mass},t.isResolvedFromDuration=!0}return t}function j6(e=wo.visualDuration,t=wo.bounce){const a=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:o,restDelta:c}=a;const b=a.keyframes[0],S=a.keyframes[a.keyframes.length-1],i={done:!1,value:b},{stiffness:P,damping:L,mass:U,duration:V,velocity:H,isResolvedFromDuration:ee}=LH({...a,velocity:-Ud(a.velocity||0)}),ie=H||0,le=L/(2*Math.sqrt(P*U)),ue=S-b,ge=Ud(Math.sqrt(P/U)),Se=Math.abs(ue)<5;o||(o=Se?wo.restSpeed.granular:wo.restSpeed.default),c||(c=Se?wo.restDelta.granular:wo.restDelta.default);let ve;if(le<1){const me=bO(ge,le);ve=Ae=>{const Oe=Math.exp(-le*ge*Ae);return S-Oe*((ie+le*ge*ue)/me*Math.sin(me*Ae)+ue*Math.cos(me*Ae))}}else if(le===1)ve=me=>S-Math.exp(-ge*me)*(ue+(ie+ge*ue)*me);else{const me=ge*Math.sqrt(le*le-1);ve=Ae=>{const Oe=Math.exp(-le*ge*Ae),Ye=Math.min(me*Ae,300);return S-Oe*((ie+le*ge*ue)*Math.sinh(Ye)+me*ue*Math.cosh(Ye))/me}}const Ee={calculatedDuration:ee&&V||null,next:me=>{const Ae=ve(me);if(ee)i.done=me>=V;else{let Oe=0;le<1&&(Oe=me===0?jd(ie):F6(ve,me,Ae));const Ye=Math.abs(Oe)<=o,He=Math.abs(S-Ae)<=c;i.done=Ye&&He}return i.value=i.done?S:Ae,i},toString:()=>{const me=Math.min(i6(Ee),dO),Ae=a6(Oe=>Ee.next(me*Oe).value,me,30);return me+"ms "+Ae}};return Ee}function Xk({keyframes:e,velocity:t=0,power:a=.8,timeConstant:o=325,bounceDamping:c=10,bounceStiffness:b=500,modifyTarget:S,min:i,max:P,restDelta:L=.5,restSpeed:U}){const V=e[0],H={done:!1,value:V},ee=Ye=>i!==void 0&&Ye<i||P!==void 0&&Ye>P,ie=Ye=>i===void 0?P:P===void 0||Math.abs(i-Ye)<Math.abs(P-Ye)?i:P;let le=a*t;const ue=V+le,ge=S===void 0?ue:S(ue);ge!==ue&&(le=ge-V);const Se=Ye=>-le*Math.exp(-Ye/o),ve=Ye=>ge+Se(Ye),Ee=Ye=>{const He=Se(Ye),st=ve(Ye);H.done=Math.abs(He)<=L,H.value=H.done?ge:st};let me,Ae;const Oe=Ye=>{ee(H.value)&&(me=Ye,Ae=j6({keyframes:[H.value,ie(H.value)],velocity:F6(ve,Ye,H.value),damping:c,stiffness:b,restDelta:L,restSpeed:U}))};return Oe(0),{calculatedDuration:null,next:Ye=>{let He=!1;return!Ae&&me===void 0&&(He=!0,Ee(Ye),Oe(Ye)),me!==void 0&&Ye>=me?Ae.next(Ye-me):(!He&&Ee(Ye),H)}}}const zH=_x(.42,0,1,1),NH=_x(0,0,.58,1),U6=_x(.42,0,.58,1),BH=e=>Array.isArray(e)&&typeof e[0]!="number",FH={linear:Tl,easeIn:zH,easeInOut:U6,easeOut:NH,circIn:HC,circInOut:b6,circOut:x6,backIn:$C,backInOut:_6,backOut:y6,anticipate:v6},Yk=e=>{if(FC(e)){Bj(e.length===4);const[t,a,o,c]=e;return _x(t,a,o,c)}else if(typeof e=="string")return FH[e];return e};function jH(e,t,a){const o=[],c=a||B6,b=e.length-1;for(let S=0;S<b;S++){let i=c(e[S],e[S+1]);if(t){const P=Array.isArray(t)?t[S]||Tl:t;i=vx(P,i)}o.push(i)}return o}function JC(e,t,{clamp:a=!0,ease:o,mixer:c}={}){const b=e.length;if(Bj(b===t.length),b===1)return()=>t[0];if(b===2&&t[0]===t[1])return()=>t[1];const S=e[0]===e[1];e[0]>e[b-1]&&(e=[...e].reverse(),t=[...t].reverse());const i=jH(t,o,c),P=i.length,L=U=>{if(S&&U<e[0])return t[0];let V=0;if(P>1)for(;V<e.length-2&&!(U<e[V+1]);V++);const H=xg(e[V],e[V+1],U);return i[V](H)};return a?U=>L(jf(e[0],e[b-1],U)):L}function UH(e,t){const a=e[e.length-1];for(let o=1;o<=t;o++){const c=xg(0,t,o);e.push(po(a,1,c))}}function V6(e){const t=[0];return UH(t,e.length-1),t}function VH(e,t){return e.map(a=>a*t)}function qH(e,t){return e.map(()=>t||U6).splice(0,e.length-1)}function Ib({duration:e=300,keyframes:t,times:a,ease:o="easeInOut"}){const c=BH(o)?o.map(Yk):Yk(o),b={done:!1,value:t[0]},S=VH(a&&a.length===t.length?a:V6(t),e),i=JC(S,t,{ease:Array.isArray(c)?c:qH(t,c)});return{calculatedDuration:e,next:P=>(b.value=i(P),b.done=P>=e,b)}}const GH=e=>{const t=({timestamp:a})=>e(a);return{start:()=>Gi.update(t,!0),stop:()=>kh(t),now:()=>Os.isProcessing?Os.timestamp:Nf.now()}},$H={decay:Xk,inertia:Xk,tween:Ib,keyframes:Ib,spring:j6},HH=e=>e/100;class qw extends z6{constructor(t){super(t),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:P}=this.options;P&&P()};const{name:a,motionValue:o,element:c,keyframes:b}=this.options,S=(c==null?void 0:c.KeyframeResolver)||WC,i=(P,L)=>this.onKeyframesResolved(P,L);this.resolver=new S(b,i,a,o,c),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(t){const{type:a="keyframes",repeat:o=0,repeatDelay:c=0,repeatType:b,velocity:S=0}=this.options,i=BC(a)?a:$H[a]||Ib;let P,L;i!==Ib&&typeof t[0]!="number"&&(P=vx(HH,B6(t[0],t[1])),t=[0,100]);const U=i({...this.options,keyframes:t});b==="mirror"&&(L=i({...this.options,keyframes:[...t].reverse(),velocity:-S})),U.calculatedDuration===null&&(U.calculatedDuration=i6(U));const{calculatedDuration:V}=U,H=V+c,ee=H*(o+1)-c;return{generator:U,mirroredGenerator:L,mapPercentToKeyframes:P,calculatedDuration:V,resolvedDuration:H,totalDuration:ee}}onPostResolved(){const{autoplay:t=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!t?this.pause():this.state=this.pendingPlayState}tick(t,a=!1){const{resolved:o}=this;if(!o){const{keyframes:Ye}=this.options;return{done:!0,value:Ye[Ye.length-1]}}const{finalKeyframe:c,generator:b,mirroredGenerator:S,mapPercentToKeyframes:i,keyframes:P,calculatedDuration:L,totalDuration:U,resolvedDuration:V}=o;if(this.startTime===null)return b.next(0);const{delay:H,repeat:ee,repeatType:ie,repeatDelay:le,onUpdate:ue}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-U/this.speed,this.startTime)),a?this.currentTime=t:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(t-this.startTime)*this.speed;const ge=this.currentTime-H*(this.speed>=0?1:-1),Se=this.speed>=0?ge<0:ge>U;this.currentTime=Math.max(ge,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=U);let ve=this.currentTime,Ee=b;if(ee){const Ye=Math.min(this.currentTime,U)/V;let He=Math.floor(Ye),st=Ye%1;!st&&Ye>=1&&(st=1),st===1&&He--,He=Math.min(He,ee+1),!!(He%2)&&(ie==="reverse"?(st=1-st,le&&(st-=le/V)):ie==="mirror"&&(Ee=S)),ve=jf(0,1,st)*V}const me=Se?{done:!1,value:P[0]}:Ee.next(ve);i&&(me.value=i(me.value));let{done:Ae}=me;!Se&&L!==null&&(Ae=this.speed>=0?this.currentTime>=U:this.currentTime<=0);const Oe=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&Ae);return Oe&&c!==void 0&&(me.value=Vw(P,this.options,c)),ue&&ue(me.value),Oe&&this.finish(),me}get duration(){const{resolved:t}=this;return t?Ud(t.calculatedDuration):0}get time(){return Ud(this.currentTime)}set time(t){t=jd(t),this.currentTime=t,this.holdTime!==null||this.speed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.speed)}get speed(){return this.playbackSpeed}set speed(t){const a=this.playbackSpeed!==t;this.playbackSpeed=t,a&&(this.time=Ud(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:t=GH,onPlay:a,startTime:o}=this.options;this.driver||(this.driver=t(b=>this.tick(b))),a&&a();const c=this.driver.now();this.holdTime!==null?this.startTime=c-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=c):this.startTime=o??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var t;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(t=this.currentTime)!==null&&t!==void 0?t:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}}function XH(e){return new qw(e)}const YH=new Set(["opacity","clipPath","filter","transform"]);function ZH(e,t,a,{delay:o=0,duration:c=300,repeat:b=0,repeatType:S="loop",ease:i="easeInOut",times:P}={}){const L={[t]:a};P&&(L.offset=P);const U=s6(i,c);return Array.isArray(U)&&(L.easing=U),e.animate(L,{delay:o,duration:c,easing:Array.isArray(U)?"linear":U,fill:"both",iterations:b+1,direction:S==="reverse"?"alternate":"normal"})}const WH=wC(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Cb=10,KH=2e4;function JH(e){return BC(e.type)||e.type==="spring"||!o6(e.ease)}function QH(e,t){const a=new qw({...t,keyframes:e,repeat:0,delay:0,isGenerator:!0});let o={done:!1,value:e[0]};const c=[];let b=0;for(;!o.done&&b<KH;)o=a.sample(b),c.push(o.value),b+=Cb;return{times:void 0,keyframes:c,duration:b-Cb,ease:"linear"}}const q6={anticipate:v6,backInOut:_6,circInOut:b6};function eX(e){return e in q6}class Zk extends z6{constructor(t){super(t);const{name:a,motionValue:o,element:c,keyframes:b}=this.options;this.resolver=new L6(b,(S,i)=>this.onKeyframesResolved(S,i),a,o,c),this.resolver.scheduleResolve()}initPlayback(t,a){let{duration:o=300,times:c,ease:b,type:S,motionValue:i,name:P,startTime:L}=this.options;if(!i.owner||!i.owner.current)return!1;if(typeof b=="string"&&Ab()&&eX(b)&&(b=q6[b]),JH(this.options)){const{onComplete:V,onUpdate:H,motionValue:ee,element:ie,...le}=this.options,ue=QH(t,le);t=ue.keyframes,t.length===1&&(t[1]=t[0]),o=ue.duration,c=ue.times,b=ue.ease,S="keyframes"}const U=ZH(i.owner.current,P,t,{...this.options,duration:o,times:c,ease:b});return U.startTime=L??this.calcStartTime(),this.pendingTimeline?(Rk(U,this.pendingTimeline),this.pendingTimeline=void 0):U.onfinish=()=>{const{onComplete:V}=this.options;i.set(Vw(t,this.options,a)),V&&V(),this.cancel(),this.resolveFinishedPromise()},{animation:U,duration:o,times:c,type:S,ease:b,keyframes:t}}get duration(){const{resolved:t}=this;if(!t)return 0;const{duration:a}=t;return Ud(a)}get time(){const{resolved:t}=this;if(!t)return 0;const{animation:a}=t;return Ud(a.currentTime||0)}set time(t){const{resolved:a}=this;if(!a)return;const{animation:o}=a;o.currentTime=jd(t)}get speed(){const{resolved:t}=this;if(!t)return 1;const{animation:a}=t;return a.playbackRate}set speed(t){const{resolved:a}=this;if(!a)return;const{animation:o}=a;o.playbackRate=t}get state(){const{resolved:t}=this;if(!t)return"idle";const{animation:a}=t;return a.playState}get startTime(){const{resolved:t}=this;if(!t)return null;const{animation:a}=t;return a.startTime}attachTimeline(t){if(!this._resolved)this.pendingTimeline=t;else{const{resolved:a}=this;if(!a)return Tl;const{animation:o}=a;Rk(o,t)}return Tl}play(){if(this.isStopped)return;const{resolved:t}=this;if(!t)return;const{animation:a}=t;a.playState==="finished"&&this.updateFinishedPromise(),a.play()}pause(){const{resolved:t}=this;if(!t)return;const{animation:a}=t;a.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:t}=this;if(!t)return;const{animation:a,keyframes:o,duration:c,type:b,ease:S,times:i}=t;if(a.playState==="idle"||a.playState==="finished")return;if(this.time){const{motionValue:L,onUpdate:U,onComplete:V,element:H,...ee}=this.options,ie=new qw({...ee,keyframes:o,duration:c,type:b,ease:S,times:i,isGenerator:!0}),le=jd(this.time);L.setWithVelocity(ie.sample(le-Cb).value,ie.sample(le).value,Cb)}const{onStop:P}=this.options;P&&P(),this.cancel()}complete(){const{resolved:t}=this;t&&t.animation.finish()}cancel(){const{resolved:t}=this;t&&t.animation.cancel()}static supports(t){const{motionValue:a,name:o,repeatDelay:c,repeatType:b,damping:S,type:i}=t;if(!a||!a.owner||!(a.owner.current instanceof HTMLElement))return!1;const{onUpdate:P,transformTemplate:L}=a.owner.getProps();return WH()&&o&&YH.has(o)&&!P&&!L&&!c&&b!=="mirror"&&S!==0&&i!=="inertia"}}const tX={type:"spring",stiffness:500,damping:25,restSpeed:10},nX=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),rX={type:"keyframes",duration:.8},iX={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},aX=(e,{keyframes:t})=>t.length>2?rX:Og.has(e)?e.startsWith("scale")?nX(t[1]):tX:iX;function oX({when:e,delay:t,delayChildren:a,staggerChildren:o,staggerDirection:c,repeat:b,repeatType:S,repeatDelay:i,from:P,elapsed:L,...U}){return!!Object.keys(U).length}const QC=(e,t,a,o={},c,b)=>S=>{const i=NC(o,e)||{},P=i.delay||o.delay||0;let{elapsed:L=0}=o;L=L-jd(P);let U={keyframes:Array.isArray(a)?a:[null,a],ease:"easeOut",velocity:t.getVelocity(),...i,delay:-L,onUpdate:H=>{t.set(H),i.onUpdate&&i.onUpdate(H)},onComplete:()=>{S(),i.onComplete&&i.onComplete()},name:e,motionValue:t,element:b?void 0:c};oX(i)||(U={...U,...aX(e,U)}),U.duration&&(U.duration=jd(U.duration)),U.repeatDelay&&(U.repeatDelay=jd(U.repeatDelay)),U.from!==void 0&&(U.keyframes[0]=U.from);let V=!1;if((U.type===!1||U.duration===0&&!U.repeatDelay)&&(U.duration=0,U.delay===0&&(V=!0)),V&&!b&&t.get()!==void 0){const H=Vw(U.keyframes,i);if(H!==void 0)return Gi.update(()=>{U.onUpdate(H),U.onComplete()}),new A$([])}return!b&&Zk.supports(U)?new Zk(U):new qw(U)};function sX({protectedKeys:e,needsAnimating:t},a){const o=e.hasOwnProperty(a)&&t[a]!==!0;return t[a]=!1,o}function G6(e,t,{delay:a=0,transitionOverride:o,type:c}={}){var b;let{transition:S=e.getDefaultTransition(),transitionEnd:i,...P}=t;o&&(S=o);const L=[],U=c&&e.animationState&&e.animationState.getState()[c];for(const V in P){const H=e.getValue(V,(b=e.latestValues[V])!==null&&b!==void 0?b:null),ee=P[V];if(ee===void 0||U&&sX(U,V))continue;const ie={delay:a,...NC(S||{},V)};let le=!1;if(window.MotionHandoffAnimation){const ge=d6(e);if(ge){const Se=window.MotionHandoffAnimation(ge,V,Gi);Se!==null&&(ie.startTime=Se,le=!0)}}mO(e,V),H.start(QC(V,H,ee,e.shouldReduceMotion&&f6.has(V)?{type:!1}:ie,e,le));const ue=H.animation;ue&&L.push(ue)}return i&&Promise.all(L).then(()=>{Gi.update(()=>{i&&j$(e,i)})}),L}function wO(e,t,a={}){var o;const c=O0(e,t,a.type==="exit"?(o=e.presenceContext)===null||o===void 0?void 0:o.custom:void 0);let{transition:b=e.getDefaultTransition()||{}}=c||{};a.transitionOverride&&(b=a.transitionOverride);const S=c?()=>Promise.all(G6(e,c,a)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(L=0)=>{const{delayChildren:U=0,staggerChildren:V,staggerDirection:H}=b;return lX(e,t,U+L,V,H,a)}:()=>Promise.resolve(),{when:P}=b;if(P){const[L,U]=P==="beforeChildren"?[S,i]:[i,S];return L().then(()=>U())}else return Promise.all([S(),i(a.delay)])}function lX(e,t,a=0,o=0,c=1,b){const S=[],i=(e.variantChildren.size-1)*o,P=c===1?(L=0)=>L*o:(L=0)=>i-L*o;return Array.from(e.variantChildren).sort(uX).forEach((L,U)=>{L.notify("AnimationStart",t),S.push(wO(L,t,{...b,delay:a+P(U)}).then(()=>L.notify("AnimationComplete",t)))}),Promise.all(S)}function uX(e,t){return e.sortNodePosition(t)}function cX(e,t,a={}){e.notify("AnimationStart",t);let o;if(Array.isArray(t)){const c=t.map(b=>wO(e,b,a));o=Promise.all(c)}else if(typeof t=="string")o=wO(e,t,a);else{const c=typeof t=="function"?O0(e,t,a.custom):t;o=Promise.all(G6(e,c,a))}return o.then(()=>{e.notify("AnimationComplete",t)})}function $6(e,t){if(!Array.isArray(t))return!1;const a=t.length;if(a!==e.length)return!1;for(let o=0;o<a;o++)if(t[o]!==e[o])return!1;return!0}const hX=TC.length;function H6(e){if(!e)return;if(!e.isControllingVariants){const a=e.parent?H6(e.parent)||{}:{};return e.props.initial!==void 0&&(a.initial=e.props.initial),a}const t={};for(let a=0;a<hX;a++){const o=TC[a],c=e.props[o];(E0(c)||c===!1)&&(t[o]=c)}return t}const fX=[...SC].reverse(),dX=SC.length;function pX(e){return t=>Promise.all(t.map(({animation:a,options:o})=>cX(e,a,o)))}function mX(e){let t=pX(e),a=Wk(),o=!0;const c=P=>(L,U)=>{var V;const H=O0(e,U,P==="exit"?(V=e.presenceContext)===null||V===void 0?void 0:V.custom:void 0);if(H){const{transition:ee,transitionEnd:ie,...le}=H;L={...L,...le,...ie}}return L};function b(P){t=P(e)}function S(P){const{props:L}=e,U=H6(e.parent)||{},V=[],H=new Set;let ee={},ie=1/0;for(let ue=0;ue<dX;ue++){const ge=fX[ue],Se=a[ge],ve=L[ge]!==void 0?L[ge]:U[ge],Ee=E0(ve),me=ge===P?Se.isActive:null;me===!1&&(ie=ue);let Ae=ve===U[ge]&&ve!==L[ge]&&Ee;if(Ae&&o&&e.manuallyAnimateOnMount&&(Ae=!1),Se.protectedKeys={...ee},!Se.isActive&&me===null||!ve&&!Se.prevProp||jw(ve)||typeof ve=="boolean")continue;const Oe=gX(Se.prevProp,ve);let Ye=Oe||ge===P&&Se.isActive&&!Ae&&Ee||ue>ie&&Ee,He=!1;const st=Array.isArray(ve)?ve:[ve];let Ke=st.reduce(c(ge),{});me===!1&&(Ke={});const{prevResolvedValues:Ot={}}=Se,Bt={...Ot,...Ke},Tt=Ft=>{Ye=!0,H.has(Ft)&&(He=!0,H.delete(Ft)),Se.needsAnimating[Ft]=!0;const Zt=e.getValue(Ft);Zt&&(Zt.liveStyle=!1)};for(const Ft in Bt){const Zt=Ke[Ft],Vt=Ot[Ft];if(ee.hasOwnProperty(Ft))continue;let Ze=!1;fO(Zt)&&fO(Vt)?Ze=!$6(Zt,Vt):Ze=Zt!==Vt,Ze?Zt!=null?Tt(Ft):H.add(Ft):Zt!==void 0&&H.has(Ft)?Tt(Ft):Se.protectedKeys[Ft]=!0}Se.prevProp=ve,Se.prevResolvedValues=Ke,Se.isActive&&(ee={...ee,...Ke}),o&&e.blockInitialAnimation&&(Ye=!1),Ye&&(!(Ae&&Oe)||He)&&V.push(...st.map(Ft=>({animation:Ft,options:{type:ge}})))}if(H.size){const ue={};if(typeof L.initial!="boolean"){const ge=O0(e,Array.isArray(L.initial)?L.initial[0]:L.initial);ge&&ge.transition&&(ue.transition=ge.transition)}H.forEach(ge=>{const Se=e.getBaseTarget(ge),ve=e.getValue(ge);ve&&(ve.liveStyle=!0),ue[ge]=Se??null}),V.push({animation:ue})}let le=!!V.length;return o&&(L.initial===!1||L.initial===L.animate)&&!e.manuallyAnimateOnMount&&(le=!1),o=!1,le?t(V):Promise.resolve()}function i(P,L){var U;if(a[P].isActive===L)return Promise.resolve();(U=e.variantChildren)===null||U===void 0||U.forEach(H=>{var ee;return(ee=H.animationState)===null||ee===void 0?void 0:ee.setActive(P,L)}),a[P].isActive=L;const V=S(P);for(const H in a)a[H].protectedKeys={};return V}return{animateChanges:S,setActive:i,setAnimateFunction:b,getState:()=>a,reset:()=>{a=Wk(),o=!0}}}function gX(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!$6(t,e):!1}function ag(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Wk(){return{animate:ag(!0),whileInView:ag(),whileHover:ag(),whileTap:ag(),whileDrag:ag(),whileFocus:ag(),exit:ag()}}class um{constructor(t){this.isMounted=!1,this.node=t}update(){}}class yX extends um{constructor(t){super(t),t.animationState||(t.animationState=mX(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();jw(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:a}=this.node.prevProps||{};t!==a&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)===null||t===void 0||t.call(this)}}let _X=0;class vX extends um{constructor(){super(...arguments),this.id=_X++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:a}=this.node.presenceContext,{isPresent:o}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===o)return;const c=this.node.animationState.setActive("exit",!t);a&&!t&&c.then(()=>{a(this.id)})}mount(){const{register:t,onExitComplete:a}=this.node.presenceContext||{};a&&a(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const xX={animation:{Feature:yX},exit:{Feature:vX}};function C0(e,t,a,o={passive:!0}){return e.addEventListener(t,a,o),()=>e.removeEventListener(t,a)}function xx(e){return{point:{x:e.pageX,y:e.pageY}}}const bX=e=>t=>jC(t)&&e(t,xx(t));function jy(e,t,a,o){return C0(e,t,bX(a),o)}function X6({top:e,left:t,right:a,bottom:o}){return{x:{min:t,max:a},y:{min:e,max:o}}}function wX({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function SX(e,t){if(!t)return e;const a=t({x:e.left,y:e.top}),o=t({x:e.right,y:e.bottom});return{top:a.y,left:a.x,bottom:o.y,right:o.x}}const Y6=1e-4,TX=1-Y6,EX=1+Y6,Z6=.01,AX=0-Z6,MX=0+Z6;function Yl(e){return e.max-e.min}function OX(e,t,a){return Math.abs(e-t)<=a}function Kk(e,t,a,o=.5){e.origin=o,e.originPoint=po(t.min,t.max,e.origin),e.scale=Yl(a)/Yl(t),e.translate=po(a.min,a.max,e.origin)-e.originPoint,(e.scale>=TX&&e.scale<=EX||isNaN(e.scale))&&(e.scale=1),(e.translate>=AX&&e.translate<=MX||isNaN(e.translate))&&(e.translate=0)}function d0(e,t,a,o){Kk(e.x,t.x,a.x,o?o.originX:void 0),Kk(e.y,t.y,a.y,o?o.originY:void 0)}function Jk(e,t,a){e.min=a.min+t.min,e.max=e.min+Yl(t)}function IX(e,t,a){Jk(e.x,t.x,a.x),Jk(e.y,t.y,a.y)}function Qk(e,t,a){e.min=t.min-a.min,e.max=e.min+Yl(t)}function p0(e,t,a){Qk(e.x,t.x,a.x),Qk(e.y,t.y,a.y)}const eD=()=>({translate:0,scale:1,origin:0,originPoint:0}),Uy=()=>({x:eD(),y:eD()}),tD=()=>({min:0,max:0}),Do=()=>({x:tD(),y:tD()});function Uc(e){return[e("x"),e("y")]}function ZS(e){return e===void 0||e===1}function SO({scale:e,scaleX:t,scaleY:a}){return!ZS(e)||!ZS(t)||!ZS(a)}function sg(e){return SO(e)||W6(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function W6(e){return nD(e.x)||nD(e.y)}function nD(e){return e&&e!=="0%"}function Pb(e,t,a){const o=e-a,c=t*o;return a+c}function rD(e,t,a,o,c){return c!==void 0&&(e=Pb(e,c,o)),Pb(e,a,o)+t}function TO(e,t=0,a=1,o,c){e.min=rD(e.min,t,a,o,c),e.max=rD(e.max,t,a,o,c)}function K6(e,{x:t,y:a}){TO(e.x,t.translate,t.scale,t.originPoint),TO(e.y,a.translate,a.scale,a.originPoint)}const iD=.999999999999,aD=1.0000000000001;function CX(e,t,a,o=!1){const c=a.length;if(!c)return;t.x=t.y=1;let b,S;for(let i=0;i<c;i++){b=a[i],S=b.projectionDelta;const{visualElement:P}=b.options;P&&P.props.style&&P.props.style.display==="contents"||(o&&b.options.layoutScroll&&b.scroll&&b!==b.root&&qy(e,{x:-b.scroll.offset.x,y:-b.scroll.offset.y}),S&&(t.x*=S.x.scale,t.y*=S.y.scale,K6(e,S)),o&&sg(b.latestValues)&&qy(e,b.latestValues))}t.x<aD&&t.x>iD&&(t.x=1),t.y<aD&&t.y>iD&&(t.y=1)}function Vy(e,t){e.min=e.min+t,e.max=e.max+t}function oD(e,t,a,o,c=.5){const b=po(e.min,e.max,c);TO(e,t,a,b,o)}function qy(e,t){oD(e.x,t.x,t.scaleX,t.scale,t.originX),oD(e.y,t.y,t.scaleY,t.scale,t.originY)}function J6(e,t){return X6(SX(e.getBoundingClientRect(),t))}function PX(e,t,a){const o=J6(e,a),{scroll:c}=t;return c&&(Vy(o.x,c.offset.x),Vy(o.y,c.offset.y)),o}const sD=(e,t)=>Math.abs(e-t);function RX(e,t){const a=sD(e.x,t.x),o=sD(e.y,t.y);return Math.sqrt(a**2+o**2)}class Q6{constructor(t,a,{transformPagePoint:o,dragSnapToOrigin:c=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const U=KS(this.lastMoveEventInfo,this.history),V=this.startEvent!==null,H=RX(U.offset,{x:0,y:0})>=3;if(!V&&!H)return;const{point:ee}=U,{timestamp:ie}=Os;this.history.push({...ee,timestamp:ie});const{onStart:le,onMove:ue}=this.handlers;V||(le&&le(this.lastMoveEvent,U),this.startEvent=this.lastMoveEvent),ue&&ue(this.lastMoveEvent,U)},this.handlePointerMove=(U,V)=>{if(U.target instanceof Element&&U.target.hasPointerCapture&&U.pointerId!==void 0)try{if(!U.target.hasPointerCapture(U.pointerId))return}catch{}this.lastMoveEvent=U,this.lastMoveEventInfo=WS(V,this.transformPagePoint),Gi.update(this.updatePoint,!0)},this.handlePointerUp=(U,V)=>{Mb(U,"release"),this.end();const{onEnd:H,onSessionEnd:ee,resumeAnimation:ie}=this.handlers;if(this.dragSnapToOrigin&&ie&&ie(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const le=KS(U.type==="pointercancel"||U.type==="lostpointercapture"?this.lastMoveEventInfo:WS(V,this.transformPagePoint),this.history);this.startEvent&&H&&H(U,le),ee&&ee(U,le)},!jC(t))return;this.dragSnapToOrigin=c,this.handlers=a,this.transformPagePoint=o;const b=xx(t),S=WS(b,this.transformPagePoint),{point:i}=S,{timestamp:P}=Os;this.history=[{...i,timestamp:P}];const{onSessionStart:L}=a;L&&L(t,KS(S,this.history)),Mb(t,"set"),this.removeListeners=vx(jy(t.currentTarget,"pointermove",this.handlePointerMove),jy(t.currentTarget,"pointerup",this.handlePointerUp),jy(t.currentTarget,"pointercancel",this.handlePointerUp),jy(t.currentTarget,"lostpointercapture",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),kh(this.updatePoint)}}function WS(e,t){return t?{point:t(e.point)}:e}function lD(e,t){return{x:e.x-t.x,y:e.y-t.y}}function KS({point:e},t){return{point:e,delta:lD(e,eU(t)),offset:lD(e,kX(t)),velocity:DX(t,.1)}}function kX(e){return e[0]}function eU(e){return e[e.length-1]}function DX(e,t){if(e.length<2)return{x:0,y:0};let a=e.length-1,o=null;const c=eU(e);for(;a>=0&&(o=e[a],!(c.timestamp-o.timestamp>jd(t)));)a--;if(!o)return{x:0,y:0};const b=Ud(c.timestamp-o.timestamp);if(b===0)return{x:0,y:0};const S={x:(c.x-o.x)/b,y:(c.y-o.y)/b};return S.x===1/0&&(S.x=0),S.y===1/0&&(S.y=0),S}function LX(e,{min:t,max:a},o){return t!==void 0&&e<t?e=o?po(t,e,o.min):Math.max(e,t):a!==void 0&&e>a&&(e=o?po(a,e,o.max):Math.min(e,a)),e}function uD(e,t,a){return{min:t!==void 0?e.min+t:void 0,max:a!==void 0?e.max+a-(e.max-e.min):void 0}}function zX(e,{top:t,left:a,bottom:o,right:c}){return{x:uD(e.x,a,c),y:uD(e.y,t,o)}}function cD(e,t){let a=t.min-e.min,o=t.max-e.max;return t.max-t.min<e.max-e.min&&([a,o]=[o,a]),{min:a,max:o}}function NX(e,t){return{x:cD(e.x,t.x),y:cD(e.y,t.y)}}function BX(e,t){let a=.5;const o=Yl(e),c=Yl(t);return c>o?a=xg(t.min,t.max-o,e.min):o>c&&(a=xg(e.min,e.max-c,t.min)),jf(0,1,a)}function FX(e,t){const a={};return t.min!==void 0&&(a.min=t.min-e.min),t.max!==void 0&&(a.max=t.max-e.min),a}const EO=.35;function jX(e=EO){return e===!1?e=0:e===!0&&(e=EO),{x:hD(e,"left","right"),y:hD(e,"top","bottom")}}function hD(e,t,a){return{min:fD(e,t),max:fD(e,a)}}function fD(e,t){return typeof e=="number"?e:e[t]||0}const UX=new WeakMap;class VX{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Do(),this.visualElement=t}start(t,{snapToCursor:a=!1}={}){const{presenceContext:o}=this.visualElement;if(o&&o.isPresent===!1)return;const c=U=>{const{dragSnapToOrigin:V}=this.getProps();V?this.pauseAnimation():this.stopAnimation(),a&&this.snapToCursor(xx(U).point)},b=(U,V)=>{const{drag:H,dragPropagation:ee,onDragStart:ie}=this.getProps();if(H&&!ee&&(this.openDragLock&&this.openDragLock(),this.openDragLock=L$(H),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Uc(ue=>{let ge=this.getAxisMotionValue(ue).get()||0;if(zf.test(ge)){const{projection:Se}=this.visualElement;if(Se&&Se.layout){const ve=Se.layout.layoutBox[ue];ve&&(ge=Yl(ve)*(parseFloat(ge)/100))}}this.originPoint[ue]=ge}),ie&&Gi.postRender(()=>ie(U,V)),mO(this.visualElement,"transform");const{animationState:le}=this.visualElement;le&&le.setActive("whileDrag",!0)},S=(U,V)=>{const{dragPropagation:H,dragDirectionLock:ee,onDirectionLock:ie,onDrag:le}=this.getProps();if(!H&&!this.openDragLock)return;const{offset:ue}=V;if(ee&&this.currentDirection===null){this.currentDirection=qX(ue),this.currentDirection!==null&&ie&&ie(this.currentDirection);return}this.updateAxis("x",V.point,ue),this.updateAxis("y",V.point,ue),this.visualElement.render(),le&&le(U,V)},i=(U,V)=>this.stop(U,V),P=()=>Uc(U=>{var V;return this.getAnimationState(U)==="paused"&&((V=this.getAxisMotionValue(U).animation)===null||V===void 0?void 0:V.play())}),{dragSnapToOrigin:L}=this.getProps();this.panSession=new Q6(t,{onSessionStart:c,onStart:b,onMove:S,onSessionEnd:i,resumeAnimation:P},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:L})}stop(t,a){const o=this.isDragging;if(this.cancel(),!o)return;const{velocity:c}=a;this.startAnimation(c);const{onDragEnd:b}=this.getProps();b&&Gi.postRender(()=>b(t,a))}cancel(){this.isDragging=!1;const{projection:t,animationState:a}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:o}=this.getProps();!o&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),a&&a.setActive("whileDrag",!1)}updateAxis(t,a,o){const{drag:c}=this.getProps();if(!o||!q1(t,c,this.currentDirection))return;const b=this.getAxisMotionValue(t);let S=this.originPoint[t]+o[t];this.constraints&&this.constraints[t]&&(S=LX(S,this.constraints[t],this.elastic[t])),b.set(S)}resolveConstraints(){var t;const{dragConstraints:a,dragElastic:o}=this.getProps(),c=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,b=this.constraints;a&&By(a)?this.constraints||(this.constraints=this.resolveRefConstraints()):a&&c?this.constraints=zX(c.layoutBox,a):this.constraints=!1,this.elastic=jX(o),b!==this.constraints&&c&&this.constraints&&!this.hasMutatedConstraints&&Uc(S=>{this.constraints!==!1&&this.getAxisMotionValue(S)&&(this.constraints[S]=FX(c.layoutBox[S],this.constraints[S]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:a}=this.getProps();if(!t||!By(t))return!1;const o=t.current,{projection:c}=this.visualElement;if(!c||!c.layout)return!1;const b=PX(o,c.root,this.visualElement.getTransformPagePoint());let S=NX(c.layout.layoutBox,b);if(a){const i=a(wX(S));this.hasMutatedConstraints=!!i,i&&(S=X6(i))}return S}startAnimation(t){const{drag:a,dragMomentum:o,dragElastic:c,dragTransition:b,dragSnapToOrigin:S,onDragTransitionEnd:i}=this.getProps(),P=this.constraints||{},L=Uc(U=>{if(!q1(U,a,this.currentDirection))return;let V=P&&P[U]||{};S&&(V={min:0,max:0});const H=c?200:1e6,ee=c?40:1e7,ie={type:"inertia",velocity:o?t[U]:0,bounceStiffness:H,bounceDamping:ee,timeConstant:750,restDelta:1,restSpeed:10,...b,...V};return this.startAxisValueAnimation(U,ie)});return Promise.all(L).then(i)}startAxisValueAnimation(t,a){const o=this.getAxisMotionValue(t);return mO(this.visualElement,t),o.start(QC(t,o,0,a,this.visualElement,!1))}stopAnimation(){Uc(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Uc(t=>{var a;return(a=this.getAxisMotionValue(t).animation)===null||a===void 0?void 0:a.pause()})}getAnimationState(t){var a;return(a=this.getAxisMotionValue(t).animation)===null||a===void 0?void 0:a.state}getAxisMotionValue(t){const a=`_drag${t.toUpperCase()}`,o=this.visualElement.getProps(),c=o[a];return c||this.visualElement.getValue(t,(o.initial?o.initial[t]:void 0)||0)}snapToCursor(t){Uc(a=>{const{drag:o}=this.getProps();if(!q1(a,o,this.currentDirection))return;const{projection:c}=this.visualElement,b=this.getAxisMotionValue(a);if(c&&c.layout){const{min:S,max:i}=c.layout.layoutBox[a];b.set(t[a]-po(S,i,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:a}=this.getProps(),{projection:o}=this.visualElement;if(!By(a)||!o||!this.constraints)return;this.stopAnimation();const c={x:0,y:0};Uc(S=>{const i=this.getAxisMotionValue(S);if(i&&this.constraints!==!1){const P=i.get();c[S]=BX({min:P,max:P},this.constraints[S])}});const{transformTemplate:b}=this.visualElement.getProps();this.visualElement.current.style.transform=b?b({},""):"none",o.root&&o.root.updateScroll(),o.updateLayout(),this.resolveConstraints(),Uc(S=>{if(!q1(S,t,null))return;const i=this.getAxisMotionValue(S),{min:P,max:L}=this.constraints[S];i.set(po(P,L,c[S]))})}addListeners(){if(!this.visualElement.current)return;UX.set(this.visualElement,this);const t=this.visualElement.current,a=jy(t,"pointerdown",P=>{const{drag:L,dragListener:U=!0}=this.getProps();L&&U&&this.start(P)}),o=()=>{const{dragConstraints:P}=this.getProps();By(P)&&P.current&&(this.constraints=this.resolveRefConstraints())},{projection:c}=this.visualElement,b=c.addEventListener("measure",o);c&&!c.layout&&(c.root&&c.root.updateScroll(),c.updateLayout()),Gi.read(o);const S=C0(window,"resize",()=>this.scalePositionWithinConstraints()),i=c.addEventListener("didUpdate",({delta:P,hasLayoutChanged:L})=>{this.isDragging&&L&&(Uc(U=>{const V=this.getAxisMotionValue(U);V&&(this.originPoint[U]+=P[U].translate,V.set(V.get()+P[U].translate))}),this.visualElement.render())});return()=>{S(),a(),b(),i&&i()}}getProps(){const t=this.visualElement.getProps(),{drag:a=!1,dragDirectionLock:o=!1,dragPropagation:c=!1,dragConstraints:b=!1,dragElastic:S=EO,dragMomentum:i=!0}=t;return{...t,drag:a,dragDirectionLock:o,dragPropagation:c,dragConstraints:b,dragElastic:S,dragMomentum:i}}}function q1(e,t,a){return(t===!0||t===e)&&(a===null||a===e)}function qX(e,t=10){let a=null;return Math.abs(e.y)>t?a="y":Math.abs(e.x)>t&&(a="x"),a}class GX extends um{constructor(t){super(t),this.removeGroupControls=Tl,this.removeListeners=Tl,this.controls=new VX(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Tl}unmount(){this.removeGroupControls(),this.removeListeners()}}const dD=e=>(t,a)=>{e&&Gi.postRender(()=>e(t,a))};class $X extends um{constructor(){super(...arguments),this.removePointerDownListener=Tl}onPointerDown(t){this.session=new Q6(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint()})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:a,onPan:o,onPanEnd:c}=this.node.getProps();return{onSessionStart:dD(t),onStart:dD(a),onMove:o,onEnd:(b,S)=>{delete this.session,c&&Gi.postRender(()=>c(b,S))}}}mount(){this.removePointerDownListener=jy(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const gb={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function pD(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Xv={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Xr.test(e))e=parseFloat(e);else return e;const a=pD(e,t.target.x),o=pD(e,t.target.y);return`${a}% ${o}%`}},HX={correct:(e,{treeScale:t,projectionDelta:a})=>{const o=e,c=im.parse(e);if(c.length>5)return o;const b=im.createTransformer(e),S=typeof c[0]!="number"?1:0,i=a.x.scale*t.x,P=a.y.scale*t.y;c[0+S]/=i,c[1+S]/=P;const L=po(i,P,.5);return typeof c[2+S]=="number"&&(c[2+S]/=L),typeof c[3+S]=="number"&&(c[3+S]/=L),b(c)}};class XX extends Jt.Component{componentDidMount(){const{visualElement:t,layoutGroup:a,switchLayoutGroup:o,layoutId:c}=this.props,{projection:b}=t;e$(YX),b&&(a.group&&a.group.add(b),o&&o.register&&c&&o.register(b),b.root.didUpdate(),b.addEventListener("animationComplete",()=>{this.safeToRemove()}),b.setOptions({...b.options,onExitComplete:()=>this.safeToRemove()})),gb.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:a,visualElement:o,drag:c,isPresent:b}=this.props,S=o.projection;return S&&(S.isPresent=b,c||t.layoutDependency!==a||a===void 0?S.willUpdate():this.safeToRemove(),t.isPresent!==b&&(b?S.promote():S.relegate()||Gi.postRender(()=>{const i=S.getStack();(!i||!i.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),AC.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:a,switchLayoutGroup:o}=this.props,{projection:c}=t;c&&(c.scheduleCheckAfterUnmount(),a&&a.group&&a.group.remove(c),o&&o.deregister&&o.deregister(c))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function tU(e){const[t,a]=PG(),o=Jt.useContext(Nj);return nn.jsx(XX,{...e,layoutGroup:o,switchLayoutGroup:Jt.useContext(Gj),isPresent:t,safeToRemove:a})}const YX={borderRadius:{...Xv,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Xv,borderTopRightRadius:Xv,borderBottomLeftRadius:Xv,borderBottomRightRadius:Xv,boxShadow:HX};function ZX(e,t,a){const o=Cs(e)?e:Pf(e);return o.start(QC("",o,t,a)),o.animation}function WX(e){return e instanceof SVGElement&&e.tagName!=="svg"}const KX=(e,t)=>e.depth-t.depth;class JX{constructor(){this.children=[],this.isDirty=!1}add(t){UC(this.children,t),this.isDirty=!0}remove(t){VC(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(KX),this.isDirty=!1,this.children.forEach(t)}}function QX(e,t){const a=Nf.now(),o=({timestamp:c})=>{const b=c-a;b>=t&&(kh(o),e(b-t))};return Gi.read(o,!0),()=>kh(o)}const nU=["TopLeft","TopRight","BottomLeft","BottomRight"],eY=nU.length,mD=e=>typeof e=="string"?parseFloat(e):e,gD=e=>typeof e=="number"||Xr.test(e);function tY(e,t,a,o,c,b){c?(e.opacity=po(0,a.opacity!==void 0?a.opacity:1,nY(o)),e.opacityExit=po(t.opacity!==void 0?t.opacity:1,0,rY(o))):b&&(e.opacity=po(t.opacity!==void 0?t.opacity:1,a.opacity!==void 0?a.opacity:1,o));for(let S=0;S<eY;S++){const i=`border${nU[S]}Radius`;let P=yD(t,i),L=yD(a,i);if(P===void 0&&L===void 0)continue;P||(P=0),L||(L=0),P===0||L===0||gD(P)===gD(L)?(e[i]=Math.max(po(mD(P),mD(L),o),0),(zf.test(L)||zf.test(P))&&(e[i]+="%")):e[i]=L}(t.rotate||a.rotate)&&(e.rotate=po(t.rotate||0,a.rotate||0,o))}function yD(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const nY=rU(0,.5,x6),rY=rU(.5,.95,Tl);function rU(e,t,a){return o=>o<e?0:o>t?1:a(xg(e,t,o))}function _D(e,t){e.min=t.min,e.max=t.max}function Bc(e,t){_D(e.x,t.x),_D(e.y,t.y)}function vD(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function xD(e,t,a,o,c){return e-=t,e=Pb(e,1/a,o),c!==void 0&&(e=Pb(e,1/c,o)),e}function iY(e,t=0,a=1,o=.5,c,b=e,S=e){if(zf.test(t)&&(t=parseFloat(t),t=po(S.min,S.max,t/100)-S.min),typeof t!="number")return;let i=po(b.min,b.max,o);e===b&&(i-=t),e.min=xD(e.min,t,a,i,c),e.max=xD(e.max,t,a,i,c)}function bD(e,t,[a,o,c],b,S){iY(e,t[a],t[o],t[c],t.scale,b,S)}const aY=["x","scaleX","originX"],oY=["y","scaleY","originY"];function wD(e,t,a,o){bD(e.x,t,aY,a?a.x:void 0,o?o.x:void 0),bD(e.y,t,oY,a?a.y:void 0,o?o.y:void 0)}function SD(e){return e.translate===0&&e.scale===1}function iU(e){return SD(e.x)&&SD(e.y)}function TD(e,t){return e.min===t.min&&e.max===t.max}function sY(e,t){return TD(e.x,t.x)&&TD(e.y,t.y)}function ED(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function aU(e,t){return ED(e.x,t.x)&&ED(e.y,t.y)}function AD(e){return Yl(e.x)/Yl(e.y)}function MD(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class lY{constructor(){this.members=[]}add(t){UC(this.members,t),t.scheduleRender()}remove(t){if(VC(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const a=this.members[this.members.length-1];a&&this.promote(a)}}relegate(t){const a=this.members.findIndex(c=>t===c);if(a===0)return!1;let o;for(let c=a;c>=0;c--){const b=this.members[c];if(b.isPresent!==!1){o=b;break}}return o?(this.promote(o),!0):!1}promote(t,a){const o=this.lead;if(t!==o&&(this.prevLead=o,this.lead=t,t.show(),o)){o.instance&&o.scheduleRender(),t.scheduleRender(),t.resumeFrom=o,a&&(t.resumeFrom.preserveOpacity=!0),o.snapshot&&(t.snapshot=o.snapshot,t.snapshot.latestValues=o.animationValues||o.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:c}=t.options;c===!1&&o.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:a,resumingFrom:o}=t;a.onExitComplete&&a.onExitComplete(),o&&o.options.onExitComplete&&o.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function uY(e,t,a){let o="";const c=e.x.translate/t.x,b=e.y.translate/t.y,S=(a==null?void 0:a.z)||0;if((c||b||S)&&(o=`translate3d(${c}px, ${b}px, ${S}px) `),(t.x!==1||t.y!==1)&&(o+=`scale(${1/t.x}, ${1/t.y}) `),a){const{transformPerspective:L,rotate:U,rotateX:V,rotateY:H,skewX:ee,skewY:ie}=a;L&&(o=`perspective(${L}px) ${o}`),U&&(o+=`rotate(${U}deg) `),V&&(o+=`rotateX(${V}deg) `),H&&(o+=`rotateY(${H}deg) `),ee&&(o+=`skewX(${ee}deg) `),ie&&(o+=`skewY(${ie}deg) `)}const i=e.x.scale*t.x,P=e.y.scale*t.y;return(i!==1||P!==1)&&(o+=`scale(${i}, ${P})`),o||"none"}const JS=["","X","Y","Z"],cY={visibility:"hidden"},OD=1e3;let hY=0;function QS(e,t,a,o){const{latestValues:c}=t;c[e]&&(a[e]=c[e],t.setStaticValue(e,0),o&&(o[e]=0))}function oU(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const a=d6(t);if(window.MotionHasOptimisedAnimation(a,"transform")){const{layout:c,layoutId:b}=e.options;window.MotionCancelOptimisedAnimation(a,"transform",Gi,!(c||b))}const{parent:o}=e;o&&!o.hasCheckedOptimisedAppear&&oU(o)}function sU({attachResizeListener:e,defaultParent:t,measureScroll:a,checkIsScrollRoot:o,resetTransform:c}){return class{constructor(S={},i=t==null?void 0:t()){this.id=hY++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(pY),this.nodes.forEach(vY),this.nodes.forEach(xY),this.nodes.forEach(mY)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=S,this.root=i?i.root||i:this,this.path=i?[...i.path,i]:[],this.parent=i,this.depth=i?i.depth+1:0;for(let P=0;P<this.path.length;P++)this.path[P].shouldResetTransform=!0;this.root===this&&(this.nodes=new JX)}addEventListener(S,i){return this.eventHandlers.has(S)||this.eventHandlers.set(S,new qC),this.eventHandlers.get(S).add(i)}notifyListeners(S,...i){const P=this.eventHandlers.get(S);P&&P.notify(...i)}hasListeners(S){return this.eventHandlers.has(S)}mount(S,i=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=WX(S),this.instance=S;const{layoutId:P,layout:L,visualElement:U}=this.options;if(U&&!U.current&&U.mount(S),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),i&&(L||P)&&(this.isLayoutDirty=!0),e){let V;const H=()=>this.root.updateBlockedByResize=!1;e(S,()=>{this.root.updateBlockedByResize=!0,V&&V(),V=QX(H,250),gb.hasAnimatedSinceResize&&(gb.hasAnimatedSinceResize=!1,this.nodes.forEach(CD))})}P&&this.root.registerSharedNode(P,this),this.options.animate!==!1&&U&&(P||L)&&this.addEventListener("didUpdate",({delta:V,hasLayoutChanged:H,hasRelativeLayoutChanged:ee,layout:ie})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const le=this.options.transition||U.getDefaultTransition()||EY,{onLayoutAnimationStart:ue,onLayoutAnimationComplete:ge}=U.getProps(),Se=!this.targetLayout||!aU(this.targetLayout,ie),ve=!H&&ee;if(this.options.layoutRoot||this.resumeFrom||ve||H&&(Se||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(V,ve);const Ee={...NC(le,"layout"),onPlay:ue,onComplete:ge};(U.shouldReduceMotion||this.options.layoutRoot)&&(Ee.delay=0,Ee.type=!1),this.startAnimation(Ee)}else H||CD(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=ie})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const S=this.getStack();S&&S.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,kh(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(bY),this.animationId++)}getTransformTemplate(){const{visualElement:S}=this.options;return S&&S.getProps().transformTemplate}willUpdate(S=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&oU(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let U=0;U<this.path.length;U++){const V=this.path[U];V.shouldResetTransform=!0,V.updateScroll("snapshot"),V.options.layoutRoot&&V.willUpdate(!1)}const{layoutId:i,layout:P}=this.options;if(i===void 0&&!P)return;const L=this.getTransformTemplate();this.prevTransformTemplateValue=L?L(this.latestValues,""):void 0,this.updateSnapshot(),S&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(ID);return}this.isUpdating||this.nodes.forEach(yY),this.isUpdating=!1,this.nodes.forEach(_Y),this.nodes.forEach(fY),this.nodes.forEach(dY),this.clearAllSnapshots();const i=Nf.now();Os.delta=jf(0,1e3/60,i-Os.timestamp),Os.timestamp=i,Os.isProcessing=!0,GS.update.process(Os),GS.preRender.process(Os),GS.render.process(Os),Os.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,AC.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(gY),this.sharedNodes.forEach(wY)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Gi.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Gi.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Yl(this.snapshot.measuredBox.x)&&!Yl(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let P=0;P<this.path.length;P++)this.path[P].updateScroll();const S=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Do(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:i}=this.options;i&&i.notify("LayoutMeasure",this.layout.layoutBox,S?S.layoutBox:void 0)}updateScroll(S="measure"){let i=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===S&&(i=!1),i){const P=o(this.instance);this.scroll={animationId:this.root.animationId,phase:S,isRoot:P,offset:a(this.instance),wasRoot:this.scroll?this.scroll.isRoot:P}}}resetTransform(){if(!c)return;const S=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,i=this.projectionDelta&&!iU(this.projectionDelta),P=this.getTransformTemplate(),L=P?P(this.latestValues,""):void 0,U=L!==this.prevTransformTemplateValue;S&&(i||sg(this.latestValues)||U)&&(c(this.instance,L),this.shouldResetTransform=!1,this.scheduleRender())}measure(S=!0){const i=this.measurePageBox();let P=this.removeElementScroll(i);return S&&(P=this.removeTransform(P)),AY(P),{animationId:this.root.animationId,measuredBox:i,layoutBox:P,latestValues:{},source:this.id}}measurePageBox(){var S;const{visualElement:i}=this.options;if(!i)return Do();const P=i.measureViewportBox();if(!(((S=this.scroll)===null||S===void 0?void 0:S.wasRoot)||this.path.some(MY))){const{scroll:U}=this.root;U&&(Vy(P.x,U.offset.x),Vy(P.y,U.offset.y))}return P}removeElementScroll(S){var i;const P=Do();if(Bc(P,S),!((i=this.scroll)===null||i===void 0)&&i.wasRoot)return P;for(let L=0;L<this.path.length;L++){const U=this.path[L],{scroll:V,options:H}=U;U!==this.root&&V&&H.layoutScroll&&(V.wasRoot&&Bc(P,S),Vy(P.x,V.offset.x),Vy(P.y,V.offset.y))}return P}applyTransform(S,i=!1){const P=Do();Bc(P,S);for(let L=0;L<this.path.length;L++){const U=this.path[L];!i&&U.options.layoutScroll&&U.scroll&&U!==U.root&&qy(P,{x:-U.scroll.offset.x,y:-U.scroll.offset.y}),sg(U.latestValues)&&qy(P,U.latestValues)}return sg(this.latestValues)&&qy(P,this.latestValues),P}removeTransform(S){const i=Do();Bc(i,S);for(let P=0;P<this.path.length;P++){const L=this.path[P];if(!L.instance||!sg(L.latestValues))continue;SO(L.latestValues)&&L.updateSnapshot();const U=Do(),V=L.measurePageBox();Bc(U,V),wD(i,L.latestValues,L.snapshot?L.snapshot.layoutBox:void 0,U)}return sg(this.latestValues)&&wD(i,this.latestValues),i}setTargetDelta(S){this.targetDelta=S,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(S){this.options={...this.options,...S,crossfade:S.crossfade!==void 0?S.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Os.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(S=!1){var i;const P=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=P.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=P.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=P.isSharedProjectionDirty);const L=!!this.resumingFrom||this!==P;if(!(S||L&&this.isSharedProjectionDirty||this.isProjectionDirty||!((i=this.parent)===null||i===void 0)&&i.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:V,layoutId:H}=this.options;if(!(!this.layout||!(V||H))){if(this.resolvedRelativeTargetAt=Os.timestamp,!this.targetDelta&&!this.relativeTarget){const ee=this.getClosestProjectingParent();ee&&ee.layout&&this.animationProgress!==1?(this.relativeParent=ee,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Do(),this.relativeTargetOrigin=Do(),p0(this.relativeTargetOrigin,this.layout.layoutBox,ee.layout.layoutBox),Bc(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Do(),this.targetWithTransforms=Do()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),IX(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Bc(this.target,this.layout.layoutBox),K6(this.target,this.targetDelta)):Bc(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const ee=this.getClosestProjectingParent();ee&&!!ee.resumingFrom==!!this.resumingFrom&&!ee.options.layoutScroll&&ee.target&&this.animationProgress!==1?(this.relativeParent=ee,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Do(),this.relativeTargetOrigin=Do(),p0(this.relativeTargetOrigin,this.target,ee.target),Bc(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||SO(this.parent.latestValues)||W6(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var S;const i=this.getLead(),P=!!this.resumingFrom||this!==i;let L=!0;if((this.isProjectionDirty||!((S=this.parent)===null||S===void 0)&&S.isProjectionDirty)&&(L=!1),P&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(L=!1),this.resolvedRelativeTargetAt===Os.timestamp&&(L=!1),L)return;const{layout:U,layoutId:V}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(U||V))return;Bc(this.layoutCorrected,this.layout.layoutBox);const H=this.treeScale.x,ee=this.treeScale.y;CX(this.layoutCorrected,this.treeScale,this.path,P),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=Do());const{target:ie}=i;if(!ie){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(vD(this.prevProjectionDelta.x,this.projectionDelta.x),vD(this.prevProjectionDelta.y,this.projectionDelta.y)),d0(this.projectionDelta,this.layoutCorrected,ie,this.latestValues),(this.treeScale.x!==H||this.treeScale.y!==ee||!MD(this.projectionDelta.x,this.prevProjectionDelta.x)||!MD(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",ie))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(S=!0){var i;if((i=this.options.visualElement)===null||i===void 0||i.scheduleRender(),S){const P=this.getStack();P&&P.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Uy(),this.projectionDelta=Uy(),this.projectionDeltaWithTransform=Uy()}setAnimationOrigin(S,i=!1){const P=this.snapshot,L=P?P.latestValues:{},U={...this.latestValues},V=Uy();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!i;const H=Do(),ee=P?P.source:void 0,ie=this.layout?this.layout.source:void 0,le=ee!==ie,ue=this.getStack(),ge=!ue||ue.members.length<=1,Se=!!(le&&!ge&&this.options.crossfade===!0&&!this.path.some(TY));this.animationProgress=0;let ve;this.mixTargetDelta=Ee=>{const me=Ee/1e3;PD(V.x,S.x,me),PD(V.y,S.y,me),this.setTargetDelta(V),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(p0(H,this.layout.layoutBox,this.relativeParent.layout.layoutBox),SY(this.relativeTarget,this.relativeTargetOrigin,H,me),ve&&sY(this.relativeTarget,ve)&&(this.isProjectionDirty=!1),ve||(ve=Do()),Bc(ve,this.relativeTarget)),le&&(this.animationValues=U,tY(U,L,this.latestValues,me,Se,ge)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=me},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(S){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(kh(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Gi.update(()=>{gb.hasAnimatedSinceResize=!0,this.currentAnimation=ZX(0,OD,{...S,onUpdate:i=>{this.mixTargetDelta(i),S.onUpdate&&S.onUpdate(i)},onStop:()=>{},onComplete:()=>{S.onComplete&&S.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const S=this.getStack();S&&S.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(OD),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const S=this.getLead();let{targetWithTransforms:i,target:P,layout:L,latestValues:U}=S;if(!(!i||!P||!L)){if(this!==S&&this.layout&&L&&lU(this.options.animationType,this.layout.layoutBox,L.layoutBox)){P=this.target||Do();const V=Yl(this.layout.layoutBox.x);P.x.min=S.target.x.min,P.x.max=P.x.min+V;const H=Yl(this.layout.layoutBox.y);P.y.min=S.target.y.min,P.y.max=P.y.min+H}Bc(i,P),qy(i,U),d0(this.projectionDeltaWithTransform,this.layoutCorrected,i,U)}}registerSharedNode(S,i){this.sharedNodes.has(S)||this.sharedNodes.set(S,new lY),this.sharedNodes.get(S).add(i);const L=i.options.initialPromotionConfig;i.promote({transition:L?L.transition:void 0,preserveFollowOpacity:L&&L.shouldPreserveFollowOpacity?L.shouldPreserveFollowOpacity(i):void 0})}isLead(){const S=this.getStack();return S?S.lead===this:!0}getLead(){var S;const{layoutId:i}=this.options;return i?((S=this.getStack())===null||S===void 0?void 0:S.lead)||this:this}getPrevLead(){var S;const{layoutId:i}=this.options;return i?(S=this.getStack())===null||S===void 0?void 0:S.prevLead:void 0}getStack(){const{layoutId:S}=this.options;if(S)return this.root.sharedNodes.get(S)}promote({needsReset:S,transition:i,preserveFollowOpacity:P}={}){const L=this.getStack();L&&L.promote(this,P),S&&(this.projectionDelta=void 0,this.needsReset=!0),i&&this.setOptions({transition:i})}relegate(){const S=this.getStack();return S?S.relegate(this):!1}resetSkewAndRotation(){const{visualElement:S}=this.options;if(!S)return;let i=!1;const{latestValues:P}=S;if((P.z||P.rotate||P.rotateX||P.rotateY||P.rotateZ||P.skewX||P.skewY)&&(i=!0),!i)return;const L={};P.z&&QS("z",S,L,this.animationValues);for(let U=0;U<JS.length;U++)QS(`rotate${JS[U]}`,S,L,this.animationValues),QS(`skew${JS[U]}`,S,L,this.animationValues);S.render();for(const U in L)S.setStaticValue(U,L[U]),this.animationValues&&(this.animationValues[U]=L[U]);S.scheduleRender()}getProjectionStyles(S){var i,P;if(!this.instance||this.isSVG)return;if(!this.isVisible)return cY;const L={visibility:""},U=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,L.opacity="",L.pointerEvents=pb(S==null?void 0:S.pointerEvents)||"",L.transform=U?U(this.latestValues,""):"none",L;const V=this.getLead();if(!this.projectionDelta||!this.layout||!V.target){const le={};return this.options.layoutId&&(le.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,le.pointerEvents=pb(S==null?void 0:S.pointerEvents)||""),this.hasProjected&&!sg(this.latestValues)&&(le.transform=U?U({},""):"none",this.hasProjected=!1),le}const H=V.animationValues||V.latestValues;this.applyTransformsToTarget(),L.transform=uY(this.projectionDeltaWithTransform,this.treeScale,H),U&&(L.transform=U(H,L.transform));const{x:ee,y:ie}=this.projectionDelta;L.transformOrigin=`${ee.origin*100}% ${ie.origin*100}% 0`,V.animationValues?L.opacity=V===this?(P=(i=H.opacity)!==null&&i!==void 0?i:this.latestValues.opacity)!==null&&P!==void 0?P:1:this.preserveOpacity?this.latestValues.opacity:H.opacityExit:L.opacity=V===this?H.opacity!==void 0?H.opacity:"":H.opacityExit!==void 0?H.opacityExit:0;for(const le in A0){if(H[le]===void 0)continue;const{correct:ue,applyTo:ge,isCSSVariable:Se}=A0[le],ve=L.transform==="none"?H[le]:ue(H[le],V);if(ge){const Ee=ge.length;for(let me=0;me<Ee;me++)L[ge[me]]=ve}else Se?this.options.visualElement.renderState.vars[le]=ve:L[le]=ve}return this.options.layoutId&&(L.pointerEvents=V===this?pb(S==null?void 0:S.pointerEvents)||"":"none"),L}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(S=>{var i;return(i=S.currentAnimation)===null||i===void 0?void 0:i.stop()}),this.root.nodes.forEach(ID),this.root.sharedNodes.clear()}}}function fY(e){e.updateLayout()}function dY(e){var t;const a=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&a&&e.hasListeners("didUpdate")){const{layoutBox:o,measuredBox:c}=e.layout,{animationType:b}=e.options,S=a.source!==e.layout.source;b==="size"?Uc(V=>{const H=S?a.measuredBox[V]:a.layoutBox[V],ee=Yl(H);H.min=o[V].min,H.max=H.min+ee}):lU(b,a.layoutBox,o)&&Uc(V=>{const H=S?a.measuredBox[V]:a.layoutBox[V],ee=Yl(o[V]);H.max=H.min+ee,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[V].max=e.relativeTarget[V].min+ee)});const i=Uy();d0(i,o,a.layoutBox);const P=Uy();S?d0(P,e.applyTransform(c,!0),a.measuredBox):d0(P,o,a.layoutBox);const L=!iU(i);let U=!1;if(!e.resumeFrom){const V=e.getClosestProjectingParent();if(V&&!V.resumeFrom){const{snapshot:H,layout:ee}=V;if(H&&ee){const ie=Do();p0(ie,a.layoutBox,H.layoutBox);const le=Do();p0(le,o,ee.layoutBox),aU(ie,le)||(U=!0),V.options.layoutRoot&&(e.relativeTarget=le,e.relativeTargetOrigin=ie,e.relativeParent=V)}}}e.notifyListeners("didUpdate",{layout:o,snapshot:a,delta:P,layoutDelta:i,hasLayoutChanged:L,hasRelativeLayoutChanged:U})}else if(e.isLead()){const{onExitComplete:o}=e.options;o&&o()}e.options.transition=void 0}function pY(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function mY(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function gY(e){e.clearSnapshot()}function ID(e){e.clearMeasurements()}function yY(e){e.isLayoutDirty=!1}function _Y(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function CD(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function vY(e){e.resolveTargetDelta()}function xY(e){e.calcProjection()}function bY(e){e.resetSkewAndRotation()}function wY(e){e.removeLeadSnapshot()}function PD(e,t,a){e.translate=po(t.translate,0,a),e.scale=po(t.scale,1,a),e.origin=t.origin,e.originPoint=t.originPoint}function RD(e,t,a,o){e.min=po(t.min,a.min,o),e.max=po(t.max,a.max,o)}function SY(e,t,a,o){RD(e.x,t.x,a.x,o),RD(e.y,t.y,a.y,o)}function TY(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const EY={duration:.45,ease:[.4,0,.1,1]},kD=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),DD=kD("applewebkit/")&&!kD("chrome/")?Math.round:Tl;function LD(e){e.min=DD(e.min),e.max=DD(e.max)}function AY(e){LD(e.x),LD(e.y)}function lU(e,t,a){return e==="position"||e==="preserve-aspect"&&!OX(AD(t),AD(a),.2)}function MY(e){var t;return e!==e.root&&((t=e.scroll)===null||t===void 0?void 0:t.wasRoot)}const OY=sU({attachResizeListener:(e,t)=>C0(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),eT={current:void 0},uU=sU({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!eT.current){const e=new OY({});e.mount(window),e.setOptions({layoutScroll:!0}),eT.current=e}return eT.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),IY={pan:{Feature:$X},drag:{Feature:GX,ProjectionNode:uU,MeasureLayout:tU}};function zD(e,t,a){const{props:o}=e;e.animationState&&o.whileHover&&e.animationState.setActive("whileHover",a==="Start");const c="onHover"+a,b=o[c];b&&Gi.postRender(()=>b(t,xx(t)))}class CY extends um{mount(){const{current:t}=this.node;t&&(this.unmount=I$(t,(a,o)=>(zD(this.node,o,"Start"),c=>zD(this.node,c,"End"))))}unmount(){}}class PY extends um{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=vx(C0(this.node.current,"focus",()=>this.onFocus()),C0(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function ND(e,t,a){const{props:o}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&o.whileTap&&e.animationState.setActive("whileTap",a==="Start");const c="onTap"+(a==="End"?"":a),b=o[c];b&&Gi.postRender(()=>b(t,xx(t)))}class RY extends um{mount(){const{current:t}=this.node;t&&(this.unmount=k$(t,(a,o)=>(ND(this.node,o,"Start"),(c,{success:b})=>ND(this.node,c,b?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const AO=new WeakMap,tT=new WeakMap,kY=e=>{const t=AO.get(e.target);t&&t(e)},DY=e=>{e.forEach(kY)};function LY({root:e,...t}){const a=e||document;tT.has(a)||tT.set(a,{});const o=tT.get(a),c=JSON.stringify(t);return o[c]||(o[c]=new IntersectionObserver(DY,{root:e,...t})),o[c]}function zY(e,t,a){const o=LY(t);return AO.set(e,a),o.observe(e),()=>{AO.delete(e),o.unobserve(e)}}const NY={some:0,all:1};class BY extends um{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:a,margin:o,amount:c="some",once:b}=t,S={root:a?a.current:void 0,rootMargin:o,threshold:typeof c=="number"?c:NY[c]},i=P=>{const{isIntersecting:L}=P;if(this.isInView===L||(this.isInView=L,b&&!L&&this.hasEnteredView))return;L&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",L);const{onViewportEnter:U,onViewportLeave:V}=this.node.getProps(),H=L?U:V;H&&H(P)};return zY(this.node.current,S,i)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:a}=this.node;["amount","margin","root"].some(FY(t,a))&&this.startObserver()}unmount(){}}function FY({viewport:e={}},{viewport:t={}}={}){return a=>e[a]!==t[a]}const jY={inView:{Feature:BY},tap:{Feature:RY},focus:{Feature:PY},hover:{Feature:CY}},UY={layout:{ProjectionNode:uU,MeasureLayout:tU}},MO={current:null},cU={current:!1};function VY(){if(cU.current=!0,!!bC)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>MO.current=e.matches;e.addListener(t),t()}else MO.current=!1}const qY=[...D6,xl,im],GY=e=>qY.find(k6(e)),$Y=new WeakMap;function HY(e,t,a){for(const o in t){const c=t[o],b=a[o];if(Cs(c))e.addValue(o,c);else if(Cs(b))e.addValue(o,Pf(c,{owner:e}));else if(b!==c)if(e.hasValue(o)){const S=e.getValue(o);S.liveStyle===!0?S.jump(c):S.hasAnimated||S.set(c)}else{const S=e.getStaticValue(o);e.addValue(o,Pf(S!==void 0?S:c,{owner:e}))}}for(const o in a)t[o]===void 0&&e.removeValue(o);return t}const BD=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class XY{scrapeMotionValuesFromProps(t,a,o){return{}}constructor({parent:t,props:a,presenceContext:o,reducedMotionConfig:c,blockInitialAnimation:b,visualState:S},i={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=WC,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const ee=Nf.now();this.renderScheduledAt<ee&&(this.renderScheduledAt=ee,Gi.render(this.render,!1,!0))};const{latestValues:P,renderState:L,onUpdate:U}=S;this.onUpdate=U,this.latestValues=P,this.baseTarget={...P},this.initialValues=a.initial?{...P}:{},this.renderState=L,this.parent=t,this.props=a,this.presenceContext=o,this.depth=t?t.depth+1:0,this.reducedMotionConfig=c,this.options=i,this.blockInitialAnimation=!!b,this.isControllingVariants=Uw(a),this.isVariantNode=Vj(a),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:V,...H}=this.scrapeMotionValuesFromProps(a,{},this);for(const ee in H){const ie=H[ee];P[ee]!==void 0&&Cs(ie)&&ie.set(P[ee],!1)}}mount(t){this.current=t,$Y.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,o)=>this.bindToMotionValue(o,a)),cU.current||VY(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:MO.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),kh(this.notifyUpdate),kh(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const a=this.features[t];a&&(a.unmount(),a.isMounted=!1)}this.current=null}bindToMotionValue(t,a){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const o=Og.has(t);o&&this.onBindTransform&&this.onBindTransform();const c=a.on("change",i=>{this.latestValues[t]=i,this.props.onUpdate&&Gi.preRender(this.notifyUpdate),o&&this.projection&&(this.projection.isTransformDirty=!0)}),b=a.on("renderRequest",this.scheduleRender);let S;window.MotionCheckAppearSync&&(S=window.MotionCheckAppearSync(this,t,a)),this.valueSubscriptions.set(t,()=>{c(),b(),S&&S(),a.owner&&a.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in n_){const a=n_[t];if(!a)continue;const{isEnabled:o,Feature:c}=a;if(!this.features[t]&&c&&o(this.props)&&(this.features[t]=new c(this)),this.features[t]){const b=this.features[t];b.isMounted?b.update():(b.mount(),b.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Do()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,a){this.latestValues[t]=a}update(t,a){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=a;for(let o=0;o<BD.length;o++){const c=BD[o];this.propEventSubscriptions[c]&&(this.propEventSubscriptions[c](),delete this.propEventSubscriptions[c]);const b="on"+c,S=t[b];S&&(this.propEventSubscriptions[c]=this.on(c,S))}this.prevMotionValues=HY(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const a=this.getClosestVariantNode();if(a)return a.variantChildren&&a.variantChildren.add(t),()=>a.variantChildren.delete(t)}addValue(t,a){const o=this.values.get(t);a!==o&&(o&&this.removeValue(t),this.bindToMotionValue(t,a),this.values.set(t,a),this.latestValues[t]=a.get())}removeValue(t){this.values.delete(t);const a=this.valueSubscriptions.get(t);a&&(a(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,a){if(this.props.values&&this.props.values[t])return this.props.values[t];let o=this.values.get(t);return o===void 0&&a!==void 0&&(o=Pf(a===null?void 0:a,{owner:this}),this.addValue(t,o)),o}readValue(t,a){var o;let c=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(o=this.getBaseTargetFromProps(this.props,t))!==null&&o!==void 0?o:this.readValueFromInstance(this.current,t,this.options);return c!=null&&(typeof c=="string"&&(P6(c)||w6(c))?c=parseFloat(c):!GY(c)&&im.test(a)&&(c=O6(t,a)),this.setBaseTarget(t,Cs(c)?c.get():c)),Cs(c)?c.get():c}setBaseTarget(t,a){this.baseTarget[t]=a}getBaseTarget(t){var a;const{initial:o}=this.props;let c;if(typeof o=="string"||typeof o=="object"){const S=LC(this.props,o,(a=this.presenceContext)===null||a===void 0?void 0:a.custom);S&&(c=S[t])}if(o&&c!==void 0)return c;const b=this.getBaseTargetFromProps(this.props,t);return b!==void 0&&!Cs(b)?b:this.initialValues[t]!==void 0&&c===void 0?void 0:this.baseTarget[t]}on(t,a){return this.events[t]||(this.events[t]=new qC),this.events[t].add(a)}notify(t,...a){this.events[t]&&this.events[t].notify(...a)}}class hU extends XY{constructor(){super(...arguments),this.KeyframeResolver=L6}sortInstanceNodePosition(t,a){return t.compareDocumentPosition(a)&2?1:-1}getBaseTargetFromProps(t,a){return t.style?t.style[a]:void 0}removeValueFromRenderState(t,{vars:a,style:o}){delete a[t],delete o[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Cs(t)&&(this.childSubscription=t.on("change",a=>{this.current&&(this.current.textContent=`${a}`)}))}}function YY(e){return window.getComputedStyle(e)}class ZY extends hU{constructor(){super(...arguments),this.type="html",this.renderInstance=Qj}readValueFromInstance(t,a){if(Og.has(a)){const o=ZC(a);return o&&o.default||0}else{const o=YY(t),c=(MC(a)?o.getPropertyValue(a):o[a])||0;return typeof c=="string"?c.trim():c}}measureInstanceViewportBox(t,{transformPagePoint:a}){return J6(t,a)}build(t,a,o){CC(t,a,o.transformTemplate)}scrapeMotionValuesFromProps(t,a,o){return zC(t,a,o)}}class WY extends hU{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Do,this.updateDimensions=()=>{this.current&&!this.renderState.dimensions&&Jj(this.current,this.renderState)}}getBaseTargetFromProps(t,a){return t[a]}readValueFromInstance(t,a){if(Og.has(a)){const o=ZC(a);return o&&o.default||0}return a=e6.has(a)?a:EC(a),t.getAttribute(a)}scrapeMotionValuesFromProps(t,a,o){return n6(t,a,o)}onBindTransform(){this.current&&!this.renderState.dimensions&&Gi.postRender(this.updateDimensions)}build(t,a,o){kC(t,a,this.isSVGTag,o.transformTemplate)}renderInstance(t,a,o,c){t6(t,a,o,c)}mount(t){this.isSVGTag=DC(t.tagName),super.mount(t)}}const KY=(e,t)=>RC(e)?new WY(t):new ZY(t,{allowProjection:e!==Jt.Fragment}),JY=T$({...xX,...jY,...IY,...UY},KY),Cr=jG(JY);function fU(e,t){let a;const o=()=>{const{currentTime:c}=t,S=(c===null?0:c.value)/100;a!==S&&e(S),a=S};return Gi.update(o,!0),()=>kh(o)}const yb=new WeakMap;let Kp;function QY(e,t){if(t){const{inlineSize:a,blockSize:o}=t[0];return{width:a,height:o}}else return e instanceof SVGElement&&"getBBox"in e?e.getBBox():{width:e.offsetWidth,height:e.offsetHeight}}function eZ({target:e,contentRect:t,borderBoxSize:a}){var o;(o=yb.get(e))===null||o===void 0||o.forEach(c=>{c({target:e,contentSize:t,get size(){return QY(e,a)}})})}function tZ(e){e.forEach(eZ)}function nZ(){typeof ResizeObserver>"u"||(Kp=new ResizeObserver(tZ))}function rZ(e,t){Kp||nZ();const a=u6(e);return a.forEach(o=>{let c=yb.get(o);c||(c=new Set,yb.set(o,c)),c.add(t),Kp==null||Kp.observe(o)}),()=>{a.forEach(o=>{const c=yb.get(o);c==null||c.delete(t),c!=null&&c.size||Kp==null||Kp.unobserve(o)})}}const _b=new Set;let m0;function iZ(){m0=()=>{const e={width:window.innerWidth,height:window.innerHeight},t={target:window,size:e,contentSize:e};_b.forEach(a=>a(t))},window.addEventListener("resize",m0)}function aZ(e){return _b.add(e),m0||iZ(),()=>{_b.delete(e),!_b.size&&m0&&(m0=void 0)}}function oZ(e,t){return typeof e=="function"?aZ(e):rZ(e,t)}const sZ=50,FD=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),lZ=()=>({time:0,x:FD(),y:FD()}),uZ={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function jD(e,t,a,o){const c=a[t],{length:b,position:S}=uZ[t],i=c.current,P=a.time;c.current=e[`scroll${S}`],c.scrollLength=e[`scroll${b}`]-e[`client${b}`],c.offset.length=0,c.offset[0]=0,c.offset[1]=c.scrollLength,c.progress=xg(0,c.scrollLength,c.current);const L=o-P;c.velocity=L>sZ?0:GC(c.current-i,L)}function cZ(e,t,a){jD(e,"x",t,a),jD(e,"y",t,a),t.time=a}function hZ(e,t){const a={x:0,y:0};let o=e;for(;o&&o!==t;)if(o instanceof HTMLElement)a.x+=o.offsetLeft,a.y+=o.offsetTop,o=o.offsetParent;else if(o.tagName==="svg"){const c=o.getBoundingClientRect();o=o.parentElement;const b=o.getBoundingClientRect();a.x+=c.left-b.left,a.y+=c.top-b.top}else if(o instanceof SVGGraphicsElement){const{x:c,y:b}=o.getBBox();a.x+=c,a.y+=b;let S=null,i=o.parentNode;for(;!S;)i.tagName==="svg"&&(S=i),i=o.parentNode;o=S}else break;return a}const OO={start:0,center:.5,end:1};function UD(e,t,a=0){let o=0;if(e in OO&&(e=OO[e]),typeof e=="string"){const c=parseFloat(e);e.endsWith("px")?o=c:e.endsWith("%")?e=c/100:e.endsWith("vw")?o=c/100*document.documentElement.clientWidth:e.endsWith("vh")?o=c/100*document.documentElement.clientHeight:e=c}return typeof e=="number"&&(o=t*e),a+o}const fZ=[0,0];function dZ(e,t,a,o){let c=Array.isArray(e)?e:fZ,b=0,S=0;return typeof e=="number"?c=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?c=e.split(" "):c=[e,OO[e]?e:"0"]),b=UD(c[0],a,o),S=UD(c[1],t),b-S}const pZ={All:[[0,0],[1,1]]},mZ={x:0,y:0};function gZ(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function yZ(e,t,a){const{offset:o=pZ.All}=a,{target:c=e,axis:b="y"}=a,S=b==="y"?"height":"width",i=c!==e?hZ(c,e):mZ,P=c===e?{width:e.scrollWidth,height:e.scrollHeight}:gZ(c),L={width:e.clientWidth,height:e.clientHeight};t[b].offset.length=0;let U=!t[b].interpolate;const V=o.length;for(let H=0;H<V;H++){const ee=dZ(o[H],L[S],P[S],i[b]);!U&&ee!==t[b].interpolatorOffsets[H]&&(U=!0),t[b].offset[H]=ee}U&&(t[b].interpolate=JC(t[b].offset,V6(o),{clamp:!1}),t[b].interpolatorOffsets=[...t[b].offset]),t[b].progress=jf(0,1,t[b].interpolate(t[b].current))}function _Z(e,t=e,a){if(a.x.targetOffset=0,a.y.targetOffset=0,t!==e){let o=t;for(;o&&o!==e;)a.x.targetOffset+=o.offsetLeft,a.y.targetOffset+=o.offsetTop,o=o.offsetParent}a.x.targetLength=t===e?t.scrollWidth:t.clientWidth,a.y.targetLength=t===e?t.scrollHeight:t.clientHeight,a.x.containerLength=e.clientWidth,a.y.containerLength=e.clientHeight}function vZ(e,t,a,o={}){return{measure:()=>_Z(e,o.target,a),update:c=>{cZ(e,a,c),(o.offset||o.target)&&yZ(e,a,o)},notify:()=>t(a)}}const Yv=new WeakMap,VD=new WeakMap,nT=new WeakMap,qD=e=>e===document.documentElement?window:e;function eP(e,{container:t=document.documentElement,...a}={}){let o=nT.get(t);o||(o=new Set,nT.set(t,o));const c=lZ(),b=vZ(t,e,c,a);if(o.add(b),!Yv.has(t)){const i=()=>{for(const H of o)H.measure()},P=()=>{for(const H of o)H.update(Os.timestamp)},L=()=>{for(const H of o)H.notify()},U=()=>{Gi.read(i,!1,!0),Gi.read(P,!1,!0),Gi.update(L,!1,!0)};Yv.set(t,U);const V=qD(t);window.addEventListener("resize",U,{passive:!0}),t!==document.documentElement&&VD.set(t,oZ(t,U)),V.addEventListener("scroll",U,{passive:!0})}const S=Yv.get(t);return Gi.read(S,!1,!0),()=>{var i;kh(S);const P=nT.get(t);if(!P||(P.delete(b),P.size))return;const L=Yv.get(t);Yv.delete(t),L&&(qD(t).removeEventListener("scroll",L),(i=VD.get(t))===null||i===void 0||i(),window.removeEventListener("resize",L))}}function xZ({source:e,container:t,axis:a="y"}){e&&(t=e);const o={value:0},c=eP(b=>{o.value=b[a].progress*100},{container:t,axis:a});return{currentTime:o,cancel:c}}const rT=new Map;function dU({source:e,container:t=document.documentElement,axis:a="y"}={}){e&&(t=e),rT.has(t)||rT.set(t,{});const o=rT.get(t);return o[a]||(o[a]=r6()?new ScrollTimeline({source:t,axis:a}):xZ({source:t,axis:a})),o[a]}function bZ(e){return e.length===2}function pU(e){return e&&(e.target||e.offset)}function wZ(e,t){return bZ(e)||pU(t)?eP(a=>{e(a[t.axis].progress,a)},t):fU(e,dU(t))}function SZ(e,t){if(e.flatten(),pU(t))return e.pause(),eP(a=>{e.time=e.duration*a[t.axis].progress},t);{const a=dU(t);return e.attachTimeline?e.attachTimeline(a,o=>(o.pause(),fU(c=>{o.time=o.duration*c},a))):Tl}}function TZ(e,{axis:t="y",...a}={}){const o={axis:t,...a};return typeof e=="function"?wZ(e,o):SZ(e,o)}function GD(e,t){RG(!!(!t||t.current))}const EZ=()=>({scrollX:Pf(0),scrollY:Pf(0),scrollXProgress:Pf(0),scrollYProgress:Pf(0)});function mU({container:e,target:t,layoutEffect:a=!0,...o}={}){const c=t_(EZ);return(a?Bw:Jt.useEffect)(()=>(GD("target",t),GD("container",e),TZ((S,{x:i,y:P})=>{c.scrollX.set(i.current),c.scrollXProgress.set(i.progress),c.scrollY.set(P.current),c.scrollYProgress.set(P.progress)},{...o,container:(e==null?void 0:e.current)||void 0,target:(t==null?void 0:t.current)||void 0})),[e,t,JSON.stringify(o.offset)]),c}function gU(e){const t=t_(()=>Pf(e)),{isStatic:a}=Jt.useContext(Nw);if(a){const[,o]=Jt.useState(e);Jt.useEffect(()=>t.on("change",o),[])}return t}function yU(e,t){const a=gU(t()),o=()=>a.set(t());return o(),Bw(()=>{const c=()=>Gi.preRender(o,!1,!0),b=e.map(S=>S.on("change",c));return()=>{b.forEach(S=>S()),kh(o)}}),a}function AZ(e,t={}){const{isStatic:a}=Jt.useContext(Nw),o=Jt.useRef(null),c=t_(()=>Cs(e)?e.get():e),b=t_(()=>typeof c=="string"?c.replace(/[\d.-]/g,""):void 0),S=gU(c),i=Jt.useRef(c),P=Jt.useRef(Tl),L=()=>{U(),o.current=XH({keyframes:[HD(S.get()),HD(i.current)],velocity:S.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...t,onUpdate:P.current})},U=()=>{o.current&&o.current.stop()};return Jt.useInsertionEffect(()=>S.attach((V,H)=>a?H(V):(i.current=V,P.current=ee=>H($D(ee,b)),Gi.postRender(L),S.get()),U),[JSON.stringify(t)]),Bw(()=>{if(Cs(e))return e.on("change",V=>S.set($D(V,b)))},[S,b]),S}function $D(e,t){return t?e+t:e}function HD(e){return typeof e=="number"?e:parseFloat(e)}const MZ=e=>e&&typeof e=="object"&&e.mix,OZ=e=>MZ(e)?e.mix:void 0;function IZ(...e){const t=!Array.isArray(e[0]),a=t?0:-1,o=e[0+a],c=e[1+a],b=e[2+a],S=e[3+a],i=JC(c,b,{mixer:OZ(b[0]),...S});return t?i(o):i}function CZ(e){h0.current=[],e();const t=yU(h0.current,e);return h0.current=void 0,t}function PZ(e,t,a,o){if(typeof e=="function")return CZ(e);const c=typeof t=="function"?t:IZ(t,a,o);return Array.isArray(e)?XD(e,c):XD([e],([b])=>c(b))}function XD(e,t){const a=t_(()=>[]);return yU(e,()=>{a.length=0;const o=e.length;for(let c=0;c<o;c++)a[c]=e[c].get();return t(a)})}function YD(){const e="Andi Surya Alam".split(" "),t={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.2}}},a={hidden:{opacity:0,y:50},visible:{opacity:1,y:0,transition:{type:"spring",stiffness:100,damping:20}}},o=["GIS","Geospatial Analysis","Spatial Data Processing","Web Mapping","PostGIS","QGIS","TailWind","Go-lang","Laravel","Web Development","JavaScript","JavaScript DOM Manipulation","React","Inertia.js","React Native (Expo, EAS)"],c={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},b={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{type:"spring",stiffness:100,damping:20}}};return nn.jsxs(Cr.div,{className:"w-full h-full flex flex-col bg-gradient-to-b from-white via-gray-300 to-white text-black text-lg shadow-2xl rounded-lg overflow-hidden",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:100,damping:10},children:[nn.jsxs(Cr.div,{className:"w-full flex flex-col items-center justify-center p-8 border-b border-gray-600",initial:{opacity:0,y:-50},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:100,damping:10},children:[nn.jsx(Cr.div,{className:"w-32 h-32 rounded-full overflow-hidden border-4 border-blue-600 mb-4",initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},transition:{type:"spring",stiffness:120,damping:10},children:nn.jsx("img",{src:"/path-to-your-avatar.jpg",alt:"Your Avatar",className:"w-full h-full object-cover"})}),nn.jsx(Cr.div,{variants:t,initial:"hidden",animate:"visible",className:"flex flex-wrap justify-center",children:e.map((S,i)=>nn.jsx(Cr.span,{variants:a,className:"text-2xl font-semibold tracking-wide inline-block mr-2",children:S},i))}),nn.jsx(Cr.div,{className:"mt-6 text-lg text-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:120,damping:12},children:nn.jsx("h2",{className:"font-semibold text-blue-600",children:"WebGIS Developer"})})]}),nn.jsxs(Cr.div,{className:"w-full flex flex-col items-center justify-center p-8",initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:100,damping:10},children:[nn.jsxs(Cr.div,{className:"text-lg text-center mb-8",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:120,damping:12},children:[nn.jsx("h2",{className:"font-semibold text-blue-600",children:"ABOUT ME"}),nn.jsx("p",{className:"mt-2 text-black-300",children:" GIS & Web Developer specializing in spatial data processing, web mapping, and geospatial analysis. Skilled in PostGIS and Turf.js for efficient web-based spatial data processing. I build dynamic applications using Laravel, Inertia.js, React, and JavaScript, while leveraging React Native (Expo, EAS) for mobile development. Experienced in Leaflet.js, Mapbox and Context API to create highly interactive maps. On the backend, I work with PHP and Go to develop secure, high-performance APIs. Passionate about transforming complex geospatial data into actionable insights! "})]}),nn.jsxs(Cr.div,{className:"w-full text-center",initial:"hidden",animate:"visible",variants:c,children:[nn.jsx("h2",{className:"font-semibold text-blue-600 mb-4",children:"SKILLS SET"}),nn.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:o.map((S,i)=>nn.jsx(Cr.div,{className:"px-4 py-2 bg-white rounded-full text-sm font-medium",variants:b,whileHover:{scale:1.1,backgroundColor:"#00BFFF"},transition:{type:"spring",stiffness:300},children:S},i))})]})]})]})}/*!
 * Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */function RZ(e,t,a){return(t=DZ(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ZD(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function jn(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?ZD(Object(a),!0).forEach(function(o){RZ(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ZD(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function kZ(e,t){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DZ(e){var t=kZ(e,"string");return typeof t=="symbol"?t:t+""}const WD=()=>{};let tP={},_U={},vU=null,xU={mark:WD,measure:WD};try{typeof window<"u"&&(tP=window),typeof document<"u"&&(_U=document),typeof MutationObserver<"u"&&(vU=MutationObserver),typeof performance<"u"&&(xU=performance)}catch{}const{userAgent:KD=""}=tP.navigator||{},am=tP,Ga=_U,JD=vU,G1=xU;am.document;const Jd=!!Ga.documentElement&&!!Ga.head&&typeof Ga.addEventListener=="function"&&typeof Ga.createElement=="function",bU=~KD.indexOf("MSIE")||~KD.indexOf("Trident/");var LZ=/fa(s|r|l|t|d|dr|dl|dt|b|k|kd|ss|sr|sl|st|sds|sdr|sdl|sdt)?[\-\ ]/,zZ=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp Duotone|Sharp|Kit)?.*/i,wU={classic:{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fab:"brands","fa-brands":"brands"},duotone:{fa:"solid",fad:"solid","fa-solid":"solid","fa-duotone":"solid",fadr:"regular","fa-regular":"regular",fadl:"light","fa-light":"light",fadt:"thin","fa-thin":"thin"},sharp:{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light",fast:"thin","fa-thin":"thin"},"sharp-duotone":{fa:"solid",fasds:"solid","fa-solid":"solid",fasdr:"regular","fa-regular":"regular",fasdl:"light","fa-light":"light",fasdt:"thin","fa-thin":"thin"}},NZ={GROUP:"duotone-group",PRIMARY:"primary",SECONDARY:"secondary"},SU=["fa-classic","fa-duotone","fa-sharp","fa-sharp-duotone"],El="classic",Gw="duotone",BZ="sharp",FZ="sharp-duotone",TU=[El,Gw,BZ,FZ],jZ={classic:{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},duotone:{900:"fad",400:"fadr",300:"fadl",100:"fadt"},sharp:{900:"fass",400:"fasr",300:"fasl",100:"fast"},"sharp-duotone":{900:"fasds",400:"fasdr",300:"fasdl",100:"fasdt"}},UZ={"Font Awesome 6 Free":{900:"fas",400:"far"},"Font Awesome 6 Pro":{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},"Font Awesome 6 Brands":{400:"fab",normal:"fab"},"Font Awesome 6 Duotone":{900:"fad",400:"fadr",normal:"fadr",300:"fadl",100:"fadt"},"Font Awesome 6 Sharp":{900:"fass",400:"fasr",normal:"fasr",300:"fasl",100:"fast"},"Font Awesome 6 Sharp Duotone":{900:"fasds",400:"fasdr",normal:"fasdr",300:"fasdl",100:"fasdt"}},VZ=new Map([["classic",{defaultShortPrefixId:"fas",defaultStyleId:"solid",styleIds:["solid","regular","light","thin","brands"],futureStyleIds:[],defaultFontWeight:900}],["sharp",{defaultShortPrefixId:"fass",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}],["duotone",{defaultShortPrefixId:"fad",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}],["sharp-duotone",{defaultShortPrefixId:"fasds",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}]]),qZ={classic:{solid:"fas",regular:"far",light:"fal",thin:"fat",brands:"fab"},duotone:{solid:"fad",regular:"fadr",light:"fadl",thin:"fadt"},sharp:{solid:"fass",regular:"fasr",light:"fasl",thin:"fast"},"sharp-duotone":{solid:"fasds",regular:"fasdr",light:"fasdl",thin:"fasdt"}},GZ=["fak","fa-kit","fakd","fa-kit-duotone"],QD={kit:{fak:"kit","fa-kit":"kit"},"kit-duotone":{fakd:"kit-duotone","fa-kit-duotone":"kit-duotone"}},$Z=["kit"],HZ={kit:{"fa-kit":"fak"}},XZ=["fak","fakd"],YZ={kit:{fak:"fa-kit"}},eL={kit:{kit:"fak"},"kit-duotone":{"kit-duotone":"fakd"}},$1={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},ZZ=["fa-classic","fa-duotone","fa-sharp","fa-sharp-duotone"],WZ=["fak","fa-kit","fakd","fa-kit-duotone"],KZ={"Font Awesome Kit":{400:"fak",normal:"fak"},"Font Awesome Kit Duotone":{400:"fakd",normal:"fakd"}},JZ={classic:{"fa-brands":"fab","fa-duotone":"fad","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"},duotone:{"fa-regular":"fadr","fa-light":"fadl","fa-thin":"fadt"},sharp:{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl","fa-thin":"fast"},"sharp-duotone":{"fa-solid":"fasds","fa-regular":"fasdr","fa-light":"fasdl","fa-thin":"fasdt"}},QZ={classic:["fas","far","fal","fat","fad"],duotone:["fadr","fadl","fadt"],sharp:["fass","fasr","fasl","fast"],"sharp-duotone":["fasds","fasdr","fasdl","fasdt"]},IO={classic:{fab:"fa-brands",fad:"fa-duotone",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"},duotone:{fadr:"fa-regular",fadl:"fa-light",fadt:"fa-thin"},sharp:{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light",fast:"fa-thin"},"sharp-duotone":{fasds:"fa-solid",fasdr:"fa-regular",fasdl:"fa-light",fasdt:"fa-thin"}},eW=["fa-solid","fa-regular","fa-light","fa-thin","fa-duotone","fa-brands"],CO=["fa","fas","far","fal","fat","fad","fadr","fadl","fadt","fab","fass","fasr","fasl","fast","fasds","fasdr","fasdl","fasdt",...ZZ,...eW],tW=["solid","regular","light","thin","duotone","brands"],EU=[1,2,3,4,5,6,7,8,9,10],nW=EU.concat([11,12,13,14,15,16,17,18,19,20]),rW=[...Object.keys(QZ),...tW,"2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",$1.GROUP,$1.SWAP_OPACITY,$1.PRIMARY,$1.SECONDARY].concat(EU.map(e=>"".concat(e,"x"))).concat(nW.map(e=>"w-".concat(e))),iW={"Font Awesome 5 Free":{900:"fas",400:"far"},"Font Awesome 5 Pro":{900:"fas",400:"far",normal:"far",300:"fal"},"Font Awesome 5 Brands":{400:"fab",normal:"fab"},"Font Awesome 5 Duotone":{900:"fad"}};const Hd="___FONT_AWESOME___",PO=16,AU="fa",MU="svg-inline--fa",bg="data-fa-i2svg",RO="data-fa-pseudo-element",aW="data-fa-pseudo-element-pending",nP="data-prefix",rP="data-icon",tL="fontawesome-i2svg",oW="async",sW=["HTML","HEAD","STYLE","SCRIPT"],OU=(()=>{try{return!0}catch{return!1}})();function bx(e){return new Proxy(e,{get(t,a){return a in t?t[a]:t[El]}})}const IU=jn({},wU);IU[El]=jn(jn(jn(jn({},{"fa-duotone":"duotone"}),wU[El]),QD.kit),QD["kit-duotone"]);const lW=bx(IU),kO=jn({},qZ);kO[El]=jn(jn(jn(jn({},{duotone:"fad"}),kO[El]),eL.kit),eL["kit-duotone"]);const nL=bx(kO),DO=jn({},IO);DO[El]=jn(jn({},DO[El]),YZ.kit);const iP=bx(DO),LO=jn({},JZ);LO[El]=jn(jn({},LO[El]),HZ.kit);bx(LO);const uW=LZ,CU="fa-layers-text",cW=zZ,hW=jn({},jZ);bx(hW);const fW=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],iT=NZ,dW=[...$Z,...rW],g0=am.FontAwesomeConfig||{};function pW(e){var t=Ga.querySelector("script["+e+"]");if(t)return t.getAttribute(e)}function mW(e){return e===""?!0:e==="false"?!1:e==="true"?!0:e}Ga&&typeof Ga.querySelector=="function"&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(t=>{let[a,o]=t;const c=mW(pW(a));c!=null&&(g0[o]=c)});const PU={styleDefault:"solid",familyDefault:El,cssPrefix:AU,replacementClass:MU,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};g0.familyPrefix&&(g0.cssPrefix=g0.familyPrefix);const i_=jn(jn({},PU),g0);i_.autoReplaceSvg||(i_.observeMutations=!1);const Pr={};Object.keys(PU).forEach(e=>{Object.defineProperty(Pr,e,{enumerable:!0,set:function(t){i_[e]=t,y0.forEach(a=>a(Pr))},get:function(){return i_[e]}})});Object.defineProperty(Pr,"familyPrefix",{enumerable:!0,set:function(e){i_.cssPrefix=e,y0.forEach(t=>t(Pr))},get:function(){return i_.cssPrefix}});am.FontAwesomeConfig=Pr;const y0=[];function gW(e){return y0.push(e),()=>{y0.splice(y0.indexOf(e),1)}}const Yp=PO,Rf={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function yW(e){if(!e||!Jd)return;const t=Ga.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=e;const a=Ga.head.childNodes;let o=null;for(let c=a.length-1;c>-1;c--){const b=a[c],S=(b.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(S)>-1&&(o=b)}return Ga.head.insertBefore(t,o),e}const _W="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function P0(){let e=12,t="";for(;e-- >0;)t+=_W[Math.random()*62|0];return t}function D_(e){const t=[];for(let a=(e||[]).length>>>0;a--;)t[a]=e[a];return t}function aP(e){return e.classList?D_(e.classList):(e.getAttribute("class")||"").split(" ").filter(t=>t)}function RU(e){return"".concat(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function vW(e){return Object.keys(e||{}).reduce((t,a)=>t+"".concat(a,'="').concat(RU(e[a]),'" '),"").trim()}function $w(e){return Object.keys(e||{}).reduce((t,a)=>t+"".concat(a,": ").concat(e[a].trim(),";"),"")}function oP(e){return e.size!==Rf.size||e.x!==Rf.x||e.y!==Rf.y||e.rotate!==Rf.rotate||e.flipX||e.flipY}function xW(e){let{transform:t,containerWidth:a,iconWidth:o}=e;const c={transform:"translate(".concat(a/2," 256)")},b="translate(".concat(t.x*32,", ").concat(t.y*32,") "),S="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),i="rotate(".concat(t.rotate," 0 0)"),P={transform:"".concat(b," ").concat(S," ").concat(i)},L={transform:"translate(".concat(o/2*-1," -256)")};return{outer:c,inner:P,path:L}}function bW(e){let{transform:t,width:a=PO,height:o=PO,startCentered:c=!1}=e,b="";return c&&bU?b+="translate(".concat(t.x/Yp-a/2,"em, ").concat(t.y/Yp-o/2,"em) "):c?b+="translate(calc(-50% + ".concat(t.x/Yp,"em), calc(-50% + ").concat(t.y/Yp,"em)) "):b+="translate(".concat(t.x/Yp,"em, ").concat(t.y/Yp,"em) "),b+="scale(".concat(t.size/Yp*(t.flipX?-1:1),", ").concat(t.size/Yp*(t.flipY?-1:1),") "),b+="rotate(".concat(t.rotate,"deg) "),b}var wW=`:root, :host {
  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Free";
  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Free";
  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Pro";
  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Pro";
  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-regular: normal 400 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-light: normal 300 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-thin: normal 100 1em/1 "Font Awesome 6 Duotone";
  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";
  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-thin: normal 100 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-duotone-solid: normal 900 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-regular: normal 400 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-light: normal 300 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-thin: normal 100 1em/1 "Font Awesome 6 Sharp Duotone";
}

svg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {
  overflow: visible;
  box-sizing: content-box;
}

.svg-inline--fa {
  display: var(--fa-display, inline-block);
  height: 1em;
  overflow: visible;
  vertical-align: -0.125em;
}
.svg-inline--fa.fa-2xs {
  vertical-align: 0.1em;
}
.svg-inline--fa.fa-xs {
  vertical-align: 0em;
}
.svg-inline--fa.fa-sm {
  vertical-align: -0.0714285705em;
}
.svg-inline--fa.fa-lg {
  vertical-align: -0.2em;
}
.svg-inline--fa.fa-xl {
  vertical-align: -0.25em;
}
.svg-inline--fa.fa-2xl {
  vertical-align: -0.3125em;
}
.svg-inline--fa.fa-pull-left {
  margin-right: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-pull-right {
  margin-left: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-li {
  width: var(--fa-li-width, 2em);
  top: 0.25em;
}
.svg-inline--fa.fa-fw {
  width: var(--fa-fw-width, 1.25em);
}

.fa-layers svg.svg-inline--fa {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.fa-layers-counter, .fa-layers-text {
  display: inline-block;
  position: absolute;
  text-align: center;
}

.fa-layers {
  display: inline-block;
  height: 1em;
  position: relative;
  text-align: center;
  vertical-align: -0.125em;
  width: 1em;
}
.fa-layers svg.svg-inline--fa {
  transform-origin: center center;
}

.fa-layers-text {
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  transform-origin: center center;
}

.fa-layers-counter {
  background-color: var(--fa-counter-background-color, #ff253a);
  border-radius: var(--fa-counter-border-radius, 1em);
  box-sizing: border-box;
  color: var(--fa-inverse, #fff);
  line-height: var(--fa-counter-line-height, 1);
  max-width: var(--fa-counter-max-width, 5em);
  min-width: var(--fa-counter-min-width, 1.5em);
  overflow: hidden;
  padding: var(--fa-counter-padding, 0.25em 0.5em);
  right: var(--fa-right, 0);
  text-overflow: ellipsis;
  top: var(--fa-top, 0);
  transform: scale(var(--fa-counter-scale, 0.25));
  transform-origin: top right;
}

.fa-layers-bottom-right {
  bottom: var(--fa-bottom, 0);
  right: var(--fa-right, 0);
  top: auto;
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: bottom right;
}

.fa-layers-bottom-left {
  bottom: var(--fa-bottom, 0);
  left: var(--fa-left, 0);
  right: auto;
  top: auto;
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: bottom left;
}

.fa-layers-top-right {
  top: var(--fa-top, 0);
  right: var(--fa-right, 0);
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: top right;
}

.fa-layers-top-left {
  left: var(--fa-left, 0);
  right: auto;
  top: var(--fa-top, 0);
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: top left;
}

.fa-1x {
  font-size: 1em;
}

.fa-2x {
  font-size: 2em;
}

.fa-3x {
  font-size: 3em;
}

.fa-4x {
  font-size: 4em;
}

.fa-5x {
  font-size: 5em;
}

.fa-6x {
  font-size: 6em;
}

.fa-7x {
  font-size: 7em;
}

.fa-8x {
  font-size: 8em;
}

.fa-9x {
  font-size: 9em;
}

.fa-10x {
  font-size: 10em;
}

.fa-2xs {
  font-size: 0.625em;
  line-height: 0.1em;
  vertical-align: 0.225em;
}

.fa-xs {
  font-size: 0.75em;
  line-height: 0.0833333337em;
  vertical-align: 0.125em;
}

.fa-sm {
  font-size: 0.875em;
  line-height: 0.0714285718em;
  vertical-align: 0.0535714295em;
}

.fa-lg {
  font-size: 1.25em;
  line-height: 0.05em;
  vertical-align: -0.075em;
}

.fa-xl {
  font-size: 1.5em;
  line-height: 0.0416666682em;
  vertical-align: -0.125em;
}

.fa-2xl {
  font-size: 2em;
  line-height: 0.03125em;
  vertical-align: -0.1875em;
}

.fa-fw {
  text-align: center;
  width: 1.25em;
}

.fa-ul {
  list-style-type: none;
  margin-left: var(--fa-li-margin, 2.5em);
  padding-left: 0;
}
.fa-ul > li {
  position: relative;
}

.fa-li {
  left: calc(-1 * var(--fa-li-width, 2em));
  position: absolute;
  text-align: center;
  width: var(--fa-li-width, 2em);
  line-height: inherit;
}

.fa-border {
  border-color: var(--fa-border-color, #eee);
  border-radius: var(--fa-border-radius, 0.1em);
  border-style: var(--fa-border-style, solid);
  border-width: var(--fa-border-width, 0.08em);
  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);
}

.fa-pull-left {
  float: left;
  margin-right: var(--fa-pull-margin, 0.3em);
}

.fa-pull-right {
  float: right;
  margin-left: var(--fa-pull-margin, 0.3em);
}

.fa-beat {
  animation-name: fa-beat;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-bounce {
  animation-name: fa-bounce;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
}

.fa-fade {
  animation-name: fa-fade;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-beat-fade {
  animation-name: fa-beat-fade;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-flip {
  animation-name: fa-flip;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-shake {
  animation-name: fa-shake;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin {
  animation-name: fa-spin;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 2s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin-reverse {
  --fa-animation-direction: reverse;
}

.fa-pulse,
.fa-spin-pulse {
  animation-name: fa-spin;
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, steps(8));
}

@media (prefers-reduced-motion: reduce) {
  .fa-beat,
.fa-bounce,
.fa-fade,
.fa-beat-fade,
.fa-flip,
.fa-pulse,
.fa-shake,
.fa-spin,
.fa-spin-pulse {
    animation-delay: -1ms;
    animation-duration: 1ms;
    animation-iteration-count: 1;
    transition-delay: 0s;
    transition-duration: 0s;
  }
}
@keyframes fa-beat {
  0%, 90% {
    transform: scale(1);
  }
  45% {
    transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@keyframes fa-bounce {
  0% {
    transform: scale(1, 1) translateY(0);
  }
  10% {
    transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    transform: scale(1, 1) translateY(0);
  }
  100% {
    transform: scale(1, 1) translateY(0);
  }
}
@keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    transform: scale(1);
  }
  50% {
    opacity: 1;
    transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@keyframes fa-flip {
  50% {
    transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@keyframes fa-shake {
  0% {
    transform: rotate(-15deg);
  }
  4% {
    transform: rotate(15deg);
  }
  8%, 24% {
    transform: rotate(-18deg);
  }
  12%, 28% {
    transform: rotate(18deg);
  }
  16% {
    transform: rotate(-22deg);
  }
  20% {
    transform: rotate(22deg);
  }
  32% {
    transform: rotate(-12deg);
  }
  36% {
    transform: rotate(12deg);
  }
  40%, 100% {
    transform: rotate(0deg);
  }
}
@keyframes fa-spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}
.fa-rotate-90 {
  transform: rotate(90deg);
}

.fa-rotate-180 {
  transform: rotate(180deg);
}

.fa-rotate-270 {
  transform: rotate(270deg);
}

.fa-flip-horizontal {
  transform: scale(-1, 1);
}

.fa-flip-vertical {
  transform: scale(1, -1);
}

.fa-flip-both,
.fa-flip-horizontal.fa-flip-vertical {
  transform: scale(-1, -1);
}

.fa-rotate-by {
  transform: rotate(var(--fa-rotate-angle, 0));
}

.fa-stack {
  display: inline-block;
  vertical-align: middle;
  height: 2em;
  position: relative;
  width: 2.5em;
}

.fa-stack-1x,
.fa-stack-2x {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
  z-index: var(--fa-stack-z-index, auto);
}

.svg-inline--fa.fa-stack-1x {
  height: 1em;
  width: 1.25em;
}
.svg-inline--fa.fa-stack-2x {
  height: 2em;
  width: 2.5em;
}

.fa-inverse {
  color: var(--fa-inverse, #fff);
}

.sr-only,
.fa-sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.sr-only-focusable:not(:focus),
.fa-sr-only-focusable:not(:focus) {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.svg-inline--fa .fa-primary {
  fill: var(--fa-primary-color, currentColor);
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa .fa-secondary {
  fill: var(--fa-secondary-color, currentColor);
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-primary {
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-secondary {
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa mask .fa-primary,
.svg-inline--fa mask .fa-secondary {
  fill: black;
}`;function kU(){const e=AU,t=MU,a=Pr.cssPrefix,o=Pr.replacementClass;let c=wW;if(a!==e||o!==t){const b=new RegExp("\\.".concat(e,"\\-"),"g"),S=new RegExp("\\--".concat(e,"\\-"),"g"),i=new RegExp("\\.".concat(t),"g");c=c.replace(b,".".concat(a,"-")).replace(S,"--".concat(a,"-")).replace(i,".".concat(o))}return c}let rL=!1;function aT(){Pr.autoAddCss&&!rL&&(yW(kU()),rL=!0)}var SW={mixout(){return{dom:{css:kU,insertCss:aT}}},hooks(){return{beforeDOMElementCreation(){aT()},beforeI2svg(){aT()}}}};const Xd=am||{};Xd[Hd]||(Xd[Hd]={});Xd[Hd].styles||(Xd[Hd].styles={});Xd[Hd].hooks||(Xd[Hd].hooks={});Xd[Hd].shims||(Xd[Hd].shims=[]);var kf=Xd[Hd];const DU=[],LU=function(){Ga.removeEventListener("DOMContentLoaded",LU),Rb=1,DU.map(e=>e())};let Rb=!1;Jd&&(Rb=(Ga.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(Ga.readyState),Rb||Ga.addEventListener("DOMContentLoaded",LU));function TW(e){Jd&&(Rb?setTimeout(e,0):DU.push(e))}function wx(e){const{tag:t,attributes:a={},children:o=[]}=e;return typeof e=="string"?RU(e):"<".concat(t," ").concat(vW(a),">").concat(o.map(wx).join(""),"</").concat(t,">")}function iL(e,t,a){if(e&&e[t]&&e[t][a])return{prefix:t,iconName:a,icon:e[t][a]}}var oT=function(t,a,o,c){var b=Object.keys(t),S=b.length,i=a,P,L,U;for(o===void 0?(P=1,U=t[b[0]]):(P=0,U=o);P<S;P++)L=b[P],U=i(U,t[L],L,t);return U};function EW(e){const t=[];let a=0;const o=e.length;for(;a<o;){const c=e.charCodeAt(a++);if(c>=55296&&c<=56319&&a<o){const b=e.charCodeAt(a++);(b&64512)==56320?t.push(((c&1023)<<10)+(b&1023)+65536):(t.push(c),a--)}else t.push(c)}return t}function zO(e){const t=EW(e);return t.length===1?t[0].toString(16):null}function AW(e,t){const a=e.length;let o=e.charCodeAt(t),c;return o>=55296&&o<=56319&&a>t+1&&(c=e.charCodeAt(t+1),c>=56320&&c<=57343)?(o-55296)*1024+c-56320+65536:o}function aL(e){return Object.keys(e).reduce((t,a)=>{const o=e[a];return!!o.icon?t[o.iconName]=o.icon:t[a]=o,t},{})}function NO(e,t){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{skipHooks:o=!1}=a,c=aL(t);typeof kf.hooks.addPack=="function"&&!o?kf.hooks.addPack(e,aL(t)):kf.styles[e]=jn(jn({},kf.styles[e]||{}),c),e==="fas"&&NO("fa",t)}const{styles:R0,shims:MW}=kf,zU=Object.keys(iP),OW=zU.reduce((e,t)=>(e[t]=Object.keys(iP[t]),e),{});let sP=null,NU={},BU={},FU={},jU={},UU={};function IW(e){return~dW.indexOf(e)}function CW(e,t){const a=t.split("-"),o=a[0],c=a.slice(1).join("-");return o===e&&c!==""&&!IW(c)?c:null}const VU=()=>{const e=o=>oT(R0,(c,b,S)=>(c[S]=oT(b,o,{}),c),{});NU=e((o,c,b)=>(c[3]&&(o[c[3]]=b),c[2]&&c[2].filter(i=>typeof i=="number").forEach(i=>{o[i.toString(16)]=b}),o)),BU=e((o,c,b)=>(o[b]=b,c[2]&&c[2].filter(i=>typeof i=="string").forEach(i=>{o[i]=b}),o)),UU=e((o,c,b)=>{const S=c[2];return o[b]=b,S.forEach(i=>{o[i]=b}),o});const t="far"in R0||Pr.autoFetchSvg,a=oT(MW,(o,c)=>{const b=c[0];let S=c[1];const i=c[2];return S==="far"&&!t&&(S="fas"),typeof b=="string"&&(o.names[b]={prefix:S,iconName:i}),typeof b=="number"&&(o.unicodes[b.toString(16)]={prefix:S,iconName:i}),o},{names:{},unicodes:{}});FU=a.names,jU=a.unicodes,sP=Hw(Pr.styleDefault,{family:Pr.familyDefault})};gW(e=>{sP=Hw(e.styleDefault,{family:Pr.familyDefault})});VU();function lP(e,t){return(NU[e]||{})[t]}function PW(e,t){return(BU[e]||{})[t]}function hg(e,t){return(UU[e]||{})[t]}function qU(e){return FU[e]||{prefix:null,iconName:null}}function RW(e){const t=jU[e],a=lP("fas",e);return t||(a?{prefix:"fas",iconName:a}:null)||{prefix:null,iconName:null}}function om(){return sP}const GU=()=>({prefix:null,iconName:null,rest:[]});function kW(e){let t=El;const a=zU.reduce((o,c)=>(o[c]="".concat(Pr.cssPrefix,"-").concat(c),o),{});return TU.forEach(o=>{(e.includes(a[o])||e.some(c=>OW[o].includes(c)))&&(t=o)}),t}function Hw(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{family:a=El}=t,o=lW[a][e];if(a===Gw&&!e)return"fad";const c=nL[a][e]||nL[a][o],b=e in kf.styles?e:null;return c||b||null}function DW(e){let t=[],a=null;return e.forEach(o=>{const c=CW(Pr.cssPrefix,o);c?a=c:o&&t.push(o)}),{iconName:a,rest:t}}function oL(e){return e.sort().filter((t,a,o)=>o.indexOf(t)===a)}function Xw(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{skipLookups:a=!1}=t;let o=null;const c=CO.concat(WZ),b=oL(e.filter(V=>c.includes(V))),S=oL(e.filter(V=>!CO.includes(V))),i=b.filter(V=>(o=V,!SU.includes(V))),[P=null]=i,L=kW(b),U=jn(jn({},DW(S)),{},{prefix:Hw(P,{family:L})});return jn(jn(jn({},U),BW({values:e,family:L,styles:R0,config:Pr,canonical:U,givenPrefix:o})),LW(a,o,U))}function LW(e,t,a){let{prefix:o,iconName:c}=a;if(e||!o||!c)return{prefix:o,iconName:c};const b=t==="fa"?qU(c):{},S=hg(o,c);return c=b.iconName||S||c,o=b.prefix||o,o==="far"&&!R0.far&&R0.fas&&!Pr.autoFetchSvg&&(o="fas"),{prefix:o,iconName:c}}const zW=TU.filter(e=>e!==El||e!==Gw),NW=Object.keys(IO).filter(e=>e!==El).map(e=>Object.keys(IO[e])).flat();function BW(e){const{values:t,family:a,canonical:o,givenPrefix:c="",styles:b={},config:S={}}=e,i=a===Gw,P=t.includes("fa-duotone")||t.includes("fad"),L=S.familyDefault==="duotone",U=o.prefix==="fad"||o.prefix==="fa-duotone";if(!i&&(P||L||U)&&(o.prefix="fad"),(t.includes("fa-brands")||t.includes("fab"))&&(o.prefix="fab"),!o.prefix&&zW.includes(a)&&(Object.keys(b).find(H=>NW.includes(H))||S.autoFetchSvg)){const H=VZ.get(a).defaultShortPrefixId;o.prefix=H,o.iconName=hg(o.prefix,o.iconName)||o.iconName}return(o.prefix==="fa"||c==="fa")&&(o.prefix=om()||"fas"),o}class FW{constructor(){this.definitions={}}add(){for(var t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];const c=a.reduce(this._pullDefinitions,{});Object.keys(c).forEach(b=>{this.definitions[b]=jn(jn({},this.definitions[b]||{}),c[b]),NO(b,c[b]);const S=iP[El][b];S&&NO(S,c[b]),VU()})}reset(){this.definitions={}}_pullDefinitions(t,a){const o=a.prefix&&a.iconName&&a.icon?{0:a}:a;return Object.keys(o).map(c=>{const{prefix:b,iconName:S,icon:i}=o[c],P=i[2];t[b]||(t[b]={}),P.length>0&&P.forEach(L=>{typeof L=="string"&&(t[b][L]=i)}),t[b][S]=i}),t}}let sL=[],Gy={};const Zy={},jW=Object.keys(Zy);function UW(e,t){let{mixoutsTo:a}=t;return sL=e,Gy={},Object.keys(Zy).forEach(o=>{jW.indexOf(o)===-1&&delete Zy[o]}),sL.forEach(o=>{const c=o.mixout?o.mixout():{};if(Object.keys(c).forEach(b=>{typeof c[b]=="function"&&(a[b]=c[b]),typeof c[b]=="object"&&Object.keys(c[b]).forEach(S=>{a[b]||(a[b]={}),a[b][S]=c[b][S]})}),o.hooks){const b=o.hooks();Object.keys(b).forEach(S=>{Gy[S]||(Gy[S]=[]),Gy[S].push(b[S])})}o.provides&&o.provides(Zy)}),a}function BO(e,t){for(var a=arguments.length,o=new Array(a>2?a-2:0),c=2;c<a;c++)o[c-2]=arguments[c];return(Gy[e]||[]).forEach(S=>{t=S.apply(null,[t,...o])}),t}function wg(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),o=1;o<t;o++)a[o-1]=arguments[o];(Gy[e]||[]).forEach(b=>{b.apply(null,a)})}function sm(){const e=arguments[0],t=Array.prototype.slice.call(arguments,1);return Zy[e]?Zy[e].apply(null,t):void 0}function FO(e){e.prefix==="fa"&&(e.prefix="fas");let{iconName:t}=e;const a=e.prefix||om();if(t)return t=hg(a,t)||t,iL($U.definitions,a,t)||iL(kf.styles,a,t)}const $U=new FW,VW=()=>{Pr.autoReplaceSvg=!1,Pr.observeMutations=!1,wg("noAuto")},qW={i2svg:function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Jd?(wg("beforeI2svg",e),sm("pseudoElements2svg",e),sm("i2svg",e)):Promise.reject(new Error("Operation requires a DOM of some kind."))},watch:function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{autoReplaceSvgRoot:t}=e;Pr.autoReplaceSvg===!1&&(Pr.autoReplaceSvg=!0),Pr.observeMutations=!0,TW(()=>{$W({autoReplaceSvgRoot:t}),wg("watch",e)})}},GW={icon:e=>{if(e===null)return null;if(typeof e=="object"&&e.prefix&&e.iconName)return{prefix:e.prefix,iconName:hg(e.prefix,e.iconName)||e.iconName};if(Array.isArray(e)&&e.length===2){const t=e[1].indexOf("fa-")===0?e[1].slice(3):e[1],a=Hw(e[0]);return{prefix:a,iconName:hg(a,t)||t}}if(typeof e=="string"&&(e.indexOf("".concat(Pr.cssPrefix,"-"))>-1||e.match(uW))){const t=Xw(e.split(" "),{skipLookups:!0});return{prefix:t.prefix||om(),iconName:hg(t.prefix,t.iconName)||t.iconName}}if(typeof e=="string"){const t=om();return{prefix:t,iconName:hg(t,e)||e}}}},Qu={noAuto:VW,config:Pr,dom:qW,parse:GW,library:$U,findIconDefinition:FO,toHtml:wx},$W=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{autoReplaceSvgRoot:t=Ga}=e;(Object.keys(kf.styles).length>0||Pr.autoFetchSvg)&&Jd&&Pr.autoReplaceSvg&&Qu.dom.i2svg({node:t})};function Yw(e,t){return Object.defineProperty(e,"abstract",{get:t}),Object.defineProperty(e,"html",{get:function(){return e.abstract.map(a=>wx(a))}}),Object.defineProperty(e,"node",{get:function(){if(!Jd)return;const a=Ga.createElement("div");return a.innerHTML=e.html,a.children}}),e}function HW(e){let{children:t,main:a,mask:o,attributes:c,styles:b,transform:S}=e;if(oP(S)&&a.found&&!o.found){const{width:i,height:P}=a,L={x:i/P/2,y:.5};c.style=$w(jn(jn({},b),{},{"transform-origin":"".concat(L.x+S.x/16,"em ").concat(L.y+S.y/16,"em")}))}return[{tag:"svg",attributes:c,children:t}]}function XW(e){let{prefix:t,iconName:a,children:o,attributes:c,symbol:b}=e;const S=b===!0?"".concat(t,"-").concat(Pr.cssPrefix,"-").concat(a):b;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:jn(jn({},c),{},{id:S}),children:o}]}]}function uP(e){const{icons:{main:t,mask:a},prefix:o,iconName:c,transform:b,symbol:S,title:i,maskId:P,titleId:L,extra:U,watchable:V=!1}=e,{width:H,height:ee}=a.found?a:t,ie=XZ.includes(o),le=[Pr.replacementClass,c?"".concat(Pr.cssPrefix,"-").concat(c):""].filter(me=>U.classes.indexOf(me)===-1).filter(me=>me!==""||!!me).concat(U.classes).join(" ");let ue={children:[],attributes:jn(jn({},U.attributes),{},{"data-prefix":o,"data-icon":c,class:le,role:U.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(H," ").concat(ee)})};const ge=ie&&!~U.classes.indexOf("fa-fw")?{width:"".concat(H/ee*16*.0625,"em")}:{};V&&(ue.attributes[bg]=""),i&&(ue.children.push({tag:"title",attributes:{id:ue.attributes["aria-labelledby"]||"title-".concat(L||P0())},children:[i]}),delete ue.attributes.title);const Se=jn(jn({},ue),{},{prefix:o,iconName:c,main:t,mask:a,maskId:P,transform:b,symbol:S,styles:jn(jn({},ge),U.styles)}),{children:ve,attributes:Ee}=a.found&&t.found?sm("generateAbstractMask",Se)||{children:[],attributes:{}}:sm("generateAbstractIcon",Se)||{children:[],attributes:{}};return Se.children=ve,Se.attributes=Ee,S?XW(Se):HW(Se)}function lL(e){const{content:t,width:a,height:o,transform:c,title:b,extra:S,watchable:i=!1}=e,P=jn(jn(jn({},S.attributes),b?{title:b}:{}),{},{class:S.classes.join(" ")});i&&(P[bg]="");const L=jn({},S.styles);oP(c)&&(L.transform=bW({transform:c,startCentered:!0,width:a,height:o}),L["-webkit-transform"]=L.transform);const U=$w(L);U.length>0&&(P.style=U);const V=[];return V.push({tag:"span",attributes:P,children:[t]}),b&&V.push({tag:"span",attributes:{class:"sr-only"},children:[b]}),V}function YW(e){const{content:t,title:a,extra:o}=e,c=jn(jn(jn({},o.attributes),a?{title:a}:{}),{},{class:o.classes.join(" ")}),b=$w(o.styles);b.length>0&&(c.style=b);const S=[];return S.push({tag:"span",attributes:c,children:[t]}),a&&S.push({tag:"span",attributes:{class:"sr-only"},children:[a]}),S}const{styles:sT}=kf;function jO(e){const t=e[0],a=e[1],[o]=e.slice(4);let c=null;return Array.isArray(o)?c={tag:"g",attributes:{class:"".concat(Pr.cssPrefix,"-").concat(iT.GROUP)},children:[{tag:"path",attributes:{class:"".concat(Pr.cssPrefix,"-").concat(iT.SECONDARY),fill:"currentColor",d:o[0]}},{tag:"path",attributes:{class:"".concat(Pr.cssPrefix,"-").concat(iT.PRIMARY),fill:"currentColor",d:o[1]}}]}:c={tag:"path",attributes:{fill:"currentColor",d:o}},{found:!0,width:t,height:a,icon:c}}const ZW={found:!1,width:512,height:512};function WW(e,t){!OU&&!Pr.showMissingIcons&&e&&console.error('Icon with name "'.concat(e,'" and prefix "').concat(t,'" is missing.'))}function UO(e,t){let a=t;return t==="fa"&&Pr.styleDefault!==null&&(t=om()),new Promise((o,c)=>{if(a==="fa"){const b=qU(e)||{};e=b.iconName||e,t=b.prefix||t}if(e&&t&&sT[t]&&sT[t][e]){const b=sT[t][e];return o(jO(b))}WW(e,t),o(jn(jn({},ZW),{},{icon:Pr.showMissingIcons&&e?sm("missingIconAbstract")||{}:{}}))})}const uL=()=>{},VO=Pr.measurePerformance&&G1&&G1.mark&&G1.measure?G1:{mark:uL,measure:uL},o0='FA "6.7.2"',KW=e=>(VO.mark("".concat(o0," ").concat(e," begins")),()=>HU(e)),HU=e=>{VO.mark("".concat(o0," ").concat(e," ends")),VO.measure("".concat(o0," ").concat(e),"".concat(o0," ").concat(e," begins"),"".concat(o0," ").concat(e," ends"))};var cP={begin:KW,end:HU};const vb=()=>{};function cL(e){return typeof(e.getAttribute?e.getAttribute(bg):null)=="string"}function JW(e){const t=e.getAttribute?e.getAttribute(nP):null,a=e.getAttribute?e.getAttribute(rP):null;return t&&a}function QW(e){return e&&e.classList&&e.classList.contains&&e.classList.contains(Pr.replacementClass)}function eK(){return Pr.autoReplaceSvg===!0?xb.replace:xb[Pr.autoReplaceSvg]||xb.replace}function tK(e){return Ga.createElementNS("http://www.w3.org/2000/svg",e)}function nK(e){return Ga.createElement(e)}function XU(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{ceFn:a=e.tag==="svg"?tK:nK}=t;if(typeof e=="string")return Ga.createTextNode(e);const o=a(e.tag);return Object.keys(e.attributes||[]).forEach(function(b){o.setAttribute(b,e.attributes[b])}),(e.children||[]).forEach(function(b){o.appendChild(XU(b,{ceFn:a}))}),o}function rK(e){let t=" ".concat(e.outerHTML," ");return t="".concat(t,"Font Awesome fontawesome.com "),t}const xb={replace:function(e){const t=e[0];if(t.parentNode)if(e[1].forEach(a=>{t.parentNode.insertBefore(XU(a),t)}),t.getAttribute(bg)===null&&Pr.keepOriginalSource){let a=Ga.createComment(rK(t));t.parentNode.replaceChild(a,t)}else t.remove()},nest:function(e){const t=e[0],a=e[1];if(~aP(t).indexOf(Pr.replacementClass))return xb.replace(e);const o=new RegExp("".concat(Pr.cssPrefix,"-.*"));if(delete a[0].attributes.id,a[0].attributes.class){const b=a[0].attributes.class.split(" ").reduce((S,i)=>(i===Pr.replacementClass||i.match(o)?S.toSvg.push(i):S.toNode.push(i),S),{toNode:[],toSvg:[]});a[0].attributes.class=b.toSvg.join(" "),b.toNode.length===0?t.removeAttribute("class"):t.setAttribute("class",b.toNode.join(" "))}const c=a.map(b=>wx(b)).join(`
`);t.setAttribute(bg,""),t.innerHTML=c}};function hL(e){e()}function YU(e,t){const a=typeof t=="function"?t:vb;if(e.length===0)a();else{let o=hL;Pr.mutateApproach===oW&&(o=am.requestAnimationFrame||hL),o(()=>{const c=eK(),b=cP.begin("mutate");e.map(c),b(),a()})}}let hP=!1;function ZU(){hP=!0}function qO(){hP=!1}let kb=null;function fL(e){if(!JD||!Pr.observeMutations)return;const{treeCallback:t=vb,nodeCallback:a=vb,pseudoElementsCallback:o=vb,observeMutationsRoot:c=Ga}=e;kb=new JD(b=>{if(hP)return;const S=om();D_(b).forEach(i=>{if(i.type==="childList"&&i.addedNodes.length>0&&!cL(i.addedNodes[0])&&(Pr.searchPseudoElements&&o(i.target),t(i.target)),i.type==="attributes"&&i.target.parentNode&&Pr.searchPseudoElements&&o(i.target.parentNode),i.type==="attributes"&&cL(i.target)&&~fW.indexOf(i.attributeName))if(i.attributeName==="class"&&JW(i.target)){const{prefix:P,iconName:L}=Xw(aP(i.target));i.target.setAttribute(nP,P||S),L&&i.target.setAttribute(rP,L)}else QW(i.target)&&a(i.target)})}),Jd&&kb.observe(c,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}function iK(){kb&&kb.disconnect()}function aK(e){const t=e.getAttribute("style");let a=[];return t&&(a=t.split(";").reduce((o,c)=>{const b=c.split(":"),S=b[0],i=b.slice(1);return S&&i.length>0&&(o[S]=i.join(":").trim()),o},{})),a}function oK(e){const t=e.getAttribute("data-prefix"),a=e.getAttribute("data-icon"),o=e.innerText!==void 0?e.innerText.trim():"";let c=Xw(aP(e));return c.prefix||(c.prefix=om()),t&&a&&(c.prefix=t,c.iconName=a),c.iconName&&c.prefix||(c.prefix&&o.length>0&&(c.iconName=PW(c.prefix,e.innerText)||lP(c.prefix,zO(e.innerText))),!c.iconName&&Pr.autoFetchSvg&&e.firstChild&&e.firstChild.nodeType===Node.TEXT_NODE&&(c.iconName=e.firstChild.data)),c}function sK(e){const t=D_(e.attributes).reduce((c,b)=>(c.name!=="class"&&c.name!=="style"&&(c[b.name]=b.value),c),{}),a=e.getAttribute("title"),o=e.getAttribute("data-fa-title-id");return Pr.autoA11y&&(a?t["aria-labelledby"]="".concat(Pr.replacementClass,"-title-").concat(o||P0()):(t["aria-hidden"]="true",t.focusable="false")),t}function lK(){return{iconName:null,title:null,titleId:null,prefix:null,transform:Rf,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}function dL(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{styleParser:!0};const{iconName:a,prefix:o,rest:c}=oK(e),b=sK(e),S=BO("parseNodeAttributes",{},e);let i=t.styleParser?aK(e):[];return jn({iconName:a,title:e.getAttribute("title"),titleId:e.getAttribute("data-fa-title-id"),prefix:o,transform:Rf,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:c,styles:i,attributes:b}},S)}const{styles:uK}=kf;function WU(e){const t=Pr.autoReplaceSvg==="nest"?dL(e,{styleParser:!1}):dL(e);return~t.extra.classes.indexOf(CU)?sm("generateLayersText",e,t):sm("generateSvgReplacementMutation",e,t)}function cK(){return[...GZ,...CO]}function pL(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!Jd)return Promise.resolve();const a=Ga.documentElement.classList,o=U=>a.add("".concat(tL,"-").concat(U)),c=U=>a.remove("".concat(tL,"-").concat(U)),b=Pr.autoFetchSvg?cK():SU.concat(Object.keys(uK));b.includes("fa")||b.push("fa");const S=[".".concat(CU,":not([").concat(bg,"])")].concat(b.map(U=>".".concat(U,":not([").concat(bg,"])"))).join(", ");if(S.length===0)return Promise.resolve();let i=[];try{i=D_(e.querySelectorAll(S))}catch{}if(i.length>0)o("pending"),c("complete");else return Promise.resolve();const P=cP.begin("onTree"),L=i.reduce((U,V)=>{try{const H=WU(V);H&&U.push(H)}catch(H){OU||H.name==="MissingIcon"&&console.error(H)}return U},[]);return new Promise((U,V)=>{Promise.all(L).then(H=>{YU(H,()=>{o("active"),o("complete"),c("pending"),typeof t=="function"&&t(),P(),U()})}).catch(H=>{P(),V(H)})})}function hK(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;WU(e).then(a=>{a&&YU([a],t)})}function fK(e){return function(t){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=(t||{}).icon?t:FO(t||{});let{mask:c}=a;return c&&(c=(c||{}).icon?c:FO(c||{})),e(o,jn(jn({},a),{},{mask:c}))}}const dK=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{transform:a=Rf,symbol:o=!1,mask:c=null,maskId:b=null,title:S=null,titleId:i=null,classes:P=[],attributes:L={},styles:U={}}=t;if(!e)return;const{prefix:V,iconName:H,icon:ee}=e;return Yw(jn({type:"icon"},e),()=>(wg("beforeDOMElementCreation",{iconDefinition:e,params:t}),Pr.autoA11y&&(S?L["aria-labelledby"]="".concat(Pr.replacementClass,"-title-").concat(i||P0()):(L["aria-hidden"]="true",L.focusable="false")),uP({icons:{main:jO(ee),mask:c?jO(c.icon):{found:!1,width:null,height:null,icon:{}}},prefix:V,iconName:H,transform:jn(jn({},Rf),a),symbol:o,title:S,maskId:b,titleId:i,extra:{attributes:L,styles:U,classes:P}})))};var pK={mixout(){return{icon:fK(dK)}},hooks(){return{mutationObserverCallbacks(e){return e.treeCallback=pL,e.nodeCallback=hK,e}}},provides(e){e.i2svg=function(t){const{node:a=Ga,callback:o=()=>{}}=t;return pL(a,o)},e.generateSvgReplacementMutation=function(t,a){const{iconName:o,title:c,titleId:b,prefix:S,transform:i,symbol:P,mask:L,maskId:U,extra:V}=a;return new Promise((H,ee)=>{Promise.all([UO(o,S),L.iconName?UO(L.iconName,L.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(ie=>{let[le,ue]=ie;H([t,uP({icons:{main:le,mask:ue},prefix:S,iconName:o,transform:i,symbol:P,maskId:U,title:c,titleId:b,extra:V,watchable:!0})])}).catch(ee)})},e.generateAbstractIcon=function(t){let{children:a,attributes:o,main:c,transform:b,styles:S}=t;const i=$w(S);i.length>0&&(o.style=i);let P;return oP(b)&&(P=sm("generateAbstractTransformGrouping",{main:c,transform:b,containerWidth:c.width,iconWidth:c.width})),a.push(P||c.icon),{children:a,attributes:o}}}},mK={mixout(){return{layer(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{classes:a=[]}=t;return Yw({type:"layer"},()=>{wg("beforeDOMElementCreation",{assembler:e,params:t});let o=[];return e(c=>{Array.isArray(c)?c.map(b=>{o=o.concat(b.abstract)}):o=o.concat(c.abstract)}),[{tag:"span",attributes:{class:["".concat(Pr.cssPrefix,"-layers"),...a].join(" ")},children:o}]})}}}},gK={mixout(){return{counter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{title:a=null,classes:o=[],attributes:c={},styles:b={}}=t;return Yw({type:"counter",content:e},()=>(wg("beforeDOMElementCreation",{content:e,params:t}),YW({content:e.toString(),title:a,extra:{attributes:c,styles:b,classes:["".concat(Pr.cssPrefix,"-layers-counter"),...o]}})))}}}},yK={mixout(){return{text(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{transform:a=Rf,title:o=null,classes:c=[],attributes:b={},styles:S={}}=t;return Yw({type:"text",content:e},()=>(wg("beforeDOMElementCreation",{content:e,params:t}),lL({content:e,transform:jn(jn({},Rf),a),title:o,extra:{attributes:b,styles:S,classes:["".concat(Pr.cssPrefix,"-layers-text"),...c]}})))}}},provides(e){e.generateLayersText=function(t,a){const{title:o,transform:c,extra:b}=a;let S=null,i=null;if(bU){const P=parseInt(getComputedStyle(t).fontSize,10),L=t.getBoundingClientRect();S=L.width/P,i=L.height/P}return Pr.autoA11y&&!o&&(b.attributes["aria-hidden"]="true"),Promise.resolve([t,lL({content:t.innerHTML,width:S,height:i,transform:c,title:o,extra:b,watchable:!0})])}}};const _K=new RegExp('"',"ug"),mL=[1105920,1112319],gL=jn(jn(jn(jn({},{FontAwesome:{normal:"fas",400:"fas"}}),UZ),iW),KZ),GO=Object.keys(gL).reduce((e,t)=>(e[t.toLowerCase()]=gL[t],e),{}),vK=Object.keys(GO).reduce((e,t)=>{const a=GO[t];return e[t]=a[900]||[...Object.entries(a)][0][1],e},{});function xK(e){const t=e.replace(_K,""),a=AW(t,0),o=a>=mL[0]&&a<=mL[1],c=t.length===2?t[0]===t[1]:!1;return{value:zO(c?t[0]:t),isSecondary:o||c}}function bK(e,t){const a=e.replace(/^['"]|['"]$/g,"").toLowerCase(),o=parseInt(t),c=isNaN(o)?"normal":o;return(GO[a]||{})[c]||vK[a]}function yL(e,t){const a="".concat(aW).concat(t.replace(":","-"));return new Promise((o,c)=>{if(e.getAttribute(a)!==null)return o();const S=D_(e.children).filter(H=>H.getAttribute(RO)===t)[0],i=am.getComputedStyle(e,t),P=i.getPropertyValue("font-family"),L=P.match(cW),U=i.getPropertyValue("font-weight"),V=i.getPropertyValue("content");if(S&&!L)return e.removeChild(S),o();if(L&&V!=="none"&&V!==""){const H=i.getPropertyValue("content");let ee=bK(P,U);const{value:ie,isSecondary:le}=xK(H),ue=L[0].startsWith("FontAwesome");let ge=lP(ee,ie),Se=ge;if(ue){const ve=RW(ie);ve.iconName&&ve.prefix&&(ge=ve.iconName,ee=ve.prefix)}if(ge&&!le&&(!S||S.getAttribute(nP)!==ee||S.getAttribute(rP)!==Se)){e.setAttribute(a,Se),S&&e.removeChild(S);const ve=lK(),{extra:Ee}=ve;Ee.attributes[RO]=t,UO(ge,ee).then(me=>{const Ae=uP(jn(jn({},ve),{},{icons:{main:me,mask:GU()},prefix:ee,iconName:Se,extra:Ee,watchable:!0})),Oe=Ga.createElementNS("http://www.w3.org/2000/svg","svg");t==="::before"?e.insertBefore(Oe,e.firstChild):e.appendChild(Oe),Oe.outerHTML=Ae.map(Ye=>wx(Ye)).join(`
`),e.removeAttribute(a),o()}).catch(c)}else o()}else o()})}function wK(e){return Promise.all([yL(e,"::before"),yL(e,"::after")])}function SK(e){return e.parentNode!==document.head&&!~sW.indexOf(e.tagName.toUpperCase())&&!e.getAttribute(RO)&&(!e.parentNode||e.parentNode.tagName!=="svg")}function _L(e){if(Jd)return new Promise((t,a)=>{const o=D_(e.querySelectorAll("*")).filter(SK).map(wK),c=cP.begin("searchPseudoElements");ZU(),Promise.all(o).then(()=>{c(),qO(),t()}).catch(()=>{c(),qO(),a()})})}var TK={hooks(){return{mutationObserverCallbacks(e){return e.pseudoElementsCallback=_L,e}}},provides(e){e.pseudoElements2svg=function(t){const{node:a=Ga}=t;Pr.searchPseudoElements&&_L(a)}}};let vL=!1;var EK={mixout(){return{dom:{unwatch(){ZU(),vL=!0}}}},hooks(){return{bootstrap(){fL(BO("mutationObserverCallbacks",{}))},noAuto(){iK()},watch(e){const{observeMutationsRoot:t}=e;vL?qO():fL(BO("mutationObserverCallbacks",{observeMutationsRoot:t}))}}}};const xL=e=>{let t={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return e.toLowerCase().split(" ").reduce((a,o)=>{const c=o.toLowerCase().split("-"),b=c[0];let S=c.slice(1).join("-");if(b&&S==="h")return a.flipX=!0,a;if(b&&S==="v")return a.flipY=!0,a;if(S=parseFloat(S),isNaN(S))return a;switch(b){case"grow":a.size=a.size+S;break;case"shrink":a.size=a.size-S;break;case"left":a.x=a.x-S;break;case"right":a.x=a.x+S;break;case"up":a.y=a.y-S;break;case"down":a.y=a.y+S;break;case"rotate":a.rotate=a.rotate+S;break}return a},t)};var AK={mixout(){return{parse:{transform:e=>xL(e)}}},hooks(){return{parseNodeAttributes(e,t){const a=t.getAttribute("data-fa-transform");return a&&(e.transform=xL(a)),e}}},provides(e){e.generateAbstractTransformGrouping=function(t){let{main:a,transform:o,containerWidth:c,iconWidth:b}=t;const S={transform:"translate(".concat(c/2," 256)")},i="translate(".concat(o.x*32,", ").concat(o.y*32,") "),P="scale(".concat(o.size/16*(o.flipX?-1:1),", ").concat(o.size/16*(o.flipY?-1:1),") "),L="rotate(".concat(o.rotate," 0 0)"),U={transform:"".concat(i," ").concat(P," ").concat(L)},V={transform:"translate(".concat(b/2*-1," -256)")},H={outer:S,inner:U,path:V};return{tag:"g",attributes:jn({},H.outer),children:[{tag:"g",attributes:jn({},H.inner),children:[{tag:a.icon.tag,children:a.icon.children,attributes:jn(jn({},a.icon.attributes),H.path)}]}]}}}};const lT={x:0,y:0,width:"100%",height:"100%"};function bL(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return e.attributes&&(e.attributes.fill||t)&&(e.attributes.fill="black"),e}function MK(e){return e.tag==="g"?e.children:[e]}var OK={hooks(){return{parseNodeAttributes(e,t){const a=t.getAttribute("data-fa-mask"),o=a?Xw(a.split(" ").map(c=>c.trim())):GU();return o.prefix||(o.prefix=om()),e.mask=o,e.maskId=t.getAttribute("data-fa-mask-id"),e}}},provides(e){e.generateAbstractMask=function(t){let{children:a,attributes:o,main:c,mask:b,maskId:S,transform:i}=t;const{width:P,icon:L}=c,{width:U,icon:V}=b,H=xW({transform:i,containerWidth:U,iconWidth:P}),ee={tag:"rect",attributes:jn(jn({},lT),{},{fill:"white"})},ie=L.children?{children:L.children.map(bL)}:{},le={tag:"g",attributes:jn({},H.inner),children:[bL(jn({tag:L.tag,attributes:jn(jn({},L.attributes),H.path)},ie))]},ue={tag:"g",attributes:jn({},H.outer),children:[le]},ge="mask-".concat(S||P0()),Se="clip-".concat(S||P0()),ve={tag:"mask",attributes:jn(jn({},lT),{},{id:ge,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[ee,ue]},Ee={tag:"defs",children:[{tag:"clipPath",attributes:{id:Se},children:MK(V)},ve]};return a.push(Ee,{tag:"rect",attributes:jn({fill:"currentColor","clip-path":"url(#".concat(Se,")"),mask:"url(#".concat(ge,")")},lT)}),{children:a,attributes:o}}}},IK={provides(e){let t=!1;am.matchMedia&&(t=am.matchMedia("(prefers-reduced-motion: reduce)").matches),e.missingIconAbstract=function(){const a=[],o={fill:"currentColor"},c={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};a.push({tag:"path",attributes:jn(jn({},o),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});const b=jn(jn({},c),{},{attributeName:"opacity"}),S={tag:"circle",attributes:jn(jn({},o),{},{cx:"256",cy:"364",r:"28"}),children:[]};return t||S.children.push({tag:"animate",attributes:jn(jn({},c),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:jn(jn({},b),{},{values:"1;0;1;1;0;1;"})}),a.push(S),a.push({tag:"path",attributes:jn(jn({},o),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:t?[]:[{tag:"animate",attributes:jn(jn({},b),{},{values:"1;0;0;0;0;1;"})}]}),t||a.push({tag:"path",attributes:jn(jn({},o),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:jn(jn({},b),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:a}}}},CK={hooks(){return{parseNodeAttributes(e,t){const a=t.getAttribute("data-fa-symbol"),o=a===null?!1:a===""?!0:a;return e.symbol=o,e}}}},PK=[SW,pK,mK,gK,yK,TK,EK,AK,OK,IK,CK];UW(PK,{mixoutsTo:Qu});Qu.noAuto;Qu.config;Qu.library;Qu.dom;const $O=Qu.parse;Qu.findIconDefinition;Qu.toHtml;const RK=Qu.icon;Qu.layer;Qu.text;Qu.counter;var uT={exports:{}},cT,wL;function kK(){if(wL)return cT;wL=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return cT=e,cT}var hT,SL;function DK(){if(SL)return hT;SL=1;var e=kK();function t(){}function a(){}return a.resetWarningCache=t,hT=function(){function o(S,i,P,L,U,V){if(V!==e){var H=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw H.name="Invariant Violation",H}}o.isRequired=o;function c(){return o}var b={array:o,bigint:o,bool:o,func:o,number:o,object:o,string:o,symbol:o,any:o,arrayOf:c,element:o,elementType:o,instanceOf:c,node:o,objectOf:c,oneOf:c,oneOfType:c,shape:c,exact:c,checkPropTypes:a,resetWarningCache:t};return b.PropTypes=b,b},hT}var TL;function LK(){return TL||(TL=1,uT.exports=DK()()),uT.exports}var zK=LK();const dr=fa(zK);function EL(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function If(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?EL(Object(a),!0).forEach(function(o){$y(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):EL(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Db(e){"@babel/helpers - typeof";return Db=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Db(e)}function $y(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function NK(e,t){if(e==null)return{};var a={},o=Object.keys(e),c,b;for(b=0;b<o.length;b++)c=o[b],!(t.indexOf(c)>=0)&&(a[c]=e[c]);return a}function BK(e,t){if(e==null)return{};var a=NK(e,t),o,c;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(c=0;c<b.length;c++)o=b[c],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function HO(e){return FK(e)||jK(e)||UK(e)||VK()}function FK(e){if(Array.isArray(e))return XO(e)}function jK(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function UK(e,t){if(e){if(typeof e=="string")return XO(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return XO(e,t)}}function XO(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function VK(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qK(e){var t,a=e.beat,o=e.fade,c=e.beatFade,b=e.bounce,S=e.shake,i=e.flash,P=e.spin,L=e.spinPulse,U=e.spinReverse,V=e.pulse,H=e.fixedWidth,ee=e.inverse,ie=e.border,le=e.listItem,ue=e.flip,ge=e.size,Se=e.rotation,ve=e.pull,Ee=(t={"fa-beat":a,"fa-fade":o,"fa-beat-fade":c,"fa-bounce":b,"fa-shake":S,"fa-flash":i,"fa-spin":P,"fa-spin-reverse":U,"fa-spin-pulse":L,"fa-pulse":V,"fa-fw":H,"fa-inverse":ee,"fa-border":ie,"fa-li":le,"fa-flip":ue===!0,"fa-flip-horizontal":ue==="horizontal"||ue==="both","fa-flip-vertical":ue==="vertical"||ue==="both"},$y(t,"fa-".concat(ge),typeof ge<"u"&&ge!==null),$y(t,"fa-rotate-".concat(Se),typeof Se<"u"&&Se!==null&&Se!==0),$y(t,"fa-pull-".concat(ve),typeof ve<"u"&&ve!==null),$y(t,"fa-swap-opacity",e.swapOpacity),t);return Object.keys(Ee).map(function(me){return Ee[me]?me:null}).filter(function(me){return me})}function GK(e){return e=e-0,e===e}function KU(e){return GK(e)?e:(e=e.replace(/[\-_\s]+(.)?/g,function(t,a){return a?a.toUpperCase():""}),e.substr(0,1).toLowerCase()+e.substr(1))}var $K=["style"];function HK(e){return e.charAt(0).toUpperCase()+e.slice(1)}function XK(e){return e.split(";").map(function(t){return t.trim()}).filter(function(t){return t}).reduce(function(t,a){var o=a.indexOf(":"),c=KU(a.slice(0,o)),b=a.slice(o+1).trim();return c.startsWith("webkit")?t[HK(c)]=b:t[c]=b,t},{})}function JU(e,t){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof t=="string")return t;var o=(t.children||[]).map(function(P){return JU(e,P)}),c=Object.keys(t.attributes||{}).reduce(function(P,L){var U=t.attributes[L];switch(L){case"class":P.attrs.className=U,delete t.attributes.class;break;case"style":P.attrs.style=XK(U);break;default:L.indexOf("aria-")===0||L.indexOf("data-")===0?P.attrs[L.toLowerCase()]=U:P.attrs[KU(L)]=U}return P},{attrs:{}}),b=a.style,S=b===void 0?{}:b,i=BK(a,$K);return c.attrs.style=If(If({},c.attrs.style),S),e.apply(void 0,[t.tag,If(If({},c.attrs),i)].concat(HO(o)))}var QU=!1;try{QU=!0}catch{}function YK(){if(!QU&&console&&typeof console.error=="function"){var e;(e=console).error.apply(e,arguments)}}function AL(e){if(e&&Db(e)==="object"&&e.prefix&&e.iconName&&e.icon)return e;if($O.icon)return $O.icon(e);if(e===null)return null;if(e&&Db(e)==="object"&&e.prefix&&e.iconName)return e;if(Array.isArray(e)&&e.length===2)return{prefix:e[0],iconName:e[1]};if(typeof e=="string")return{prefix:"fas",iconName:e}}function fT(e,t){return Array.isArray(t)&&t.length>0||!Array.isArray(t)&&t?$y({},e,t):{}}var ML={border:!1,className:"",mask:null,maskId:null,fixedWidth:!1,inverse:!1,flip:!1,icon:null,listItem:!1,pull:null,pulse:!1,rotation:null,size:null,spin:!1,spinPulse:!1,spinReverse:!1,beat:!1,fade:!1,beatFade:!1,bounce:!1,shake:!1,symbol:!1,title:"",titleId:null,transform:null,swapOpacity:!1},fg=kt.forwardRef(function(e,t){var a=If(If({},ML),e),o=a.icon,c=a.mask,b=a.symbol,S=a.className,i=a.title,P=a.titleId,L=a.maskId,U=AL(o),V=fT("classes",[].concat(HO(qK(a)),HO((S||"").split(" ")))),H=fT("transform",typeof a.transform=="string"?$O.transform(a.transform):a.transform),ee=fT("mask",AL(c)),ie=RK(U,If(If(If(If({},V),H),ee),{},{symbol:b,title:i,titleId:P,maskId:L}));if(!ie)return YK("Could not find icon",U),null;var le=ie.abstract,ue={ref:t};return Object.keys(a).forEach(function(ge){ML.hasOwnProperty(ge)||(ue[ge]=a[ge])}),ZK(le[0],ue)});fg.displayName="FontAwesomeIcon";fg.propTypes={beat:dr.bool,border:dr.bool,beatFade:dr.bool,bounce:dr.bool,className:dr.string,fade:dr.bool,flash:dr.bool,mask:dr.oneOfType([dr.object,dr.array,dr.string]),maskId:dr.string,fixedWidth:dr.bool,inverse:dr.bool,flip:dr.oneOf([!0,!1,"horizontal","vertical","both"]),icon:dr.oneOfType([dr.object,dr.array,dr.string]),listItem:dr.bool,pull:dr.oneOf(["right","left"]),pulse:dr.bool,rotation:dr.oneOf([0,90,180,270]),shake:dr.bool,size:dr.oneOf(["2xs","xs","sm","lg","xl","2xl","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"]),spin:dr.bool,spinPulse:dr.bool,spinReverse:dr.bool,symbol:dr.oneOfType([dr.bool,dr.string]),title:dr.string,titleId:dr.string,transform:dr.oneOfType([dr.string,dr.object]),swapOpacity:dr.bool};var ZK=JU.bind(null,kt.createElement);/*!
 * Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */const WK={prefix:"fas",iconName:"envelope",icon:[512,512,[128386,9993,61443],"f0e0","M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48L48 64zM0 176L0 384c0 35.3 28.7 64 64 64l384 0c35.3 0 64-28.7 64-64l0-208L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z"]},KK={prefix:"fas",iconName:"arrow-down",icon:[384,512,[8595],"f063","M169.4 470.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 370.8 224 64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 306.7L54.6 265.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"]};/*!
 * Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */const JK={prefix:"fab",iconName:"linkedin",icon:[448,512,[],"f08c","M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"]},QK={prefix:"fab",iconName:"whatsapp",icon:[448,512,[],"f232","M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"]},eJ={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]};function tJ(){return nn.jsxs(Cr.div,{className:"w-full py-20 bg-white border-2 rounded-lg flex flex-col items-center justify-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:100,damping:10},children:[nn.jsx(Cr.h2,{className:"text-5xl font-bold text-blue-600 mb-6 text-center",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:120,damping:12,delay:.2},children:"Let's Connect!"}),nn.jsxs(Cr.p,{className:"text-xl text-gray-700 mb-12 text-center max-w-2xl leading-relaxed",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:120,damping:12,delay:.4},children:["Have a question or want to collaborate? Feel free to reach out to me via:"," "]}),nn.jsxs(Cr.div,{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 w-full max-w-6xl px-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:120,damping:12,delay:.6},children:[nn.jsxs(Cr.a,{href:"mailto:your-email@example.com",className:"px-8 py-6 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors flex flex-col items-center justify-center gap-3 shadow-lg hover:shadow-xl",whileHover:{scale:1.05},whileTap:{scale:.95},children:[nn.jsx(fg,{icon:WK,className:"h-8 w-8"}),nn.jsx("span",{className:"text-lg font-medium",children:"Email Me"})]}),nn.jsxs(Cr.a,{href:"https://wa.me/your-whatsapp-number",target:"_blank",rel:"noopener noreferrer",className:"px-8 py-6 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors flex flex-col items-center justify-center gap-3 shadow-lg hover:shadow-xl",whileHover:{scale:1.05},whileTap:{scale:.95},children:[nn.jsx(fg,{icon:QK,className:"h-8 w-8"}),nn.jsx("span",{className:"text-lg font-medium",children:"WhatsApp"})]}),nn.jsxs(Cr.a,{href:"https://www.linkedin.com/in/your-linkedin-profile",target:"_blank",rel:"noopener noreferrer",className:"px-8 py-6 bg-blue-700 text-white rounded-xl hover:bg-blue-800 transition-colors flex flex-col items-center justify-center gap-3 shadow-lg hover:shadow-xl",whileHover:{scale:1.05},whileTap:{scale:.95},children:[nn.jsx(fg,{icon:JK,className:"h-8 w-8"}),nn.jsx("span",{className:"text-lg font-medium",children:"LinkedIn"})]}),nn.jsxs(Cr.a,{href:"https://github.com/your-github-profile",target:"_blank",rel:"noopener noreferrer",className:"px-4 py-3 bg-gray-800 text-white rounded-xl hover:bg-gray-900 transition-colors flex flex-col items-center justify-center gap-3 shadow-lg hover:shadow-xl",whileHover:{scale:1.05},whileTap:{scale:.95},children:[nn.jsx(fg,{icon:eJ,className:"h-8 w-8"}),nn.jsx("span",{className:"text-lg font-medium",children:"GitHub"})]})]}),nn.jsx(Cr.p,{className:"text-xl text-gray-700 mt-12 text-center max-w-2xl leading-relaxed",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:120,damping:12,delay:.4},children:"I'm always open to new opportunities and discussions!"})]})}function nJ({activeId:e}){const t={1:"About Me",2:"Interactive Data Visualizations",3:"Spatial Analysis & Dynamic Mapping",4:"Project: Webmap PBB P-2",5:"Project: Survey Pajak Kendaraan Bermotor"},a=t[e]||"Profile",o=e+1,c=t[o]||"End",b={hidden:{opacity:0,y:-50},visible:{opacity:1,y:0,transition:{duration:.5,ease:"easeOut"}}},S={hidden:{opacity:0,x:-20},visible:{opacity:1,x:0,transition:{delay:.3,duration:.5,ease:"easeOut"}}},i={hidden:{opacity:0,y:50},visible:{opacity:1,y:0,transition:{duration:.5,ease:"easeOut"}}};return nn.jsxs(nn.Fragment,{children:[nn.jsx(Cr.header,{className:"fixed top-0 left-0 right-0 h-[100px] bg-gradient-to-b from-gray-200 to-white text-[#00BFFF] p-4 z-50 flex items-center justify-center",initial:"hidden",animate:"visible",variants:b,style:{color:"#00BFFF"},children:nn.jsx(Cr.div,{className:"flex items-center gap-3",variants:S,children:nn.jsx("h6",{className:"text-2xl font-semibold tracking-tight",children:a})})}),nn.jsx(Cr.footer,{className:"fixed bottom-0 left-0 right-0 bg-white text-[#00BFFF] p-4 z-50 shadow-lg flex justify-center items-center",initial:"hidden",animate:"visible",variants:i,children:nn.jsxs(Cr.p,{className:"text-md flex items-center gap-2 font-medium",variants:S,style:{color:"#00BFFF"},children:[nn.jsx("span",{children:c}),c!=="End"&&nn.jsx(fg,{icon:KK,className:"animate-bounce"})]})})]})}var bb={exports:{}},rJ=bb.exports,OL;function iJ(){return OL||(OL=1,function(e,t){(function(a,o){e.exports=o()})(rJ,function(){var a,o,c;function b(i,P){if(!a)a=P;else if(!o)o=P;else{var L="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+a+")(sharedChunk); ("+o+")(sharedChunk); self.onerror = null;",U={};a(U),c=P(U),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(c.workerUrl=window.URL.createObjectURL(new Blob([L],{type:"text/javascript"})))}}b(["exports"],function(i){function P(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var L,U={},V={};function H(){if(L)return V;L=1,Object.defineProperty(V,"__esModule",{value:!0}),V.setMatrixArrayType=function(y){V.ARRAY_TYPE=n=y},V.toRadian=function(y){return y*h},V.equals=function(y,d){return Math.abs(y-d)<=u*Math.max(1,Math.abs(y),Math.abs(d))},V.RANDOM=V.ARRAY_TYPE=V.EPSILON=void 0;var u=1e-6;V.EPSILON=u;var n=typeof Float32Array<"u"?Float32Array:Array;V.ARRAY_TYPE=n;var s=Math.random;V.RANDOM=s;var h=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var y=0,d=arguments.length;d--;)y+=arguments[d]*arguments[d];return Math.sqrt(y)}),V}var ee,ie={};function le(){if(ee)return ie;function u(d){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},u(d)}ee=1,Object.defineProperty(ie,"__esModule",{value:!0}),ie.create=function(){var d=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(d[1]=0,d[2]=0),d[0]=1,d[3]=1,d},ie.clone=function(d){var v=new n.ARRAY_TYPE(4);return v[0]=d[0],v[1]=d[1],v[2]=d[2],v[3]=d[3],v},ie.copy=function(d,v){return d[0]=v[0],d[1]=v[1],d[2]=v[2],d[3]=v[3],d},ie.identity=function(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=1,d},ie.fromValues=function(d,v,M,k){var j=new n.ARRAY_TYPE(4);return j[0]=d,j[1]=v,j[2]=M,j[3]=k,j},ie.set=function(d,v,M,k,j){return d[0]=v,d[1]=M,d[2]=k,d[3]=j,d},ie.transpose=function(d,v){if(d===v){var M=v[1];d[1]=v[2],d[2]=M}else d[0]=v[0],d[1]=v[2],d[2]=v[1],d[3]=v[3];return d},ie.invert=function(d,v){var M=v[0],k=v[1],j=v[2],E=v[3],D=M*E-j*k;return D?(d[0]=E*(D=1/D),d[1]=-k*D,d[2]=-j*D,d[3]=M*D,d):null},ie.adjoint=function(d,v){var M=v[0];return d[0]=v[3],d[1]=-v[1],d[2]=-v[2],d[3]=M,d},ie.determinant=function(d){return d[0]*d[3]-d[2]*d[1]},ie.multiply=h,ie.rotate=function(d,v,M){var k=v[0],j=v[1],E=v[2],D=v[3],B=Math.sin(M),R=Math.cos(M);return d[0]=k*R+E*B,d[1]=j*R+D*B,d[2]=k*-B+E*R,d[3]=j*-B+D*R,d},ie.scale=function(d,v,M){var k=v[1],j=v[2],E=v[3],D=M[0],B=M[1];return d[0]=v[0]*D,d[1]=k*D,d[2]=j*B,d[3]=E*B,d},ie.fromRotation=function(d,v){var M=Math.sin(v),k=Math.cos(v);return d[0]=k,d[1]=M,d[2]=-M,d[3]=k,d},ie.fromScaling=function(d,v){return d[0]=v[0],d[1]=0,d[2]=0,d[3]=v[1],d},ie.str=function(d){return"mat2("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+")"},ie.frob=function(d){return Math.hypot(d[0],d[1],d[2],d[3])},ie.LDU=function(d,v,M,k){return d[2]=k[2]/k[0],M[0]=k[0],M[1]=k[1],M[3]=k[3]-d[2]*M[1],[d,v,M]},ie.add=function(d,v,M){return d[0]=v[0]+M[0],d[1]=v[1]+M[1],d[2]=v[2]+M[2],d[3]=v[3]+M[3],d},ie.subtract=y,ie.exactEquals=function(d,v){return d[0]===v[0]&&d[1]===v[1]&&d[2]===v[2]&&d[3]===v[3]},ie.equals=function(d,v){var M=d[0],k=d[1],j=d[2],E=d[3],D=v[0],B=v[1],R=v[2],z=v[3];return Math.abs(M-D)<=n.EPSILON*Math.max(1,Math.abs(M),Math.abs(D))&&Math.abs(k-B)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(B))&&Math.abs(j-R)<=n.EPSILON*Math.max(1,Math.abs(j),Math.abs(R))&&Math.abs(E-z)<=n.EPSILON*Math.max(1,Math.abs(E),Math.abs(z))},ie.multiplyScalar=function(d,v,M){return d[0]=v[0]*M,d[1]=v[1]*M,d[2]=v[2]*M,d[3]=v[3]*M,d},ie.multiplyScalarAndAdd=function(d,v,M,k){return d[0]=v[0]+M[0]*k,d[1]=v[1]+M[1]*k,d[2]=v[2]+M[2]*k,d[3]=v[3]+M[3]*k,d},ie.sub=ie.mul=void 0;var n=function(d,v){if(d&&d.__esModule)return d;if(d===null||u(d)!=="object"&&typeof d!="function")return{default:d};var M=s(void 0);if(M&&M.has(d))return M.get(d);var k={},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var E in d)if(E!=="default"&&Object.prototype.hasOwnProperty.call(d,E)){var D=j?Object.getOwnPropertyDescriptor(d,E):null;D&&(D.get||D.set)?Object.defineProperty(k,E,D):k[E]=d[E]}return k.default=d,M&&M.set(d,k),k}(H());function s(d){if(typeof WeakMap!="function")return null;var v=new WeakMap,M=new WeakMap;return(s=function(k){return k?M:v})(d)}function h(d,v,M){var k=v[0],j=v[1],E=v[2],D=v[3],B=M[0],R=M[1],z=M[2],q=M[3];return d[0]=k*B+E*R,d[1]=j*B+D*R,d[2]=k*z+E*q,d[3]=j*z+D*q,d}function y(d,v,M){return d[0]=v[0]-M[0],d[1]=v[1]-M[1],d[2]=v[2]-M[2],d[3]=v[3]-M[3],d}return ie.mul=h,ie.sub=y,ie}var ue,ge={};function Se(){if(ue)return ge;function u(d){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},u(d)}ue=1,Object.defineProperty(ge,"__esModule",{value:!0}),ge.create=function(){var d=new n.ARRAY_TYPE(6);return n.ARRAY_TYPE!=Float32Array&&(d[1]=0,d[2]=0,d[4]=0,d[5]=0),d[0]=1,d[3]=1,d},ge.clone=function(d){var v=new n.ARRAY_TYPE(6);return v[0]=d[0],v[1]=d[1],v[2]=d[2],v[3]=d[3],v[4]=d[4],v[5]=d[5],v},ge.copy=function(d,v){return d[0]=v[0],d[1]=v[1],d[2]=v[2],d[3]=v[3],d[4]=v[4],d[5]=v[5],d},ge.identity=function(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=1,d[4]=0,d[5]=0,d},ge.fromValues=function(d,v,M,k,j,E){var D=new n.ARRAY_TYPE(6);return D[0]=d,D[1]=v,D[2]=M,D[3]=k,D[4]=j,D[5]=E,D},ge.set=function(d,v,M,k,j,E,D){return d[0]=v,d[1]=M,d[2]=k,d[3]=j,d[4]=E,d[5]=D,d},ge.invert=function(d,v){var M=v[0],k=v[1],j=v[2],E=v[3],D=v[4],B=v[5],R=M*E-k*j;return R?(d[0]=E*(R=1/R),d[1]=-k*R,d[2]=-j*R,d[3]=M*R,d[4]=(j*B-E*D)*R,d[5]=(k*D-M*B)*R,d):null},ge.determinant=function(d){return d[0]*d[3]-d[1]*d[2]},ge.multiply=h,ge.rotate=function(d,v,M){var k=v[0],j=v[1],E=v[2],D=v[3],B=v[4],R=v[5],z=Math.sin(M),q=Math.cos(M);return d[0]=k*q+E*z,d[1]=j*q+D*z,d[2]=k*-z+E*q,d[3]=j*-z+D*q,d[4]=B,d[5]=R,d},ge.scale=function(d,v,M){var k=v[1],j=v[2],E=v[3],D=v[4],B=v[5],R=M[0],z=M[1];return d[0]=v[0]*R,d[1]=k*R,d[2]=j*z,d[3]=E*z,d[4]=D,d[5]=B,d},ge.translate=function(d,v,M){var k=v[0],j=v[1],E=v[2],D=v[3],B=v[4],R=v[5],z=M[0],q=M[1];return d[0]=k,d[1]=j,d[2]=E,d[3]=D,d[4]=k*z+E*q+B,d[5]=j*z+D*q+R,d},ge.fromRotation=function(d,v){var M=Math.sin(v),k=Math.cos(v);return d[0]=k,d[1]=M,d[2]=-M,d[3]=k,d[4]=0,d[5]=0,d},ge.fromScaling=function(d,v){return d[0]=v[0],d[1]=0,d[2]=0,d[3]=v[1],d[4]=0,d[5]=0,d},ge.fromTranslation=function(d,v){return d[0]=1,d[1]=0,d[2]=0,d[3]=1,d[4]=v[0],d[5]=v[1],d},ge.str=function(d){return"mat2d("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+")"},ge.frob=function(d){return Math.hypot(d[0],d[1],d[2],d[3],d[4],d[5],1)},ge.add=function(d,v,M){return d[0]=v[0]+M[0],d[1]=v[1]+M[1],d[2]=v[2]+M[2],d[3]=v[3]+M[3],d[4]=v[4]+M[4],d[5]=v[5]+M[5],d},ge.subtract=y,ge.multiplyScalar=function(d,v,M){return d[0]=v[0]*M,d[1]=v[1]*M,d[2]=v[2]*M,d[3]=v[3]*M,d[4]=v[4]*M,d[5]=v[5]*M,d},ge.multiplyScalarAndAdd=function(d,v,M,k){return d[0]=v[0]+M[0]*k,d[1]=v[1]+M[1]*k,d[2]=v[2]+M[2]*k,d[3]=v[3]+M[3]*k,d[4]=v[4]+M[4]*k,d[5]=v[5]+M[5]*k,d},ge.exactEquals=function(d,v){return d[0]===v[0]&&d[1]===v[1]&&d[2]===v[2]&&d[3]===v[3]&&d[4]===v[4]&&d[5]===v[5]},ge.equals=function(d,v){var M=d[0],k=d[1],j=d[2],E=d[3],D=d[4],B=d[5],R=v[0],z=v[1],q=v[2],W=v[3],K=v[4],oe=v[5];return Math.abs(M-R)<=n.EPSILON*Math.max(1,Math.abs(M),Math.abs(R))&&Math.abs(k-z)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(z))&&Math.abs(j-q)<=n.EPSILON*Math.max(1,Math.abs(j),Math.abs(q))&&Math.abs(E-W)<=n.EPSILON*Math.max(1,Math.abs(E),Math.abs(W))&&Math.abs(D-K)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs(K))&&Math.abs(B-oe)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(oe))},ge.sub=ge.mul=void 0;var n=function(d,v){if(d&&d.__esModule)return d;if(d===null||u(d)!=="object"&&typeof d!="function")return{default:d};var M=s(void 0);if(M&&M.has(d))return M.get(d);var k={},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var E in d)if(E!=="default"&&Object.prototype.hasOwnProperty.call(d,E)){var D=j?Object.getOwnPropertyDescriptor(d,E):null;D&&(D.get||D.set)?Object.defineProperty(k,E,D):k[E]=d[E]}return k.default=d,M&&M.set(d,k),k}(H());function s(d){if(typeof WeakMap!="function")return null;var v=new WeakMap,M=new WeakMap;return(s=function(k){return k?M:v})(d)}function h(d,v,M){var k=v[0],j=v[1],E=v[2],D=v[3],B=v[4],R=v[5],z=M[0],q=M[1],W=M[2],K=M[3],oe=M[4],se=M[5];return d[0]=k*z+E*q,d[1]=j*z+D*q,d[2]=k*W+E*K,d[3]=j*W+D*K,d[4]=k*oe+E*se+B,d[5]=j*oe+D*se+R,d}function y(d,v,M){return d[0]=v[0]-M[0],d[1]=v[1]-M[1],d[2]=v[2]-M[2],d[3]=v[3]-M[3],d[4]=v[4]-M[4],d[5]=v[5]-M[5],d}return ge.mul=h,ge.sub=y,ge}var ve,Ee={};function me(){if(ve)return Ee;function u(d){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},u(d)}ve=1,Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.create=function(){var d=new n.ARRAY_TYPE(9);return n.ARRAY_TYPE!=Float32Array&&(d[1]=0,d[2]=0,d[3]=0,d[5]=0,d[6]=0,d[7]=0),d[0]=1,d[4]=1,d[8]=1,d},Ee.fromMat4=function(d,v){return d[0]=v[0],d[1]=v[1],d[2]=v[2],d[3]=v[4],d[4]=v[5],d[5]=v[6],d[6]=v[8],d[7]=v[9],d[8]=v[10],d},Ee.clone=function(d){var v=new n.ARRAY_TYPE(9);return v[0]=d[0],v[1]=d[1],v[2]=d[2],v[3]=d[3],v[4]=d[4],v[5]=d[5],v[6]=d[6],v[7]=d[7],v[8]=d[8],v},Ee.copy=function(d,v){return d[0]=v[0],d[1]=v[1],d[2]=v[2],d[3]=v[3],d[4]=v[4],d[5]=v[5],d[6]=v[6],d[7]=v[7],d[8]=v[8],d},Ee.fromValues=function(d,v,M,k,j,E,D,B,R){var z=new n.ARRAY_TYPE(9);return z[0]=d,z[1]=v,z[2]=M,z[3]=k,z[4]=j,z[5]=E,z[6]=D,z[7]=B,z[8]=R,z},Ee.set=function(d,v,M,k,j,E,D,B,R,z){return d[0]=v,d[1]=M,d[2]=k,d[3]=j,d[4]=E,d[5]=D,d[6]=B,d[7]=R,d[8]=z,d},Ee.identity=function(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=1,d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},Ee.transpose=function(d,v){if(d===v){var M=v[1],k=v[2],j=v[5];d[1]=v[3],d[2]=v[6],d[3]=M,d[5]=v[7],d[6]=k,d[7]=j}else d[0]=v[0],d[1]=v[3],d[2]=v[6],d[3]=v[1],d[4]=v[4],d[5]=v[7],d[6]=v[2],d[7]=v[5],d[8]=v[8];return d},Ee.invert=function(d,v){var M=v[0],k=v[1],j=v[2],E=v[3],D=v[4],B=v[5],R=v[6],z=v[7],q=v[8],W=q*D-B*z,K=-q*E+B*R,oe=z*E-D*R,se=M*W+k*K+j*oe;return se?(d[0]=W*(se=1/se),d[1]=(-q*k+j*z)*se,d[2]=(B*k-j*D)*se,d[3]=K*se,d[4]=(q*M-j*R)*se,d[5]=(-B*M+j*E)*se,d[6]=oe*se,d[7]=(-z*M+k*R)*se,d[8]=(D*M-k*E)*se,d):null},Ee.adjoint=function(d,v){var M=v[0],k=v[1],j=v[2],E=v[3],D=v[4],B=v[5],R=v[6],z=v[7],q=v[8];return d[0]=D*q-B*z,d[1]=j*z-k*q,d[2]=k*B-j*D,d[3]=B*R-E*q,d[4]=M*q-j*R,d[5]=j*E-M*B,d[6]=E*z-D*R,d[7]=k*R-M*z,d[8]=M*D-k*E,d},Ee.determinant=function(d){var v=d[3],M=d[4],k=d[5],j=d[6],E=d[7],D=d[8];return d[0]*(D*M-k*E)+d[1]*(-D*v+k*j)+d[2]*(E*v-M*j)},Ee.multiply=h,Ee.translate=function(d,v,M){var k=v[0],j=v[1],E=v[2],D=v[3],B=v[4],R=v[5],z=v[6],q=v[7],W=v[8],K=M[0],oe=M[1];return d[0]=k,d[1]=j,d[2]=E,d[3]=D,d[4]=B,d[5]=R,d[6]=K*k+oe*D+z,d[7]=K*j+oe*B+q,d[8]=K*E+oe*R+W,d},Ee.rotate=function(d,v,M){var k=v[0],j=v[1],E=v[2],D=v[3],B=v[4],R=v[5],z=v[6],q=v[7],W=v[8],K=Math.sin(M),oe=Math.cos(M);return d[0]=oe*k+K*D,d[1]=oe*j+K*B,d[2]=oe*E+K*R,d[3]=oe*D-K*k,d[4]=oe*B-K*j,d[5]=oe*R-K*E,d[6]=z,d[7]=q,d[8]=W,d},Ee.scale=function(d,v,M){var k=M[0],j=M[1];return d[0]=k*v[0],d[1]=k*v[1],d[2]=k*v[2],d[3]=j*v[3],d[4]=j*v[4],d[5]=j*v[5],d[6]=v[6],d[7]=v[7],d[8]=v[8],d},Ee.fromTranslation=function(d,v){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=1,d[5]=0,d[6]=v[0],d[7]=v[1],d[8]=1,d},Ee.fromRotation=function(d,v){var M=Math.sin(v),k=Math.cos(v);return d[0]=k,d[1]=M,d[2]=0,d[3]=-M,d[4]=k,d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},Ee.fromScaling=function(d,v){return d[0]=v[0],d[1]=0,d[2]=0,d[3]=0,d[4]=v[1],d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},Ee.fromMat2d=function(d,v){return d[0]=v[0],d[1]=v[1],d[2]=0,d[3]=v[2],d[4]=v[3],d[5]=0,d[6]=v[4],d[7]=v[5],d[8]=1,d},Ee.fromQuat=function(d,v){var M=v[0],k=v[1],j=v[2],E=v[3],D=M+M,B=k+k,R=j+j,z=M*D,q=k*D,W=k*B,K=j*D,oe=j*B,se=j*R,ne=E*D,ce=E*B,pe=E*R;return d[0]=1-W-se,d[3]=q-pe,d[6]=K+ce,d[1]=q+pe,d[4]=1-z-se,d[7]=oe-ne,d[2]=K-ce,d[5]=oe+ne,d[8]=1-z-W,d},Ee.normalFromMat4=function(d,v){var M=v[0],k=v[1],j=v[2],E=v[3],D=v[4],B=v[5],R=v[6],z=v[7],q=v[8],W=v[9],K=v[10],oe=v[11],se=v[12],ne=v[13],ce=v[14],pe=v[15],we=M*B-k*D,ke=M*R-j*D,Re=M*z-E*D,Pe=k*R-j*B,We=k*z-E*B,Le=j*z-E*R,Je=q*ne-W*se,it=q*ce-K*se,tt=q*pe-oe*se,ot=W*ce-K*ne,ut=W*pe-oe*ne,pt=K*pe-oe*ce,lt=we*pt-ke*ut+Re*ot+Pe*tt-We*it+Le*Je;return lt?(d[0]=(B*pt-R*ut+z*ot)*(lt=1/lt),d[1]=(R*tt-D*pt-z*it)*lt,d[2]=(D*ut-B*tt+z*Je)*lt,d[3]=(j*ut-k*pt-E*ot)*lt,d[4]=(M*pt-j*tt+E*it)*lt,d[5]=(k*tt-M*ut-E*Je)*lt,d[6]=(ne*Le-ce*We+pe*Pe)*lt,d[7]=(ce*Re-se*Le-pe*ke)*lt,d[8]=(se*We-ne*Re+pe*we)*lt,d):null},Ee.projection=function(d,v,M){return d[0]=2/v,d[1]=0,d[2]=0,d[3]=0,d[4]=-2/M,d[5]=0,d[6]=-1,d[7]=1,d[8]=1,d},Ee.str=function(d){return"mat3("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+", "+d[6]+", "+d[7]+", "+d[8]+")"},Ee.frob=function(d){return Math.hypot(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8])},Ee.add=function(d,v,M){return d[0]=v[0]+M[0],d[1]=v[1]+M[1],d[2]=v[2]+M[2],d[3]=v[3]+M[3],d[4]=v[4]+M[4],d[5]=v[5]+M[5],d[6]=v[6]+M[6],d[7]=v[7]+M[7],d[8]=v[8]+M[8],d},Ee.subtract=y,Ee.multiplyScalar=function(d,v,M){return d[0]=v[0]*M,d[1]=v[1]*M,d[2]=v[2]*M,d[3]=v[3]*M,d[4]=v[4]*M,d[5]=v[5]*M,d[6]=v[6]*M,d[7]=v[7]*M,d[8]=v[8]*M,d},Ee.multiplyScalarAndAdd=function(d,v,M,k){return d[0]=v[0]+M[0]*k,d[1]=v[1]+M[1]*k,d[2]=v[2]+M[2]*k,d[3]=v[3]+M[3]*k,d[4]=v[4]+M[4]*k,d[5]=v[5]+M[5]*k,d[6]=v[6]+M[6]*k,d[7]=v[7]+M[7]*k,d[8]=v[8]+M[8]*k,d},Ee.exactEquals=function(d,v){return d[0]===v[0]&&d[1]===v[1]&&d[2]===v[2]&&d[3]===v[3]&&d[4]===v[4]&&d[5]===v[5]&&d[6]===v[6]&&d[7]===v[7]&&d[8]===v[8]},Ee.equals=function(d,v){var M=d[0],k=d[1],j=d[2],E=d[3],D=d[4],B=d[5],R=d[6],z=d[7],q=d[8],W=v[0],K=v[1],oe=v[2],se=v[3],ne=v[4],ce=v[5],pe=v[6],we=v[7],ke=v[8];return Math.abs(M-W)<=n.EPSILON*Math.max(1,Math.abs(M),Math.abs(W))&&Math.abs(k-K)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(K))&&Math.abs(j-oe)<=n.EPSILON*Math.max(1,Math.abs(j),Math.abs(oe))&&Math.abs(E-se)<=n.EPSILON*Math.max(1,Math.abs(E),Math.abs(se))&&Math.abs(D-ne)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs(ne))&&Math.abs(B-ce)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(ce))&&Math.abs(R-pe)<=n.EPSILON*Math.max(1,Math.abs(R),Math.abs(pe))&&Math.abs(z-we)<=n.EPSILON*Math.max(1,Math.abs(z),Math.abs(we))&&Math.abs(q-ke)<=n.EPSILON*Math.max(1,Math.abs(q),Math.abs(ke))},Ee.sub=Ee.mul=void 0;var n=function(d,v){if(d&&d.__esModule)return d;if(d===null||u(d)!=="object"&&typeof d!="function")return{default:d};var M=s(void 0);if(M&&M.has(d))return M.get(d);var k={},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var E in d)if(E!=="default"&&Object.prototype.hasOwnProperty.call(d,E)){var D=j?Object.getOwnPropertyDescriptor(d,E):null;D&&(D.get||D.set)?Object.defineProperty(k,E,D):k[E]=d[E]}return k.default=d,M&&M.set(d,k),k}(H());function s(d){if(typeof WeakMap!="function")return null;var v=new WeakMap,M=new WeakMap;return(s=function(k){return k?M:v})(d)}function h(d,v,M){var k=v[0],j=v[1],E=v[2],D=v[3],B=v[4],R=v[5],z=v[6],q=v[7],W=v[8],K=M[0],oe=M[1],se=M[2],ne=M[3],ce=M[4],pe=M[5],we=M[6],ke=M[7],Re=M[8];return d[0]=K*k+oe*D+se*z,d[1]=K*j+oe*B+se*q,d[2]=K*E+oe*R+se*W,d[3]=ne*k+ce*D+pe*z,d[4]=ne*j+ce*B+pe*q,d[5]=ne*E+ce*R+pe*W,d[6]=we*k+ke*D+Re*z,d[7]=we*j+ke*B+Re*q,d[8]=we*E+ke*R+Re*W,d}function y(d,v,M){return d[0]=v[0]-M[0],d[1]=v[1]-M[1],d[2]=v[2]-M[2],d[3]=v[3]-M[3],d[4]=v[4]-M[4],d[5]=v[5]-M[5],d[6]=v[6]-M[6],d[7]=v[7]-M[7],d[8]=v[8]-M[8],d}return Ee.mul=h,Ee.sub=y,Ee}var Ae,Oe={};function Ye(){if(Ae)return Oe;function u(E){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},u(E)}Ae=1,Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.create=function(){var E=new n.ARRAY_TYPE(16);return n.ARRAY_TYPE!=Float32Array&&(E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[11]=0,E[12]=0,E[13]=0,E[14]=0),E[0]=1,E[5]=1,E[10]=1,E[15]=1,E},Oe.clone=function(E){var D=new n.ARRAY_TYPE(16);return D[0]=E[0],D[1]=E[1],D[2]=E[2],D[3]=E[3],D[4]=E[4],D[5]=E[5],D[6]=E[6],D[7]=E[7],D[8]=E[8],D[9]=E[9],D[10]=E[10],D[11]=E[11],D[12]=E[12],D[13]=E[13],D[14]=E[14],D[15]=E[15],D},Oe.copy=function(E,D){return E[0]=D[0],E[1]=D[1],E[2]=D[2],E[3]=D[3],E[4]=D[4],E[5]=D[5],E[6]=D[6],E[7]=D[7],E[8]=D[8],E[9]=D[9],E[10]=D[10],E[11]=D[11],E[12]=D[12],E[13]=D[13],E[14]=D[14],E[15]=D[15],E},Oe.fromValues=function(E,D,B,R,z,q,W,K,oe,se,ne,ce,pe,we,ke,Re){var Pe=new n.ARRAY_TYPE(16);return Pe[0]=E,Pe[1]=D,Pe[2]=B,Pe[3]=R,Pe[4]=z,Pe[5]=q,Pe[6]=W,Pe[7]=K,Pe[8]=oe,Pe[9]=se,Pe[10]=ne,Pe[11]=ce,Pe[12]=pe,Pe[13]=we,Pe[14]=ke,Pe[15]=Re,Pe},Oe.set=function(E,D,B,R,z,q,W,K,oe,se,ne,ce,pe,we,ke,Re,Pe){return E[0]=D,E[1]=B,E[2]=R,E[3]=z,E[4]=q,E[5]=W,E[6]=K,E[7]=oe,E[8]=se,E[9]=ne,E[10]=ce,E[11]=pe,E[12]=we,E[13]=ke,E[14]=Re,E[15]=Pe,E},Oe.identity=h,Oe.transpose=function(E,D){if(E===D){var B=D[1],R=D[2],z=D[3],q=D[6],W=D[7],K=D[11];E[1]=D[4],E[2]=D[8],E[3]=D[12],E[4]=B,E[6]=D[9],E[7]=D[13],E[8]=R,E[9]=q,E[11]=D[14],E[12]=z,E[13]=W,E[14]=K}else E[0]=D[0],E[1]=D[4],E[2]=D[8],E[3]=D[12],E[4]=D[1],E[5]=D[5],E[6]=D[9],E[7]=D[13],E[8]=D[2],E[9]=D[6],E[10]=D[10],E[11]=D[14],E[12]=D[3],E[13]=D[7],E[14]=D[11],E[15]=D[15];return E},Oe.invert=function(E,D){var B=D[0],R=D[1],z=D[2],q=D[3],W=D[4],K=D[5],oe=D[6],se=D[7],ne=D[8],ce=D[9],pe=D[10],we=D[11],ke=D[12],Re=D[13],Pe=D[14],We=D[15],Le=B*K-R*W,Je=B*oe-z*W,it=B*se-q*W,tt=R*oe-z*K,ot=R*se-q*K,ut=z*se-q*oe,pt=ne*Re-ce*ke,lt=ne*Pe-pe*ke,Lt=ne*We-we*ke,Wt=ce*Pe-pe*Re,Rt=ce*We-we*Re,xn=pe*We-we*Pe,mn=Le*xn-Je*Rt+it*Wt+tt*Lt-ot*lt+ut*pt;return mn?(E[0]=(K*xn-oe*Rt+se*Wt)*(mn=1/mn),E[1]=(z*Rt-R*xn-q*Wt)*mn,E[2]=(Re*ut-Pe*ot+We*tt)*mn,E[3]=(pe*ot-ce*ut-we*tt)*mn,E[4]=(oe*Lt-W*xn-se*lt)*mn,E[5]=(B*xn-z*Lt+q*lt)*mn,E[6]=(Pe*it-ke*ut-We*Je)*mn,E[7]=(ne*ut-pe*it+we*Je)*mn,E[8]=(W*Rt-K*Lt+se*pt)*mn,E[9]=(R*Lt-B*Rt-q*pt)*mn,E[10]=(ke*ot-Re*it+We*Le)*mn,E[11]=(ce*it-ne*ot-we*Le)*mn,E[12]=(K*lt-W*Wt-oe*pt)*mn,E[13]=(B*Wt-R*lt+z*pt)*mn,E[14]=(Re*Je-ke*tt-Pe*Le)*mn,E[15]=(ne*tt-ce*Je+pe*Le)*mn,E):null},Oe.adjoint=function(E,D){var B=D[0],R=D[1],z=D[2],q=D[3],W=D[4],K=D[5],oe=D[6],se=D[7],ne=D[8],ce=D[9],pe=D[10],we=D[11],ke=D[12],Re=D[13],Pe=D[14],We=D[15];return E[0]=K*(pe*We-we*Pe)-ce*(oe*We-se*Pe)+Re*(oe*we-se*pe),E[1]=-(R*(pe*We-we*Pe)-ce*(z*We-q*Pe)+Re*(z*we-q*pe)),E[2]=R*(oe*We-se*Pe)-K*(z*We-q*Pe)+Re*(z*se-q*oe),E[3]=-(R*(oe*we-se*pe)-K*(z*we-q*pe)+ce*(z*se-q*oe)),E[4]=-(W*(pe*We-we*Pe)-ne*(oe*We-se*Pe)+ke*(oe*we-se*pe)),E[5]=B*(pe*We-we*Pe)-ne*(z*We-q*Pe)+ke*(z*we-q*pe),E[6]=-(B*(oe*We-se*Pe)-W*(z*We-q*Pe)+ke*(z*se-q*oe)),E[7]=B*(oe*we-se*pe)-W*(z*we-q*pe)+ne*(z*se-q*oe),E[8]=W*(ce*We-we*Re)-ne*(K*We-se*Re)+ke*(K*we-se*ce),E[9]=-(B*(ce*We-we*Re)-ne*(R*We-q*Re)+ke*(R*we-q*ce)),E[10]=B*(K*We-se*Re)-W*(R*We-q*Re)+ke*(R*se-q*K),E[11]=-(B*(K*we-se*ce)-W*(R*we-q*ce)+ne*(R*se-q*K)),E[12]=-(W*(ce*Pe-pe*Re)-ne*(K*Pe-oe*Re)+ke*(K*pe-oe*ce)),E[13]=B*(ce*Pe-pe*Re)-ne*(R*Pe-z*Re)+ke*(R*pe-z*ce),E[14]=-(B*(K*Pe-oe*Re)-W*(R*Pe-z*Re)+ke*(R*oe-z*K)),E[15]=B*(K*pe-oe*ce)-W*(R*pe-z*ce)+ne*(R*oe-z*K),E},Oe.determinant=function(E){var D=E[0],B=E[1],R=E[2],z=E[3],q=E[4],W=E[5],K=E[6],oe=E[7],se=E[8],ne=E[9],ce=E[10],pe=E[11],we=E[12],ke=E[13],Re=E[14],Pe=E[15];return(D*W-B*q)*(ce*Pe-pe*Re)-(D*K-R*q)*(ne*Pe-pe*ke)+(D*oe-z*q)*(ne*Re-ce*ke)+(B*K-R*W)*(se*Pe-pe*we)-(B*oe-z*W)*(se*Re-ce*we)+(R*oe-z*K)*(se*ke-ne*we)},Oe.multiply=y,Oe.translate=function(E,D,B){var R,z,q,W,K,oe,se,ne,ce,pe,we,ke,Re=B[0],Pe=B[1],We=B[2];return D===E?(E[12]=D[0]*Re+D[4]*Pe+D[8]*We+D[12],E[13]=D[1]*Re+D[5]*Pe+D[9]*We+D[13],E[14]=D[2]*Re+D[6]*Pe+D[10]*We+D[14],E[15]=D[3]*Re+D[7]*Pe+D[11]*We+D[15]):(z=D[1],q=D[2],W=D[3],K=D[4],oe=D[5],se=D[6],ne=D[7],ce=D[8],pe=D[9],we=D[10],ke=D[11],E[0]=R=D[0],E[1]=z,E[2]=q,E[3]=W,E[4]=K,E[5]=oe,E[6]=se,E[7]=ne,E[8]=ce,E[9]=pe,E[10]=we,E[11]=ke,E[12]=R*Re+K*Pe+ce*We+D[12],E[13]=z*Re+oe*Pe+pe*We+D[13],E[14]=q*Re+se*Pe+we*We+D[14],E[15]=W*Re+ne*Pe+ke*We+D[15]),E},Oe.scale=function(E,D,B){var R=B[0],z=B[1],q=B[2];return E[0]=D[0]*R,E[1]=D[1]*R,E[2]=D[2]*R,E[3]=D[3]*R,E[4]=D[4]*z,E[5]=D[5]*z,E[6]=D[6]*z,E[7]=D[7]*z,E[8]=D[8]*q,E[9]=D[9]*q,E[10]=D[10]*q,E[11]=D[11]*q,E[12]=D[12],E[13]=D[13],E[14]=D[14],E[15]=D[15],E},Oe.rotate=function(E,D,B,R){var z,q,W,K,oe,se,ne,ce,pe,we,ke,Re,Pe,We,Le,Je,it,tt,ot,ut,pt,lt,Lt,Wt,Rt=R[0],xn=R[1],mn=R[2],on=Math.hypot(Rt,xn,mn);return on<n.EPSILON?null:(Rt*=on=1/on,xn*=on,mn*=on,z=Math.sin(B),q=Math.cos(B),oe=D[1],se=D[2],ne=D[3],pe=D[5],we=D[6],ke=D[7],Pe=D[9],We=D[10],Le=D[11],Je=Rt*Rt*(W=1-q)+q,ot=Rt*xn*W-mn*z,ut=xn*xn*W+q,pt=mn*xn*W+Rt*z,lt=Rt*mn*W+xn*z,Lt=xn*mn*W-Rt*z,Wt=mn*mn*W+q,E[0]=(K=D[0])*Je+(ce=D[4])*(it=xn*Rt*W+mn*z)+(Re=D[8])*(tt=mn*Rt*W-xn*z),E[1]=oe*Je+pe*it+Pe*tt,E[2]=se*Je+we*it+We*tt,E[3]=ne*Je+ke*it+Le*tt,E[4]=K*ot+ce*ut+Re*pt,E[5]=oe*ot+pe*ut+Pe*pt,E[6]=se*ot+we*ut+We*pt,E[7]=ne*ot+ke*ut+Le*pt,E[8]=K*lt+ce*Lt+Re*Wt,E[9]=oe*lt+pe*Lt+Pe*Wt,E[10]=se*lt+we*Lt+We*Wt,E[11]=ne*lt+ke*Lt+Le*Wt,D!==E&&(E[12]=D[12],E[13]=D[13],E[14]=D[14],E[15]=D[15]),E)},Oe.rotateX=function(E,D,B){var R=Math.sin(B),z=Math.cos(B),q=D[4],W=D[5],K=D[6],oe=D[7],se=D[8],ne=D[9],ce=D[10],pe=D[11];return D!==E&&(E[0]=D[0],E[1]=D[1],E[2]=D[2],E[3]=D[3],E[12]=D[12],E[13]=D[13],E[14]=D[14],E[15]=D[15]),E[4]=q*z+se*R,E[5]=W*z+ne*R,E[6]=K*z+ce*R,E[7]=oe*z+pe*R,E[8]=se*z-q*R,E[9]=ne*z-W*R,E[10]=ce*z-K*R,E[11]=pe*z-oe*R,E},Oe.rotateY=function(E,D,B){var R=Math.sin(B),z=Math.cos(B),q=D[0],W=D[1],K=D[2],oe=D[3],se=D[8],ne=D[9],ce=D[10],pe=D[11];return D!==E&&(E[4]=D[4],E[5]=D[5],E[6]=D[6],E[7]=D[7],E[12]=D[12],E[13]=D[13],E[14]=D[14],E[15]=D[15]),E[0]=q*z-se*R,E[1]=W*z-ne*R,E[2]=K*z-ce*R,E[3]=oe*z-pe*R,E[8]=q*R+se*z,E[9]=W*R+ne*z,E[10]=K*R+ce*z,E[11]=oe*R+pe*z,E},Oe.rotateZ=function(E,D,B){var R=Math.sin(B),z=Math.cos(B),q=D[0],W=D[1],K=D[2],oe=D[3],se=D[4],ne=D[5],ce=D[6],pe=D[7];return D!==E&&(E[8]=D[8],E[9]=D[9],E[10]=D[10],E[11]=D[11],E[12]=D[12],E[13]=D[13],E[14]=D[14],E[15]=D[15]),E[0]=q*z+se*R,E[1]=W*z+ne*R,E[2]=K*z+ce*R,E[3]=oe*z+pe*R,E[4]=se*z-q*R,E[5]=ne*z-W*R,E[6]=ce*z-K*R,E[7]=pe*z-oe*R,E},Oe.fromTranslation=function(E,D){return E[0]=1,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=1,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=1,E[11]=0,E[12]=D[0],E[13]=D[1],E[14]=D[2],E[15]=1,E},Oe.fromScaling=function(E,D){return E[0]=D[0],E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=D[1],E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=D[2],E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E},Oe.fromRotation=function(E,D,B){var R,z,q,W=B[0],K=B[1],oe=B[2],se=Math.hypot(W,K,oe);return se<n.EPSILON?null:(W*=se=1/se,K*=se,oe*=se,R=Math.sin(D),z=Math.cos(D),E[0]=W*W*(q=1-z)+z,E[1]=K*W*q+oe*R,E[2]=oe*W*q-K*R,E[3]=0,E[4]=W*K*q-oe*R,E[5]=K*K*q+z,E[6]=oe*K*q+W*R,E[7]=0,E[8]=W*oe*q+K*R,E[9]=K*oe*q-W*R,E[10]=oe*oe*q+z,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E)},Oe.fromXRotation=function(E,D){var B=Math.sin(D),R=Math.cos(D);return E[0]=1,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=R,E[6]=B,E[7]=0,E[8]=0,E[9]=-B,E[10]=R,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E},Oe.fromYRotation=function(E,D){var B=Math.sin(D),R=Math.cos(D);return E[0]=R,E[1]=0,E[2]=-B,E[3]=0,E[4]=0,E[5]=1,E[6]=0,E[7]=0,E[8]=B,E[9]=0,E[10]=R,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E},Oe.fromZRotation=function(E,D){var B=Math.sin(D),R=Math.cos(D);return E[0]=R,E[1]=B,E[2]=0,E[3]=0,E[4]=-B,E[5]=R,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=1,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E},Oe.fromRotationTranslation=d,Oe.fromQuat2=function(E,D){var B=new n.ARRAY_TYPE(3),R=-D[0],z=-D[1],q=-D[2],W=D[3],K=D[4],oe=D[5],se=D[6],ne=D[7],ce=R*R+z*z+q*q+W*W;return ce>0?(B[0]=2*(K*W+ne*R+oe*q-se*z)/ce,B[1]=2*(oe*W+ne*z+se*R-K*q)/ce,B[2]=2*(se*W+ne*q+K*z-oe*R)/ce):(B[0]=2*(K*W+ne*R+oe*q-se*z),B[1]=2*(oe*W+ne*z+se*R-K*q),B[2]=2*(se*W+ne*q+K*z-oe*R)),d(E,D,B),E},Oe.getTranslation=function(E,D){return E[0]=D[12],E[1]=D[13],E[2]=D[14],E},Oe.getScaling=v,Oe.getRotation=function(E,D){var B=new n.ARRAY_TYPE(3);v(B,D);var R=1/B[0],z=1/B[1],q=1/B[2],W=D[0]*R,K=D[1]*z,oe=D[2]*q,se=D[4]*R,ne=D[5]*z,ce=D[6]*q,pe=D[8]*R,we=D[9]*z,ke=D[10]*q,Re=W+ne+ke,Pe=0;return Re>0?(Pe=2*Math.sqrt(Re+1),E[3]=.25*Pe,E[0]=(ce-we)/Pe,E[1]=(pe-oe)/Pe,E[2]=(K-se)/Pe):W>ne&&W>ke?(Pe=2*Math.sqrt(1+W-ne-ke),E[3]=(ce-we)/Pe,E[0]=.25*Pe,E[1]=(K+se)/Pe,E[2]=(pe+oe)/Pe):ne>ke?(Pe=2*Math.sqrt(1+ne-W-ke),E[3]=(pe-oe)/Pe,E[0]=(K+se)/Pe,E[1]=.25*Pe,E[2]=(ce+we)/Pe):(Pe=2*Math.sqrt(1+ke-W-ne),E[3]=(K-se)/Pe,E[0]=(pe+oe)/Pe,E[1]=(ce+we)/Pe,E[2]=.25*Pe),E},Oe.fromRotationTranslationScale=function(E,D,B,R){var z=D[0],q=D[1],W=D[2],K=D[3],oe=z+z,se=q+q,ne=W+W,ce=z*oe,pe=z*se,we=z*ne,ke=q*se,Re=q*ne,Pe=W*ne,We=K*oe,Le=K*se,Je=K*ne,it=R[0],tt=R[1],ot=R[2];return E[0]=(1-(ke+Pe))*it,E[1]=(pe+Je)*it,E[2]=(we-Le)*it,E[3]=0,E[4]=(pe-Je)*tt,E[5]=(1-(ce+Pe))*tt,E[6]=(Re+We)*tt,E[7]=0,E[8]=(we+Le)*ot,E[9]=(Re-We)*ot,E[10]=(1-(ce+ke))*ot,E[11]=0,E[12]=B[0],E[13]=B[1],E[14]=B[2],E[15]=1,E},Oe.fromRotationTranslationScaleOrigin=function(E,D,B,R,z){var q=D[0],W=D[1],K=D[2],oe=D[3],se=q+q,ne=W+W,ce=K+K,pe=q*se,we=q*ne,ke=q*ce,Re=W*ne,Pe=W*ce,We=K*ce,Le=oe*se,Je=oe*ne,it=oe*ce,tt=R[0],ot=R[1],ut=R[2],pt=z[0],lt=z[1],Lt=z[2],Wt=(1-(Re+We))*tt,Rt=(we+it)*tt,xn=(ke-Je)*tt,mn=(we-it)*ot,on=(1-(pe+We))*ot,en=(Pe+Le)*ot,zn=(ke+Je)*ut,Tn=(Pe-Le)*ut,Pn=(1-(pe+Re))*ut;return E[0]=Wt,E[1]=Rt,E[2]=xn,E[3]=0,E[4]=mn,E[5]=on,E[6]=en,E[7]=0,E[8]=zn,E[9]=Tn,E[10]=Pn,E[11]=0,E[12]=B[0]+pt-(Wt*pt+mn*lt+zn*Lt),E[13]=B[1]+lt-(Rt*pt+on*lt+Tn*Lt),E[14]=B[2]+Lt-(xn*pt+en*lt+Pn*Lt),E[15]=1,E},Oe.fromQuat=function(E,D){var B=D[0],R=D[1],z=D[2],q=D[3],W=B+B,K=R+R,oe=z+z,se=B*W,ne=R*W,ce=R*K,pe=z*W,we=z*K,ke=z*oe,Re=q*W,Pe=q*K,We=q*oe;return E[0]=1-ce-ke,E[1]=ne+We,E[2]=pe-Pe,E[3]=0,E[4]=ne-We,E[5]=1-se-ke,E[6]=we+Re,E[7]=0,E[8]=pe+Pe,E[9]=we-Re,E[10]=1-se-ce,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E},Oe.frustum=function(E,D,B,R,z,q,W){var K=1/(B-D),oe=1/(z-R),se=1/(q-W);return E[0]=2*q*K,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=2*q*oe,E[6]=0,E[7]=0,E[8]=(B+D)*K,E[9]=(z+R)*oe,E[10]=(W+q)*se,E[11]=-1,E[12]=0,E[13]=0,E[14]=W*q*2*se,E[15]=0,E},Oe.perspectiveNO=M,Oe.perspectiveZO=function(E,D,B,R,z){var q,W=1/Math.tan(D/2);return E[0]=W/B,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=W,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[11]=-1,E[12]=0,E[13]=0,E[15]=0,z!=null&&z!==1/0?(E[10]=z*(q=1/(R-z)),E[14]=z*R*q):(E[10]=-1,E[14]=-R),E},Oe.perspectiveFromFieldOfView=function(E,D,B,R){var z=Math.tan(D.upDegrees*Math.PI/180),q=Math.tan(D.downDegrees*Math.PI/180),W=Math.tan(D.leftDegrees*Math.PI/180),K=Math.tan(D.rightDegrees*Math.PI/180),oe=2/(W+K),se=2/(z+q);return E[0]=oe,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=se,E[6]=0,E[7]=0,E[8]=-(W-K)*oe*.5,E[9]=(z-q)*se*.5,E[10]=R/(B-R),E[11]=-1,E[12]=0,E[13]=0,E[14]=R*B/(B-R),E[15]=0,E},Oe.orthoNO=k,Oe.orthoZO=function(E,D,B,R,z,q,W){var K=1/(D-B),oe=1/(R-z),se=1/(q-W);return E[0]=-2*K,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=-2*oe,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=se,E[11]=0,E[12]=(D+B)*K,E[13]=(z+R)*oe,E[14]=q*se,E[15]=1,E},Oe.lookAt=function(E,D,B,R){var z,q,W,K,oe,se,ne,ce,pe,we,ke=D[0],Re=D[1],Pe=D[2],We=R[0],Le=R[1],Je=R[2],it=B[0],tt=B[1],ot=B[2];return Math.abs(ke-it)<n.EPSILON&&Math.abs(Re-tt)<n.EPSILON&&Math.abs(Pe-ot)<n.EPSILON?h(E):(ne=ke-it,ce=Re-tt,pe=Pe-ot,z=Le*(pe*=we=1/Math.hypot(ne,ce,pe))-Je*(ce*=we),q=Je*(ne*=we)-We*pe,W=We*ce-Le*ne,(we=Math.hypot(z,q,W))?(z*=we=1/we,q*=we,W*=we):(z=0,q=0,W=0),K=ce*W-pe*q,oe=pe*z-ne*W,se=ne*q-ce*z,(we=Math.hypot(K,oe,se))?(K*=we=1/we,oe*=we,se*=we):(K=0,oe=0,se=0),E[0]=z,E[1]=K,E[2]=ne,E[3]=0,E[4]=q,E[5]=oe,E[6]=ce,E[7]=0,E[8]=W,E[9]=se,E[10]=pe,E[11]=0,E[12]=-(z*ke+q*Re+W*Pe),E[13]=-(K*ke+oe*Re+se*Pe),E[14]=-(ne*ke+ce*Re+pe*Pe),E[15]=1,E)},Oe.targetTo=function(E,D,B,R){var z=D[0],q=D[1],W=D[2],K=R[0],oe=R[1],se=R[2],ne=z-B[0],ce=q-B[1],pe=W-B[2],we=ne*ne+ce*ce+pe*pe;we>0&&(ne*=we=1/Math.sqrt(we),ce*=we,pe*=we);var ke=oe*pe-se*ce,Re=se*ne-K*pe,Pe=K*ce-oe*ne;return(we=ke*ke+Re*Re+Pe*Pe)>0&&(ke*=we=1/Math.sqrt(we),Re*=we,Pe*=we),E[0]=ke,E[1]=Re,E[2]=Pe,E[3]=0,E[4]=ce*Pe-pe*Re,E[5]=pe*ke-ne*Pe,E[6]=ne*Re-ce*ke,E[7]=0,E[8]=ne,E[9]=ce,E[10]=pe,E[11]=0,E[12]=z,E[13]=q,E[14]=W,E[15]=1,E},Oe.str=function(E){return"mat4("+E[0]+", "+E[1]+", "+E[2]+", "+E[3]+", "+E[4]+", "+E[5]+", "+E[6]+", "+E[7]+", "+E[8]+", "+E[9]+", "+E[10]+", "+E[11]+", "+E[12]+", "+E[13]+", "+E[14]+", "+E[15]+")"},Oe.frob=function(E){return Math.hypot(E[0],E[1],E[2],E[3],E[4],E[5],E[6],E[7],E[8],E[9],E[10],E[11],E[12],E[13],E[14],E[15])},Oe.add=function(E,D,B){return E[0]=D[0]+B[0],E[1]=D[1]+B[1],E[2]=D[2]+B[2],E[3]=D[3]+B[3],E[4]=D[4]+B[4],E[5]=D[5]+B[5],E[6]=D[6]+B[6],E[7]=D[7]+B[7],E[8]=D[8]+B[8],E[9]=D[9]+B[9],E[10]=D[10]+B[10],E[11]=D[11]+B[11],E[12]=D[12]+B[12],E[13]=D[13]+B[13],E[14]=D[14]+B[14],E[15]=D[15]+B[15],E},Oe.subtract=j,Oe.multiplyScalar=function(E,D,B){return E[0]=D[0]*B,E[1]=D[1]*B,E[2]=D[2]*B,E[3]=D[3]*B,E[4]=D[4]*B,E[5]=D[5]*B,E[6]=D[6]*B,E[7]=D[7]*B,E[8]=D[8]*B,E[9]=D[9]*B,E[10]=D[10]*B,E[11]=D[11]*B,E[12]=D[12]*B,E[13]=D[13]*B,E[14]=D[14]*B,E[15]=D[15]*B,E},Oe.multiplyScalarAndAdd=function(E,D,B,R){return E[0]=D[0]+B[0]*R,E[1]=D[1]+B[1]*R,E[2]=D[2]+B[2]*R,E[3]=D[3]+B[3]*R,E[4]=D[4]+B[4]*R,E[5]=D[5]+B[5]*R,E[6]=D[6]+B[6]*R,E[7]=D[7]+B[7]*R,E[8]=D[8]+B[8]*R,E[9]=D[9]+B[9]*R,E[10]=D[10]+B[10]*R,E[11]=D[11]+B[11]*R,E[12]=D[12]+B[12]*R,E[13]=D[13]+B[13]*R,E[14]=D[14]+B[14]*R,E[15]=D[15]+B[15]*R,E},Oe.exactEquals=function(E,D){return E[0]===D[0]&&E[1]===D[1]&&E[2]===D[2]&&E[3]===D[3]&&E[4]===D[4]&&E[5]===D[5]&&E[6]===D[6]&&E[7]===D[7]&&E[8]===D[8]&&E[9]===D[9]&&E[10]===D[10]&&E[11]===D[11]&&E[12]===D[12]&&E[13]===D[13]&&E[14]===D[14]&&E[15]===D[15]},Oe.equals=function(E,D){var B=E[0],R=E[1],z=E[2],q=E[3],W=E[4],K=E[5],oe=E[6],se=E[7],ne=E[8],ce=E[9],pe=E[10],we=E[11],ke=E[12],Re=E[13],Pe=E[14],We=E[15],Le=D[0],Je=D[1],it=D[2],tt=D[3],ot=D[4],ut=D[5],pt=D[6],lt=D[7],Lt=D[8],Wt=D[9],Rt=D[10],xn=D[11],mn=D[12],on=D[13],en=D[14],zn=D[15];return Math.abs(B-Le)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(Le))&&Math.abs(R-Je)<=n.EPSILON*Math.max(1,Math.abs(R),Math.abs(Je))&&Math.abs(z-it)<=n.EPSILON*Math.max(1,Math.abs(z),Math.abs(it))&&Math.abs(q-tt)<=n.EPSILON*Math.max(1,Math.abs(q),Math.abs(tt))&&Math.abs(W-ot)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(ot))&&Math.abs(K-ut)<=n.EPSILON*Math.max(1,Math.abs(K),Math.abs(ut))&&Math.abs(oe-pt)<=n.EPSILON*Math.max(1,Math.abs(oe),Math.abs(pt))&&Math.abs(se-lt)<=n.EPSILON*Math.max(1,Math.abs(se),Math.abs(lt))&&Math.abs(ne-Lt)<=n.EPSILON*Math.max(1,Math.abs(ne),Math.abs(Lt))&&Math.abs(ce-Wt)<=n.EPSILON*Math.max(1,Math.abs(ce),Math.abs(Wt))&&Math.abs(pe-Rt)<=n.EPSILON*Math.max(1,Math.abs(pe),Math.abs(Rt))&&Math.abs(we-xn)<=n.EPSILON*Math.max(1,Math.abs(we),Math.abs(xn))&&Math.abs(ke-mn)<=n.EPSILON*Math.max(1,Math.abs(ke),Math.abs(mn))&&Math.abs(Re-on)<=n.EPSILON*Math.max(1,Math.abs(Re),Math.abs(on))&&Math.abs(Pe-en)<=n.EPSILON*Math.max(1,Math.abs(Pe),Math.abs(en))&&Math.abs(We-zn)<=n.EPSILON*Math.max(1,Math.abs(We),Math.abs(zn))},Oe.sub=Oe.mul=Oe.ortho=Oe.perspective=void 0;var n=function(E,D){if(E&&E.__esModule)return E;if(E===null||u(E)!=="object"&&typeof E!="function")return{default:E};var B=s(void 0);if(B&&B.has(E))return B.get(E);var R={},z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var q in E)if(q!=="default"&&Object.prototype.hasOwnProperty.call(E,q)){var W=z?Object.getOwnPropertyDescriptor(E,q):null;W&&(W.get||W.set)?Object.defineProperty(R,q,W):R[q]=E[q]}return R.default=E,B&&B.set(E,R),R}(H());function s(E){if(typeof WeakMap!="function")return null;var D=new WeakMap,B=new WeakMap;return(s=function(R){return R?B:D})(E)}function h(E){return E[0]=1,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=1,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=1,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E}function y(E,D,B){var R=D[0],z=D[1],q=D[2],W=D[3],K=D[4],oe=D[5],se=D[6],ne=D[7],ce=D[8],pe=D[9],we=D[10],ke=D[11],Re=D[12],Pe=D[13],We=D[14],Le=D[15],Je=B[0],it=B[1],tt=B[2],ot=B[3];return E[0]=Je*R+it*K+tt*ce+ot*Re,E[1]=Je*z+it*oe+tt*pe+ot*Pe,E[2]=Je*q+it*se+tt*we+ot*We,E[3]=Je*W+it*ne+tt*ke+ot*Le,E[4]=(Je=B[4])*R+(it=B[5])*K+(tt=B[6])*ce+(ot=B[7])*Re,E[5]=Je*z+it*oe+tt*pe+ot*Pe,E[6]=Je*q+it*se+tt*we+ot*We,E[7]=Je*W+it*ne+tt*ke+ot*Le,E[8]=(Je=B[8])*R+(it=B[9])*K+(tt=B[10])*ce+(ot=B[11])*Re,E[9]=Je*z+it*oe+tt*pe+ot*Pe,E[10]=Je*q+it*se+tt*we+ot*We,E[11]=Je*W+it*ne+tt*ke+ot*Le,E[12]=(Je=B[12])*R+(it=B[13])*K+(tt=B[14])*ce+(ot=B[15])*Re,E[13]=Je*z+it*oe+tt*pe+ot*Pe,E[14]=Je*q+it*se+tt*we+ot*We,E[15]=Je*W+it*ne+tt*ke+ot*Le,E}function d(E,D,B){var R=D[0],z=D[1],q=D[2],W=D[3],K=R+R,oe=z+z,se=q+q,ne=R*K,ce=R*oe,pe=R*se,we=z*oe,ke=z*se,Re=q*se,Pe=W*K,We=W*oe,Le=W*se;return E[0]=1-(we+Re),E[1]=ce+Le,E[2]=pe-We,E[3]=0,E[4]=ce-Le,E[5]=1-(ne+Re),E[6]=ke+Pe,E[7]=0,E[8]=pe+We,E[9]=ke-Pe,E[10]=1-(ne+we),E[11]=0,E[12]=B[0],E[13]=B[1],E[14]=B[2],E[15]=1,E}function v(E,D){var B=D[4],R=D[5],z=D[6],q=D[8],W=D[9],K=D[10];return E[0]=Math.hypot(D[0],D[1],D[2]),E[1]=Math.hypot(B,R,z),E[2]=Math.hypot(q,W,K),E}function M(E,D,B,R,z){var q,W=1/Math.tan(D/2);return E[0]=W/B,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=W,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[11]=-1,E[12]=0,E[13]=0,E[15]=0,z!=null&&z!==1/0?(E[10]=(z+R)*(q=1/(R-z)),E[14]=2*z*R*q):(E[10]=-1,E[14]=-2*R),E}function k(E,D,B,R,z,q,W){var K=1/(D-B),oe=1/(R-z),se=1/(q-W);return E[0]=-2*K,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=-2*oe,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=2*se,E[11]=0,E[12]=(D+B)*K,E[13]=(z+R)*oe,E[14]=(W+q)*se,E[15]=1,E}function j(E,D,B){return E[0]=D[0]-B[0],E[1]=D[1]-B[1],E[2]=D[2]-B[2],E[3]=D[3]-B[3],E[4]=D[4]-B[4],E[5]=D[5]-B[5],E[6]=D[6]-B[6],E[7]=D[7]-B[7],E[8]=D[8]-B[8],E[9]=D[9]-B[9],E[10]=D[10]-B[10],E[11]=D[11]-B[11],E[12]=D[12]-B[12],E[13]=D[13]-B[13],E[14]=D[14]-B[14],E[15]=D[15]-B[15],E}return Oe.perspective=M,Oe.ortho=k,Oe.mul=y,Oe.sub=j,Oe}var He,st={},Ke={};function Ot(){if(He)return Ke;function u(z){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(q){return typeof q}:function(q){return q&&typeof Symbol=="function"&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":typeof q},u(z)}He=1,Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.create=h,Ke.clone=function(z){var q=new n.ARRAY_TYPE(3);return q[0]=z[0],q[1]=z[1],q[2]=z[2],q},Ke.length=y,Ke.fromValues=function(z,q,W){var K=new n.ARRAY_TYPE(3);return K[0]=z,K[1]=q,K[2]=W,K},Ke.copy=function(z,q){return z[0]=q[0],z[1]=q[1],z[2]=q[2],z},Ke.set=function(z,q,W,K){return z[0]=q,z[1]=W,z[2]=K,z},Ke.add=function(z,q,W){return z[0]=q[0]+W[0],z[1]=q[1]+W[1],z[2]=q[2]+W[2],z},Ke.subtract=d,Ke.multiply=v,Ke.divide=M,Ke.ceil=function(z,q){return z[0]=Math.ceil(q[0]),z[1]=Math.ceil(q[1]),z[2]=Math.ceil(q[2]),z},Ke.floor=function(z,q){return z[0]=Math.floor(q[0]),z[1]=Math.floor(q[1]),z[2]=Math.floor(q[2]),z},Ke.min=function(z,q,W){return z[0]=Math.min(q[0],W[0]),z[1]=Math.min(q[1],W[1]),z[2]=Math.min(q[2],W[2]),z},Ke.max=function(z,q,W){return z[0]=Math.max(q[0],W[0]),z[1]=Math.max(q[1],W[1]),z[2]=Math.max(q[2],W[2]),z},Ke.round=function(z,q){return z[0]=Math.round(q[0]),z[1]=Math.round(q[1]),z[2]=Math.round(q[2]),z},Ke.scale=function(z,q,W){return z[0]=q[0]*W,z[1]=q[1]*W,z[2]=q[2]*W,z},Ke.scaleAndAdd=function(z,q,W,K){return z[0]=q[0]+W[0]*K,z[1]=q[1]+W[1]*K,z[2]=q[2]+W[2]*K,z},Ke.distance=k,Ke.squaredDistance=j,Ke.squaredLength=E,Ke.negate=function(z,q){return z[0]=-q[0],z[1]=-q[1],z[2]=-q[2],z},Ke.inverse=function(z,q){return z[0]=1/q[0],z[1]=1/q[1],z[2]=1/q[2],z},Ke.normalize=function(z,q){var W=q[0],K=q[1],oe=q[2],se=W*W+K*K+oe*oe;return se>0&&(se=1/Math.sqrt(se)),z[0]=q[0]*se,z[1]=q[1]*se,z[2]=q[2]*se,z},Ke.dot=D,Ke.cross=function(z,q,W){var K=q[0],oe=q[1],se=q[2],ne=W[0],ce=W[1],pe=W[2];return z[0]=oe*pe-se*ce,z[1]=se*ne-K*pe,z[2]=K*ce-oe*ne,z},Ke.lerp=function(z,q,W,K){var oe=q[0],se=q[1],ne=q[2];return z[0]=oe+K*(W[0]-oe),z[1]=se+K*(W[1]-se),z[2]=ne+K*(W[2]-ne),z},Ke.hermite=function(z,q,W,K,oe,se){var ne=se*se,ce=ne*(2*se-3)+1,pe=ne*(se-2)+se,we=ne*(se-1),ke=ne*(3-2*se);return z[0]=q[0]*ce+W[0]*pe+K[0]*we+oe[0]*ke,z[1]=q[1]*ce+W[1]*pe+K[1]*we+oe[1]*ke,z[2]=q[2]*ce+W[2]*pe+K[2]*we+oe[2]*ke,z},Ke.bezier=function(z,q,W,K,oe,se){var ne=1-se,ce=ne*ne,pe=se*se,we=ce*ne,ke=3*se*ce,Re=3*pe*ne,Pe=pe*se;return z[0]=q[0]*we+W[0]*ke+K[0]*Re+oe[0]*Pe,z[1]=q[1]*we+W[1]*ke+K[1]*Re+oe[1]*Pe,z[2]=q[2]*we+W[2]*ke+K[2]*Re+oe[2]*Pe,z},Ke.random=function(z,q){q=q||1;var W=2*n.RANDOM()*Math.PI,K=2*n.RANDOM()-1,oe=Math.sqrt(1-K*K)*q;return z[0]=Math.cos(W)*oe,z[1]=Math.sin(W)*oe,z[2]=K*q,z},Ke.transformMat4=function(z,q,W){var K=q[0],oe=q[1],se=q[2],ne=W[3]*K+W[7]*oe+W[11]*se+W[15];return z[0]=(W[0]*K+W[4]*oe+W[8]*se+W[12])/(ne=ne||1),z[1]=(W[1]*K+W[5]*oe+W[9]*se+W[13])/ne,z[2]=(W[2]*K+W[6]*oe+W[10]*se+W[14])/ne,z},Ke.transformMat3=function(z,q,W){var K=q[0],oe=q[1],se=q[2];return z[0]=K*W[0]+oe*W[3]+se*W[6],z[1]=K*W[1]+oe*W[4]+se*W[7],z[2]=K*W[2]+oe*W[5]+se*W[8],z},Ke.transformQuat=function(z,q,W){var K=W[0],oe=W[1],se=W[2],ne=q[0],ce=q[1],pe=q[2],we=oe*pe-se*ce,ke=se*ne-K*pe,Re=K*ce-oe*ne,Pe=oe*Re-se*ke,We=se*we-K*Re,Le=K*ke-oe*we,Je=2*W[3];return ke*=Je,Re*=Je,We*=2,Le*=2,z[0]=ne+(we*=Je)+(Pe*=2),z[1]=ce+ke+We,z[2]=pe+Re+Le,z},Ke.rotateX=function(z,q,W,K){var oe=[],se=[];return oe[0]=q[0]-W[0],oe[1]=q[1]-W[1],oe[2]=q[2]-W[2],se[0]=oe[0],se[1]=oe[1]*Math.cos(K)-oe[2]*Math.sin(K),se[2]=oe[1]*Math.sin(K)+oe[2]*Math.cos(K),z[0]=se[0]+W[0],z[1]=se[1]+W[1],z[2]=se[2]+W[2],z},Ke.rotateY=function(z,q,W,K){var oe=[],se=[];return oe[0]=q[0]-W[0],oe[1]=q[1]-W[1],oe[2]=q[2]-W[2],se[0]=oe[2]*Math.sin(K)+oe[0]*Math.cos(K),se[1]=oe[1],se[2]=oe[2]*Math.cos(K)-oe[0]*Math.sin(K),z[0]=se[0]+W[0],z[1]=se[1]+W[1],z[2]=se[2]+W[2],z},Ke.rotateZ=function(z,q,W,K){var oe=[],se=[];return oe[0]=q[0]-W[0],oe[1]=q[1]-W[1],oe[2]=q[2]-W[2],se[0]=oe[0]*Math.cos(K)-oe[1]*Math.sin(K),se[1]=oe[0]*Math.sin(K)+oe[1]*Math.cos(K),se[2]=oe[2],z[0]=se[0]+W[0],z[1]=se[1]+W[1],z[2]=se[2]+W[2],z},Ke.angle=function(z,q){var W=z[0],K=z[1],oe=z[2],se=q[0],ne=q[1],ce=q[2],pe=Math.sqrt(W*W+K*K+oe*oe)*Math.sqrt(se*se+ne*ne+ce*ce),we=pe&&D(z,q)/pe;return Math.acos(Math.min(Math.max(we,-1),1))},Ke.zero=function(z){return z[0]=0,z[1]=0,z[2]=0,z},Ke.str=function(z){return"vec3("+z[0]+", "+z[1]+", "+z[2]+")"},Ke.exactEquals=function(z,q){return z[0]===q[0]&&z[1]===q[1]&&z[2]===q[2]},Ke.equals=function(z,q){var W=z[0],K=z[1],oe=z[2],se=q[0],ne=q[1],ce=q[2];return Math.abs(W-se)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(se))&&Math.abs(K-ne)<=n.EPSILON*Math.max(1,Math.abs(K),Math.abs(ne))&&Math.abs(oe-ce)<=n.EPSILON*Math.max(1,Math.abs(oe),Math.abs(ce))},Ke.forEach=Ke.sqrLen=Ke.len=Ke.sqrDist=Ke.dist=Ke.div=Ke.mul=Ke.sub=void 0;var n=function(z,q){if(z&&z.__esModule)return z;if(z===null||u(z)!=="object"&&typeof z!="function")return{default:z};var W=s(void 0);if(W&&W.has(z))return W.get(z);var K={},oe=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var se in z)if(se!=="default"&&Object.prototype.hasOwnProperty.call(z,se)){var ne=oe?Object.getOwnPropertyDescriptor(z,se):null;ne&&(ne.get||ne.set)?Object.defineProperty(K,se,ne):K[se]=z[se]}return K.default=z,W&&W.set(z,K),K}(H());function s(z){if(typeof WeakMap!="function")return null;var q=new WeakMap,W=new WeakMap;return(s=function(K){return K?W:q})(z)}function h(){var z=new n.ARRAY_TYPE(3);return n.ARRAY_TYPE!=Float32Array&&(z[0]=0,z[1]=0,z[2]=0),z}function y(z){return Math.hypot(z[0],z[1],z[2])}function d(z,q,W){return z[0]=q[0]-W[0],z[1]=q[1]-W[1],z[2]=q[2]-W[2],z}function v(z,q,W){return z[0]=q[0]*W[0],z[1]=q[1]*W[1],z[2]=q[2]*W[2],z}function M(z,q,W){return z[0]=q[0]/W[0],z[1]=q[1]/W[1],z[2]=q[2]/W[2],z}function k(z,q){return Math.hypot(q[0]-z[0],q[1]-z[1],q[2]-z[2])}function j(z,q){var W=q[0]-z[0],K=q[1]-z[1],oe=q[2]-z[2];return W*W+K*K+oe*oe}function E(z){var q=z[0],W=z[1],K=z[2];return q*q+W*W+K*K}function D(z,q){return z[0]*q[0]+z[1]*q[1]+z[2]*q[2]}Ke.sub=d,Ke.mul=v,Ke.div=M,Ke.dist=k,Ke.sqrDist=j,Ke.len=y,Ke.sqrLen=E;var B,R=(B=h(),function(z,q,W,K,oe,se){var ne,ce;for(q||(q=3),W||(W=0),ce=K?Math.min(K*q+W,z.length):z.length,ne=W;ne<ce;ne+=q)B[0]=z[ne],B[1]=z[ne+1],B[2]=z[ne+2],oe(B,B,se),z[ne]=B[0],z[ne+1]=B[1],z[ne+2]=B[2];return z});return Ke.forEach=R,Ke}var Bt,Tt,mt={};function bt(){if(Bt)return mt;function u(R){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(z){return typeof z}:function(z){return z&&typeof Symbol=="function"&&z.constructor===Symbol&&z!==Symbol.prototype?"symbol":typeof z},u(R)}Bt=1,Object.defineProperty(mt,"__esModule",{value:!0}),mt.create=h,mt.clone=function(R){var z=new n.ARRAY_TYPE(4);return z[0]=R[0],z[1]=R[1],z[2]=R[2],z[3]=R[3],z},mt.fromValues=function(R,z,q,W){var K=new n.ARRAY_TYPE(4);return K[0]=R,K[1]=z,K[2]=q,K[3]=W,K},mt.copy=function(R,z){return R[0]=z[0],R[1]=z[1],R[2]=z[2],R[3]=z[3],R},mt.set=function(R,z,q,W,K){return R[0]=z,R[1]=q,R[2]=W,R[3]=K,R},mt.add=function(R,z,q){return R[0]=z[0]+q[0],R[1]=z[1]+q[1],R[2]=z[2]+q[2],R[3]=z[3]+q[3],R},mt.subtract=y,mt.multiply=d,mt.divide=v,mt.ceil=function(R,z){return R[0]=Math.ceil(z[0]),R[1]=Math.ceil(z[1]),R[2]=Math.ceil(z[2]),R[3]=Math.ceil(z[3]),R},mt.floor=function(R,z){return R[0]=Math.floor(z[0]),R[1]=Math.floor(z[1]),R[2]=Math.floor(z[2]),R[3]=Math.floor(z[3]),R},mt.min=function(R,z,q){return R[0]=Math.min(z[0],q[0]),R[1]=Math.min(z[1],q[1]),R[2]=Math.min(z[2],q[2]),R[3]=Math.min(z[3],q[3]),R},mt.max=function(R,z,q){return R[0]=Math.max(z[0],q[0]),R[1]=Math.max(z[1],q[1]),R[2]=Math.max(z[2],q[2]),R[3]=Math.max(z[3],q[3]),R},mt.round=function(R,z){return R[0]=Math.round(z[0]),R[1]=Math.round(z[1]),R[2]=Math.round(z[2]),R[3]=Math.round(z[3]),R},mt.scale=function(R,z,q){return R[0]=z[0]*q,R[1]=z[1]*q,R[2]=z[2]*q,R[3]=z[3]*q,R},mt.scaleAndAdd=function(R,z,q,W){return R[0]=z[0]+q[0]*W,R[1]=z[1]+q[1]*W,R[2]=z[2]+q[2]*W,R[3]=z[3]+q[3]*W,R},mt.distance=M,mt.squaredDistance=k,mt.length=j,mt.squaredLength=E,mt.negate=function(R,z){return R[0]=-z[0],R[1]=-z[1],R[2]=-z[2],R[3]=-z[3],R},mt.inverse=function(R,z){return R[0]=1/z[0],R[1]=1/z[1],R[2]=1/z[2],R[3]=1/z[3],R},mt.normalize=function(R,z){var q=z[0],W=z[1],K=z[2],oe=z[3],se=q*q+W*W+K*K+oe*oe;return se>0&&(se=1/Math.sqrt(se)),R[0]=q*se,R[1]=W*se,R[2]=K*se,R[3]=oe*se,R},mt.dot=function(R,z){return R[0]*z[0]+R[1]*z[1]+R[2]*z[2]+R[3]*z[3]},mt.cross=function(R,z,q,W){var K=q[0]*W[1]-q[1]*W[0],oe=q[0]*W[2]-q[2]*W[0],se=q[0]*W[3]-q[3]*W[0],ne=q[1]*W[2]-q[2]*W[1],ce=q[1]*W[3]-q[3]*W[1],pe=q[2]*W[3]-q[3]*W[2],we=z[0],ke=z[1],Re=z[2],Pe=z[3];return R[0]=ke*pe-Re*ce+Pe*ne,R[1]=-we*pe+Re*se-Pe*oe,R[2]=we*ce-ke*se+Pe*K,R[3]=-we*ne+ke*oe-Re*K,R},mt.lerp=function(R,z,q,W){var K=z[0],oe=z[1],se=z[2],ne=z[3];return R[0]=K+W*(q[0]-K),R[1]=oe+W*(q[1]-oe),R[2]=se+W*(q[2]-se),R[3]=ne+W*(q[3]-ne),R},mt.random=function(R,z){var q,W,K,oe,se,ne;z=z||1;do se=(q=2*n.RANDOM()-1)*q+(W=2*n.RANDOM()-1)*W;while(se>=1);do ne=(K=2*n.RANDOM()-1)*K+(oe=2*n.RANDOM()-1)*oe;while(ne>=1);var ce=Math.sqrt((1-se)/ne);return R[0]=z*q,R[1]=z*W,R[2]=z*K*ce,R[3]=z*oe*ce,R},mt.transformMat4=function(R,z,q){var W=z[0],K=z[1],oe=z[2],se=z[3];return R[0]=q[0]*W+q[4]*K+q[8]*oe+q[12]*se,R[1]=q[1]*W+q[5]*K+q[9]*oe+q[13]*se,R[2]=q[2]*W+q[6]*K+q[10]*oe+q[14]*se,R[3]=q[3]*W+q[7]*K+q[11]*oe+q[15]*se,R},mt.transformQuat=function(R,z,q){var W=z[0],K=z[1],oe=z[2],se=q[0],ne=q[1],ce=q[2],pe=q[3],we=pe*W+ne*oe-ce*K,ke=pe*K+ce*W-se*oe,Re=pe*oe+se*K-ne*W,Pe=-se*W-ne*K-ce*oe;return R[0]=we*pe+Pe*-se+ke*-ce-Re*-ne,R[1]=ke*pe+Pe*-ne+Re*-se-we*-ce,R[2]=Re*pe+Pe*-ce+we*-ne-ke*-se,R[3]=z[3],R},mt.zero=function(R){return R[0]=0,R[1]=0,R[2]=0,R[3]=0,R},mt.str=function(R){return"vec4("+R[0]+", "+R[1]+", "+R[2]+", "+R[3]+")"},mt.exactEquals=function(R,z){return R[0]===z[0]&&R[1]===z[1]&&R[2]===z[2]&&R[3]===z[3]},mt.equals=function(R,z){var q=R[0],W=R[1],K=R[2],oe=R[3],se=z[0],ne=z[1],ce=z[2],pe=z[3];return Math.abs(q-se)<=n.EPSILON*Math.max(1,Math.abs(q),Math.abs(se))&&Math.abs(W-ne)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(ne))&&Math.abs(K-ce)<=n.EPSILON*Math.max(1,Math.abs(K),Math.abs(ce))&&Math.abs(oe-pe)<=n.EPSILON*Math.max(1,Math.abs(oe),Math.abs(pe))},mt.forEach=mt.sqrLen=mt.len=mt.sqrDist=mt.dist=mt.div=mt.mul=mt.sub=void 0;var n=function(R,z){if(R&&R.__esModule)return R;if(R===null||u(R)!=="object"&&typeof R!="function")return{default:R};var q=s(void 0);if(q&&q.has(R))return q.get(R);var W={},K=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var oe in R)if(oe!=="default"&&Object.prototype.hasOwnProperty.call(R,oe)){var se=K?Object.getOwnPropertyDescriptor(R,oe):null;se&&(se.get||se.set)?Object.defineProperty(W,oe,se):W[oe]=R[oe]}return W.default=R,q&&q.set(R,W),W}(H());function s(R){if(typeof WeakMap!="function")return null;var z=new WeakMap,q=new WeakMap;return(s=function(W){return W?q:z})(R)}function h(){var R=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(R[0]=0,R[1]=0,R[2]=0,R[3]=0),R}function y(R,z,q){return R[0]=z[0]-q[0],R[1]=z[1]-q[1],R[2]=z[2]-q[2],R[3]=z[3]-q[3],R}function d(R,z,q){return R[0]=z[0]*q[0],R[1]=z[1]*q[1],R[2]=z[2]*q[2],R[3]=z[3]*q[3],R}function v(R,z,q){return R[0]=z[0]/q[0],R[1]=z[1]/q[1],R[2]=z[2]/q[2],R[3]=z[3]/q[3],R}function M(R,z){return Math.hypot(z[0]-R[0],z[1]-R[1],z[2]-R[2],z[3]-R[3])}function k(R,z){var q=z[0]-R[0],W=z[1]-R[1],K=z[2]-R[2],oe=z[3]-R[3];return q*q+W*W+K*K+oe*oe}function j(R){return Math.hypot(R[0],R[1],R[2],R[3])}function E(R){var z=R[0],q=R[1],W=R[2],K=R[3];return z*z+q*q+W*W+K*K}mt.sub=y,mt.mul=d,mt.div=v,mt.dist=M,mt.sqrDist=k,mt.len=j,mt.sqrLen=E;var D,B=(D=h(),function(R,z,q,W,K,oe){var se,ne;for(z||(z=4),q||(q=0),ne=W?Math.min(W*z+q,R.length):R.length,se=q;se<ne;se+=z)D[0]=R[se],D[1]=R[se+1],D[2]=R[se+2],D[3]=R[se+3],K(D,D,oe),R[se]=D[0],R[se+1]=D[1],R[se+2]=D[2],R[se+3]=D[3];return R});return mt.forEach=B,mt}function Ft(){if(Tt)return st;function u(Le){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Je){return typeof Je}:function(Je){return Je&&typeof Symbol=="function"&&Je.constructor===Symbol&&Je!==Symbol.prototype?"symbol":typeof Je},u(Le)}Tt=1,Object.defineProperty(st,"__esModule",{value:!0}),st.create=M,st.identity=function(Le){return Le[0]=0,Le[1]=0,Le[2]=0,Le[3]=1,Le},st.setAxisAngle=k,st.getAxisAngle=function(Le,Je){var it=2*Math.acos(Je[3]),tt=Math.sin(it/2);return tt>n.EPSILON?(Le[0]=Je[0]/tt,Le[1]=Je[1]/tt,Le[2]=Je[2]/tt):(Le[0]=1,Le[1]=0,Le[2]=0),it},st.getAngle=function(Le,Je){var it=q(Le,Je);return Math.acos(2*it*it-1)},st.multiply=j,st.rotateX=function(Le,Je,it){it*=.5;var tt=Je[0],ot=Je[1],ut=Je[2],pt=Je[3],lt=Math.sin(it),Lt=Math.cos(it);return Le[0]=tt*Lt+pt*lt,Le[1]=ot*Lt+ut*lt,Le[2]=ut*Lt-ot*lt,Le[3]=pt*Lt-tt*lt,Le},st.rotateY=function(Le,Je,it){it*=.5;var tt=Je[0],ot=Je[1],ut=Je[2],pt=Je[3],lt=Math.sin(it),Lt=Math.cos(it);return Le[0]=tt*Lt-ut*lt,Le[1]=ot*Lt+pt*lt,Le[2]=ut*Lt+tt*lt,Le[3]=pt*Lt-ot*lt,Le},st.rotateZ=function(Le,Je,it){it*=.5;var tt=Je[0],ot=Je[1],ut=Je[2],pt=Je[3],lt=Math.sin(it),Lt=Math.cos(it);return Le[0]=tt*Lt+ot*lt,Le[1]=ot*Lt-tt*lt,Le[2]=ut*Lt+pt*lt,Le[3]=pt*Lt-ut*lt,Le},st.calculateW=function(Le,Je){var it=Je[0],tt=Je[1],ot=Je[2];return Le[0]=it,Le[1]=tt,Le[2]=ot,Le[3]=Math.sqrt(Math.abs(1-it*it-tt*tt-ot*ot)),Le},st.exp=E,st.ln=D,st.pow=function(Le,Je,it){return D(Le,Je),z(Le,Le,it),E(Le,Le),Le},st.slerp=B,st.random=function(Le){var Je=n.RANDOM(),it=n.RANDOM(),tt=n.RANDOM(),ot=Math.sqrt(1-Je),ut=Math.sqrt(Je);return Le[0]=ot*Math.sin(2*Math.PI*it),Le[1]=ot*Math.cos(2*Math.PI*it),Le[2]=ut*Math.sin(2*Math.PI*tt),Le[3]=ut*Math.cos(2*Math.PI*tt),Le},st.invert=function(Le,Je){var it=Je[0],tt=Je[1],ot=Je[2],ut=Je[3],pt=it*it+tt*tt+ot*ot+ut*ut,lt=pt?1/pt:0;return Le[0]=-it*lt,Le[1]=-tt*lt,Le[2]=-ot*lt,Le[3]=ut*lt,Le},st.conjugate=function(Le,Je){return Le[0]=-Je[0],Le[1]=-Je[1],Le[2]=-Je[2],Le[3]=Je[3],Le},st.fromMat3=R,st.fromEuler=function(Le,Je,it,tt){var ot=.5*Math.PI/180;Je*=ot,it*=ot,tt*=ot;var ut=Math.sin(Je),pt=Math.cos(Je),lt=Math.sin(it),Lt=Math.cos(it),Wt=Math.sin(tt),Rt=Math.cos(tt);return Le[0]=ut*Lt*Rt-pt*lt*Wt,Le[1]=pt*lt*Rt+ut*Lt*Wt,Le[2]=pt*Lt*Wt-ut*lt*Rt,Le[3]=pt*Lt*Rt+ut*lt*Wt,Le},st.str=function(Le){return"quat("+Le[0]+", "+Le[1]+", "+Le[2]+", "+Le[3]+")"},st.setAxes=st.sqlerp=st.rotationTo=st.equals=st.exactEquals=st.normalize=st.sqrLen=st.squaredLength=st.len=st.length=st.lerp=st.dot=st.scale=st.mul=st.add=st.set=st.copy=st.fromValues=st.clone=void 0;var n=v(H()),s=v(me()),h=v(Ot()),y=v(bt());function d(Le){if(typeof WeakMap!="function")return null;var Je=new WeakMap,it=new WeakMap;return(d=function(tt){return tt?it:Je})(Le)}function v(Le,Je){if(Le&&Le.__esModule)return Le;if(Le===null||u(Le)!=="object"&&typeof Le!="function")return{default:Le};var it=d(Je);if(it&&it.has(Le))return it.get(Le);var tt={},ot=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ut in Le)if(ut!=="default"&&Object.prototype.hasOwnProperty.call(Le,ut)){var pt=ot?Object.getOwnPropertyDescriptor(Le,ut):null;pt&&(pt.get||pt.set)?Object.defineProperty(tt,ut,pt):tt[ut]=Le[ut]}return tt.default=Le,it&&it.set(Le,tt),tt}function M(){var Le=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(Le[0]=0,Le[1]=0,Le[2]=0),Le[3]=1,Le}function k(Le,Je,it){it*=.5;var tt=Math.sin(it);return Le[0]=tt*Je[0],Le[1]=tt*Je[1],Le[2]=tt*Je[2],Le[3]=Math.cos(it),Le}function j(Le,Je,it){var tt=Je[0],ot=Je[1],ut=Je[2],pt=Je[3],lt=it[0],Lt=it[1],Wt=it[2],Rt=it[3];return Le[0]=tt*Rt+pt*lt+ot*Wt-ut*Lt,Le[1]=ot*Rt+pt*Lt+ut*lt-tt*Wt,Le[2]=ut*Rt+pt*Wt+tt*Lt-ot*lt,Le[3]=pt*Rt-tt*lt-ot*Lt-ut*Wt,Le}function E(Le,Je){var it=Je[0],tt=Je[1],ot=Je[2],ut=Je[3],pt=Math.sqrt(it*it+tt*tt+ot*ot),lt=Math.exp(ut),Lt=pt>0?lt*Math.sin(pt)/pt:0;return Le[0]=it*Lt,Le[1]=tt*Lt,Le[2]=ot*Lt,Le[3]=lt*Math.cos(pt),Le}function D(Le,Je){var it=Je[0],tt=Je[1],ot=Je[2],ut=Je[3],pt=Math.sqrt(it*it+tt*tt+ot*ot),lt=pt>0?Math.atan2(pt,ut)/pt:0;return Le[0]=it*lt,Le[1]=tt*lt,Le[2]=ot*lt,Le[3]=.5*Math.log(it*it+tt*tt+ot*ot+ut*ut),Le}function B(Le,Je,it,tt){var ot,ut,pt,lt,Lt,Wt=Je[0],Rt=Je[1],xn=Je[2],mn=Je[3],on=it[0],en=it[1],zn=it[2],Tn=it[3];return(ut=Wt*on+Rt*en+xn*zn+mn*Tn)<0&&(ut=-ut,on=-on,en=-en,zn=-zn,Tn=-Tn),1-ut>n.EPSILON?(ot=Math.acos(ut),pt=Math.sin(ot),lt=Math.sin((1-tt)*ot)/pt,Lt=Math.sin(tt*ot)/pt):(lt=1-tt,Lt=tt),Le[0]=lt*Wt+Lt*on,Le[1]=lt*Rt+Lt*en,Le[2]=lt*xn+Lt*zn,Le[3]=lt*mn+Lt*Tn,Le}function R(Le,Je){var it,tt=Je[0]+Je[4]+Je[8];if(tt>0)it=Math.sqrt(tt+1),Le[3]=.5*it,Le[0]=(Je[5]-Je[7])*(it=.5/it),Le[1]=(Je[6]-Je[2])*it,Le[2]=(Je[1]-Je[3])*it;else{var ot=0;Je[4]>Je[0]&&(ot=1),Je[8]>Je[3*ot+ot]&&(ot=2);var ut=(ot+1)%3,pt=(ot+2)%3;it=Math.sqrt(Je[3*ot+ot]-Je[3*ut+ut]-Je[3*pt+pt]+1),Le[ot]=.5*it,Le[3]=(Je[3*ut+pt]-Je[3*pt+ut])*(it=.5/it),Le[ut]=(Je[3*ut+ot]+Je[3*ot+ut])*it,Le[pt]=(Je[3*pt+ot]+Je[3*ot+pt])*it}return Le}st.clone=y.clone,st.fromValues=y.fromValues,st.copy=y.copy,st.set=y.set,st.add=y.add,st.mul=j;var z=y.scale;st.scale=z;var q=y.dot;st.dot=q,st.lerp=y.lerp;var W=y.length;st.length=W,st.len=W;var K=y.squaredLength;st.squaredLength=K,st.sqrLen=K;var oe=y.normalize;st.normalize=oe,st.exactEquals=y.exactEquals,st.equals=y.equals;var se,ne,ce,pe=(se=h.create(),ne=h.fromValues(1,0,0),ce=h.fromValues(0,1,0),function(Le,Je,it){var tt=h.dot(Je,it);return tt<-.999999?(h.cross(se,ne,Je),h.len(se)<1e-6&&h.cross(se,ce,Je),h.normalize(se,se),k(Le,se,Math.PI),Le):tt>.999999?(Le[0]=0,Le[1]=0,Le[2]=0,Le[3]=1,Le):(h.cross(se,Je,it),Le[0]=se[0],Le[1]=se[1],Le[2]=se[2],Le[3]=1+tt,oe(Le,Le))});st.rotationTo=pe;var we,ke,Re=(we=M(),ke=M(),function(Le,Je,it,tt,ot,ut){return B(we,Je,ot,ut),B(ke,it,tt,ut),B(Le,we,ke,2*ut*(1-ut)),Le});st.sqlerp=Re;var Pe,We=(Pe=s.create(),function(Le,Je,it,tt){return Pe[0]=it[0],Pe[3]=it[1],Pe[6]=it[2],Pe[1]=tt[0],Pe[4]=tt[1],Pe[7]=tt[2],Pe[2]=-Je[0],Pe[5]=-Je[1],Pe[8]=-Je[2],oe(Le,R(Le,Pe))});return st.setAxes=We,st}var Zt,Vt={};function Ze(){if(Zt)return Vt;function u(B){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},u(B)}Zt=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.create=function(){var B=new n.ARRAY_TYPE(8);return n.ARRAY_TYPE!=Float32Array&&(B[0]=0,B[1]=0,B[2]=0,B[4]=0,B[5]=0,B[6]=0,B[7]=0),B[3]=1,B},Vt.clone=function(B){var R=new n.ARRAY_TYPE(8);return R[0]=B[0],R[1]=B[1],R[2]=B[2],R[3]=B[3],R[4]=B[4],R[5]=B[5],R[6]=B[6],R[7]=B[7],R},Vt.fromValues=function(B,R,z,q,W,K,oe,se){var ne=new n.ARRAY_TYPE(8);return ne[0]=B,ne[1]=R,ne[2]=z,ne[3]=q,ne[4]=W,ne[5]=K,ne[6]=oe,ne[7]=se,ne},Vt.fromRotationTranslationValues=function(B,R,z,q,W,K,oe){var se=new n.ARRAY_TYPE(8);se[0]=B,se[1]=R,se[2]=z,se[3]=q;var ne=.5*W,ce=.5*K,pe=.5*oe;return se[4]=ne*q+ce*z-pe*R,se[5]=ce*q+pe*B-ne*z,se[6]=pe*q+ne*R-ce*B,se[7]=-ne*B-ce*R-pe*z,se},Vt.fromRotationTranslation=v,Vt.fromTranslation=function(B,R){return B[0]=0,B[1]=0,B[2]=0,B[3]=1,B[4]=.5*R[0],B[5]=.5*R[1],B[6]=.5*R[2],B[7]=0,B},Vt.fromRotation=function(B,R){return B[0]=R[0],B[1]=R[1],B[2]=R[2],B[3]=R[3],B[4]=0,B[5]=0,B[6]=0,B[7]=0,B},Vt.fromMat4=function(B,R){var z=s.create();h.getRotation(z,R);var q=new n.ARRAY_TYPE(3);return h.getTranslation(q,R),v(B,z,q),B},Vt.copy=M,Vt.identity=function(B){return B[0]=0,B[1]=0,B[2]=0,B[3]=1,B[4]=0,B[5]=0,B[6]=0,B[7]=0,B},Vt.set=function(B,R,z,q,W,K,oe,se,ne){return B[0]=R,B[1]=z,B[2]=q,B[3]=W,B[4]=K,B[5]=oe,B[6]=se,B[7]=ne,B},Vt.getDual=function(B,R){return B[0]=R[4],B[1]=R[5],B[2]=R[6],B[3]=R[7],B},Vt.setDual=function(B,R){return B[4]=R[0],B[5]=R[1],B[6]=R[2],B[7]=R[3],B},Vt.getTranslation=function(B,R){var z=R[4],q=R[5],W=R[6],K=R[7],oe=-R[0],se=-R[1],ne=-R[2],ce=R[3];return B[0]=2*(z*ce+K*oe+q*ne-W*se),B[1]=2*(q*ce+K*se+W*oe-z*ne),B[2]=2*(W*ce+K*ne+z*se-q*oe),B},Vt.translate=function(B,R,z){var q=R[0],W=R[1],K=R[2],oe=R[3],se=.5*z[0],ne=.5*z[1],ce=.5*z[2],pe=R[4],we=R[5],ke=R[6],Re=R[7];return B[0]=q,B[1]=W,B[2]=K,B[3]=oe,B[4]=oe*se+W*ce-K*ne+pe,B[5]=oe*ne+K*se-q*ce+we,B[6]=oe*ce+q*ne-W*se+ke,B[7]=-q*se-W*ne-K*ce+Re,B},Vt.rotateX=function(B,R,z){var q=-R[0],W=-R[1],K=-R[2],oe=R[3],se=R[4],ne=R[5],ce=R[6],pe=R[7],we=se*oe+pe*q+ne*K-ce*W,ke=ne*oe+pe*W+ce*q-se*K,Re=ce*oe+pe*K+se*W-ne*q,Pe=pe*oe-se*q-ne*W-ce*K;return s.rotateX(B,R,z),B[4]=we*(oe=B[3])+Pe*(q=B[0])+ke*(K=B[2])-Re*(W=B[1]),B[5]=ke*oe+Pe*W+Re*q-we*K,B[6]=Re*oe+Pe*K+we*W-ke*q,B[7]=Pe*oe-we*q-ke*W-Re*K,B},Vt.rotateY=function(B,R,z){var q=-R[0],W=-R[1],K=-R[2],oe=R[3],se=R[4],ne=R[5],ce=R[6],pe=R[7],we=se*oe+pe*q+ne*K-ce*W,ke=ne*oe+pe*W+ce*q-se*K,Re=ce*oe+pe*K+se*W-ne*q,Pe=pe*oe-se*q-ne*W-ce*K;return s.rotateY(B,R,z),B[4]=we*(oe=B[3])+Pe*(q=B[0])+ke*(K=B[2])-Re*(W=B[1]),B[5]=ke*oe+Pe*W+Re*q-we*K,B[6]=Re*oe+Pe*K+we*W-ke*q,B[7]=Pe*oe-we*q-ke*W-Re*K,B},Vt.rotateZ=function(B,R,z){var q=-R[0],W=-R[1],K=-R[2],oe=R[3],se=R[4],ne=R[5],ce=R[6],pe=R[7],we=se*oe+pe*q+ne*K-ce*W,ke=ne*oe+pe*W+ce*q-se*K,Re=ce*oe+pe*K+se*W-ne*q,Pe=pe*oe-se*q-ne*W-ce*K;return s.rotateZ(B,R,z),B[4]=we*(oe=B[3])+Pe*(q=B[0])+ke*(K=B[2])-Re*(W=B[1]),B[5]=ke*oe+Pe*W+Re*q-we*K,B[6]=Re*oe+Pe*K+we*W-ke*q,B[7]=Pe*oe-we*q-ke*W-Re*K,B},Vt.rotateByQuatAppend=function(B,R,z){var q=z[0],W=z[1],K=z[2],oe=z[3],se=R[0],ne=R[1],ce=R[2],pe=R[3];return B[0]=se*oe+pe*q+ne*K-ce*W,B[1]=ne*oe+pe*W+ce*q-se*K,B[2]=ce*oe+pe*K+se*W-ne*q,B[3]=pe*oe-se*q-ne*W-ce*K,B[4]=(se=R[4])*oe+(pe=R[7])*q+(ne=R[5])*K-(ce=R[6])*W,B[5]=ne*oe+pe*W+ce*q-se*K,B[6]=ce*oe+pe*K+se*W-ne*q,B[7]=pe*oe-se*q-ne*W-ce*K,B},Vt.rotateByQuatPrepend=function(B,R,z){var q=R[0],W=R[1],K=R[2],oe=R[3],se=z[0],ne=z[1],ce=z[2],pe=z[3];return B[0]=q*pe+oe*se+W*ce-K*ne,B[1]=W*pe+oe*ne+K*se-q*ce,B[2]=K*pe+oe*ce+q*ne-W*se,B[3]=oe*pe-q*se-W*ne-K*ce,B[4]=q*(pe=z[7])+oe*(se=z[4])+W*(ce=z[6])-K*(ne=z[5]),B[5]=W*pe+oe*ne+K*se-q*ce,B[6]=K*pe+oe*ce+q*ne-W*se,B[7]=oe*pe-q*se-W*ne-K*ce,B},Vt.rotateAroundAxis=function(B,R,z,q){if(Math.abs(q)<n.EPSILON)return M(B,R);var W=Math.hypot(z[0],z[1],z[2]);q*=.5;var K=Math.sin(q),oe=K*z[0]/W,se=K*z[1]/W,ne=K*z[2]/W,ce=Math.cos(q),pe=R[0],we=R[1],ke=R[2],Re=R[3];B[0]=pe*ce+Re*oe+we*ne-ke*se,B[1]=we*ce+Re*se+ke*oe-pe*ne,B[2]=ke*ce+Re*ne+pe*se-we*oe,B[3]=Re*ce-pe*oe-we*se-ke*ne;var Pe=R[4],We=R[5],Le=R[6],Je=R[7];return B[4]=Pe*ce+Je*oe+We*ne-Le*se,B[5]=We*ce+Je*se+Le*oe-Pe*ne,B[6]=Le*ce+Je*ne+Pe*se-We*oe,B[7]=Je*ce-Pe*oe-We*se-Le*ne,B},Vt.add=function(B,R,z){return B[0]=R[0]+z[0],B[1]=R[1]+z[1],B[2]=R[2]+z[2],B[3]=R[3]+z[3],B[4]=R[4]+z[4],B[5]=R[5]+z[5],B[6]=R[6]+z[6],B[7]=R[7]+z[7],B},Vt.multiply=k,Vt.scale=function(B,R,z){return B[0]=R[0]*z,B[1]=R[1]*z,B[2]=R[2]*z,B[3]=R[3]*z,B[4]=R[4]*z,B[5]=R[5]*z,B[6]=R[6]*z,B[7]=R[7]*z,B},Vt.lerp=function(B,R,z,q){var W=1-q;return j(R,z)<0&&(q=-q),B[0]=R[0]*W+z[0]*q,B[1]=R[1]*W+z[1]*q,B[2]=R[2]*W+z[2]*q,B[3]=R[3]*W+z[3]*q,B[4]=R[4]*W+z[4]*q,B[5]=R[5]*W+z[5]*q,B[6]=R[6]*W+z[6]*q,B[7]=R[7]*W+z[7]*q,B},Vt.invert=function(B,R){var z=D(R);return B[0]=-R[0]/z,B[1]=-R[1]/z,B[2]=-R[2]/z,B[3]=R[3]/z,B[4]=-R[4]/z,B[5]=-R[5]/z,B[6]=-R[6]/z,B[7]=R[7]/z,B},Vt.conjugate=function(B,R){return B[0]=-R[0],B[1]=-R[1],B[2]=-R[2],B[3]=R[3],B[4]=-R[4],B[5]=-R[5],B[6]=-R[6],B[7]=R[7],B},Vt.normalize=function(B,R){var z=D(R);if(z>0){z=Math.sqrt(z);var q=R[0]/z,W=R[1]/z,K=R[2]/z,oe=R[3]/z,se=R[4],ne=R[5],ce=R[6],pe=R[7],we=q*se+W*ne+K*ce+oe*pe;B[0]=q,B[1]=W,B[2]=K,B[3]=oe,B[4]=(se-q*we)/z,B[5]=(ne-W*we)/z,B[6]=(ce-K*we)/z,B[7]=(pe-oe*we)/z}return B},Vt.str=function(B){return"quat2("+B[0]+", "+B[1]+", "+B[2]+", "+B[3]+", "+B[4]+", "+B[5]+", "+B[6]+", "+B[7]+")"},Vt.exactEquals=function(B,R){return B[0]===R[0]&&B[1]===R[1]&&B[2]===R[2]&&B[3]===R[3]&&B[4]===R[4]&&B[5]===R[5]&&B[6]===R[6]&&B[7]===R[7]},Vt.equals=function(B,R){var z=B[0],q=B[1],W=B[2],K=B[3],oe=B[4],se=B[5],ne=B[6],ce=B[7],pe=R[0],we=R[1],ke=R[2],Re=R[3],Pe=R[4],We=R[5],Le=R[6],Je=R[7];return Math.abs(z-pe)<=n.EPSILON*Math.max(1,Math.abs(z),Math.abs(pe))&&Math.abs(q-we)<=n.EPSILON*Math.max(1,Math.abs(q),Math.abs(we))&&Math.abs(W-ke)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(ke))&&Math.abs(K-Re)<=n.EPSILON*Math.max(1,Math.abs(K),Math.abs(Re))&&Math.abs(oe-Pe)<=n.EPSILON*Math.max(1,Math.abs(oe),Math.abs(Pe))&&Math.abs(se-We)<=n.EPSILON*Math.max(1,Math.abs(se),Math.abs(We))&&Math.abs(ne-Le)<=n.EPSILON*Math.max(1,Math.abs(ne),Math.abs(Le))&&Math.abs(ce-Je)<=n.EPSILON*Math.max(1,Math.abs(ce),Math.abs(Je))},Vt.sqrLen=Vt.squaredLength=Vt.len=Vt.length=Vt.dot=Vt.mul=Vt.setReal=Vt.getReal=void 0;var n=d(H()),s=d(Ft()),h=d(Ye());function y(B){if(typeof WeakMap!="function")return null;var R=new WeakMap,z=new WeakMap;return(y=function(q){return q?z:R})(B)}function d(B,R){if(B&&B.__esModule)return B;if(B===null||u(B)!=="object"&&typeof B!="function")return{default:B};var z=y(R);if(z&&z.has(B))return z.get(B);var q={},W=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var K in B)if(K!=="default"&&Object.prototype.hasOwnProperty.call(B,K)){var oe=W?Object.getOwnPropertyDescriptor(B,K):null;oe&&(oe.get||oe.set)?Object.defineProperty(q,K,oe):q[K]=B[K]}return q.default=B,z&&z.set(B,q),q}function v(B,R,z){var q=.5*z[0],W=.5*z[1],K=.5*z[2],oe=R[0],se=R[1],ne=R[2],ce=R[3];return B[0]=oe,B[1]=se,B[2]=ne,B[3]=ce,B[4]=q*ce+W*ne-K*se,B[5]=W*ce+K*oe-q*ne,B[6]=K*ce+q*se-W*oe,B[7]=-q*oe-W*se-K*ne,B}function M(B,R){return B[0]=R[0],B[1]=R[1],B[2]=R[2],B[3]=R[3],B[4]=R[4],B[5]=R[5],B[6]=R[6],B[7]=R[7],B}function k(B,R,z){var q=R[0],W=R[1],K=R[2],oe=R[3],se=z[4],ne=z[5],ce=z[6],pe=z[7],we=R[4],ke=R[5],Re=R[6],Pe=R[7],We=z[0],Le=z[1],Je=z[2],it=z[3];return B[0]=q*it+oe*We+W*Je-K*Le,B[1]=W*it+oe*Le+K*We-q*Je,B[2]=K*it+oe*Je+q*Le-W*We,B[3]=oe*it-q*We-W*Le-K*Je,B[4]=q*pe+oe*se+W*ce-K*ne+we*it+Pe*We+ke*Je-Re*Le,B[5]=W*pe+oe*ne+K*se-q*ce+ke*it+Pe*Le+Re*We-we*Je,B[6]=K*pe+oe*ce+q*ne-W*se+Re*it+Pe*Je+we*Le-ke*We,B[7]=oe*pe-q*se-W*ne-K*ce+Pe*it-we*We-ke*Le-Re*Je,B}Vt.getReal=s.copy,Vt.setReal=s.copy,Vt.mul=k;var j=s.dot;Vt.dot=j;var E=s.length;Vt.length=E,Vt.len=E;var D=s.squaredLength;return Vt.squaredLength=D,Vt.sqrLen=D,Vt}var Xt,an,qt={};function cn(){if(Xt)return qt;function u(R){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(z){return typeof z}:function(z){return z&&typeof Symbol=="function"&&z.constructor===Symbol&&z!==Symbol.prototype?"symbol":typeof z},u(R)}Xt=1,Object.defineProperty(qt,"__esModule",{value:!0}),qt.create=h,qt.clone=function(R){var z=new n.ARRAY_TYPE(2);return z[0]=R[0],z[1]=R[1],z},qt.fromValues=function(R,z){var q=new n.ARRAY_TYPE(2);return q[0]=R,q[1]=z,q},qt.copy=function(R,z){return R[0]=z[0],R[1]=z[1],R},qt.set=function(R,z,q){return R[0]=z,R[1]=q,R},qt.add=function(R,z,q){return R[0]=z[0]+q[0],R[1]=z[1]+q[1],R},qt.subtract=y,qt.multiply=d,qt.divide=v,qt.ceil=function(R,z){return R[0]=Math.ceil(z[0]),R[1]=Math.ceil(z[1]),R},qt.floor=function(R,z){return R[0]=Math.floor(z[0]),R[1]=Math.floor(z[1]),R},qt.min=function(R,z,q){return R[0]=Math.min(z[0],q[0]),R[1]=Math.min(z[1],q[1]),R},qt.max=function(R,z,q){return R[0]=Math.max(z[0],q[0]),R[1]=Math.max(z[1],q[1]),R},qt.round=function(R,z){return R[0]=Math.round(z[0]),R[1]=Math.round(z[1]),R},qt.scale=function(R,z,q){return R[0]=z[0]*q,R[1]=z[1]*q,R},qt.scaleAndAdd=function(R,z,q,W){return R[0]=z[0]+q[0]*W,R[1]=z[1]+q[1]*W,R},qt.distance=M,qt.squaredDistance=k,qt.length=j,qt.squaredLength=E,qt.negate=function(R,z){return R[0]=-z[0],R[1]=-z[1],R},qt.inverse=function(R,z){return R[0]=1/z[0],R[1]=1/z[1],R},qt.normalize=function(R,z){var q=z[0],W=z[1],K=q*q+W*W;return K>0&&(K=1/Math.sqrt(K)),R[0]=z[0]*K,R[1]=z[1]*K,R},qt.dot=function(R,z){return R[0]*z[0]+R[1]*z[1]},qt.cross=function(R,z,q){var W=z[0]*q[1]-z[1]*q[0];return R[0]=R[1]=0,R[2]=W,R},qt.lerp=function(R,z,q,W){var K=z[0],oe=z[1];return R[0]=K+W*(q[0]-K),R[1]=oe+W*(q[1]-oe),R},qt.random=function(R,z){z=z||1;var q=2*n.RANDOM()*Math.PI;return R[0]=Math.cos(q)*z,R[1]=Math.sin(q)*z,R},qt.transformMat2=function(R,z,q){var W=z[0],K=z[1];return R[0]=q[0]*W+q[2]*K,R[1]=q[1]*W+q[3]*K,R},qt.transformMat2d=function(R,z,q){var W=z[0],K=z[1];return R[0]=q[0]*W+q[2]*K+q[4],R[1]=q[1]*W+q[3]*K+q[5],R},qt.transformMat3=function(R,z,q){var W=z[0],K=z[1];return R[0]=q[0]*W+q[3]*K+q[6],R[1]=q[1]*W+q[4]*K+q[7],R},qt.transformMat4=function(R,z,q){var W=z[0],K=z[1];return R[0]=q[0]*W+q[4]*K+q[12],R[1]=q[1]*W+q[5]*K+q[13],R},qt.rotate=function(R,z,q,W){var K=z[0]-q[0],oe=z[1]-q[1],se=Math.sin(W),ne=Math.cos(W);return R[0]=K*ne-oe*se+q[0],R[1]=K*se+oe*ne+q[1],R},qt.angle=function(R,z){var q=R[0],W=R[1],K=z[0],oe=z[1],se=Math.sqrt(q*q+W*W)*Math.sqrt(K*K+oe*oe);return Math.acos(Math.min(Math.max(se&&(q*K+W*oe)/se,-1),1))},qt.zero=function(R){return R[0]=0,R[1]=0,R},qt.str=function(R){return"vec2("+R[0]+", "+R[1]+")"},qt.exactEquals=function(R,z){return R[0]===z[0]&&R[1]===z[1]},qt.equals=function(R,z){var q=R[0],W=R[1],K=z[0],oe=z[1];return Math.abs(q-K)<=n.EPSILON*Math.max(1,Math.abs(q),Math.abs(K))&&Math.abs(W-oe)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(oe))},qt.forEach=qt.sqrLen=qt.sqrDist=qt.dist=qt.div=qt.mul=qt.sub=qt.len=void 0;var n=function(R,z){if(R&&R.__esModule)return R;if(R===null||u(R)!=="object"&&typeof R!="function")return{default:R};var q=s(void 0);if(q&&q.has(R))return q.get(R);var W={},K=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var oe in R)if(oe!=="default"&&Object.prototype.hasOwnProperty.call(R,oe)){var se=K?Object.getOwnPropertyDescriptor(R,oe):null;se&&(se.get||se.set)?Object.defineProperty(W,oe,se):W[oe]=R[oe]}return W.default=R,q&&q.set(R,W),W}(H());function s(R){if(typeof WeakMap!="function")return null;var z=new WeakMap,q=new WeakMap;return(s=function(W){return W?q:z})(R)}function h(){var R=new n.ARRAY_TYPE(2);return n.ARRAY_TYPE!=Float32Array&&(R[0]=0,R[1]=0),R}function y(R,z,q){return R[0]=z[0]-q[0],R[1]=z[1]-q[1],R}function d(R,z,q){return R[0]=z[0]*q[0],R[1]=z[1]*q[1],R}function v(R,z,q){return R[0]=z[0]/q[0],R[1]=z[1]/q[1],R}function M(R,z){return Math.hypot(z[0]-R[0],z[1]-R[1])}function k(R,z){var q=z[0]-R[0],W=z[1]-R[1];return q*q+W*W}function j(R){return Math.hypot(R[0],R[1])}function E(R){var z=R[0],q=R[1];return z*z+q*q}qt.len=j,qt.sub=y,qt.mul=d,qt.div=v,qt.dist=M,qt.sqrDist=k,qt.sqrLen=E;var D,B=(D=h(),function(R,z,q,W,K,oe){var se,ne;for(z||(z=2),q||(q=0),ne=W?Math.min(W*z+q,R.length):R.length,se=q;se<ne;se+=z)D[0]=R[se],D[1]=R[se+1],K(D,D,oe),R[se]=D[0],R[se+1]=D[1];return R});return qt.forEach=B,qt}function rr(){if(an)return U;function u(R){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(z){return typeof z}:function(z){return z&&typeof Symbol=="function"&&z.constructor===Symbol&&z!==Symbol.prototype?"symbol":typeof z},u(R)}an=1,Object.defineProperty(U,"__esModule",{value:!0}),U.vec4=U.vec3=U.vec2=U.quat2=U.quat=U.mat4=U.mat3=U.mat2d=U.mat2=U.glMatrix=void 0;var n=B(H());U.glMatrix=n;var s=B(le());U.mat2=s;var h=B(Se());U.mat2d=h;var y=B(me());U.mat3=y;var d=B(Ye());U.mat4=d;var v=B(Ft());U.quat=v;var M=B(Ze());U.quat2=M;var k=B(cn());U.vec2=k;var j=B(Ot());U.vec3=j;var E=B(bt());function D(R){if(typeof WeakMap!="function")return null;var z=new WeakMap,q=new WeakMap;return(D=function(W){return W?q:z})(R)}function B(R,z){if(R&&R.__esModule)return R;if(R===null||u(R)!=="object"&&typeof R!="function")return{default:R};var q=D(z);if(q&&q.has(R))return q.get(R);var W={},K=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var oe in R)if(oe!=="default"&&Object.prototype.hasOwnProperty.call(R,oe)){var se=K?Object.getOwnPropertyDescriptor(R,oe):null;se&&(se.get||se.set)?Object.defineProperty(W,oe,se):W[oe]=R[oe]}return W.default=R,q&&q.set(R,W),W}return U.vec4=E,U}var mr,Ci,Et,Ln,Ne=rr(),An=function(){if(Ci)return mr;function u(n,s,h,y){this.cx=3*n,this.bx=3*(h-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(y-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=s,this.p2x=h,this.p2y=y}return Ci=1,mr=u,u.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,s){if(s===void 0&&(s=1e-6),n<0)return 0;if(n>1)return 1;for(var h=n,y=0;y<8;y++){var d=this.sampleCurveX(h)-n;if(Math.abs(d)<s)return h;var v=this.sampleCurveDerivativeX(h);if(Math.abs(v)<1e-6)break;h-=d/v}var M=0,k=1;for(h=n,y=0;y<20&&(d=this.sampleCurveX(h),!(Math.abs(d-n)<s));y++)n>d?M=h:k=h,h=.5*(k-M)+M;return h},solve:function(n,s){return this.sampleCurveY(this.solveCurveX(n,s))}},mr}(),qe=P(An);function jr(){if(Ln)return Et;function u(n,s){this.x=n,this.y=s}return Ln=1,Et=u,u.prototype={clone:function(){return new u(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,s){return this.clone()._rotateAround(n,s)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var s=n.x-this.x,h=n.y-this.y;return s*s+h*h},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,s){return Math.atan2(this.x*s-this.y*n,this.x*n+this.y*s)},_matMult:function(n){var s=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=s,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var s=Math.cos(n),h=Math.sin(n),y=h*this.x+s*this.y;return this.x=s*this.x-h*this.y,this.y=y,this},_rotateAround:function(n,s){var h=Math.cos(n),y=Math.sin(n),d=s.y+y*(this.x-s.x)+h*(this.y-s.y);return this.x=s.x+h*(this.x-s.x)-y*(this.y-s.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},u.convert=function(n){return n instanceof u?n:Array.isArray(n)?new u(n[0],n[1]):n},Et}var $t=P(jr());function Ur(u,n){if(Array.isArray(u)){if(!Array.isArray(n)||u.length!==n.length)return!1;for(let s=0;s<u.length;s++)if(!Ur(u[s],n[s]))return!1;return!0}if(typeof u=="object"&&u!==null&&n!==null){if(typeof n!="object"||Object.keys(u).length!==Object.keys(n).length)return!1;for(const s in u)if(!Ur(u[s],n[s]))return!1;return!0}return u===n}const Wr=Math.PI/180,Qi=180/Math.PI;function hr(u){return u*Wr}function vn(u){return u*Qi}const wa=[[0,0],[1,0],[1,1],[0,1]];function La(u){if(u<=0)return 0;if(u>=1)return 1;const n=u*u,s=n*u;return 4*(u<.5?s:3*(u-n)+s-.75)}function ya(u,n,s,h){const y=new qe(u,n,s,h);return function(d){return y.solve(d)}}const ks=ya(.25,.1,.25,1);function Mn(u,n,s){return Math.min(s,Math.max(n,u))}function no(u,n,s){return(s=Mn((s-u)/(n-u),0,1))*s*(3-2*s)}function To(u,n,s){const h=s-n,y=((u-n)%h+h)%h+n;return y===n?s:y}function Ds(u,n,s){if(!u.length)return s(null,[]);let h=u.length;const y=new Array(u.length);let d=null;u.forEach((v,M)=>{n(v,(k,j)=>{k&&(d=k),y[M]=j,--h==0&&s(d,y)})})}function ar(u,...n){for(const s of n)for(const h in s)u[h]=s[h];return u}let Ls=1;function Kr(){return Ls++}function Rr(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))}function ec(u,n){u.forEach(s=>{n[s]&&(n[s]=n[s].bind(n))})}function Ui(u,n){return u.indexOf(n,u.length-n.length)!==-1}function $a(u,n,s){const h={};for(const y in u)h[y]=n.call(this,u[y],y,u);return h}function Er(u,n,s){const h={};for(const y in u)n.call(this,u[y],y,u)&&(h[y]=u[y]);return h}function Sa(u){return Array.isArray(u)?u.map(Sa):typeof u=="object"&&u?$a(u,Sa):u}const za={};function lr(u){za[u]||(typeof console<"u"&&console.warn(u),za[u]=!0)}function _a(u,n,s){return(s.y-u.y)*(n.x-u.x)>(n.y-u.y)*(s.x-u.x)}function Kl(u){let n=0;for(let s,h,y=0,d=u.length,v=d-1;y<d;v=y++)s=u[y],h=u[v],n+=(h.x-s.x)*(s.y+h.y);return n}function $i([u,n,s]){const h=hr(n+90),y=hr(s);return{x:u*Math.cos(h)*Math.sin(y),y:u*Math.sin(h)*Math.sin(y),z:u*Math.cos(y),azimuthal:n,polar:s}}function Zo(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Eo(u){const n={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,h,y,d)=>{const v=y||d;return n[h]=!v||v.toLowerCase(),""}),n["max-age"]){const s=parseInt(n["max-age"],10);isNaN(s)?delete n["max-age"]:n["max-age"]=s}return n}let Al=null;function zs(u,n){return[u[4*n],u[4*n+1],u[4*n+2],u[4*n+3]]}function nl(u,n,s,h){for(;n<s;){const y=n+s>>1;u[y]<h?n=y+1:s=y}return n}function Bn(u,n,s,h){for(;n<s;){const y=n+s>>1;u[y]<=h?n=y+1:s=y}return n}function Jl(u){return u>0?1/(1.001-u):1+u}function Ml(u){return u>0?1-1/(1.001-u):-u}const Mi={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Mi.API_URL)return null;try{const u=new URL(Mi.API_URL);return u.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":u.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function tc(u){return Mi.API_URL_REGEX.test(u)}function Tu(u){return Mi.API_SPRITE_REGEX.test(u)}let Eu,ea,ls,wt,de,xe;function Ie(){return Eu==null&&(Eu=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Eu}const Fe={now:()=>wt!==void 0?wt:performance.now(),setNow(u){wt=u},restoreNow(){wt=void 0},frame(u){const n=requestAnimationFrame(u);return{cancel:()=>cancelAnimationFrame(n)}},getImageData(u,n=0){const{width:s,height:h}=u;de||(de=document.createElement("canvas"));const y=de.getContext("2d",{willReadFrequently:!0});if(!y)throw new Error("failed to create canvas 2d context");return(s>de.width||h>de.height)&&(de.width=s,de.height=h),y.clearRect(-n,-n,s+2*n,h+2*n),y.drawImage(u,0,0,s,h),y.getImageData(-n,-n,s+2*n,h+2*n)},resolveURL:u=>(ea||(ea=document.createElement("a")),ea.href=u,ea.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(ls==null&&(ls=window.matchMedia("(prefers-reduced-motion: reduce)")),ls.matches)},hasCanvasFingerprintNoise(){if(xe!==void 0)return xe;if(!Ie())return xe=!1,!1;const u=new OffscreenCanvas(85,1),n=u.getContext("2d",{willReadFrequently:!0});let s=0;for(let y=0;y<u.width;++y)n.fillStyle=`rgba(${s++},${s++},${s++}, 255)`,n.fillRect(y,0,1,1);const h=n.getImageData(0,0,u.width,u.height);s=0;for(let y=0;y<h.data.length;++y)if(y%4!=3&&s++!==h.data[y])return xe=!0,!0;return xe=!1,!1}};function Xe(u,n){const s=u.indexOf("?");if(s<0)return`${u}?${new URLSearchParams(n).toString()}`;const h=new URLSearchParams(u.slice(s));for(const y in n)h.set(y,n[y]);return`${u.slice(0,s)}?${h.toString()}`}function nt(u,n={persistentParams:[]}){const s=u.indexOf("?");if(s<0)return u;const h=new URLSearchParams,y=new URLSearchParams(u.slice(s));for(const v of n.persistentParams){const M=y.get(v);M&&h.set(v,M)}const d=h.toString();return`${u.slice(0,s)}${d.length>0?`?${d}`:""}`}const ct="mapbox-tiles";let rt=500,vt=50;const gt=["language","worldview","jobid"];let xt,Ct;function un(){try{return caches}catch{}}function hn(){const u=un();u&&xt==null&&(xt=u.open(ct))}let Rn=1/0;const $n={supported:!1,testSupport:function(u){!yr&&Fn&&(Tr?Or(u):Xn=u)}};let Xn,Fn,yr=!1,Tr=!1;const or=typeof self<"u"?self:{};function Or(u){const n=u.createTexture();u.bindTexture(u.TEXTURE_2D,n);try{if(u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,Fn),u.isContextLost())return;$n.supported=!0}catch{}u.deleteTexture(n),yr=!0}or.document&&(Fn=or.document.createElement("img"),Fn.onload=function(){Xn&&Or(Xn),Xn=null,Tr=!0},Fn.onerror=function(){yr=!0,Xn=null},Fn.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Nr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Nr);class Pi extends Error{constructor(n,s,h){s===401&&tc(h)&&(n+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(n),this.status=s,this.url=h}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Ao=Zo()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,ta=function(u,n){if(!(/^file:/.test(s=u.url)||/^file:/.test(Ao())&&!/^\w+:/.test(s))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(h,y){const d=new AbortController,v=new Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,referrer:Ao(),referrerPolicy:h.referrerPolicy,signal:d.signal});let M=!1,k=!1;const j=(E=v.url).indexOf("sku=")>0&&tc(E);var E;h.type==="json"&&v.headers.set("Accept","application/json");const D=(R,z,q)=>{if(k)return;if(R&&R.message!=="SecurityError"&&lr(R.toString()),z&&q)return B(z);const W=Date.now();fetch(v).then(K=>{if(K.ok){const oe=j?K.clone():null;return B(K,oe,W)}return y(new Pi(K.statusText,K.status,h.url))}).catch(K=>{K.name!=="AbortError"&&y(new Error(`${K.message} ${h.url}`))})},B=(R,z,q)=>{(h.type==="arrayBuffer"?R.arrayBuffer():h.type==="json"?R.json():R.text()).then(W=>{k||(z&&q&&function(K,oe,se){if(hn(),xt==null)return;const ne=Eo(oe.headers.get("Cache-Control")||"");if(ne["no-store"])return;const ce={status:oe.status,statusText:oe.statusText,headers:new Headers};oe.headers.forEach((ke,Re)=>ce.headers.set(Re,ke)),ne["max-age"]&&ce.headers.set("Expires",new Date(se+1e3*ne["max-age"]).toUTCString());const pe=ce.headers.get("Expires");if(!pe||new Date(pe).getTime()-se<42e4)return;let we=nt(K.url,{persistentParams:gt});if(oe.status===206){const ke=K.headers.get("Range");if(!ke)return;ce.status=200,we=Xe(we,{range:ke})}(function(ke,Re){if(Ct===void 0)try{new Response(new ReadableStream),Ct=!0}catch{Ct=!1}Ct?Re(ke.body):ke.blob().then(Re)})(oe,ke=>{const Re=new Response((Pe=oe.status)!==200&&Pe!==404&&[101,103,204,205,304].includes(Pe)?null:ke,ce);var Pe;hn(),xt!=null&&xt.then(We=>We.put(we,Re)).catch(We=>lr(We.message))})}(v,z,q),M=!0,y(null,W,R.headers.get("Cache-Control"),R.headers.get("Expires")))}).catch(W=>{k||y(new Error(W.message))})};return j?function(R,z){if(hn(),xt==null)return z(null);xt.then(q=>{let W=nt(R.url,{persistentParams:gt});const K=R.headers.get("Range");K&&(W=Xe(W,{range:K})),q.match(W).then(oe=>{const se=function(ne){if(!ne)return!1;const ce=new Date(ne.headers.get("Expires")||0),pe=Eo(ne.headers.get("Cache-Control")||"");return ce>Date.now()&&!pe["no-cache"]}(oe);q.delete(W),se&&q.put(W,oe.clone()),z(null,oe,se)}).catch(z)}).catch(z)}(v,D):D(null,null),{cancel:()=>{k=!0,M||d.abort()}}}(u,n);if(Zo()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",u,n,void 0,!0)}var s;return function(h,y){const d=new XMLHttpRequest;d.open(h.method||"GET",h.url,!0),h.type==="arrayBuffer"&&(d.responseType="arraybuffer");for(const v in h.headers)d.setRequestHeader(v,h.headers[v]);return h.type==="json"&&(d.responseType="text",d.setRequestHeader("Accept","application/json")),d.withCredentials=h.credentials==="include",d.onerror=()=>{y(new Error(d.statusText))},d.onload=()=>{if((d.status>=200&&d.status<300||d.status===0)&&d.response!==null){let v=d.response;if(h.type==="json")try{v=JSON.parse(d.response)}catch(M){return y(M)}y(null,v,d.getResponseHeader("Cache-Control"),d.getResponseHeader("Expires"))}else y(new Pi(d.statusText,d.status,h.url))},d.send(h.body),{cancel:()=>d.abort()}}(u,n)},Ri=function(u,n){return ta(ar(u,{type:"arrayBuffer"}),n)};function Vi(u){const n=document.createElement("a");return n.href=u,n.protocol===location.protocol&&n.host===location.host}const Au="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let rl,Ns;rl=[],Ns=0;const us=function(u,n){if($n.supported&&(u.headers||(u.headers={}),u.headers.accept="image/webp,*/*"),Ns>=Mi.MAX_PARALLEL_IMAGE_REQUESTS){const d={requestParameters:u,callback:n,cancelled:!1,cancel(){this.cancelled=!0}};return rl.push(d),d}Ns++;let s=!1;const h=()=>{if(!s)for(s=!0,Ns--;rl.length&&Ns<Mi.MAX_PARALLEL_IMAGE_REQUESTS;){const d=rl.shift(),{requestParameters:v,callback:M,cancelled:k}=d;k||(d.cancel=us(v,M).cancel)}},y=Ri(u,(d,v,M,k)=>{h(),d?n(d):v&&(self.createImageBitmap?function(j,E){const D=new Blob([new Uint8Array(j)],{type:"image/png"});createImageBitmap(D).then(B=>{E(null,B)}).catch(B=>{E(new Error(`Could not load image because of ${B.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(v,(j,E)=>n(j,E,M,k)):function(j,E){const D=new Image;D.onload=()=>{E(null,D),URL.revokeObjectURL(D.src),D.onload=null,requestAnimationFrame(()=>{D.src=Au})},D.onerror=()=>E(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const B=new Blob([new Uint8Array(j)],{type:"image/png"});D.src=j.byteLength?URL.createObjectURL(B):Au}(v,(j,E)=>n(j,E,M,k)))});return{cancel:()=>{y.cancel(),h()}}};var cs,Lh,Na,Ha={exports:{}},hs={exports:{}},Bs={exports:{}},Mo=function(){if(Na)return Ha.exports;Na=1;var u=(cs||(cs=1,hs.exports=function(s,h){var y,d,v,M,k,j,E,D;for(d=s.length-(y=3&s.length),v=h,k=3432918353,j=461845907,D=0;D<d;)E=255&s.charCodeAt(D)|(255&s.charCodeAt(++D))<<8|(255&s.charCodeAt(++D))<<16|(255&s.charCodeAt(++D))<<24,++D,v=27492+(65535&(M=5*(65535&(v=(v^=E=(65535&(E=(E=(65535&E)*k+(((E>>>16)*k&65535)<<16)&4294967295)<<15|E>>>17))*j+(((E>>>16)*j&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(M>>>16)&65535)<<16);switch(E=0,y){case 3:E^=(255&s.charCodeAt(D+2))<<16;case 2:E^=(255&s.charCodeAt(D+1))<<8;case 1:v^=E=(65535&(E=(E=(65535&(E^=255&s.charCodeAt(D)))*k+(((E>>>16)*k&65535)<<16)&4294967295)<<15|E>>>17))*j+(((E>>>16)*j&65535)<<16)&4294967295}return v^=s.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0}),hs.exports),n=(Lh||(Lh=1,Bs.exports=function(s,h){for(var y,d=s.length,v=h^d,M=0;d>=4;)y=1540483477*(65535&(y=255&s.charCodeAt(M)|(255&s.charCodeAt(++M))<<8|(255&s.charCodeAt(++M))<<16|(255&s.charCodeAt(++M))<<24))+((1540483477*(y>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(y=1540483477*(65535&(y^=y>>>24))+((1540483477*(y>>>16)&65535)<<16)),d-=4,++M;switch(d){case 3:v^=(255&s.charCodeAt(M+2))<<16;case 2:v^=(255&s.charCodeAt(M+1))<<8;case 1:v=1540483477*(65535&(v^=255&s.charCodeAt(M)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0}),Bs.exports);return Ha.exports=u,Ha.exports.murmur3=u,Ha.exports.murmur2=n,Ha.exports}(),Wo=P(Mo);class Oo{constructor(n,...s){ar(this,s[0]||{}),this.type=n}}class il extends Oo{constructor(n,s={}){super("error",ar({error:n},s))}}function Gf(u,n,s){s[u]&&s[u].indexOf(n)!==-1||(s[u]=s[u]||[],s[u].push(n))}function al(u,n,s){if(s&&s[u]){const h=s[u].indexOf(n);h!==-1&&s[u].splice(h,1)}}class Ol{on(n,s){return this._listeners=this._listeners||{},Gf(n,s,this._listeners),this}off(n,s){return al(n,s,this._listeners),al(n,s,this._oneTimeListeners),this}once(n,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},Gf(n,s,this._oneTimeListeners),this):new Promise(h=>this.once(n,h))}fire(n,s){const h=typeof n=="string"?new Oo(n,s):n,y=h.type;if(this.listens(y)){h.target=this;const d=this._listeners&&this._listeners[y]?this._listeners[y].slice():[];for(const k of d)k.call(this,h);const v=this._oneTimeListeners&&this._oneTimeListeners[y]?this._oneTimeListeners[y].slice():[];for(const k of v)al(y,k,this._oneTimeListeners),k.call(this,h);const M=this._eventedParent;M&&(ar(h,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),M.fire(h))}else h instanceof il&&console.error(h.error);return this}listens(n){return!!(this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n))}setEventedParent(n,s){return this._eventedParent=n,this._eventedParentData=s,this}}var nc,Hi={},Xa=function(){if(nc)return Hi;nc=1;var u={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(d){return(d=Math.round(d))<0?0:d>255?255:d}function s(d){return n(d[d.length-1]==="%"?parseFloat(d)/100*255:parseInt(d))}function h(d){return(v=d[d.length-1]==="%"?parseFloat(d)/100:parseFloat(d))<0?0:v>1?1:v;var v}function y(d,v,M){return M<0?M+=1:M>1&&(M-=1),6*M<1?d+(v-d)*M*6:2*M<1?v:3*M<2?d+(v-d)*(2/3-M)*6:d}try{Hi.parseCSSColor=function(d){var v,M=d.replace(/ /g,"").toLowerCase();if(M in u)return u[M].slice();if(M[0]==="#")return M.length===4?(v=parseInt(M.substr(1),16))>=0&&v<=4095?[(3840&v)>>4|(3840&v)>>8,240&v|(240&v)>>4,15&v|(15&v)<<4,1]:null:M.length===7&&(v=parseInt(M.substr(1),16))>=0&&v<=16777215?[(16711680&v)>>16,(65280&v)>>8,255&v,1]:null;var k=M.indexOf("("),j=M.indexOf(")");if(k!==-1&&j+1===M.length){var E=M.substr(0,k),D=M.substr(k+1,j-(k+1)).split(","),B=1;switch(E){case"rgba":if(D.length!==4)return null;B=h(D.pop());case"rgb":return D.length!==3?null:[s(D[0]),s(D[1]),s(D[2]),B];case"hsla":if(D.length!==4)return null;B=h(D.pop());case"hsl":if(D.length!==3)return null;var R=(parseFloat(D[0])%360+360)%360/360,z=h(D[1]),q=h(D[2]),W=q<=.5?q*(z+1):q+z-q*z,K=2*q-W;return[n(255*y(K,W,R+1/3)),n(255*y(K,W,R)),n(255*y(K,W,R-1/3)),B];default:return null}}return null}}catch{}return Hi}();class Vr{constructor(n,s,h,y=1){this.r=n,this.g=s,this.b=h,this.a=y}static parse(n){if(!n)return;if(n instanceof Vr)return n;if(typeof n!="string")return;const s=Xa.parseCSSColor(n);return s?new Vr(s[0]/255*s[3],s[1]/255*s[3],s[2]/255*s[3],s[3]):void 0}toStringPremultipliedAlpha(){const[n,s,h,y]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(n)},${Math.round(s)},${Math.round(h)},${y})`}toString(){const[n,s,h,y]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*n)},${Math.round(255*s)},${Math.round(255*h)},${y})`}toRenderColor(n){const{r:s,g:h,b:y,a:d}=this;return new Mu(n,s,h,y,d)}clone(){return new Vr(this.r,this.g,this.b,this.a)}}class Mu{constructor(n,s,h,y,d){if(n){const v=n.image.height,M=v*v;s=d===0?0:s/d*(v-1),h=d===0?0:h/d*(v-1),y=d===0?0:y/d*(v-1);const k=Math.floor(s),j=Math.floor(h),E=Math.floor(y),D=Math.ceil(s),B=Math.ceil(h),R=Math.ceil(y),z=s-k,q=h-j,W=y-E,K=n.image.data,oe=4*(k+j*M+E*v),se=4*(k+j*M+R*v),ne=4*(k+B*M+E*v),ce=4*(k+B*M+R*v),pe=4*(D+j*M+E*v),we=4*(D+j*M+R*v),ke=4*(D+B*M+E*v),Re=4*(D+B*M+R*v);if(oe<0||Re>=K.length)throw new Error("out of range");this.r=Nn(Nn(Nn(K[oe],K[se],W),Nn(K[ne],K[ce],W),q),Nn(Nn(K[pe],K[we],W),Nn(K[ke],K[Re],W),q),z)/255*d,this.g=Nn(Nn(Nn(K[oe+1],K[se+1],W),Nn(K[ne+1],K[ce+1],W),q),Nn(Nn(K[pe+1],K[we+1],W),Nn(K[ke+1],K[Re+1],W),q),z)/255*d,this.b=Nn(Nn(Nn(K[oe+2],K[se+2],W),Nn(K[ne+2],K[ce+2],W),q),Nn(Nn(K[pe+2],K[we+2],W),Nn(K[ke+2],K[Re+2],W),q),z)/255*d,this.a=d}else this.r=s,this.g=h,this.b=y,this.a=d}toArray(){const{r:n,g:s,b:h,a:y}=this;return y===0?[0,0,0,0]:[255*n/y,255*s/y,255*h/y,y]}toHslaArray(){if(this.a===0)return[0,0,0,0];const{r:n,g:s,b:h,a:y}=this,d=Math.min(Math.max(n/y,0),1),v=Math.min(Math.max(s/y,0),1),M=Math.min(Math.max(h/y,0),1),k=Math.min(d,v,M),j=Math.max(d,v,M),E=(k+j)/2;if(k===j)return[0,0,100*E,y];const D=j-k,B=E>.5?D/(2-j-k):D/(j+k);let R=0;return j===d?R=(v-M)/D+(v<M?6:0):j===v?R=(M-d)/D+2:j===M&&(R=(d-v)/D+4),R*=60,[Math.min(Math.max(R,0),360),Math.min(Math.max(100*B,0),100),Math.min(Math.max(100*E,0),100),y]}toArray01(){const{r:n,g:s,b:h,a:y}=this;return y===0?[0,0,0,0]:[n/y,s/y,h/y,y]}toArray01Scaled(n){const{r:s,g:h,b:y,a:d}=this;return d===0?[0,0,0]:[s/d*n,h/d*n,y/d*n]}toArray01PremultipliedAlpha(){const{r:n,g:s,b:h,a:y}=this;return[n,s,h,y]}toArray01Linear(){const{r:n,g:s,b:h,a:y}=this;return y===0?[0,0,0,0]:[Math.pow(n/y,2.2),Math.pow(s/y,2.2),Math.pow(h/y,2.2),y]}}function Nn(u,n,s){return u*(1-s)+n*s}function Ya(u,n,s){return u.map((h,y)=>Nn(h,n[y],s))}Vr.black=new Vr(0,0,0,1),Vr.white=new Vr(1,1,1,1),Vr.transparent=new Vr(0,0,0,0),Vr.red=new Vr(1,0,0,1),Vr.blue=new Vr(0,0,1,1);var fs=Object.freeze({__proto__:null,array:Ya,color:function(u,n,s){return new Vr(Nn(u.r,n.r,s),Nn(u.g,n.g,s),Nn(u.b,n.b,s),Nn(u.a,n.a,s))},number:Nn});function Yc(u,...n){for(const s of n)for(const h in s)u[h]=s[h];return u}class _r extends Error{constructor(n,s){super(s),this.message=s,this.key=n}}class rc{constructor(n,s=[]){this.parent=n,this.bindings={};for(const[h,y]of s)this.bindings[h]=y}concat(n){return new rc(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const Lo={kind:"null"},kn={kind:"number"},qr={kind:"string"},Vn={kind:"boolean"},zi={kind:"color"},zo={kind:"object"},Br={kind:"value"},ds={kind:"collator"},No={kind:"formatted"},Ta={kind:"resolvedImage"};function di(u,n){return{kind:"array",itemType:u,N:n}}function ui(u){if(u.kind==="array"){const n=ui(u.itemType);return typeof u.N=="number"?`array<${n}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${n}>`}return u.kind}const Ou=[Lo,kn,qr,Vn,zi,No,zo,di(Br),Ta];function Ea(u,n){if(n.kind==="error")return null;if(u.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!Ea(u.itemType,n.itemType))&&(typeof u.N!="number"||u.N===n.N))return null}else{if(u.kind===n.kind)return null;if(u.kind==="value"){for(const s of Ou)if(!Ea(s,n))return null}}return`Expected ${ui(u)} but found ${ui(n)} instead.`}function zh(u,n){return n.some(s=>s.kind===u.kind)}function Ql(u,n){return n.some(s=>s==="null"?u===null:s==="array"?Array.isArray(u):s==="object"?u&&!Array.isArray(u)&&typeof u=="object":s===typeof u)}class Bo{constructor(n,s,h){this.sensitivity=n?s?"variant":"case":s?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,s){return this.collator.compare(n,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ps{constructor(n,s,h,y,d){this.text=n.normalize?n.normalize():n,this.image=s,this.scale=h,this.fontStack=y,this.textColor=d}}class Aa{constructor(n){this.sections=n}static fromString(n){return new Aa([new ps(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.namePrimary)}static factory(n){return n instanceof Aa?n:Aa.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}serialize(){const n=["format"];for(const s of this.sections){if(s.image){n.push(["image",s.image.namePrimary]);continue}n.push(s.text);const h={};s.fontStack&&(h["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(h["font-scale"]=s.scale),s.textColor&&(h["text-color"]=["rgba"].concat(s.textColor.toRenderColor(null).toArray())),n.push(h)}return n}}class da{constructor(n,s){if(this.id=n,this.options=s||{params:{}},this.options.transform){const{a:h,b:y,c:d,d:v,e:M,f:k}=this.options.transform;this.options.transform=new DOMMatrix([h,y,d,v,M,k])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}static deserializeId(n){return JSON.parse(n).id}static deserializeFromString(n){const s=JSON.parse(n),{a:h,b:y,c:d,d:v,e:M,f:k}=s.options.transform;return new DOMMatrix([h,y,d,v,M,k]),new da(s.id,s.options)}scaleSelf(n){return this.options.transform=this.options.transform.scale(n),this}serialize(){const n={id:this.id};this.options&&(n.options=this.options);const{a:s,b:h,c:y,d,e:v,f:M}=this.options.transform;return n.options.transform={a:s,b:h,c:y,d,e:v,f:M},JSON.stringify(n)}}class la{constructor(n){this.namePrimary=n.namePrimary,n.nameSecondary&&(this.nameSecondary=n.nameSecondary),n.optionsPrimary&&(this.optionsPrimary=n.optionsPrimary),n.optionsSecondary&&(this.optionsSecondary=n.optionsSecondary),this.available=n.available}toString(){return this.namePrimary&&this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}getPrimary(){return new da(this.namePrimary,{params:this.optionsPrimary&&this.optionsPrimary.params||{}})}getSerializedPrimary(){return this.getPrimary().serialize()}getSecondary(){return this.nameSecondary?new da(this.nameSecondary,{params:this.optionsSecondary&&this.optionsSecondary.params||{}}):null}static from(n){return typeof n=="string"?la.build(n):n}static build(n,s,h,y){return n?new la({namePrimary:n,nameSecondary:s,optionsPrimary:h,optionsSecondary:y,available:!1}):null}}function $f(u,n,s,h){return typeof u=="number"&&u>=0&&u<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof s=="number"&&s>=0&&s<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[u,n,s,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[u,n,s,h]:[u,n,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Fo(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof Vr||u instanceof Bo||u instanceof Aa||u instanceof la)return!0;if(Array.isArray(u)){for(const n of u)if(!Fo(n))return!1;return!0}if(typeof u=="object"){for(const n in u)if(!Fo(u[n]))return!1;return!0}return!1}function Oi(u){if(u===null)return Lo;if(typeof u=="string")return qr;if(typeof u=="boolean")return Vn;if(typeof u=="number")return kn;if(u instanceof Vr)return zi;if(u instanceof Bo)return ds;if(u instanceof Aa)return No;if(u instanceof la)return Ta;if(Array.isArray(u)){const n=u.length;let s;for(const h of u){const y=Oi(h);if(s){if(s===y)continue;s=Br;break}s=y}return di(s||Br,n)}return zo}function ro(u){const n=typeof u;return u===null?"":n==="string"||n==="number"||n==="boolean"?String(u):u instanceof Vr?u.toStringPremultipliedAlpha():u instanceof Aa||u instanceof la?u.toString():JSON.stringify(u)}class Ba{constructor(n,s){this.type=n,this.value=s}static parse(n,s){if(n.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!Fo(n[1]))return s.error("invalid value");const h=n[1];let y=Oi(h);const d=s.expectedType;return y.kind!=="array"||y.N!==0||!d||d.kind!=="array"||typeof d.N=="number"&&d.N!==0||(y=d),new Ba(y,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Vr?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof Aa?this.value.serialize():this.value}}class pi{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const ic={string:qr,number:kn,boolean:Vn,object:zo};class Fs{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");let h,y=1;const d=n[0];if(d==="array"){let M,k;if(n.length>2){const j=n[1];if(typeof j!="string"||!(j in ic)||j==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);M=ic[j],y++}else M=Br;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return s.error('The length argument to "array" must be a positive integer literal',2);k=n[2],y++}h=di(M,k)}else h=ic[d];const v=[];for(;y<n.length;y++){const M=s.parse(n[y],y,Br);if(!M)return null;v.push(M)}return new Fs(h,v)}evaluate(n){for(let s=0;s<this.args.length;s++){const h=this.args[s].evaluate(n);if(!Ea(this.type,Oi(h)))return h;if(s===this.args.length-1)throw new pi(`The expression ${JSON.stringify(this.args[s].serialize())} evaluated to ${ui(Oi(h))} but was expected to be of type ${ui(this.type)}.`)}return null}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=this.type,s=[n.kind];if(n.kind==="array"){const h=n.itemType;if(h.kind==="string"||h.kind==="number"||h.kind==="boolean"){s.push(h.kind);const y=n.N;(typeof y=="number"||this.args.length>1)&&s.push(y)}}return s.concat(this.args.map(h=>h.serialize()))}}class eu{constructor(n){this.type=No,this.sections=n}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const h=n[1];if(!Array.isArray(h)&&typeof h=="object")return s.error("First argument must be an image or text section.");const y=[];let d=!1;for(let v=1;v<=n.length-1;++v){const M=n[v];if(d&&typeof M=="object"&&!Array.isArray(M)){d=!1;let k=null;if(M["font-scale"]&&(k=s.parseObjectValue(M["font-scale"],v,"font-scale",kn),!k))return null;let j=null;if(M["text-font"]&&(j=s.parseObjectValue(M["text-font"],v,"text-font",di(qr)),!j))return null;let E=null;if(M["text-color"]&&(E=s.parseObjectValue(M["text-color"],v,"text-color",zi),!E))return null;const D=y[y.length-1];D.scale=k,D.font=j,D.textColor=E}else{const k=s.parse(n[v],v,Br);if(!k)return null;const j=k.type.kind;if(j!=="string"&&j!=="value"&&j!=="null"&&j!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");d=!0,y.push({content:k,scale:null,font:null,textColor:null})}}return new eu(y)}evaluate(n){return new Aa(this.sections.map(s=>{const h=s.content.evaluate(n);return Oi(h)===Ta?new ps("",h,null,null,null):new ps(ro(h),null,s.scale?s.scale.evaluate(n):null,s.font?s.font.evaluate(n).join(","):null,s.textColor?s.textColor.evaluate(n):null)}))}eachChild(n){for(const s of this.sections)n(s.content),s.scale&&n(s.scale),s.font&&n(s.font),s.textColor&&n(s.textColor)}outputDefined(){return!1}serialize(){const n=["format"];for(const s of this.sections){n.push(s.content.serialize());const h={};s.scale&&(h["font-scale"]=s.scale.serialize()),s.font&&(h["text-font"]=s.font.serialize()),s.textColor&&(h["text-color"]=s.textColor.serialize()),n.push(h)}return n}}class Zc{constructor(n,s,h,y){this._imageWarnHistory={},this.type=Ta,this.inputPrimary=n,this.inputSecondary=s,this.inputPrimaryParams=h,this.inputSecondaryParams=y}static parse(n,s){if(n.length<2)return s.error("Expected two or more arguments.");let h=1;const y=[];function d(){if(h<n.length){const M=s.parse(n[h],h++,qr);return M?(y.push({image:M,options:void 0}),!0):(s.error(y.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function v(){if(h<n.length){if((M=n[h])===null||typeof M!="object"||Array.isArray(M))return!0;const k=n[h].params,j=s.concat(h);if(!k)return h++,!0;if(typeof k!="object"||k.constructor!==Object)return j.error('Image options "params" should be an object'),!1;const E={},D=j.concat(void 0,"params");for(const B in k){if(!B)return D.error("Image parameter name should be non-empty"),!1;const R=D.concat(void 0,B).parse(k[B],void 0,zi,void 0,{typeAnnotation:"coerce"});if(!R)return!1;E[B]=R}return y[y.length-1].options=E,h++,!0}var M;return!0}for(let M=0;M<2;M++)if(!d()||!v())return;return new Zc(y[0].image,y[1]?y[1].image:void 0,y[0].options,y[1]?y[1].options:void 0)}evaluateParams(n,s){const h={};if(s){for(const y in s)if(s[y])try{const d=s[y].evaluate(n),v=`Ignoring image parameter "${y}" with semi-transparent color ${d.toString()}`;if(d.a!==1){this._imageWarnHistory[v]||(console.warn(v),this._imageWarnHistory[v]=!0);continue}h[y]=d}catch{continue}if(Object.keys(h).length!==0)return{params:h}}}evaluate(n){const s=la.build(this.inputPrimary.evaluate(n),this.inputSecondary?this.inputSecondary.evaluate(n):void 0,this.inputPrimaryParams?this.evaluateParams(n,this.inputPrimaryParams):void 0,this.inputSecondaryParams?this.evaluateParams(n,this.inputSecondaryParams):void 0);return s&&n.availableImages&&(s.available=n.availableImages.indexOf(s.namePrimary)>-1,s.nameSecondary&&s.available&&n.availableImages&&(s.available=n.availableImages.indexOf(s.nameSecondary)>-1)),s}eachChild(n){if(n(this.inputPrimary),this.inputPrimaryParams)for(const s in this.inputPrimaryParams)this.inputPrimaryParams[s]&&n(this.inputPrimaryParams[s]);if(this.inputSecondary&&(n(this.inputSecondary),this.inputSecondaryParams))for(const s in this.inputSecondaryParams)this.inputSecondaryParams[s]&&n(this.inputSecondaryParams[s])}outputDefined(){return!1}serializeParams(n){const s={};if(n){for(const h in n)n[h]&&(s[h]=n[h].serialize());return{params:s}}}serialize(){const n=["image",this.inputPrimary.serialize()];return this.inputPrimaryParams&&n.push(this.serializeParams(this.inputPrimaryParams)),this.inputSecondary&&(n.push(this.inputSecondary.serialize()),this.inputSecondaryParams&&n.push(this.serializeParams(this.inputSecondaryParams))),n}}function js(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}const Hf={"to-boolean":Vn,"to-color":zi,"to-number":kn,"to-string":qr};class Il{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const h=n[0],y=[];let d=Lo;if(h==="to-array"){if(!Array.isArray(n[1]))return null;const v=n[1].length;if(s.expectedType){if(s.expectedType.kind!=="array")return s.error(`Expected ${s.expectedType.kind} but found array.`);d=di(s.expectedType.itemType,v)}else{if(!(v>0&&Fo(n[1][0])))return null;d=di(Oi(n[1][0]),v)}for(let M=0;M<v;M++){const k=n[1][M];let j;if(js(k)==="array")j=s.parse(k,void 0,d.itemType);else{const E=js(k);if(E!==d.itemType.kind)return s.error(`Expected ${d.itemType.kind} but found ${E}.`);j=s.registry.literal.parse(["literal",k===void 0?null:k],s)}if(!j)return null;y.push(j)}}else{if((h==="to-boolean"||h==="to-string")&&n.length!==2)return s.error("Expected one argument.");d=Hf[h];for(let v=1;v<n.length;v++){const M=s.parse(n[v],v,Br);if(!M)return null;y.push(M)}}return new Il(d,y)}evaluate(n){if(this.type.kind==="boolean")return!!this.args[0].evaluate(n);if(this.type.kind==="color"){let s,h;for(const y of this.args){if(s=y.evaluate(n),h=null,s instanceof Vr)return s;if(typeof s=="string"){const d=n.parseColor(s);if(d)return d}else if(Array.isArray(s)&&(h=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:$f(s[0],s[1],s[2],s[3]),!h))return new Vr(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new pi(h||`Could not parse color from value '${typeof s=="string"?s:String(JSON.stringify(s))}'`)}if(this.type.kind==="number"){let s=null;for(const h of this.args){if(s=h.evaluate(n),s===null)return 0;const y=Number(s);if(!isNaN(y))return y}throw new pi(`Could not convert ${JSON.stringify(s)} to number.`)}return this.type.kind==="formatted"?Aa.fromString(ro(this.args[0].evaluate(n))):this.type.kind==="resolvedImage"?la.build(ro(this.args[0].evaluate(n))):this.type.kind==="array"?this.args.map(s=>s.evaluate(n)):ro(this.args[0].evaluate(n))}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){if(this.type.kind==="formatted")return new eu([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Zc(this.args[0]).serialize();const n=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(s=>{n.push(s.serialize())}),n}}const Xf=["Unknown","Point","LineString","Polygon"];class Cl{constructor(n,s){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=n,this.options=s}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Xf[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(n){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:h,y}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(h*s-n[0])+this.featureDistanceData.bearing[1]*(y*s-n[1])}return 0}parseColor(n){let s=this._parseColorCache[n];return s||(s=this._parseColorCache[n]=Vr.parse(n)),s}getConfig(n){return this.options?this.options.get(n):null}}class qi{constructor(n,s,h,y,d){this.name=n,this.type=s,this._evaluate=h,this.args=y,this._overloadIndex=d}evaluate(n){if(!this._evaluate){const s=qi.definitions[this.name];this._evaluate=Array.isArray(s)?s[2]:s.overloads[this._overloadIndex][1]}return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(n=>n.serialize()))}static parse(n,s){const h=n[0],y=qi.definitions[h];if(!y)return s.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const d=Array.isArray(y)?y[0]:y.type,v=Array.isArray(y)?[[y[1],y[2]]]:y.overloads,M=[];let k=null,j=-1;for(const[E,D]of v){if(Array.isArray(E)&&E.length!==n.length-1)continue;M.push(E),j++,k=new Pl(s.registry,s.path,null,s.scope,void 0,s._scope,s.options);const B=[];let R=!1;for(let z=1;z<n.length;z++){const q=n[z],W=Array.isArray(E)?E[z-1]:E.type,K=k.parse(q,1+B.length,W);if(!K){R=!0;break}B.push(K)}if(!R)if(Array.isArray(E)&&E.length!==B.length)k.error(`Expected ${E.length} arguments, but found ${B.length} instead.`);else{for(let z=0;z<B.length;z++){const q=Array.isArray(E)?E[z]:E.type,W=B[z];k.concat(z+1).checkSubtype(q,W.type)}if(k.errors.length===0)return new qi(h,d,D,B,j)}}if(M.length===1)s.errors.push(...k.errors);else{const E=(M.length?M:v.map(([B])=>B)).map(Yf).join(" | "),D=[];for(let B=1;B<n.length;B++){const R=s.parse(n[B],1+D.length);if(!R)return null;D.push(ui(R.type))}s.error(`Expected arguments of type ${E}, but found (${D.join(", ")}) instead.`)}return null}static register(n,s){qi.definitions=s;for(const h in s)n[h]=qi}}function Yf(u){return Array.isArray(u)?`(${u.map(ui).join(", ")})`:`(${ui(u.type)}...)`}class ac{constructor(n,s,h){this.type=ds,this.locale=h,this.caseSensitive=n,this.diacriticSensitive=s}static parse(n,s){if(n.length!==2)return s.error("Expected one argument.");const h=n[1];if(typeof h!="object"||Array.isArray(h))return s.error("Collator options argument must be an object.");const y=h["case-sensitive"]===void 0?s.parse(!1,1,Vn):s.parseObjectValue(h["case-sensitive"],1,"case-sensitive",Vn);if(!y)return null;const d=h["diacritic-sensitive"]===void 0?s.parse(!1,1,Vn):s.parseObjectValue(h["diacritic-sensitive"],1,"diacritic-sensitive",Vn);if(!d)return null;let v=null;return h.locale&&(v=s.parseObjectValue(h.locale,1,"locale",qr),!v)?null:new ac(y,d,v)}evaluate(n){return new Bo(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}serialize(){const n={};return n["case-sensitive"]=this.caseSensitive.serialize(),n["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(n.locale=this.locale.serialize()),["collator",n]}}function Wc(u,n,s=0,h=u.length-1,y=np){for(;h>s;){if(h-s>600){const k=h-s+1,j=n-s+1,E=Math.log(k),D=.5*Math.exp(2*E/3),B=.5*Math.sqrt(E*D*(k-D)/k)*(j-k/2<0?-1:1);Wc(u,n,Math.max(s,Math.floor(n-j*D/k+B)),Math.min(h,Math.floor(n+(k-j)*D/k+B)),y)}const d=u[n];let v=s,M=h;for(Iu(u,s,n),y(u[h],d)>0&&Iu(u,s,h);v<M;){for(Iu(u,v,M),v++,M--;y(u[v],d)<0;)v++;for(;y(u[M],d)>0;)M--}y(u[s],d)===0?Iu(u,s,M):(M++,Iu(u,M,h)),M<=n&&(s=M+1),n<=M&&(h=M-1)}}function Iu(u,n,s){const h=u[n];u[n]=u[s],u[s]=h}function np(u,n){return u<n?-1:u>n?1:0}function Zf(u){let n=0;for(let s,h,y=0,d=u.length,v=d-1;y<d;v=y++)s=u[y],h=u[v],n+=(h.x-s.x)*(s.y+h.y);return n}function oc(u,n){u[0]=Math.min(u[0],n[0]),u[1]=Math.min(u[1],n[1]),u[2]=Math.max(u[2],n[0]),u[3]=Math.max(u[3],n[1])}function Io(u,n){return!(u[0]<=n[0]||u[2]>=n[2]||u[1]<=n[1]||u[3]>=n[3])}function rp(u,n,s){const h=u[0]-n[0],y=u[1]-n[1],d=u[0]-s[0],v=u[1]-s[1];return h*v-d*y==0&&h*d<=0&&y*v<=0}function Za(u,n,s=!1){let h=!1;for(let M=0,k=n.length;M<k;M++){const j=n[M];for(let E=0,D=j.length,B=D-1;E<D;B=E++){const R=j[B],z=j[E];if(rp(u,R,z))return s;(d=R)[1]>(y=u)[1]!=(v=z)[1]>y[1]&&y[0]<(v[0]-d[0])*(y[1]-d[1])/(v[1]-d[1])+d[0]&&(h=!h)}}var y,d,v;return h}function Cu(u,n,s,h){const y=h[0]-s[0],d=h[1]-s[1],v=(u[0]-s[0])*d-y*(u[1]-s[1]),M=(n[0]-s[0])*d-y*(n[1]-s[1]);return v>0&&M<0||v<0&&M>0}function Us(u,n,s,h){return(y=[h[0]-s[0],h[1]-s[1]])[0]*(d=[n[0]-u[0],n[1]-u[1]])[1]-y[1]*d[0]!=0&&!(!Cu(u,n,s,h)||!Cu(s,h,u,n));var y,d}const Ko=8192;function ip(u,n){const s=(180+u[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,y=Math.pow(2,n.z);return[Math.round(s*y*Ko),Math.round(h*y*Ko)]}function Kc(u,n){for(let s=0;s<n.length;s++)if(Za(u,n[s]))return!0;return!1}function Nh(u,n,s){for(const h of s)for(let y=0,d=h.length,v=d-1;y<d;v=y++)if(Us(u,n,h[v],h[y]))return!0;return!1}function Wf(u,n){for(let s=0;s<u.length;++s)if(!Za(u[s],n))return!1;for(let s=0;s<u.length-1;++s)if(Nh(u[s],u[s+1],n))return!1;return!0}function ap(u,n){for(let s=0;s<n.length;s++)if(Wf(u,n[s]))return!0;return!1}function Bh(u,n,s){const h=[];for(let y=0;y<u.length;y++){const d=[];for(let v=0;v<u[y].length;v++){const M=ip(u[y][v],s);oc(n,M),d.push(M)}h.push(d)}return h}function ms(u,n,s){const h=[];for(let y=0;y<u.length;y++){const d=Bh(u[y],n,s);h.push(d)}return h}function vr(u,n,s,h){if(u[0]<s[0]||u[0]>s[2]){const y=.5*h;let d=u[0]-s[0]>y?-h:s[0]-u[0]>y?h:0;d===0&&(d=u[0]-s[2]>y?-h:s[2]-u[0]>y?h:0),u[0]+=d}oc(n,u)}function qn(u,n,s,h){const y=Math.pow(2,h.z)*Ko,d=[h.x*Ko,h.y*Ko],v=[];if(!u)return v;for(const M of u)for(const k of M){const j=[k.x+d[0],k.y+d[1]];vr(j,n,s,y),v.push(j)}return v}function Fh(u,n,s,h){const y=Math.pow(2,h.z)*Ko,d=[h.x*Ko,h.y*Ko],v=[];if(!u)return v;for(const k of u){const j=[];for(const E of k){const D=[E.x+d[0],E.y+d[1]];oc(n,D),j.push(D)}v.push(j)}if(n[2]-n[0]<=y/2){(M=n)[0]=M[1]=1/0,M[2]=M[3]=-1/0;for(const k of v)for(const j of k)vr(j,n,s,y)}var M;return v}class Qn{constructor(n,s){this.type=Vn,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(Fo(n[1])){const h=n[1];if(h.type==="FeatureCollection")for(let y=0;y<h.features.length;++y){const d=h.features[y].geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new Qn(h,h.features[y].geometry)}else if(h.type==="Feature"){const y=h.geometry.type;if(y==="Polygon"||y==="MultiPolygon")return new Qn(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new Qn(h,h)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(s,h){const y=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],v=s.canonicalID();if(!v)return!1;if(h.type==="Polygon"){const M=Bh(h.coordinates,d,v),k=qn(s.geometry(),y,d,v);if(!Io(y,d))return!1;for(const j of k)if(!Za(j,M))return!1}if(h.type==="MultiPolygon"){const M=ms(h.coordinates,d,v),k=qn(s.geometry(),y,d,v);if(!Io(y,d))return!1;for(const j of k)if(!Kc(j,M))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(s,h){const y=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],v=s.canonicalID();if(!v)return!1;if(h.type==="Polygon"){const M=Bh(h.coordinates,d,v),k=Fh(s.geometry(),y,d,v);if(!Io(y,d))return!1;for(const j of k)if(!Wf(j,M))return!1}if(h.type==="MultiPolygon"){const M=ms(h.coordinates,d,v),k=Fh(s.geometry(),y,d,v);if(!Io(y,d))return!1;for(const j of k)if(!ap(j,M))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const tu={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},nu=1/298.257223563,Wn=nu*(2-nu),sc=Math.PI/180;class ol{static fromTile(n,s,h){const y=Math.PI*(1-2*(n+.5)/Math.pow(2,s)),d=Math.atan(.5*(Math.exp(y)-Math.exp(-y)))/sc;return new ol(d,h)}static get units(){return tu}constructor(n,s){if(n===void 0)throw new Error("No latitude given.");if(s&&!tu[s])throw new Error(`Unknown unit ${s}. Use one of: ${Object.keys(tu).join(", ")}`);const h=6378.137*sc*(s?tu[s]:1),y=Math.cos(n*sc),d=1/(1-Wn*(1-y*y)),v=Math.sqrt(d);this.kx=h*v*y,this.ky=h*v*d*(1-Wn)}distance(n,s){const h=io(n[0]-s[0])*this.kx,y=(n[1]-s[1])*this.ky;return Math.sqrt(h*h+y*y)}bearing(n,s){const h=io(s[0]-n[0])*this.kx;return Math.atan2(h,(s[1]-n[1])*this.ky)/sc}destination(n,s,h){const y=h*sc;return this.offset(n,Math.sin(y)*s,Math.cos(y)*s)}offset(n,s,h){return[n[0]+s/this.kx,n[1]+h/this.ky]}lineDistance(n){let s=0;for(let h=0;h<n.length-1;h++)s+=this.distance(n[h],n[h+1]);return s}area(n){let s=0;for(let h=0;h<n.length;h++){const y=n[h];for(let d=0,v=y.length,M=v-1;d<v;M=d++)s+=io(y[d][0]-y[M][0])*(y[d][1]+y[M][1])*(h?-1:1)}return Math.abs(s)/2*this.kx*this.ky}along(n,s){let h=0;if(s<=0)return n[0];for(let y=0;y<n.length-1;y++){const d=n[y],v=n[y+1],M=this.distance(d,v);if(h+=M,h>s)return Jc(d,v,(s-(h-M))/M)}return n[n.length-1]}pointToSegmentDistance(n,s,h){let[y,d]=s,v=io(h[0]-y)*this.kx,M=(h[1]-d)*this.ky;if(v!==0||M!==0){const k=(io(n[0]-y)*this.kx*v+(n[1]-d)*this.ky*M)/(v*v+M*M);k>1?(y=h[0],d=h[1]):k>0&&(y+=v/this.kx*k,d+=M/this.ky*k)}return v=io(n[0]-y)*this.kx,M=(n[1]-d)*this.ky,Math.sqrt(v*v+M*M)}pointOnLine(n,s){let h=1/0,y=n[0][0],d=n[0][1],v=0,M=0;for(let k=0;k<n.length-1;k++){let j=n[k][0],E=n[k][1],D=io(n[k+1][0]-j)*this.kx,B=(n[k+1][1]-E)*this.ky,R=0;D===0&&B===0||(R=(io(s[0]-j)*this.kx*D+(s[1]-E)*this.ky*B)/(D*D+B*B),R>1?(j=n[k+1][0],E=n[k+1][1]):R>0&&(j+=D/this.kx*R,E+=B/this.ky*R)),D=io(s[0]-j)*this.kx,B=(s[1]-E)*this.ky;const z=D*D+B*B;z<h&&(h=z,y=j,d=E,v=k,M=R)}return{point:[y,d],index:v,t:Math.max(0,Math.min(1,M))}}lineSlice(n,s,h){let y=this.pointOnLine(h,n),d=this.pointOnLine(h,s);if(y.index>d.index||y.index===d.index&&y.t>d.t){const j=y;y=d,d=j}const v=[y.point],M=y.index+1,k=d.index;!jh(h[M],v[0])&&M<=k&&v.push(h[M]);for(let j=M+1;j<=k;j++)v.push(h[j]);return jh(h[k],d.point)||v.push(d.point),v}lineSliceAlong(n,s,h){let y=0;const d=[];for(let v=0;v<h.length-1;v++){const M=h[v],k=h[v+1],j=this.distance(M,k);if(y+=j,y>n&&d.length===0&&d.push(Jc(M,k,(n-(y-j))/j)),y>=s)return d.push(Jc(M,k,(s-(y-j))/j)),d;y>n&&d.push(k)}return d}bufferPoint(n,s){const h=s/this.ky,y=s/this.kx;return[n[0]-y,n[1]-h,n[0]+y,n[1]+h]}bufferBBox(n,s){const h=s/this.ky,y=s/this.kx;return[n[0]-y,n[1]-h,n[2]+y,n[3]+h]}insideBBox(n,s){return io(n[0]-s[0])>=0&&io(n[0]-s[2])<=0&&n[1]>=s[1]&&n[1]<=s[3]}}function jh(u,n){return u[0]===n[0]&&u[1]===n[1]}function Jc(u,n,s){const h=io(n[0]-u[0]);return[u[0]+h*s,u[1]+(n[1]-u[1])*s]}function io(u){for(;u<-180;)u+=360;for(;u>180;)u-=360;return u}class Ma{constructor(n=[],s=(h,y)=>h<y?-1:h>y?1:0){if(this.data=n,this.length=this.data.length,this.compare=s,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:s,compare:h}=this,y=s[n];for(;n>0;){const d=n-1>>1,v=s[d];if(h(y,v)>=0)break;s[n]=v,n=d}s[n]=y}_down(n){const{data:s,compare:h}=this,y=this.length>>1,d=s[n];for(;n<y;){let v=1+(n<<1);const M=v+1;if(M<this.length&&h(s[M],s[v])<0&&(v=M),h(s[v],d)>=0)break;s[n]=s[v],n=v}s[n]=d}}var pn=8192;function Qc(u,n){return n.dist-u.dist}const lc=100,uc=50;function ru(u){const n=[1/0,1/0,-1/0,-1/0];if(n.length!==u.length)return!1;for(let s=0;s<n.length;s++)if(n[s]!==u[s])return!1;return!0}function Oa(u){return u[1]-u[0]+1}function Vs(u,n){const s=u[1]>=u[0]&&u[1]<n;return s||console.warn("Distance Expression: Index is out of range"),s}function Kf(u,n){if(u[0]>u[1])return[null,null];const s=Oa(u);if(n){if(s===2)return[u,null];const h=Math.floor(s/2);return[[u[0],u[0]+h],[u[0]+h,u[1]]]}{if(s===1)return[u,null];const h=Math.floor(s/2)-1;return[[u[0],u[0]+h],[u[0]+h+1,u[1]]]}}function Ia(u,n){const s=[1/0,1/0,-1/0,-1/0];if(!Vs(n,u.length))return s;for(let h=n[0];h<=n[1];++h)oc(s,u[h]);return s}function gs(u){const n=[1/0,1/0,-1/0,-1/0];for(let s=0;s<u.length;++s)for(let h=0;h<u[s].length;++h)oc(n,u[s][h]);return n}function iu(u,n,s){if(ru(u)||ru(n))return NaN;let h=0,y=0;return u[2]<n[0]&&(h=n[0]-u[2]),u[0]>n[2]&&(h=u[0]-n[2]),u[1]>n[3]&&(y=u[1]-n[3]),u[3]<n[1]&&(y=n[1]-u[3]),s.distance([0,0],[h,y])}function Uh(u){return 360*u-180}function Pu(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function Vh(u,n){const s=Math.pow(2,n.z),h=(u.y/pn+n.y)/s;return[Uh((u.x/pn+n.x)/s),Pu(h)]}function qh(u,n){const s=[];for(let h=0;h<u.length;++h)s.push(Vh(u[h],n));return s}function Jo(u,n,s){const h=s.pointOnLine(n,u).point;return s.distance(u,h)}function ys(u,n,s,h,y){const d=s.slice(h[0],h[1]+1);let v=1/0;for(let M=n[0];M<=n[1];++M)if((v=Math.min(v,Jo(u[M],d,y)))===0)return 0;return v}function C(u,n,s,h,y){const d=Math.min(y.pointToSegmentDistance(u,s,h),y.pointToSegmentDistance(n,s,h)),v=Math.min(y.pointToSegmentDistance(s,u,n),y.pointToSegmentDistance(h,u,n));return Math.min(d,v)}function g(u,n,s,h,y){if(!Vs(n,u.length)||!Vs(h,s.length))return NaN;let d=1/0;for(let v=n[0];v<n[1];++v)for(let M=h[0];M<h[1];++M){if(Us(u[v],u[v+1],s[M],s[M+1]))return 0;d=Math.min(d,C(u[v],u[v+1],s[M],s[M+1],y))}return d}function x(u,n,s,h,y){if(!Vs(n,u.length)||!Vs(h,s.length))return NaN;let d=1/0;for(let v=n[0];v<=n[1];++v)for(let M=h[0];M<=h[1];++M)if((d=Math.min(d,y.distance(u[v],s[M])))===0)return d;return d}function O(u,n,s){if(Za(u,n,!0))return 0;let h=1/0;for(const y of n){const d=y.length;if(d<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(y[0]!==y[d-1]&&(h=Math.min(h,s.pointToSegmentDistance(u,y[d-1],y[0])))===0||(h=Math.min(h,Jo(u,y,s)))===0)return h}return h}function $(u,n,s,h){if(!Vs(n,u.length))return NaN;for(let d=n[0];d<=n[1];++d)if(Za(u[d],s,!0))return 0;let y=1/0;for(let d=n[0];d<n[1];++d)for(const v of s)for(let M=0,k=v.length,j=k-1;M<k;j=M++){if(Us(u[d],u[d+1],v[j],v[M]))return 0;y=Math.min(y,C(u[d],u[d+1],v[j],v[M],h))}return y}function te(u,n){for(const s of u)for(let h=0;h<=s.length-1;++h)if(Za(s[h],n,!0))return!0;return!1}function he(u,n,s,h=1/0){const y=gs(u),d=gs(n);if(h!==1/0&&iu(y,d,s)>=h)return h;if(Io(y,d)){if(te(u,n))return 0}else if(te(n,u))return 0;let v=h;for(const M of u)for(let k=0,j=M.length,E=j-1;k<j;E=k++)for(const D of n)for(let B=0,R=D.length,z=R-1;B<R;z=B++){if(Us(M[E],M[k],D[z],D[B]))return 0;v=Math.min(v,C(M[E],M[k],D[z],D[B],s))}return v}function Te(u,n,s,h,y,d,v){if(d===null||v===null)return;const M=iu(Ia(h,d),Ia(y,v),s);M<n&&u.push({dist:M,range1:d,range2:v})}function Be(u,n,s,h,y=1/0){let d=Math.min(h.distance(u[0],s[0][0]),y);if(d===0)return d;const v=new Ma([{dist:0,range1:[0,u.length-1],range2:[0,0]}],Qc),M=n?uc:lc,k=gs(s);for(;v.length;){const j=v.pop();if(j.dist>=d)continue;const E=j.range1;if(Oa(E)<=M){if(!Vs(E,u.length))return NaN;if(n){const D=$(u,E,s,h);if((d=Math.min(d,D))===0)return d}else for(let D=E[0];D<=E[1];++D){const B=O(u[D],s,h);if((d=Math.min(d,B))===0)return d}}else{const D=Kf(E,n);if(D[0]!==null){const B=iu(Ia(u,D[0]),k,h);B<d&&v.push({dist:B,range1:D[0],range2:[0,0]})}if(D[1]!==null){const B=iu(Ia(u,D[1]),k,h);B<d&&v.push({dist:B,range1:D[1],range2:[0,0]})}}}return d}function et(u,n,s,h,y,d=1/0){let v=Math.min(d,y.distance(u[0],s[0]));if(v===0)return v;const M=new Ma([{dist:0,range1:[0,u.length-1],range2:[0,s.length-1]}],Qc),k=n?uc:lc,j=h?uc:lc;for(;M.length;){const E=M.pop();if(E.dist>=v)continue;const D=E.range1,B=E.range2;if(Oa(D)<=k&&Oa(B)<=j){if(!Vs(D,u.length)||!Vs(B,s.length))return NaN;if(n&&h?v=Math.min(v,g(u,D,s,B,y)):n||h?n&&!h?v=Math.min(v,ys(s,B,u,D,y)):!n&&h&&(v=Math.min(v,ys(u,D,s,B,y))):v=Math.min(v,x(u,D,s,B,y)),v===0)return v}else{const R=Kf(D,n),z=Kf(B,h);Te(M,v,y,u,s,R[0],z[0]),Te(M,v,y,u,s,R[0],z[1]),Te(M,v,y,u,s,R[1],z[0]),Te(M,v,y,u,s,R[1],z[1])}}return v}function Dt(u,n,s,h,y=1/0){let d=y;const v=Ia(u,[0,u.length-1]);for(const M of s)if(!(d!==1/0&&iu(v,Ia(M,[0,M.length-1]),h)>=d)&&(d=Math.min(d,et(u,n,M,!0,h,d)),d===0))return d;return d}function Ht(u,n,s,h,y=1/0){let d=y;const v=Ia(u,[0,u.length-1]);for(const M of s){if(d!==1/0&&iu(v,gs(M),h)>=d)continue;const k=Be(u,n,M,h,d);if(isNaN(k))return k;if((d=Math.min(d,k))===0)return d}return d}function bn(u){return u==="Point"||u==="MultiPoint"||u==="LineString"||u==="MultiLineString"||u==="Polygon"||u==="MultiPolygon"}class Hn{constructor(n,s){this.type=kn,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'distance' expression requires either one argument, but found ' ${n.length-1} instead.`);if(Fo(n[1])){const h=n[1];if(h.type==="FeatureCollection"){for(let y=0;y<h.features.length;++y)if(bn(h.features[y].geometry.type))return new Hn(h,h.features[y].geometry)}else if(h.type==="Feature"){if(bn(h.geometry.type))return new Hn(h,h.geometry)}else if(bn(h.type))return new Hn(h,h)}return s.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(n){const s=n.geometry(),h=n.canonicalID();if(s!=null&&h!=null){if(n.geometryType()==="Point")return function(y,d,v){const M=[];for(const j of y)for(const E of j)M.push(Vh(E,d));const k=new ol(M[0][1],"meters");return v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString"?et(M,!1,v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",k):v.type==="MultiLineString"?Dt(M,!1,v.coordinates,k):v.type==="Polygon"||v.type==="MultiPolygon"?Ht(M,!1,v.type==="Polygon"?[v.coordinates]:v.coordinates,k):null}(s,h,this.geometries);if(n.geometryType()==="LineString")return function(y,d,v){const M=[];for(const j of y){const E=[];for(const D of j)E.push(Vh(D,d));M.push(E)}const k=new ol(M[0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return Dt(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",M,k);if(v.type==="MultiLineString"){let j=1/0;for(let E=0;E<v.coordinates.length;E++){const D=Dt(v.coordinates[E],!0,M,k,j);if(isNaN(D))return D;if((j=Math.min(j,D))===0)return j}return j}if(v.type==="Polygon"||v.type==="MultiPolygon"){let j=1/0;for(let E=0;E<M.length;E++){const D=Ht(M[E],!0,v.type==="Polygon"?[v.coordinates]:v.coordinates,k,j);if(isNaN(D))return D;if((j=Math.min(j,D))===0)return j}return j}return null}(s,h,this.geometries);if(n.geometryType()==="Polygon")return function(y,d,v){const M=[];for(const j of function(E,D){const B=E.length;if(B<=1)return[E];const R=[];let z,q;for(let W=0;W<B;W++){const K=Zf(E[W]);K!==0&&(E[W].area=Math.abs(K),q===void 0&&(q=K<0),q===K<0?(z&&R.push(z),z=[E[W]]):z.push(E[W]))}return z&&R.push(z),R}(y)){const E=[];for(let D=0;D<j.length;++D)E.push(qh(j[D],d));M.push(E)}const k=new ol(M[0][0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return Ht(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",M,k);if(v.type==="MultiLineString"){let j=1/0;for(let E=0;E<v.coordinates.length;E++){const D=Ht(v.coordinates[E],!0,M,k,j);if(isNaN(D))return D;if((j=Math.min(j,D))===0)return j}return j}return v.type==="Polygon"||v.type==="MultiPolygon"?function(j,E,D){let B=1/0;for(const R of j)for(const z of E){const q=he(R,z,D,B);if(isNaN(q))return q;if((B=Math.min(B,q))===0)return B}return B}(v.type==="Polygon"?[v.coordinates]:v.coordinates,M,k):null}(s,h,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function sr(u,n){switch(u){case"string":return ro(n);case"number":return+n;case"boolean":return!!n;case"color":return Vr.parse(n);case"formatted":return Aa.fromString(ro(n));case"resolvedImage":return la.build(ro(n))}return n}function xr(u,n,s,h){return h!==void 0&&(u=h*Math.round(u/h)),n!==void 0&&u<n&&(u=n),s!==void 0&&u>s&&(u=s),u}class Jr{constructor(n,s,h){this.type=n,this.key=s,this.scope=h}static parse(n,s){let h=s.expectedType;if(h==null&&(h=Br),n.length<2||n.length>3)return s.error("Invalid number of arguments for 'config' expression.");const y=s.parse(n[1],1);if(!(y instanceof Ba))return s.error("Key name of 'config' expression must be a string literal.");if(n.length>=3){const d=s.parse(n[2],2);return d instanceof Ba?new Jr(h,ro(y.value),ro(d.value)):s.error("Scope of 'config' expression must be a string literal.")}return new Jr(h,ro(y.value))}evaluate(n){const s=[this.key,this.scope,n.scope].filter(Boolean).join(""),h=n.getConfig(s);if(!h)return null;const{type:y,value:d,values:v,minValue:M,maxValue:k,stepValue:j}=h,E=h.default.evaluate(n);let D=E;if(d){const B=n.scope;n.scope=(B||"").split("").slice(1).join(""),D=d.evaluate(n),n.scope=B}return y&&(D=sr(y,D)),D===void 0||M===void 0&&k===void 0&&j===void 0||(typeof D=="number"?D=xr(D,M,k,j):Array.isArray(D)&&(D=D.map(B=>typeof B=="number"?xr(B,M,k,j):B))),d!==void 0&&D!==void 0&&v&&!v.includes(D)&&(D=E,y&&(D=sr(y,D))),(y&&y!==this.type||D!==void 0&&Oi(D)!==this.type)&&(D=sr(this.type.kind,D)),D}eachChild(){}outputDefined(){return!1}serialize(){const n=["config",this.key];return this.scope&&n.concat(this.key),n}}function Qr(u){if(u instanceof qi&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof Qn||u instanceof Hn)return!1;let n=!0;return u.eachChild(s=>{n&&!Qr(s)&&(n=!1)}),n}function xi(u){if(u instanceof qi&&u.name==="feature-state")return!1;let n=!0;return u.eachChild(s=>{n&&!xi(s)&&(n=!1)}),n}function Si(u){if(u instanceof Jr)return new Set([u.key]);let n=new Set;return u.eachChild(s=>{n=new Set([...n,...Si(s)])}),n}function mi(u,n){if(u instanceof qi&&n.indexOf(u.name)>=0)return!1;let s=!0;return u.eachChild(h=>{s&&!mi(h,n)&&(s=!1)}),s}class Wa{constructor(n,s){this.type=s.type,this.name=n,this.boundExpression=s}static parse(n,s){if(n.length!==2||typeof n[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const h=n[1];return s.scope.has(h)?new Wa(h,s.scope.get(h)):s.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class _s{constructor(n,s=[],h,y=new rc,d=[],v,M){this.registry=n,this.path=s,this.key=s.map(k=>typeof k=="string"?`['${k}']`:`[${k}]`).join(""),this.scope=y,this.errors=d,this.expectedType=h,this._scope=v,this.options=M}parse(n,s,h,y,d={}){return s||h?this.concat(s,null,h,y)._parse(n,d):this._parse(n,d)}parseObjectValue(n,s,h,y,d,v={}){return this.concat(s,h,y,d)._parse(n,v)}_parse(n,s){function h(y,d,v){return v==="assert"?new Fs(d,[y]):v==="coerce"?new Il(d,[y]):y}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const y=typeof n[0]=="string"?this.registry[n[0]]:void 0;if(y){let d=y.parse(n,this);if(!d)return null;if(this.expectedType){const v=this.expectedType,M=d.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||M.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||M.kind!=="value"&&M.kind!=="string"){if(this.checkSubtype(v,M))return null}else d=h(d,v,s.typeAnnotation||"coerce");else d=h(d,v,s.typeAnnotation||"assert")}if(!(d instanceof Ba)&&d.type.kind!=="resolvedImage"&&au(d)){const v=new Cl(this._scope,this.options);try{d=new Ba(d.type,d.evaluate(v))}catch(M){return this.error(M.message),null}}return d}return Il.parse(["to-array",n],this)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,s,h,y){let d=typeof n=="number"?this.path.concat(n):this.path;d=typeof s=="string"?d.concat(s):d;const v=y?this.scope.concat(y):this.scope;return new _s(this.registry,d,h||null,v,this.errors,this._scope,this.options)}error(n,...s){const h=`${this.key}${s.map(y=>`[${y}]`).join("")}`;this.errors.push(new _r(h,n))}checkSubtype(n,s){const h=Ea(n,s);return h&&this.error(h),h}}var Pl=_s;function au(u){if(u instanceof Wa)return au(u.boundExpression);if(u instanceof qi&&u.name==="error"||u instanceof ac||u instanceof Qn||u instanceof Hn||u instanceof Jr)return!1;const n=u instanceof Il||u instanceof Fs;let s=!0;return u.eachChild(h=>{s=n?s&&au(h):s&&h instanceof Ba}),!!s&&Qr(u)&&mi(u,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function ou(u,n){const s=u.length-1;let h,y,d=0,v=s,M=0;for(;d<=v;)if(M=Math.floor((d+v)/2),h=u[M],y=u[M+1],h<=n){if(M===s||n<y)return M;d=M+1}else{if(!(h>n))throw new pi("Input is not a number.");v=M-1}return 0}class jo{constructor(n,s,h){this.type=n,this.input=s,this.labels=[],this.outputs=[];for(const[y,d]of h)this.labels.push(y),this.outputs.push(d)}static parse(n,s){if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");const h=s.parse(n[1],1,kn);if(!h)return null;const y=[];let d=null;s.expectedType&&s.expectedType.kind!=="value"&&(d=s.expectedType);for(let v=1;v<n.length;v+=2){const M=v===1?-1/0:n[v],k=n[v+1],j=v,E=v+1;if(typeof M!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(y.length&&y[y.length-1][0]>=M)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',j);const D=s.parse(k,E,d);if(!D)return null;d=d||D.type,y.push([M,D])}return new jo(d,h,y)}evaluate(n){const s=this.labels,h=this.outputs;if(s.length===1)return h[0].evaluate(n);const y=this.input.evaluate(n);if(y<=s[0])return h[0].evaluate(n);const d=s.length;return y>=s[d-1]?h[d-1].evaluate(n):h[ou(s,y)].evaluate(n)}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){const n=["step",this.input.serialize()];for(let s=0;s<this.labels.length;s++)s>0&&n.push(this.labels[s]),n.push(this.outputs[s].serialize());return n}}const Rl=.95047,Ar=1.08883,kl=4/29,Dl=6/29,qs=3*Dl*Dl,eh=Dl*Dl*Dl,Gh=Math.PI/180,gi=180/Math.PI;function $h(u){return u>eh?Math.pow(u,1/3):u/qs+kl}function vs(u){return u>Dl?u*u*u:qs*(u-kl)}function xs(u){return 255*(u<=.0031308?12.92*u:1.055*Math.pow(u,1/2.4)-.055)}function Ru(u){return(u/=255)<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function su(u){const n=Ru(u.r),s=Ru(u.g),h=Ru(u.b),y=$h((.4124564*n+.3575761*s+.1804375*h)/Rl),d=$h((.2126729*n+.7151522*s+.072175*h)/1);return{l:116*d-16,a:500*(y-d),b:200*(d-$h((.0193339*n+.119192*s+.9503041*h)/Ar)),alpha:u.a}}function lu(u){let n=(u.l+16)/116,s=isNaN(u.a)?n:n+u.a/500,h=isNaN(u.b)?n:n-u.b/200;return n=1*vs(n),s=Rl*vs(s),h=Ar*vs(h),new Vr(xs(3.2404542*s-1.5371385*n-.4985314*h),xs(-.969266*s+1.8760108*n+.041556*h),xs(.0556434*s-.2040259*n+1.0572252*h),u.alpha)}function th(u,n,s){const h=n-u;return u+s*(h>180||h<-180?h-360*Math.round(h/360):h)}const Hh={forward:su,reverse:lu,interpolate:function(u,n,s){return{l:Nn(u.l,n.l,s),a:Nn(u.a,n.a,s),b:Nn(u.b,n.b,s),alpha:Nn(u.alpha,n.alpha,s)}}},nh={forward:function(u){const{l:n,a:s,b:h}=su(u),y=Math.atan2(h,s)*gi;return{h:y<0?y+360:y,c:Math.sqrt(s*s+h*h),l:n,alpha:u.a}},reverse:function(u){const n=u.h*Gh,s=u.c;return lu({l:u.l,a:Math.cos(n)*s,b:Math.sin(n)*s,alpha:u.alpha})},interpolate:function(u,n,s){return{h:th(u.h,n.h,s),c:Nn(u.c,n.c,s),l:Nn(u.l,n.l,s),alpha:Nn(u.alpha,n.alpha,s)}}};var op=Object.freeze({__proto__:null,hcl:nh,lab:Hh});class Xi{constructor(n,s,h,y,d,v){this.type=n,this.operator=s,this.interpolation=h,this.input=y,this.dynamicStops=d,this.labels=[],this.outputs=[];for(const[M,k]of v)this.labels.push(M),this.outputs.push(k)}static interpolationFactor(n,s,h,y){let d=0;if(n.name==="exponential")d=ao(s,n.base,h,y);else if(n.name==="linear")d=ao(s,1,h,y);else if(n.name==="cubic-bezier"){const v=n.controlPoints;d=new qe(v[0],v[1],v[2],v[3]).solve(ao(s,1,h,y))}return d}static parse(n,s){let[h,y,d,...v]=n;if(!Array.isArray(y)||y.length===0)return s.error("Expected an interpolation type expression.",1);if(y[0]==="linear")y={name:"linear"};else if(y[0]==="exponential"){const j=y[1];if(typeof j!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);y={name:"exponential",base:j}}else{if(y[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(y[0])}`,1,0);{const j=y.slice(1);if(j.length!==4||j.some(E=>typeof E!="number"||E<0||E>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);y={name:"cubic-bezier",controlPoints:j}}}if(n.length-1<3)return s.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length-1>3&&(n.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(d=s.parse(d,2,kn),!d)return null;const M=[];let k=null;if(h==="interpolate-hcl"||h==="interpolate-lab"?k=zi:s.expectedType&&s.expectedType.kind!=="value"&&(k=s.expectedType),n.length-1==3){const j=s.parse(v[0],3,Br);return j?new Xi(k,h,y,d,j,M):null}for(let j=0;j<v.length;j+=2){const E=v[j],D=v[j+1],B=j+3,R=j+4;if(typeof E!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(M.length&&M[M.length-1][0]>=E)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',B);const z=s.parse(D,R,k);if(!z)return null;k=k||z.type,M.push([E,z])}return k.kind==="number"||k.kind==="color"||k.kind==="array"&&k.itemType.kind==="number"&&typeof k.N=="number"?new Xi(k,h,y,d,null,M):s.error(`Type ${ui(k)} is not interpolatable.`)}evaluate(n){let s=this.labels,h=this.outputs;if(this.dynamicStops){const E=this.dynamicStops.evaluate(n);if(E.length%2!=0)throw new pi("Expected an even number of arguments.");s=[],h=[];for(let D=0;D<E.length;D+=2){const B=E[D],R=new Ba(kn,E[D+1]);if(typeof B!="number")throw new pi('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.');if(s.length&&s[s.length-1]>=B)throw new pi('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.');s.push(B),h.push(R)}if(s.length===0)throw new pi("Expected at least one input/output pair.")}if(s.length===1)return h[0].evaluate(n);const y=this.input.evaluate(n);if(y<=s[0])return h[0].evaluate(n);const d=s.length;if(y>=s[d-1])return h[d-1].evaluate(n);const v=ou(s,y),M=Xi.interpolationFactor(this.interpolation,y,s[v],s[v+1]),k=h[v].evaluate(n),j=h[v+1].evaluate(n);return this.operator==="interpolate"?fs[this.type.kind.toLowerCase()](k,j,M):this.operator==="interpolate-hcl"?nh.reverse(nh.interpolate(nh.forward(k),nh.forward(j),M)):Hh.reverse(Hh.interpolate(Hh.forward(k),Hh.forward(j),M))}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){let n;n=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const s=[this.operator,n,this.input.serialize()];if(this.dynamicStops)s.push(this.dynamicStops.serialize());else for(let h=0;h<this.labels.length;h++)s.push(this.labels[h],this.outputs[h].serialize());return s}}function ao(u,n,s,h){const y=h-s,d=u-s;return y===0?0:n===1?d/y:(Math.pow(n,d)-1)/(Math.pow(n,y)-1)}class yi{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expectected at least one argument.");let h=null;const y=s.expectedType;y&&y.kind!=="value"&&(h=y);const d=[];for(const M of n.slice(1)){const k=s.parse(M,1+d.length,h,void 0,{typeAnnotation:"omit"});if(!k)return null;h=h||k.type,d.push(k)}const v=y&&d.some(M=>Ea(y,M.type));return new yi(v?Br:h,d)}evaluate(n){let s,h=null,y=0;for(const d of this.args){if(y++,h=d.evaluate(n),h&&h instanceof la&&!h.available&&(s||(s=h),h=null,y===this.args.length))return s;if(h!==null)break}return h}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=["coalesce"];return this.eachChild(s=>{n.push(s.serialize())}),n}}class bs{constructor(n,s){this.type=s.type,this.bindings=[].concat(n),this.result=s}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const s of this.bindings)n(s[1]);n(this.result)}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const h=[];for(let d=1;d<n.length-1;d+=2){const v=n[d];if(typeof v!="string")return s.error(`Expected string, but found ${typeof v} instead.`,d);if(/[^a-zA-Z0-9_]/.test(v))return s.error("Variable names must contain only alphanumeric characters or '_'.",d);const M=s.parse(n[d+1],d+1);if(!M)return null;h.push([v,M])}const y=s.parse(n[n.length-1],n.length-1,s.expectedType,h);return y?new bs(h,y):null}outputDefined(){return this.result.outputDefined()}serialize(){const n=["let"];for(const[s,h]of this.bindings)n.push(s,h.serialize());return n.push(this.result.serialize()),n}}class sl{constructor(n,s,h){this.type=n,this.index=s,this.input=h}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const h=s.parse(n[1],1,kn),y=s.parse(n[2],2,di(s.expectedType||Br));return h&&y?new sl(y.type.itemType,h,y):null}evaluate(n){const s=this.index.evaluate(n),h=this.input.evaluate(n);if(s<0)throw new pi(`Array index out of bounds: ${s} < 0.`);if(s>h.length-1)throw new pi(`Array index out of bounds: ${s} > ${h.length-1}.`);if(s===Math.floor(s))return h[s];const y=Math.floor(s),d=Math.ceil(s),v=h[y],M=h[d];if(typeof v!="number"||typeof M!="number")throw new pi(`Cannot interpolate between non-number values at index ${s}.`);const k=s-y;return v*(1-k)+M*k}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Jf{constructor(n,s){this.type=Vn,this.needle=n,this.haystack=s}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const h=s.parse(n[1],1,Br),y=s.parse(n[2],2,Br);return h&&y?zh(h.type,[Vn,qr,kn,Lo,Br])?new Jf(h,y):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${ui(h.type)} instead`):null}evaluate(n){const s=this.needle.evaluate(n),h=this.haystack.evaluate(n);if(h==null)return!1;if(!Ql(s,["boolean","string","number","null"]))throw new pi(`Expected first argument to be of type boolean, string, number or null, but found ${ui(Oi(s))} instead.`);if(!Ql(h,["string","array"]))throw new pi(`Expected second argument to be of type array or string, but found ${ui(Oi(h))} instead.`);return h.indexOf(s)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class uu{constructor(n,s,h){this.type=kn,this.needle=n,this.haystack=s,this.fromIndex=h}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const h=s.parse(n[1],1,Br),y=s.parse(n[2],2,Br);if(!h||!y)return null;if(!zh(h.type,[Vn,qr,kn,Lo,Br]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${ui(h.type)} instead`);if(n.length===4){const d=s.parse(n[3],3,kn);return d?new uu(h,y,d):null}return new uu(h,y)}evaluate(n){const s=this.needle.evaluate(n),h=this.haystack.evaluate(n);if(!Ql(s,["boolean","string","number","null"]))throw new pi(`Expected first argument to be of type boolean, string, number or null, but found ${ui(Oi(s))} instead.`);if(!Ql(h,["string","array"]))throw new pi(`Expected second argument to be of type array or string, but found ${ui(Oi(h))} instead.`);if(this.fromIndex){const y=this.fromIndex.evaluate(n);return h.indexOf(s,y)}return h.indexOf(s)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const n=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),n]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class sp{constructor(n,s,h,y,d,v){this.inputType=n,this.type=s,this.input=h,this.cases=y,this.outputs=d,this.otherwise=v}static parse(n,s){if(n.length<5)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return s.error("Expected an even number of arguments.");let h,y;s.expectedType&&s.expectedType.kind!=="value"&&(y=s.expectedType);const d={},v=[];for(let j=2;j<n.length-1;j+=2){let E=n[j];const D=n[j+1];Array.isArray(E)||(E=[E]);const B=s.concat(j);if(E.length===0)return B.error("Expected at least one branch label.");for(const z of E){if(typeof z!="number"&&typeof z!="string")return B.error("Branch labels must be numbers or strings.");if(typeof z=="number"&&Math.abs(z)>Number.MAX_SAFE_INTEGER)return B.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof z=="number"&&Math.floor(z)!==z)return B.error("Numeric branch labels must be integer values.");if(h){if(B.checkSubtype(h,Oi(z)))return null}else h=Oi(z);if(d[String(z)]!==void 0)return B.error("Branch labels must be unique.");d[String(z)]=v.length}const R=s.parse(D,j,y);if(!R)return null;y=y||R.type,v.push(R)}const M=s.parse(n[1],1,Br);if(!M)return null;const k=s.parse(n[n.length-1],n.length-1,y);return k?M.type.kind!=="value"&&s.concat(1).checkSubtype(h,M.type)?null:new sp(h,y,M,d,v,k):null}evaluate(n){const s=this.input.evaluate(n);return(Oi(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["match",this.input.serialize()],s=Object.keys(this.cases).sort(),h=[],y={};for(const v of s){const M=y[this.cases[v]];M===void 0?(y[this.cases[v]]=h.length,h.push([this.cases[v],[v]])):h[M][1].push(v)}const d=v=>this.inputType.kind==="number"?Number(v):v;for(const[v,M]of h)n.push(M.length===1?d(M[0]):M.map(d)),n.push(this.outputs[v].serialize());return n.push(this.otherwise.serialize()),n}}class lp{constructor(n,s,h){this.type=n,this.branches=s,this.otherwise=h}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return s.error("Expected an odd number of arguments.");let h;s.expectedType&&s.expectedType.kind!=="value"&&(h=s.expectedType);const y=[];for(let v=1;v<n.length-1;v+=2){const M=s.parse(n[v],v,Vn);if(!M)return null;const k=s.parse(n[v+1],v+1,h);if(!k)return null;y.push([M,k]),h=h||k.type}const d=s.parse(n[n.length-1],n.length-1,h);return d?new lp(h,y,d):null}evaluate(n){for(const[s,h]of this.branches)if(s.evaluate(n))return h.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[s,h]of this.branches)n(s),n(h);n(this.otherwise)}outputDefined(){return this.branches.every(([n,s])=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["case"];return this.eachChild(s=>{n.push(s.serialize())}),n}}class cc{constructor(n,s,h,y){this.type=n,this.input=s,this.beginIndex=h,this.endIndex=y}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const h=s.parse(n[1],1,Br),y=s.parse(n[2],2,kn);if(!h||!y)return null;if(!zh(h.type,[di(Br),qr,Br]))return s.error(`Expected first argument to be of type array or string, but found ${ui(h.type)} instead`);if(n.length===4){const d=s.parse(n[3],3,kn);return d?new cc(h.type,h,y,d):null}return new cc(h.type,h,y)}evaluate(n){const s=this.input.evaluate(n),h=this.beginIndex.evaluate(n);if(!Ql(s,["string","array"]))throw new pi(`Expected first argument to be of type array or string, but found ${ui(Oi(s))} instead.`);if(this.endIndex){const y=this.endIndex.evaluate(n);return s.slice(h,y)}return s.slice(h)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const n=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),n]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Xh(u,n){return u==="=="||u==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function Yh(u,n,s,h){return h.compare(n,s)===0}function cu(u,n,s){const h=u!=="=="&&u!=="!=";return class eV{constructor(d,v,M){this.type=Vn,this.lhs=d,this.rhs=v,this.collator=M,this.hasUntypedArgument=d.type.kind==="value"||v.type.kind==="value"}static parse(d,v){if(d.length!==3&&d.length!==4)return v.error("Expected two or three arguments.");const M=d[0];let k=v.parse(d[1],1,Br);if(!k)return null;if(!Xh(M,k.type))return v.concat(1).error(`"${M}" comparisons are not supported for type '${ui(k.type)}'.`);let j=v.parse(d[2],2,Br);if(!j)return null;if(!Xh(M,j.type))return v.concat(2).error(`"${M}" comparisons are not supported for type '${ui(j.type)}'.`);if(k.type.kind!==j.type.kind&&k.type.kind!=="value"&&j.type.kind!=="value")return v.error(`Cannot compare types '${ui(k.type)}' and '${ui(j.type)}'.`);h&&(k.type.kind==="value"&&j.type.kind!=="value"?k=new Fs(j.type,[k]):k.type.kind!=="value"&&j.type.kind==="value"&&(j=new Fs(k.type,[j])));let E=null;if(d.length===4){if(k.type.kind!=="string"&&j.type.kind!=="string"&&k.type.kind!=="value"&&j.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(E=v.parse(d[3],3,ds),!E)return null}return new eV(k,j,E)}evaluate(d){const v=this.lhs.evaluate(d),M=this.rhs.evaluate(d);if(h&&this.hasUntypedArgument){const k=Oi(v),j=Oi(M);if(k.kind!==j.kind||k.kind!=="string"&&k.kind!=="number")throw new pi(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${k.kind}, ${j.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const k=Oi(v),j=Oi(M);if(k.kind!=="string"||j.kind!=="string")return n(d,v,M)}return this.collator?s(d,v,M,this.collator.evaluate(d)):n(d,v,M)}eachChild(d){d(this.lhs),d(this.rhs),this.collator&&d(this.collator)}outputDefined(){return!0}serialize(){const d=[u];return this.eachChild(v=>{d.push(v.serialize())}),d}}}const Dg=cu("==",function(u,n,s){return n===s},Yh),gm=cu("!=",function(u,n,s){return n!==s},function(u,n,s,h){return!Yh(0,n,s,h)}),Lg=cu("<",function(u,n,s){return n<s},function(u,n,s,h){return h.compare(n,s)<0}),up=cu(">",function(u,n,s){return n>s},function(u,n,s,h){return h.compare(n,s)>0}),zg=cu("<=",function(u,n,s){return n<=s},function(u,n,s,h){return h.compare(n,s)<=0}),Qf=cu(">=",function(u,n,s){return n>=s},function(u,n,s,h){return h.compare(n,s)>=0});class cp{constructor(n,s,h,y,d,v){this.type=qr,this.number=n,this.locale=s,this.currency=h,this.unit=y,this.minFractionDigits=d,this.maxFractionDigits=v}static parse(n,s){if(n.length!==3)return s.error("Expected two arguments.");const h=s.parse(n[1],1,kn);if(!h)return null;const y=n[2];if(typeof y!="object"||Array.isArray(y))return s.error("NumberFormat options argument must be an object.");let d=null;if(y.locale&&(d=s.parseObjectValue(y.locale,2,"locale",qr),!d))return null;let v=null;if(y.currency&&(v=s.parseObjectValue(y.currency,2,"currency",qr),!v))return null;let M=null;if(y.unit&&(M=s.parseObjectValue(y.unit,2,"unit",qr),!M))return null;let k=null;if(y["min-fraction-digits"]&&(k=s.parseObjectValue(y["min-fraction-digits"],2,"min-fraction-digits",kn),!k))return null;let j=null;return y["max-fraction-digits"]&&(j=s.parseObjectValue(y["max-fraction-digits"],2,"max-fraction-digits",kn),!j)?null:new cp(h,d,v,M,k,j)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(n):void 0,unit:this.unit?this.unit.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.unit&&n(this.unit),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const n={};return this.locale&&(n.locale=this.locale.serialize()),this.currency&&(n.currency=this.currency.serialize()),this.unit&&(n.unit=this.unit.serialize()),this.minFractionDigits&&(n["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(n["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),n]}}class hc{constructor(n){this.type=kn,this.input=n}static parse(n,s){if(n.length!==2)return s.error(`Expected 1 argument, but found ${n.length-1} instead.`);const h=s.parse(n[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${ui(h.type)} instead.`):new hc(h):null}evaluate(n){const s=this.input.evaluate(n);if(typeof s=="string"||Array.isArray(s))return s.length;throw new pi(`Expected value to be of type string or array, but found ${ui(Oi(s))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}serialize(){const n=["length"];return this.eachChild(s=>{n.push(s.serialize())}),n}}function fc(u){return function(){u=1831565813+(u|=0)|0;let n=Math.imul(u^u>>>15,1|u);return n=n+Math.imul(n^n>>>7,61|n)^n,((n^n>>>14)>>>0)/4294967296}}const ku={"==":Dg,"!=":gm,">":up,"<":Lg,">=":Qf,"<=":zg,array:Fs,at:sl,boolean:Fs,case:lp,coalesce:yi,collator:ac,format:eu,image:Zc,in:Jf,"index-of":uu,interpolate:Xi,"interpolate-hcl":Xi,"interpolate-lab":Xi,length:hc,let:bs,literal:Ba,match:sp,number:Fs,"number-format":cp,object:Fs,slice:cc,step:jo,string:Fs,"to-boolean":Il,"to-color":Il,"to-number":Il,"to-string":Il,var:Wa,within:Qn,distance:Hn,config:Jr};function rh(u,[n,s,h,y]){n=n.evaluate(u),s=s.evaluate(u),h=h.evaluate(u);const d=y?y.evaluate(u):1,v=$f(n,s,h,d);if(v)throw new pi(v);return new Vr(n/255*d,s/255*d,h/255*d,d)}function ed(u,[n,s,h,y]){n=n.evaluate(u),s=s.evaluate(u),h=h.evaluate(u);const d=y?y.evaluate(u):1,v=function(j,E,D,B){return typeof j=="number"&&j>=0&&j<=360?typeof E=="number"&&E>=0&&E<=100&&typeof D=="number"&&D>=0&&D<=100?B===void 0||typeof B=="number"&&B>=0&&B<=1?null:`Invalid hsla value [${[j,E,D,B].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof B=="number"?[j,E,D,B]:[j,E,D]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof B=="number"?[j,E,D,B]:[j,E,D]).join(", ")}]: 'h' must be between 0 and 360.`}(n,s,h,d);if(v)throw new pi(v);const M=`hsla(${n}, ${s}%, ${h}%, ${d})`,k=Vr.parse(M);if(!k)throw new pi(`Failed to parse HSLA color: ${M}`);return k}function ym(u,n){return u in n}function hp(u,n){const s=n[u];return s===void 0?null:s}function ws(u){return{type:u}}function fp(u){return{result:"success",value:u}}function go(u){return{result:"error",value:u}}function ih(u,n){return!!u&&!!u.parameters&&u.parameters.indexOf(n)>-1}function Zh(u){return u["property-type"]==="data-driven"}function dp(u){return ih(u.expression,"measure-light")}function Wh(u){return ih(u.expression,"zoom")}function Uo(u){return!!u.expression&&u.expression.interpolated}function ll(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function dc(u){return u}function pp(u,n){const s=n.type==="color",h=u.stops&&typeof u.stops[0][0]=="object",y=h||!(h||u.property!==void 0),d=u.type||(Uo(n)?"exponential":"interval");if(s&&((u=Yc({},u)).stops&&(u.stops=u.stops.map(j=>[j[0],Vr.parse(j[1])])),u.default=Vr.parse(u.default?u.default:n.default)),u.colorSpace&&u.colorSpace!=="rgb"&&!op[u.colorSpace])throw new Error(`Unknown color space: ${u.colorSpace}`);let v,M,k;if(d==="exponential")v=td;else if(d==="interval")v=oo;else if(d==="categorical"){v=Du,M=Object.create(null);for(const j of u.stops)M[j[0]]=j[1];k=typeof u.stops[0][0]}else{if(d!=="identity")throw new Error(`Unknown function type "${d}"`);v=Ng}if(h){const j={},E=[];for(let R=0;R<u.stops.length;R++){const z=u.stops[R],q=z[0].zoom;j[q]===void 0&&(j[q]={zoom:q,type:u.type,property:u.property,default:u.default,stops:[]},E.push(q)),j[q].stops.push([z[0].value,z[1]])}const D=[];for(const R of E)D.push([j[R].zoom,pp(j[R],n)]);const B={name:"linear"};return{kind:"composite",interpolationType:B,interpolationFactor:Xi.interpolationFactor.bind(void 0,B),zoomStops:D.map(R=>R[0]),evaluate:({zoom:R},z)=>td({stops:D,base:u.base},n,R).evaluate(R,z)}}if(y){const j=d==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:j,interpolationFactor:Xi.interpolationFactor.bind(void 0,j),zoomStops:u.stops.map(E=>E[0]),evaluate:({zoom:E})=>v(u,n,E,M,k)}}return{kind:"source",evaluate(j,E){const D=E&&E.properties?E.properties[u.property]:void 0;return D===void 0?Gs(u.default,n.default):v(u,n,D,M,k)}}}function Gs(u,n,s){return u!==void 0?u:n!==void 0?n:s!==void 0?s:void 0}function Du(u,n,s,h,y){return Gs(typeof s===y?h[s]:void 0,u.default,n.default)}function oo(u,n,s){if(js(s)!=="number")return Gs(u.default,n.default);const h=u.stops.length;if(h===1||s<=u.stops[0][0])return u.stops[0][1];if(s>=u.stops[h-1][0])return u.stops[h-1][1];const y=ou(u.stops.map(d=>d[0]),s);return u.stops[y][1]}function td(u,n,s){const h=u.base!==void 0?u.base:1;if(js(s)!=="number")return Gs(u.default,n.default);const y=u.stops.length;if(y===1||s<=u.stops[0][0])return u.stops[0][1];if(s>=u.stops[y-1][0])return u.stops[y-1][1];const d=ou(u.stops.map(E=>E[0]),s),v=function(E,D,B,R){const z=R-B,q=E-B;return z===0?0:D===1?q/z:(Math.pow(D,q)-1)/(Math.pow(D,z)-1)}(s,h,u.stops[d][0],u.stops[d+1][0]),M=u.stops[d][1],k=u.stops[d+1][1];let j=fs[n.type]||dc;if(u.colorSpace&&u.colorSpace!=="rgb"){const E=op[u.colorSpace];j=(D,B)=>E.reverse(E.interpolate(E.forward(D),E.forward(B),v))}return typeof M.evaluate=="function"?{evaluate(...E){const D=M.evaluate.apply(void 0,E),B=k.evaluate.apply(void 0,E);if(D!==void 0&&B!==void 0)return j(D,B,v)}}:j(M,k,v)}function Ng(u,n,s){return n.type==="color"?s=Vr.parse(s):n.type==="formatted"?s=Aa.fromString(s.toString()):n.type==="resolvedImage"?s=la.build(s.toString()):js(s)===n.type||n.type==="enum"&&n.values[s]||(s=void 0),Gs(s,u.default,n.default)}qi.register(ku,{error:[{kind:"error"},[qr],(u,[n])=>{throw new pi(n.evaluate(u))}],typeof:[qr,[Br],(u,[n])=>ui(Oi(n.evaluate(u)))],"to-rgba":[di(kn,4),[zi],(u,[n])=>n.evaluate(u).toRenderColor(null).toArray()],"to-hsla":[di(kn,4),[zi],(u,[n])=>n.evaluate(u).toRenderColor(null).toHslaArray()],rgb:[zi,[kn,kn,kn],rh],rgba:[zi,[kn,kn,kn,kn],rh],hsl:[zi,[kn,kn,kn],ed],hsla:[zi,[kn,kn,kn,kn],ed],has:{type:Vn,overloads:[[[qr],(u,[n])=>ym(n.evaluate(u),u.properties())],[[qr,zo],(u,[n,s])=>ym(n.evaluate(u),s.evaluate(u))]]},get:{type:Br,overloads:[[[qr],(u,[n])=>hp(n.evaluate(u),u.properties())],[[qr,zo],(u,[n,s])=>hp(n.evaluate(u),s.evaluate(u))]]},"feature-state":[Br,[qr],(u,[n])=>hp(n.evaluate(u),u.featureState||{})],properties:[zo,[],u=>u.properties()],"geometry-type":[qr,[],u=>u.geometryType()],id:[Br,[],u=>u.id()],zoom:[kn,[],u=>u.globals.zoom],pitch:[kn,[],u=>u.globals.pitch||0],"distance-from-center":[kn,[],u=>u.distanceFromCenter()],"measure-light":[kn,[qr],(u,[n])=>u.measureLight(n.evaluate(u))],"heatmap-density":[kn,[],u=>u.globals.heatmapDensity||0],"line-progress":[kn,[],u=>u.globals.lineProgress||0],"raster-value":[kn,[],u=>u.globals.rasterValue||0],"raster-particle-speed":[kn,[],u=>u.globals.rasterParticleSpeed||0],"sky-radial-progress":[kn,[],u=>u.globals.skyRadialProgress||0],accumulated:[Br,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[kn,ws(kn),(u,n)=>{let s=0;for(const h of n)s+=h.evaluate(u);return s}],"*":[kn,ws(kn),(u,n)=>{let s=1;for(const h of n)s*=h.evaluate(u);return s}],"-":{type:kn,overloads:[[[kn,kn],(u,[n,s])=>n.evaluate(u)-s.evaluate(u)],[[kn],(u,[n])=>-n.evaluate(u)]]},"/":[kn,[kn,kn],(u,[n,s])=>n.evaluate(u)/s.evaluate(u)],"%":[kn,[kn,kn],(u,[n,s])=>n.evaluate(u)%s.evaluate(u)],ln2:[kn,[],()=>Math.LN2],pi:[kn,[],()=>Math.PI],e:[kn,[],()=>Math.E],"^":[kn,[kn,kn],(u,[n,s])=>Math.pow(n.evaluate(u),s.evaluate(u))],sqrt:[kn,[kn],(u,[n])=>Math.sqrt(n.evaluate(u))],log10:[kn,[kn],(u,[n])=>Math.log(n.evaluate(u))/Math.LN10],ln:[kn,[kn],(u,[n])=>Math.log(n.evaluate(u))],log2:[kn,[kn],(u,[n])=>Math.log(n.evaluate(u))/Math.LN2],sin:[kn,[kn],(u,[n])=>Math.sin(n.evaluate(u))],cos:[kn,[kn],(u,[n])=>Math.cos(n.evaluate(u))],tan:[kn,[kn],(u,[n])=>Math.tan(n.evaluate(u))],asin:[kn,[kn],(u,[n])=>Math.asin(n.evaluate(u))],acos:[kn,[kn],(u,[n])=>Math.acos(n.evaluate(u))],atan:[kn,[kn],(u,[n])=>Math.atan(n.evaluate(u))],min:[kn,ws(kn),(u,n)=>Math.min(...n.map(s=>s.evaluate(u)))],max:[kn,ws(kn),(u,n)=>Math.max(...n.map(s=>s.evaluate(u)))],abs:[kn,[kn],(u,[n])=>Math.abs(n.evaluate(u))],round:[kn,[kn],(u,[n])=>{const s=n.evaluate(u);return s<0?-Math.round(-s):Math.round(s)}],floor:[kn,[kn],(u,[n])=>Math.floor(n.evaluate(u))],ceil:[kn,[kn],(u,[n])=>Math.ceil(n.evaluate(u))],"filter-==":[Vn,[qr,Br],(u,[n,s])=>u.properties()[n.value]===s.value],"filter-id-==":[Vn,[Br],(u,[n])=>u.id()===n.value],"filter-type-==":[Vn,[qr],(u,[n])=>u.geometryType()===n.value],"filter-<":[Vn,[qr,Br],(u,[n,s])=>{const h=u.properties()[n.value],y=s.value;return typeof h==typeof y&&h<y}],"filter-id-<":[Vn,[Br],(u,[n])=>{const s=u.id(),h=n.value;return typeof s==typeof h&&s<h}],"filter->":[Vn,[qr,Br],(u,[n,s])=>{const h=u.properties()[n.value],y=s.value;return typeof h==typeof y&&h>y}],"filter-id->":[Vn,[Br],(u,[n])=>{const s=u.id(),h=n.value;return typeof s==typeof h&&s>h}],"filter-<=":[Vn,[qr,Br],(u,[n,s])=>{const h=u.properties()[n.value],y=s.value;return typeof h==typeof y&&h<=y}],"filter-id-<=":[Vn,[Br],(u,[n])=>{const s=u.id(),h=n.value;return typeof s==typeof h&&s<=h}],"filter->=":[Vn,[qr,Br],(u,[n,s])=>{const h=u.properties()[n.value],y=s.value;return typeof h==typeof y&&h>=y}],"filter-id->=":[Vn,[Br],(u,[n])=>{const s=u.id(),h=n.value;return typeof s==typeof h&&s>=h}],"filter-has":[Vn,[Br],(u,[n])=>n.value in u.properties()],"filter-has-id":[Vn,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[Vn,[di(qr)],(u,[n])=>n.value.indexOf(u.geometryType())>=0],"filter-id-in":[Vn,[di(Br)],(u,[n])=>n.value.indexOf(u.id())>=0],"filter-in-small":[Vn,[qr,di(Br)],(u,[n,s])=>s.value.indexOf(u.properties()[n.value])>=0],"filter-in-large":[Vn,[qr,di(Br)],(u,[n,s])=>function(h,y,d,v){for(;d<=v;){const M=d+v>>1;if(y[M]===h)return!0;y[M]>h?v=M-1:d=M+1}return!1}(u.properties()[n.value],s.value,0,s.value.length-1)],all:{type:Vn,overloads:[[[Vn,Vn],(u,[n,s])=>n.evaluate(u)&&s.evaluate(u)],[ws(Vn),(u,n)=>{for(const s of n)if(!s.evaluate(u))return!1;return!0}]]},any:{type:Vn,overloads:[[[Vn,Vn],(u,[n,s])=>n.evaluate(u)||s.evaluate(u)],[ws(Vn),(u,n)=>{for(const s of n)if(s.evaluate(u))return!0;return!1}]]},"!":[Vn,[Vn],(u,[n])=>!n.evaluate(u)],"is-supported-script":[Vn,[qr],(u,[n])=>{const s=u.globals&&u.globals.isSupportedScript;return!s||s(n.evaluate(u))}],upcase:[qr,[qr],(u,[n])=>n.evaluate(u).toUpperCase()],downcase:[qr,[qr],(u,[n])=>n.evaluate(u).toLowerCase()],concat:[qr,ws(Br),(u,n)=>n.map(s=>ro(s.evaluate(u))).join("")],"resolved-locale":[qr,[ds],(u,[n])=>n.evaluate(u).resolvedLocale()],random:[kn,[kn,kn,Br],(u,n)=>{const[s,h,y]=n.map(v=>v.evaluate(u));if(s>h||s===h)return s;let d;if(typeof y=="string")d=function(v){let M=0;if(v.length===0)return M;for(let k=0;k<v.length;k++)M=(M<<5)-M+v.charCodeAt(k),M|=0;return M}(y);else{if(typeof y!="number")throw new pi(`Invalid seed input: ${y}`);d=y}return s+fc(d)()*(h-s)}]});class mp{constructor(n,s,h,y){this.expression=n,this._warningHistory={},this._evaluator=new Cl(h,y),this._defaultValue=s?function(d){return d.type==="color"&&(ll(d.default)||Array.isArray(d.default))?new Vr(0,0,0,0):d.type==="color"?Vr.parse(d.default)||null:d.default===void 0?null:d.default}(s):null,this._enumValues=s&&s.type==="enum"?s.values:null,this.configDependencies=Si(n)}evaluateWithoutErrorHandling(n,s,h,y,d,v,M,k){return this._evaluator.globals=n,this._evaluator.feature=s,this._evaluator.featureState=h,this._evaluator.canonical=y||null,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=v,this._evaluator.featureTileCoord=M||null,this._evaluator.featureDistanceData=k||null,this.expression.evaluate(this._evaluator)}evaluate(n,s,h,y,d,v,M,k){this._evaluator.globals=n,this._evaluator.feature=s||null,this._evaluator.featureState=h||null,this._evaluator.canonical=y||null,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=v||null,this._evaluator.featureTileCoord=M||null,this._evaluator.featureDistanceData=k||null;try{const j=this.expression.evaluate(this._evaluator);if(j==null||typeof j=="number"&&j!=j)return this._defaultValue;if(this._enumValues&&!(j in this._enumValues))throw new pi(`Expected value to be one of ${Object.keys(this._enumValues).map(E=>JSON.stringify(E)).join(", ")}, but found ${JSON.stringify(j)} instead.`);return j}catch(j){return this._warningHistory[j.message]||(this._warningHistory[j.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${j.message}`)),this._defaultValue}}}function Kh(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in ku}function pa(u,n,s,h){const y=new Pl(ku,[],n?function(v){const M={color:zi,string:qr,number:kn,enum:qr,boolean:Vn,formatted:No,resolvedImage:Ta};return v.type==="array"?di(M[v.value]||Br,v.length):M[v.type]}(n):void 0,void 0,void 0,s,h),d=y.parse(u,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?fp(new mp(d,n,s,h)):go(y.errors)}class Jh{constructor(n,s,h,y){this.kind=n,this._styleExpression=s,this.isLightConstant=h,this.isLineProgressConstant=y,this.isStateDependent=n!=="constant"&&!xi(s.expression),this.configDependencies=Si(s.expression)}evaluateWithoutErrorHandling(n,s,h,y,d,v){return this._styleExpression.evaluateWithoutErrorHandling(n,s,h,y,d,v)}evaluate(n,s,h,y,d,v){return this._styleExpression.evaluate(n,s,h,y,d,v)}}class Lu{constructor(n,s,h,y,d,v){this.kind=n,this.zoomStops=h,this._styleExpression=s,this.isStateDependent=n!=="camera"&&!xi(s.expression),this.isLightConstant=d,this.isLineProgressConstant=v,this.configDependencies=Si(s.expression),this.interpolationType=y}evaluateWithoutErrorHandling(n,s,h,y,d,v){return this._styleExpression.evaluateWithoutErrorHandling(n,s,h,y,d,v)}evaluate(n,s,h,y,d,v){return this._styleExpression.evaluate(n,s,h,y,d,v)}interpolationFactor(n,s,h){return this.interpolationType?Xi.interpolationFactor(this.interpolationType,n,s,h):0}}function Qh(u,n,s,h){if((u=pa(u,n,s,h)).result==="error")return u;const y=u.value.expression,d=Qr(y);if(!d&&!Zh(n))return go([new _r("","data expressions not supported")]);const v=mi(y,["zoom","pitch","distance-from-center"]);if(!v&&!Wh(n))return go([new _r("","zoom expressions not supported")]);const M=mi(y,["measure-light"]);if(!M&&!dp(n))return go([new _r("","measure-light expression not supported")]);const k=mi(y,["line-progress"]);if(!k&&!function(D){return ih(D.expression,"line-progress")}(n))return go([new _r("","line-progress expression not supported")]);const j=n.expression&&n.expression.relaxZoomRestriction,E=hu(y);return E||v||j?E instanceof _r?go([E]):E instanceof Xi&&!Uo(n)?go([new _r("",'"interpolate" expressions cannot be used with this property')]):fp(E?new Lu(d&&k?"camera":"composite",u.value,E.labels,E instanceof Xi?E.interpolation:void 0,M,k):new Jh(d&&k?"constant":"source",u.value,M,k)):go([new _r("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class ah{constructor(n,s){this._parameters=n,this._specification=s,Yc(this,pp(this._parameters,this._specification))}static deserialize(n){return new ah(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function hu(u){let n=null;if(u instanceof bs)n=hu(u.result);else if(u instanceof yi){for(const s of u.args)if(n=hu(s),n)break}else(u instanceof jo||u instanceof Xi)&&u.input instanceof qi&&u.input.name==="zoom"&&(n=u);return n instanceof _r||u.eachChild(s=>{const h=hu(s);h instanceof _r?n=h:n&&h&&n!==h&&(n=new _r("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}var pc,Bg,Fg=function(){if(Bg)return pc;Bg=1,pc=n;var u=3;function n(s,h,y){var d=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;var v=new Int32Array(this.arrayBuffer);s=v[0],this.d=(h=v[1])+2*(y=v[2]);for(var M=0;M<this.d*this.d;M++){var k=v[u+M],j=v[u+M+1];d.push(k===j?null:v.subarray(k,j))}var E=v[u+d.length+1];this.keys=v.subarray(v[u+d.length],E),this.bboxes=v.subarray(E),this.insert=this._insertReadonly}else{this.d=h+2*y;for(var D=0;D<this.d*this.d;D++)d.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=s,this.padding=y,this.scale=h/s,this.uid=0;var B=y/h*s;this.min=-B,this.max=s+B}return n.prototype.insert=function(s,h,y,d,v){this._forEachCell(h,y,d,v,this._insertCell,this.uid++),this.keys.push(s),this.bboxes.push(h),this.bboxes.push(y),this.bboxes.push(d),this.bboxes.push(v)},n.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},n.prototype._insertCell=function(s,h,y,d,v,M){this.cells[v].push(M)},n.prototype.query=function(s,h,y,d,v){var M=this.min,k=this.max;if(s<=M&&h<=M&&k<=y&&k<=d&&!v)return Array.prototype.slice.call(this.keys);var j=[];return this._forEachCell(s,h,y,d,this._queryCell,j,{},v),j},n.prototype._queryCell=function(s,h,y,d,v,M,k,j){var E=this.cells[v];if(E!==null)for(var D=this.keys,B=this.bboxes,R=0;R<E.length;R++){var z=E[R];if(k[z]===void 0){var q=4*z;(j?j(B[q+0],B[q+1],B[q+2],B[q+3]):s<=B[q+2]&&h<=B[q+3]&&y>=B[q+0]&&d>=B[q+1])?(k[z]=!0,M.push(D[z])):k[z]=!1}}},n.prototype._forEachCell=function(s,h,y,d,v,M,k,j){for(var E=this._convertToCellCoord(s),D=this._convertToCellCoord(h),B=this._convertToCellCoord(y),R=this._convertToCellCoord(d),z=E;z<=B;z++)for(var q=D;q<=R;q++){var W=this.d*q+z;if((!j||j(this._convertFromCellCoord(z),this._convertFromCellCoord(q),this._convertFromCellCoord(z+1),this._convertFromCellCoord(q+1)))&&v.call(this,s,h,y,d,W,M,k,j))return}},n.prototype._convertFromCellCoord=function(s){return(s-this.padding)/this.scale},n.prototype._convertToCellCoord=function(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))},n.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var s=this.cells,h=u+this.cells.length+1+1,y=0,d=0;d<this.cells.length;d++)y+=this.cells[d].length;var v=new Int32Array(h+y+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;for(var M=h,k=0;k<s.length;k++){var j=s[k];v[u+k]=M,v.set(j,M),M+=j.length}return v[u+s.length]=M,v.set(this.keys,M),v[u+s.length+1]=M+=this.keys.length,v.set(this.bboxes,M),M+=this.bboxes.length,v.buffer},pc}(),oh=P(Fg);const nd={};function In(u,n,s={}){Object.defineProperty(u,"_classRegistryKey",{value:n,writable:!1}),nd[n]={klass:u,omit:s.omit||[]}}In(Object,"Object"),oh.serialize=function(u,n){const s=u.toArrayBuffer();return n&&n.add(s),{buffer:s}},oh.deserialize=function(u){return new oh(u.buffer)},Object.defineProperty(oh,"name",{value:"Grid"}),In(oh,"Grid"),typeof DOMMatrix<"u"&&In(DOMMatrix,"DOMMatrix"),In(Vr,"Color"),In(Error,"Error"),In(Aa,"Formatted"),In(ps,"FormattedSection"),In(Pi,"AJAXError"),In(la,"ResolvedImage"),In(ah,"StylePropertyFunction"),In(mp,"StyleExpression",{omit:["_evaluator"]}),In(da,"ImageIdWithOptions"),In(Lu,"ZoomDependentExpression"),In(Jh,"ZoomConstantExpression"),In(qi,"CompoundExpression",{omit:["_evaluate"]});for(const u in ku)nd[ku[u]._classRegistryKey]||In(ku[u],`Expression${u}`);function rd(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function ef(u){return self.ImageBitmap&&u instanceof ImageBitmap}function zu(u,n){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp)return u;if(rd(u)||ef(u))return n&&n.add(u),u;if(ArrayBuffer.isView(u))return n&&n.add(u.buffer),u;if(u instanceof ImageData)return n&&n.add(u.data.buffer),u;if(Array.isArray(u)){const s=[];for(const h of u)s.push(zu(h,n));return s}if(u instanceof Map){const s={$name:"Map"};for(const[h,y]of u.entries())s[h]=zu(y);return s}if(u instanceof Set){const s={$name:"Set"};let h=0;for(const y of u.values())s[++h]=zu(y);return s}if(typeof u=="object"){const s=u.constructor,h=s._classRegistryKey;if(!h)throw new Error(`Can't serialize object of unregistered class "${h}".`);const y=s.serialize?s.serialize(u,n):{};if(!s.serialize){for(const d in u)u.hasOwnProperty(d)&&(nd[h].omit.indexOf(d)>=0||(y[d]=zu(u[d],n)));u instanceof Error&&(y.message=u.message)}if(y.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(y.$name=h),y}throw new Error("can't serialize object of type "+typeof u)}function Ss(u){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||rd(u)||ef(u)||ArrayBuffer.isView(u)||u instanceof ImageData)return u;if(Array.isArray(u))return u.map(Ss);if(typeof u=="object"){const n=u.$name||"Object";if(n==="Map"){const y=new Map;for(const d of Object.keys(u))d!=="$name"&&y.set(d,Ss(u[d]));return y}if(n==="Set"){const y=new Set;for(const d of Object.keys(u))d!=="$name"&&y.add(Ss(u[d]));return y}const{klass:s}=nd[n];if(!s)throw new Error(`Can't deserialize unregistered class "${n}".`);if(s.deserialize)return s.deserialize(u);const h=Object.create(s.prototype);for(const y of Object.keys(u))y!=="$name"&&(h[y]=Ss(u[y]));return h}throw new Error("can't deserialize object of type "+typeof u)}const dn={"Latin-1 Supplement":u=>u>=128&&u<=255,Arabic:u=>u>=1536&&u<=1791,"Arabic Supplement":u=>u>=1872&&u<=1919,"Arabic Extended-A":u=>u>=2208&&u<=2303,"Hangul Jamo":u=>u>=4352&&u<=4607,"Unified Canadian Aboriginal Syllabics":u=>u>=5120&&u<=5759,Khmer:u=>u>=6016&&u<=6143,"Unified Canadian Aboriginal Syllabics Extended":u=>u>=6320&&u<=6399,"General Punctuation":u=>u>=8192&&u<=8303,"Letterlike Symbols":u=>u>=8448&&u<=8527,"Number Forms":u=>u>=8528&&u<=8591,"Miscellaneous Technical":u=>u>=8960&&u<=9215,"Control Pictures":u=>u>=9216&&u<=9279,"Optical Character Recognition":u=>u>=9280&&u<=9311,"Enclosed Alphanumerics":u=>u>=9312&&u<=9471,"Geometric Shapes":u=>u>=9632&&u<=9727,"Miscellaneous Symbols":u=>u>=9728&&u<=9983,"Miscellaneous Symbols and Arrows":u=>u>=11008&&u<=11263,"CJK Radicals Supplement":u=>u>=11904&&u<=12031,"Kangxi Radicals":u=>u>=12032&&u<=12255,"Ideographic Description Characters":u=>u>=12272&&u<=12287,"CJK Symbols and Punctuation":u=>u>=12288&&u<=12351,Hiragana:u=>u>=12352&&u<=12447,Katakana:u=>u>=12448&&u<=12543,Bopomofo:u=>u>=12544&&u<=12591,"Hangul Compatibility Jamo":u=>u>=12592&&u<=12687,Kanbun:u=>u>=12688&&u<=12703,"Bopomofo Extended":u=>u>=12704&&u<=12735,"CJK Strokes":u=>u>=12736&&u<=12783,"Katakana Phonetic Extensions":u=>u>=12784&&u<=12799,"Enclosed CJK Letters and Months":u=>u>=12800&&u<=13055,"CJK Compatibility":u=>u>=13056&&u<=13311,"CJK Unified Ideographs Extension A":u=>u>=13312&&u<=19903,"Yijing Hexagram Symbols":u=>u>=19904&&u<=19967,"CJK Unified Ideographs":u=>u>=19968&&u<=40959,"Yi Syllables":u=>u>=40960&&u<=42127,"Yi Radicals":u=>u>=42128&&u<=42191,"Hangul Jamo Extended-A":u=>u>=43360&&u<=43391,"Hangul Syllables":u=>u>=44032&&u<=55215,"Hangul Jamo Extended-B":u=>u>=55216&&u<=55295,"Private Use Area":u=>u>=57344&&u<=63743,"CJK Compatibility Ideographs":u=>u>=63744&&u<=64255,"Arabic Presentation Forms-A":u=>u>=64336&&u<=65023,"Vertical Forms":u=>u>=65040&&u<=65055,"CJK Compatibility Forms":u=>u>=65072&&u<=65103,"Small Form Variants":u=>u>=65104&&u<=65135,"Arabic Presentation Forms-B":u=>u>=65136&&u<=65279,"Halfwidth and Fullwidth Forms":u=>u>=65280&&u<=65519,Osage:u=>u>=66736&&u<=66815,"CJK Unified Ideographs Extension B":u=>u>=131072&&u<=173791};function Ni(u){for(const n of u)if(Nu(n.charCodeAt(0)))return!0;return!1}function Ka(u){for(const n of u)if(!gp(n.charCodeAt(0)))return!1;return!0}function gp(u){return!(dn.Arabic(u)||dn["Arabic Supplement"](u)||dn["Arabic Extended-A"](u)||dn["Arabic Presentation Forms-A"](u)||dn["Arabic Presentation Forms-B"](u))}function Nu(u){return!(u!==746&&u!==747&&(u<4352||!(dn["Bopomofo Extended"](u)||dn.Bopomofo(u)||dn["CJK Compatibility Forms"](u)&&!(u>=65097&&u<=65103)||dn["CJK Compatibility Ideographs"](u)||dn["CJK Compatibility"](u)||dn["CJK Radicals Supplement"](u)||dn["CJK Strokes"](u)||!(!dn["CJK Symbols and Punctuation"](u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||dn["CJK Unified Ideographs Extension A"](u)||dn["CJK Unified Ideographs"](u)||dn["Enclosed CJK Letters and Months"](u)||dn["Hangul Compatibility Jamo"](u)||dn["Hangul Jamo Extended-A"](u)||dn["Hangul Jamo Extended-B"](u)||dn["Hangul Jamo"](u)||dn["Hangul Syllables"](u)||dn.Hiragana(u)||dn["Ideographic Description Characters"](u)||dn.Kanbun(u)||dn["Kangxi Radicals"](u)||dn["Katakana Phonetic Extensions"](u)||dn.Katakana(u)&&u!==12540||!(!dn["Halfwidth and Fullwidth Forms"](u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!dn["Small Form Variants"](u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||dn["Unified Canadian Aboriginal Syllabics"](u)||dn["Unified Canadian Aboriginal Syllabics Extended"](u)||dn["Vertical Forms"](u)||dn["Yijing Hexagram Symbols"](u)||dn["Yi Syllables"](u)||dn["Yi Radicals"](u))))}function Bu(u){return!(Nu(u)||function(n){return!!(dn["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||dn["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||dn["Letterlike Symbols"](n)||dn["Number Forms"](n)||dn["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||dn["Control Pictures"](n)&&n!==9251||dn["Optical Character Recognition"](n)||dn["Enclosed Alphanumerics"](n)||dn["Geometric Shapes"](n)||dn["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||dn["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||dn["CJK Symbols and Punctuation"](n)||dn.Katakana(n)||dn["Private Use Area"](n)||dn["CJK Compatibility Forms"](n)||dn["Small Form Variants"](n)||dn["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(u))}function tf(u){return u>=1424&&u<=2303||dn["Arabic Presentation Forms-A"](u)||dn["Arabic Presentation Forms-B"](u)}function nf(u,n){return!(!n&&tf(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||dn.Khmer(u))}function mc(u){for(const n of u)if(tf(n.charCodeAt(0)))return!0;return!1}const id="deferred",ma="loading",ad="loaded";let ul=null,Qo="unavailable",Fu=null;const _m=function(u){u&&typeof u=="string"&&u.indexOf("NetworkError")>-1&&(Qo="error"),ul&&ul(u)};function od(){gc.fire(new Oo("pluginStateChange",{pluginStatus:Qo,pluginURL:Fu}))}const gc=new Ol,rf=function(){return Qo},yo=function(){if(Qo!==id||!Fu)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Qo=ma,od(),Fu&&Ri({url:Fu},u=>{u?_m(u):(Qo=ad,od())})},Ii={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Qo===ad||Ii.applyArabicShaping!=null,isLoading:()=>Qo===ma,setState(u){Qo=u.pluginStatus,Fu=u.pluginURL},isParsed:()=>Ii.applyArabicShaping!=null&&Ii.processBidirectionalText!=null&&Ii.processStyledBidirectionalText!=null,getPluginURL:()=>Fu};class ci{constructor(n,s){this.zoom=n,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.transition=s.transition,this.pitch=s.pitch,this.brightness=s.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(n){return function(s,h){for(const y of s)if(!nf(y.charCodeAt(0),h))return!1;return!0}(n,Ii.isLoaded())}}class yc{constructor(n,s,h,y){this.property=n,this.value=s,this.expression=function(d,v,M,k){if(ll(d))return new ah(d,v);if(Kh(d)||Array.isArray(d)&&d.length>0){const j=Qh(d,v,M,k);if(j.result==="error")throw new Error(j.value.map(E=>`${E.key}: ${E.message}`).join(", "));return j.value}{let j=d;return typeof d=="string"&&v.type==="color"&&(j=Vr.parse(d)),{kind:"constant",configDependencies:new Set,evaluate:()=>j}}}(s===void 0?n.specification.default:s,n.specification,h,y)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,s,h){return this.property.possiblyEvaluate(this,n,s,h)}}class _c{constructor(n,s,h){this.property=n,this.value=new yc(n,void 0,s,h)}transitioned(n,s){return new Ll(this.property,this.value,s,ar({},n.transition,this.transition),n.now)}untransitioned(){return new Ll(this.property,this.value,null,{},0)}}class af{constructor(n,s,h){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues),this._scope=s,this._options=h,this.configDependencies=new Set}getValue(n){return Sa(this._values[n].value.value)}setValue(n,s){this._values.hasOwnProperty(n)||(this._values[n]=new _c(this._values[n].property,this._scope,this._options)),this._values[n].value=new yc(this._values[n].property,s===null?void 0:Sa(s),this._scope,this._options),this._values[n].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[n].value.expression.configDependencies]))}setTransitionOrValue(n,s){s&&(this._options=s);const h=this._properties.properties;if(n)for(const y in n){const d=n[y];if(Ui(y,"-transition")){const v=y.slice(0,-11);h[v]&&this.setTransition(v,d)}else h.hasOwnProperty(y)&&this.setValue(y,d)}}getTransition(n){return Sa(this._values[n].transition)}setTransition(n,s){this._values.hasOwnProperty(n)||(this._values[n]=new _c(this._values[n].property)),this._values[n].transition=Sa(s)||void 0}serialize(){const n={};for(const s of Object.keys(this._values)){const h=this.getValue(s);h!==void 0&&(n[s]=h);const y=this.getTransition(s);y!==void 0&&(n[`${s}-transition`]=y)}return n}transitioned(n,s){const h=new vc(this._properties);for(const y of Object.keys(this._values))h._values[y]=this._values[y].transitioned(n,s._values[y]);return h}untransitioned(){const n=new vc(this._properties);for(const s of Object.keys(this._values))n._values[s]=this._values[s].untransitioned();return n}}class Ll{constructor(n,s,h,y,d){const v=y.delay||0,M=y.duration||0;d=d||0,this.property=n,this.value=s,this.begin=d+v,this.end=this.begin+M,n.specification.transition&&(y.delay||y.duration)&&(this.prior=h)}possiblyEvaluate(n,s,h){const y=n.now||0,d=this.value.possiblyEvaluate(n,s,h),v=this.prior;if(v){if(y>this.end)return this.prior=null,d;if(this.value.isDataDriven())return this.prior=null,d;if(y<this.begin)return v.possiblyEvaluate(n,s,h);{const M=(y-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(n,s,h),d,La(M))}}return d}}class vc{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,s,h){const y=new sh(this._properties);for(const d of Object.keys(this._values))y._values[d]=this._values[d].possiblyEvaluate(n,s,h);return y}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class xc{constructor(n,s,h){this._properties=n,this._values=Object.create(n.defaultPropertyValues),this._scope=s,this._options=h,this.configDependencies=new Set}getValue(n){return Sa(this._values[n].value)}setValue(n,s){this._values[n]=new yc(this._values[n].property,s===null?void 0:Sa(s),this._scope,this._options),this._values[n].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[n].expression.configDependencies]))}serialize(){const n={};for(const s of Object.keys(this._values)){const h=this.getValue(s);h!==void 0&&(n[s]=h)}return n}possiblyEvaluate(n,s,h){const y=new sh(this._properties);for(const d of Object.keys(this._values))y._values[d]=this._values[d].possiblyEvaluate(n,s,h);return y}}class bc{constructor(n,s,h){this.property=n,this.value=s,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,s,h,y){return this.property.evaluate(this.value,this.parameters,n,s,h,y)}}class sh{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class sn{constructor(n){this.specification=n}possiblyEvaluate(n,s){return n.expression.evaluate(s)}interpolate(n,s,h){const y=fs[this.specification.type];return y?y(n,s,h):n}}class En{constructor(n,s){this.specification=n,this.overrides=s}possiblyEvaluate(n,s,h,y){return new bc(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(s,null,{},h,y)}:n.expression,s)}interpolate(n,s,h){if(n.value.kind!=="constant"||s.value.kind!=="constant")return n;if(n.value.value===void 0||s.value.value===void 0)return new bc(this,{kind:"constant",value:void 0},n.parameters);const y=fs[this.specification.type];return y?new bc(this,{kind:"constant",value:y(n.value.value,s.value.value,h)},n.parameters):n}evaluate(n,s,h,y,d,v){return n.kind==="constant"?n.value:n.evaluate(s,h,y,d,v)}}class lh{constructor(n){this.specification=n}possiblyEvaluate(n,s,h,y){return!!n.expression.evaluate(s,null,{},h,y)}interpolate(){return!1}}class Bi{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const s=new ci(0,{});for(const h in n){const y=n[h];y.specification.overridable&&this.overridableProperties.push(h);const d=this.defaultPropertyValues[h]=new yc(y,void 0),v=this.defaultTransitionablePropertyValues[h]=new _c(y);this.defaultTransitioningPropertyValues[h]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=d.possiblyEvaluate(s)}}}In(En,"DataDrivenProperty"),In(sn,"DataConstantProperty"),In(lh,"ColorRampProperty");var _t=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow","experimental":true},"rain":{"type":"rain","experimental":true},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor","experimental":true},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"metadata":{"experimental":true,"type":"*"},"selectors":{"experimental":true,"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"experimental":true,"type":"string","required":true},"properties":{"experimental":true,"type":"selectorProperty","required":false},"featureNamespace":{"experimental":true,"type":"string","required":false},"_uniqueFeatureID":{"experimental":true,"type":"boolean","private":true,"required":false}},"selectorProperty":{"experimental":true,"*":{"experimental":true,"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-quality":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]},"experimental":true},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant"},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","experimental":true,"private":true,"expression":{},"property-type":"data-constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"line-cross-slope":{"type":"number","experimental":true,"expression":{},"property-type":"constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","experimental":true,"private":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.4,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","property-type":"data-constant","default":0.71,"minimum":0,"maximum":5,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.57,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","property-type":"data-constant","default":0.7,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}},"buildingFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"flat","property-type":"data-constant"},"fill-extrusion-base-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"terrain","property-type":"data-constant"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"experimental":true,"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"*"}}}');function yp(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function sd(u){if(Array.isArray(u))return u.map(sd);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){const n={};for(const s in u)n[s]=sd(u[s]);return n}return yp(u)}function vm(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const n of u.slice(1))if(!vm(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}function xm(u,n="",s=null,h="fill"){if(u==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};vm(u)||(u=ld(u));const y=u;let d=!0;try{d=function(E){if(!wc(E))return E;let D=sd(E);return wm(D),D=bm(D),D}(y)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(y,null,2)}
        `)}let v=null,M=null;if(h!=="background"&&h!=="sky"&&h!=="slot"){M=_t[`filter_${h}`];const E=pa(d,M,n,s);if(E.result==="error")throw new Error(E.value.map(D=>`${D.key}: ${D.message}`).join(", "));v=(D,B,R)=>E.value.evaluate(D,B,{},R)}let k=null,j=null;if(d!==y){const E=pa(y,M,n,s);if(E.result==="error")throw new Error(E.value.map(D=>`${D.key}: ${D.message}`).join(", "));k=(D,B,R,z,q)=>E.value.evaluate(D,B,{},R,void 0,void 0,z,q),j=!Qr(E.value.expression)}return{filter:v,dynamicFilter:k||void 0,needGeometry:Sm(d),needFeature:!!j}}function bm(u){if(!Array.isArray(u))return u;const n=function(s){if(jg.has(s[0])){for(let h=1;h<s.length;h++)if(wc(s[h]))return!0}return s}(u);return n===!0?n:n.map(s=>bm(s))}function wm(u){let n=!1;const s=[];if(u[0]==="case"){for(let h=1;h<u.length-1;h+=2)n=n||wc(u[h]),s.push(u[h+1]);s.push(u[u.length-1])}else if(u[0]==="match"){n=n||wc(u[1]);for(let h=2;h<u.length-1;h+=2)s.push(u[h+1]);s.push(u[u.length-1])}else if(u[0]==="step"){n=n||wc(u[1]);for(let h=1;h<u.length-1;h+=2)s.push(u[h+1])}n&&(u.length=0,u.push("any",...s));for(let h=1;h<u.length;h++)wm(u[h])}function wc(u){if(!Array.isArray(u))return!1;if((n=u[0])==="pitch"||n==="distance-from-center")return!0;var n;for(let s=1;s<u.length;s++)if(wc(u[s]))return!0;return!1}const jg=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Ug(u,n){return u<n?-1:u>n?1:0}function Sm(u){if(!Array.isArray(u))return!1;if(u[0]==="within"||u[0]==="distance")return!0;for(let n=1;n<u.length;n++)if(Sm(u[n]))return!0;return!1}function ld(u){if(!u)return!0;const n=u[0];return u.length<=1?n!=="any":n==="=="?ju(u[1],u[2],"=="):n==="!="?cl(ju(u[1],u[2],"==")):n==="<"||n===">"||n==="<="||n===">="?ju(u[1],u[2],n):n==="any"?(s=u.slice(1),["any"].concat(s.map(ld))):n==="all"?["all"].concat(u.slice(1).map(ld)):n==="none"?["all"].concat(u.slice(1).map(ld).map(cl)):n==="in"?Tm(u[1],u.slice(2)):n==="!in"?cl(Tm(u[1],u.slice(2))):n==="has"?_p(u[1]):n!=="!has"||cl(_p(u[1]));var s}function ju(u,n,s){switch(u){case"$type":return[`filter-type-${s}`,n];case"$id":return[`filter-id-${s}`,n];default:return[`filter-${s}`,u,n]}}function Tm(u,n){if(n.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(s=>typeof s!=typeof n[0])?["filter-in-large",u,["literal",n.sort(Ug)]]:["filter-in-small",u,["literal",n]]}}function _p(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function cl(u){return["!",u]}const ud="";function $s(u,n){return n?`${u}${ud}${n}`:u}const hl="-transition",Em=new Set(["fill","line","background","hillshade","raster"]);class Ca extends Ol{constructor(n,s,h,y,d){if(super(),this.id=n.id,this.fqid=$s(this.id,h),this.type=n.type,this.scope=h,this.lut=y,this.options=d,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,n.type!=="custom"){if(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type&&n.type!=="background"&&n.type!=="sky"&&n.type!=="slot"){this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter;const v=pa(this.filter,_t[`filter_${n.type}`]);v.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...v.value.configDependencies]))}if(n.slot&&(this.slot=n.slot),s.layout&&(this._unevaluatedLayout=new xc(s.layout,this.scope,d),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),s.paint){this._transitionablePaint=new af(s.paint,this.scope,d);for(const v in n.paint)this.setPaintProperty(v,n.paint[v]);for(const v in n.layout)this.setLayoutProperty(v,n.layout[v]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new sh(s.paint)}}}onAdd(n){}onRemove(n){}isDraped(n){return!this.is3D()&&Em.has(this.type)}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,s){if(this.type==="custom"&&n==="visibility")return void(this.visibility=s);const h=this._unevaluatedLayout;h._properties.properties[n]&&(h.setValue(n,s),this.configDependencies=new Set([...this.configDependencies,...h.configDependencies]),n==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(n){return Ui(n,hl)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,s){const h=this._transitionablePaint,y=h._properties.properties;if(Ui(n,hl)){const D=n.slice(0,-11);return y[D]&&h.setTransition(D,s||void 0),!1}if(!y[n])return!1;const d=h._values[n],v=d.value.isDataDriven(),M=d.value;h.setValue(n,s),this.configDependencies=new Set([...this.configDependencies,...h.configDependencies]),this._handleSpecialPaintPropertyUpdate(n);const k=h._values[n].value,j=k.isDataDriven(),E=Ui(n,"pattern")||n==="line-dasharray";return j||v||E||this._handleOverridablePaintPropertyUpdate(n,M,k)}_handleSpecialPaintPropertyUpdate(n){}getProgramIds(){return null}getDefaultProgramParams(n,s,h){return null}_handleOverridablePaintPropertyUpdate(n,s,h){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,s){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,s)}serialize(){return Er({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(n,s)=>!(n===void 0||s==="layout"&&!Object.keys(n).length||s==="paint"&&!Object.keys(n).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const n in this.paint._values){const s=this.paint.get(n);if(s instanceof bc&&Zh(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}compileFilter(n){this._filterCompiled||(this._featureFilter=xm(this.filter,this.scope,n),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(n){this._stats&&(n.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(n){}queryIntersectsFeature(n,s,h,y,d,v,M,k,j){}}const Vg={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class of{constructor(n,s){this._structArray=n,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class bi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,s){return n._trim(),s&&(n.isTransferred=!0,s.add(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const s=Object.create(this.prototype);return s.arrayBuffer=n.arrayBuffer,s.length=n.length,s.capacity=n.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...n){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...n){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Yr(u,n=1){let s=0,h=0;return{members:u.map(y=>{const d=Vg[y.type].BYTES_PER_ELEMENT,v=s=vp(s,Math.max(n,d)),M=y.components||1;return h=Math.max(h,d),s+=d*M,{name:y.name,type:y.type,components:M,offset:v}}),size:vp(s,Math.max(h,n)),alignment:n}}function vp(u,n){return Math.ceil(u/n)*n}class fu extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s){const h=this.length;return this.resize(h+1),this.emplace(h,n,s)}emplace(n,s,h){const y=2*n;return this.int16[y+0]=s,this.int16[y+1]=h,n}}fu.prototype.bytesPerElement=4,In(fu,"StructArrayLayout2i4");class uh extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,h){const y=this.length;return this.resize(y+1),this.emplace(y,n,s,h)}emplace(n,s,h,y){const d=3*n;return this.int16[d+0]=s,this.int16[d+1]=h,this.int16[d+2]=y,n}}uh.prototype.bytesPerElement=6,In(uh,"StructArrayLayout3i6");class zl extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,h,y){const d=this.length;return this.resize(d+1),this.emplace(d,n,s,h,y)}emplace(n,s,h,y,d){const v=4*n;return this.int16[v+0]=s,this.int16[v+1]=h,this.int16[v+2]=y,this.int16[v+3]=d,n}}zl.prototype.bytesPerElement=8,In(zl,"StructArrayLayout4i8");class cd extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,h,y,d){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,h,y,d)}emplace(n,s,h,y,d,v){const M=5*n;return this.int16[M+0]=s,this.int16[M+1]=h,this.int16[M+2]=y,this.int16[M+3]=d,this.int16[M+4]=v,n}}cd.prototype.bytesPerElement=10,In(cd,"StructArrayLayout5i10");class sf extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,h,y,d,v,M){const k=this.length;return this.resize(k+1),this.emplace(k,n,s,h,y,d,v,M)}emplace(n,s,h,y,d,v,M,k){const j=6*n,E=12*n,D=3*n;return this.int16[j+0]=s,this.int16[j+1]=h,this.uint8[E+4]=y,this.uint8[E+5]=d,this.uint8[E+6]=v,this.uint8[E+7]=M,this.float32[D+2]=k,n}}sf.prototype.bytesPerElement=12,In(sf,"StructArrayLayout2i4ub1f12");class du extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,h){const y=this.length;return this.resize(y+1),this.emplace(y,n,s,h)}emplace(n,s,h,y){const d=3*n;return this.float32[d+0]=s,this.float32[d+1]=h,this.float32[d+2]=y,n}}du.prototype.bytesPerElement=12,In(du,"StructArrayLayout3f12");class so extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,h,y,d){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,h,y,d)}emplace(n,s,h,y,d,v){const M=6*n,k=3*n;return this.uint16[M+0]=s,this.uint16[M+1]=h,this.uint16[M+2]=y,this.uint16[M+3]=d,this.float32[k+2]=v,n}}so.prototype.bytesPerElement=12,In(so,"StructArrayLayout4ui1f12");class hd extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,h,y){const d=this.length;return this.resize(d+1),this.emplace(d,n,s,h,y)}emplace(n,s,h,y,d){const v=4*n;return this.uint16[v+0]=s,this.uint16[v+1]=h,this.uint16[v+2]=y,this.uint16[v+3]=d,n}}hd.prototype.bytesPerElement=8,In(hd,"StructArrayLayout4ui8");class lf extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,h,y,d,v){const M=this.length;return this.resize(M+1),this.emplace(M,n,s,h,y,d,v)}emplace(n,s,h,y,d,v,M){const k=6*n;return this.int16[k+0]=s,this.int16[k+1]=h,this.int16[k+2]=y,this.int16[k+3]=d,this.int16[k+4]=v,this.int16[k+5]=M,n}}lf.prototype.bytesPerElement=12,In(lf,"StructArrayLayout6i12");class fd extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,h,y,d,v,M,k,j,E,D,B){const R=this.length;return this.resize(R+1),this.emplace(R,n,s,h,y,d,v,M,k,j,E,D,B)}emplace(n,s,h,y,d,v,M,k,j,E,D,B,R){const z=12*n;return this.int16[z+0]=s,this.int16[z+1]=h,this.int16[z+2]=y,this.int16[z+3]=d,this.uint16[z+4]=v,this.uint16[z+5]=M,this.uint16[z+6]=k,this.uint16[z+7]=j,this.int16[z+8]=E,this.int16[z+9]=D,this.int16[z+10]=B,this.int16[z+11]=R,n}}fd.prototype.bytesPerElement=24,In(fd,"StructArrayLayout4i4ui4i24");class xp extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,h,y,d,v){const M=this.length;return this.resize(M+1),this.emplace(M,n,s,h,y,d,v)}emplace(n,s,h,y,d,v,M){const k=10*n,j=5*n;return this.int16[k+0]=s,this.int16[k+1]=h,this.int16[k+2]=y,this.float32[j+2]=d,this.float32[j+3]=v,this.float32[j+4]=M,n}}xp.prototype.bytesPerElement=20,In(xp,"StructArrayLayout3i3f20");class Sc extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,h,y){const d=this.length;return this.resize(d+1),this.emplace(d,n,s,h,y)}emplace(n,s,h,y,d){const v=4*n;return this.float32[v+0]=s,this.float32[v+1]=h,this.float32[v+2]=y,this.float32[v+3]=d,n}}Sc.prototype.bytesPerElement=16,In(Sc,"StructArrayLayout4f16");class Am extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint32[1*n+0]=s,n}}Am.prototype.bytesPerElement=4,In(Am,"StructArrayLayout1ul4");class Tc extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s){const h=this.length;return this.resize(h+1),this.emplace(h,n,s)}emplace(n,s,h){const y=2*n;return this.uint16[y+0]=s,this.uint16[y+1]=h,n}}Tc.prototype.bytesPerElement=4,In(Tc,"StructArrayLayout2ui4");class bp extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,h,y,d,v,M,k,j,E,D,B,R){const z=this.length;return this.resize(z+1),this.emplace(z,n,s,h,y,d,v,M,k,j,E,D,B,R)}emplace(n,s,h,y,d,v,M,k,j,E,D,B,R,z){const q=20*n,W=10*n;return this.int16[q+0]=s,this.int16[q+1]=h,this.int16[q+2]=y,this.int16[q+3]=d,this.int16[q+4]=v,this.float32[W+3]=M,this.float32[W+4]=k,this.float32[W+5]=j,this.float32[W+6]=E,this.int16[q+14]=D,this.uint32[W+8]=B,this.uint16[q+18]=R,this.uint16[q+19]=z,n}}bp.prototype.bytesPerElement=40,In(bp,"StructArrayLayout5i4f1i1ul2ui40");class Ec extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,h,y,d,v,M){const k=this.length;return this.resize(k+1),this.emplace(k,n,s,h,y,d,v,M)}emplace(n,s,h,y,d,v,M,k){const j=8*n;return this.int16[j+0]=s,this.int16[j+1]=h,this.int16[j+2]=y,this.int16[j+4]=d,this.int16[j+5]=v,this.int16[j+6]=M,this.int16[j+7]=k,n}}Ec.prototype.bytesPerElement=16,In(Ec,"StructArrayLayout3i2i2i16");class dd extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,h,y,d){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,h,y,d)}emplace(n,s,h,y,d,v){const M=4*n,k=8*n;return this.float32[M+0]=s,this.float32[M+1]=h,this.float32[M+2]=y,this.int16[k+6]=d,this.int16[k+7]=v,n}}dd.prototype.bytesPerElement=16,In(dd,"StructArrayLayout2f1f2i16");class uf extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,h,y,d,v){const M=this.length;return this.resize(M+1),this.emplace(M,n,s,h,y,d,v)}emplace(n,s,h,y,d,v,M){const k=20*n,j=5*n;return this.uint8[k+0]=s,this.uint8[k+1]=h,this.float32[j+1]=y,this.float32[j+2]=d,this.float32[j+3]=v,this.float32[j+4]=M,n}}uf.prototype.bytesPerElement=20,In(uf,"StructArrayLayout2ub4f20");class Ja extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,h){const y=this.length;return this.resize(y+1),this.emplace(y,n,s,h)}emplace(n,s,h,y){const d=3*n;return this.uint16[d+0]=s,this.uint16[d+1]=h,this.uint16[d+2]=y,n}}Ja.prototype.bytesPerElement=6,In(Ja,"StructArrayLayout3ui6");class wp extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,s,h,y,d,v,M,k,j,E,D,B,R,z,q,W,K,oe,se,ne,ce){const pe=this.length;return this.resize(pe+1),this.emplace(pe,n,s,h,y,d,v,M,k,j,E,D,B,R,z,q,W,K,oe,se,ne,ce)}emplace(n,s,h,y,d,v,M,k,j,E,D,B,R,z,q,W,K,oe,se,ne,ce,pe){const we=30*n,ke=15*n,Re=60*n;return this.int16[we+0]=s,this.int16[we+1]=h,this.int16[we+2]=y,this.float32[ke+2]=d,this.float32[ke+3]=v,this.uint16[we+8]=M,this.uint16[we+9]=k,this.uint32[ke+5]=j,this.uint32[ke+6]=E,this.uint32[ke+7]=D,this.uint16[we+16]=B,this.uint16[we+17]=R,this.uint16[we+18]=z,this.float32[ke+10]=q,this.float32[ke+11]=W,this.uint8[Re+48]=K,this.uint8[Re+49]=oe,this.uint8[Re+50]=se,this.uint32[ke+13]=ne,this.int16[we+28]=ce,this.uint8[Re+58]=pe,n}}wp.prototype.bytesPerElement=60,In(wp,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class fl extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,s,h,y,d,v,M,k,j,E,D,B,R,z,q,W,K,oe,se,ne,ce,pe,we,ke,Re,Pe,We,Le,Je,it,tt,ot){const ut=this.length;return this.resize(ut+1),this.emplace(ut,n,s,h,y,d,v,M,k,j,E,D,B,R,z,q,W,K,oe,se,ne,ce,pe,we,ke,Re,Pe,We,Le,Je,it,tt,ot)}emplace(n,s,h,y,d,v,M,k,j,E,D,B,R,z,q,W,K,oe,se,ne,ce,pe,we,ke,Re,Pe,We,Le,Je,it,tt,ot,ut){const pt=20*n,lt=40*n,Lt=80*n;return this.float32[pt+0]=s,this.float32[pt+1]=h,this.int16[lt+4]=y,this.int16[lt+5]=d,this.int16[lt+6]=v,this.int16[lt+7]=M,this.int16[lt+8]=k,this.int16[lt+9]=j,this.int16[lt+10]=E,this.int16[lt+11]=D,this.int16[lt+12]=B,this.uint16[lt+13]=R,this.uint16[lt+14]=z,this.uint16[lt+15]=q,this.uint16[lt+16]=W,this.uint16[lt+17]=K,this.uint16[lt+18]=oe,this.uint16[lt+19]=se,this.uint16[lt+20]=ne,this.uint16[lt+21]=ce,this.uint16[lt+22]=pe,this.uint16[lt+23]=we,this.uint16[lt+24]=ke,this.uint16[lt+25]=Re,this.uint16[lt+26]=Pe,this.uint16[lt+27]=We,this.uint32[pt+14]=Le,this.float32[pt+15]=Je,this.float32[pt+16]=it,this.float32[pt+17]=tt,this.float32[pt+18]=ot,this.uint8[Lt+76]=ut,n}}fl.prototype.bytesPerElement=80,In(fl,"StructArrayLayout2f9i15ui1ul4f1ub80");class Nl extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.float32[1*n+0]=s,n}}Nl.prototype.bytesPerElement=4,In(Nl,"StructArrayLayout1f4");class es extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,h,y,d){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,h,y,d)}emplace(n,s,h,y,d,v){const M=5*n;return this.float32[M+0]=s,this.float32[M+1]=h,this.float32[M+2]=y,this.float32[M+3]=d,this.float32[M+4]=v,n}}es.prototype.bytesPerElement=20,In(es,"StructArrayLayout5f20");class pu extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,h,y,d,v,M){const k=this.length;return this.resize(k+1),this.emplace(k,n,s,h,y,d,v,M)}emplace(n,s,h,y,d,v,M,k){const j=7*n;return this.float32[j+0]=s,this.float32[j+1]=h,this.float32[j+2]=y,this.float32[j+3]=d,this.float32[j+4]=v,this.float32[j+5]=M,this.float32[j+6]=k,n}}pu.prototype.bytesPerElement=28,In(pu,"StructArrayLayout7f28");class dl extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,h,y,d,v,M,k,j,E,D){const B=this.length;return this.resize(B+1),this.emplace(B,n,s,h,y,d,v,M,k,j,E,D)}emplace(n,s,h,y,d,v,M,k,j,E,D,B){const R=11*n;return this.float32[R+0]=s,this.float32[R+1]=h,this.float32[R+2]=y,this.float32[R+3]=d,this.float32[R+4]=v,this.float32[R+5]=M,this.float32[R+6]=k,this.float32[R+7]=j,this.float32[R+8]=E,this.float32[R+9]=D,this.float32[R+10]=B,n}}dl.prototype.bytesPerElement=44,In(dl,"StructArrayLayout11f44");class cf extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,h,y,d,v,M,k,j){const E=this.length;return this.resize(E+1),this.emplace(E,n,s,h,y,d,v,M,k,j)}emplace(n,s,h,y,d,v,M,k,j,E){const D=9*n;return this.float32[D+0]=s,this.float32[D+1]=h,this.float32[D+2]=y,this.float32[D+3]=d,this.float32[D+4]=v,this.float32[D+5]=M,this.float32[D+6]=k,this.float32[D+7]=j,this.float32[D+8]=E,n}}cf.prototype.bytesPerElement=36,In(cf,"StructArrayLayout9f36");class ch extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s){const h=this.length;return this.resize(h+1),this.emplace(h,n,s)}emplace(n,s,h){const y=2*n;return this.float32[y+0]=s,this.float32[y+1]=h,n}}ch.prototype.bytesPerElement=8,In(ch,"StructArrayLayout2f8");class Sp extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,h,y){const d=this.length;return this.resize(d+1),this.emplace(d,n,s,h,y)}emplace(n,s,h,y,d){const v=6*n;return this.uint32[3*n+0]=s,this.uint16[v+2]=h,this.uint16[v+3]=y,this.uint16[v+4]=d,n}}Sp.prototype.bytesPerElement=12,In(Sp,"StructArrayLayout1ul3ui12");class Uu extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint16[1*n+0]=s,n}}Uu.prototype.bytesPerElement=2,In(Uu,"StructArrayLayout1ui2");class Ac extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,h,y,d,v,M,k,j,E,D,B,R,z,q,W){const K=this.length;return this.resize(K+1),this.emplace(K,n,s,h,y,d,v,M,k,j,E,D,B,R,z,q,W)}emplace(n,s,h,y,d,v,M,k,j,E,D,B,R,z,q,W,K){const oe=16*n;return this.float32[oe+0]=s,this.float32[oe+1]=h,this.float32[oe+2]=y,this.float32[oe+3]=d,this.float32[oe+4]=v,this.float32[oe+5]=M,this.float32[oe+6]=k,this.float32[oe+7]=j,this.float32[oe+8]=E,this.float32[oe+9]=D,this.float32[oe+10]=B,this.float32[oe+11]=R,this.float32[oe+12]=z,this.float32[oe+13]=q,this.float32[oe+14]=W,this.float32[oe+15]=K,n}}Ac.prototype.bytesPerElement=64,In(Ac,"StructArrayLayout16f64");class hf extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,h,y,d,v,M){const k=this.length;return this.resize(k+1),this.emplace(k,n,s,h,y,d,v,M)}emplace(n,s,h,y,d,v,M,k){const j=10*n,E=5*n;return this.uint16[j+0]=s,this.uint16[j+1]=h,this.uint16[j+2]=y,this.uint16[j+3]=d,this.float32[E+2]=v,this.float32[E+3]=M,this.float32[E+4]=k,n}}hf.prototype.bytesPerElement=20,In(hf,"StructArrayLayout4ui3f20");class Tp extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.int16[1*n+0]=s,n}}Tp.prototype.bytesPerElement=2,In(Tp,"StructArrayLayout1i2");class pd extends bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint8[1*n+0]=s,n}}pd.prototype.bytesPerElement=1,In(pd,"StructArrayLayout1ub1");class md extends of{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}md.prototype.size=40;class Ep extends bp{get(n){return new md(this,n)}}In(Ep,"CollisionBoxArray");class hh extends of{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(n){this._structArray.uint8[this._pos1+49]=n}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(n){this._structArray.uint8[this._pos1+50]=n}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(n){this._structArray.uint32[this._pos4+13]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(n){this._structArray.uint8[this._pos1+58]=n}}hh.prototype.size=60;class Mm extends wp{get(n){return new hh(this,n)}}In(Mm,"PlacedSymbolArray");class Om extends of{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(n){this._structArray.uint32[this._pos4+14]=n}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(n){this._structArray.float32[this._pos4+18]=n}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}Om.prototype.size=80;class qg extends fl{get(n){return new Om(this,n)}}In(qg,"SymbolInstanceArray");class Im extends Nl{getoffsetX(n){return this.float32[1*n+0]}}In(Im,"GlyphOffsetArray");class lo extends fu{getx(n){return this.int16[2*n+0]}gety(n){return this.int16[2*n+1]}}In(lo,"SymbolLineVertexArray");class Fa extends of{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Fa.prototype.size=12;class ff extends Sp{get(n){return new Fa(this,n)}}In(ff,"FeatureIndexArray");class ts extends Tc{geta_centroid_pos0(n){return this.uint16[2*n+0]}geta_centroid_pos1(n){return this.uint16[2*n+1]}}In(ts,"FillExtrusionCentroidArray");class df extends of{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}df.prototype.size=6;class Cm extends uh{get(n){return new df(this,n)}}In(Cm,"FillExtrusionWallArray");const Gg=Yr([{name:"a_pos",components:2,type:"Int16"}],4),gd=Yr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Yi{constructor(n=[]){this.segments=n}_prepareSegment(n,s,h,y){let d=this.segments[this.segments.length-1];return n>Yi.MAX_VERTEX_ARRAY_LENGTH&&lr(`Max vertices per segment is ${Yi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!d||d.vertexLength+n>Yi.MAX_VERTEX_ARRAY_LENGTH||d.sortKey!==y)&&(d={vertexOffset:s,primitiveOffset:h,vertexLength:0,primitiveLength:0},y!==void 0&&(d.sortKey=y),this.segments.push(d)),d}prepareSegment(n,s,h,y){return this._prepareSegment(n,s.length,h.length,y)}get(){return this.segments}destroy(){for(const n of this.segments)for(const s in n.vaos)n.vaos[s].destroy()}static simpleSegment(n,s,h,y){return new Yi([{vertexOffset:n,primitiveOffset:s,vertexLength:h,primitiveLength:y,vaos:{},sortKey:0}])}}function yd(u,n){return 256*(u=Mn(Math.floor(u),0,255))+Mn(Math.floor(n),0,255)}Yi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,In(Yi,"SegmentVector");const $g=Yr([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Ap=Yr([{name:"a_dash",components:4,type:"Uint16"}]);class fh{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(n,s,h,y){this.ids.push(Mp(n)),this.positions.push(s,h,y)}eachPosition(n,s){const h=Mp(n);let y=0,d=this.ids.length-1;for(;y<d;){const v=y+d>>1;this.ids[v]>=h?d=v:y=v+1}for(;this.ids[y]===h;)s(this.positions[3*y],this.positions[3*y+1],this.positions[3*y+2]),y++}static serialize(n,s){const h=new Float64Array(n.ids),y=new Uint32Array(n.positions);return dh(h,y,0,h.length-1),s&&(s.add(h.buffer),s.add(y.buffer)),{ids:h,positions:y}}static deserialize(n){const s=new fh;let h;s.ids=n.ids,s.positions=n.positions;for(const y of s.ids)y!==h&&s.uniqueIds.push(y),h=y;return s.indexed=!0,s}}function Mp(u){const n=+u;return!isNaN(n)&&Number.MIN_SAFE_INTEGER<=n&&n<=Number.MAX_SAFE_INTEGER?n:Wo(String(u))}function dh(u,n,s,h){for(;s<h;){const y=u[s+h>>1];let d=s-1,v=h+1;for(;;){do d++;while(u[d]<y);do v--;while(u[v]>y);if(d>=v)break;_d(u,d,v),_d(n,3*d,3*v),_d(n,3*d+1,3*v+1),_d(n,3*d+2,3*v+2)}v-s<h-v?(dh(u,n,s,v),s=v+1):(dh(u,n,v+1,h),h=v)}}function _d(u,n,s){const h=u[n];u[n]=u[s],u[s]=h}In(fh,"FeaturePositionMap");class pl{constructor(n){this.gl=n.gl,this.initialized=!1}fetchUniformLocation(n,s){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(n,s),this.initialized=!0),!!this.location}set(n,s,h){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class ph extends pl{constructor(n){super(n),this.current=0}set(n,s,h){this.fetchUniformLocation(n,s)&&this.current!==h&&(this.current=h,this.gl.uniform1i(this.location,h))}}class na extends pl{constructor(n){super(n),this.current=0}set(n,s,h){this.fetchUniformLocation(n,s)&&this.current!==h&&(this.current=h,this.gl.uniform1f(this.location,h))}}class Hs extends pl{constructor(n){super(n),this.current=[0,0]}set(n,s,h){this.fetchUniformLocation(n,s)&&(h[0]===this.current[0]&&h[1]===this.current[1]||(this.current=h,this.gl.uniform2f(this.location,h[0],h[1])))}}class Mc extends pl{constructor(n){super(n),this.current=[0,0,0]}set(n,s,h){this.fetchUniformLocation(n,s)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]||(this.current=h,this.gl.uniform3f(this.location,h[0],h[1],h[2])))}}class pf extends pl{constructor(n){super(n),this.current=[0,0,0,0]}set(n,s,h){this.fetchUniformLocation(n,s)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]&&h[3]===this.current[3]||(this.current=h,this.gl.uniform4f(this.location,h[0],h[1],h[2],h[3])))}}class mu extends pl{constructor(n){super(n),this.current=Vr.transparent.toRenderColor(null)}set(n,s,h){this.fetchUniformLocation(n,s)&&(h.r===this.current.r&&h.g===this.current.g&&h.b===this.current.b&&h.a===this.current.a||(this.current=h,this.gl.uniform4f(this.location,h.r,h.g,h.b,h.a)))}}const Op=new Float32Array(16);class vd extends pl{constructor(n){super(n),this.current=Op}set(n,s,h){if(this.fetchUniformLocation(n,s)){if(h[12]!==this.current[12]||h[0]!==this.current[0])return this.current=h,void this.gl.uniformMatrix4fv(this.location,!1,h);for(let y=1;y<16;y++)if(h[y]!==this.current[y]){this.current=h,this.gl.uniformMatrix4fv(this.location,!1,h);break}}}}const Ip=new Float32Array(9),Pm=new Float32Array(4);class Vu extends pl{constructor(n){super(n),this.current=Pm}set(n,s,h){if(this.fetchUniformLocation(n,s)){for(let y=0;y<4;y++)if(h[y]!==this.current[y]){this.current=h,this.gl.uniformMatrix2fv(this.location,!1,h);break}}}}function Bl(u){return[yd(255*u.r,255*u.g),yd(255*u.b,255*u.a)]}class Ts{constructor(n,s,h,y){this.value=n,this.uniformNames=s.map(d=>`u_${d}`),this.type=h,this.context=y}setUniform(n,s,h,y,d){const v=y.constantOr(this.value);s.set(n,d,v instanceof Vr?v.toRenderColor(this.ignoreLut?null:this.context.lut):v)}getBinding(n,s){return this.type==="color"?new mu(n):new na(n)}}class ns{constructor(n,s){this.uniformNames=s.map(h=>`u_${h}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(n){this.pixelRatio=n.pixelRatio||1,this.pattern=n.tl.concat(n.br)}setUniform(n,s,h,y,d){const v=d==="u_pattern"||d==="u_dash"?this.pattern:d==="u_pixel_ratio"?this.pixelRatio:null;v&&s.set(n,d,v)}getBinding(n,s){return s==="u_pattern"||s==="u_dash"?new pf(n):new na(n)}}class Fl{constructor(n,s,h,y){this.expression=n,this.type=h,this.maxValue=0,this.paintVertexAttributes=s.map(d=>({name:`a_${d}`,type:"Float32",components:h==="color"?2:1,offset:0})),this.paintVertexArray=new y}populatePaintArray(n,s,h,y,d,v,M){const k=this.paintVertexArray.length,j=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new ci(0,{brightness:v}),s,{},d,y,M):this.expression.kind==="constant"&&this.expression.value;!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate(new ci(0,{brightness:v}),s,{},d,y,M)==="none"),this.paintVertexArray.resize(n),this._setPaintValue(k,n,j,this.context)}updatePaintArray(n,s,h,y,d,v,M){const k=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:M},h,y,void 0,d):this.expression.kind==="constant"&&this.expression.value;!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate({zoom:0,brightness:M},h,y,void 0,d)==="none"),this._setPaintValue(n,s,k,this.context)}_setPaintValue(n,s,h,y){if(this.type==="color"){const d=Bl(h.toRenderColor(this.ignoreLut?null:y.lut));for(let v=n;v<s;v++)this.paintVertexArray.emplace(v,d[0],d[1])}else{for(let d=n;d<s;d++)this.paintVertexArray.emplace(d,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Xs{constructor(n,s,h,y,d,v){this.expression=n,this.uniformNames=s.map(M=>`u_${M}_t`),this.type=h,this.useIntegerZoom=y,this.context=d,this.maxValue=0,this.paintVertexAttributes=s.map(M=>({name:`a_${M}`,type:"Float32",components:h==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(n,s,h,y,d,v,M){const k=this.expression.evaluate(new ci(this.context.zoom,{brightness:v}),s,{},d,y,M),j=this.expression.evaluate(new ci(this.context.zoom+1,{brightness:v}),s,{},d,y,M);!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate(new ci(this.context.zoom,{brightness:v}),s,{},d,y,M)==="none");const E=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(E,n,k,j,this.context)}updatePaintArray(n,s,h,y,d,v,M){const k=this.expression.evaluate({zoom:this.context.zoom,brightness:M},h,y,void 0,d),j=this.expression.evaluate({zoom:this.context.zoom+1,brightness:M},h,y,void 0,d);!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate({zoom:this.context.zoom,brightness:M},h,y,void 0,d)==="none"),this._setPaintValue(n,s,k,j,this.context)}_setPaintValue(n,s,h,y,d){if(this.type==="color"){const v=Bl(h.toRenderColor(this.ignoreLut?null:d.lut)),M=Bl(h.toRenderColor(this.ignoreLut?null:d.lut));for(let k=n;k<s;k++)this.paintVertexArray.emplace(k,v[0],v[1],M[0],M[1])}else{for(let v=n;v<s;v++)this.paintVertexArray.emplace(v,h,y);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(y))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,s,h,y,d){const v=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,M=Mn(this.expression.interpolationFactor(v,this.context.zoom,this.context.zoom+1),0,1);s.set(n,d,M)}getBinding(n,s){return new na(n)}}class ml{constructor(n,s,h,y,d){this.expression=n,this.layerId=d,this.paintVertexAttributes=(h==="array"?Ap:$g).members;for(let v=0;v<s.length;++v);this.paintVertexArray=new y}populatePaintArray(n,s,h,y){const d=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValues(d,n,s.patterns&&s.patterns[this.layerId],h)}updatePaintArray(n,s,h,y,d,v,M){this._setPaintValues(n,s,h.patterns&&h.patterns[this.layerId],v)}_setPaintValues(n,s,h,y){if(!y||!h)return;const d=y[h];if(!d)return;const{tl:v,br:M,pixelRatio:k}=d;for(let j=n;j<s;j++)this.paintVertexArray.emplace(j,v[0],v[1],M[0],M[1],k)}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class gu{constructor(n,s,h=()=>!0){this.binders={},this._buffers=[],this.context=s;const y=[];for(const d in n.paint._values){const v=n.paint.get(d),M=n.paint.get(`${d}-use-theme`);if(d.endsWith("-use-theme")||!h(d)||!(v instanceof bc&&Zh(v.property.specification)))continue;const k=Cp(d,n.type),j=v.value,E=v.property.specification.type,D=!!v.property.useIntegerZoom,B=d==="line-dasharray"||d.endsWith("pattern"),R=d==="line-dasharray"&&n.layout.get("line-cap").value.kind!=="constant"||M&&M.value.kind!=="constant";if(j.kind!=="constant"||R)if(j.kind==="source"||R||B){const z=Pp(d,E,"source");this.binders[d]=B?new ml(j,k,E,z,n.id):new Fl(j,k,E,z),y.push(`/a_${d}`)}else{const z=Pp(d,E,"composite");this.binders[d]=new Xs(j,k,E,D,s,z),y.push(`/z_${d}`)}else this.binders[d]=B?new ns(j.value,k):new Ts(j.value,k,E,s),y.push(`/u_${d}`);M&&(this.binders[d].ignoreLut=M.constantOr("default")==="none",this.binders[d].lutExpression=M.value,this.binders[d].checkUseTheme=!0)}this.cacheKey=y.sort().join("")}getMaxValue(n){const s=this.binders[n];return s instanceof Fl||s instanceof Xs?s.maxValue:0}populatePaintArrays(n,s,h,y,d,v,M){for(const k in this.binders){const j=this.binders[k];j.context=this.context,j instanceof Fl||j instanceof Xs||j instanceof ml?j.populatePaintArray(n,s,h,y,d,v,M):j.lutExpression&&j instanceof Ts&&j.lutExpression&&(j.lutExpression.kind==="composite"||j.lutExpression.kind==="source")&&(j.ignoreLut=j.lutExpression.evaluate(new ci(0,{brightness:v}),s,{},d,y,M)==="none")}}setConstantPatternPositions(n){for(const s in this.binders){const h=this.binders[s];h instanceof ns&&h.setConstantPatternPositions(n)}}updatePaintArrays(n,s,h,y,d,v,M,k,j){let E=!1;const D=Object.keys(n),B=D.length!==0&&!k,R=B?D:s.uniqueIds;this.context.lut=d.lut;for(const z in this.binders){const q=this.binders[z];if(q.context=this.context,(q instanceof Fl||q instanceof Xs||q instanceof ml)&&q.expression&&q.expression.kind&&q.expression.kind!=="constant"&&(q.expression.isStateDependent===!0||q.expression.isLightConstant===!1)){const W=d.paint.get(z);q.expression=W.value;for(const K of R){const oe=n[K.toString()];s.eachPosition(K,(se,ne,ce)=>{const pe=y.feature(se);q.updatePaintArray(ne,ce,pe,oe,v,M,j)})}if(!B)for(const K of h.uniqueIds){const oe=n[K.toString()];h.eachPosition(K,(se,ne,ce)=>{const pe=y.feature(se);q.updatePaintArray(ne,ce,pe,oe,v,M,j)})}E=!0}}return E}defines(){const n=[];for(const s in this.binders){const h=this.binders[s];(h instanceof Ts||h instanceof ns)&&n.push(...h.uniformNames.map(y=>`#define HAS_UNIFORM_${y}`))}return n}getBinderAttributes(){const n=[];for(const s in this.binders){const h=this.binders[s];if(h instanceof Fl||h instanceof Xs||h instanceof ml)for(let y=0;y<h.paintVertexAttributes.length;y++)n.push(h.paintVertexAttributes[y].name)}return n}getBinderUniforms(){const n=[];for(const s in this.binders){const h=this.binders[s];if(h instanceof Ts||h instanceof ns||h instanceof Xs)for(const y of h.uniformNames)n.push(y)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n){const s=[];for(const h in this.binders){const y=this.binders[h];if(y instanceof Ts||y instanceof ns||y instanceof Xs)for(const d of y.uniformNames)s.push({name:d,property:h,binding:y.getBinding(n,d)})}return s}setUniforms(n,s,h,y,d){for(const{name:v,property:M,binding:k}of h){if(this.binders[M].checkUseTheme&&this.binders[M]instanceof Ts){const j=y.get(`${M}-use-theme`);j.isConstant()&&(this.binders[M].ignoreLut=j.constantOr("default")==="none")}this.binders[M].setUniform(n,k,d,y.get(M),v)}}updatePaintBuffers(){this._buffers=[];for(const n in this.binders){const s=this.binders[n];(s instanceof Fl||s instanceof Xs||s instanceof ml)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(n){for(const s in this.binders){const h=this.binders[s];(h instanceof Fl||h instanceof Xs||h instanceof ml)&&h.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const s=this.binders[n];(s instanceof Fl||s instanceof Xs||s instanceof ml)&&s.destroy()}}}class Es{constructor(n,s,h=()=>!0){this.programConfigurations={};for(const y of n)this.programConfigurations[y.id]=new gu(y,s,h);this.needsUpload=!1,this._featureMap=new fh,this._featureMapWithoutIds=new fh,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(n,s,h,y,d,v,M,k){for(const j in this.programConfigurations)this.programConfigurations[j].populatePaintArrays(n,s,y,d,v,M,k);s.id!==void 0?this._featureMap.add(s.id,h,this._bufferOffset,n):(this._featureMapWithoutIds.add(this._idlessCounter,h,this._bufferOffset,n),this._idlessCounter+=1),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,s,h,y,d,v,M){for(const k of h)this.needsUpload=this.programConfigurations[k.id].updatePaintArrays(n,this._featureMap,this._featureMapWithoutIds,s,k,y,d,v,M||0)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}const Vo={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Cp(u,n){return Vo[u]||[u.replace(`${n}-`,"").replace(/-/g,"_")]}const Hg={"line-pattern":{source:so,composite:so},"fill-pattern":{source:so,composite:so},"fill-extrusion-pattern":{source:so,composite:so},"line-dasharray":{source:hd,composite:hd}},jl={color:{source:ch,composite:Sc},number:{source:Nl,composite:ch}};function Pp(u,n,s){const h=Hg[u];return h&&h[s]||jl[n][s]}In(Ts,"ConstantBinder"),In(ns,"PatternConstantBinder"),In(Fl,"SourceExpressionBinder"),In(ml,"PatternCompositeBinder"),In(Xs,"CompositeExpressionBinder"),In(gu,"ProgramConfiguration",{omit:["_buffers"]}),In(Es,"ProgramConfigurationSet");const _o=pn/Math.PI/2,Ys=5,qu=6,mf=16383,Oc=64,gf=[Oc,32,16],Co=-_o,Po=_o;function mh(u,n,s,h=_o){return s=hr(s),[u*Math.sin(s)*h,-n*h,u*Math.cos(s)*h]}function Ic(u,n,s){return mh(Math.cos(hr(u)),Math.sin(hr(u)),n,s)}const Ul=63710088e-1,yu=2*Math.PI*Ul;class Gr{constructor(n,s){if(isNaN(n)||isNaN(s))throw new Error(`Invalid LngLat object: (${n}, ${s})`);if(this.lng=+n,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Gr(To(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const s=Math.PI/180,h=this.lat*s,y=n.lat*s,d=Math.sin(h)*Math.sin(y)+Math.cos(h)*Math.cos(y)*Math.cos((n.lng-this.lng)*s);return Ul*Math.acos(Math.min(d,1))}toBounds(n=0){const s=360*n/40075017,h=s/Math.cos(Math.PI/180*this.lat);return new Gu({lng:this.lng-h,lat:this.lat-s},{lng:this.lng+h,lat:this.lat+s})}toEcef(n){return Ic(this.lat,this.lng,_o+n*_o/Ul)}static convert(n){if(n instanceof Gr)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new Gr(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new Gr(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Gu{constructor(n,s){if(n)if(s)this.setSouthWest(n).setNorthEast(s);else if(n.length===4){const h=n;this.setSouthWest([h[0],h[1]]).setNorthEast([h[2],h[3]])}else{const h=n;this.setSouthWest(h[0]).setNorthEast(h[1])}}setNorthEast(n){return this._ne=n instanceof Gr?new Gr(n.lng,n.lat):Gr.convert(n),this}setSouthWest(n){return this._sw=n instanceof Gr?new Gr(n.lng,n.lat):Gr.convert(n),this}extend(n){const s=this._sw,h=this._ne;let y,d;if(n instanceof Gr)y=n,d=n;else{if(!(n instanceof Gu))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(Gu.convert(n)):this.extend(Gr.convert(n)):typeof n=="object"&&n!==null&&n.hasOwnProperty("lat")&&(n.hasOwnProperty("lon")||n.hasOwnProperty("lng"))?this.extend(Gr.convert(n)):this;if(y=n._sw,d=n._ne,!y||!d)return this}return s||h?(s.lng=Math.min(y.lng,s.lng),s.lat=Math.min(y.lat,s.lat),h.lng=Math.max(d.lng,h.lng),h.lat=Math.max(d.lat,h.lat)):(this._sw=new Gr(y.lng,y.lat),this._ne=new Gr(d.lng,d.lat)),this}getCenter(){return new Gr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Gr(this.getWest(),this.getNorth())}getSouthEast(){return new Gr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:s,lat:h}=Gr.convert(n);let y=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(y=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&y}static convert(n){if(n)return n instanceof Gu?n:new Gu(n)}}const gh=0,Zs=25.5;function xd(u){return yu*Math.cos(u*Math.PI/180)}function Vl(u){return(180+u)/360}function gl(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function vo(u,n){return u/xd(n)}function qo(u){return 360*u-180}function Pa(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function _u(u,n){return u*xd(Pa(n))}const hi=85.051129;function bd(u){return Math.cos(hr(Mn(u,-85.051129,hi)))}function yh(u,n){const s=Mn(n,gh,Zs),h=Math.pow(2,s);return bd(u)*yu/(512*h)}function p(u){return 1/Math.cos(u*Math.PI/180)}function r(u,n=0){const s=Math.exp(Math.PI*(1-(u.y+n/pn)/(1<<u.z)*2));return 80150034*s/(s*s+1)/pn/(1<<u.z)}class l{constructor(n,s,h=0){this.x=+n,this.y=+s,this.z=+h}static fromLngLat(n,s=0){const h=Gr.convert(n);return new l(Vl(h.lng),gl(h.lat),vo(s,h.lat))}toLngLat(){return new Gr(qo(this.x),Pa(this.y))}toAltitude(){return _u(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/yu*p(Pa(this.y))}}function m(u,n,s,h,y,d,v,M,k){const j=(n+h)/2,E=(s+y)/2,D=new $t(j,E);M(D),function(B,R,z,q,W,K){const oe=z-W,se=q-K;return Math.abs((q-R)*oe-(z-B)*se)/Math.hypot(oe,se)}(D.x,D.y,d.x,d.y,v.x,v.y)>=k?(m(u,n,s,j,E,d,D,M,k),m(u,j,E,h,y,D,v,M,k)):u.push(v)}function w(u,n,s){let h=u[0],y=h.x,d=h.y;n(h);const v=[h];for(let M=1;M<u.length;M++){const k=u[M],{x:j,y:E}=k;n(k),m(v,y,d,j,E,h,k,n,s),y=j,d=E,h=k}return v}function T(u,n,s,h){if(h(n,s)){const y=n.add(s)._mult(.5);T(u,n,y,h),T(u,y,s,h)}else u.push(s)}function I(u,n){let s=u[0];const h=[s];for(let y=1;y<u.length;y++){const d=u[y];T(h,s,d,n),s=d}return h}const N=Math.pow(2,14)-1,G=-N-1;function X(u,n){const s=Math.round(u.x*n),h=Math.round(u.y*n);return u.x=Mn(s,G,N),u.y=Mn(h,G,N),(s<u.x||s>u.x+1||h<u.y||h>u.y+1)&&lr("Geometry exceeds allowed extent, reduce your vector tile buffer size"),u}function Z(u,n,s){const h=u.loadGeometry(),y=u.extent,d=pn/y;if(n&&s&&s.projection.isReprojectedInTileSpace){const v=1<<n.z,{scale:M,x:k,y:j,projection:E}=s,D=B=>{const R=qo((n.x+B.x/y)/v),z=Pa((n.y+B.y/y)/v),q=E.project(R,z);B.x=(q.x*M-k)*y,B.y=(q.y*M-j)*y};for(let B=0;B<h.length;B++)if(u.type!==1)h[B]=w(h[B],D,1);else{const R=[];for(const z of h[B])z.x<0||z.x>=y||z.y<0||z.y>=y||(D(z),R.push(z));h[B]=R}}for(const v of h)for(const M of v)X(M,d);return h}function J(u,n){return{type:u.type,id:u.id,properties:u.properties,geometry:n?Z(u):[]}}function Q(u,n,s,h,y){u.emplaceBack(2*n+(h+1)/2,2*s+(y+1)/2)}function ae(u,n,s){u.emplaceBack(n.x,n.y,n.z,s[0]*16384,s[1]*16384,s[2]*16384)}class ye{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.projection=n.projection,this.layoutVertexArray=new fu,this.indexArray=new Ja,this.segments=new Yi,this.programConfigurations=new Es(n.layers,{zoom:n.zoom,lut:n.lut}),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}updateFootprints(n,s){}populate(n,s,h,y){const d=this.layers[0],v=[];let M=null;d.type==="circle"&&(M=d.layout.get("circle-sort-key"));for(const{feature:j,id:E,index:D,sourceLayerIndex:B}of n){const R=this.layers[0]._featureFilter.needGeometry,z=J(j,R);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),z,h))continue;const q=M?M.evaluate(z,{},h):void 0,W={id:E,properties:j.properties,type:j.type,sourceLayerIndex:B,index:D,geometry:R?z.geometry:Z(j,h,y),patterns:{},sortKey:q};v.push(W)}M&&v.sort((j,E)=>j.sortKey-E.sortKey);let k=null;y.projection.name==="globe"&&(this.globeExtVertexArray=new lf,k=y.projection);for(const j of v){const{geometry:E,index:D,sourceLayerIndex:B}=j,R=n[D].feature;this.addFeature(j,E,D,s.availableImages,h,k,s.brightness),s.featureIndex.insert(R,E,D,B,this.index)}}update(n,s,h,y,d,v,M){this.programConfigurations.updatePaintArrays(n,s,d,h,y,v,M)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Gg.members),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,gd.members))),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(n,s,h,y,d,v,M){for(const k of s)for(const j of k){const E=j.x,D=j.y;if(E<0||E>=pn||D<0||D>=pn)continue;if(v){const z=v.projectTilePoint(E,D,d),q=v.upVector(d,E,D),W=this.globeExtVertexArray;ae(W,z,q),ae(W,z,q),ae(W,z,q),ae(W,z,q)}const B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),R=B.vertexLength;Q(this.layoutVertexArray,E,D,-1,-1),Q(this.layoutVertexArray,E,D,1,-1),Q(this.layoutVertexArray,E,D,1,1),Q(this.layoutVertexArray,E,D,-1,1),this.indexArray.emplaceBack(R,R+1,R+2),this.indexArray.emplaceBack(R,R+2,R+3),B.vertexLength+=4,B.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,h,{},y,d,M)}}function fe(u,n){for(let s=0;s<u.length;s++)if(Ue(n,u[s]))return!0;for(let s=0;s<n.length;s++)if(Ue(u,n[s]))return!0;return!!ze(u,n)}function be(u,n,s){return!!Ue(u,n)||!!$e(n,u,s)}function _e(u,n){if(u.length===1)return Ve(n,u[0]);for(let s=0;s<n.length;s++){const h=n[s];for(let y=0;y<h.length;y++)if(Ue(u,h[y]))return!0}for(let s=0;s<u.length;s++)if(Ve(n,u[s]))return!0;for(let s=0;s<n.length;s++)if(ze(u,n[s]))return!0;return!1}function Ce(u,n,s){if(u.length>1){if(ze(u,n))return!0;for(let h=0;h<n.length;h++)if($e(n[h],u,s))return!0}for(let h=0;h<u.length;h++)if($e(u[h],n,s))return!0;return!1}function ze(u,n){if(u.length===0||n.length===0)return!1;for(let s=0;s<u.length-1;s++){const h=u[s],y=u[s+1];for(let d=0;d<n.length-1;d++)if(De(h,y,n[d],n[d+1]))return!0}return!1}function De(u,n,s,h){return _a(u,s,h)!==_a(n,s,h)&&_a(u,n,s)!==_a(u,n,h)}function $e(u,n,s){const h=s*s;if(n.length===1)return u.distSqr(n[0])<h;for(let y=1;y<n.length;y++)if(je(u,n[y-1],n[y])<h)return!0;return!1}function je(u,n,s){const h=n.distSqr(s);if(h===0)return u.distSqr(n);const y=((u.x-n.x)*(s.x-n.x)+(u.y-n.y)*(s.y-n.y))/h;return u.distSqr(y<0?n:y>1?s:s.sub(n)._mult(y)._add(n))}function Ve(u,n){let s,h,y,d=!1;for(let v=0;v<u.length;v++){s=u[v];for(let M=0,k=s.length-1;M<s.length;k=M++)h=s[M],y=s[k],h.y>n.y!=y.y>n.y&&n.x<(y.x-h.x)*(n.y-h.y)/(y.y-h.y)+h.x&&(d=!d)}return d}function Ue(u,n){let s=!1;for(let h=0,y=u.length-1;h<u.length;y=h++){const d=u[h],v=u[y];d.y>n.y!=v.y>n.y&&n.x<(v.x-d.x)*(n.y-d.y)/(v.y-d.y)+d.x&&(s=!s)}return s}function Qe(u,n,s,h,y){for(const v of u)if(n<=v.x&&s<=v.y&&h>=v.x&&y>=v.y)return!0;const d=[new $t(n,s),new $t(n,y),new $t(h,y),new $t(h,s)];if(u.length>2){for(const v of d)if(Ue(u,v))return!0}for(let v=0;v<u.length-1;v++)if(at(u[v],u[v+1],d))return!0;return!1}function at(u,n,s){const h=s[0],y=s[2];if(u.x<h.x&&n.x<h.x||u.x>y.x&&n.x>y.x||u.y<h.y&&n.y<h.y||u.y>y.y&&n.y>y.y)return!1;const d=_a(u,n,s[0]);return d!==_a(u,n,s[1])||d!==_a(u,n,s[2])||d!==_a(u,n,s[3])}function St(u,n,s,h,y,d){let v=n.y-u.y,M=u.x-n.x;if(d=d||0){const k=v*v+M*M;if(k===0)return!0;const j=Math.sqrt(k);v/=j,M/=j}return!((s.x-u.x)*v+(s.y-u.y)*M-d<0||(h.x-u.x)*v+(h.y-u.y)*M-d<0||(y.x-u.x)*v+(y.y-u.y)*M-d<0)}function yt(u,n,s,h,y,d,v){return!(St(u,n,h,y,d,v)||St(n,s,h,y,d,v)||St(s,u,h,y,d,v)||St(h,y,u,n,s,v)||St(y,d,u,n,s,v)||St(d,h,u,n,s,v))}function jt(u,n,s){const h=n.paint.get(u).value;return h.kind==="constant"?h.value:s.programConfigurations.get(n.id).getMaxValue(u)}function It(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function ft(u,n,s,h,y){if(!n[0]&&!n[1])return u;const d=$t.convert(n)._mult(y);s==="viewport"&&d._rotate(-h);const v=[];for(let M=0;M<u.length;M++)v.push(u[M].sub(d));return v}function At(u,n,s,h){const y=$t.convert(u)._mult(h);return n==="viewport"&&y._rotate(-s),y}let Qt,ht;In(ye,"CircleBucket",{omit:["layers"]});var zt,Mt={exports:{}},ln=(zt||(zt=1,function(u,n){(function(s){function h(d,v,M){var k=y(256*d,256*(v=Math.pow(2,M)-v-1),M),j=y(256*(d+1),256*(v+1),M);return k[0]+","+k[1]+","+j[0]+","+j[1]}function y(d,v,M){var k=2*Math.PI*6378137/256/Math.pow(2,M);return[d*k-2*Math.PI*6378137/2,v*k-2*Math.PI*6378137/2]}s.getURL=function(d,v,M,k,j,E){return E=E||{},d+"?"+["bbox="+h(M,k,j),"format="+(E.format||"image/png"),"service="+(E.service||"WMS"),"version="+(E.version||"1.1.1"),"request="+(E.request||"GetMap"),"srs="+(E.srs||"EPSG:3857"),"width="+(E.width||256),"height="+(E.height||256),"layers="+v].join("&")},s.getTileBBox=h,s.getMercCoords=y,Object.defineProperty(s,"__esModule",{value:!0})})(n)}(0,Mt.exports)),Mt.exports);class Yt{constructor(n,s,h){this.z=n,this.x=s,this.y=h,this.key=fn(0,n,n,s,h)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,s){const h=ln.getTileBBox(this.x,this.y,this.z),y=function(d,v,M){let k,j="";for(let E=d;E>0;E--)k=1<<E-1,j+=(v&k?1:0)+(M&k?2:0);return j}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",y).replace("{bbox-epsg-3857}",h)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Ut{constructor(n,s){this.wrap=n,this.canonical=s,this.key=fn(n,s.z,s.z,s.x,s.y)}}class tn{constructor(n,s,h,y,d){this.overscaledZ=n,this.wrap=s,this.canonical=new Yt(h,+y,+d),this.key=s===0&&n===h?this.canonical.key:fn(s,n,h,y,d)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){const s=this.canonical.z-n;return n>this.canonical.z?new tn(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new tn(n,this.wrap,n,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(n,s=!0){if(this.overscaledZ===n&&s)return this.key;if(n>this.canonical.z)return fn(this.wrap*+s,n,this.canonical.z,this.canonical.x,this.canonical.y);{const h=this.canonical.z-n;return fn(this.wrap*+s,n,n,this.canonical.x>>h,this.canonical.y>>h)}}isChildOf(n){if(n.wrap!==this.wrap)return!1;const s=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.z<this.canonical.z&&n.canonical.x===this.canonical.x>>s&&n.canonical.y===this.canonical.y>>s}children(n){if(this.overscaledZ>=n)return[new tn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,h=2*this.canonical.x,y=2*this.canonical.y;return[new tn(s,this.wrap,s,h,y),new tn(s,this.wrap,s,h+1,y),new tn(s,this.wrap,s,h,y+1),new tn(s,this.wrap,s,h+1,y+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new tn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new tn(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ut(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function fn(u,n,s,h,y){const d=1<<Math.min(s,22);let v=d*(y%d)+h%d;return u&&s<22&&(v+=d*d*((u<0?-2*u-1:2*u)%(1<<2*(22-s)))),16*(32*v+s)+(n-s)}const wn=[u=>{let n=u.canonical.x-1,s=u.wrap;return n<0&&(n=(1<<u.canonical.z)-1,s--),new tn(u.overscaledZ,s,u.canonical.z,n,u.canonical.y)},u=>{let n=u.canonical.x+1,s=u.wrap;return n===1<<u.canonical.z&&(n=0,s++),new tn(u.overscaledZ,s,u.canonical.z,n,u.canonical.y)},u=>new tn(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,(u.canonical.y===0?1<<u.canonical.z:u.canonical.y)-1),u=>new tn(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,u.canonical.y===(1<<u.canonical.z)-1?0:u.canonical.y+1)];In(Yt,"CanonicalTileID"),In(tn,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Cn=Yr([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Yn}=Cn,Gn=Yr([{name:"a_pos_3",components:3,type:"Int16"}]);var Un=Yr([{name:"a_pos",type:"Int16",components:2}]);class tr{constructor(n,s){this.pos=n,this.dir=s}intersectsPlane(n,s,h){const y=Ne.vec3.dot(s,this.dir);if(Math.abs(y)<1e-6)return!1;const d=((n[0]-this.pos[0])*s[0]+(n[1]-this.pos[1])*s[1]+(n[2]-this.pos[2])*s[2])/y;return h[0]=this.pos[0]+this.dir[0]*d,h[1]=this.pos[1]+this.dir[1]*d,h[2]=this.pos[2]+this.dir[2]*d,!0}closestPointOnSphere(n,s,h){if(Ne.vec3.equals(this.pos,n)||s===0)return h[0]=h[1]=h[2]=0,!1;const[y,d,v]=this.dir,M=this.pos[0]-n[0],k=this.pos[1]-n[1],j=this.pos[2]-n[2],E=y*y+d*d+v*v,D=2*(M*y+k*d+j*v),B=D*D-4*E*(M*M+k*k+j*j-s*s);if(B<0){const R=Math.max(-D/2,0),z=M+y*R,q=k+d*R,W=j+v*R,K=Math.hypot(z,q,W);return h[0]=z*s/K,h[1]=q*s/K,h[2]=W*s/K,!1}{const R=(-D-Math.sqrt(B))/(2*E);if(R<0){const z=Math.hypot(M,k,j);return h[0]=M*s/z,h[1]=k*s/z,h[2]=j*s/z,!1}return h[0]=M+y*R,h[1]=k+d*R,h[2]=j+v*R,!0}}}class nr{constructor(n,s,h,y,d){this.TL=n,this.TR=s,this.BR=h,this.BL=y,this.horizon=d}static fromInvProjectionMatrix(n,s,h){const y=[-1,1,1],d=[1,1,1],v=[1,-1,1],M=[-1,-1,1],k=Ne.vec3.transformMat4(y,y,n),j=Ne.vec3.transformMat4(d,d,n),E=Ne.vec3.transformMat4(v,v,n),D=Ne.vec3.transformMat4(M,M,n);return new nr(k,j,E,D,s/h)}}function ri(u,n,s){let h=1/0,y=-1/0;const d=[];for(const v of u){Ne.vec3.sub(d,v,n);const M=Ne.vec3.dot(d,s);h=Math.min(h,M),y=Math.max(y,M)}return[h,y]}function Zi(u,n){let s=!0;for(let h=0;h<u.planes.length;h++){const y=u.planes[h];let d=0;for(let v=0;v<n.length;v++)d+=Ne.vec3.dot(y,n[v])+y[3]>=0;if(d===0)return 0;d!==n.length&&(s=!1)}return s?2:1}function wi(u,n){for(const s of u.projections){const h=ri(n,u.points[0],s.axis);if(s.projection[1]<h[0]||s.projection[0]>h[1])return 0}return 1}function ur(u,n){let s=0;const h=[0,0,0,0];for(let y=0;y<u.length;y++)h[0]=u[y][0],h[1]=u[y][1],h[2]=u[y][2],h[3]=1,Ne.vec4.dot(h,n)>=0&&s++;return s}class $r{constructor(n,s){this.points=n||new Array(8).fill([0,0,0]),this.planes=s||new Array(6).fill([0,0,0,0]),this.bounds=Sn.fromPoints(this.points),this.projections=[],this.frustumEdges=[Ne.vec3.sub([],this.points[2],this.points[3]),Ne.vec3.sub([],this.points[0],this.points[3]),Ne.vec3.sub([],this.points[4],this.points[0]),Ne.vec3.sub([],this.points[5],this.points[1]),Ne.vec3.sub([],this.points[6],this.points[2]),Ne.vec3.sub([],this.points[7],this.points[3])];for(const h of this.frustumEdges){const y=[0,-h[2],h[1]],d=[h[2],0,-h[0]];this.projections.push({axis:y,projection:ri(this.points,this.points[0],y)}),this.projections.push({axis:d,projection:ri(this.points,this.points[0],d)})}}static fromInvProjectionMatrix(n,s,h,y){const d=Math.pow(2,h),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(j=>{const E=Ne.vec4.transformMat4([],j,n),D=1/E[3]/s*d;return Ne.vec4.mul(E,E,[D,D,y?1/E[3]:D,D])}),M=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(j=>{const E=Ne.vec3.sub([],v[j[0]],v[j[1]]),D=Ne.vec3.sub([],v[j[2]],v[j[1]]),B=Ne.vec3.normalize([],Ne.vec3.cross([],E,D)),R=-Ne.vec3.dot(B,v[j[1]]);return B.concat(R)}),k=[];for(let j=0;j<v.length;j++)k.push([v[j][0],v[j][1],v[j][2]]);return new $r(k,M)}intersectsPrecise(n,s,h){for(let y=0;y<s.length;y++)if(!ur(n,s[y]))return 0;for(let y=0;y<this.planes.length;y++)if(!ur(n,this.planes[y]))return 0;for(const y of h)for(const d of this.frustumEdges){const v=Ne.vec3.cross([],y,d),M=Ne.vec3.length(v);if(M===0)continue;Ne.vec3.scale(v,v,1/M);const k=ri(this.points,this.points[0],v),j=ri(n,this.points[0],v);if(k[0]>j[1]||j[0]>k[1])return 0}return 1}containsPoint(n){for(const s of this.planes){const h=s[3];if(Ne.vec3.dot([s[0],s[1],s[2]],n)+h<0)return!1}return!0}}class Sn{static fromPoints(n){const s=[1/0,1/0,1/0],h=[-1/0,-1/0,-1/0];for(const y of n)Ne.vec3.min(s,s,y),Ne.vec3.max(h,h,y);return new Sn(s,h)}static fromTileIdAndHeight(n,s,h){const y=1<<n.canonical.z,d=n.canonical.x,v=n.canonical.y;return new Sn([d/y,v/y,s],[(d+1)/y,(v+1)/y,h])}static applyTransform(n,s){const h=n.getCorners();for(let y=0;y<h.length;++y)Ne.vec3.transformMat4(h[y],h[y],s);return Sn.fromPoints(h)}static applyTransformFast(n,s){const h=[s[12],s[13],s[14]],y=[...h];for(let d=0;d<3;d++)for(let v=0;v<3;v++){const M=s[4*v+d],k=M*n.min[v],j=M*n.max[v];h[d]+=Math.min(k,j),y[d]+=Math.max(k,j)}return new Sn(h,y)}static projectAabbCorners(n,s){const h=n.getCorners();for(let y=0;y<h.length;++y)Ne.vec3.transformMat4(h[y],h[y],s);return h}constructor(n,s){this.min=n,this.max=s,this.center=Ne.vec3.scale([],Ne.vec3.add([],this.min,this.max),.5)}quadrant(n){const s=[n%2==0,n<2],h=Ne.vec3.clone(this.min),y=Ne.vec3.clone(this.max);for(let d=0;d<s.length;d++)h[d]=s[d]?this.min[d]:this.center[d],y[d]=s[d]?this.center[d]:this.max[d];return y[2]=this.max[2],new Sn(h,y)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}distanceZ(n){return Math.max(Math.min(this.max[2],n[2]),this.min[2])-n[2]}getCorners(){const n=this.min,s=this.max;return[[n[0],n[1],n[2]],[s[0],n[1],n[2]],[s[0],s[1],n[2]],[n[0],s[1],n[2]],[n[0],n[1],s[2]],[s[0],n[1],s[2]],[s[0],s[1],s[2]],[n[0],s[1],s[2]]]}intersects(n){return this.intersectsAabb(n.bounds)?Zi(n,this.getCorners()):0}intersectsFlat(n){return this.intersectsAabb(n.bounds)?Zi(n,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(n,s){return s||this.intersects(n)?wi(n,this.getCorners()):0}intersectsPreciseFlat(n,s){return s||this.intersectsFlat(n)?wi(n,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(n){for(let s=0;s<3;++s)if(this.min[s]>n.max[s]||n.min[s]>this.max[s])return!1;return!0}intersectsAabbXY(n){return!(this.min[0]>n.max[0]||n.min[0]>this.max[0]||this.min[1]>n.max[1]||n.min[1]>this.max[1])}encapsulate(n){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],n.min[s]),this.max[s]=Math.max(this.max[s],n.max[s])}encapsulatePoint(n){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],n[s]),this.max[s]=Math.max(this.max[s],n[s])}closestPoint(n){return[Math.max(Math.min(this.max[0],n[0]),this.min[0]),Math.max(Math.min(this.max[1],n[1]),this.min[1]),Math.max(Math.min(this.max[2],n[2]),this.min[2])]}}function Kn(u){return u*_o/Ul}In(Sn,"Aabb");const Zn=[new Sn([Co,Co,Co],[Po,Po,Po]),new Sn([Co,Co,Co],[0,0,Po]),new Sn([0,Co,Co],[Po,0,Po]),new Sn([Co,0,Co],[0,Po,Po]),new Sn([0,0,Co],[Po,Po,Po])];function Jn(u,n,s,h=!0){const y=Ne.vec3.scale([],u._camera.position,u.worldSize),d=[n,s,1,1];Ne.vec4.transformMat4(d,d,u.pixelMatrixInverse),Ne.vec4.scale(d,d,1/d[3]);const v=Ne.vec3.sub([],d,y),M=Ne.vec3.normalize([],v),k=u.globeMatrix,j=[k[12],k[13],k[14]],E=Ne.vec3.sub([],j,y),D=Ne.vec3.length(E),B=Ne.vec3.normalize([],E),R=u.worldSize/(2*Math.PI),z=Ne.vec3.dot(B,M),q=Math.asin(R/D);if(q<Math.acos(z)){if(!h)return null;const We=[],Le=[];Ne.vec3.scale(We,M,D/z),Ne.vec3.normalize(Le,Ne.vec3.sub(Le,We,E)),Ne.vec3.normalize(M,Ne.vec3.add(M,E,Ne.vec3.scale(M,Le,Math.tan(q)*D)))}const W=[];new tr(y,M).closestPointOnSphere(j,R,W);const K=Ne.vec3.normalize([],zs(k,0)),oe=Ne.vec3.normalize([],zs(k,1)),se=Ne.vec3.normalize([],zs(k,2)),ne=Ne.vec3.dot(K,W),ce=Ne.vec3.dot(oe,W),pe=Ne.vec3.dot(se,W),we=vn(Math.asin(-ce/R));let ke=vn(Math.atan2(ne,pe));ke=u.center.lng+function(We,Le){const Je=(Le-We+180)%360-180;return Je<-180?Je+360:Je}(u.center.lng,ke);const Re=Vl(ke),Pe=Mn(gl(we),0,1);return new l(Re,Pe)}class Ir{constructor(n,s,h){this.a=Ne.vec3.sub([],n,h),this.b=Ne.vec3.sub([],s,h),this.center=h;const y=Ne.vec3.normalize([],this.a),d=Ne.vec3.normalize([],this.b);this.angle=Math.acos(Ne.vec3.dot(y,d))}}function Ti(u,n){if(u.angle===0)return null;let s;return s=u.a[n]===0?1/u.angle*.5*Math.PI:1/u.angle*Math.atan(u.b[n]/u.a[n]/Math.sin(u.angle)-1/Math.tan(u.angle)),s<0||s>1?null:function(h,y,d,v){const M=Math.sin(d);return h*(Math.sin((1-v)*d)/M)+y*(Math.sin(v*d)/M)}(u.a[n],u.b[n],u.angle,Mn(s,0,1))+u.center[n]}function ki(u){if(u.z<=1)return Zn[u.z+2*u.y+u.x];const n=ti(zr(u));return Sn.fromPoints(n)}function Wi(u,n,s){return Ne.vec3.scale(u,u,1-s),Ne.vec3.scaleAndAdd(u,u,n,s)}function rs(u,n,s){for(const h of u)Ne.vec3.transformMat4(h,h,n),Ne.vec3.scale(h,h,s)}function ua(u,n,s,h){const y=n/u.worldSize,d=u.globeMatrix;if(s.z<=1){const Re=ki(s).getCorners();return rs(Re,d,y),Sn.fromPoints(Re)}const v=zr(s,h),M=ti(v,_o+Kn(u._tileCoverLift));rs(M,d,y);const k=Number.MAX_VALUE,j=[-k,-k,-k],E=[k,k,k];if(v.contains(u.center)){for(const We of M)Ne.vec3.min(E,E,We),Ne.vec3.max(j,j,We);j[2]=0;const Re=u.point,Pe=[Re.x*y,Re.y*y,0];return Ne.vec3.min(E,E,Pe),Ne.vec3.max(j,j,Pe),new Sn(E,j)}if(u._tileCoverLift>0){for(const Re of M)Ne.vec3.min(E,E,Re),Ne.vec3.max(j,j,Re);return new Sn(E,j)}const D=[d[12]*y,d[13]*y,d[14]*y],B=v.getCenter(),R=Mn(u.center.lat,-85.051129,hi),z=Mn(B.lat,-85.051129,hi),q=Vl(u.center.lng),W=gl(R);let K=q-Vl(B.lng);const oe=W-gl(z);K>.5?K-=1:K<-.5&&(K+=1);let se=0;if(Math.abs(K)>Math.abs(oe))se=K>=0?1:3;else{se=oe>=0?0:2;const Re=[d[4]*y,d[5]*y,d[6]*y],Pe=-Math.sin(hr(oe>=0?v.getSouth():v.getNorth()))*_o;Ne.vec3.scaleAndAdd(D,D,Re,Pe)}const ne=M[se],ce=M[(se+1)%4],pe=new Ir(ne,ce,D),we=[Ti(pe,0)||ne[0],Ti(pe,1)||ne[1],Ti(pe,2)||ne[2]],ke=xo(u.zoom);if(ke>0){const Re=function({x:We,y:Le,z:Je},it,tt,ot,ut){const pt=1/(1<<Je);let lt=We*pt,Lt=lt+pt,Wt=Le*pt,Rt=Wt+pt,xn=0;const mn=(lt+Lt)/2-ot;return mn>.5?xn=-1:mn<-.5&&(xn=1),lt=((lt+xn)*it-(ot*=it))*tt+ot,Lt=((Lt+xn)*it-ot)*tt+ot,Wt=(Wt*it-(ut*=it))*tt+ut,Rt=(Rt*it-ut)*tt+ut,[[lt,Rt,0],[Lt,Rt,0],[Lt,Wt,0],[lt,Wt,0]]}(s,n,u._pixelsPerMercatorPixel,q,W);for(let We=0;We<M.length;We++)Wi(M[We],Re[We],ke);const Pe=Ne.vec3.add([],Re[se],Re[(se+1)%4]);Ne.vec3.scale(Pe,Pe,.5),Wi(we,Pe,ke)}for(const Re of M)Ne.vec3.min(E,E,Re),Ne.vec3.max(j,j,Re);return E[2]=Math.min(ne[2],ce[2]),Ne.vec3.min(E,E,we),Ne.vec3.max(j,j,we),new Sn(E,j)}function zr({x:u,y:n,z:s},h=!1){const y=1/(1<<s),d=new Gr(qo(u*y),n===(1<<s)-1&&h?-90:Pa((n+1)*y)),v=new Gr(qo((u+1)*y),n===0&&h?90:Pa(n*y));return new Gu(d,v)}function ti(u,n=_o){const s=hr(u.getNorth()),h=hr(u.getSouth()),y=Math.cos(s),d=Math.cos(h),v=Math.sin(s),M=Math.sin(h),k=u.getWest(),j=u.getEast();return[mh(d,M,k,n),mh(d,M,j,n),mh(y,v,j,n),mh(y,v,k,n)]}function ei(u,n,s,h){const y=1<<s.z,d=(u/pn+s.x)/y;return Ic(Pa((n/pn+s.y)/y),qo(d),h)}function Dr({min:u,max:n}){return mf/Math.max(n[0]-u[0],n[1]-u[1],n[2]-u[2])}const fi=new Float64Array(16);function aa(u){const n=Dr(u),s=Ne.mat4.fromScaling(fi,[n,n,n]);return Ne.mat4.translate(s,s,Ne.vec3.negate([],u.min))}function ii(u){const n=Ne.mat4.fromTranslation(fi,u.min),s=1/Dr(u);return Ne.mat4.scale(n,n,[s,s,s])}function oa(u){const n=pn/(2*Math.PI);return u/(2*Math.PI)/n}function As(u,n){return pn/(512*Math.pow(2,u))*Dr(ki(n))}function Go(u,n,s,h,y){const d=oa(s),v=[u,n,-s/(2*Math.PI)],M=Ne.mat4.identity(new Float64Array(16));return Ne.mat4.translate(M,M,v),Ne.mat4.scale(M,M,[d,d,d]),Ne.mat4.rotateX(M,M,hr(-y)),Ne.mat4.rotateY(M,M,hr(-h)),M}function xo(u){return no(Ys,qu,u)}function Ws(u,n){const s=Ic(n.lat,n.lng),h=function(d){const v=Ic(d._center.lat,d._center.lng),M=Ne.vec3.fromValues(0,1,0);let k=Ne.vec3.cross([],M,v);const j=Ne.mat4.fromRotation([],-d.angle,v);k=Ne.vec3.transformMat4(k,k,j),Ne.mat4.fromRotation(j,-d._pitch,k);const E=Ne.vec3.normalize([],v);return Ne.vec3.scale(E,E,Kn(d.cameraToCenterDistance/d.pixelsPerMeter)),Ne.vec3.transformMat4(E,E,j),Ne.vec3.add([],v,E)}(u),y=Ne.vec3.subtract([],h,s);return Ne.vec3.angle(y,s)}function uo(u,n){return Ws(u,n)>Math.PI/2*1.01}const $o=hr(85),Ks=Math.cos($o),Ms=Math.sin($o),$u=Ne.mat4.create(),Cc=u=>{const n=[];return u.paint.get("circle-pitch-alignment")==="map"&&n.push("PITCH_WITH_MAP"),u.paint.get("circle-pitch-scale")==="map"&&n.push("SCALE_WITH_MAP"),n};function Pc(u,n,s,h,y,d,v,M,k){if(d&&u.queryGeometry.isAboveHorizon)return!1;d&&(k*=u.pixelToTileUnitsFactor);const j=u.tileID.canonical,E=s.projection.upVectorScale(j,s.center.lat,s.worldSize).metersToTile;for(const D of n)for(const B of D){const R=B.add(M),z=y&&s.elevation?s.elevation.exaggeration()*y.getElevationAt(R.x,R.y,!0):0,q=s.projection.projectTilePoint(R.x,R.y,j);if(z>0){const se=s.projection.upVector(j,R.x,R.y);q.x+=se[0]*E*z,q.y+=se[1]*E*z,q.z+=se[2]*E*z}const W=d?R:wd(q.x,q.y,q.z,h),K=d?u.tilespaceRays.map(se=>Js(se,z)):u.queryGeometry.screenGeometry,oe=Ne.vec4.transformMat4([],[q.x,q.y,q.z,1],h);if(!v&&d?k*=oe[3]/s.cameraToCenterDistance:v&&!d&&(k*=s.cameraToCenterDistance/oe[3]),d){const se=Pa((B.y/pn+j.y)/(1<<j.z));k/=s.projection.pixelsPerMeter(se,1)/vo(1,se)}if(be(K,W,k))return!0}return!1}function wd(u,n,s,h){const y=Ne.vec4.transformMat4([],[u,n,s,1],h);return new $t(y[0]/y[3],y[1]/y[3])}const yl=Ne.vec3.fromValues(0,0,0),Nx=Ne.vec3.fromValues(0,0,1);function Js(u,n){const s=Ne.vec3.create();return yl[2]=n,u.intersectsPlane(yl,Nx,s),new $t(s[0],s[1])}class H_ extends ye{}let Xg,X_,Bx,Rc;function Rm(u,{width:n,height:s},h,y){if(y){if(y instanceof Uint8ClampedArray)y=new Uint8Array(y.buffer);else if(y.length!==n*s*h)throw new RangeError("mismatched image size")}else y=new Uint8Array(n*s*h);return u.width=n,u.height=s,u.data=y,u}function Yg(u,n,s){const{width:h,height:y}=n;h===u.width&&y===u.height||(yf(u,n,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,h),height:Math.min(u.height,y)},s,null),u.width=h,u.height=y,u.data=n.data)}function yf(u,n,s,h,y,d,v,M){if(y.width===0||y.height===0)return n;if(y.width>u.width||y.height>u.height||s.x>u.width-y.width||s.y>u.height-y.height)throw new RangeError("out of range source coordinates for image copy");if(y.width>n.width||y.height>n.height||h.x>n.width-y.width||h.y>n.height-y.height)throw new RangeError("out of range destination coordinates for image copy");const k=u.data,j=n.data,E=d===4&&M;for(let D=0;D<y.height;D++){const B=((s.y+D)*u.width+s.x)*d,R=((h.y+D)*n.width+h.x)*d;if(E)for(let z=0;z<y.width;z++){const q=B+z*d+3,W=R+z*d;j[W+0]=255,j[W+1]=255,j[W+2]=255,j[W+3]=k[q]}else if(v)for(let z=0;z<y.width;z++){const q=B+z*d,W=R+z*d,K=k[q+3],oe=new Vr(k[q+0]/255*K,k[q+1]/255*K,k[q+2]/255*K,K).toRenderColor(v).toArray();j[W+0]=oe[0],j[W+1]=oe[1],j[W+2]=oe[2],j[W+3]=oe[3]}else for(let z=0;z<y.width*d;z++)j[R+z]=k[B+z]}return n}In(H_,"HeatmapBucket",{omit:["layers"]});class _h{constructor(n,s){Rm(this,n,1,s)}resize(n){Yg(this,new _h(n),1)}clone(){return new _h({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,h,y,d){yf(n,s,h,y,d,1,null)}}class co{constructor(n,s){Rm(this,n,4,s)}resize(n){Yg(this,new co(n),4)}replace(n,s){s?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new co({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,h,y,d,v,M){yf(n,s,h,y,d,4,v,M)}}class Y_{constructor(n,s){this.width=n.width,this.height=n.height,this.data=s instanceof Uint8Array?new Float32Array(s.buffer):s}}function Sd(u){const n={},s=u.resolution||256,h=u.clips?u.clips.length:1,y=u.image||new co({width:s,height:h}),d=(v,M,k)=>{n[u.evaluationKey]=k;const j=u.expression.evaluate(n);j&&(y.data[v+M+0]=Math.floor(255*j.r/j.a),y.data[v+M+1]=Math.floor(255*j.g/j.a),y.data[v+M+2]=Math.floor(255*j.b/j.a),y.data[v+M+3]=Math.floor(255*j.a))};if(u.clips)for(let v=0,M=0;v<h;++v,M+=4*s)for(let k=0,j=0;k<s;k++,j+=4){const E=k/(s-1),{start:D,end:B}=u.clips[v];d(M,j,D*(1-E)+B*E)}else for(let v=0,M=0;v<s;v++,M+=4)d(0,M,v/(s-1));return y}In(_h,"AlphaImage"),In(co,"RGBAImage");const Z_=Yr([{name:"a_pos",components:2,type:"Int16"}],4),{members:O2}=Z_;function km(u,n,s=2){const h=n&&n.length,y=h?n[0]*s:u.length;let d=Fx(u,0,y,s,!0);const v=[];if(!d||d.next===d.prev)return v;let M,k,j;if(h&&(d=function(E,D,B,R){const z=[];for(let q=0,W=D.length;q<W;q++){const K=Fx(E,D[q]*R,q<W-1?D[q+1]*R:E.length,R,!1);K===K.next&&(K.steiner=!0),z.push(ca(K))}z.sort(I2);for(let q=0;q<z.length;q++)B=Vx(z[q],B);return B}(u,n,d,s)),u.length>80*s){M=1/0,k=1/0;let E=-1/0,D=-1/0;for(let B=s;B<y;B+=s){const R=u[B],z=u[B+1];R<M&&(M=R),z<k&&(k=z),R>E&&(E=R),z>D&&(D=z)}j=Math.max(E-M,D-k),j=j!==0?32767/j:0}return Rp(d,v,s,M,k,j,0),v}function Fx(u,n,s,h,y){let d;if(y===function(v,M,k,j){let E=0;for(let D=M,B=k-j;D<k;D+=j)E+=(v[B]-v[D])*(v[D+1]+v[B+1]),B=D;return E}(u,n,s,h)>0)for(let v=n;v<s;v+=h)d=Dm(v/h|0,u[v],u[v+1],d);else for(let v=s-h;v>=n;v-=h)d=Dm(v/h|0,u[v],u[v+1],d);return d&&Kg(d,d.next)&&(Ed(d),d=d.next),d}function _f(u,n){if(!u)return u;n||(n=u);let s,h=u;do if(s=!1,h.steiner||!Kg(h,h.next)&&Ra(h.prev,h,h.next)!==0)h=h.next;else{if(Ed(h),h=n=h.prev,h===h.next)break;s=!0}while(s||h!==n);return n}function Rp(u,n,s,h,y,d,v){if(!u)return;!v&&d&&function(k,j,E,D){let B=k;do B.z===0&&(B.z=Wg(B.x,B.y,j,E,D)),B.prevZ=B.prev,B.nextZ=B.next,B=B.next;while(B!==k);B.prevZ.nextZ=null,B.prevZ=null,function(R){let z,q=1;do{let W,K=R;R=null;let oe=null;for(z=0;K;){z++;let se=K,ne=0;for(let pe=0;pe<q&&(ne++,se=se.nextZ,se);pe++);let ce=q;for(;ne>0||ce>0&&se;)ne!==0&&(ce===0||!se||K.z<=se.z)?(W=K,K=K.nextZ,ne--):(W=se,se=se.nextZ,ce--),oe?oe.nextZ=W:R=W,W.prevZ=oe,oe=W;K=se}oe.nextZ=null,q*=2}while(z>1)}(B)}(u,h,y,d);let M=u;for(;u.prev!==u.next;){const k=u.prev,j=u.next;if(d?Zg(u,h,y,d):kp(u))n.push(k.i,u.i,j.i),Ed(u),u=j.next,M=j.next;else if((u=j)===M){v?v===1?Rp(u=jx(_f(u),n),n,s,h,y,d,2):v===2&&Ux(u,n,s,h,y,d):Rp(_f(u),n,s,h,y,d,1);break}}}function kp(u){const n=u.prev,s=u,h=u.next;if(Ra(n,s,h)>=0)return!1;const y=n.x,d=s.x,v=h.x,M=n.y,k=s.y,j=h.y,E=y<d?y<v?y:v:d<v?d:v,D=M<k?M<j?M:j:k<j?k:j,B=y>d?y>v?y:v:d>v?d:v,R=M>k?M>j?M:j:k>j?k:j;let z=h.next;for(;z!==n;){if(z.x>=E&&z.x<=B&&z.y>=D&&z.y<=R&&vf(y,M,d,k,v,j,z.x,z.y)&&Ra(z.prev,z,z.next)>=0)return!1;z=z.next}return!0}function Zg(u,n,s,h){const y=u.prev,d=u,v=u.next;if(Ra(y,d,v)>=0)return!1;const M=y.x,k=d.x,j=v.x,E=y.y,D=d.y,B=v.y,R=M<k?M<j?M:j:k<j?k:j,z=E<D?E<B?E:B:D<B?D:B,q=M>k?M>j?M:j:k>j?k:j,W=E>D?E>B?E:B:D>B?D:B,K=Wg(R,z,n,s,h),oe=Wg(q,W,n,s,h);let se=u.prevZ,ne=u.nextZ;for(;se&&se.z>=K&&ne&&ne.z<=oe;){if(se.x>=R&&se.x<=q&&se.y>=z&&se.y<=W&&se!==y&&se!==v&&vf(M,E,k,D,j,B,se.x,se.y)&&Ra(se.prev,se,se.next)>=0||(se=se.prevZ,ne.x>=R&&ne.x<=q&&ne.y>=z&&ne.y<=W&&ne!==y&&ne!==v&&vf(M,E,k,D,j,B,ne.x,ne.y)&&Ra(ne.prev,ne,ne.next)>=0))return!1;ne=ne.nextZ}for(;se&&se.z>=K;){if(se.x>=R&&se.x<=q&&se.y>=z&&se.y<=W&&se!==y&&se!==v&&vf(M,E,k,D,j,B,se.x,se.y)&&Ra(se.prev,se,se.next)>=0)return!1;se=se.prevZ}for(;ne&&ne.z<=oe;){if(ne.x>=R&&ne.x<=q&&ne.y>=z&&ne.y<=W&&ne!==y&&ne!==v&&vf(M,E,k,D,j,B,ne.x,ne.y)&&Ra(ne.prev,ne,ne.next)>=0)return!1;ne=ne.nextZ}return!0}function jx(u,n){let s=u;do{const h=s.prev,y=s.next.next;!Kg(h,y)&&qx(h,s,s.next,y)&&kc(h,y)&&kc(y,h)&&(n.push(h.i,s.i,y.i),Ed(s),Ed(s.next),s=u=y),s=s.next}while(s!==u);return _f(s)}function Ux(u,n,s,h,y,d){let v=u;do{let M=v.next.next;for(;M!==v.prev;){if(v.i!==M.i&&C2(v,M)){let k=Qg(v,M);return v=_f(v,v.next),k=_f(k,k.next),Rp(v,n,s,h,y,d,0),void Rp(k,n,s,h,y,d,0)}M=M.next}v=v.next}while(v!==u)}function I2(u,n){return u.x-n.x}function Vx(u,n){const s=function(y,d){let v=d;const M=y.x,k=y.y;let j,E=-1/0;do{if(k<=v.y&&k>=v.next.y&&v.next.y!==v.y){const q=v.x+(k-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(q<=M&&q>E&&(E=q,j=v.x<v.next.x?v:v.next,q===M))return j}v=v.next}while(v!==d);if(!j)return null;const D=j,B=j.x,R=j.y;let z=1/0;v=j;do{if(M>=v.x&&v.x>=B&&M!==v.x&&vf(k<R?M:E,k,B,R,k<R?E:M,k,v.x,v.y)){const q=Math.abs(k-v.y)/(M-v.x);kc(v,y)&&(q<z||q===z&&(v.x>j.x||v.x===j.x&&Dp(j,v)))&&(j=v,z=q)}v=v.next}while(v!==D);return j}(u,n);if(!s)return n;const h=Qg(s,u);return _f(h,h.next),_f(s,s.next)}function Dp(u,n){return Ra(u.prev,u,n.prev)<0&&Ra(n.next,u,u.next)<0}function Wg(u,n,s,h,y){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-s)*y|0)|u<<8))|u<<4))|u<<2))|u<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-h)*y|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function ca(u){let n=u,s=u;do(n.x<s.x||n.x===s.x&&n.y<s.y)&&(s=n),n=n.next;while(n!==u);return s}function vf(u,n,s,h,y,d,v,M){return(y-v)*(n-M)>=(u-v)*(d-M)&&(u-v)*(h-M)>=(s-v)*(n-M)&&(s-v)*(d-M)>=(y-v)*(h-M)}function C2(u,n){return u.next.i!==n.i&&u.prev.i!==n.i&&!function(s,h){let y=s;do{if(y.i!==s.i&&y.next.i!==s.i&&y.i!==h.i&&y.next.i!==h.i&&qx(y,y.next,s,h))return!0;y=y.next}while(y!==s);return!1}(u,n)&&(kc(u,n)&&kc(n,u)&&function(s,h){let y=s,d=!1;const v=(s.x+h.x)/2,M=(s.y+h.y)/2;do y.y>M!=y.next.y>M&&y.next.y!==y.y&&v<(y.next.x-y.x)*(M-y.y)/(y.next.y-y.y)+y.x&&(d=!d),y=y.next;while(y!==s);return d}(u,n)&&(Ra(u.prev,u,n.prev)||Ra(u,n.prev,n))||Kg(u,n)&&Ra(u.prev,u,u.next)>0&&Ra(n.prev,n,n.next)>0)}function Ra(u,n,s){return(n.y-u.y)*(s.x-n.x)-(n.x-u.x)*(s.y-n.y)}function Kg(u,n){return u.x===n.x&&u.y===n.y}function qx(u,n,s,h){const y=Td(Ra(u,n,s)),d=Td(Ra(u,n,h)),v=Td(Ra(s,h,u)),M=Td(Ra(s,h,n));return y!==d&&v!==M||!(y!==0||!Jg(u,s,n))||!(d!==0||!Jg(u,h,n))||!(v!==0||!Jg(s,u,h))||!(M!==0||!Jg(s,n,h))}function Jg(u,n,s){return n.x<=Math.max(u.x,s.x)&&n.x>=Math.min(u.x,s.x)&&n.y<=Math.max(u.y,s.y)&&n.y>=Math.min(u.y,s.y)}function Td(u){return u>0?1:u<0?-1:0}function kc(u,n){return Ra(u.prev,u,u.next)<0?Ra(u,n,u.next)>=0&&Ra(u,u.prev,n)>=0:Ra(u,n,u.prev)<0||Ra(u,u.next,n)<0}function Qg(u,n){const s=vh(u.i,u.x,u.y),h=vh(n.i,n.x,n.y),y=u.next,d=n.prev;return u.next=n,n.prev=u,s.next=y,y.prev=s,h.next=s,s.prev=h,d.next=h,h.prev=d,h}function Dm(u,n,s,h){const y=vh(u,n,s);return h?(y.next=h.next,y.prev=h,h.next.prev=y,h.next=y):(y.prev=y,y.next=y),y}function Ed(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function vh(u,n,s){return{i:u,x:n,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function ql(u,n){const s=u.length;if(s<=1)return[u];const h=[];let y,d;for(let v=0;v<s;v++){const M=Kl(u[v]);M!==0&&(u[v].area=Math.abs(M),d===void 0&&(d=M<0),d===M<0?(y&&h.push(y),y=[u[v]]):y.push(u[v]))}if(y&&h.push(y),n>1)for(let v=0;v<h.length;v++)h[v].length<=n||(Wc(h[v],n,1,h[v].length-1,Lm),h[v]=h[v].slice(0,n));return h}function Lm(u,n){return n.area-u.area}function Gx(u,n,s=1){if(!u)return null;const h=typeof u=="string"?u:u.getPrimary().id;n[h]||(n[h]=[]);const y=la.from(h).getPrimary().scaleSelf(s);return n[h].push(y),y.serialize()}function ey(u,n,s,h){const y=h.patternDependencies;let d=!1;for(const v of n){const M=v.paint.get(`${u}-pattern`);M.isConstant()||(d=!0),Gx(M.constantOr(null),y,s)&&(d=!0)}return d}function ty(u,n,s,h,y,d){const v=d.patternDependencies;for(const M of n){const k=M.paint.get(`${u}-pattern`).value;if(k.kind!=="constant"){let j=k.evaluate({zoom:h},s,{},d.availableImages);j=j&&j.name?j.name:j;const E=Gx(j,v,y);E&&(s.patterns[M.id]=E)}}return s}class ny{constructor(n){this.zoom=n.zoom,this.pixelRatio=n.pixelRatio,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new fu,this.indexArray=new Ja,this.indexArray2=new Tc,this.programConfigurations=new Es(n.layers,{zoom:n.zoom,lut:n.lut}),this.segments=new Yi,this.segments2=new Yi,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.projection=n.projection}updateFootprints(n,s){}populate(n,s,h,y){this.hasPattern=ey("fill",this.layers,this.pixelRatio,s);const d=this.layers[0].layout.get("fill-sort-key"),v=[];for(const{feature:M,id:k,index:j,sourceLayerIndex:E}of n){const D=this.layers[0]._featureFilter.needGeometry,B=J(M,D);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),B,h))continue;const R=d?d.evaluate(B,{},h,s.availableImages):void 0,z={id:k,properties:M.properties,type:M.type,sourceLayerIndex:E,index:j,geometry:D?B.geometry:Z(M,h,y),patterns:{},sortKey:R};v.push(z)}d&&v.sort((M,k)=>M.sortKey-k.sortKey);for(const M of v){const{geometry:k,index:j,sourceLayerIndex:E}=M;if(this.hasPattern){const D=ty("fill",this.layers,M,this.zoom,this.pixelRatio,s);this.patternFeatures.push(D)}else this.addFeature(M,k,j,h,{},s.availableImages,s.brightness,s.elevationFeatures);s.featureIndex.insert(n[j].feature,k,j,E,this.index)}}update(n,s,h,y,d,v,M){this.programConfigurations.updatePaintArrays(n,s,d,h,y,v,M)}addFeatures(n,s,h,y,d,v){for(const M of this.patternFeatures)this.addFeature(M,M.geometry,M.index,s,h,y,v,n.elevationFeatures)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,O2),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,s,h,y,d,v=[],M,k){for(const j of ql(s,500)){let E=0;for(const W of j)E+=W.length;const D=this.segments.prepareSegment(E,this.layoutVertexArray,this.indexArray),B=D.vertexLength,R=[],z=[];for(const W of j){if(W.length===0)continue;W!==j[0]&&z.push(R.length/2);const K=this.segments2.prepareSegment(W.length,this.layoutVertexArray,this.indexArray2),oe=K.vertexLength;this.layoutVertexArray.emplaceBack(W[0].x,W[0].y),this.indexArray2.emplaceBack(oe+W.length-1,oe),R.push(W[0].x),R.push(W[0].y);for(let se=1;se<W.length;se++)this.layoutVertexArray.emplaceBack(W[se].x,W[se].y),this.indexArray2.emplaceBack(oe+se-1,oe+se),R.push(W[se].x),R.push(W[se].y);K.vertexLength+=W.length,K.primitiveLength+=W.length}const q=km(R,z);for(let W=0;W<q.length;W+=3)this.indexArray.emplaceBack(B+q[W],B+q[W+1],B+q[W+2]);D.vertexLength+=E,D.primitiveLength+=q.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,h,d,v,y,M)}}let $x,ry,W_,K_;In(ny,"FillBucket",{omit:["layers","patternFeatures"]});class J_{constructor(n,s,h,y){if(this.triangleCount=s.length/3,this.min=new $t(0,0),this.max=new $t(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||n.length===0)return;const[d,v]=[n[0].clone(),n[0].clone()];for(let D=1;D<n.length;++D){const B=n[D];d.x=Math.min(d.x,B.x),d.y=Math.min(d.y,B.y),v.x=Math.max(v.x,B.x),v.y=Math.max(v.y,B.y)}if(y){const D=Math.ceil(Math.max(v.x-d.x,v.y-d.y)/y);h=Math.max(h,D)}if(h===0)return;this.min=d,this.max=v;const M=this.max.sub(this.min);M.x=Math.max(M.x,1),M.y=Math.max(M.y,1);const k=Math.max(M.x,M.y)/h;this.cellsX=Math.max(1,Math.ceil(M.x/k)),this.cellsY=Math.max(1,Math.ceil(M.y/k)),this.xScale=1/k,this.yScale=1/k;const j=[];for(let D=0;D<this.triangleCount;D++){const B=n[s[3*D+0]].sub(this.min),R=n[s[3*D+1]].sub(this.min),z=n[s[3*D+2]].sub(this.min),q=vu(Math.floor(Math.min(B.x,R.x,z.x)),this.xScale,this.cellsX),W=vu(Math.floor(Math.max(B.x,R.x,z.x)),this.xScale,this.cellsX),K=vu(Math.floor(Math.min(B.y,R.y,z.y)),this.yScale,this.cellsY),oe=vu(Math.floor(Math.max(B.y,R.y,z.y)),this.yScale,this.cellsY),se=new $t(0,0),ne=new $t(0,0),ce=new $t(0,0),pe=new $t(0,0);for(let we=K;we<=oe;++we){se.y=ne.y=we*k,ce.y=pe.y=(we+1)*k;for(let ke=q;ke<=W;++ke)se.x=ce.x=ke*k,ne.x=pe.x=(ke+1)*k,(yt(B,R,z,se,ne,pe)||yt(B,R,z,se,pe,ce))&&j.push({cellIdx:we*this.cellsX+ke,triIdx:D})}}if(j.length===0)return;j.sort((D,B)=>D.cellIdx-B.cellIdx||D.triIdx-B.triIdx);let E=0;for(;E<j.length;){const D=j[E].cellIdx,B={start:this.payload.length,len:0};for(;E<j.length&&j[E].cellIdx===D;)++B.len,this.payload.push(j[E++].triIdx);this.cells[D]=B}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(n,s){if(this.triangleCount===0||this.cells.length===0||n.x>this.max.x||this.min.x>n.x||n.y>this.max.y||this.min.y>n.y)return;const h=vu(n.x-this.min.x,this.xScale,this.cellsX),y=vu(n.y-this.min.y,this.yScale,this.cellsY),d=this.cells[y*this.cellsX+h];if(d){this._lazyInitLookup();for(let v=0;v<d.len;v++){const M=this.payload[d.start+v],k=Math.floor(M/8),j=1<<M%8;if(!(this.lookup[k]&j)&&(this.lookup[k]|=j,s.push(M),s.length===this.triangleCount))return}}}query(n,s,h){if(this.triangleCount===0||this.cells.length===0||n.x>this.max.x||this.min.x>s.x||n.y>this.max.y||this.min.y>s.y)return;this._lazyInitLookup();const y=vu(n.x-this.min.x,this.xScale,this.cellsX),d=vu(s.x-this.min.x,this.xScale,this.cellsX),v=vu(n.y-this.min.y,this.yScale,this.cellsY),M=vu(s.y-this.min.y,this.yScale,this.cellsY);for(let k=v;k<=M;k++)for(let j=y;j<=d;j++){const E=this.cells[k*this.cellsX+j];if(E)for(let D=0;D<E.len;D++){const B=this.payload[E.start+D],R=Math.floor(B/8),z=1<<B%8;if(!(this.lookup[R]&z)&&(this.lookup[R]|=z,h.push(B),h.length===this.triangleCount))return}}}}function vu(u,n,s){return Math.max(0,Math.min(s-1,Math.floor(u*n)))}In(J_,"TriangleGridIndex");class iy{constructor(n){this.zoom=n.zoom,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.footprints=[]}updateFootprints(n,s){for(const h of this.footprints)s.push({footprint:h,id:n})}populate(n,s,h,y){const d=[];for(const{feature:v,id:M,index:k,sourceLayerIndex:j}of n){const E=this.layers[0]._featureFilter.needGeometry,D=J(v,E);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),D,h))continue;const B={id:M,properties:v.properties,type:v.type,sourceLayerIndex:j,index:k,geometry:E?D.geometry:Z(v,h,y),patterns:{}};d.push(B)}for(const v of d){const{geometry:M,index:k,sourceLayerIndex:j}=v;this.addFeature(v,M,k,h,{},s.availableImages,s.brightness),s.featureIndex.insert(n[k].feature,M,k,j,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(n){}update(n,s,h,y,d,v,M){}destroy(){}addFeature(n,s,h,y,d,v=[],M){for(const k of ql(s,2)){const j=[],E=[],D=[],B=new $t(1/0,1/0),R=new $t(-1/0,-1/0);for(const W of k)if(W.length!==0){W!==k[0]&&D.push(E.length/2);for(let K=0;K<W.length;K++)E.push(W[K].x),E.push(W[K].y),j.push(W[K]),B.x=Math.min(B.x,W[K].x),B.y=Math.min(B.y,W[K].y),R.x=Math.max(R.x,W[K].x),R.y=Math.max(R.y,W[K].y)}const z=km(E,D),q=new J_(j,z,8,256);this.footprints.push({vertices:j,indices:z,grid:q,min:B,max:R})}}}In(iy,"ClipBucket",{omit:["layers"]});const P2=Yr([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),R2=Yr([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),zm=Yr([{name:"a_centroid_pos",components:2,type:"Uint16"}]),k2=Yr([{name:"a_join_normal_inside",components:3,type:"Int16"}]),Hx=Yr([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),Ei=Yr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Q_}=P2;var Lp,ay,oy,sy,Ad,Nm,Md,Bm={};function Xx(){if(ay)return Lp;ay=1;var u=jr();function n(y,d,v,M,k){this.properties={},this.extent=v,this.type=0,this._pbf=y,this._geometry=-1,this._keys=M,this._values=k,y.readFields(s,this,d)}function s(y,d,v){y==1?d.id=v.readVarint():y==2?function(M,k){for(var j=M.readVarint()+M.pos;M.pos<j;){var E=k._keys[M.readVarint()],D=k._values[M.readVarint()];k.properties[E]=D}}(v,d):y==3?d.type=v.readVarint():y==4&&(d._geometry=v.pos)}function h(y){for(var d,v,M=0,k=0,j=y.length,E=j-1;k<j;E=k++)M+=((v=y[E]).x-(d=y[k]).x)*(d.y+v.y);return M}return Lp=n,n.types=["Unknown","Point","LineString","Polygon"],n.prototype.loadGeometry=function(){var y=this._pbf;y.pos=this._geometry;for(var d,v=y.readVarint()+y.pos,M=1,k=0,j=0,E=0,D=[];y.pos<v;){if(k<=0){var B=y.readVarint();M=7&B,k=B>>3}if(k--,M===1||M===2)j+=y.readSVarint(),E+=y.readSVarint(),M===1&&(d&&D.push(d),d=[]),d.push(new u(j,E));else{if(M!==7)throw new Error("unknown command "+M);d&&d.push(d[0].clone())}}return d&&D.push(d),D},n.prototype.bbox=function(){var y=this._pbf;y.pos=this._geometry;for(var d=y.readVarint()+y.pos,v=1,M=0,k=0,j=0,E=1/0,D=-1/0,B=1/0,R=-1/0;y.pos<d;){if(M<=0){var z=y.readVarint();v=7&z,M=z>>3}if(M--,v===1||v===2)(k+=y.readSVarint())<E&&(E=k),k>D&&(D=k),(j+=y.readSVarint())<B&&(B=j),j>R&&(R=j);else if(v!==7)throw new Error("unknown command "+v)}return[E,B,D,R]},n.prototype.toGeoJSON=function(y,d,v){var M,k,j=this.extent*Math.pow(2,v),E=this.extent*y,D=this.extent*d,B=this.loadGeometry(),R=n.types[this.type];function z(K){for(var oe=0;oe<K.length;oe++){var se=K[oe];K[oe]=[360*(se.x+E)/j-180,360/Math.PI*Math.atan(Math.exp((180-360*(se.y+D)/j)*Math.PI/180))-90]}}switch(this.type){case 1:var q=[];for(M=0;M<B.length;M++)q[M]=B[M][0];z(B=q);break;case 2:for(M=0;M<B.length;M++)z(B[M]);break;case 3:for(B=function(K){var oe=K.length;if(oe<=1)return[K];for(var se,ne,ce=[],pe=0;pe<oe;pe++){var we=h(K[pe]);we!==0&&(ne===void 0&&(ne=we<0),ne===we<0?(se&&ce.push(se),se=[K[pe]]):se.push(K[pe]))}return se&&ce.push(se),ce}(B),M=0;M<B.length;M++)for(k=0;k<B[M].length;k++)z(B[M][k])}B.length===1?B=B[0]:R="Multi"+R;var W={type:"Feature",geometry:{type:R,coordinates:B},properties:this.properties};return"id"in this&&(W.id=this.id),W},Lp}function Yx(){if(sy)return oy;sy=1;var u=Xx();function n(h,y){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=h,this._keys=[],this._values=[],this._features=[],h.readFields(s,this,y),this.length=this._features.length}function s(h,y,d){h===15?y.version=d.readVarint():h===1?y.name=d.readString():h===5?y.extent=d.readVarint():h===2?y._features.push(d.pos):h===3?y._keys.push(d.readString()):h===4&&y._values.push(function(v){for(var M=null,k=v.readVarint()+v.pos;v.pos<k;){var j=v.readVarint()>>3;M=j===1?v.readString():j===2?v.readFloat():j===3?v.readDouble():j===4?v.readVarint64():j===5?v.readVarint():j===6?v.readSVarint():j===7?v.readBoolean():null}return M}(d))}return oy=n,n.prototype.feature=function(h){if(h<0||h>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[h];var y=this._pbf.readVarint()+this._pbf.pos;return new u(this._pbf,y,this.extent,this._keys,this._values)},oy}function ev(){return Md||(Md=1,Bm.VectorTile=function(){if(Nm)return Ad;Nm=1;var u=Yx();function n(s,h,y){if(s===3){var d=new u(y,y.readVarint()+y.pos);d.length&&(h[d.name]=d)}}return Ad=function(s,h){this.layers=s.readFields(n,{},h)},Ad}(),Bm.VectorTileFeature=Xx(),Bm.VectorTileLayer=Yx()),Bm}var Od=ev();class Dc extends $t{constructor(n,s,h){super(n,s),this.z=h}}class ra extends Dc{constructor(n,s,h,y){super(n,s,h),this.w=y}}function zp(u,n,s,h){const y=[],d=h===0?(v,M,k,j,E,D)=>{v.push(new $t(D,k+(D-M)/(j-M)*(E-k)))}:(v,M,k,j,E,D)=>{v.push(new $t(M+(D-k)/(E-k)*(j-M),D))};for(const v of u){const M=[];for(const k of v){if(k.length<=2)continue;const j=[];for(let B=0;B<k.length-1;B++){const R=k[B].x,z=k[B].y,q=k[B+1].x,W=k[B+1].y,K=h===0?R:z,oe=h===0?q:W;K<n?oe>n&&d(j,R,z,q,W,n):K>s?oe<s&&d(j,R,z,q,W,s):j.push(k[B]),oe<n&&K>=n&&d(j,R,z,q,W,n),oe>s&&K<=s&&d(j,R,z,q,W,s)}let E=k[k.length-1];const D=h===0?E.x:E.y;D>=n&&D<=s&&j.push(E),j.length&&(E=j[j.length-1],j[0].x===E.x&&j[0].y===E.y||j.push(j[0]),M.push(j))}M.length&&y.push(M)}return y}function Ho(u,n,s,h){const y=s==="x"?"y":"x",d=(h-u[s])/(n[s]-u[s]);u[y]=u[y]+(n[y]-u[y])*d,u[s]=h,u.hasOwnProperty("z")&&(u.z=Nn(u.z,n.z,d)),u.hasOwnProperty("w")&&(u.w=Nn(u.w,n.w,d))}function Zx(u,n,s,h){const y=s,d=h;for(const v of["x","y"]){let M=u,k=n;M[v]>=k[v]&&(M=n,k=u),M[v]<y&&k[v]>y&&Ho(M,k,v,y),M[v]<d&&k[v]>d&&Ho(k,M,v,d)}}const Np=Number.MAX_SAFE_INTEGER;function ly(u,n,s,h){return u.order<n||u.order===Np||!(u.clipMask&s)||function(y,d){return d.length!==0&&d.find(v=>v===y)===void 0}(h,u.clipScope)}function Id(u,n){return u.x-n.x||u.y-n.y}function tv(u,n){return Id(u.min,n.min)===0&&Id(u.max,n.max)===0}function uy(u,n){return!(u.min.x>n.max.x||u.max.x<n.min.x||u.min.y>n.max.y||u.max.y<n.min.y)}function Fm(u,n){if(u.length!==n.length)return!1;for(let s=0;s<u.length;s++)if(u[s].sourceId!==n[s].sourceId||!tv(u[s],n[s])||u[s].order!==n[s].order||u[s].clipMask!==n[s].clipMask||!Ur(u[s].clipScope,n[s].clipScope))return!1;return!0}function cy(u,n,s){const h=1/pn,y=1/(1<<s.canonical.z),d=(n.x*h+s.canonical.x)*y+s.wrap,v=(n.y*h+s.canonical.y)*y;return{min:new $t((u.x*h+s.canonical.x)*y+s.wrap,(u.y*h+s.canonical.y)*y),max:new $t(d,v)}}function D2(u,n,s){const h=1<<s.canonical.z,y=((n.x-s.wrap)*h-s.canonical.x)*pn,d=(n.y*h-s.canonical.y)*pn;return{min:new $t(((u.x-s.wrap)*h-s.canonical.x)*pn,(u.y*h-s.canonical.y)*pn),max:new $t(y,d)}}function nv(u,n,s,h,y,d,v){const M=u.indices,k=u.vertices,j=[];for(let E=h;E<h+y;E+=3){const D=n[s[E+0]+d],B=n[s[E+1]+d],R=n[s[E+2]+d],z=Math.min(D.x,B.x,R.x),q=Math.max(D.x,B.x,R.x),W=Math.min(D.y,B.y,R.y),K=Math.max(D.y,B.y,R.y);j.length=0,u.grid.query(new $t(z,W),new $t(q,K),j);for(let oe=0;oe<j.length;oe++){const se=j[oe];if(yt(k[M[3*se+0]],k[M[3*se+1]],k[M[3*se+2]],D,B,R,v))return!0}}return!1}function Wx(u,n,s,h){if(!u||!s)return!1;let y=u.vertices;if(!n.canonical.equals(h.canonical)||n.wrap!==h.wrap){if(s.vertices.length<u.vertices.length)return Wx(s,h,u,n);const d=n.canonical,v=h.canonical,M=Math.pow(2,v.z-d.z);y=u.vertices.map(k=>new $t((k.x+d.x*pn)*M-v.x*pn,(k.y+d.y*pn)*M-v.y*pn))}return nv(s,y,u.indices,0,u.indices.length,0,0)}function rv(u,n,s,h){const y=Math.pow(2,h.z-s.z);return new $t((u+s.x*pn)*y-h.x*pn,(n+s.y*pn)*y-h.y*pn)}function Kx(u,n){const s=[];n.grid.queryPoint(u,s);const h=n.indices,y=n.vertices;for(let d=0;d<s.length;d++){const v=s[d];if(Ue([y[h[3*v+0]],y[h[3*v+1]],y[h[3*v+2]]],u))return!0}return!1}const iv=[new $t(0,0),new $t(pn,0),new $t(pn,pn),new $t(0,pn)];function hy(u,n){const s=[];let h=[];if(!n||u.length<2)return[u];if(u.length===2)return at(u[0],u[1],iv)?[u]:[];for(let y=0;y<u.length+2;y++){const d=u[y%u.length],v=u[(y+1)%u.length],M=at(y===0?u[u.length-1]:u[(y-1)%u.length],d,iv),k=at(d,v,iv),j=M||k;j&&h.push(d),j&&k||h.length>0&&(h.length>1&&s.push(h),h=[])}return h.length>1&&s.push(h),s}const jm=Od.VectorTileFeature.types,L2=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],z2=["fill-extrusion-flood-light-ground-radius"],Hu=Math.pow(2,13),Jx=Math.pow(2,15)-1,av=new $t(0,1),Ro=2147483648;function Bp(u,n,s,h,y,d,v,M){u.emplaceBack((n<<1)+v,(s<<1)+d,(Math.floor(h*Hu)<<1)+y,Math.round(M))}function xf(u,n,s){u.emplaceBack(n.x*pn,n.y*pn,s?1:0)}function xu(u,n,s,h,y,d){u.emplaceBack(n.x,n.y,(s.x<<1)+h,(s.y<<1)+y,d)}function Um(u,n,s){u.emplaceBack(n.x,n.y,n.z,s[0]*16384,s[1]*16384,s[2]*16384)}class Qx{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class Cd{constructor(){this.centroidXY=new $t(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new $t(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new $t(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new $t(this.max.x-this.min.x,this.max.y-this.min.y)}}class ov{constructor(){this.acc=new $t(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(n,s){n.min.x===Number.MAX_VALUE&&(n.min.x=n.max.x=s.x,n.min.y=n.max.y=s.y)}appendEdge(n,s,h){this.accCount++,this.acc._add(s);let y=!!this.borders;s.x<n.min.x?(n.min.x=s.x,y=!0):s.x>n.max.x&&(n.max.x=s.x,y=!0),s.y<n.min.y?(n.min.y=s.y,y=!0):s.y>n.max.y&&(n.max.y=s.y,y=!0),((s.x===0||s.x===pn)&&s.x===h.x)!=((s.y===0||s.y===pn)&&s.y===h.y)&&this.processBorderOverlap(s,h),y&&this.checkBorderIntersection(s,h)}checkBorderIntersection(n,s){s.x<0!=n.x<0&&this.addBorderIntersection(0,Nn(s.y,n.y,(0-s.x)/(n.x-s.x))),s.x>pn!=n.x>pn&&this.addBorderIntersection(1,Nn(s.y,n.y,(pn-s.x)/(n.x-s.x))),s.y<0!=n.y<0&&this.addBorderIntersection(2,Nn(s.x,n.x,(0-s.y)/(n.y-s.y))),s.y>pn!=n.y>pn&&this.addBorderIntersection(3,Nn(s.x,n.x,(pn-s.y)/(n.y-s.y)))}addBorderIntersection(n,s){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const h=this.borders[n];s<h[0]&&(h[0]=s),s>h[1]&&(h[1]=s)}processBorderOverlap(n,s){if(n.x===s.x){if(n.y===s.y)return;const h=n.x===0?0:1;this.addBorderIntersection(h,s.y),this.addBorderIntersection(h,n.y)}else{const h=n.y===0?2:3;this.addBorderIntersection(h,s.x),this.addBorderIntersection(h,n.x)}}centroid(){return this.accCount===0?new $t(0,0):new $t(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((n,s)=>n+ +(s[0]!==Number.MAX_VALUE),0):0}}function e1(u,n){const s=u.add(n)._unit(),h=Mn(u.x*s.x+u.y*s.y,-1,1);var y,d,v;return v=Math.acos(h),Math.min(4,Math.max(-4,Math.tan(v)))/4*Jx*((y=u).x*(d=n).y-y.y*d.x<0?-1:1)}const N2=[u=>u.x<0,u=>u.x>pn,u=>u.y<0,u=>u.y>pn];function B2(u,n,s,h){const y=[4];if(h===0)return y;s._mult(h);const d=u.sub(s),v=n.sub(s),M=[u,n,d,v];for(let k=0;k<4;k++)for(const j of M)if(N2[k](j)){y.push(k);break}return y}class t1{constructor(n){this.vertexArray=new cd,this.indexArray=new Ja,this.programConfigurations=new Es(n.layers,{zoom:n.zoom,lut:n.lut},s=>z2.includes(s)),this._segments=new Yi,this.hiddenByLandmarkVertexArray=new pd,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Yi}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(n,s,h,y=!1){const d=n.length;if(d>2){let v=Math.max(0,this._segments.get().length-1);const M=this._segments._prepareSegment(4*d,this.vertexArray.length,2*this._segmentToGroundQuads[v].length);let k;v!==this._segments.get().length-1&&(v++,this._segmentToGroundQuads[v]=[],this._segmentToRegionTriCounts[v]=[0,0,0,0,0]);{const j=n[0],E=n[1];k=e1(j.sub(n[d-1])._perp()._unit(),E.sub(j)._perp()._unit())}for(let j=0;j<d;j++){const E=j===d-1?0:j+1,D=n[j],B=n[E],R=n[E===d-1?0:E+1],z=B.sub(D)._perp()._unit(),q=e1(z,R.sub(B)._perp()._unit()),W=k,K=q;if(bf(D,B,s)||y&&Fp(D,s)&&Fp(B,s)){k=q;continue}const oe=M.vertexLength;xu(this.vertexArray,D,B,1,1,W),xu(this.vertexArray,D,B,1,0,W),xu(this.vertexArray,D,B,0,1,K),xu(this.vertexArray,D,B,0,0,K),M.vertexLength+=4;const se=B2(D,B,z,h);for(const ne of se)this._segmentToGroundQuads[v].push({id:oe,region:ne}),this._segmentToRegionTriCounts[v][ne]+=2,M.primitiveLength+=2;k=q}}}prepareBorderSegments(){if(!this.hasData())return;const n=this._segments.get(),s=n.length;for(let h=0;h<s;h++)this._segmentToGroundQuads[h].sort((y,d)=>y.region-d.region);for(let h=0;h<s;h++){const y=this._segmentToGroundQuads[h],d=n[h],v=this._segmentToRegionTriCounts[h];v.reduce((k,j)=>k+j,0);let M=0;for(let k=0;k<=4;k++){const j=v[k];if(j!==0){let E=this.regionSegments[k];E||(E=this.regionSegments[k]=new Yi);const D={vertexOffset:d.vertexOffset,primitiveOffset:d.primitiveOffset+M,vertexLength:d.vertexLength,primitiveLength:j};E.get().push(D)}M+=j}for(let k=0;k<y.length;k++){const j=y[k].id;this.indexArray.emplaceBack(j,j+1,j+3),this.indexArray.emplaceBack(j,j+3,j+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(n,s,h,y,d,v){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,n,s,h,y,d,v)}upload(n){this.hasData()&&(this.vertexBuffer=n.createVertexBuffer(this.vertexArray,R2.members),this.indexBuffer=n.createIndexBuffer(this.indexArray))}uploadPaintProperties(n){this.hasData()&&this.programConfigurations.upload(n)}update(n,s,h,y,d,v,M){this.hasData()&&this.programConfigurations.updatePaintArrays(n,s,h,y,d,v,M)}updateHiddenByLandmark(n){if(!this.hasData())return;const s=n.groundVertexCount+n.groundVertexArrayOffset;if(n.groundVertexCount===0)return;const h=n.flags&Ro?1:0;for(let y=n.groundVertexArrayOffset;y<s;++y)this.hiddenByLandmarkVertexArray.emplace(y,h);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(n){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=n.createVertexBuffer(this.hiddenByLandmarkVertexArray,Hx.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let n=0;n<=4;n++){const s=this.regionSegments[n];s&&s.destroy()}}}}class fy{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.overscaling=n.overscaling,this.layers=n.layers,this.pixelRatio=n.pixelRatio,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=n.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Ja,this.footprintVertices=new fu,this.footprintSegments=[],this.layoutVertexArray=new zl,this.centroidVertexArray=new ts,this.wallVertexArray=new Cm,this.indexArray=new Ja,this.programConfigurations=new Es(n.layers,{zoom:n.zoom,lut:n.lut},s=>L2.includes(s)),this.segments=new Yi,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.groundEffect=new t1(n),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(n,s){}populate(n,s,h,y){this.features=[],this.hasPattern=ey("fill-extrusion",this.layers,this.pixelRatio,s),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=r(h),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:d,id:v,index:M,sourceLayerIndex:k}of n){const j=this.layers[0]._featureFilter.needGeometry,E=J(d,j);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),E,h))continue;const D={id:v,sourceLayerIndex:k,index:M,geometry:j?E.geometry:Z(d,h,y),properties:d.properties,type:d.type,patterns:{}},B=this.layoutVertexArray.length,R=jm[D.type]==="Polygon";if(this.hasPattern)this.features.push(ty("fill-extrusion",this.layers,D,this.zoom,this.pixelRatio,s));else if(this.wallMode)for(const z of D.geometry)for(const q of hy(z,R))this.addFeature(D,[q],M,h,{},s.availableImages,y,s.brightness);else this.addFeature(D,D.geometry,M,h,{},s.availableImages,y,s.brightness);s.featureIndex.insert(d,D.geometry,M,k,this.index,B)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(n,s,h,y,d,v){for(const M of this.features){const k=jm[M.type]==="Polygon",{geometry:j}=M;if(this.wallMode)for(const E of j)for(const D of hy(E,k))this.addFeature(M,[D],M.index,s,h,y,d,v);else this.addFeature(M,j,M.index,s,h,y,d,v)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(n,s,h,y,d,v,M){this.programConfigurations.updatePaintArrays(n,s,d,h,y,v,M),this.groundEffect.update(n,s,d,h,y,v,M)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Q_),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.wallVertexBuffer=n.createVertexBuffer(this.wallVertexArray,k2.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=n.createVertexBuffer(this.layoutVertexExtArray,Ei.members,!0)),this.groundEffect.upload(n)),this.groundEffect.uploadPaintProperties(n),this.programConfigurations.upload(n),this.uploaded=!0}uploadCentroid(n){this.groundEffect.uploadHiddenByLandmark(n),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,zm.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,s,h,y,d,v,M,k){const j=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(n,{})/this.tileToMeter,E=[new $t(0,0),new $t(pn,pn)],D=M.projection,B=D.name==="globe",R=this.wallMode||jm[n.type]==="Polygon",z=new ov;z.centroidDataIndex=this.centroidData.length;const q=new Cd,W=this.layers[0].paint.get("fill-extrusion-base").evaluate(n,{},y)<=0,K=this.layers[0].paint.get("fill-extrusion-height").evaluate(n,{},y);let oe;if(q.height=K,q.vertexArrayOffset=this.layoutVertexArray.length,q.groundVertexArrayOffset=this.groundEffect.vertexArray.length,B&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new lf),this.wallMode){if(B)return void lr("Non zero fill-extrusion-line-width is not yet supported on globe.");if(s.length!==1)return;oe=function(Pe){const We=Pe[0].x===Pe[Pe.length-1].x&&Pe[0].y===Pe[Pe.length-1].y;(function(on){let en=0;const zn=on.length;for(let Tn=0;Tn<zn;Tn++)en+=(on[(Tn+1)%zn].x-on[Tn].x)*(on[(Tn+1)%zn].y+on[Tn].y);return en>=0})(Pe)||(Pe=Pe.reverse());const Je={geometry:[],joinNormals:[],indices:[]},it=[],tt=[],ot=[];let ut=Pe.length;for(;ut>=2&&Pe[ut-1].equals(Pe[ut-2]);)ut--;if(ut<(We?3:2))return Je;let pt,lt,Lt,Wt,Rt,xn=0;for(;xn<ut-1&&Pe[xn].equals(Pe[xn+1]);)xn++;We&&(pt=Pe[ut-2],Rt=Pe[xn].sub(pt)._unit()._perp());for(let on=xn;on<ut;on++){if(Lt=on===ut-1?We?Pe[xn+1]:void 0:Pe[on+1],Lt&&Pe[on].equals(Lt))continue;Rt&&(Wt=Rt),pt&&(lt=pt),pt=Pe[on],Rt=Lt?Lt.sub(pt)._unit()._perp():Wt,Wt=Wt||Rt;let en=Wt.add(Rt);en.x===0&&en.y===0||en._unit();const zn=en.x*Rt.x+en.y*Rt.y,Tn=zn!==0?1/zn:1/0,Pn=Wt.x*Rt.y-Wt.y*Rt.x>0;let ir="miter";const gr=2;ir==="miter"&&Tn>gr&&(ir="bevel"),ir==="bevel"&&(Tn>100&&(ir="flipbevel"),Tn<gr&&(ir="miter"));const wr=(Sr,kr,Lr,Ai)=>{const si=new $t(Sr.x,Sr.y),cr=new $t(Sr.x,Sr.y);si.x+=kr.x*Ai,si.y+=kr.y*Ai,cr.x-=kr.x*Math.max(Lr,1),cr.y-=kr.y*Math.max(Lr,1),ot.push(kr),it.push(si),tt.push(cr)};if(ir==="miter")en._mult(Tn),wr(pt,en,0,0);else if(ir==="flipbevel")en=Rt.mult(-1),wr(pt,en,0,0),wr(pt,en.mult(-1),0,0);else{const Sr=-Math.sqrt(Tn*Tn-1),kr=Pn?Sr:0,Lr=Pn?0:Sr;lt&&wr(pt,Wt,kr,Lr),Lt&&wr(pt,Rt,kr,Lr)}}Je.geometry=[...it,...tt.reverse(),it[0]],Je.joinNormals=[...ot,...ot.reverse(),ot[ot.length-1]];const mn=Je.geometry.length-1;for(let on=0;on<mn/2;on++)if(on+1<mn/2){let en=on,zn=on+1,Tn=mn-1-on,Pn=mn-2-on;en=en===0?mn-1:en-1,zn=zn===0?mn-1:zn-1,Tn=Tn===0?mn-1:Tn-1,Pn=Pn===0?mn-1:Pn-1,Je.indices.push(Tn),Je.indices.push(zn),Je.indices.push(en),Je.indices.push(Tn),Je.indices.push(Pn),Je.indices.push(zn)}return Je}(s[0]),s=[oe.geometry]}const se=(Pe,We)=>Pe<(We.length-1)/2||Pe===We.length-1,ne=this.wallMode?[s]:ql(s,500);for(let Pe=ne.length-1;Pe>=0;Pe--){const We=ne[Pe];(We.length===0||(ce=We[0]).every(Le=>Le.x<=0)||ce.every(Le=>Le.x>=pn)||ce.every(Le=>Le.y<=0)||ce.every(Le=>Le.y>=pn))&&ne.splice(Pe,1)}var ce;let pe;if(B)pe=jp(ne,E,y);else{pe=[];for(const Pe of ne)pe.push({polygon:Pe,bounds:E})}const we=R?this.edgeRadius:0,ke=we>0&&this.zoom<17,Re=(Pe,We)=>{if(Pe.length===0)return!1;const Le=Pe[Pe.length-1];return We.x===Le.x&&We.y===Le.y};for(const{polygon:Pe,bounds:We}of pe){let Le=0,Je=0;for(const ut of Pe)R&&!ut[0].equals(ut[ut.length-1])&&ut.push(ut[0]),Je+=R?ut.length-1:ut.length;const it=this.segments.prepareSegment((R?5:4)*Je,this.layoutVertexArray,this.indexArray);q.footprintSegIdx<0&&(q.footprintSegIdx=this.footprintSegments.length),q.polygonSegIdx<0&&(q.polygonSegIdx=this.polygonSegments.length);const tt={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},ot=new Qx;if(ot.vertexOffset=this.footprintVertices.length,ot.indexOffset=3*this.footprintIndices.length,ot.ringIndices=[],R){const ut=[],pt=[];Le=it.vertexLength;for(let Lt=0;Lt<Pe.length;Lt++){const Wt=Pe[Lt];Wt.length&&Lt!==0&&pt.push(ut.length/2);const Rt=[];let xn,mn;xn=Wt[1].sub(Wt[0])._perp()._unit(),ot.ringIndices.push(Wt.length-1);for(let on=1;on<Wt.length;on++){const en=Wt[on],zn=Wt[on===Wt.length-1?1:on+1],Tn=en.clone();if(we){mn=zn.sub(en)._perp()._unit();const Pn=xn.add(mn)._unit(),ir=we*Math.min(4,1/(xn.x*Pn.x+xn.y*Pn.y));Tn.x+=ir*Pn.x,Tn.y+=ir*Pn.y,Tn.x=Math.round(Tn.x),Tn.y=Math.round(Tn.y),xn=mn}if(!W||we!==0&&!ke||Re(Rt,Tn)||Rt.push(Tn),Bp(this.layoutVertexArray,Tn.x,Tn.y,0,0,1,1,0),this.wallMode){const Pn=se(on,Wt);xf(this.wallVertexArray,oe.joinNormals[on],!Pn)}it.vertexLength++,this.footprintVertices.emplaceBack(en.x,en.y),ut.push(en.x,en.y),B&&Um(this.layoutVertexExtArray,D.projectTilePoint(Tn.x,Tn.y,y),D.upVector(y,Tn.x,Tn.y))}W&&(we===0||ke)&&(Rt.length!==0&&Re(Rt,Rt[0])&&Rt.pop(),this.groundEffect.addData(Rt,We,j))}const lt=this.wallMode?oe.indices:km(ut,pt);for(let Lt=0;Lt<lt.length;Lt+=3)this.footprintIndices.emplaceBack(ot.vertexOffset+lt[Lt+0],ot.vertexOffset+lt[Lt+1],ot.vertexOffset+lt[Lt+2]),this.indexArray.emplaceBack(Le+lt[Lt],Le+lt[Lt+2],Le+lt[Lt+1]),it.primitiveLength++;ot.indexCount+=lt.length,ot.vertexCount+=this.footprintVertices.length-ot.vertexOffset}for(let ut=0;ut<Pe.length;ut++){const pt=Pe[ut];z.startRing(q,pt[0]);let lt=pt.length>4&&lv(pt[pt.length-2],pt[0],pt[1]),Lt=we?F2(pt[pt.length-2],pt[0],pt[1],we):0;const Wt=[];let Rt,xn,mn;xn=pt[1].sub(pt[0])._perp()._unit();let on=!0;for(let en=1,zn=0;en<pt.length;en++){let Tn=pt[en-1],Pn=pt[en];const ir=pt[en===pt.length-1?1:en+1];if(z.appendEdge(q,Pn,Tn),bf(Pn,Tn,We)){we&&(xn=ir.sub(Pn)._perp()._unit(),on=!on);continue}const gr=Pn.sub(Tn)._perp(),wr=gr.x/(Math.abs(gr.x)+Math.abs(gr.y)),Sr=gr.y>0?1:0,kr=Tn.dist(Pn);if(zn+kr>32768&&(zn=0),we){mn=ir.sub(Pn)._perp()._unit();let cr=sv(Tn,Pn,ir,n1(xn,mn),we);isNaN(cr)&&(cr=0);const ai=Pn.sub(Tn)._unit();Tn=Tn.add(ai.mult(Lt))._round(),Pn=Pn.add(ai.mult(-cr))._round(),Lt=cr,xn=mn,W&&this.zoom>=17&&(Re(Wt,Tn)||Wt.push(Tn),Re(Wt,Pn)||Wt.push(Pn))}const Lr=it.vertexLength,Ai=pt.length>4&&lv(Tn,Pn,ir);let si=r1(zn,lt,on);if(Bp(this.layoutVertexArray,Tn.x,Tn.y,wr,Sr,0,0,si),Bp(this.layoutVertexArray,Tn.x,Tn.y,wr,Sr,0,1,si),this.wallMode){const cr=se(en-1,pt),ai=oe.joinNormals[en-1];xf(this.wallVertexArray,ai,cr),xf(this.wallVertexArray,ai,cr)}if(zn+=kr,si=r1(zn,Ai,!on),lt=Ai,Bp(this.layoutVertexArray,Pn.x,Pn.y,wr,Sr,0,0,si),Bp(this.layoutVertexArray,Pn.x,Pn.y,wr,Sr,0,1,si),this.wallMode){const cr=se(en,pt),ai=oe.joinNormals[en];xf(this.wallVertexArray,ai,cr),xf(this.wallVertexArray,ai,cr)}if(it.vertexLength+=4,this.indexArray.emplaceBack(Lr+0,Lr+1,Lr+2),this.indexArray.emplaceBack(Lr+1,Lr+3,Lr+2),it.primitiveLength+=2,we){const cr=Le+(en===1?pt.length-2:en-2),ai=en===1?Le:cr+1;if(this.indexArray.emplaceBack(Lr+1,cr,Lr+3),this.indexArray.emplaceBack(cr,ai,Lr+3),it.primitiveLength+=2,Rt===void 0&&(Rt=Lr),!bf(ir,pt[en],We)){const oi=en===pt.length-1?Rt:it.vertexLength;this.indexArray.emplaceBack(Lr+2,Lr+3,oi),this.indexArray.emplaceBack(Lr+3,oi+1,oi),this.indexArray.emplaceBack(Lr+3,ai,oi+1),it.primitiveLength+=3}on=!on}if(B){const cr=this.layoutVertexExtArray,ai=D.projectTilePoint(Tn.x,Tn.y,y),oi=D.projectTilePoint(Pn.x,Pn.y,y),Fi=D.upVector(y,Tn.x,Tn.y),va=D.upVector(y,Pn.x,Pn.y);Um(cr,ai,Fi),Um(cr,ai,Fi),Um(cr,oi,va),Um(cr,oi,va)}}R&&(Le+=pt.length-1),W&&we&&this.zoom>=17&&(Wt.length!==0&&Re(Wt,Wt[0])&&Wt.pop(),this.groundEffect.addData(Wt,We,j,we>0))}this.footprintSegments.push(ot),tt.triangleCount=this.indexArray.length-tt.triangleArrayOffset,this.polygonSegments.push(tt),++q.footprintSegLen,++q.polygonSegLen}if(q.vertexCount=this.layoutVertexArray.length-q.vertexArrayOffset,q.groundVertexCount=this.groundEffect.vertexArray.length-q.groundVertexArrayOffset,q.vertexCount!==0){if(q.centroidXY=z.borders?av:this.encodeCentroid(z,q),this.centroidData.push(q),z.borders){this.featuresOnBorder.push(z);const Pe=this.featuresOnBorder.length-1;for(let We=0;We<z.borders.length;We++)z.borders[We][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[We].push(Pe)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,h,d,v,y,k),this.groundEffect.addPaintPropertiesData(n,h,d,v,y,k),this.maxHeight=Math.max(this.maxHeight,K)}}sortBorders(){for(let n=0;n<this.borderFeatureIndices.length;n++)this.borderFeatureIndices[n].sort((s,h)=>this.featuresOnBorder[s].borders[n][0]-this.featuresOnBorder[h].borders[n][0])}splitToSubtiles(){const n=[];for(let M=0;M<this.centroidData.length;M++){const k=this.centroidData[M],j=+(k.min.y+k.max.y>pn),E=2*j+(+(k.min.x+k.max.x>pn)^j);for(let D=0;D<k.polygonSegLen;D++){const B=k.polygonSegIdx+D;n.push({centroidIdx:M,subtile:E,polygonSegmentIdx:B,triangleSegmentIdx:this.polygonSegments[B].triangleSegIdx})}}const s=new Ja;n.sort((M,k)=>M.triangleSegmentIdx===k.triangleSegmentIdx?M.subtile-k.subtile:M.triangleSegmentIdx-k.triangleSegmentIdx);let h=0,y=0,d=0;for(const M of n){if(M.triangleSegmentIdx!==h)break;d++}const v=n.length;for(;y!==n.length;){h=n[y].triangleSegmentIdx;let M=0,k=y,j=y;for(let E=k;E<d&&n[E].subtile===M;E++)j++;for(;k!==d;){const E=n[k];M=E.subtile;const D=this.centroidData[E.centroidIdx].min.clone(),B=this.centroidData[E.centroidIdx].max.clone(),R={vertexOffset:this.segments.segments[h].vertexOffset,primitiveOffset:s.length,vertexLength:this.segments.segments[h].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let z=k;z<j;z++){const q=n[z],W=this.polygonSegments[q.polygonSegmentIdx],K=this.centroidData[q.centroidIdx].min,oe=this.centroidData[q.centroidIdx].max,se=this.indexArray.uint16;for(let ne=W.triangleArrayOffset;ne<W.triangleArrayOffset+W.triangleCount;ne++)s.emplaceBack(se[3*ne],se[3*ne+1],se[3*ne+2]);R.primitiveLength+=W.triangleCount,D.x=Math.min(D.x,K.x),D.y=Math.min(D.y,K.y),B.x=Math.max(B.x,oe.x),B.y=Math.max(B.y,oe.y)}R.primitiveLength>0&&this.triangleSubSegments.push({segment:R,min:D,max:B}),k=j;for(let z=k;z<d&&n[z].subtile===n[k].subtile;z++)j++}y=d;for(let E=y;E<v&&n[E].triangleSegmentIdx===n[y].triangleSegmentIdx;E++)d++}s._trim(),this.indexArray=s}getVisibleSegments(n,s,h){const y=new Yi;if(this.wallMode){for(const q of this.triangleSubSegments)y.segments.push(q.segment);return y}let d=0,v=0;const M=1<<n.canonical.z;if(s){const q=s.getMinMaxForTile(n);q&&(d=q.min,v=q.max)}v+=this.maxHeight;const k=n.toUnwrapped();let j;const E=[k.canonical.x/M+k.wrap,k.canonical.y/M],D=[(k.canonical.x+1)/M+k.wrap,(k.canonical.y+1)/M],B=(q,W,K)=>[q[0]*(1-K[0])+W[0]*K[0],q[1]*(1-K[1])+W[1]*K[1]],R=[],z=[];for(const q of this.triangleSubSegments){R[0]=q.min.x/pn,R[1]=q.min.y/pn,z[0]=q.max.x/pn,z[1]=q.max.y/pn;const W=B(E,D,R),K=B(E,D,z);if(new Sn([W[0],W[1],d],[K[0],K[1],v]).intersectsPrecise(h)===0){j&&(y.segments.push(j),j=void 0);continue}const oe=q.segment;j&&j.vertexOffset!==oe.vertexOffset&&(y.segments.push(j),j=void 0),j?(j.vertexLength+=oe.vertexLength,j.primitiveLength+=oe.primitiveLength):j={vertexOffset:oe.vertexOffset,primitiveLength:oe.primitiveLength,vertexLength:oe.vertexLength,primitiveOffset:oe.primitiveOffset,sortKey:void 0,vaos:{}}}return j&&y.segments.push(j),y}encodeCentroid(n,s){const h=n.centroid(),y=s.span(),d=Math.min(7,Math.round(y.x*this.tileToMeter/10)),v=Math.min(7,Math.round(y.y*this.tileToMeter/10));return new $t(Mn(h.x,1,pn-1)<<3|d,Mn(h.y,1,pn-1)<<3|v)}encodeBorderCentroid(n){if(!n.borders)return new $t(0,0);const s=n.borders,h=Number.MAX_VALUE;if(s[0][0]!==h||s[1][0]!==h){const y=s[0][0]!==h?0:1;return new $t(6|(s[0][0]!==h?0:65528),(s[y][0]+s[y][1])/2<<3|6)}{const y=s[2][0]!==h?2:3;return new $t((s[y][0]+s[y][1])/2<<3|6,6|(s[2][0]!==h?0:65528))}}showCentroid(n){const s=this.centroidData[n.centroidDataIndex];s.flags&=Ro,s.centroidXY.x=0,s.centroidXY.y=0,this.writeCentroidToBuffer(s)}writeCentroidToBuffer(n){this.groundEffect.updateHiddenByLandmark(n);const s=n.vertexArrayOffset,h=n.vertexCount+n.vertexArrayOffset,y=n.flags&Ro?av:n.centroidXY,d=this.centroidVertexArray.geta_centroid_pos0(s);if(this.centroidVertexArray.geta_centroid_pos1(s)!==y.y||d!==y.x){for(let v=s;v<h;++v)this.centroidVertexArray.emplace(v,y.x,y.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const n of this.centroidData)this.writeCentroidToBuffer(n)}updateReplacement(n,s,h){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const y=s.getReplacementRegionsForTile(n.toUnwrapped());if(Fm(this.activeReplacements,y))return;if(this.activeReplacements=y,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const v of this.centroidData)v.flags&=2147483647;const d=[];for(const v of this.activeReplacements){if(v.order<h)continue;const M=Math.max(1,Math.pow(2,v.footprintTileId.canonical.z-n.canonical.z));for(const k of this.centroidData)if(!(k.flags&Ro||v.min.x>k.max.x||k.min.x>v.max.x||v.min.y>k.max.y||k.min.y>v.max.y))for(let j=0;j<k.footprintSegLen;j++){const E=this.footprintSegments[k.footprintSegIdx+j];if(d.length=0,i1(this.footprintVertices,E.vertexOffset,E.vertexCount,v.footprintTileId.canonical,n.canonical,d),nv(v.footprint,d,this.footprintIndices.uint16,E.indexOffset,E.indexCount,-E.vertexOffset,-M)){k.flags|=Ro;break}}}for(const v of this.centroidData)this.writeCentroidToBuffer(v);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(n,s,h){let y=!1;for(let d=0;d<h.footprintSegLen;d++){const v=this.footprintSegments[h.footprintSegIdx+d];let M=0;for(const k of v.ringIndices){for(let j=M,E=k+M-1;j<k+M;E=j++){const D=this.footprintVertices.int16[2*(j+v.vertexOffset)+0],B=this.footprintVertices.int16[2*(j+v.vertexOffset)+1],R=this.footprintVertices.int16[2*(E+v.vertexOffset)+1];B>s!=R>s&&n<(this.footprintVertices.int16[2*(E+v.vertexOffset)+0]-D)*(s-B)/(R-B)+D&&(y=!y)}M=k}}return y}getHeightAtTileCoord(n,s){let h=Number.NEGATIVE_INFINITY,y=!0;const d=4*(n+pn)*pn+(s+pn);if(this.partLookup.hasOwnProperty(d)){const v=this.partLookup[d];return v?{height:v.height,hidden:!!(v.flags&Ro)}:void 0}for(const v of this.centroidData)n>v.max.x||v.min.x>n||s>v.max.y||v.min.y>s||this.footprintContainsPoint(n,s,v)&&v&&v.height>h&&(h=v.height,this.partLookup[d]=v,y=!!(v.flags&Ro));if(h!==Number.NEGATIVE_INFINITY)return{height:h,hidden:y};this.partLookup[d]=void 0}}function n1(u,n){const s=u.add(n)._unit();return u.x*s.x+u.y*s.y}function F2(u,n,s,h){const y=n.sub(u)._perp()._unit(),d=s.sub(n)._perp()._unit();return sv(u,n,s,n1(y,d),h)}function sv(u,n,s,h,y){const d=Math.sqrt(1-h*h);return Math.min(u.dist(n)/3,n.dist(s)/3,y*d/h)}function bf(u,n,s){return u.x<s[0].x&&n.x<s[0].x||u.x>s[1].x&&n.x>s[1].x||u.y<s[0].y&&n.y<s[0].y||u.y>s[1].y&&n.y>s[1].y}function Fp(u,n){return u.x<n[0].x||u.x>n[1].x||u.y<n[0].y||u.y>n[1].y}function lv(u,n,s){if(u.x<0||u.x>=pn||n.x<0||n.x>=pn||s.x<0||s.x>=pn)return!1;const h=s.sub(n),y=h.perp(),d=u.sub(n);return(h.x*d.x+h.y*d.y)/Math.sqrt((h.x*h.x+h.y*h.y)*(d.x*d.x+d.y*d.y))>-.866&&y.x*d.x+y.y*d.y<0}function r1(u,n,s){const h=n?2|u:-3&u;return s?1|h:-2&h}function Pd(){const u=Math.PI/32,n=Math.tan(u),s=Ul;return s*Math.sqrt(1+2*n*n)-s}function jp(u,n,s){const h=1<<s.z,y=qo(s.x/h),d=qo((s.x+1)/h),v=Pa(s.y/h),M=Pa((s.y+1)/h);return function(k,j,E,D,B=0,R){const z=[];if(!k.length||!E||!D)return z;const q=(pe,we)=>{for(const ke of pe)z.push({polygon:ke,bounds:we})},W=Math.ceil(Math.log2(E)),K=Math.ceil(Math.log2(D)),oe=W-K,se=[];for(let pe=0;pe<Math.abs(oe);pe++)se.push(oe>0?0:1);for(let pe=0;pe<Math.min(W,K);pe++)se.push(0),se.push(1);let ne=k;if(ne=zp(ne,j[0].y-B,j[1].y+B,1),ne=zp(ne,j[0].x-B,j[1].x+B,0),!ne.length)return z;const ce=[];for(se.length?ce.push({polygons:ne,bounds:j,depth:0}):q(ne,j);ce.length;){const pe=ce.pop(),we=pe.depth,ke=se[we],Re=pe.bounds[0],Pe=pe.bounds[1],We=ke===0?Re.x:Re.y,Le=ke===0?Pe.x:Pe.y,Je=R?R(ke,We,Le):.5*(We+Le),it=zp(pe.polygons,We-B,Je+B,ke),tt=zp(pe.polygons,Je-B,Le+B,ke);if(it.length){const ot=[Re,new $t(ke===0?Je:Pe.x,ke===1?Je:Pe.y)];se.length>we+1?ce.push({polygons:it,bounds:ot,depth:we+1}):q(it,ot)}if(tt.length){const ot=[new $t(ke===0?Je:Re.x,ke===1?Je:Re.y),Pe];se.length>we+1?ce.push({polygons:tt,bounds:ot,depth:we+1}):q(tt,ot)}}return z}(u,n,Math.ceil((d-y)/11.25),Math.ceil((v-M)/11.25),1,(k,j,E)=>{if(k===0)return .5*(j+E);{const D=Pa((s.y+j/pn)/h);return(gl(.5*(Pa((s.y+E/pn)/h)+D))*h-s.y)*pn}})}function i1(u,n,s,h,y,d){const v=Math.pow(2,h.z-y.z);for(let M=0;M<s;M++){let k=u.int16[2*(M+n)+0],j=u.int16[2*(M+n)+1];k=(k+y.x*pn)*v-h.x*pn,j=(j+y.y*pn)*v-h.y*pn,d.push(new $t(k,j))}}let Vm,dy;function Rd(u,n){return u.x*n.x+u.y*n.y}function qm(u,n){if(u.length===1){let s=0;const h=n[s++];let y;for(;!y||h.equals(y);)if(y=n[s++],!y)return 1/0;for(;s<n.length;s++){const d=n[s],v=u[0],M=y.sub(h),k=d.sub(h),j=v.sub(h),E=Rd(M,M),D=Rd(M,k),B=Rd(k,k),R=Rd(j,M),z=Rd(j,k),q=E*B-D*D,W=(B*R-D*z)/q,K=(E*z-D*R)/q,oe=h.z*(1-W-K)+y.z*W+d.z*K;if(isFinite(oe))return oe}return 1/0}{let s=1/0;for(const h of n)s=Math.min(s,h.z);return s}}function uv(u,n,s,h,y,d,v,M){const k=v*y.getElevationAt(u,n,!0,!0),j=d[0]!==0,E=j?d[1]===0?v*(d[0]/7-450):v*function(D,B,R){const z=Math.floor(B[0]/8),q=Math.floor(B[1]/8),W=10*(B[0]-8*z),K=10*(B[1]-8*q),oe=D.getElevationAt(z,q,!0,!0),se=D.getMeterToDEM(R),ne=Math.floor(.5*(W*se-1)),ce=Math.floor(.5*(K*se-1)),pe=D.tileCoordToPixel(z,q),we=2*ne+1,ke=2*ce+1,Re=function(tt,ot,ut,pt,lt){return[tt.getElevationAtPixel(ot,ut,!0),tt.getElevationAtPixel(ot+lt,ut,!0),tt.getElevationAtPixel(ot,ut+lt,!0),tt.getElevationAtPixel(ot+pt,ut+lt,!0)]}(D,pe.x-ne,pe.y-ce,we,ke),Pe=Math.abs(Re[0]-Re[1]),We=Math.abs(Re[2]-Re[3]),Le=Math.abs(Re[0]-Re[2])+Math.abs(Re[1]-Re[3]),Je=Math.min(.25,.5*se*(Pe+We)/we),it=Math.min(.25,.5*se*Le/ke);return oe+Math.max(Je*W,it*K)}(y,d,M):k;return{base:k+(s===0?-1:s),top:j?Math.max(E+h,k+s+2):k+h}}In(fy,"FillExtrusionBucket",{omit:["layers","features"]}),In(Cd,"PartData"),In(Qx,"FootprintSegment"),In(ov,"BorderCentroidData"),In(t1,"GroundEffect");const a1=Yr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),j2=Yr([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:o1}=a1,Gm=Yr([{name:"a_packed",components:3,type:"Float32"}]),{members:U2}=Gm,V2=Yr([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:q2}=V2;class $m{constructor(n,s){this.width=n,this.height=s,this.nextRow=0,this.image=new _h({width:n,height:s}),this.positions={},this.uploaded=!1}getDash(n,s){const h=this.getKey(n,s);return this.positions[h]}trim(){const n=this.width,s=this.height=Rr(this.nextRow);this.image.resize({width:n,height:s})}getKey(n,s){return n.join(",")+s}getDashRanges(n,s,h){const y=[];let d=n.length%2==1?-n[n.length-1]*h:0,v=n[0]*h,M=!0;y.push({left:d,right:v,isDash:M,zeroLength:n[0]===0});let k=n[0];for(let j=1;j<n.length;j++){M=!M;const E=n[j];d=k*h,k+=E,v=k*h,y.push({left:d,right:v,isDash:M,zeroLength:E===0})}return y}addRoundDash(n,s,h){const y=s/2;for(let d=-h;d<=h;d++){const v=this.width*(this.nextRow+h+d);let M=0,k=n[M];for(let j=0;j<this.width;j++){j/k.right>1&&(k=n[++M]);const E=Math.abs(j-k.left),D=Math.abs(j-k.right),B=Math.min(E,D);let R;const z=d/h*(y+1);if(k.isDash){const q=y-Math.abs(z);R=Math.sqrt(B*B+q*q)}else R=y-Math.sqrt(B*B+z*z);this.image.data[v+j]=Math.max(0,Math.min(255,R+128))}}}addRegularDash(n,s){for(let k=n.length-1;k>=0;--k){const j=n[k],E=n[k+1];j.zeroLength?n.splice(k,1):E&&E.isDash===j.isDash&&(E.left=j.left,n.splice(k,1))}const h=n[0],y=n[n.length-1];h.isDash===y.isDash&&(h.left=y.left-this.width,y.right=h.right+this.width);const d=this.width*this.nextRow;let v=0,M=n[v];for(let k=0;k<this.width;k++){k/M.right>1&&(M=n[++v]);const j=Math.abs(k-M.left),E=Math.abs(k-M.right),D=Math.min(j,E);this.image.data[d+k]=Math.max(0,Math.min(255,(M.isDash?D:-D)+s+128))}}addDash(n,s){const h=this.getKey(n,s);if(this.positions[h])return this.positions[h];const y=s==="round",d=y?7:0,v=2*d+1;if(this.nextRow+v>this.height)return lr("LineAtlas out of space"),null;n.length===0&&n.push(1);let M=0;for(let E=0;E<n.length;E++)n[E]<0&&(lr("Negative value is found in line dasharray, replacing values with 0"),n[E]=0),M+=n[E];if(M!==0){const E=this.width/M,D=this.getDashRanges(n,this.width,E);y?this.addRoundDash(D,E,d):this.addRegularDash(D,s==="square"?.5*E:0)}const k=this.nextRow+d;this.nextRow+=v;const j={tl:[k,d],br:[M,0]};return this.positions[h]=j,j}}In($m,"LineAtlas");const py=Od.VectorTileFeature.types,cv=Math.cos(Math.PI/180*37.5),G2=Math.cos(Math.PI/180*5);class kd{constructor(n){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.zoom=n.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=n.overscaling,this.pixelRatio=n.pixelRatio,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.projection=n.projection,this.hasPattern=!1,this.hasZOffset=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new sf,this.layoutVertexArray2=new du,this.patternVertexArray=new du,this.indexArray=new Ja,this.programConfigurations=new Es(n.layers,{zoom:n.zoom,lut:n.lut}),this.segments=new Yi,this.maxLineLength=0,this.zOffsetVertexArray=new du,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.tessellationStep=n.tessellationStep?n.tessellationStep:pn/64}updateFootprints(n,s){}populate(n,s,h,y){this.hasPattern=ey("line",this.layers,this.pixelRatio,s);const d=this.layers[0].layout.get("line-sort-key");this.tileToMeter=r(h);const v=this.layers[0].layout.get("line-z-offset"),M=v.isConstant()&&!v.constantOr(0),k=this.layers[0].layout.get("line-elevation-reference");this.hasZOffset=k==="sea"||k==="ground"||!M&&k==="none",this.hasZOffset&&k==="none"&&lr(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`);const j=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.hasZOffset&&j!==void 0;const E=[];for(const{feature:z,id:q,index:W,sourceLayerIndex:K}of n){const oe=this.layers[0]._featureFilter.needGeometry,se=J(z,oe);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),se,h))continue;const ne=d?d.evaluate(se,{},h):void 0,ce={id:q,properties:z.properties,type:z.type,sourceLayerIndex:K,index:W,geometry:oe?se.geometry:Z(z,h,y),patterns:{},sortKey:ne};E.push(ce)}d&&E.sort((z,q)=>z.sortKey-q.sortKey);const{lineAtlas:D,featureIndex:B}=s,R=this.addConstantDashes(D);for(const z of E){const{geometry:q,index:W,sourceLayerIndex:K}=z;if(R&&this.addFeatureDashes(z,D),this.hasPattern){const oe=ty("line",this.layers,z,this.zoom,this.pixelRatio,s);this.patternFeatures.push(oe)}else this.addFeature(z,q,W,h,D.positions,s.availableImages,s.brightness);B.insert(n[W].feature,q,W,K,this.index)}}addConstantDashes(n){let s=!1;for(const h of this.layers){const y=h.paint.get("line-dasharray").value,d=h.layout.get("line-cap").value;if(y.kind!=="constant"||d.kind!=="constant")s=!0;else{const v=d.value,M=y.value;if(!M)continue;n.addDash(M,v)}}return s}addFeatureDashes(n,s){const h=this.zoom;for(const y of this.layers){const d=y.paint.get("line-dasharray").value,v=y.layout.get("line-cap").value;if(d.kind==="constant"&&v.kind==="constant")continue;let M,k;if(d.kind==="constant"){if(M=d.value,!M)continue}else M=d.evaluate({zoom:h},n);k=v.kind==="constant"?v.value:v.evaluate({zoom:h},n),s.addDash(M,k),n.patterns[y.id]=s.getKey(M,k)}}update(n,s,h,y,d,v,M){this.programConfigurations.updatePaintArrays(n,s,d,h,y,v,M)}addFeatures(n,s,h,y,d,v){for(const M of this.patternFeatures)this.addFeature(M,M.geometry,M.index,s,h,y,v)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,U2)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=n.createVertexBuffer(this.patternVertexArray,q2)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=n.createVertexBuffer(this.zOffsetVertexArray,j2.members,!0)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,o1),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&n.properties.hasOwnProperty("mapbox_clip_start")&&n.properties.hasOwnProperty("mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,s,h,y,d,v,M){const k=this.layers[0].layout,j=k.get("line-join").evaluate(n,{}),E=k.get("line-cap").evaluate(n,{}),D=k.get("line-miter-limit"),B=k.get("line-round-limit");this.lineClips=this.lineFeatureClips(n),this.lineFeature=n,this.zOffsetValue=k.get("line-z-offset").value;const R=this.layers[0].paint.get("line-width").value;R.kind!=="constant"&&R.isLineProgressConstant===!1&&(this.variableWidthValue=R);for(const z of s)this.addLine(z,n,y,j,E,D,B);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,h,d,v,y,M)}addLine(n,s,h,y,d,v,M){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const k=y==="none";if(this.patternJoinNone=this.hasPattern&&k,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let se=0;se<n.length-1;se++)this.totalDistance+=n[se].dist(n[se+1]);this.totalFeatureLength=this.totalDistance/(this.lineClips.end-this.lineClips.start),this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const j=py[s.type]==="Polygon";let E=n.length;for(;E>=2&&n[E-1].equals(n[E-2]);)E--;let D=0;for(;D<E-1&&n[D].equals(n[D+1]);)D++;if(E<(j?3:2))return;y==="bevel"&&(v=1.05);const B=this.segments.prepareSegment(10*E,this.layoutVertexArray,this.indexArray);let R,z,q,W,K,oe;this.e1=this.e2=-1,j&&(R=n[E-2],K=n[D].sub(R)._unit()._perp());for(let se=D;se<E;se++){if(q=se===E-1?j?n[D+1]:void 0:n[se+1],q&&n[se].equals(q))continue;K&&(W=K),R&&(z=R),R=n[se],oe=this.evaluateLineProgressFeatures(z?z.dist(R):0),K=q?q.sub(R)._unit()._perp():W,W=W||K;const ne=z&&q;let ce=ne?y:j||k?"butt":d;const pe=W.x*K.x+W.y*K.y;if(k){const it=function(tt){if(tt.patternJoinNone){const ot=tt.segmentPoints.length/2,ut=tt.lineSoFar-tt.segmentStart;for(let pt=0;pt<ot;++pt){const lt=tt.segmentPoints[2*pt+1],Lt=Math.round(tt.segmentPoints[2*pt])+.5+.25*lt;tt.patternVertexArray.emplaceBack(Lt,ut,tt.segmentStart),tt.patternVertexArray.emplaceBack(Lt,ut,tt.segmentStart)}tt.segmentPoints.length=0}tt.e1=tt.e2=-1};if(ne&&pe<G2){this.updateDistance(z,R),this.addCurrentVertex(R,W,1,1,B,oe),it(this),this.addCurrentVertex(R,K,-1,-1,B,oe);continue}if(z){if(!q){this.updateDistance(z,R),this.addCurrentVertex(R,W,1,1,B,oe),it(this);continue}ce="miter"}}let we=W.add(K);we.x===0&&we.y===0||we._unit();const ke=we.x*K.x+we.y*K.y,Re=ke!==0?1/ke:1/0,Pe=2*Math.sqrt(2-2*ke),We=ke<cv&&z&&q,Le=W.x*K.y-W.y*K.x>0,Je=this.overscaling<=16?15*pn/(512*this.overscaling):0;if(ne&&ce==="round"){if(Re<M)ce="miter";else if(Re<=2){const it=hv(R,-10,pn+10);ce=this.hasZOffset&&(it||this.hasCrossSlope)?"miter":"fakeround"}}if(ce==="miter"&&Re>v&&(ce="bevel"),ce==="bevel"&&(Re>2&&(ce="flipbevel"),Re<v&&(ce="miter")),z&&!(ce==="miter"&&We)&&this.updateDistance(z,R),ce==="miter")if(We){const it=R.dist(z);if(it>2*Je){const ot=R.sub(R.sub(z)._mult(Je/it)._round());this.updateDistance(z,ot),this.addCurrentVertex(ot,W,0,0,B,oe),z=ot}this.updateDistance(z,R),we._mult(Re),this.addCurrentVertex(R,we,0,0,B,oe);const tt=R.dist(q);if(tt>2*Je){const ot=R.add(q.sub(R)._mult(Je/tt)._round());this.updateDistance(R,ot),this.addCurrentVertex(ot,K,0,0,B,oe),R=ot}}else we._mult(Re),this.addCurrentVertex(R,we,0,0,B,oe);else if(ce==="flipbevel"){if(Re>100)we=K.mult(-1);else{const it=Re*W.add(K).mag()/W.sub(K).mag();we._perp()._mult(it*(Le?-1:1))}this.addCurrentVertex(R,we,0,0,B,oe),this.addCurrentVertex(R,we.mult(-1),0,0,B,oe)}else if(ce==="bevel"||ce==="fakeround"){oe!=null&&z&&this.addCurrentVertex(R,W,-1,-1,B,oe);const it=R.dist(z)<=2*Je&&ce!=="bevel",tt=we.mult(Le?1:-1);tt._mult(Re);const ot=K.mult(Le?-1:1),ut=W.mult(Le?-1:1),pt=this.evaluateLineProgressFeatures(this.distance);if(oe==null&&(this.addHalfVertex(R,tt.x,tt.y,!1,!Le,0,B,pt),it||this.addHalfVertex(R,tt.x+2*ut.x,tt.y+2*ut.y,!1,Le,0,B,pt)),ce==="fakeround"){const lt=Math.round(180*Pe/Math.PI/20);this.addHalfVertex(R,ut.x,ut.y,!1,Le,0,B,pt);for(let Lt=0;Lt<lt;Lt++){let Wt=Lt/lt;if(Wt!==.5){const xn=Wt-.5;Wt+=Wt*xn*(Wt-1)*((1.0904+pe*(pe*(3.55645-1.43519*pe)-3.2452))*xn*xn+(.848013+pe*(.215638*pe-1.06021)))}const Rt=ot.sub(ut)._mult(Wt)._add(ut)._unit();this.addHalfVertex(R,Rt.x,Rt.y,!1,Le,0,B,pt)}this.addHalfVertex(R,ot.x,ot.y,!1,Le,0,B,pt)}it||oe!=null||this.addHalfVertex(R,tt.x+2*ot.x,tt.y+2*ot.y,!1,Le,0,B,pt),oe!=null&&q&&this.addCurrentVertex(R,K,1,1,B,oe)}else ce==="butt"?this.addCurrentVertex(R,we,0,0,B,oe):ce==="square"?(z||this.addCurrentVertex(R,we,-1,-1,B,oe),this.addCurrentVertex(R,we,0,0,B,oe),z&&this.addCurrentVertex(R,we,1,1,B,oe)):ce==="round"&&(z&&(this.addCurrentVertex(R,W,0,0,B,oe),this.addCurrentVertex(R,W,1,1,B,oe,!0)),q&&(this.addCurrentVertex(R,K,-1,-1,B,oe,!0),this.addCurrentVertex(R,K,0,0,B,oe)))}}addVerticesTo(n,s,h,y,d,v,M,k,j,E){const D=(s.w-n.w)/this.tessellationStep|0;let B=0;const R=this.scaledDistance;if(D>1){this.lineSoFar=n.w;const q=(s.x-n.x)/D,W=(s.y-n.y)/D,K=(s.z-n.z)/D,oe=(s.w-n.w)/D;for(let se=1;se<D;++se){n.x+=q,n.y+=W,n.z+=K,this.lineSoFar+=oe,B+=oe;const ne=this.evaluateLineProgressFeatures(this.prevDistance+B);this.scaledDistance=(this.prevDistance+B)/this.totalDistance,this.addHalfVertex(n,h,y,E,!1,M,j,ne),this.addHalfVertex(n,d,v,E,!0,-k,j,ne)}}this.lineSoFar=s.w,this.scaledDistance=R;const z=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(s,h,y,E,!1,M,j,z),this.addHalfVertex(s,d,v,E,!0,-k,j,z)}evaluateLineProgressFeatures(n){if(!this.variableWidthValue&&!this.hasZOffset)return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+n)/this.totalFeatureLength):lr(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let s=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(s=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.hasZOffset?this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:s}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:s}:{zOffset:0,variableWidth:s}}addCurrentVertex(n,s,h,y,d,v,M=!1){const k=s.x+s.y*h,j=s.y-s.x*h,E=s.y*y-s.x,D=-s.y-s.x*y;if(v!=null){const B=this.hasZOffset,R=-10,z=pn+10,q=v.zOffset,W=new ra(n.x,n.y,q,this.lineSoFar),K=!!B&&hv(n,R,z),oe=this.lineSoFar,se=this.distance;if(this.currentVertex)if(K){const ne=this.currentVertexIsOutside,ce=this.currentVertex,pe=new ra(n.x,n.y,q,this.lineSoFar);if(Zx(ce,pe,R,z),!hv(pe,R,z)){if(ne){this.e1=this.e2=-1,this.distance-=ce.dist(W),this.lineSoFar=ce.w;const we=this.evaluateLineProgressFeatures(ce.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ce,k,j,M,!1,h,d,we),this.addHalfVertex(ce,E,D,M,!0,-y,d,we),this.prevDistance=this.distance}this.distance=this.prevDistance+ce.dist(pe),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(ce,pe,k,j,E,D,h,y,d,M),this.distance=se,this.scaledDistance=this.distance/this.totalDistance}}else{const ne=this.currentVertex;if(this.currentVertexIsOutside){Zx(ne,W,R,z),this.e1=this.e2=-1,this.distance-=ne.dist(W),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=ne.w;const ce=this.evaluateLineProgressFeatures(ne.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ne,k,j,M,!1,h,d,ce),this.addHalfVertex(ne,E,D,M,!0,-y,d,ce),this.prevDistance=this.distance,this.distance=se,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(ne,W,k,j,E,D,h,y,d,M)}else K||(this.addHalfVertex(n,k,j,M,!1,h,d,v),this.addHalfVertex(n,E,D,M,!0,-y,d,v));this.currentVertex=W,this.currentVertexIsOutside=K,this.lineSoFar=oe}else this.addHalfVertex(n,k,j,M,!1,h,d,v),this.addHalfVertex(n,E,D,M,!0,-y,d,v)}addHalfVertex({x:n,y:s},h,y,d,v,M,k,j){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),v||this.segmentPoints.push(this.lineSoFar-this.segmentStart,M)),this.layoutVertexArray.emplaceBack((n<<1)+(d?1:0),(s<<1)+(v?1:0),Math.round(63*h)+128,Math.round(63*y)+128,1+(M===0?0:M<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const D=Nn(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,D)}const E=k.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,E),k.primitiveLength++),v?this.e2=E:this.e1=E,j!=null&&this.zOffsetVertexArray.emplaceBack(j.zOffset,j.variableWidth,j.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(n,s){this.prevDistance=this.distance,this.distance+=n.dist(s),this.updateScaledDistance()}}function hv(u,n,s){return u.x<n||u.x>s||u.y<n||u.y>s}let fv,dv;function pv(u,n,s){return n*(pn/(u.tileSize*Math.pow(2,s-u.tileID.overscaledZ)))}In(kd,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const mv=(u,n,s)=>(1-s)*u+s*n;function my(u,n){return 1/pv(u,1,n.tileZoom)}function gv(u,n,s,h){return u.translatePosMatrix(h||n.tileID.projMatrix,n,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const Hm=u=>{const n=[];s1(u)&&n.push("RENDER_LINE_DASH"),u.paint.get("line-gradient")&&n.push("RENDER_LINE_GRADIENT");const s=u.paint.get("line-trim-offset");s[0]===0&&s[1]===0||n.push("RENDER_LINE_TRIM_OFFSET"),u.paint.get("line-border-width").constantOr(1)!==0&&n.push("RENDER_LINE_BORDER");const h=u.layout.get("line-join").constantOr("miter")==="none",y=!!u.paint.get("line-pattern").constantOr(1);return h&&y&&n.push("LINE_JOIN_NONE"),n};function s1(u){const n=u.paint.get("line-dasharray").value;return n.value||n.kind!=="constant"}let yv;const gy=()=>yv||(yv={layout:fv||(fv=new Bi({"line-cap":new En(_t.layout_line["line-cap"]),"line-join":new En(_t.layout_line["line-join"]),"line-miter-limit":new sn(_t.layout_line["line-miter-limit"]),"line-round-limit":new sn(_t.layout_line["line-round-limit"]),"line-sort-key":new En(_t.layout_line["line-sort-key"]),"line-z-offset":new En(_t.layout_line["line-z-offset"]),"line-elevation-reference":new sn(_t.layout_line["line-elevation-reference"]),"line-cross-slope":new sn(_t.layout_line["line-cross-slope"]),visibility:new sn(_t.layout_line.visibility),"line-width-unit":new sn(_t.layout_line["line-width-unit"])})),paint:dv||(dv=new Bi({"line-opacity":new En(_t.paint_line["line-opacity"]),"line-color":new En(_t.paint_line["line-color"]),"line-translate":new sn(_t.paint_line["line-translate"]),"line-translate-anchor":new sn(_t.paint_line["line-translate-anchor"]),"line-width":new En(_t.paint_line["line-width"]),"line-gap-width":new En(_t.paint_line["line-gap-width"]),"line-offset":new En(_t.paint_line["line-offset"]),"line-blur":new En(_t.paint_line["line-blur"]),"line-dasharray":new En(_t.paint_line["line-dasharray"]),"line-pattern":new En(_t.paint_line["line-pattern"]),"line-gradient":new lh(_t.paint_line["line-gradient"]),"line-trim-offset":new sn(_t.paint_line["line-trim-offset"]),"line-trim-fade-range":new sn(_t.paint_line["line-trim-fade-range"]),"line-trim-color":new sn(_t.paint_line["line-trim-color"]),"line-emissive-strength":new sn(_t.paint_line["line-emissive-strength"]),"line-border-width":new En(_t.paint_line["line-border-width"]),"line-border-color":new En(_t.paint_line["line-border-color"]),"line-occlusion-opacity":new sn(_t.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new En({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new En({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new En({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new En({type:"string",default:"default","property-type":"data-driven"})}))},yv);class _v extends En{possiblyEvaluate(n,s){return s=new ci(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,transition:s.transition}),super.possiblyEvaluate(n,s)}evaluate(n,s,h,y){return s=ar({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(n,s,h,y)}}let wf;function yy(u,n){return n>0?n+2*u:u}const l1=Yr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),vv=Yr([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Sf=Yr([{name:"a_projected_pos",components:4,type:"Float32"}],4);Yr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Tf=Yr([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),Ef=Yr([{name:"a_texb",components:2,type:"Uint16"}]),Xm=Yr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),Ym=Yr([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);Yr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const xh=Yr([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),$2=Yr([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Yr([{name:"triangle",components:3,type:"Uint16"}]),Yr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Yr([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),Yr([{type:"Float32",name:"offsetX"}]),Yr([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var bo=24;const Qs=128;function xv(u,n,s,h,y){if(u.kind==="camera")return u.maxSize;if(u.kind==="composite"){const d=n.possiblyEvaluate(new ci(u.maxZoom),s).evaluate(y,{},s),v=n.possiblyEvaluate(new ci(u.minZoom),s).evaluate(y,{},s);return Math.max(d,v)}return n.possiblyEvaluate(new ci(h)).evaluate(y,{},s)}function _y(u,n){const{expression:s}=n;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new ci(u+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:h,interpolationType:y}=s;let d=0;for(;d<h.length&&h[d]<=u;)d++;d=Math.max(0,d-1);let v=d;for(;v<h.length&&h[v]<u+1;)v++;v=Math.min(h.length-1,v);const M=h[d],k=h[v];return s.kind==="composite"?{kind:"composite",minZoom:M,maxZoom:k,interpolationType:y}:{kind:"camera",minZoom:M,maxZoom:k,minSize:s.evaluate(new ci(M)),maxSize:s.evaluate(new ci(k)),interpolationType:y}}}function Dd(u,{uSize:n,uSizeT:s},{lowerSize:h,upperSize:y}){return u.kind==="source"?h/Qs:u.kind==="composite"?Nn(h/Qs,y/Qs,s):n}function Ld(u,n,s=1){let h=0,y=0;if(u.kind==="constant")y=u.layoutSize*s;else if(u.kind!=="source"){const{interpolationType:d,minZoom:v,maxZoom:M}=u,k=d?Mn(Xi.interpolationFactor(d,n,v,M),0,1):0;u.kind==="camera"?y=Nn(u.minSize,u.maxSize,k)*s:h=k*s}return{uSizeT:h,uSize:y}}var H2=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Qs,evaluateSizeForFeature:Dd,evaluateSizeForZoom:Ld,getRasterizedIconSize:xv,getSizeData:_y});function vy(u,n,s){return u.sections.forEach(h=>{h.text=function(y,d,v){const M=d.layout.get("text-transform").evaluate(v,{});return M==="uppercase"?y=y.toLocaleUpperCase():M==="lowercase"&&(y=y.toLocaleLowerCase()),Ii.applyArabicShaping&&(y=Ii.applyArabicShaping(y)),y}(h.text,n,s)}),u}const Af={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function u1(u){return u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""}function Zm(u){return u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""}var xy,Up,bv,wv={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function by(){return xy||(xy=1,wv.read=function(u,n,s,h,y){var d,v,M=8*y-h-1,k=(1<<M)-1,j=k>>1,E=-7,D=s?y-1:0,B=s?-1:1,R=u[n+D];for(D+=B,d=R&(1<<-E)-1,R>>=-E,E+=M;E>0;d=256*d+u[n+D],D+=B,E-=8);for(v=d&(1<<-E)-1,d>>=-E,E+=h;E>0;v=256*v+u[n+D],D+=B,E-=8);if(d===0)d=1-j;else{if(d===k)return v?NaN:1/0*(R?-1:1);v+=Math.pow(2,h),d-=j}return(R?-1:1)*v*Math.pow(2,d-h)},wv.write=function(u,n,s,h,y,d){var v,M,k,j=8*d-y-1,E=(1<<j)-1,D=E>>1,B=y===23?Math.pow(2,-24)-Math.pow(2,-77):0,R=h?0:d-1,z=h?1:-1,q=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(M=isNaN(n)?1:0,v=E):(v=Math.floor(Math.log(n)/Math.LN2),n*(k=Math.pow(2,-v))<1&&(v--,k*=2),(n+=v+D>=1?B/k:B*Math.pow(2,1-D))*k>=2&&(v++,k/=2),v+D>=E?(M=0,v=E):v+D>=1?(M=(n*k-1)*Math.pow(2,y),v+=D):(M=n*Math.pow(2,D-1)*Math.pow(2,y),v=0));y>=8;u[s+R]=255&M,R+=z,M/=256,y-=8);for(v=v<<y|M,j+=y;j>0;u[s+R]=255&v,R+=z,v/=256,j-=8);u[s+R-z]|=128*q}),wv}function f(){if(bv)return Up;bv=1,Up=n;var u=by();function n(ne){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(ne)?ne:new Uint8Array(ne||0),this.pos=0,this.type=0,this.length=this.buf.length}n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;var s=4294967296,h=1/s,y=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function d(ne){return ne.type===n.Bytes?ne.readVarint()+ne.pos:ne.pos+1}function v(ne,ce,pe){return pe?4294967296*ce+(ne>>>0):4294967296*(ce>>>0)+(ne>>>0)}function M(ne,ce,pe){var we=ce<=16383?1:ce<=2097151?2:ce<=268435455?3:Math.floor(Math.log(ce)/(7*Math.LN2));pe.realloc(we);for(var ke=pe.pos-1;ke>=ne;ke--)pe.buf[ke+we]=pe.buf[ke]}function k(ne,ce){for(var pe=0;pe<ne.length;pe++)ce.writeVarint(ne[pe])}function j(ne,ce){for(var pe=0;pe<ne.length;pe++)ce.writeSVarint(ne[pe])}function E(ne,ce){for(var pe=0;pe<ne.length;pe++)ce.writeFloat(ne[pe])}function D(ne,ce){for(var pe=0;pe<ne.length;pe++)ce.writeDouble(ne[pe])}function B(ne,ce){for(var pe=0;pe<ne.length;pe++)ce.writeBoolean(ne[pe])}function R(ne,ce){for(var pe=0;pe<ne.length;pe++)ce.writeFixed32(ne[pe])}function z(ne,ce){for(var pe=0;pe<ne.length;pe++)ce.writeSFixed32(ne[pe])}function q(ne,ce){for(var pe=0;pe<ne.length;pe++)ce.writeFixed64(ne[pe])}function W(ne,ce){for(var pe=0;pe<ne.length;pe++)ce.writeSFixed64(ne[pe])}function K(ne,ce){return(ne[ce]|ne[ce+1]<<8|ne[ce+2]<<16)+16777216*ne[ce+3]}function oe(ne,ce,pe){ne[pe]=ce,ne[pe+1]=ce>>>8,ne[pe+2]=ce>>>16,ne[pe+3]=ce>>>24}function se(ne,ce){return(ne[ce]|ne[ce+1]<<8|ne[ce+2]<<16)+(ne[ce+3]<<24)}return n.prototype={destroy:function(){this.buf=null},readFields:function(ne,ce,pe){for(pe=pe||this.length;this.pos<pe;){var we=this.readVarint(),ke=we>>3,Re=this.pos;this.type=7&we,ne(ke,ce,this),this.pos===Re&&this.skip(we)}return ce},readMessage:function(ne,ce){return this.readFields(ne,ce,this.readVarint()+this.pos)},readFixed32:function(){var ne=K(this.buf,this.pos);return this.pos+=4,ne},readSFixed32:function(){var ne=se(this.buf,this.pos);return this.pos+=4,ne},readFixed64:function(){var ne=K(this.buf,this.pos)+K(this.buf,this.pos+4)*s;return this.pos+=8,ne},readSFixed64:function(){var ne=K(this.buf,this.pos)+se(this.buf,this.pos+4)*s;return this.pos+=8,ne},readFloat:function(){var ne=u.read(this.buf,this.pos,!0,23,4);return this.pos+=4,ne},readDouble:function(){var ne=u.read(this.buf,this.pos,!0,52,8);return this.pos+=8,ne},readVarint:function(ne){var ce,pe,we=this.buf;return ce=127&(pe=we[this.pos++]),pe<128?ce:(ce|=(127&(pe=we[this.pos++]))<<7,pe<128?ce:(ce|=(127&(pe=we[this.pos++]))<<14,pe<128?ce:(ce|=(127&(pe=we[this.pos++]))<<21,pe<128?ce:function(ke,Re,Pe){var We,Le,Je=Pe.buf;if(We=(112&(Le=Je[Pe.pos++]))>>4,Le<128||(We|=(127&(Le=Je[Pe.pos++]))<<3,Le<128)||(We|=(127&(Le=Je[Pe.pos++]))<<10,Le<128)||(We|=(127&(Le=Je[Pe.pos++]))<<17,Le<128)||(We|=(127&(Le=Je[Pe.pos++]))<<24,Le<128)||(We|=(1&(Le=Je[Pe.pos++]))<<31,Le<128))return v(ke,We,Re);throw new Error("Expected varint not more than 10 bytes")}(ce|=(15&(pe=we[this.pos]))<<28,ne,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var ne=this.readVarint();return ne%2==1?(ne+1)/-2:ne/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var ne=this.readVarint()+this.pos,ce=this.pos;return this.pos=ne,ne-ce>=12&&y?function(pe,we,ke){return y.decode(pe.subarray(we,ke))}(this.buf,ce,ne):function(pe,we,ke){for(var Re="",Pe=we;Pe<ke;){var We,Le,Je,it=pe[Pe],tt=null,ot=it>239?4:it>223?3:it>191?2:1;if(Pe+ot>ke)break;ot===1?it<128&&(tt=it):ot===2?(192&(We=pe[Pe+1]))==128&&(tt=(31&it)<<6|63&We)<=127&&(tt=null):ot===3?(Le=pe[Pe+2],(192&(We=pe[Pe+1]))==128&&(192&Le)==128&&((tt=(15&it)<<12|(63&We)<<6|63&Le)<=2047||tt>=55296&&tt<=57343)&&(tt=null)):ot===4&&(Le=pe[Pe+2],Je=pe[Pe+3],(192&(We=pe[Pe+1]))==128&&(192&Le)==128&&(192&Je)==128&&((tt=(15&it)<<18|(63&We)<<12|(63&Le)<<6|63&Je)<=65535||tt>=1114112)&&(tt=null)),tt===null?(tt=65533,ot=1):tt>65535&&(tt-=65536,Re+=String.fromCharCode(tt>>>10&1023|55296),tt=56320|1023&tt),Re+=String.fromCharCode(tt),Pe+=ot}return Re}(this.buf,ce,ne)},readBytes:function(){var ne=this.readVarint()+this.pos,ce=this.buf.subarray(this.pos,ne);return this.pos=ne,ce},readPackedVarint:function(ne,ce){if(this.type!==n.Bytes)return ne.push(this.readVarint(ce));var pe=d(this);for(ne=ne||[];this.pos<pe;)ne.push(this.readVarint(ce));return ne},readPackedSVarint:function(ne){if(this.type!==n.Bytes)return ne.push(this.readSVarint());var ce=d(this);for(ne=ne||[];this.pos<ce;)ne.push(this.readSVarint());return ne},readPackedBoolean:function(ne){if(this.type!==n.Bytes)return ne.push(this.readBoolean());var ce=d(this);for(ne=ne||[];this.pos<ce;)ne.push(this.readBoolean());return ne},readPackedFloat:function(ne){if(this.type!==n.Bytes)return ne.push(this.readFloat());var ce=d(this);for(ne=ne||[];this.pos<ce;)ne.push(this.readFloat());return ne},readPackedDouble:function(ne){if(this.type!==n.Bytes)return ne.push(this.readDouble());var ce=d(this);for(ne=ne||[];this.pos<ce;)ne.push(this.readDouble());return ne},readPackedFixed32:function(ne){if(this.type!==n.Bytes)return ne.push(this.readFixed32());var ce=d(this);for(ne=ne||[];this.pos<ce;)ne.push(this.readFixed32());return ne},readPackedSFixed32:function(ne){if(this.type!==n.Bytes)return ne.push(this.readSFixed32());var ce=d(this);for(ne=ne||[];this.pos<ce;)ne.push(this.readSFixed32());return ne},readPackedFixed64:function(ne){if(this.type!==n.Bytes)return ne.push(this.readFixed64());var ce=d(this);for(ne=ne||[];this.pos<ce;)ne.push(this.readFixed64());return ne},readPackedSFixed64:function(ne){if(this.type!==n.Bytes)return ne.push(this.readSFixed64());var ce=d(this);for(ne=ne||[];this.pos<ce;)ne.push(this.readSFixed64());return ne},skip:function(ne){var ce=7&ne;if(ce===n.Varint)for(;this.buf[this.pos++]>127;);else if(ce===n.Bytes)this.pos=this.readVarint()+this.pos;else if(ce===n.Fixed32)this.pos+=4;else{if(ce!==n.Fixed64)throw new Error("Unimplemented type: "+ce);this.pos+=8}},writeTag:function(ne,ce){this.writeVarint(ne<<3|ce)},realloc:function(ne){for(var ce=this.length||16;ce<this.pos+ne;)ce*=2;if(ce!==this.length){var pe=new Uint8Array(ce);pe.set(this.buf),this.buf=pe,this.length=ce}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(ne){this.realloc(4),oe(this.buf,ne,this.pos),this.pos+=4},writeSFixed32:function(ne){this.realloc(4),oe(this.buf,ne,this.pos),this.pos+=4},writeFixed64:function(ne){this.realloc(8),oe(this.buf,-1&ne,this.pos),oe(this.buf,Math.floor(ne*h),this.pos+4),this.pos+=8},writeSFixed64:function(ne){this.realloc(8),oe(this.buf,-1&ne,this.pos),oe(this.buf,Math.floor(ne*h),this.pos+4),this.pos+=8},writeVarint:function(ne){(ne=+ne||0)>268435455||ne<0?function(ce,pe){var we,ke;if(ce>=0?(we=ce%4294967296|0,ke=ce/4294967296|0):(ke=~(-ce/4294967296),4294967295^(we=~(-ce%4294967296))?we=we+1|0:(we=0,ke=ke+1|0)),ce>=18446744073709552e3||ce<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");pe.realloc(10),function(Re,Pe,We){We.buf[We.pos++]=127&Re|128,Re>>>=7,We.buf[We.pos++]=127&Re|128,Re>>>=7,We.buf[We.pos++]=127&Re|128,Re>>>=7,We.buf[We.pos++]=127&Re|128,We.buf[We.pos]=127&(Re>>>=7)}(we,0,pe),function(Re,Pe){var We=(7&Re)<<4;Pe.buf[Pe.pos++]|=We|((Re>>>=3)?128:0),Re&&(Pe.buf[Pe.pos++]=127&Re|((Re>>>=7)?128:0),Re&&(Pe.buf[Pe.pos++]=127&Re|((Re>>>=7)?128:0),Re&&(Pe.buf[Pe.pos++]=127&Re|((Re>>>=7)?128:0),Re&&(Pe.buf[Pe.pos++]=127&Re|((Re>>>=7)?128:0),Re&&(Pe.buf[Pe.pos++]=127&Re)))))}(ke,pe)}(ne,this):(this.realloc(4),this.buf[this.pos++]=127&ne|(ne>127?128:0),ne<=127||(this.buf[this.pos++]=127&(ne>>>=7)|(ne>127?128:0),ne<=127||(this.buf[this.pos++]=127&(ne>>>=7)|(ne>127?128:0),ne<=127||(this.buf[this.pos++]=ne>>>7&127))))},writeSVarint:function(ne){this.writeVarint(ne<0?2*-ne-1:2*ne)},writeBoolean:function(ne){this.writeVarint(!!ne)},writeString:function(ne){ne=String(ne),this.realloc(4*ne.length),this.pos++;var ce=this.pos;this.pos=function(we,ke,Re){for(var Pe,We,Le=0;Le<ke.length;Le++){if((Pe=ke.charCodeAt(Le))>55295&&Pe<57344){if(!We){Pe>56319||Le+1===ke.length?(we[Re++]=239,we[Re++]=191,we[Re++]=189):We=Pe;continue}if(Pe<56320){we[Re++]=239,we[Re++]=191,we[Re++]=189,We=Pe;continue}Pe=We-55296<<10|Pe-56320|65536,We=null}else We&&(we[Re++]=239,we[Re++]=191,we[Re++]=189,We=null);Pe<128?we[Re++]=Pe:(Pe<2048?we[Re++]=Pe>>6|192:(Pe<65536?we[Re++]=Pe>>12|224:(we[Re++]=Pe>>18|240,we[Re++]=Pe>>12&63|128),we[Re++]=Pe>>6&63|128),we[Re++]=63&Pe|128)}return Re}(this.buf,ne,this.pos);var pe=this.pos-ce;pe>=128&&M(ce,pe,this),this.pos=ce-1,this.writeVarint(pe),this.pos+=pe},writeFloat:function(ne){this.realloc(4),u.write(this.buf,ne,this.pos,!0,23,4),this.pos+=4},writeDouble:function(ne){this.realloc(8),u.write(this.buf,ne,this.pos,!0,52,8),this.pos+=8},writeBytes:function(ne){var ce=ne.length;this.writeVarint(ce),this.realloc(ce);for(var pe=0;pe<ce;pe++)this.buf[this.pos++]=ne[pe]},writeRawMessage:function(ne,ce){this.pos++;var pe=this.pos;ne(ce,this);var we=this.pos-pe;we>=128&&M(pe,we,this),this.pos=pe-1,this.writeVarint(we),this.pos+=we},writeMessage:function(ne,ce,pe){this.writeTag(ne,n.Bytes),this.writeRawMessage(ce,pe)},writePackedVarint:function(ne,ce){ce.length&&this.writeMessage(ne,k,ce)},writePackedSVarint:function(ne,ce){ce.length&&this.writeMessage(ne,j,ce)},writePackedBoolean:function(ne,ce){ce.length&&this.writeMessage(ne,B,ce)},writePackedFloat:function(ne,ce){ce.length&&this.writeMessage(ne,E,ce)},writePackedDouble:function(ne,ce){ce.length&&this.writeMessage(ne,D,ce)},writePackedFixed32:function(ne,ce){ce.length&&this.writeMessage(ne,R,ce)},writePackedSFixed32:function(ne,ce){ce.length&&this.writeMessage(ne,z,ce)},writePackedFixed64:function(ne,ce){ce.length&&this.writeMessage(ne,q,ce)},writePackedSFixed64:function(ne,ce){ce.length&&this.writeMessage(ne,W,ce)},writeBytesField:function(ne,ce){this.writeTag(ne,n.Bytes),this.writeBytes(ce)},writeFixed32Field:function(ne,ce){this.writeTag(ne,n.Fixed32),this.writeFixed32(ce)},writeSFixed32Field:function(ne,ce){this.writeTag(ne,n.Fixed32),this.writeSFixed32(ce)},writeFixed64Field:function(ne,ce){this.writeTag(ne,n.Fixed64),this.writeFixed64(ce)},writeSFixed64Field:function(ne,ce){this.writeTag(ne,n.Fixed64),this.writeSFixed64(ce)},writeVarintField:function(ne,ce){this.writeTag(ne,n.Varint),this.writeVarint(ce)},writeSVarintField:function(ne,ce){this.writeTag(ne,n.Varint),this.writeSVarint(ce)},writeStringField:function(ne,ce){this.writeTag(ne,n.Bytes),this.writeString(ce)},writeFloatField:function(ne,ce){this.writeTag(ne,n.Fixed32),this.writeFloat(ce)},writeDoubleField:function(ne,ce){this.writeTag(ne,n.Fixed64),this.writeDouble(ce)},writeBooleanField:function(ne,ce){this.writeVarintField(ne,!!ce)}},Up}var _=P(f());const A=3;function F(u,n,s){n.glyphs=[],u===1&&s.readMessage(Y,n)}function Y(u,n,s){if(u===3){const{id:h,bitmap:y,width:d,height:v,left:M,top:k,advance:j}=s.readMessage(re,{});n.glyphs.push({id:h,bitmap:new _h({width:d+2*A,height:v+2*A},y),metrics:{width:d,height:v,left:M,top:k,advance:j}})}else u===4?n.ascender=s.readSVarint():u===5&&(n.descender=s.readSVarint())}function re(u,n,s){u===1?n.id=s.readVarint():u===2?n.bitmap=s.readBytes():u===3?n.width=s.readVarint():u===4?n.height=s.readVarint():u===5?n.left=s.readSVarint():u===6?n.top=s.readSVarint():u===7&&(n.advance=s.readVarint())}const Me=A,Ge={horizontal:1,vertical:2,horizontalOnly:3};class dt{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(n,s){const h=new dt;return h.scale=n||1,h.fontStack=s,h}static forImage(n){const s=new dt;return s.image=n,s}}class Nt{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,s){const h=new Nt;for(let y=0;y<n.sections.length;y++){const d=n.sections[y];d.image?h.addImageSection(d):h.addTextSection(d,s)}return h}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSections(){return this.sections}getSectionIndex(n){return this.sectionIndex[n]}getCodePoint(n){return this.text.codePointAt(n)}verticalizePunctuation(n){this.text=function(s,h){let y="";for(let d=0;d<s.length;d++){const v=s.charCodeAt(d+1)||null,M=s.charCodeAt(d-1)||null;y+=!h&&(v&&Bu(v)&&!Af[s[d+1]]||M&&Bu(M)&&!Af[s[d-1]])||!Af[s[d]]?s[d]:Af[s[d]]}return y}(this.text,n)}trim(){let n=0;for(let h=0;h<this.text.length&&Dn[this.text.charCodeAt(h)];h++)n++;let s=this.text.length;for(let h=this.text.length-1;h>=0&&h>=n&&Dn[this.text.charCodeAt(h)];h--)s--;this.text=this.text.substring(n,s),this.sectionIndex=this.sectionIndex.slice(n,s)}substring(n,s){const h=new Nt;return h.text=this.text.substring(n,s),h.sectionIndex=this.sectionIndex.slice(n,s),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,s)=>Math.max(n,this.sections[s].scale),0)}addTextSection(n,s){this.text+=n.text,this.sections.push(dt.forText(n.scale,n.fontStack||s));const h=this.sections.length-1;for(let y=0;y<n.text.length;++y)this.sectionIndex.push(h)}addImageSection(n){const s=n.image&&n.image.namePrimary?n.image.getPrimary():null;if(!s)return void lr("Can't add FormattedSection with an empty image.");const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCodePoint(h),this.sections.push(dt.forImage(s)),this.sectionIndex.push(this.sections.length-1)):lr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function yn(u,n,s,h,y,d,v,M,k,j,E,D,B,R,z){const q=Nt.fromFeature(u,y);D===Ge.vertical&&q.verticalizePunctuation(B);let W=[];const K=function(pe,we,ke,Re,Pe,We){if(!pe)return[];const Le=[],Je=function(ut,pt,lt,Lt,Wt,Rt){let xn=0;for(let mn=0;mn<ut.length();mn++){const on=ut.getSection(mn);xn+=gn(ut.getCodePoint(mn),on,Lt,Wt,pt,Rt)}return xn/Math.max(1,Math.ceil(xn/lt))}(pe,we,ke,Re,Pe,We),it=pe.text.indexOf("")>=0;let tt=0;for(let ut=0;ut<pe.length();ut++){const pt=pe.getSection(ut),lt=pe.getCodePoint(ut);if(Dn[lt]||(tt+=gn(lt,pt,Re,Pe,we,We)),ut<pe.length()-1){const Lt=!((ot=lt)<11904||!(dn["Bopomofo Extended"](ot)||dn.Bopomofo(ot)||dn["CJK Compatibility Forms"](ot)||dn["CJK Compatibility Ideographs"](ot)||dn["CJK Compatibility"](ot)||dn["CJK Radicals Supplement"](ot)||dn["CJK Strokes"](ot)||dn["CJK Symbols and Punctuation"](ot)||dn["CJK Unified Ideographs Extension A"](ot)||dn["CJK Unified Ideographs"](ot)||dn["Enclosed CJK Letters and Months"](ot)||dn["Halfwidth and Fullwidth Forms"](ot)||dn.Hiragana(ot)||dn["Ideographic Description Characters"](ot)||dn["Kangxi Radicals"](ot)||dn["Katakana Phonetic Extensions"](ot)||dn.Katakana(ot)||dn["Vertical Forms"](ot)||dn["Yi Radicals"](ot)||dn["Yi Syllables"](ot)));(rn[lt]||Lt||pt.image)&&Le.push(ja(ut+1,tt,Je,Le,ni(lt,pe.getCodePoint(ut+1),Lt&&it),!1))}}var ot;return Gt(ja(pe.length(),tt,Je,Le,0,!0))}(q,j,d,n,h,R),{processBidirectionalText:oe,processStyledBidirectionalText:se}=Ii;if(oe&&q.sections.length===1){const pe=oe(q.toString(),K);for(const we of pe){const ke=new Nt;ke.text=we,ke.sections=q.sections;for(let Re=0;Re<we.length;Re++)ke.sectionIndex.push(0);W.push(ke)}}else if(se){const pe=se(q.text,q.sectionIndex,K);for(const we of pe){const ke=new Nt;ke.text=we[0],ke.sectionIndex=we[1],ke.sections=q.sections,W.push(ke)}}else W=function(pe,we){const ke=[],Re=pe.text;let Pe=0;for(const We of we)ke.push(pe.substring(Pe,We)),Pe=We;return Pe<Re.length&&ke.push(pe.substring(Pe,Re.length)),ke}(q,K);const ne=[],ce={positionedLines:ne,text:q.toString(),top:E[1],bottom:E[1],left:E[0],right:E[0],writingMode:D,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(pe,we,ke,Re,Pe,We,Le,Je,it,tt,ot,ut){let pt=0,lt=0,Lt=0;const Wt=Je==="right"?1:Je==="left"?0:.5;let Rt=!1;for(const Tn of Pe){const Pn=Tn.getSections();for(const ir of Pn){if(ir.image)continue;const gr=we[ir.fontStack];if(gr&&(Rt=gr.ascender!==void 0&&gr.descender!==void 0,!Rt))break}if(!Rt)break}let xn=0;for(const Tn of Pe){Tn.trim();const Pn=Tn.getMaxScale(),ir=(Pn-1)*bo,gr={positionedGlyphs:[],lineOffset:0};pe.positionedLines[xn]=gr;const wr=gr.positionedGlyphs;let Sr=0;if(!Tn.length()){lt+=We,++xn;continue}let kr=0,Lr=0;for(let si=0;si<Tn.length();si++){const cr=Tn.getSection(si),ai=Tn.getSectionIndex(si),oi=Tn.getCodePoint(si);let Fi=cr.scale,va=null,Va=null,xa=null,ha=bo,ka=0;const Qa=!(it===Ge.horizontal||!ot&&!Nu(oi)||ot&&(Dn[oi]||(mn=oi,dn.Arabic(mn)||dn["Arabic Supplement"](mn)||dn["Arabic Extended-A"](mn)||dn["Arabic Presentation Forms-A"](mn)||dn["Arabic Presentation Forms-B"](mn))));if(cr.image){const is=Re[cr.image.serialize()];if(!is)continue;xa=cr.image.id,pe.iconsInText=pe.iconsInText||!0,Va=is.paddedRect;const Li=is.displaySize;Fi=Fi*bo/ut,va={width:Li[0],height:Li[1],left:0,top:-3,advance:Qa?Li[1]:Li[0],localGlyph:!1},ka=Rt?-va.height*Fi:Pn*bo-17-Li[1]*Fi,ha=va.advance;const Gl=(Qa?Li[0]:Li[1])*Fi-bo*Pn;Gl>0&&Gl>Sr&&(Sr=Gl)}else{const is=ke[cr.fontStack];if(!is)continue;is[oi]&&(Va=is[oi]);const Li=we[cr.fontStack];if(!Li)continue;const Gl=Li.glyphs[oi];if(!Gl)continue;if(va=Gl.metrics,ha=oi!==8203?bo:0,Rt){const Eh=Li.ascender!==void 0?Math.abs(Li.ascender):0,zc=Li.descender!==void 0?Math.abs(Li.descender):0,Nc=(Eh+zc)*Fi;kr<Nc&&(kr=Nc,Lr=(Eh-zc)/2*Fi),ka=-Eh*Fi}else ka=(Pn-Fi)*bo-17}Qa?(pe.verticalizable=!0,wr.push({glyph:oi,imageName:xa,x:pt,y:lt+ka,vertical:Qa,scale:Fi,localGlyph:va.localGlyph,fontStack:cr.fontStack,sectionIndex:ai,metrics:va,rect:Va}),pt+=ha*Fi+tt):(wr.push({glyph:oi,imageName:xa,x:pt,y:lt+ka,vertical:Qa,scale:Fi,localGlyph:va.localGlyph,fontStack:cr.fontStack,sectionIndex:ai,metrics:va,rect:Va}),pt+=va.advance*Fi+tt)}wr.length!==0&&(Lt=Math.max(pt-tt,Lt),Rt?Kt(wr,Wt,Sr,Lr,We*Pn/2):Kt(wr,Wt,Sr,0,We/2)),pt=0;const Ai=We*Pn+Sr;gr.lineOffset=Math.max(Sr,ir),lt+=Ai,++xn}var mn;const on=lt,{horizontalAlign:en,verticalAlign:zn}=Pt(Le);(function(Tn,Pn,ir,gr,wr,Sr){const kr=(Pn-ir)*wr,Lr=-Sr*gr;for(const Ai of Tn)for(const si of Ai.positionedGlyphs)si.x+=kr,si.y+=Lr})(pe.positionedLines,Wt,en,zn,Lt,on),pe.top+=-zn*on,pe.bottom=pe.top+on,pe.left+=-en*Lt,pe.right=pe.left+Lt,pe.hasBaseline=Rt}(ce,n,s,h,W,v,M,k,D,j,B,z),!function(pe){for(const we of pe)if(we.positionedGlyphs.length!==0)return!1;return!0}(ne)&&ce}const Dn={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},rn={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function gn(u,n,s,h,y,d){if(n.image){const v=h[n.image.serialize()];return v?v.displaySize[0]*n.scale*bo/d+y:0}{const v=s[n.fontStack],M=v&&v.glyphs[u];return M?M.metrics.advance*n.scale+y:0}}function br(u,n,s,h){const y=Math.pow(u-n,2);return h?u<n?y/2:2*y:y+Math.abs(s)*s}function ni(u,n,s){let h=0;return u===10&&(h-=1e4),s&&(h+=150),u!==40&&u!==65288||(h+=50),n!==41&&n!==65289||(h+=50),h}function ja(u,n,s,h,y,d){let v=null,M=br(n,s,y,d);for(const k of h){const j=br(n-k.x,s,y,d)+k.badness;j<=M&&(v=k,M=j)}return{index:u,x:n,priorBreak:v,badness:M}}function Gt(u){return u?Gt(u.priorBreak).concat(u.index):[]}function Pt(u){let n=.5,s=.5;switch(u){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:n,verticalAlign:s}}function Kt(u,n,s,h,y){if(!(n||s||h||y))return;const d=u.length-1,v=u[d],M=(v.x+v.metrics.advance*v.scale)*n;for(let k=0;k<=d;k++)u[k].x-=M,u[k].y+=s+h+y}function On(u,n,s,h){const{horizontalAlign:y,verticalAlign:d}=Pt(h),v=s[0]-u.displaySize[0]*y,M=s[1]-u.displaySize[1]*d;return{imagePrimary:u,imageSecondary:n,top:M,bottom:M+u.displaySize[1],left:v,right:v+u.displaySize[0]}}function fr(u,n,s,h,y,d){const v=u.imagePrimary;let M;if(v.content){const W=v.content,K=v.pixelRatio||1;M=[W[0]/K,W[1]/K,v.displaySize[0]-W[2]/K,v.displaySize[1]-W[3]/K]}const k=n.left*d,j=n.right*d;let E,D,B,R;s==="width"||s==="both"?(R=y[0]+k-h[3],D=y[0]+j+h[1]):(R=y[0]+(k+j-v.displaySize[0])/2,D=R+v.displaySize[0]);const z=n.top*d,q=n.bottom*d;return s==="height"||s==="both"?(E=y[1]+z-h[0],B=y[1]+q+h[2]):(E=y[1]+(z+q-v.displaySize[1])/2,B=E+v.displaySize[1]),{imagePrimary:v,imageSecondary:void 0,top:E,right:D,bottom:B,left:R,collisionPadding:M}}class Zr extends $t{constructor(n,s,h,y,d){super(n,s),this.angle=y,this.z=h,d!==void 0&&(this.segment=d)}clone(){return new Zr(this.x,this.y,this.z,this.angle,this.segment)}}function Mr(u,n,s,h,y){if(n.segment===void 0)return!0;let d=n,v=n.segment+1,M=0;for(;M>-s/2;){if(v--,v<0)return!1;M-=u[v].dist(d),d=u[v]}M+=u[v].dist(u[v+1]),v++;const k=[];let j=0;for(;M<s/2;){const E=u[v],D=u[v+1];if(!D)return!1;let B=u[v-1].angleTo(E)-E.angleTo(D);for(B=Math.abs((B+3*Math.PI)%(2*Math.PI)-Math.PI),k.push({distance:M,angleDelta:B}),j+=B;M-k[0].distance>h;)j-=k.shift().angleDelta;if(j>y)return!1;v++,M+=E.dist(D)}return!0}function Fr(u){let n=0;for(let s=0;s<u.length-1;s++)n+=u[s].dist(u[s+1]);return n}function ko(u,n,s){return u?.6*n*s:0}function Di(u,n){return Math.max(u?u.right-u.left:0,n?n.right-n.left:0)}function Mf(u,n,s,h,y,d){const v=ko(s,y,d),M=Di(s,h)*d;let k=0;const j=Fr(u)/2;for(let E=0;E<u.length-1;E++){const D=u[E],B=u[E+1],R=D.dist(B);if(k+R>j){const z=(j-k)/R,q=Nn(D.x,B.x,z),W=Nn(D.y,B.y,z),K=new Zr(q,W,0,B.angleTo(D),E);return!v||Mr(u,K,M,v,n)?K:void 0}k+=R}}function X2(u,n,s,h,y,d,v,M,k){const j=ko(h,d,v),E=Di(h,y),D=E*v,B=u[0].x===0||u[0].x===k||u[0].y===0||u[0].y===k;return n-D<n/4&&(n=D+n/4),yR(u,B?n/2*M%n:(E/2+2*d)*v*M%n,n,j,s,D,B,!1,k)}function yR(u,n,s,h,y,d,v,M,k){const j=d/2,E=Fr(u);let D=0,B=n-s,R=[];for(let z=0;z<u.length-1;z++){const q=u[z],W=u[z+1],K=q.dist(W),oe=W.angleTo(q);for(;B+s<D+K;){B+=s;const se=(B-D)/K,ne=Nn(q.x,W.x,se),ce=Nn(q.y,W.y,se);if(ne>=0&&ne<k&&ce>=0&&ce<k&&B-j>=0&&B+j<=E){const pe=new Zr(ne,ce,0,oe,z);h&&!Mr(u,pe,d,h,y)||R.push(pe)}}D+=K}return M||R.length||v||(R=yR(u,D/2,s,h,y,d,v,!0,k)),R}function _R(u,n,s,h,y){const d=[];for(let v=0;v<u.length;v++){const M=u[v];let k;for(let j=0;j<M.length-1;j++){let E=M[j],D=M[j+1];E.x<n&&D.x<n||(E.x<n?E=new $t(n,E.y+(n-E.x)/(D.x-E.x)*(D.y-E.y))._round():D.x<n&&(D=new $t(n,E.y+(n-E.x)/(D.x-E.x)*(D.y-E.y))._round()),E.y<s&&D.y<s||(E.y<s?E=new $t(E.x+(s-E.y)/(D.y-E.y)*(D.x-E.x),s)._round():D.y<s&&(D=new $t(E.x+(s-E.y)/(D.y-E.y)*(D.x-E.x),s)._round()),E.x>=h&&D.x>=h||(E.x>=h?E=new $t(h,E.y+(h-E.x)/(D.x-E.x)*(D.y-E.y))._round():D.x>=h&&(D=new $t(h,E.y+(h-E.x)/(D.x-E.x)*(D.y-E.y))._round()),E.y>=y&&D.y>=y||(E.y>=y?E=new $t(E.x+(y-E.y)/(D.y-E.y)*(D.x-E.x),y)._round():D.y>=y&&(D=new $t(E.x+(y-E.y)/(D.y-E.y)*(D.x-E.x),y)._round()),k&&E.equals(k[k.length-1])||(k=[E],d.push(k)),k.push(D)))))}}return d}function vR(u){let n=0,s=0;for(const v of u)n+=v.w*v.h,s=Math.max(s,v.w);u.sort((v,M)=>M.h-v.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),s),h:1/0}];let y=0,d=0;for(const v of u)for(let M=h.length-1;M>=0;M--){const k=h[M];if(!(v.w>k.w||v.h>k.h)){if(v.x=k.x,v.y=k.y,d=Math.max(d,v.y+v.h),y=Math.max(y,v.x+v.w),v.w===k.w&&v.h===k.h){const j=h.pop();M<h.length&&(h[M]=j)}else v.h===k.h?(k.x+=v.w,k.w-=v.w):v.w===k.w?(k.y+=v.h,k.h-=v.h):(h.push({x:k.x+v.w,y:k.y,w:k.w-v.w,h:v.h}),k.y+=v.h,k.h-=v.h);break}}return{w:y,h:d,fill:n/(y*d)||0}}In(Zr,"Anchor");const Sv=1;class Tv{static getImagePositionScale(n,s,h){return s&&n&&n.options&&n.options.transform?{x:n.options.transform.a,y:n.options.transform.d}:{x:h,y:h}}constructor(n,{pixelRatio:s,version:h,stretchX:y,stretchY:d,content:v,sdf:M,usvg:k},j,E){this.paddedRect=n,this.pixelRatio=s,this.stretchX=y,this.stretchY=d,this.content=v,this.version=h,this.padding=j,this.sdf=M,this.scale=Tv.getImagePositionScale(E,k,s)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}class xR{constructor(n,s,h){const y={},d={};this.haveRenderCallbacks=[];const v=[];this.addImages(n,y,Sv,v),this.addImages(s,d,2,v);const{w:M,h:k}=vR(v),j=new co({width:M||1,height:k||1});for(const E in n){const D=n[E],B=y[E].paddedRect;co.copy(D.data,j,{x:0,y:0},{x:B.x+Sv,y:B.y+Sv},D.data,h,D.sdf)}for(const E in s){const D=s[E],B=d[E].paddedRect;let R=d[E].padding;const z=B.x+R,q=B.y+R,W=D.data.width,K=D.data.height;R=R>1?R-1:R,co.copy(D.data,j,{x:0,y:0},{x:z,y:q},D.data,h),co.copy(D.data,j,{x:0,y:K-R},{x:z,y:q-R},{width:W,height:R},h),co.copy(D.data,j,{x:0,y:0},{x:z,y:q+K},{width:W,height:R},h),co.copy(D.data,j,{x:W-R,y:0},{x:z-R,y:q},{width:R,height:K},h),co.copy(D.data,j,{x:0,y:0},{x:z+W,y:q},{width:R,height:K},h),co.copy(D.data,j,{x:W-R,y:K-R},{x:z-R,y:q-R},{width:R,height:R},h),co.copy(D.data,j,{x:0,y:K-R},{x:z+W,y:q-R},{width:R,height:R},h),co.copy(D.data,j,{x:0,y:0},{x:z+W,y:q+K},{width:R,height:R},h),co.copy(D.data,j,{x:W-R,y:0},{x:z-R,y:q+K},{width:R,height:R},h)}this.lut=h,this.image=j,this.iconPositions=y,this.patternPositions=d}addImages(n,s,h,y){for(const d in n){const v=n[d],M={x:0,y:0,w:v.data.width+2*h,h:v.data.height+2*h};y.push(M);const k=da.deserializeFromString(d);s[d]=new Tv(M,v,h,k),v.hasRenderCallback&&this.haveRenderCallbacks.push(k.id)}}patchUpdatedImages(n,s,h){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(y=>n.hasImage(y,h)),n.dispatchRenderCallbacks(this.haveRenderCallbacks,h);for(const y in n.getUpdatedImages(h)){for(const d of Object.keys(this.iconPositions))da.deserializeId(d)===y&&this.patchUpdatedImage(this.iconPositions[d],n.getImage(y,h),s);for(const d of Object.keys(this.patternPositions))da.deserializeId(d)===y&&this.patchUpdatedImage(this.patternPositions[d],n.getImage(y,h),s)}}patchUpdatedImage(n,s,h){if(!n||!s||n.version===s.version)return;n.version=s.version;const[y,d]=n.tl,v=n.sdf;if(this.lut||v){const M={width:s.data.width,height:s.data.height},k=new co(M);co.copy(s.data,k,{x:0,y:0},{x:0,y:0},M,this.lut,v),h.update(k,{position:{x:y,y:d}})}else h.update(s.data,{position:{x:y,y:d}})}}In(Tv,"ImagePosition"),In(xR,"ImageAtlas");const c1=1e20;function bR(u,n,s,h,y,d,v,M,k){for(let j=n;j<n+h;j++)wR(u,s*d+j,d,y,v,M,k);for(let j=s;j<s+y;j++)wR(u,j*d+n,1,h,v,M,k)}function wR(u,n,s,h,y,d,v){d[0]=0,v[0]=-1e20,v[1]=c1,y[0]=u[n];for(let M=1,k=0,j=0;M<h;M++){y[M]=u[n+M*s];const E=M*M;do{const D=d[k];j=(y[M]-y[D]+E-D*D)/(M-D)/2}while(j<=v[k]&&--k>-1);k++,d[k]=M,v[k]=j,v[k+1]=c1}for(let M=0,k=0;M<h;M++){for(;v[k+1]<M;)k++;const j=d[k],E=M-j;u[n+M*s]=y[j]+E*E}}const bh=2,Y2={none:0,ideographs:1,all:2};class wy{constructor(n,s,h){this.requestManager=n,this.localGlyphMode=s,this.localFontFamily=h,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(n,s){this.urls[s]=n}getGlyphs(n,s,h){const y=[],d=this.urls[s]||Mi.GLYPHS_URL;for(const v in n)for(const M of n[v])y.push({stack:v,id:M});Ds(y,({stack:v,id:M},k)=>{let j=this.entries[v];j||(j=this.entries[v]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let E=j.glyphs[M];if(E!==void 0)return void k(null,{stack:v,id:M,glyph:E});if(E=this._tinySDF(j,v,M),E)return j.glyphs[M]=E,void k(null,{stack:v,id:M,glyph:E});const D=Math.floor(M/256);if(256*D>65535)return lr("glyphs > 65535 not supported"),void k(null,{stack:v,id:M,glyph:E});if(j.ranges[D])return void k(null,{stack:v,id:M,glyph:E});let B=j.requests[D];B||(B=j.requests[D]=[],wy.loadGlyphRange(v,D,d,this.requestManager,(R,z)=>{if(z){j.ascender=z.ascender,j.descender=z.descender;for(const q in z.glyphs)this._doesCharSupportLocalGlyph(+q)||(j.glyphs[+q]=z.glyphs[+q]);j.ranges[D]=!0}for(const q of B)q(R,z);delete j.requests[D]})),B.push((R,z)=>{R?k(R):z&&k(null,{stack:v,id:M,glyph:z.glyphs[M]||null})})},(v,M)=>{if(v)h(v);else if(M){const k={};for(const{stack:j,id:E,glyph:D}of M)k[j]===void 0&&(k[j]={}),k[j].glyphs===void 0&&(k[j].glyphs={}),k[j].glyphs[E]=D&&{id:D.id,bitmap:D.bitmap.clone(),metrics:D.metrics},k[j].ascender=this.entries[j].ascender,k[j].descender=this.entries[j].descender;h(null,k)}})}_doesCharSupportLocalGlyph(n){return this.localGlyphMode!==Y2.none&&(this.localGlyphMode===Y2.all?!!this.localFontFamily:!!this.localFontFamily&&(dn["CJK Unified Ideographs"](n)||dn["Hangul Syllables"](n)||dn.Hiragana(n)||dn.Katakana(n)||dn["CJK Symbols and Punctuation"](n)||dn["CJK Unified Ideographs Extension A"](n)||dn["CJK Unified Ideographs Extension B"](n)||dn.Osage(n)))}_tinySDF(n,s,h){const y=this.localFontFamily;if(!y||!this._doesCharSupportLocalGlyph(h))return;let d=n.tinySDF;if(!d){let q="400";/bold/i.test(s)?q="900":/medium/i.test(s)?q="500":/light/i.test(s)&&(q="200"),d=n.tinySDF=new wy.TinySDF({fontFamily:y,fontWeight:q,fontSize:24*bh,buffer:3*bh,radius:8*bh}),d.fontWeight=q}if(this.localGlyphs[d.fontWeight][h])return this.localGlyphs[d.fontWeight][h];const v=String.fromCodePoint(h),{data:M,width:k,height:j,glyphWidth:E,glyphHeight:D,glyphLeft:B,glyphTop:R,glyphAdvance:z}=d.draw(v);return this.localGlyphs[d.fontWeight][h]={id:h,bitmap:new _h({width:k,height:j},M),metrics:{width:E/bh,height:D/bh,left:B/bh,top:R/bh-27,advance:z/bh,localGlyph:!0}}}}wy.loadGlyphRange=function(u,n,s,h,y){const d=256*n,v=d+255,M=h.transformRequest(h.normalizeGlyphsURL(s).replace("{fontstack}",u).replace("{range}",`${d}-${v}`),Nr.Glyphs);Ri(M,(k,j)=>{if(k)y(k);else if(j){const E={},D=function(B){return new _(B).readFields(F,{})}(j);for(const B of D.glyphs)E[B.id]=B;y(null,{glyphs:E,ascender:D.ascender,descender:D.descender})}})},wy.TinySDF=class{constructor({fontSize:u=24,buffer:n=3,radius:s=8,cutoff:h=.25,fontFamily:y="sans-serif",fontWeight:d="normal",fontStyle:v="normal"}={}){this.buffer=n,this.cutoff=h,this.radius=s;const M=this.size=u+4*n,k=this._createCanvas(M),j=this.ctx=k.getContext("2d",{willReadFrequently:!0});j.font=`${v} ${d} ${u}px ${y}`,j.textBaseline="alphabetic",j.textAlign="left",j.fillStyle="black",this.gridOuter=new Float64Array(M*M),this.gridInner=new Float64Array(M*M),this.f=new Float64Array(M),this.z=new Float64Array(M+1),this.v=new Uint16Array(M)}_createCanvas(u){const n=document.createElement("canvas");return n.width=n.height=u,n}draw(u){const{width:n,actualBoundingBoxAscent:s,actualBoundingBoxDescent:h,actualBoundingBoxLeft:y,actualBoundingBoxRight:d}=this.ctx.measureText(u),v=Math.ceil(s),M=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(d-y))),k=Math.min(this.size-this.buffer,v+Math.ceil(h)),j=M+2*this.buffer,E=k+2*this.buffer,D=Math.max(j*E,0),B=new Uint8ClampedArray(D),R={data:B,width:j,height:E,glyphWidth:M,glyphHeight:k,glyphTop:v,glyphLeft:0,glyphAdvance:n};if(M===0||k===0)return R;const{ctx:z,buffer:q,gridInner:W,gridOuter:K}=this;z.clearRect(q,q,M,k),z.fillText(u,q,q+v);const oe=z.getImageData(q,q,M,k);K.fill(c1,0,D),W.fill(0,0,D);for(let se=0;se<k;se++)for(let ne=0;ne<M;ne++){const ce=oe.data[4*(se*M+ne)+3]/255;if(ce===0)continue;const pe=(se+q)*j+ne+q;if(ce===1)K[pe]=0,W[pe]=c1;else{const we=.5-ce;K[pe]=we>0?we*we:0,W[pe]=we<0?we*we:0}}bR(K,0,0,j,E,j,this.f,this.v,this.z),bR(W,q,q,M,k,j,this.f,this.v,this.z);for(let se=0;se<D;se++){const ne=Math.sqrt(K[se])-Math.sqrt(W[se]);B[se]=Math.round(255-255*(ne/this.radius+this.cutoff))}return R}};const Wm=Sv;function SR(u,n){return u+n[1]-n[0]}function TR(u,n,s,h,y=1){const d=[],v=u.imagePrimary,M=v.pixelRatio,k=v.paddedRect.w-2*Wm,j=v.paddedRect.h-2*Wm,E=(u.right-u.left)*y,D=(u.bottom-u.top)*y,B=v.stretchX||[[0,k]],R=v.stretchY||[[0,j]],z=B.reduce(SR,0),q=R.reduce(SR,0),W=k-z,K=j-q;let oe=0,se=z,ne=0,ce=q,pe=0,we=W,ke=0,Re=K;if(v.content&&h){const We=v.content;oe=h1(B,0,We[0]),ne=h1(R,0,We[1]),se=h1(B,We[0],We[2]),ce=h1(R,We[1],We[3]),pe=We[0]-oe,ke=We[1]-ne,we=We[2]-We[0]-se,Re=We[3]-We[1]-ce}const Pe=(We,Le,Je,it)=>{const tt=f1(We.stretch-oe,se,E,u.left*y),ot=d1(We.fixed-pe,we,We.stretch,z),ut=f1(Le.stretch-ne,ce,D,u.top*y),pt=d1(Le.fixed-ke,Re,Le.stretch,q),lt=f1(Je.stretch-oe,se,E,u.left*y),Lt=d1(Je.fixed-pe,we,Je.stretch,z),Wt=f1(it.stretch-ne,ce,D,u.top*y),Rt=d1(it.fixed-ke,Re,it.stretch,q),xn=new $t(tt,ut),mn=new $t(lt,ut),on=new $t(lt,Wt),en=new $t(tt,Wt),zn=new $t(ot/M,pt/M),Tn=new $t(Lt/M,Rt/M),Pn=n*Math.PI/180;if(Pn){const Lr=Math.sin(Pn),Ai=Math.cos(Pn),si=[Ai,-Lr,Lr,Ai];xn._matMult(si),mn._matMult(si),en._matMult(si),on._matMult(si)}const ir=We.stretch+We.fixed,gr=Je.stretch+Je.fixed,wr=Le.stretch+Le.fixed,Sr=it.stretch+it.fixed,kr=u.imageSecondary;return{tl:xn,tr:mn,bl:en,br:on,texPrimary:{x:v.paddedRect.x+Wm+ir,y:v.paddedRect.y+Wm+wr,w:gr-ir,h:Sr-wr},texSecondary:kr?{x:kr.paddedRect.x+Wm+ir,y:kr.paddedRect.y+Wm+wr,w:gr-ir,h:Sr-wr}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:zn,pixelOffsetBR:Tn,minFontScaleX:we/M/E,minFontScaleY:Re/M/D,isSDF:s}};if(h&&(v.stretchX||v.stretchY)){const We=ER(B,W,z),Le=ER(R,K,q);for(let Je=0;Je<We.length-1;Je++){const it=We[Je],tt=We[Je+1];for(let ot=0;ot<Le.length-1;ot++)d.push(Pe(it,Le[ot],tt,Le[ot+1]))}}else d.push(Pe({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:k+1},{fixed:0,stretch:j+1}));return d}function h1(u,n,s){let h=0;for(const y of u)h+=Math.max(n,Math.min(s,y[1]))-Math.max(n,Math.min(s,y[0]));return h}function ER(u,n,s){const h=[{fixed:-1,stretch:0}];for(const[y,d]of u){const v=h[h.length-1];h.push({fixed:y-v.stretch,stretch:v.stretch}),h.push({fixed:y-v.stretch,stretch:v.stretch+(d-y)})}return h.push({fixed:n+Wm,stretch:s}),h}function f1(u,n,s,h){return u/n*s+h}function d1(u,n,s,h){return u-n*s/h}function N7(u,n,s,h){const y=n+u.positionedLines[h].lineOffset;return h===0?s+y/2:s+(y+(n+u.positionedLines[h-1].lineOffset))/2}function B7(u,n=1,s=!1){let h=1/0,y=1/0,d=-1/0,v=-1/0;const M=u[0];for(let R=0;R<M.length;R++){const z=M[R];(!R||z.x<h)&&(h=z.x),(!R||z.y<y)&&(y=z.y),(!R||z.x>d)&&(d=z.x),(!R||z.y>v)&&(v=z.y)}const k=Math.min(d-h,v-y);let j=k/2;const E=new Ma([],F7);if(k===0)return new $t(h,y);for(let R=h;R<d;R+=k)for(let z=y;z<v;z+=k)E.push(new Sy(R+j,z+j,j,u));let D=function(R){let z=0,q=0,W=0;const K=R[0];for(let oe=0,se=K.length,ne=se-1;oe<se;ne=oe++){const ce=K[oe],pe=K[ne],we=ce.x*pe.y-pe.x*ce.y;q+=(ce.x+pe.x)*we,W+=(ce.y+pe.y)*we,z+=3*we}return new Sy(q/z,W/z,0,R)}(u),B=E.length;for(;E.length;){const R=E.pop();(R.d>D.d||!D.d)&&(D=R,s&&console.log("found best %d after %d probes",Math.round(1e4*R.d)/1e4,B)),R.max-D.d<=n||(j=R.h/2,E.push(new Sy(R.p.x-j,R.p.y-j,j,u)),E.push(new Sy(R.p.x+j,R.p.y-j,j,u)),E.push(new Sy(R.p.x-j,R.p.y+j,j,u)),E.push(new Sy(R.p.x+j,R.p.y+j,j,u)),B+=4)}return s&&(console.log(`num probes: ${B}`),console.log(`best distance: ${D.d}`)),D.p}function F7(u,n){return n.max-u.max}class Sy{constructor(n,s,h,y){this.p=new $t(n,s),this.h=h,this.d=function(d,v){let M=!1,k=1/0;for(let j=0;j<v.length;j++){const E=v[j];for(let D=0,B=E.length,R=B-1;D<B;R=D++){const z=E[D],q=E[R];z.y>d.y!=q.y>d.y&&d.x<(q.x-z.x)*(d.y-z.y)/(q.y-z.y)+z.x&&(M=!M),k=Math.min(k,je(d,z,q))}}return(M?1:-1)*Math.sqrt(k)}(this.p,y),this.max=this.d+this.h*Math.SQRT2}}const Z2=Number.POSITIVE_INFINITY,j7=Math.sqrt(2);function AR(u,[n,s]){let h=0,y=0;if(s===Z2){n<0&&(n=0);const d=n/j7;switch(u){case"top-right":case"top-left":y=d-7;break;case"bottom-right":case"bottom-left":y=7-d;break;case"bottom":y=7-n;break;case"top":y=n-7}switch(u){case"top-right":case"bottom-right":h=-d;break;case"top-left":case"bottom-left":h=d;break;case"left":h=n;break;case"right":h=-n}}else{switch(n=Math.abs(n),s=Math.abs(s),u){case"top-right":case"top-left":case"top":y=s-7;break;case"bottom-right":case"bottom-left":case"bottom":y=7-s}switch(u){case"top-right":case"bottom-right":case"right":h=-n;break;case"top-left":case"bottom-left":case"left":h=n}}return[h,y]}function W2(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function U7(u,n,s,h,y,d,v,M,k,j,E,D,B,R,z){let q=d.textMaxSize.evaluate(n,{},D);q===void 0?q=v*d.textScaleFactor:q*=d.textScaleFactor;const W=u.layers[0].layout,K=W.get("icon-offset").evaluate(n,{},D),oe=OR(s.horizontal)||s.vertical,se=B.name==="globe",ne=bo,ce=v*d.textScaleFactor/ne,pe=u.tilePixelRatio*q/ne,we=(tt=u.overscaling,u.zoom>18&&tt>2&&(tt>>=1),Math.max(pn/(512*tt),1)*W.get("symbol-spacing")),ke=W.get("text-padding")*u.tilePixelRatio,Re=W.get("icon-padding")*u.tilePixelRatio,Pe=hr(W.get("text-max-angle")),We=W.get("text-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",Le=W.get("icon-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",Je=W.get("symbol-placement"),it=we/2;var tt;const ot=W.get("icon-text-fit").evaluate(n,{},D),ut=W.get("icon-text-fit-padding").evaluate(n,{},D),pt=ot!=="none";let lt;u.hasAnyIconTextFit===!1&&pt&&(u.hasAnyIconTextFit=!0),h&&pt&&(u.allowVerticalPlacement&&s.vertical&&(lt=fr(h,s.vertical,ot,ut,K,ce)),oe&&(h=fr(h,oe,ot,ut,K,ce)));const Lt=(Wt,Rt,xn)=>{if(Rt.x<0||Rt.x>=pn||Rt.y<0||Rt.y>=pn)return;let mn=null;if(se){const{x:on,y:en,z:zn}=B.projectTilePoint(Rt.x,Rt.y,xn);mn={anchor:new Zr(on,en,zn,0,void 0),up:B.upVector(xn,Rt.x,Rt.y)}}(function(on,en,zn,Tn,Pn,ir,gr,wr,Sr,kr,Lr,Ai,si,cr,ai,oi,Fi,va,Va,xa,ha,ka,Qa,is,Li,Gl,Eh){const zc=on.addToLineVertexArray(en,Tn);let Nc,tg,Hp,ng,qv,lk,uk,ck=0,hk=0,fk=0,dk=0,PS=-1,RS=-1;const Of={};let pk=Wo("");const rg=zn?zn.anchor:en,kS=Sr.layout.get("icon-text-fit").evaluate(ha,{},Li)!=="none";let DS=0,LS=0;if(Sr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[DS,LS]=Sr.layout.get("text-offset").evaluate(ha,{},Li).map(Yu=>Yu*bo):(DS=Sr.layout.get("text-radial-offset").evaluate(ha,{},Li)*bo,LS=Z2),on.allowVerticalPlacement&&Pn.vertical){const Yu=Pn.vertical;if(ai)lk=K2(Yu),wr&&(uk=K2(wr));else{const $l=Sr.layout.get("text-rotate").evaluate(ha,{},Li)+90;Hp=p1(kr,rg,en,Lr,Ai,si,Yu,cr,$l,oi),wr&&(ng=p1(kr,rg,en,Lr,Ai,si,wr,va,$l))}}if(ir){const Yu=on.iconSizeData,$l=Sr.layout.get("icon-rotate").evaluate(ha,{},Li),Gv=TR(ir,$l,Qa,kS,ka.iconScaleFactor),NS=wr?TR(wr,$l,Qa,kS,ka.iconScaleFactor):void 0;tg=p1(kr,rg,en,Lr,Ai,si,ir,va,$l,null),ck=4*Gv.length;let ig=null;Yu.kind==="source"?(ig=[Qs*Sr.layout.get("icon-size").evaluate(ha,{},Li)*ka.iconScaleFactor],ig[0]>Vp&&lr(`${on.layerIds[0]}: Value for "icon-size" is >= ${Ev}. Reduce your "icon-size".`)):Yu.kind==="composite"&&(ig=[Qs*ka.compositeIconSizes[0].evaluate(ha,{},Li)*ka.iconScaleFactor,Qs*ka.compositeIconSizes[1].evaluate(ha,{},Li)*ka.iconScaleFactor],(ig[0]>Vp||ig[1]>Vp)&&lr(`${on.layerIds[0]}: Value for "icon-size" is >= ${Ev}. Reduce your "icon-size".`)),on.addSymbols(on.icon,Gv,ig,xa,Va,ha,!1,zn,en,zc.lineStartIndex,zc.lineLength,-1,is,Li,Gl,Eh),PS=on.icon.placedSymbolArray.length-1,NS&&(hk=4*NS.length,on.addSymbols(on.icon,NS,ig,xa,Va,ha,Ge.vertical,zn,en,zc.lineStartIndex,zc.lineLength,-1,is,Li,Gl,Eh),RS=on.icon.placedSymbolArray.length-1)}for(const Yu in Pn.horizontal){const $l=Pn.horizontal[Yu];Nc||(pk=Wo($l.text),ai?qv=K2($l):Nc=p1(kr,rg,en,Lr,Ai,si,$l,cr,Sr.layout.get("text-rotate").evaluate(ha,{},Li),oi));const Gv=$l.positionedLines.length===1;if(fk+=MR(on,zn,en,$l,gr,Sr,ai,ha,oi,zc,Pn.vertical?Ge.horizontal:Ge.horizontalOnly,Gv?Object.keys(Pn.horizontal):[Yu],Of,PS,ka,is,Li,Gl),Gv)break}Pn.vertical&&(dk+=MR(on,zn,en,Pn.vertical,gr,Sr,ai,ha,oi,zc,Ge.vertical,["vertical"],Of,RS,ka,is,Li,Gl));let Xp=-1;const zS=(Yu,$l)=>Yu?Math.max(Yu,$l):$l;Xp=zS(qv,Xp),Xp=zS(lk,Xp),Xp=zS(uk,Xp);const xG=Xp>-1?1:0;on.glyphOffsetArray.length>=65535&&lr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ha.sortKey!==void 0&&on.addToSortKeyRanges(on.symbolInstances.length,ha.sortKey),on.symbolInstances.emplaceBack(en.x,en.y,rg.x,rg.y,rg.z,Of.right>=0?Of.right:-1,Of.center>=0?Of.center:-1,Of.left>=0?Of.left:-1,Of.vertical>=0?Of.vertical:-1,PS,RS,pk,Nc!==void 0?Nc:on.collisionBoxArray.length,Nc!==void 0?Nc+1:on.collisionBoxArray.length,Hp!==void 0?Hp:on.collisionBoxArray.length,Hp!==void 0?Hp+1:on.collisionBoxArray.length,tg!==void 0?tg:on.collisionBoxArray.length,tg!==void 0?tg+1:on.collisionBoxArray.length,ng||on.collisionBoxArray.length,ng?ng+1:on.collisionBoxArray.length,Lr,fk,dk,ck,hk,xG,0,DS,LS,Xp,0,kS?1:0)})(u,Rt,mn,Wt,s,h,y,lt,u.layers[0],u.collisionBoxArray,n.index,n.sourceLayerIndex,u.index,ke,We,k,0,Re,Le,K,n,d,j,E,D,R,z)};if(Je==="line")for(const Wt of _R(n.geometry,0,0,pn,pn)){const Rt=X2(Wt,we,Pe,s.vertical||oe,h,ne,pe,u.overscaling,pn);for(const xn of Rt)oe&&V7(u,oe.text,it,xn)||Lt(Wt,xn,D)}else if(Je==="line-center"){for(const Wt of n.geometry)if(Wt.length>1){const Rt=Mf(Wt,Pe,s.vertical||oe,h,ne,pe);Rt&&Lt(Wt,Rt,D)}}else if(n.type==="Polygon")for(const Wt of ql(n.geometry,0)){const Rt=B7(Wt,16);Lt(Wt[0],new Zr(Rt.x,Rt.y,0,0,void 0),D)}else if(n.type==="LineString")for(const Wt of n.geometry)Lt(Wt,new Zr(Wt[0].x,Wt[0].y,0,0,void 0),D);else if(n.type==="Point")for(const Wt of n.geometry)for(const Rt of Wt)Lt([Rt],new Zr(Rt.x,Rt.y,0,0,void 0),D)}const Ev=255,Vp=Ev*Qs;function MR(u,n,s,h,y,d,v,M,k,j,E,D,B,R,z,q,W,K){const oe=function(ce,pe,we,ke,Re,Pe,We,Le){const Je=[];if(pe.positionedLines.length===0)return Je;const it=ke.layout.get("text-rotate").evaluate(Pe,{})*Math.PI/180,tt=function(Lt){const Wt=Lt[0],Rt=Lt[1],xn=Wt*Rt;return xn>0?[Wt,-Rt]:xn<0?[-Wt,Rt]:Wt===0?[Rt,Wt]:[Rt,-Wt]}(we);let ot=Math.abs(pe.top-pe.bottom);for(const Lt of pe.positionedLines)ot-=Lt.lineOffset;const ut=pe.positionedLines.length,pt=ot/ut;let lt=pe.top-we[1];for(let Lt=0;Lt<ut;++Lt){const Wt=pe.positionedLines[Lt];lt=N7(pe,pt,lt,Lt);for(const Rt of Wt.positionedGlyphs){if(!Rt.rect)continue;const xn=Rt.rect||{};let mn=Me+1,on=!0,en=1,zn=0;if(Rt.imageName){const xa=We[la.build(Rt.imageName).getSerializedPrimary()];if(!xa)continue;if(xa.sdf){lr("SDF images are not supported in formatted text and will be ignored.");continue}on=!1,en=xa.pixelRatio,mn=Sv/en}const Tn=(Re||Le)&&Rt.vertical,Pn=Rt.metrics.advance*Rt.scale/2,ir=Rt.metrics,gr=Rt.rect;if(gr===null)continue;Le&&pe.verticalizable&&(zn=Rt.imageName?Pn-Rt.metrics.width*Rt.scale/2:0);const wr=Re?[Rt.x+Pn,Rt.y]:[0,0];let Sr=[0,0],kr=[0,0],Lr=!1;Re||(Tn?(kr=[Rt.x+Pn+tt[0],Rt.y+tt[1]-zn],Lr=!0):Sr=[Rt.x+Pn+we[0],Rt.y+we[1]-zn]);const Ai=gr.w*Rt.scale/(en*(Rt.localGlyph?bh:1)),si=gr.h*Rt.scale/(en*(Rt.localGlyph?bh:1));let cr,ai,oi,Fi;if(Tn){const xa=Rt.y-lt,ha=new $t(-Pn,Pn-xa),ka=-Math.PI/2,Qa=new $t(...kr);cr=new $t(-Pn+Sr[0],Sr[1]),cr._rotateAround(ka,ha)._add(Qa),cr.x+=-xa+Pn,cr.y-=(ir.left-mn)*Rt.scale;const is=Rt.imageName?ir.advance*Rt.scale:bo*Rt.scale,Li=String.fromCodePoint(Rt.glyph);u1(Li)?cr.x+=(1-mn)*Rt.scale:Zm(Li)?cr.x+=is-ir.height*Rt.scale+(-mn-1)*Rt.scale:cr.x+=Rt.imageName||ir.width+2*mn===gr.w&&ir.height+2*mn===gr.h?(is-si)/2:(is-(ir.height+2*mn)*Rt.scale)/2,ai=new $t(cr.x,cr.y-Ai),oi=new $t(cr.x+si,cr.y),Fi=new $t(cr.x+si,cr.y-Ai)}else{const xa=(ir.left-mn)*Rt.scale-Pn+Sr[0],ha=(-ir.top-mn)*Rt.scale+Sr[1],ka=xa+Ai,Qa=ha+si;cr=new $t(xa,ha),ai=new $t(ka,ha),oi=new $t(xa,Qa),Fi=new $t(ka,Qa)}if(it){let xa;xa=Re?new $t(0,0):Lr?new $t(tt[0],tt[1]):new $t(we[0],we[1]),cr._rotateAround(it,xa),ai._rotateAround(it,xa),oi._rotateAround(it,xa),Fi._rotateAround(it,xa)}const va=new $t(0,0),Va=new $t(0,0);Je.push({tl:cr,tr:ai,bl:oi,br:Fi,texPrimary:xn,texSecondary:void 0,writingMode:pe.writingMode,glyphOffset:wr,sectionIndex:Rt.sectionIndex,isSDF:on,pixelOffsetTL:va,pixelOffsetBR:Va,minFontScaleX:0,minFontScaleY:0})}}return Je}(0,h,k,d,v,M,y,u.allowVerticalPlacement),se=u.textSizeData;let ne=null;se.kind==="source"?(ne=[Qs*d.layout.get("text-size").evaluate(M,{},W)*z.textScaleFactor],ne[0]>Vp&&lr(`${u.layerIds[0]}: Value for "text-size" is >= ${Ev}. Reduce your "text-size".`)):se.kind==="composite"&&(ne=[Qs*z.compositeTextSizes[0].evaluate(M,{},W)*z.textScaleFactor,Qs*z.compositeTextSizes[1].evaluate(M,{},W)*z.textScaleFactor],(ne[0]>Vp||ne[1]>Vp)&&lr(`${u.layerIds[0]}: Value for "text-size" is >= ${Ev}. Reduce your "text-size".`)),u.addSymbols(u.text,oe,ne,k,v,M,E,n,s,j.lineStartIndex,j.lineLength,R,q,W,K,!1);for(const ce of D)B[ce]=u.text.placedSymbolArray.length-1;return 4*oe.length}function OR(u){for(const n in u)return u[n];return null}function p1(u,n,s,h,y,d,v,M,k,j){let E=v.top,D=v.bottom,B=v.left,R=v.right;const z=v.collisionPadding;if(z&&(B-=z[0],E-=z[1],R+=z[2],D+=z[3]),k){const q=new $t(B,E),W=new $t(R,E),K=new $t(B,D),oe=new $t(R,D),se=hr(k);let ne=new $t(0,0);j&&(ne=new $t(j[0],j[1])),q._rotateAround(se,ne),W._rotateAround(se,ne),K._rotateAround(se,ne),oe._rotateAround(se,ne),B=Math.min(q.x,W.x,K.x,oe.x),R=Math.max(q.x,W.x,K.x,oe.x),E=Math.min(q.y,W.y,K.y,oe.y),D=Math.max(q.y,W.y,K.y,oe.y)}return u.emplaceBack(n.x,n.y,n.z,s.x,s.y,B,E,R,D,M,h,y,d),u.length-1}function K2(u){u.collisionPadding&&(u.top-=u.collisionPadding[1],u.bottom+=u.collisionPadding[3]);const n=u.bottom-u.top;return n>0?Math.max(10,n):null}function V7(u,n,s,h){const y=u.compareText;if(n in y){const d=y[n];for(let v=d.length-1;v>=0;v--)if(h.dist(d[v])<s)return!0}else y[n]=[];return y[n].push(h),!1}function IR(u,n){const s=u.fovAboveCenter,h=u.elevation?u.elevation.getMinElevationBelowMSL()*n:0,y=(u._camera.position[2]*u.worldSize-h)/Math.cos(u._pitch),d=Math.sin(s)*y/Math.sin(Math.max(Math.PI/2-u._pitch-s,.01));let v=Math.sin(u._pitch)*d+y;const M=y*(1/u._horizonShift);if(!u.elevation||u.elevation.exaggeration()===0){let k=Math.max(u.zoom-17,0);u.isOrthographic&&(k/=10),v*=1+k}return Math.min(1.01*v,M)}function Av(u,n){if(!n.isReprojectedInTileSpace)return{scale:1<<u.z,x:u.x,y:u.y,x2:u.x+1,y2:u.y+1,projection:n};const s=Math.pow(2,-u.z),h=u.x*s,y=(u.x+1)*s,d=u.y*s,v=(u.y+1)*s,M=qo(h),k=qo(y),j=Pa(d),E=Pa(v),D=n.project(M,j),B=n.project(k,j),R=n.project(k,E),z=n.project(M,E);let q=Math.min(D.x,B.x,R.x,z.x),W=Math.min(D.y,B.y,R.y,z.y),K=Math.max(D.x,B.x,R.x,z.x),oe=Math.max(D.y,B.y,R.y,z.y);const se=s/16;function ne(pe,we,ke,Re,Pe,We){const Le=(ke+Pe)/2,Je=(Re+We)/2,it=n.project(qo(Le),Pa(Je)),tt=Math.max(0,q-it.x,W-it.y,it.x-K,it.y-oe);q=Math.min(q,it.x),K=Math.max(K,it.x),W=Math.min(W,it.y),oe=Math.max(oe,it.y),tt>se&&(ne(pe,it,ke,Re,Le,Je),ne(it,we,Le,Je,Pe,We))}ne(D,B,h,d,y,d),ne(B,R,y,d,y,v),ne(R,z,y,v,h,v),ne(z,D,h,v,h,d),q-=se,W-=se,K+=se,oe+=se;const ce=1/Math.max(K-q,oe-W);return{scale:ce,x:q*ce,y:W*ce,x2:K*ce,y2:oe*ce,projection:n}}function CR(u,{x:n,y:s},h=0){return new $t(((n-h)*u.scale-u.x)*pn,(s*u.scale-u.y)*pn)}const q7=Ne.mat4.identity(new Float32Array(16));class qp{constructor(n){this.spec=n,this.name=n.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(n,s){return{x:0,y:0,z:0}}unproject(n,s){return new Gr(0,0)}projectTilePoint(n,s,h){return{x:n,y:s,z:0}}locationPoint(n,s,h=!0){return n._coordinatePoint(n.locationCoordinate(s),h)}pixelsPerMeter(n,s){return vo(1,n)*s}pixelSpaceConversion(n,s,h){return 1}farthestPixelDistance(n){return IR(n,n.pixelsPerMeter)}pointCoordinate(n,s,h,y){const d=n.horizonLineFromTop(!1),v=new $t(s,Math.max(d,h));return n.rayIntersectionCoordinate(n.pointRayIntersection(v,y))}pointCoordinate3D(n,s,h){const y=new $t(s,h);if(n.elevation)return n.elevation.pointCoordinate(y);{const d=this.pointCoordinate(n,y.x,y.y,0);return[d.x,d.y,d.z]}}isPointAboveHorizon(n,s){if(n.elevation&&n.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(n,s.x,s.y);const h=n.horizonLineFromTop();return s.y<h}createInversionMatrix(n,s){return q7}createTileMatrix(n,s,h){let y,d,v;const M=h.canonical,k=Ne.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const j=Av(M,this);y=1,d=j.x+h.wrap*j.scale,v=j.y,Ne.mat4.scale(k,k,[y/j.scale,y/j.scale,n.pixelsPerMeter/s])}else y=s/n.zoomScale(M.z),d=(M.x+Math.pow(2,M.z)*h.wrap)*y,v=M.y*y;return Ne.mat4.translate(k,k,[d,v,0]),Ne.mat4.scale(k,k,[y/pn,y/pn,1]),k}upVector(n,s,h){return[0,0,1]}upVectorScale(n,s,h){return{metersToTile:1}}}class G7 extends qp{constructor(n){super(n),this.range=[4,7],this.center=n.center||[-96,37.5];const[s,h]=this.parallels=n.parallels||[29.5,45.5],y=Math.sin(hr(s));this.n=(y+Math.sin(hr(h)))/2,this.c=1+y*(2*this.n-y),this.r0=Math.sqrt(this.c)/this.n}project(n,s){const{n:h,c:y,r0:d}=this,v=hr(n-this.center[0]),M=hr(s),k=Math.sqrt(y-2*h*Math.sin(M))/h;return{x:k*Math.sin(v*h),y:k*Math.cos(v*h)-d,z:0}}unproject(n,s){const{n:h,c:y,r0:d}=this,v=d+s;let M=Math.atan2(n,Math.abs(v))*Math.sign(v);v*h<0&&(M-=Math.PI*Math.sign(n)*Math.sign(v));const k=hr(this.center[0])*h;M=To(M,-Math.PI-k,Math.PI-k);const j=Mn(vn(M/h)+this.center[0],-180,180),E=Math.asin(Mn((y-(n*n+v*v)*h*h)/(2*h),-1,1)),D=Mn(vn(E),-85.051129,hi);return new Gr(j,D)}}const Mv=1.340264,Ov=-.081106,Iv=893e-6,Cv=.003796,m1=Math.sqrt(3)/2;class $7 extends qp{project(n,s){s=s/180*Math.PI,n=n/180*Math.PI;const h=Math.asin(m1*Math.sin(s)),y=h*h,d=y*y*y;return{x:.5*(n*Math.cos(h)/(m1*(Mv+3*Ov*y+d*(7*Iv+9*Cv*y)))/Math.PI+.5),y:1-.5*(h*(Mv+Ov*y+d*(Iv+Cv*y))/Math.PI+1),z:0}}unproject(n,s){n=(2*n-.5)*Math.PI;let h=s=(2*(1-s)-1)*Math.PI,y=h*h,d=y*y*y;for(let E,D,B,R=0;R<12&&(D=h*(Mv+Ov*y+d*(Iv+Cv*y))-s,B=Mv+3*Ov*y+d*(7*Iv+9*Cv*y),E=D/B,h=Mn(h-E,-Math.PI/3,Math.PI/3),y=h*h,d=y*y*y,!(Math.abs(E)<1e-12));++R);const v=m1*n*(Mv+3*Ov*y+d*(7*Iv+9*Cv*y))/Math.cos(h),M=Math.asin(Math.sin(h)/m1),k=Mn(180*v/Math.PI,-180,180),j=Mn(180*M/Math.PI,-85.051129,hi);return new Gr(k,j)}}class H7 extends qp{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0}project(n,s){return{x:.5+n/360,y:.5-s/360,z:0}}unproject(n,s){const h=360*(n-.5),y=Mn(360*(.5-s),-85.051129,hi);return new Gr(h,y)}}const Ty=Math.PI/2;function g1(u){return Math.tan((Ty+u)/2)}class X7 extends qp{constructor(n){super(n),this.center=n.center||[0,30];const[s,h]=this.parallels=n.parallels||[30,30];let y=hr(s),d=hr(h);this.southernCenter=y+d<0,this.southernCenter&&(y=-y,d=-d);const v=Math.cos(y),M=g1(y);this.n=y===d?Math.sin(y):Math.log(v/Math.cos(d))/Math.log(g1(d)/M),this.f=v*Math.pow(g1(y),this.n)/this.n}project(n,s){s=hr(s),this.southernCenter&&(s=-s),n=hr(n-this.center[0]);const h=1e-6,{n:y,f:d}=this;d>0?s<-Ty+h&&(s=-Ty+h):s>Ty-h&&(s=Ty-h);const v=d/Math.pow(g1(s),y);let M=v*Math.sin(y*n),k=d-v*Math.cos(y*n);return M=.5*(M/Math.PI+.5),k=.5*(k/Math.PI+.5),{x:M,y:this.southernCenter?k:1-k,z:0}}unproject(n,s){n=(2*n-.5)*Math.PI,this.southernCenter&&(s=1-s),s=(2*(1-s)-.5)*Math.PI;const{n:h,f:y}=this,d=y-s,v=Math.sign(d),M=Math.sign(h)*Math.sqrt(n*n+d*d);let k=Math.atan2(n,Math.abs(d))*v;d*h<0&&(k-=Math.PI*Math.sign(n)*v);const j=Mn(vn(k/h)+this.center[0],-180,180),E=Mn(vn(2*Math.atan(Math.pow(y/M,1/h))-Ty),-85.051129,hi);return new Gr(j,this.southernCenter?-E:E)}}class PR extends qp{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(n,s){return{x:Vl(n),y:gl(s),z:0}}unproject(n,s){const h=qo(n),y=Pa(s);return new Gr(h,y)}}const RR=hr(hi);class Y7 extends qp{project(n,s){const h=(s=hr(s))*s,y=h*h;return{x:.5*((n=hr(n))*(.8707-.131979*h+y*(y*(.003971*h-.001529*y)-.013791))/Math.PI+.5),y:1-.5*(s*(1.007226+h*(.015085+y*(.028874*h-.044475-.005916*y)))/Math.PI+1),z:0}}unproject(n,s){n=(2*n-.5)*Math.PI;let h=s=(2*(1-s)-1)*Math.PI,y=25,d=0,v=h*h;do{v=h*h;const j=v*v;d=(h*(1.007226+v*(.015085+j*(.028874*v-.044475-.005916*j)))-s)/(1.007226+v*(.045255+j*(.259866*v-.311325-.005916*11*j))),h=Mn(h-d,-RR,RR)}while(Math.abs(d)>1e-6&&--y>0);v=h*h;const M=Mn(vn(n/(.8707+v*(v*(v*v*v*(.003971-.001529*v)-.013791)-.131979))),-180,180),k=vn(h);return new Gr(M,k)}}const kR=hr(hi);class Z7 extends qp{project(n,s){s=hr(s),n=hr(n);const h=Math.cos(s),y=2/Math.PI,d=Math.acos(h*Math.cos(n/2)),v=Math.sin(d)/d,M=.5*(n*y+2*h*Math.sin(n/2)/v)||0,k=.5*(s+Math.sin(s)/v)||0;return{x:.5*(M/Math.PI+.5),y:1-.5*(k/Math.PI+1),z:0}}unproject(n,s){let h=n=(2*n-.5)*Math.PI,y=s=(2*(1-s)-1)*Math.PI,d=25;const v=1e-6;let M=0,k=0;do{const j=Math.cos(y),E=Math.sin(y),D=2*E*j,B=E*E,R=j*j,z=Math.cos(h/2),q=Math.sin(h/2),W=2*z*q,K=q*q,oe=1-R*z*z,se=oe?1/oe:0,ne=oe?Math.acos(j*z)*Math.sqrt(1/oe):0,ce=.5*(2*ne*j*q+2*h/Math.PI)-n,pe=.5*(ne*E+y)-s,we=.5*se*(R*K+ne*j*z*B)+1/Math.PI,ke=se*(W*D/4-ne*E*q),Re=.125*se*(D*q-ne*E*R*W),Pe=.5*se*(B*z+ne*K*j)+.5,We=ke*Re-Pe*we;M=(pe*ke-ce*Pe)/We,k=(ce*Re-pe*we)/We,h=Mn(h-M,-Math.PI,Math.PI),y=Mn(y-k,-kR,kR)}while((Math.abs(M)>v||Math.abs(k)>v)&&--d>0);return new Gr(vn(h),vn(y))}}class DR extends qp{constructor(n){super(n),this.center=n.center||[0,0],this.parallels=n.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(hr(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(n,s){const{scale:h,cosPhi:y}=this;return{x:hr(n)*y*h+.5,y:-Math.sin(hr(s))/y*h+.5,z:0}}unproject(n,s){const{scale:h,cosPhi:y}=this,d=-(s-.5)/h,v=Mn(vn((n-.5)/h)/y,-180,180),M=Math.asin(Mn(d*y,-1,1)),k=Mn(vn(M),-85.051129,hi);return new Gr(v,k)}}class W7 extends PR{constructor(n){super(n),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(n,s,h){const y=ei(n,s,h),d=aa(ki(h));return Ne.vec3.transformMat4(y,y,d),{x:y[0],y:y[1],z:y[2]}}locationPoint(n,s){const h=Ic(s.lat,s.lng),y=Ne.vec3.normalize([],h),d=n.elevation?n.elevation.getAtPointOrZero(n.locationCoordinate(s),n._centerAltitude):n._centerAltitude,v=vo(1,0)*pn*d;Ne.vec3.scaleAndAdd(h,h,y,v);const M=Ne.mat4.identity(new Float64Array(16));return Ne.mat4.multiply(M,n.pixelMatrix,n.globeMatrix),Ne.vec3.transformMat4(h,h,M),new $t(h[0],h[1])}pixelsPerMeter(n,s){return vo(1,0)*s}pixelSpaceConversion(n,s,h){const y=vo(1,n)*s,d=Nn(vo(1,45)*s,y,h);return this.pixelsPerMeter(n,s)/d}createTileMatrix(n,s,h){const y=ii(ki(h.canonical));return Ne.mat4.multiply(new Float64Array(16),n.globeMatrix,y)}createInversionMatrix(n,s){const{center:h}=n,y=aa(ki(s));return Ne.mat4.rotateY(y,y,hr(h.lng)),Ne.mat4.rotateX(y,y,hr(h.lat)),Ne.mat4.scale(y,y,[n._pixelsPerMercatorPixel,n._pixelsPerMercatorPixel,1]),Float32Array.from(y)}pointCoordinate(n,s,h,y){return Jn(n,s,h,!0)||new l(0,0)}pointCoordinate3D(n,s,h){const y=this.pointCoordinate(n,s,h,0);return[y.x,y.y,y.z]}isPointAboveHorizon(n,s){return!Jn(n,s.x,s.y,!1)}farthestPixelDistance(n){const s=function(y,d){const v=y.cameraToCenterDistance,M=y._centerAltitude*d,k=y._camera,j=y._camera.forward(),E=Ne.vec3.add([],Ne.vec3.scale([],j,-v),[0,0,M]),D=y.worldSize/(2*Math.PI),B=[0,0,-D],R=y.width/y.height,z=Math.tan(y.fovAboveCenter),q=Ne.vec3.scale([],k.up(),z),W=Ne.vec3.scale([],k.right(),z*R),K=Ne.vec3.normalize([],Ne.vec3.add([],Ne.vec3.add([],j,q),W)),oe=[];let se;if(new tr(E,K).closestPointOnSphere(B,D,oe)){const ne=Ne.vec3.add([],oe,B),ce=Ne.vec3.sub([],ne,E);se=Math.cos(y.fovAboveCenter)*Ne.vec3.length(ce)}else{const ne=Ne.vec3.sub([],E,B),ce=Ne.vec3.sub([],B,E);Ne.vec3.normalize(ce,ce);const pe=Ne.vec3.length(ne)-D;se=Math.sqrt(pe*(pe+2*D));const we=Math.acos(se/(D+pe))-Math.acos(Ne.vec3.dot(j,ce));se*=Math.cos(we)}return 1.01*se}(n,this.pixelsPerMeter(n.center.lat,n.worldSize)),h=xo(n.zoom);if(h>0){const y=IR(n,vo(1,n.center.lat)*n.worldSize),d=n.worldSize/(2*Math.PI),v=Math.max(n.width,n.height)/n.worldSize*Math.PI;return Nn(s,y+d*(1-Math.cos(v)),Math.pow(h,10))}return s}upVector(n,s,h){return ei(s,h,n,1)}upVectorScale(n){return{metersToTile:Kn(Dr(ki(n)))}}}function LR(u){const n=u.parallels,s=!!n&&Math.abs(n[0]+n[1])<.01;switch(u.name){case"mercator":return new PR(u);case"equirectangular":return new H7(u);case"naturalEarth":return new Y7(u);case"equalEarth":return new $7(u);case"winkelTripel":return new Z7(u);case"albers":return s?new DR(u):new G7(u);case"lambertConformalConic":return s?new DR(u):new X7(u);case"globe":return new W7(u)}throw new Error(`Invalid projection name: ${u.name}`)}const K7=Od.VectorTileFeature.types,J7=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function y1(u,n,s,h,y,d,v,M,k,j,E,D,B){const R=M?Math.min(Vp,Math.round(M[0])):0,z=M?Math.min(Vp,Math.round(M[1])):0;u.emplaceBack(n,s,Math.round(32*h),Math.round(32*y),d,v,(R<<1)+(k?1:0),z,16*j,16*E,256*D,256*B)}function _1(u,n,s){u.emplaceBack(n,s)}function v1(u,n,s,h,y,d,v){u.emplaceBack(n,s,h,y,d,v)}function x1(u,n,s,h,y){u.emplaceBack(n,s,h,y),u.emplaceBack(n,s,h,y),u.emplaceBack(n,s,h,y),u.emplaceBack(n,s,h,y)}function Q7(u){for(const n of u.sections)if(mc(n.text))return!0;return!1}class J2{constructor(n){this.layoutVertexArray=new fd,this.indexArray=new Ja,this.programConfigurations=n,this.segments=new Yi,this.dynamicLayoutVertexArray=new Sc,this.opacityVertexArray=new Am,this.placedSymbolArray=new Mm,this.iconTransitioningVertexArray=new Tc,this.globeExtVertexArray=new xp,this.zOffsetVertexArray=new Nl}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(n,s,h,y,d){this.isEmpty()||(h&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,l1.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,Sf.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,J7,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=n.createVertexBuffer(this.iconTransitioningVertexArray,Ef.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,vv.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||d)&&(this.zOffsetVertexBuffer=n.createVertexBuffer(this.zOffsetVertexArray,Tf.members,!0)),this.opacityVertexBuffer.itemSize=1),(h||y)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}In(J2,"SymbolBuffers");class Q2{constructor(n,s,h){this.layoutVertexArray=new n,this.layoutAttributes=s,this.indexArray=new h,this.segments=new Yi,this.collisionVertexArray=new uf,this.collisionVertexArrayExt=new Sc}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,Xm.members,!0),this.collisionVertexBufferExt=n.createVertexBuffer(this.collisionVertexArrayExt,Ym.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}In(Q2,"CollisionBuffers");class b1{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.lut=n.lut,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(v=>v.fqid),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ne.mat4.identity([]),this.placementViewportMatrix=Ne.mat4.identity([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=_y(this.zoom,s["text-size"]),this.iconSizeData=_y(this.zoom,s["icon-size"]);const h=this.layers[0].layout,y=h.get("symbol-sort-key"),d=h.get("symbol-z-order");this.canOverlap=h.get("text-allow-overlap")||h.get("icon-allow-overlap")||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=d!=="viewport-y"&&y.constantOr(1)!==void 0,this.sortFeaturesByY=(d==="viewport-y"||d==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=h.get("text-writing-mode").map(v=>Ge[v]),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=n.sourceID,this.projection=n.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=h.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new J2(new Es(this.layers,{zoom:this.zoom,lut:this.lut},n=>n.startsWith("text")||n.startsWith("symbol"))),this.icon=new J2(new Es(this.layers,{zoom:this.zoom,lut:this.lut},n=>n.startsWith("icon")||n.startsWith("symbol"))),this.glyphOffsetArray=new Im,this.lineVertexArray=new lo,this.symbolInstances=new qg}calculateGlyphDependencies(n,s,h,y,d){for(const v of n){const M=v.codePointAt(0);if(M===void 0)break;if(s[M]=!0,y&&d&&M<=65535){const k=Af[v];k&&(s[k.charCodeAt(0)]=!0)}}}updateFootprints(n,s){}updateReplacement(n,s){if(s.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=s.updateTime;const h=s.getReplacementRegionsForTile(n.toUnwrapped(),!0);return!Fm(this.activeReplacements,h)&&(this.activeReplacements=h,!0)}populate(n,s,h,y){const d=this.layers[0],v=d.layout,M=this.projection.name==="globe",k=v.get("text-font"),j=v.get("text-field"),E=v.get("icon-image"),[D,B]=v.get("icon-size-scale-range"),R=Mn(s.scaleFactor||1,D,B),z=(j.value.kind!=="constant"||j.value.value instanceof Aa&&!j.value.value.isEmpty()||j.value.value.toString().length>0)&&(k.value.kind!=="constant"||k.value.value.length>0),q=E.value.kind!=="constant"||!!E.value.value||Object.keys(E.parameters).length>0,W=v.get("symbol-sort-key");if(this.features=[],!z&&!q)return;const K=s.iconDependencies,oe=s.glyphDependencies,se=s.availableImages,ne=new ci(this.zoom);for(const{feature:ce,id:pe,index:we,sourceLayerIndex:ke}of n){const Re=d._featureFilter.needGeometry,Pe=J(ce,Re);if(!d._featureFilter.filter(ne,Pe,h))continue;if(Re||(Pe.geometry=Z(ce,h,y)),M&&ce.type!==1&&h.z<=5){const tt=Pe.geometry,ot=.98078528056,ut=(pt,lt)=>{const Lt=ei(pt.x,pt.y,h,1),Wt=ei(lt.x,lt.y,h,1);return Ne.vec3.dot(Lt,Wt)<ot};for(let pt=0;pt<tt.length;pt++)tt[pt]=I(tt[pt],ut)}let We,Le;if(z){const tt=d.getValueAndResolveTokens("text-field",Pe,h,se),ot=Aa.factory(tt);Q7(ot)&&(this.hasRTLText=!0),(!this.hasRTLText||rf()==="unavailable"||this.hasRTLText&&Ii.isParsed())&&(We=vy(ot,d,Pe))}if(q){const tt=d.getValueAndResolveTokens("icon-image",Pe,h,se);Le=tt instanceof la?tt:la.build(tt)}if(!We&&!Le)continue;const Je=this.sortFeaturesByKey?W.evaluate(Pe,{},h):void 0,it={id:pe,text:We,icon:Le,index:we,sourceLayerIndex:ke,geometry:Pe.geometry,properties:ce.properties,type:K7[ce.type],sortKey:Je};if(this.features.push(it),Le){const tt=xv(this.iconSizeData,this.layers[0]._unevaluatedLayout._values["icon-size"],h,this.zoom,it)*R*this.pixelRatio,ot=Le.getPrimary().scaleSelf(tt);if(K[ot.id]=K[ot.id]||[],K[ot.id].push(ot),Le.nameSecondary){const ut=Le.getSecondary().scaleSelf(tt);K[ut.id]=K[ut.id]||[],K[ut.id].push(ut)}}if(We){const tt=k.evaluate(Pe,{},h).join(","),ot=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ge.vertical)>=0;for(const ut of We.sections)if(ut.image){const pt=ut.image.getPrimary().scaleSelf(this.pixelRatio);K[pt.id]=K[pt.id]||[],K[pt.id].push(pt)}else{const pt=Ni(We.toString()),lt=ut.fontStack||tt,Lt=oe[lt]=oe[lt]||{};this.calculateGlyphDependencies(ut.text,Lt,ot,this.allowVerticalPlacement,pt)}}}v.get("symbol-placement")==="line"&&(this.features=function(ce){const pe={},we={},ke=[];let Re=0;function Pe(it){ke.push(ce[it]),Re++}function We(it,tt,ot){const ut=we[it];return delete we[it],we[tt]=ut,ke[ut].geometry[0].pop(),ke[ut].geometry[0]=ke[ut].geometry[0].concat(ot[0]),ut}function Le(it,tt,ot){const ut=pe[tt];return delete pe[tt],pe[it]=ut,ke[ut].geometry[0].shift(),ke[ut].geometry[0]=ot[0].concat(ke[ut].geometry[0]),ut}function Je(it,tt,ot){const ut=ot?tt[0][tt[0].length-1]:tt[0][0];return`${it}:${ut.x}:${ut.y}`}for(let it=0;it<ce.length;it++){const tt=ce[it],ot=tt.geometry,ut=tt.text?tt.text.toString():null;if(!ut){Pe(it);continue}const pt=Je(ut,ot),lt=Je(ut,ot,!0);if(pt in we&&lt in pe&&we[pt]!==pe[lt]){const Lt=Le(pt,lt,ot),Wt=We(pt,lt,ke[Lt].geometry);delete pe[pt],delete we[lt],we[Je(ut,ke[Wt].geometry,!0)]=Wt,ke[Lt].geometry=null}else pt in we?We(pt,lt,ot):lt in pe?Le(pt,lt,ot):(Pe(it),pe[pt]=Re-1,we[lt]=Re-1)}return ke.filter(it=>it.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ce,pe)=>ce.sortKey-pe.sortKey)}update(n,s,h,y,d,v,M){this.text.programConfigurations.updatePaintArrays(n,s,d,h,y,v,M),this.icon.programConfigurations.updatePaintArrays(n,s,d,h,y,v,M)}updateZOffset(){const n=(d,v,M)=>{h+=v,h>d.length&&d.resize(h);for(let k=-v;k<0;k++)d.emplace(k+h,M)},s=(d,v,M)=>{y+=v,y>d.length&&d.resize(y);for(let k=-v;k<0;k++)d.emplace(k+y,M)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let h=0,y=0;for(let d=0;d<this.symbolInstances.length;d++){const v=this.symbolInstances.get(d),{numHorizontalGlyphVertices:M,numVerticalGlyphVertices:k,numIconVertices:j}=v,E=v.zOffset,D=j>0;if((M>0||k>0)&&(n(this.text.zOffsetVertexArray,M,E),n(this.text.zOffsetVertexArray,k,E)),D){const{placedIconSymbolIndex:B,verticalPlacedIconSymbolIndex:R}=v;B>=0&&s(this.icon.zOffsetVertexArray,j,E),R>=0&&s(this.icon.zOffsetVertexArray,v.numVerticalIconVertices,E)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=LR(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,s){const h=this.lineVertexArray.length;if(n.segment!==void 0)for(const{x:y,y:d}of s)this.lineVertexArray.emplaceBack(y,d);return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(n,s,h,y,d,v,M,k,j,E,D,B,R,z,q,W){const K=n.indexArray,oe=n.layoutVertexArray,se=n.globeExtVertexArray,ne=n.segments.prepareSegment(4*s.length,oe,K,this.canOverlap?v.sortKey:void 0),ce=this.glyphOffsetArray.length,pe=ne.vertexLength,we=this.allowVerticalPlacement&&M===Ge.vertical?Math.PI/2:0,ke=v.text&&v.text.sections;for(let Pe=0;Pe<s.length;Pe++){const{tl:We,tr:Le,bl:Je,br:it,texPrimary:tt,texSecondary:ot,pixelOffsetTL:ut,pixelOffsetBR:pt,minFontScaleX:lt,minFontScaleY:Lt,glyphOffset:Wt,isSDF:Rt,sectionIndex:xn}=s[Pe],mn=ne.vertexLength,on=Wt[1];if(y1(oe,j.x,j.y,We.x,on+We.y,tt.x,tt.y,h,Rt,ut.x,ut.y,lt,Lt),y1(oe,j.x,j.y,Le.x,on+Le.y,tt.x+tt.w,tt.y,h,Rt,pt.x,ut.y,lt,Lt),y1(oe,j.x,j.y,Je.x,on+Je.y,tt.x,tt.y+tt.h,h,Rt,ut.x,pt.y,lt,Lt),y1(oe,j.x,j.y,it.x,on+it.y,tt.x+tt.w,tt.y+tt.h,h,Rt,pt.x,pt.y,lt,Lt),k){const{x:en,y:zn,z:Tn}=k.anchor,[Pn,ir,gr]=k.up;v1(se,en,zn,Tn,Pn,ir,gr),v1(se,en,zn,Tn,Pn,ir,gr),v1(se,en,zn,Tn,Pn,ir,gr),v1(se,en,zn,Tn,Pn,ir,gr),x1(n.dynamicLayoutVertexArray,en,zn,Tn,we)}else x1(n.dynamicLayoutVertexArray,j.x,j.y,j.z,we);if(W){const en=ot||tt;_1(n.iconTransitioningVertexArray,en.x,en.y),_1(n.iconTransitioningVertexArray,en.x+en.w,en.y),_1(n.iconTransitioningVertexArray,en.x,en.y+en.h),_1(n.iconTransitioningVertexArray,en.x+en.w,en.y+en.h)}K.emplaceBack(mn,mn+1,mn+2),K.emplaceBack(mn+1,mn+2,mn+3),ne.vertexLength+=4,ne.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Wt[0]),Pe!==s.length-1&&xn===s[Pe+1].sectionIndex||n.programConfigurations.populatePaintArrays(oe.length,v,v.index,{},R,z,q,ke&&ke[xn])}const Re=k?k.anchor:j;n.placedSymbolArray.emplaceBack(Re.x,Re.y,Re.z,j.x,j.y,ce,this.glyphOffsetArray.length-ce,pe,E,D,j.segment,h?h[0]:0,h?h[1]:0,y[0],y[1],M,0,!1,0,B,0)}_commitLayoutVertex(n,s,h,y,d,v,M){n.emplaceBack(s,h,y,d,v,Math.round(M.x),Math.round(M.y))}_addCollisionDebugVertices(n,s,h,y,d,v,M){const k=h.segments.prepareSegment(4,h.layoutVertexArray,h.indexArray),j=k.vertexLength,E=M.tileAnchorX,D=M.tileAnchorY;for(let R=0;R<4;R++)h.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(h.collisionVertexArrayExt,s,n.padding,M.zOffset),this._commitLayoutVertex(h.layoutVertexArray,y,d,v,E,D,new $t(n.x1,n.y1)),this._commitLayoutVertex(h.layoutVertexArray,y,d,v,E,D,new $t(n.x2,n.y1)),this._commitLayoutVertex(h.layoutVertexArray,y,d,v,E,D,new $t(n.x2,n.y2)),this._commitLayoutVertex(h.layoutVertexArray,y,d,v,E,D,new $t(n.x1,n.y2)),k.vertexLength+=4;const B=h.indexArray;B.emplaceBack(j,j+1),B.emplaceBack(j+1,j+2),B.emplaceBack(j+2,j+3),B.emplaceBack(j+3,j),k.primitiveLength+=4}_addTextDebugCollisionBoxes(n,s,h,y,d,v){for(let M=y;M<d;M++){const k=h.get(M),j=this.getSymbolInstanceTextSize(n,v,s,M);this._addCollisionDebugVertices(k,j,this.textCollisionBox,k.projectedAnchorX,k.projectedAnchorY,k.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(n,s,h,y,d,v){for(let M=y;M<d;M++){const k=h.get(M),j=this.getSymbolInstanceIconSize(n,s,v.placedIconSymbolIndex);this._addCollisionDebugVertices(k,j,this.iconCollisionBox,k.projectedAnchorX,k.projectedAnchorY,k.projectedAnchorZ,v)}}generateCollisionDebugBuffers(n,s,h){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Q2(Ec,xh.members,Tc),this.iconCollisionBox=new Q2(Ec,xh.members,Tc);const y=Ld(this.iconSizeData,n),d=Ld(this.textSizeData,n,h);for(let v=0;v<this.symbolInstances.length;v++){const M=this.symbolInstances.get(v);this._addTextDebugCollisionBoxes(d,n,s,M.textBoxStartIndex,M.textBoxEndIndex,M),this._addTextDebugCollisionBoxes(d,n,s,M.verticalTextBoxStartIndex,M.verticalTextBoxEndIndex,M),this._addIconDebugCollisionBoxes(y,n,s,M.iconBoxStartIndex,M.iconBoxEndIndex,M),this._addIconDebugCollisionBoxes(y,n,s,M.verticalIconBoxStartIndex,M.verticalIconBoxEndIndex,M)}}getSymbolInstanceTextSize(n,s,h,y){const d=this.text.placedSymbolArray.get(s.rightJustifiedTextSymbolIndex>=0?s.rightJustifiedTextSymbolIndex:s.centerJustifiedTextSymbolIndex>=0?s.centerJustifiedTextSymbolIndex:s.leftJustifiedTextSymbolIndex>=0?s.leftJustifiedTextSymbolIndex:s.verticalPlacedTextSymbolIndex>=0?s.verticalPlacedTextSymbolIndex:y),v=Dd(this.textSizeData,n,d)/bo;return this.tilePixelRatio*v}getSymbolInstanceIconSize(n,s,h){const y=this.icon.placedSymbolArray.get(h),d=Dd(this.iconSizeData,n,y);return this.tilePixelRatio*d}_commitDebugCollisionVertexUpdate(n,s,h,y){n.emplaceBack(s,-h,-h,y),n.emplaceBack(s,h,-h,y),n.emplaceBack(s,h,h,y),n.emplaceBack(s,-h,h,y)}_updateTextDebugCollisionBoxes(n,s,h,y,d,v,M){for(let k=y;k<d;k++){const j=h.get(k),E=this.getSymbolInstanceTextSize(n,v,s,k);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,E,j.padding,v.zOffset)}}_updateIconDebugCollisionBoxes(n,s,h,y,d,v,M){for(let k=y;k<d;k++){const j=h.get(k),E=this.getSymbolInstanceIconSize(n,s,v.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,E,j.padding,v.zOffset)}}updateCollisionDebugBuffers(n,s,h,y){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const d=Ld(this.iconSizeData,n,y),v=Ld(this.textSizeData,n,h);for(let M=0;M<this.symbolInstances.length;M++){const k=this.symbolInstances.get(M);this._updateTextDebugCollisionBoxes(v,n,s,k.textBoxStartIndex,k.textBoxEndIndex,k,h),this._updateTextDebugCollisionBoxes(v,n,s,k.verticalTextBoxStartIndex,k.verticalTextBoxEndIndex,k,h),this._updateIconDebugCollisionBoxes(d,n,s,k.iconBoxStartIndex,k.iconBoxEndIndex,k,y),this._updateIconDebugCollisionBoxes(d,n,s,k.verticalIconBoxStartIndex,k.verticalIconBoxEndIndex,k,y)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(n,s,h,y,d,v,M,k,j){const E={};if(s<h){const{x1:D,y1:B,x2:R,y2:z,padding:q,projectedAnchorX:W,projectedAnchorY:K,projectedAnchorZ:oe,tileAnchorX:se,tileAnchorY:ne,featureIndex:ce}=n.get(s);E.textBox={x1:D,y1:B,x2:R,y2:z,padding:q,projectedAnchorX:W,projectedAnchorY:K,projectedAnchorZ:oe,tileAnchorX:se,tileAnchorY:ne},E.textFeatureIndex=ce}if(y<d){const{x1:D,y1:B,x2:R,y2:z,padding:q,projectedAnchorX:W,projectedAnchorY:K,projectedAnchorZ:oe,tileAnchorX:se,tileAnchorY:ne,featureIndex:ce}=n.get(y);E.verticalTextBox={x1:D,y1:B,x2:R,y2:z,padding:q,projectedAnchorX:W,projectedAnchorY:K,projectedAnchorZ:oe,tileAnchorX:se,tileAnchorY:ne},E.verticalTextFeatureIndex=ce}if(v<M){const{x1:D,y1:B,x2:R,y2:z,padding:q,projectedAnchorX:W,projectedAnchorY:K,projectedAnchorZ:oe,tileAnchorX:se,tileAnchorY:ne,featureIndex:ce}=n.get(v);E.iconBox={x1:D,y1:B,x2:R,y2:z,padding:q,projectedAnchorX:W,projectedAnchorY:K,projectedAnchorZ:oe,tileAnchorX:se,tileAnchorY:ne},E.iconFeatureIndex=ce}if(k<j){const{x1:D,y1:B,x2:R,y2:z,padding:q,projectedAnchorX:W,projectedAnchorY:K,projectedAnchorZ:oe,tileAnchorX:se,tileAnchorY:ne,featureIndex:ce}=n.get(k);E.verticalIconBox={x1:D,y1:B,x2:R,y2:z,padding:q,projectedAnchorX:W,projectedAnchorY:K,projectedAnchorZ:oe,tileAnchorX:se,tileAnchorY:ne},E.verticalIconFeatureIndex=ce}return E}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const h=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(n,s){const h=n.placedSymbolArray.get(s),y=h.vertexStartIndex+4*h.numGlyphs;for(let d=h.vertexStartIndex;d<y;d+=4)n.indexArray.emplaceBack(d,d+1,d+2),n.indexArray.emplaceBack(d+1,d+2,d+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(n),h=Math.cos(n),y=[],d=[],v=[];for(let M=0;M<this.symbolInstances.length;++M){v.push(M);const k=this.symbolInstances.get(M);y.push(0|Math.round(s*k.tileAnchorX+h*k.tileAnchorY)),d.push(k.featureIndex)}return v.sort((M,k)=>y[M]-y[k]||d[k]-d[M]),v}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let n=0;n<this.symbolInstances.length;++n)this.symbolInstanceIndexesSortedZOffset.push(n)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((n,s)=>this.symbolInstances.get(s).zOffset-this.symbolInstances.get(n).zOffset)}addToSortKeyRanges(n,s){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===s?h.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const h=this.symbolInstances.get(s);this.featureSortOrder.push(h.featureIndex);const{rightJustifiedTextSymbolIndex:y,centerJustifiedTextSymbolIndex:d,leftJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:M,placedIconSymbolIndex:k,verticalPlacedIconSymbolIndex:j}=h;y>=0&&this.addIndicesForPlacedSymbol(this.text,y),d>=0&&d!==y&&this.addIndicesForPlacedSymbol(this.text,d),v>=0&&v!==d&&v!==y&&this.addIndicesForPlacedSymbol(this.text,v),M>=0&&this.addIndicesForPlacedSymbol(this.text,M),k>=0&&this.addIndicesForPlacedSymbol(this.icon,k),j>=0&&this.addIndicesForPlacedSymbol(this.icon,j)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let zR,NR,eS;In(b1,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),b1.addDynamicAttributes=x1;class BR{constructor(n){this.type=n.property.overrides?n.property.overrides.runtimeType:Lo,this.defaultValue=n}evaluate(n){if(n.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(n.formattedSection))return s.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}In(BR,"FormatSectionOverride",{omit:["defaultValue"]});const tS=()=>eS||(eS={layout:zR||(zR=new Bi({"symbol-placement":new sn(_t.layout_symbol["symbol-placement"]),"symbol-spacing":new sn(_t.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new sn(_t.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new En(_t.layout_symbol["symbol-sort-key"]),"symbol-z-order":new sn(_t.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new sn(_t.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new sn(_t.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new sn(_t.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new sn(_t.layout_symbol["icon-ignore-placement"]),"icon-optional":new sn(_t.layout_symbol["icon-optional"]),"icon-rotation-alignment":new sn(_t.layout_symbol["icon-rotation-alignment"]),"icon-size":new En(_t.layout_symbol["icon-size"]),"icon-size-scale-range":new sn(_t.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new En(_t.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new En(_t.layout_symbol["icon-text-fit-padding"]),"icon-image":new En(_t.layout_symbol["icon-image"]),"icon-rotate":new En(_t.layout_symbol["icon-rotate"]),"icon-padding":new sn(_t.layout_symbol["icon-padding"]),"icon-keep-upright":new sn(_t.layout_symbol["icon-keep-upright"]),"icon-offset":new En(_t.layout_symbol["icon-offset"]),"icon-anchor":new En(_t.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new sn(_t.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new sn(_t.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new sn(_t.layout_symbol["text-rotation-alignment"]),"text-field":new En(_t.layout_symbol["text-field"]),"text-font":new En(_t.layout_symbol["text-font"]),"text-size":new En(_t.layout_symbol["text-size"]),"text-size-scale-range":new sn(_t.layout_symbol["text-size-scale-range"]),"text-max-width":new En(_t.layout_symbol["text-max-width"]),"text-line-height":new En(_t.layout_symbol["text-line-height"]),"text-letter-spacing":new En(_t.layout_symbol["text-letter-spacing"]),"text-justify":new En(_t.layout_symbol["text-justify"]),"text-radial-offset":new En(_t.layout_symbol["text-radial-offset"]),"text-variable-anchor":new sn(_t.layout_symbol["text-variable-anchor"]),"text-anchor":new En(_t.layout_symbol["text-anchor"]),"text-max-angle":new sn(_t.layout_symbol["text-max-angle"]),"text-writing-mode":new sn(_t.layout_symbol["text-writing-mode"]),"text-rotate":new En(_t.layout_symbol["text-rotate"]),"text-padding":new sn(_t.layout_symbol["text-padding"]),"text-keep-upright":new sn(_t.layout_symbol["text-keep-upright"]),"text-transform":new En(_t.layout_symbol["text-transform"]),"text-offset":new En(_t.layout_symbol["text-offset"]),"text-allow-overlap":new sn(_t.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new sn(_t.layout_symbol["text-ignore-placement"]),"text-optional":new sn(_t.layout_symbol["text-optional"]),visibility:new sn(_t.layout_symbol.visibility)})),paint:NR||(NR=new Bi({"icon-opacity":new En(_t.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new En(_t.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new En(_t.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new En(_t.paint_symbol["text-emissive-strength"]),"icon-color":new En(_t.paint_symbol["icon-color"]),"icon-halo-color":new En(_t.paint_symbol["icon-halo-color"]),"icon-halo-width":new En(_t.paint_symbol["icon-halo-width"]),"icon-halo-blur":new En(_t.paint_symbol["icon-halo-blur"]),"icon-translate":new sn(_t.paint_symbol["icon-translate"]),"icon-translate-anchor":new sn(_t.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new En(_t.paint_symbol["icon-image-cross-fade"]),"text-opacity":new En(_t.paint_symbol["text-opacity"]),"text-occlusion-opacity":new En(_t.paint_symbol["text-occlusion-opacity"]),"text-color":new En(_t.paint_symbol["text-color"],{runtimeType:zi,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new En(_t.paint_symbol["text-halo-color"]),"text-halo-width":new En(_t.paint_symbol["text-halo-width"]),"text-halo-blur":new En(_t.paint_symbol["text-halo-blur"]),"text-translate":new sn(_t.paint_symbol["text-translate"]),"text-translate-anchor":new sn(_t.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new sn(_t.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new sn(_t.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new sn(_t.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new sn(_t.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new En(_t.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new En({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new En({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new En({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new En({type:"string",default:"default","property-type":"data-driven"})}))},eS);class w1 extends Ca{constructor(n,s,h,y){super(n,tS(),s,h,y),this._colorAdjustmentMatrix=Ne.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=n.paint!==void 0&&("icon-occlusion-opacity"in n.paint||"text-occlusion-opacity"in n.paint)}recalculate(n,s){super.recalculate(n,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const h=this.layout.get("text-writing-mode");if(h){const y=[];for(const d of h)y.indexOf(d)<0&&y.push(d);this.layout._values["text-writing-mode"]=y}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(n,s,h,y){return this._saturation===n&&this._contrast===s&&this._brightnessMin===h&&this._brightnessMax===y||(this._colorAdjustmentMatrix=function(d,v,M,k){d=Ml(d),v=Jl(v);const j=Ne.mat4.create(),E=d/3,D=1-2*E,B=[D,E,E,0,E,D,E,0,E,E,D,0,0,0,0,1],R=.5-.5*v,z=k-M;return Ne.mat4.multiply(j,[z,0,0,0,0,z,0,0,0,0,z,0,M,M,M,1],[v,0,0,0,0,v,0,0,0,0,v,0,R,R,R,1]),Ne.mat4.multiply(j,j,B),j}(n,s,h,y),this._saturation=n,this._contrast=s,this._brightnessMin=h,this._brightnessMax=y),this._colorAdjustmentMatrix}getValueAndResolveTokens(n,s,h,y){const d=this.layout.get(n).evaluate(s,{},h,y),v=this._unevaluatedLayout._values[n];return v.isDataDriven()||Kh(v.value)||!d?d:function(M,k){return k.replace(/{([^{}]+)}/g,(j,E)=>E in M?String(M[E]):"")}(s.properties,d)}createBucket(n){return new b1(n)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const n of tS().paint.overridableProperties){if(!w1.hasPaintOverride(this.layout,n))continue;const s=this.paint.get(n),h=new BR(s),y=new mp(h,s.property.specification,this.scope,this.options);let d=null;d=s.value.kind==="constant"||s.value.kind==="source"?new Jh("source",y):new Lu("composite",y,s.value.zoomStops,s.value._interpolationType),this.paint._values[n]=new bc(s.property,d,s.parameters)}}_handleOverridablePaintPropertyUpdate(n,s,h){return!(!this.layout||s.isDataDriven()||h.isDataDriven())&&w1.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,s){const h=n.get("text-field"),y=tS().paint.properties[s];let d=!1;const v=M=>{for(const k of M)if(y.overrides&&y.overrides.hasOverride(k))return void(d=!0)};if(h.value.kind==="constant"&&h.value.value instanceof Aa)v(h.value.value.sections);else if(h.value.kind==="source"){const M=j=>{d||(j instanceof Ba&&Oi(j.value)===No?v(j.value.sections):j instanceof eu?v(j.sections):j.eachChild(M))},k=h.value;k._styleExpression&&M(k._styleExpression.expression)}return d}getProgramIds(){return["symbol"]}getDefaultProgramParams(n,s,h){return{config:new gu(this,{zoom:s,lut:h}),overrideFog:!1}}}let FR,jR,UR,VR;var nS=Yr([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function rS(u){switch(u){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function iS(u){switch(u){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class aS{constructor(n,s,h,y){this.context=n,this.format=h,this.useMipmap=y&&y.useMipmap,this.texture=n.gl.createTexture(),this.update(s,{premultiply:y&&y.premultiply})}update(n,s){const h=n&&n instanceof HTMLVideoElement&&n.width===0?n.videoWidth:n.width,y=n&&n instanceof HTMLVideoElement&&n.height===0?n.videoHeight:n.height,{context:d}=this,{gl:v}=d,{x:M,y:k}=s&&s.position?s.position:{x:0,y:0},j=M+h,E=k+y;!this.size||this.size[0]===j&&this.size[1]===E||(v.bindTexture(v.TEXTURE_2D,null),v.deleteTexture(this.texture),this.texture=v.createTexture(),this.size=null),v.bindTexture(v.TEXTURE_2D,this.texture),d.pixelStoreUnpackFlipY.set(!1),d.pixelStoreUnpack.set(1),d.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA8&&(!s||s.premultiply!==!1));const D=n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||ImageBitmap&&n instanceof ImageBitmap;if(!this.size&&j>0&&E>0){const B=this.useMipmap?Math.floor(Math.log2(Math.max(j,E)))+1:1;v.texStorage2D(v.TEXTURE_2D,B,this.format,j,E),this.size=[j,E]}if(this.size)if(D)v.texSubImage2D(v.TEXTURE_2D,0,M,k,rS(this.format),iS(this.format),n);else{const B=n.data;B&&v.texSubImage2D(v.TEXTURE_2D,0,M,k,h,y,rS(this.format),iS(this.format),B)}this.useMipmap&&v.generateMipmap(v.TEXTURE_2D)}bind(n,s,h=!1){const{context:y}=this,{gl:d}=y;d.bindTexture(d.TEXTURE_2D,this.texture),n!==this.minFilter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,n),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,this.useMipmap&&!h?n===d.NEAREST?d.NEAREST_MIPMAP_NEAREST:d.LINEAR_MIPMAP_LINEAR:n),this.minFilter=n),s!==this.wrapS&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,s),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,s),this.wrapS=s)}bindExtraParam(n,s,h,y){const{context:d}=this,{gl:v}=d;v.bindTexture(v.TEXTURE_2D,this.texture),s!==this.magFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,s),this.magFilter=s),n!==this.minFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,this.useMipmap?n===v.NEAREST?v.NEAREST_MIPMAP_NEAREST:v.LINEAR_MIPMAP_LINEAR:n),this.minFilter=n),h!==this.wrapS&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,h),this.wrapS=h),y!==this.wrapT&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,y),this.wrapT=y)}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}class S1{constructor(n,s){this.context=n,this.texture=s}bind(n,s){const{context:h}=this,{gl:y}=h;y.bindTexture(y.TEXTURE_2D,this.texture),n!==this.minFilter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,n),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,n),this.minFilter=n),s!==this.wrapS&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,s),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,s),this.wrapS=s)}}function T1(u,n,s,h,y,d,v,M){const k=[u,n,1,s,h,1,y,d,1],j=[v,M,1],E=Ne.mat3.adjoint([],k),[D,B,R]=Ne.vec3.transformMat3(j,j,E);return Ne.mat3.multiply(k,k,[D,0,0,0,B,0,0,0,R])}function qR(u,n,s,h,y,d,v,M){const k=function(j,E,D,B,R,z,q,W){const K=T1(0,0,1,0,1,1,0,1),oe=T1(j,E,D,B,R,z,q,W),se=Ne.mat3.adjoint([],K);return Ne.mat3.multiply(oe,oe,se)}(u,n,s,h,y,d,v,M);return[k[2]/k[8]/pn,k[5]/k[8]/pn]}function E1(u){return[u[0],Math.min(Math.max(u[1],-85.051129),hi)]}class GR extends Ol{constructor(n,s,h,y){super(),this.id=n,this.dispatcher=h,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(y),this.options=s,this._dirty=!1}load(n,s){if(this._loaded=s||!1,this.fire(new Oo("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return n&&(this.coordinates=n),this._loaded=!0,void this._finishLoading();this._imageRequest=us(this.map._requestManager.transformRequest(this.url,Nr.Image),(h,y)=>{this._imageRequest=null,this._loaded=!0,h?this.fire(new il(h)):y&&(this.image=y instanceof HTMLImageElement?Fe.getImageData(y):y,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,n&&(this.coordinates=n),this._finishLoading())})}loaded(){return this._loaded}updateImage(n){return n.url?(this._imageRequest&&n.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=n.url,this.load(n.coordinates,this._loaded),this):this}setTexture(n){if(!(n.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new S1(this.map.painter.context,n.handle),this.width=n.dimensions[0],this.height=n.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Oo("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(n){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof S1||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(n){if(this.coordinates=n,this._boundsArray=void 0,this._unsupportedCoords=!1,!n.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let s=n[0][1],h=n[0][1];for(const d of n)d[1]>h&&(h=d[1]),d[1]<s&&(s=d[1]);const y=(h+s)/2;if(y>hi?this.onNorthPole=!0:y<-85.051129&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const d=n.map(l.fromLngLat);this.tileID=function(v){let M=1/0,k=1/0,j=-1/0,E=-1/0;for(const q of v)M=Math.min(M,q.x),k=Math.min(k,q.y),j=Math.max(j,q.x),E=Math.max(E,q.y);const D=Math.max(j-M,E-k),B=Math.max(0,Math.floor(-Math.log(D)/Math.LN2)),R=Math.pow(2,B);let z=Math.floor((M+j)/2*R);return z>1&&(z-=1),new Yt(B,z,Math.floor((k+E)/2*R))}(d),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Oo("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(n){for(const K in this.tiles){const oe=this.tiles[K];oe.state!=="loaded"&&(oe.state="loaded",oe.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const s=Av(new Yt(0,0,0),this.map.transform.projection),h=[s.projection.project(this.coordinates[0][0],this.coordinates[0][1]),s.projection.project(this.coordinates[1][0],this.coordinates[1][1]),s.projection.project(this.coordinates[2][0],this.coordinates[2][1]),s.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(K){const oe=K[1].x-K[0].x,se=K[1].y-K[0].y,ne=K[2].x-K[1].x,ce=K[2].y-K[1].y,pe=K[3].x-K[2].x,we=K[3].y-K[2].y,ke=K[0].x-K[3].x,Re=K[0].y-K[3].y,Pe=oe*ce-ne*se,We=ne*we-pe*ce,Le=pe*Re-ke*we,Je=ke*se-oe*Re;return Pe>0&&We>0&&Le>0&&Je>0||Pe<0&&We<0&&Le<0&&Je<0}(h))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const y=Av(this.tileID,this.map.transform.projection),[d,v,M,k]=this.coordinates.map(K=>{const oe=y.projection.project(K[0],K[1]);return CR(y,oe)._round()});this.perspectiveTransform=qR(d.x,d.y,v.x,v.y,M.x,M.y,k.x,k.y);const j=this._boundsArray=new zl;j.emplaceBack(d.x,d.y,0,0),j.emplaceBack(v.x,v.y,pn,0),j.emplaceBack(k.x,k.y,0,pn),j.emplaceBack(M.x,M.y,pn,pn),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=n.createVertexBuffer(j,nS.members),this.boundsSegments=Yi.simpleSegment(0,0,4,2);const E=[],D=[E1((B=this.coordinates)[0]),E1(B[1]),E1(B[2]),E1(B[3])];var B;const[R,z,q,W]=function(K){let oe=K[0][0],se=oe,ne=K[0][1],ce=ne;for(let pe=1;pe<K.length;pe++)K[pe][0]<oe?oe=K[pe][0]:K[pe][0]>se&&(se=K[pe][0]),K[pe][1]<ne?ne=K[pe][1]:K[pe][1]>ce&&(ce=K[pe][1]);return[oe,ne,se-oe,ce-ne]}(D);{const K=new zl,[oe,se,ne,ce]=function(ut){let pt=ut[0].x,lt=pt,Lt=ut[0].y,Wt=Lt;for(let Rt=1;Rt<ut.length;Rt++)ut[Rt].x<pt?pt=ut[Rt].x:ut[Rt].x>lt&&(lt=ut[Rt].x),ut[Rt].y<Lt?Lt=ut[Rt].y:ut[Rt].y>Wt&&(Wt=ut[Rt].y);return[pt,Lt,lt-pt,Wt-Lt]}(h),pe=ut=>[(ut.x-oe)/ne,(ut.y-se)/ce],[we,ke,Re,Pe]=h.map(pe),We=function(ut,pt,lt,Lt,Wt,Rt,xn,mn){const on=T1(0,0,1,0,1,1,0,1),en=T1(ut,pt,lt,Lt,Wt,Rt,xn,mn),zn=Ne.mat3.adjoint([],en);return Ne.mat3.multiply(on,on,zn)}(we[0],we[1],ke[0],ke[1],Re[0],Re[1],Pe[0],Pe[1]);this.elevatedGlobePerspectiveTransform=qR(we[0],we[1],ke[0],ke[1],Re[0],Re[1],Pe[0],Pe[1]);const Le=(ut,pt)=>{E.push(ut.lng);const lt=Math.round((ut.lng-R)/q*pn),Lt=Math.round((ut.lat-z)/W*pn),Wt=pe(pt),Rt=Ne.vec3.transformMat3([],[Wt[0],Wt[1],1],We),xn=Math.round(Rt[0]/Rt[2]*pn),mn=Math.round(Rt[1]/Rt[2]*pn);K.emplaceBack(lt,Lt,xn,mn)},Je=h[3].x-h[0].x,it=h[3].y-h[0].y,tt=h[2].x-h[1].x,ot=h[2].y-h[1].y;for(let ut=0;ut<65;ut++){const pt=ut/64,lt=[h[0].x+pt*Je,h[0].y+pt*it],Lt=[h[1].x+pt*tt,h[1].y+pt*ot],Wt=Lt[0]-lt[0],Rt=Lt[1]-lt[1];for(let xn=0;xn<65;xn++){const mn=xn/64,on={x:lt[0]+Wt*mn,y:lt[1]+Rt*mn};Le(s.projection.unproject(on.x,on.y),on)}}this.elevatedGlobeVertexBuffer=n.createVertexBuffer(K,nS.members)}{this.maxLongitudeTriangleSize=0;let K=[],oe=new Ja;const se=(ne,ce,pe)=>{oe.emplaceBack(ne,ce,pe);const we=E[ne],ke=E[ce],Re=E[pe],Pe=Math.min(Math.min(we,ke),Re),We=Math.max(Math.max(we,ke),Re)-Pe;We>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=We),K.push(Pe+We/2)};for(let ne=0;ne<64;ne++)for(let ce=0;ce<64;ce++){const pe=65*ne+ce,we=pe+1,ke=pe+65,Re=ke+1;se(pe,ke,we),se(we,ke,Re)}[K,oe]=function(ne,ce){const pe=Array.from({length:ne.length},(Re,Pe)=>Pe);pe.sort((Re,Pe)=>ne[Re]-ne[Pe]);const we=[],ke=new Ja;for(let Re=0;Re<pe.length;Re++){const Pe=pe[Re];we.push(ne[Pe]);const We=3*Pe,Le=We+1;ke.emplaceBack(ce.uint16[We],ce.uint16[Le],ce.uint16[Le+1])}return[we,ke]}(K,oe),this.elevatedGlobeTrianglesCenterLongitudes=K,this.elevatedGlobeIndexBuffer=n.createIndexBuffer(oe)}this.elevatedGlobeSegments=Yi.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,q/pn,0,W/pn,0,0,z,R,0])}prepare(){const n=Object.keys(this.tiles).length!==0;if(this.tileID&&!n)return;const s=this.map.painter.context,h=s.gl;!this._dirty||this.texture instanceof S1||(this.texture?this.texture.update(this.image):(this.texture=new aS(s,this.image,h.RGBA8),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this._dirty=!1),n&&this._prepareData(s)}loadTile(n,s){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},s(null)):(n.state="errored",s(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(n){const s=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!s)return null;const h=this.elevatedGlobeTrianglesCenterLongitudes;let y=(d=n+180)+360*Math.round((h[0]-d)/360);var d;const v=new Yi,M=(D,B)=>{v.segments.push({vertexOffset:0,primitiveOffset:D,vertexLength:s.segments[0].vertexLength,primitiveLength:B,sortKey:void 0,vaos:{}})},k=.51*this.maxLongitudeTriangleSize;if(Math.abs(h[0]-y)<=k){const D=Bn(h,0,h.length,y+k);return D===h.length||M(D,nl(h,D+1,h.length,y+360-k)-D),v}y<h[0]&&(y+=360);const j=nl(h,0,h.length,y-k);if(j===h.length)return M(0,h.length),v;M(0,j-0);const E=Bn(h,j+1,h.length,y+k);return E!==h.length&&M(E,h.length-E),v}}const e9=(Math.pow(256,2)-1)/16907520;class $R extends Ca{constructor(n,s,h,y){super(n,{layout:UR||(UR=new Bi({visibility:new sn(_t.layout_raster.visibility)})),paint:VR||(VR=new Bi({"raster-opacity":new sn(_t.paint_raster["raster-opacity"]),"raster-color":new lh(_t.paint_raster["raster-color"]),"raster-color-mix":new sn(_t.paint_raster["raster-color-mix"]),"raster-color-range":new sn(_t.paint_raster["raster-color-range"]),"raster-hue-rotate":new sn(_t.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new sn(_t.paint_raster["raster-brightness-min"]),"raster-brightness-max":new sn(_t.paint_raster["raster-brightness-max"]),"raster-saturation":new sn(_t.paint_raster["raster-saturation"]),"raster-contrast":new sn(_t.paint_raster["raster-contrast"]),"raster-resampling":new sn(_t.paint_raster["raster-resampling"]),"raster-fade-duration":new sn(_t.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new sn(_t.paint_raster["raster-emissive-strength"]),"raster-array-band":new sn(_t.paint_raster["raster-array-band"]),"raster-elevation":new sn(_t.paint_raster["raster-elevation"]),"raster-color-use-theme":new En({type:"string",default:"default","property-type":"data-driven"})}))},s,h,y),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(n){return!(n&&n._source instanceof GR&&(n._source.onNorthPole||n._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(n){n!=="raster-color"&&n!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(n){if(!this.hasColorMap()||!this._curRampRange)return;const s=this._transitionablePaint._values["raster-color"].value.expression,[h,y]=n||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(h)&&isNaN(y)||h===this._curRampRange[0]&&y===this._curRampRange[1]||(this.colorRamp=Sd({expression:s,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:h,end:y}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[h,y])}}let HR,XR,YR,ZR,WR;class KR extends Ca{constructor(n,s,h,y){super(n,{layout:HR||(HR=new Bi({visibility:new sn(_t["layout_raster-particle"].visibility)})),paint:XR||(XR=new Bi({"raster-particle-array-band":new sn(_t["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new sn(_t["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new lh(_t["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new sn(_t["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new sn(_t["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new sn(_t["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new sn(_t["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new sn(_t["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new En({type:"string",default:"default","property-type":"data-driven"})}))},s,h,y),this._updateColorRamp(),this.lastInvalidatedAt=Fe.now()}onRemove(n){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(n){return!1}_handleSpecialPaintPropertyUpdate(n){n!=="raster-particle-color"&&n!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),n==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const n=this._transitionablePaint._values["raster-particle-color"].value.expression,s=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Sd({expression:n,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:s}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Fe.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class t9 extends Ca{constructor(n,s){super(n,{},s,null),this.implementation=n,n.slot&&(this.slot=n.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(n){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(n){this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)}onRemove(n){this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)}}function oS(u,n,s){const h=[0,0,1],y=Ne.quat.identity([]);return Ne.quat.rotateY(y,y,s?-hr(u)+Math.PI:hr(u)),Ne.quat.rotateX(y,y,-hr(n)),Ne.vec3.transformQuat(h,h,y),Ne.vec3.normalize(h,h)}function JR(u,n){const s=A1(u.projection,u.zoom,u.width,u.height),h=function(d,v,M,k,j){const E=new Gr(M.lng-180*Gp,M.lat),D=new Gr(M.lng+180*Gp,M.lat),B=d.project(E.lng,E.lat),R=d.project(D.lng,D.lat),z=-Math.atan2(R.y-B.y,R.x-B.x),q=l.fromLngLat(M);q.y=Mn(q.y,-1+Gp,1-Gp);const W=q.toLngLat(),K=d.project(W.lng,W.lat),oe=l.fromLngLat(W);oe.x+=Gp;const se=oe.toLngLat(),ne=d.project(se.lng,se.lat),ce=e3(ne.x-K.x,ne.y-K.y,z),pe=l.fromLngLat(W);pe.y+=Gp;const we=pe.toLngLat(),ke=d.project(we.lng,we.lat),Re=e3(ke.x-K.x,ke.y-K.y,z),Pe=Math.abs(ce.x)/Math.abs(Re.y),We=Ne.mat4.identity([]);Ne.mat4.rotateZ(We,We,-z*(1-(j?0:k)));const Le=Ne.mat4.identity([]);return Ne.mat4.scale(Le,Le,[1,1-(1-Pe)*k,1]),Le[4]=-Re.x/Re.y*k,Ne.mat4.rotateZ(Le,Le,z),Ne.mat4.multiply(Le,We,Le),Le}(u.projection,0,u.center,s,n),y=QR(u);return Ne.mat4.scale(h,h,[y,y,1]),h}function QR(u){const n=u.projection,s=A1(u.projection,u.zoom,u.width,u.height),h=sS(n,u.center),y=sS(n,Gr.convert(n.center));return Math.pow(2,h*s+(1-s)*y)}function A1(u,n,s,h,y=1/0){const d=u.range;if(!d)return 0;const v=Math.min(y,Math.max(s,h)),M=Math.log(v/1024)/Math.LN2;return no(d[0]+M,d[1]+M,n)}const Gp=1/4e4;function sS(u,n){const s=Mn(n.lat,-85.051129,hi),h=new Gr(n.lng-180*Gp,s),y=new Gr(n.lng+180*Gp,s),d=u.project(h.lng,s),v=u.project(y.lng,s),M=l.fromLngLat(h),k=l.fromLngLat(y),j=v.x-d.x,E=v.y-d.y,D=k.x-M.x,B=k.y-M.y,R=Math.sqrt((D*D+B*B)/(j*j+E*E));return Math.log(R)/Math.LN2}function e3(u,n,s){const h=Math.cos(s),y=Math.sin(s);return{x:u*h-n*y,y:u*y+n*h}}function t3(u,n,s){Ne.mat4.identity(u),Ne.mat4.rotateZ(u,u,hr(n[2])),Ne.mat4.rotateX(u,u,hr(n[0])),Ne.mat4.rotateY(u,u,hr(n[1])),Ne.mat4.scale(u,u,s),Ne.mat4.multiply(u,u,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function M1(u,n,s,h,y,d,v,M){const k=[s[0]-n[0],s[1]-n[1],0],j=[h[0]-n[0],h[1]-n[1],0];if(Ne.vec3.length(k)<1e-12||Ne.vec3.length(j)<1e-12)return Ne.quat.identity(u);const E=Ne.vec3.cross([],k,j);Ne.vec3.normalize(E,E),Ne.vec3.subtract(j,h,n),k[2]=(d-y)*M,j[2]=(v-y)*M;const D=k;return Ne.vec3.cross(D,k,j),Ne.vec3.normalize(D,D),Ne.quat.rotationTo(u,E,D)}function lS(u,n,s=!1){const h=xo(n.zoom),y=function(d,v,M){const k=v.worldSize,j=[d[12],d[13],d[14]],E=Pa(j[1]/k),D=qo(j[0]/k),B=Ne.mat4.identity([]),R=vo(1,E)*k,z=vo(1,0)*k*yh(E,v.zoom),q=1/oa(k);let W=z*q;if(M){const ne=A1(v.projection,v.zoom,v.width,v.height,1024);W=q*v.projection.pixelSpaceConversion(v.center.lat,k,ne)}const K=Ic(E,D);Ne.vec3.add(K,K,Ne.vec3.scale([],Ne.vec3.normalize([],K),R*W*j[2]));const oe=function(ne){const ce=[ne[0],ne[1],ne[2]];let pe=[0,1,0];const we=Ne.vec3.cross([],pe,ce);return Ne.vec3.cross(pe,ce,we),Ne.vec3.squaredLength(pe)===0&&(pe=[0,1,0],Ne.vec3.cross(we,ce,pe)),Ne.vec3.normalize(we,we),Ne.vec3.normalize(pe,pe),Ne.vec3.normalize(ce,ce),[we[0],we[1],we[2],0,pe[0],pe[1],pe[2],0,ce[0],ce[1],ce[2],0,ne[0],ne[1],ne[2],1]}(K);Ne.mat4.scale(B,B,[W,W,W*R]),Ne.mat4.translate(B,B,[-j[0],-j[1],-j[2]]);const se=Ne.mat4.multiply([],v.globeMatrix,oe);return Ne.mat4.multiply(se,se,B),Ne.mat4.multiply(se,se,d),se}(u,n,s);if(h>0){const d=function(v,M){const k=M.worldSize,j=vo(1,0)*k*yh(M.center.lat,M.zoom)/oa(k),E=vo(1,M.center.lat)*k,D=Ne.mat4.identity([]);return Ne.mat4.rotateY(D,D,hr(M.center.lng)),Ne.mat4.rotateX(D,D,hr(M.center.lat)),Ne.mat4.translate(D,D,[0,0,_o]),Ne.mat4.scale(D,D,[j,j,j*E]),Ne.mat4.translate(D,D,[M.point.x-.5*k,M.point.y-.5*k,0]),Ne.mat4.multiply(D,D,v),Ne.mat4.multiply(D,M.globeMatrix,D)}(u,n);return function(v,M,k){const j=(z,q,W)=>{const K=Ne.vec3.length(z),oe=Ne.vec3.length(q),se=Wi(z,q,W);return Ne.vec3.scale(se,se,1/Ne.vec3.length(se)*Nn(K,oe,W))},E=j([v[0],v[1],v[2]],[M[0],M[1],M[2]],k),D=j([v[4],v[5],v[6]],[M[4],M[5],M[6]],k),B=j([v[8],v[9],v[10]],[M[8],M[9],M[10]],k),R=Wi([v[12],v[13],v[14]],[M[12],M[13],M[14]],k);return[E[0],E[1],E[2],0,D[0],D[1],D[2],0,B[0],B[1],B[2],0,R[0],R[1],R[2],1]}(y,d,h)}return y}function n3(u,n,s,h){const y=Sn.projectAabbCorners(h,s);let d=Number.MAX_VALUE,v=-1;for(let j=0;j<y.length;++j){const E=y[j];E[0]=(.5*E[0]+.5)*n.width,E[1]=(.5-.5*E[1])*n.height,E[2]<d&&(v=j,d=E[2])}const M=j=>new $t(y[j][0],y[j][1]);let k;switch(v){case 0:case 6:k=[M(1),M(5),M(4),M(7),M(3),M(2),M(1)];break;case 1:case 7:k=[M(0),M(4),M(5),M(6),M(2),M(3),M(0)];break;case 3:case 5:k=[M(1),M(0),M(4),M(7),M(6),M(2),M(1)];break;default:k=[M(1),M(5),M(6),M(7),M(3),M(0),M(1)]}if(fe(u,k))return d}const n9=Yr([{name:"a_pos_3f",components:3,type:"Float32"}]),r9=Yr([{name:"a_color_3f",components:3,type:"Float32"}]),i9=Yr([{name:"a_color_4f",components:4,type:"Float32"}]),a9=Yr([{name:"a_uv_2f",components:2,type:"Float32"}]),o9=Yr([{name:"a_normal_3f",components:3,type:"Float32"}]),s9=Yr([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),l9=Yr([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),r3={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class O1{constructor(n,s,h,y){this.message=(n?`${n}: `:"")+h,y&&(this.identifier=y),s!=null&&s.__line__&&(this.line=s.__line__)}}function i3(u,n){const s=u.indexOf("://")===-1;try{return new URL(u,s&&n?"http://example.com":void 0),!0}catch{return!1}}class a3{constructor(n,s){this.feature=n,this.instancedDataOffset=s,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class o3{constructor(){this.instancedDataArray=new Ac,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class uS{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.projection=n.projection,this.index=n.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(n,s){}populate(n,s,h,y){this.tileToMeter=r(h);const d=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:v,id:M,index:k,sourceLayerIndex:j}of n){const E=M??(v.properties&&v.properties.hasOwnProperty("id")?v.properties.id:void 0),D=J(v,d);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),D,h))continue;const B={id:E,sourceLayerIndex:j,index:k,geometry:d?D.geometry:Z(v,h,y),properties:v.properties,type:v.type,patterns:{}},R=this.addFeature(B,B.geometry,D);R&&s.featureIndex.insert(v,B.geometry,k,j,this.index,this.instancesPerModel[R].instancedDataArray.length,pn/32)}this.lookup=null}update(n,s,h,y){for(const d in this.instancesPerModel){const v=this.instancesPerModel[d];for(const M in n)v.idToFeaturesIndex.hasOwnProperty(M)&&(this.evaluate(v.features[v.idToFeaturesIndex[M]],n[M],v,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let n=!1;for(const s in this.instancesPerModel){const h=this.instancesPerModel[s];for(const y of h.features){const d=this.layers[0],v=y.feature,M=this.canonical,k=d.paint.get("model-rotation").evaluate(v,{},M),j=d.paint.get("model-scale").evaluate(v,{},M),E=d.paint.get("model-translation").evaluate(v,{},M);Ne.vec3.exactEquals(y.rotation,k)&&Ne.vec3.exactEquals(y.scale,j)&&Ne.vec3.exactEquals(y.translation,E)||(this.evaluate(y,y.featureStates,h,!0),n=!0)}}return n}updateReplacement(n,s,h,y){if(s.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=s.updateTime;const d=s.getReplacementRegionsForTile(n.toUnwrapped(),!0);if(Fm(this.activeReplacements,d))return!1;this.activeReplacements=d;let v=!1;for(const M in this.instancesPerModel){const k=this.instancesPerModel[M],j=k.instancedDataArray;for(const E of k.features){const D=E.instancedDataOffset,B=E.instancedDataCount;for(let R=0;R<B;R++){const z=16*(R+D);let q=j.float32[z+0];const W=q>pn;q=W?q-pn:q;const K=Math.floor(q),oe=j.float32[z+1];let se=!1;for(const ne of this.activeReplacements)if(!ly(ne,h,r3.Model,y)&&!(ne.min.x>K||K>ne.max.x||ne.min.y>oe||oe>ne.max.y)&&(se=Kx(rv(K,oe,n.canonical,ne.footprintTileId.canonical),ne.footprint),se))break;j.float32[z]=se?q+pn:q,v=v||se!==W}}}return v}isEmpty(){for(const n in this.instancesPerModel)if(this.instancesPerModel[n].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(n){if(!this.uploaded)for(const s in this.instancesPerModel){const h=this.instancesPerModel[s];h.instancedDataArray.length<0||h.instancedDataArray.length===0||(h.instancedDataBuffer?h.instancedDataBuffer.updateData(h.instancedDataArray):h.instancedDataBuffer=n.createVertexBuffer(h.instancedDataArray,s9.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const s in this.instancesPerModel){const h=this.instancesPerModel[s];h.instancedDataArray.length!==0&&h.instancedDataBuffer&&h.instancedDataBuffer.destroy()}const n=this.layers[0].modelManager;if(n&&this.modelUris)for(const s of this.modelUris)n.removeModel(s,"")}addFeature(n,s,h){const y=this.layers[0],d=y.layout.get("model-id").evaluate(h,{},this.canonical);if(!d)return lr(`modelId is not evaluated for layer ${y.id} and it is not going to get rendered.`),d;i3(d,!1)&&(this.modelUris.includes(d)||this.modelUris.push(d)),this.instancesPerModel[d]||(this.instancesPerModel[d]=new o3);const v=this.instancesPerModel[d],M=v.instancedDataArray,k=new a3(h,M.length);for(const j of s)for(const E of j){if(E.x<0||E.x>=pn||E.y<0||E.y>=pn)continue;const D=(this.lookupDim-1)/pn,B=this.lookupDim*(E.y*D|0)+E.x*D|0;if(this.lookup){if(this.lookup[B]!==0)continue;this.lookup[B]=1}this.instanceCount++;const R=M.length;M.resize(R+1),v.instancesEvaluatedElevation.push(0),M.float32[16*R]=E.x,M.float32[16*R+1]=E.y}return k.instancedDataCount=v.instancedDataArray.length-k.instancedDataOffset,k.instancedDataCount>0&&(n.id&&(v.idToFeaturesIndex[n.id]=v.features.length),v.features.push(k),this.evaluate(k,{},v,!1)),d}getModelUris(){return this.modelUris}evaluate(n,s,h,y){const d=this.layers[0],v=n.feature,M=this.canonical,k=n.rotation=d.paint.get("model-rotation").evaluate(v,s,M),j=n.scale=d.paint.get("model-scale").evaluate(v,s,M),E=n.translation=d.paint.get("model-translation").evaluate(v,s,M),D=d.paint.get("model-color").evaluate(v,s,M);D.a=d.paint.get("model-color-mix-intensity").evaluate(v,s,M);const B=[];this.maxVerticalOffset<E[2]&&(this.maxVerticalOffset=E[2]),this.maxScale=Math.max(Math.max(this.maxScale,j[0]),Math.max(j[1],j[2])),t3(B,k,j);const R=Math.round(100*D.a)+D.b/1.05;for(let z=0;z<n.instancedDataCount;++z){const q=n.instancedDataOffset+z,W=16*q,K=h.instancedDataArray.float32;let oe=0;y&&(oe=K[W+6]-h.instancesEvaluatedElevation[q]);const se=0|K[W+1];K[W]=(0|K[W])+D.r/1.05,K[W+1]=se+D.g/1.05,K[W+2]=R,K[W+3]=1/(M.z>10?this.tileToMeter:r(M,se)),K[W+4]=E[0],K[W+5]=E[1],K[W+6]=E[2]+oe,K[W+7]=B[0],K[W+8]=B[1],K[W+9]=B[2],K[W+10]=B[4],K[W+11]=B[5],K[W+12]=B[6],K[W+13]=B[8],K[W+14]=B[9],K[W+15]=B[10],h.instancesEvaluatedElevation[q]=E[2]}}}let s3,l3;In(uS,"ModelBucket",{omit:["layers"]}),In(o3,"PerModelAttributes"),In(a3,"ModelFeature");const Km=64,Ey={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function u3(u,n,s,h,y,d,v,M,k,j=!1){const E=s.zoom,D=s.project(h),B=yh(h.lat,E),R=1/B;Ne.mat4.identity(u),Ne.mat4.translate(u,u,[D.x+v[0]*R,D.y+v[1]*R,v[2]]);let z=1,q=1;const W=s.worldSize;if(j){if(s.projection.name==="mercator"){let ne=0;s.elevation&&(ne=s.elevation.getAtPointOrZero(new l(D.x/W,D.y/W),0));const ce=Ne.vec4.transformMat4([],[D.x,D.y,ne,1],s.projMatrix)[3]/s.cameraToCenterDistance;z=ce,q=ce*yh(s.center.lat,E)}else if(s.projection.name==="globe"){const ne=lS(u,s),ce=Ne.mat4.multiply([],s.projMatrix,ne),pe=[0,0,0,1];Ne.vec4.transformMat4(pe,pe,ce);const we=pe[3]/s.cameraToCenterDistance,ke=xo(E),Re=s.projection.pixelsPerMeter(h.lat,W)*yh(h.lat,E),Pe=s.projection.pixelsPerMeter(s.center.lat,W)*yh(s.center.lat,E);z=we/Nn(Re,bd(s.center.lat),ke),q=we*B/Re,z*=Pe,q*=Pe}}else z=R;Ne.mat4.scale(u,u,[z,z,q]);const K=[...u],oe=n.orientation,se=[];if(t3(se,[oe[0]+y[0],oe[1]+y[1],oe[2]+y[2]],d),Ne.mat4.multiply(u,K,se),M&&s.elevation){let ne=0;const ce=[];if(k&&s.elevation){ne=function(ke,Re,Pe,We,Le){const Je=Re.elevation;if(!Je)return 0;const it=Sn.projectAabbCorners(Pe,We),tt=vo(1,Le.lat)*Re.worldSize,ot=function(zn,Tn){const Pn=[0,0,1],ir=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const gr of ir){const wr=zn[gr.corners[0]],Sr=zn[gr.corners[1]],kr=zn[gr.corners[2]],Lr=[Sr[0]-wr[0],Sr[1]-wr[1],Tn*(Sr[2]-wr[2])],Ai=Ne.vec3.cross(Lr,Lr,[kr[0]-wr[0],kr[1]-wr[1],Tn*(kr[2]-wr[2])]);Ne.vec3.normalize(Ai,Ai),gr.dotProductWithUp=Ne.vec3.dot(Ai,Pn)}return ir.sort((gr,wr)=>gr.dotProductWithUp-wr.dotProductWithUp),ir[0].corners}(it,tt),ut=it[ot[0]],pt=it[ot[1]],lt=it[ot[2]],Lt=it[ot[3]],Wt=Je.getAtPointOrZero(new l(ut[0]/Re.worldSize,ut[1]/Re.worldSize),0),Rt=Je.getAtPointOrZero(new l(pt[0]/Re.worldSize,pt[1]/Re.worldSize),0),xn=Je.getAtPointOrZero(new l(lt[0]/Re.worldSize,lt[1]/Re.worldSize),0),mn=Je.getAtPointOrZero(new l(Lt[0]/Re.worldSize,Lt[1]/Re.worldSize),0),on=(Wt+mn)/2,en=(Rt+xn)/2;return on>en?Rt<xn?M1(ke,pt,Lt,ut,Rt,mn,Wt,tt):M1(ke,lt,ut,Lt,xn,Wt,mn,tt):Wt<mn?M1(ke,ut,pt,lt,Wt,Rt,xn,tt):M1(ke,Lt,lt,pt,mn,xn,Rt,tt),Math.max(on,en)}(ce,s,n.aabb,u,h);const pe=Ne.mat4.fromQuat([],ce),we=Ne.mat4.multiply([],pe,se);Ne.mat4.multiply(u,K,we)}else ne=s.elevation.getAtPointOrZero(new l(D.x/W,D.y/W),0);ne!==0&&(u[14]+=ne)}}function Pv(u,n,s=!1){u.uploaded||(u.gfxTexture=new aS(n,u.image,s?n.gl.R8:n.gl.RGBA8,{useMipmap:u.sampler.minFilter>=n.gl.NEAREST_MIPMAP_NEAREST}),u.uploaded=!0,u.image=null)}function u9(u,n,s){u.indexBuffer=n.createIndexBuffer(u.indexArray,!1,!0),u.vertexBuffer=n.createVertexBuffer(u.vertexArray,n9.members,!1,!0),u.normalArray&&(u.normalBuffer=n.createVertexBuffer(u.normalArray,o9.members,!1,!0)),u.texcoordArray&&(u.texcoordBuffer=n.createVertexBuffer(u.texcoordArray,a9.members,!1,!0)),u.colorArray&&(u.colorBuffer=n.createVertexBuffer(u.colorArray,(u.colorArray.bytesPerElement===12?r9:i9).members,!1,!0)),u.featureArray&&(u.pbrBuffer=n.createVertexBuffer(u.featureArray,l9.members,!0)),u.segments=Yi.simpleSegment(0,0,u.vertexArray.length,u.indexArray.length);const h=u.material;h.pbrMetallicRoughness.baseColorTexture&&Pv(h.pbrMetallicRoughness.baseColorTexture,n),h.pbrMetallicRoughness.metallicRoughnessTexture&&Pv(h.pbrMetallicRoughness.metallicRoughnessTexture,n),h.normalTexture&&Pv(h.normalTexture,n),h.occlusionTexture&&Pv(h.occlusionTexture,n,s),h.emissionTexture&&Pv(h.emissionTexture,n)}function cS(u,n,s){if(u.meshes)for(const h of u.meshes)u9(h,n,s);if(u.children)for(const h of u.children)cS(h,n,s)}function I1(u){if(u.meshes)for(const n of u.meshes)n.indexArray.destroy(),n.vertexArray.destroy(),n.colorArray&&n.colorArray.destroy(),n.normalArray&&n.normalArray.destroy(),n.texcoordArray&&n.texcoordArray.destroy(),n.featureArray&&n.featureArray.destroy();if(u.children)for(const n of u.children)I1(n)}function hS(u){if(u.meshes)for(const s of u.meshes)s.vertexBuffer&&(s.vertexBuffer.destroy(),s.indexBuffer.destroy(),s.normalBuffer&&s.normalBuffer.destroy(),s.texcoordBuffer&&s.texcoordBuffer.destroy(),s.colorBuffer&&s.colorBuffer.destroy(),s.pbrBuffer&&s.pbrBuffer.destroy(),s.segments.destroy(),s.material&&((n=s.material).pbrMetallicRoughness.baseColorTexture&&n.pbrMetallicRoughness.baseColorTexture.gfxTexture&&n.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),n.pbrMetallicRoughness.metallicRoughnessTexture&&n.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&n.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),n.normalTexture&&n.normalTexture.gfxTexture&&n.normalTexture.gfxTexture.destroy(),n.emissionTexture&&n.emissionTexture.gfxTexture&&n.emissionTexture.gfxTexture.destroy(),n.occlusionTexture&&n.occlusionTexture.gfxTexture&&n.occlusionTexture.gfxTexture.destroy()));var n;if(u.children)for(const s of u.children)hS(s)}class Ay{constructor(n,s,h){this._demTile=n,this._dem=this._demTile.dem,this._scale=s,this._offset=h}static create(n,s,h){const y=h||n.findDEMTileFor(s);if(!y||!y.dem)return;const d=y.dem,v=y.tileID,M=1<<s.canonical.z-v.canonical.z;return new Ay(y,d.dim/pn/M,[(s.canonical.x/M-v.canonical.x)*d.dim,(s.canonical.y/M-v.canonical.y)*d.dim])}tileCoordToPixel(n,s){const h=s*this._scale+this._offset[1],y=Math.floor(n*this._scale+this._offset[0]),d=Math.floor(h);return new $t(y,d)}getElevationAt(n,s,h,y){const d=n*this._scale+this._offset[0],v=s*this._scale+this._offset[1],M=Math.floor(d),k=Math.floor(v),j=this._dem;return y=!!y,h?Nn(Nn(j.get(M,k,y),j.get(M,k+1,y),v-k),Nn(j.get(M+1,k,y),j.get(M+1,k+1,y),v-k),d-M):j.get(M,k,y)}getElevationAtPixel(n,s,h){return this._dem.get(n,s,!!h)}getMeterToDEM(n){return(1<<this._demTile.tileID.canonical.z)*vo(1,n)*this._dem.stride}}const fS=new Float32Array(262144),Jm=new Uint8Array(262144);function c3(u){let n=0;if(u.meshes)for(const s of u.meshes)n=Math.max(n,s.aabb.max[2]);if(u.children)for(const s of u.children)n=Math.max(n,c3(s));return n}function h3(u,n,s){if(u.meshes)for(const h of u.meshes){if(h.aabb.min[0]===1/0)continue;const y=Sn.applyTransform(h.aabb,u.matrix);s.insert(n,y.min[0],y.min[1],y.max[0],y.max[1])}if(u.children)for(const h of u.children)h3(h,n,s)}const f3=["","wall","door","roof","window","lamp","logo"];class d3{constructor(n){this.node=n,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:n.id,geometry:[],properties:{height:c3(n)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new Sn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let n=0;const s=new Sn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const h of this.node.meshes)this.node.lightMeshIndex!==n&&(h.transformedAabb=Sn.applyTransformFast(h.aabb,this.node.matrix),s.encapsulate(h.transformedAabb)),n++;this.aabb=s}return this.aabb}}class C1{constructor(n,s,h,y,d,v,M){this.id=h,this.layers=n,this.layerIds=this.layers.map(k=>k.fqid),this.stateDependentLayerIds=this.layers.filter(k=>k.isStateDependent()).map(k=>k.id),this.modelTraits|=Ey.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,y&&(this.modelTraits|=Ey.HasMapboxMeshFeatures),d&&(this.modelTraits|=Ey.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=v,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const k of s)this.nodesInfo.push(new d3(k)),h3(k,M.featureIndexArray.length,M.grid),M.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,M.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(n,s){for(const h of this.getNodesInfo()){const y=h.node;y.footprint&&s.push({footprint:y.footprint,id:n})}}update(n){const s=Object.keys(n).length!==0;if(s&&!this.stateDependentLayers.length)return;const h=s?this.stateDependentLayers:this.layers;if(!Ur(n,this.states))for(const y of h)this.evaluate(y,n);this.states=structuredClone(n)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(n){if(!this.needsUpload)return;const s=this.getNodesInfo();for(const h of s){const y=h.node;this.uploaded?this.updatePbrBuffer(y):cS(y,n,!0)}for(const h of s)I1(h.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(n){let s=!1;if(!n.meshes)return s;for(const h of n.meshes)h.pbrBuffer&&(h.pbrBuffer.updateData(h.featureArray),s=!0);return s}needsReEvaluation(n,s,h){const y=n.transform.projectionOptions,d=n.style.getBrightness(),v=this.brightness!==d;if(!this.uploaded||this.dirty||y.name!==this.projection.name||Rv(h.paint.get("model-color").value,v)||Rv(h.paint.get("model-color-mix-intensity").value,v)||Rv(h.paint.get("model-roughness").value,v)||Rv(h.paint.get("model-emissive-strength").value,v)||Rv(h.paint.get("model-height-based-emissive-strength-multiplier").value,v)){this.projection=y,this.brightness=d;const M=this.getNodesInfo();for(const k of M)k.state=null;return!0}return!1}evaluateScale(n,s){if(n.transform.zoom===this.zoom)return;this.zoom=n.transform.zoom;const h=this.getNodesInfo(),y=this.id.canonical;for(const d of h){const v=d.feature;d.evaluatedScale=s.paint.get("model-scale").evaluate(v,{},y)}}evaluate(n,s){const h=this.getNodesInfo();for(const y of h){if(!y.node.meshes)continue;const d=y.feature,v=s&&s[d.id];if(Ur(v,y.state))continue;y.state=structuredClone(v);const M=y.node.meshes&&y.node.meshes[0].featureData,k=y.evaluatedColor[2],j=y.evaluatedRMEA[2],E=this.id.canonical;if(y.hasTranslucentParts=!1,M){for(let D=0;D<f3.length;D++){const B=f3[D];B.length&&(d.properties.part=B);const R=n.paint.get("model-color").evaluate(d,v,E).toRenderColor(null),z=n.paint.get("model-color-mix-intensity").evaluate(d,v,E);y.evaluatedColor[D]=[R.r,R.g,R.b,z],y.evaluatedRMEA[D][0]=n.paint.get("model-roughness").evaluate(d,v,E),y.evaluatedRMEA[D][2]=n.paint.get("model-emissive-strength").evaluate(d,v,E),y.evaluatedRMEA[D][3]=R.a,y.emissionHeightBasedParams[D]=n.paint.get("model-height-based-emissive-strength-multiplier").evaluate(d,v,E),!y.hasTranslucentParts&&R.a<1&&(y.hasTranslucentParts=!0)}delete d.properties.part,h9(y,k!==y.evaluatedColor[2]||j!==y.evaluatedRMEA[2],this.modelTraits)}else y.evaluatedRMEA[0][2]=n.paint.get("model-emissive-strength").evaluate(d,v,E);y.evaluatedScale=n.paint.get("model-scale").evaluate(d,v,E),this.updatePbrBuffer(y.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(n,s,h,y){const d=n.findDEMTileFor(h);if(d&&(d.tileID.canonical!==this.terrainTile||s!==this.terrainExaggeration)){if(d.dem&&d.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=d.tileID.overscaledZ;const v=Ay.create(n,h,d);if(!v)return;this.modelTraits&Ey.HasMapboxMeshFeatures&&this.updateDEM(n,v,h,y);for(const M of this.getNodesInfo()){const k=M.node;if(!k.footprint||!k.footprint.vertices||!k.footprint.vertices.length)continue;const j=k.footprint.vertices;let E=v.getElevationAt(j[0].x,j[0].y,!0,!0);for(let D=1;D<j.length;D++)E=Math.min(E,v.getElevationAt(j[D].x,j[D].y,!0,!0));k.elevation=E}}this.terrainTile=d.tileID.canonical,this.terrainExaggeration=s}}updateDEM(n,s,h,y){let d=s._dem._modifiedForSources[y];if(d===void 0&&(s._dem._modifiedForSources[y]=[],d=s._dem._modifiedForSources[y]),d.includes(h.canonical))return;const v=s._dem.dim;d.push(h.canonical);let M=!1;for(const k of this.getNodesInfo()){const j=k.node;if(!j.footprint||!j.footprint.grid)continue;const E=j.footprint.grid,D=s.tileCoordToPixel(E.min.x,E.min.y),B=s.tileCoordToPixel(E.max.x,E.max.y),R=Math.min(Math.min(v-B.y,D.x),Math.min(D.y,v-B.x));if(R<0)continue;const z=Mn(R,2,5);let q=Math.max(0,D.x-z),W=Math.max(0,D.y-z),K=Math.min(B.x+z,v-1),oe=Math.min(B.y+z,v-1);for(let pe=W;pe<=oe;++pe)for(let we=q;we<=K;++we)Jm[pe*v+we]=255;let se=0,ne=0;for(let pe=0;pe<E.cellsY;++pe)for(let we=0;we<E.cellsX;++we){if(!E.cells[pe*E.cellsX+we])continue;const ke=s.tileCoordToPixel(E.min.x+we/E.xScale,E.min.y+pe/E.yScale),Re=s.tileCoordToPixel(E.min.x+(we+1)/E.xScale,E.min.y+(pe+1)/E.yScale);for(let Pe=ke.y;Pe<=Math.min(Re.y+1,v-1);++Pe)for(let We=ke.x;We<=Math.min(Re.x+1,v-1);++We)Jm[Pe*v+We]===255&&(Jm[Pe*v+We]=0,se+=s.getElevationAtPixel(We,Pe),ne++)}const ce=se/ne;q=Math.max(1,D.x-z),W=Math.max(1,D.y-z),K=Math.min(B.x+z,v-2),oe=Math.min(B.y+z,v-2),M=!0;for(let pe=W;pe<=oe;++pe)for(let we=q;we<=K;++we)Jm[pe*v+we]===0&&(fS[pe*v+we]=s._dem.set(we,pe,ce));for(let pe=1;pe<z;++pe){q=Math.max(1,D.x-pe),W=Math.max(1,D.y-pe),K=Math.min(B.x+pe,v-2),oe=Math.min(B.y+pe,v-2);for(let we=W;we<=oe;++we)for(let ke=q;ke<=K;++ke){const Re=we*v+ke;if(Jm[Re]===255){let Pe=0,We=0,Le=-1,Je=-1;for(let it=-1;it<=1;++it)for(let tt=-1;tt<=1;++tt){const ot=(we+it)*v+ke+tt;if(Jm[ot]>=pe)continue;const ut=fS[ot],pt=Math.abs(ut);pt>We&&(Pe=ut,We=pt,Le=tt,Je=it)}if(We>.1){const it=1-(pe+.5*Math.abs(Le*Je))/z;let tt=s._dem.get(ke,we)+Pe*it;const ot=s._dem.get(ke+Le,we+Je),ut=s._dem.get(ke-Le,we-Je,!0);(tt-ot)*(tt-ut)>0&&(tt=(ot+ut)/2),fS[Re]=s._dem.set(ke,we,tt),Jm[Re]=pe}}}}}M&&(s._demTile.needsDEMTextureUpload=!0,s._dem._timestamp=Fe.now())}getNodesInfo(){return this.nodesInfo}destroy(){const n=this.getNodesInfo();for(const s of n)I1(s.node),hS(s.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(n,s){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const h=s.getReplacementRegionsForTile(n.toUnwrapped()),y=this.getNodesInfo();for(let d=0;d<this.nodesInfo.length;d++){const v=y[d].node;y[d].hiddenByReplacement=!!v.footprint&&!h.find(M=>M.footprint===v.footprint)}}getHeightAtTileCoord(n,s){const h=this.getNodesInfo(),y=[],d=[0,0,0],v=Ne.mat4.identity([]);for(let M=0;M<this.nodesInfo.length;M++){const k=h[M],j=k.node.meshes[0],E=j.transformedAabb;if(n<E.min[0]||s<E.min[1]||n>E.max[0]||s>E.max[1])continue;if(k.node.hidden===!0)return{height:1/0,maxHeight:k.feature.properties.height,hidden:!1,verticalScale:k.evaluatedScale[2]};Ne.mat4.invert(v,k.node.matrix),d[0]=n,d[1]=s,Ne.vec3.transformMat4(d,d,v);const D=(d[0]-j.aabb.min[0])/(j.aabb.max[0]-j.aabb.min[0])*Km|0,B=Math.min(63,(d[1]-j.aabb.min[1])/(j.aabb.max[1]-j.aabb.min[1])*Km|0)*Km+Math.min(63,D),R=j.heightmap[B];if(!(R<0&&k.node.footprint))return k.hiddenByReplacement?void 0:{height:R,maxHeight:k.feature.properties.height,hidden:!1,verticalScale:k.evaluatedScale[2]};if(k.node.footprint.grid.query(new $t(n,s),new $t(n,s),y),y.length>0)return{height:void 0,maxHeight:k.feature.properties.height,hidden:k.hiddenByReplacement,verticalScale:k.evaluatedScale[2]}}}}function Rv(u,n){return!u.isLightConstant&&n}function c9(u,n,s,h,y,d,v,M){let k=(61440&n|(61440&n)>>4)>>8,j=(3840&n|(3840&n)>>4)>>4,E=240&n|(240&n)>>4;s[3]>0&&(k=Nn(k,255*s[0],s[3]),j=Nn(j,255*s[1],s[3]),E=Nn(E,255*s[2],s[3]));const D=k<<8|j,B=E<<8|Math.floor(255*h[3]),R=function(pe){const we=Mn(pe,0,2);return Math.min(Math.round(.5*we*255),255)}(h[2])<<8|15*h[0]<<4|15*h[1],z=Mn(y[0],0,1),q=Mn(y[1],0,1),W=Mn(y[2],0,1),K=Mn(y[3],0,1);let oe,se,ne,ce;if(z!==q&&v!==d&&q!==z){const pe=v-d;se=1/(pe*(q-z)),ne=-(d+pe*z)/(pe*(q-z));const we=Mn(y[4],-1,1);ce=Math.pow(10,we),oe=255*W<<8|255*K}else oe=65535,se=0,ne=1,ce=1;if(u.emplaceBack(D,B,R,oe,se,ne,ce),M){const pe=M.length;M.clear();for(let we=0;we<pe;we++)M.emplaceBack(D,B,R,oe,se,ne,ce)}}function h9(u,n,s){const h=u.node;let y=0;const d=s&Ey.HasMeshoptCompression;for(const v of h.meshes){if(h.lights&&h.lightMeshIndex===y||!v.featureData)continue;v.featureArray=new hf,v.featureArray.reserve(v.featureData.length);let M=n;for(const k of v.featureData){const j=d?65535&k:k>>16&65535,E=d?k>>16&65535:65535&k,D=(15&E)<8?15&E:0,B=u.evaluatedRMEA[D],R=u.evaluatedColor[D],z=u.emissionHeightBasedParams[D];let q;if(M&&D===2&&h.lights&&(q=new hf,q.resize(10*h.lights.length)),c9(v.featureArray,j,R,B,z,v.aabb.min[2],v.aabb.max[2],q),q&&M){M=!1;const W=h.meshes[h.lightMeshIndex];W.featureArray=q,W.featureArray._trim()}}v.featureArray._trim(),y++}}function p3(u,n,s,h){const y=1<<u.z;n.lat=Pa((h/pn+u.y)/y),n.lng=qo((s/pn+u.x)/y)}In(C1,"Tiled3dModelBucket",{omit:["layers"]}),In(d3,"Tiled3dModelFeature");const f9={circle:class extends Ca{constructor(u,n,s,h){super(u,{layout:Qt||(Qt=new Bi({"circle-sort-key":new En(_t.layout_circle["circle-sort-key"]),"circle-elevation-reference":new sn(_t.layout_circle["circle-elevation-reference"]),visibility:new sn(_t.layout_circle.visibility)})),paint:ht||(ht=new Bi({"circle-radius":new En(_t.paint_circle["circle-radius"]),"circle-color":new En(_t.paint_circle["circle-color"]),"circle-blur":new En(_t.paint_circle["circle-blur"]),"circle-opacity":new En(_t.paint_circle["circle-opacity"]),"circle-translate":new sn(_t.paint_circle["circle-translate"]),"circle-translate-anchor":new sn(_t.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new sn(_t.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new sn(_t.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new En(_t.paint_circle["circle-stroke-width"]),"circle-stroke-color":new En(_t.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new En(_t.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new sn(_t.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new En({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new En({type:"string",default:"default","property-type":"data-driven"})}))},n,s,h)}createBucket(u){return new ye(u)}queryRadius(u){const n=u;return jt("circle-radius",this,n)+jt("circle-stroke-width",this,n)+It(this.paint.get("circle-translate"))}queryIntersectsFeature(u,n,s,h,y,d,v,M){const k=At(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),d.angle,u.pixelToTileUnitsFactor),j=this.paint.get("circle-radius").evaluate(n,s)+this.paint.get("circle-stroke-width").evaluate(n,s);return Pc(u,h,d,v,M,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",k,j)}getProgramIds(){return["circle"]}getDefaultProgramParams(u,n,s){const h=Cc(this);return{config:new gu(this,{zoom:n,lut:s}),defines:h,overrideFog:!1}}},heatmap:class extends Ca{createBucket(u){return new H_(u)}constructor(u,n,s,h){super(u,{layout:Xg||(Xg=new Bi({visibility:new sn(_t.layout_heatmap.visibility)})),paint:X_||(X_=new Bi({"heatmap-radius":new En(_t.paint_heatmap["heatmap-radius"]),"heatmap-weight":new En(_t.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new sn(_t.paint_heatmap["heatmap-intensity"]),"heatmap-color":new lh(_t.paint_heatmap["heatmap-color"]),"heatmap-opacity":new sn(_t.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new En({type:"string",default:"default","property-type":"data-driven"})}))},n,s,h),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Sd({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(u){return jt("heatmap-radius",this,u)}queryIntersectsFeature(u,n,s,h,y,d,v,M){const k=this.paint.get("heatmap-radius").evaluate(n,s);return Pc(u,h,d,v,M,!0,!0,new $t(0,0),k)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(u,n,s){return u==="heatmap"?{config:new gu(this,{zoom:n,lut:s}),overrideFog:!1}:{}}},hillshade:class extends Ca{constructor(u,n,s,h){super(u,{layout:Bx||(Bx=new Bi({visibility:new sn(_t.layout_hillshade.visibility)})),paint:Rc||(Rc=new Bi({"hillshade-illumination-direction":new sn(_t.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new sn(_t.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new sn(_t.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new sn(_t.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new sn(_t.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new sn(_t.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new sn(_t.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new En({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new En({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new En({type:"string",default:"default","property-type":"data-driven"})}))},n,s,h)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(u,n,s){return{overrideFog:!1}}},fill:class extends Ca{constructor(u,n,s,h){super(u,{layout:$x||($x=new Bi({"fill-sort-key":new En(_t.layout_fill["fill-sort-key"]),visibility:new sn(_t.layout_fill.visibility),"fill-elevation-reference":new sn(_t.layout_fill["fill-elevation-reference"])})),paint:ry||(ry=new Bi({"fill-antialias":new sn(_t.paint_fill["fill-antialias"]),"fill-opacity":new En(_t.paint_fill["fill-opacity"]),"fill-color":new En(_t.paint_fill["fill-color"]),"fill-outline-color":new En(_t.paint_fill["fill-outline-color"]),"fill-translate":new sn(_t.paint_fill["fill-translate"]),"fill-translate-anchor":new sn(_t.paint_fill["fill-translate-anchor"]),"fill-pattern":new En(_t.paint_fill["fill-pattern"]),"fill-emissive-strength":new sn(_t.paint_fill["fill-emissive-strength"]),"fill-z-offset":new En(_t.paint_fill["fill-z-offset"]),"fill-color-use-theme":new En({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new En({type:"string",default:"default","property-type":"data-driven"})}))},n,s,h)}getProgramIds(){const u=this.paint.get("fill-pattern"),n=u&&u.constantOr(1),s=[n?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&s.push(n&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),s}getDefaultProgramParams(u,n,s){return{config:new gu(this,{zoom:n,lut:s}),overrideFog:!1}}recalculate(u,n){super.recalculate(u,n);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(u){return new ny(u)}queryRadius(){return It(this.paint.get("fill-translate"))}queryIntersectsFeature(u,n,s,h,y,d){return!u.queryGeometry.isAboveHorizon&&_e(ft(u.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),d.angle,u.pixelToTileUnitsFactor),h)}isTileClipped(){return!0}is3D(){return this.paint.get("fill-z-offset").constantOr(1)!==0}},"fill-extrusion":class extends Ca{constructor(u,n,s,h){super(u,{layout:Vm||(Vm=new Bi({visibility:new sn(_t["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new sn(_t["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:dy||(dy=new Bi({"fill-extrusion-opacity":new sn(_t["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new En(_t["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new sn(_t["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new sn(_t["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new En(_t["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new En(_t["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new En(_t["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new sn(_t["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new sn(_t["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new sn(_t["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new sn(_t["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new sn(_t["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new sn(_t["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new sn(_t["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new sn(_t["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new sn(_t["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new sn(_t["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new En(_t["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new En(_t["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new sn(_t["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new sn(_t["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new sn(_t["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new sn(_t["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new En(_t["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new En(_t["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new sn(_t["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new En({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new En({type:"string",default:"default","property-type":"data-driven"})}))},n,s,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(u){return new fy(u)}queryRadius(){return It(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(u,n,s,h,y,d,v,M,k){const j=At(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),d.angle,u.pixelToTileUnitsFactor),E=this.paint.get("fill-extrusion-height").evaluate(n,s),D=this.paint.get("fill-extrusion-base").evaluate(n,s),B=[0,0],R=M&&d.elevation,z=d.elevation?d.elevation.exaggeration():1,q=u.tile.getBucket(this);if(R&&q instanceof fy){const ne=q.centroidVertexArray,ce=k+1;ce<ne.length&&(B[0]=ne.geta_centroid_pos0(ce),B[1]=ne.geta_centroid_pos1(ce))}if(B[0]===0&&B[1]===1)return!1;d.projection.name==="globe"&&(h=jp([h],[new $t(0,0),new $t(pn,pn)],u.tileID.canonical).map(ne=>ne.polygon).flat());const W=R?M:null,[K,oe]=function(ne,ce,pe,we,ke,Re,Pe,We,Le,Je,it){return ne.projection.name==="globe"?function(tt,ot,ut,pt,lt,Lt,Wt,Rt,xn,mn,on){const en=[],zn=[],Tn=tt.projection.upVectorScale(on,tt.center.lat,tt.worldSize).metersToTile,Pn=[0,0,0,1],ir=[0,0,0,1],gr=(Sr,kr,Lr,Ai)=>{Sr[0]=kr,Sr[1]=Lr,Sr[2]=Ai,Sr[3]=1},wr=Pd();ut>0&&(ut+=wr),pt+=wr;for(const Sr of ot){const kr=[],Lr=[];for(const Ai of Sr){const si=Ai.x+lt.x,cr=Ai.y+lt.y,ai=tt.projection.projectTilePoint(si,cr,on),oi=tt.projection.upVector(on,Ai.x,Ai.y);let Fi=ut,va=pt;if(Wt){const Va=uv(si,cr,ut,pt,Wt,Rt,xn,mn);Fi+=Va.base,va+=Va.top}ut!==0?gr(Pn,ai.x+oi[0]*Tn*Fi,ai.y+oi[1]*Tn*Fi,ai.z+oi[2]*Tn*Fi):gr(Pn,ai.x,ai.y,ai.z),gr(ir,ai.x+oi[0]*Tn*va,ai.y+oi[1]*Tn*va,ai.z+oi[2]*Tn*va),Ne.vec3.transformMat4(Pn,Pn,Lt),Ne.vec3.transformMat4(ir,ir,Lt),kr.push(new Dc(Pn[0],Pn[1],Pn[2])),Lr.push(new Dc(ir[0],ir[1],ir[2]))}en.push(kr),zn.push(Lr)}return[en,zn]}(ne,ce,pe,we,ke,Re,Pe,We,Le,Je,it):Pe?function(tt,ot,ut,pt,lt,Lt,Wt,Rt,xn){const mn=[],on=[],en=[0,0,0,1];for(const zn of tt){const Tn=[],Pn=[];for(const ir of zn){const gr=ir.x+pt.x,wr=ir.y+pt.y,Sr=uv(gr,wr,ot,ut,Lt,Wt,Rt,xn);en[0]=gr,en[1]=wr,en[2]=Sr.base,en[3]=1,Ne.vec4.transformMat4(en,en,lt),en[3]=Math.max(en[3],1e-5);const kr=new Dc(en[0]/en[3],en[1]/en[3],en[2]/en[3]);en[0]=gr,en[1]=wr,en[2]=Sr.top,en[3]=1,Ne.vec4.transformMat4(en,en,lt),en[3]=Math.max(en[3],1e-5);const Lr=new Dc(en[0]/en[3],en[1]/en[3],en[2]/en[3]);Tn.push(kr),Pn.push(Lr)}mn.push(Tn),on.push(Pn)}return[mn,on]}(ce,pe,we,ke,Re,Pe,We,Le,Je):function(tt,ot,ut,pt,lt){const Lt=[],Wt=[],Rt=lt[8]*ot,xn=lt[9]*ot,mn=lt[10]*ot,on=lt[11]*ot,en=lt[8]*ut,zn=lt[9]*ut,Tn=lt[10]*ut,Pn=lt[11]*ut;for(const ir of tt){const gr=[],wr=[];for(const Sr of ir){const kr=Sr.x+pt.x,Lr=Sr.y+pt.y,Ai=lt[0]*kr+lt[4]*Lr+lt[12],si=lt[1]*kr+lt[5]*Lr+lt[13],cr=lt[2]*kr+lt[6]*Lr+lt[14],ai=lt[3]*kr+lt[7]*Lr+lt[15],oi=Ai+Rt,Fi=si+xn,va=cr+mn,Va=Math.max(ai+on,1e-5),xa=Ai+en,ha=si+zn,ka=cr+Tn,Qa=Math.max(ai+Pn,1e-5);gr.push(new Dc(oi/Va,Fi/Va,va/Va)),wr.push(new Dc(xa/Qa,ha/Qa,ka/Qa))}Lt.push(gr),Wt.push(wr)}return[Lt,Wt]}(ce,pe,we,ke,Re)}(d,h,D,E,j,v,W,B,z,d.center.lat,u.tileID.canonical),se=u.queryGeometry;return function(ne,ce,pe){let we=1/0;_e(pe,ce)&&(we=qm(pe,ce[0]));for(let ke=0;ke<ce.length;ke++){const Re=ce[ke],Pe=ne[ke];for(let We=0;We<Re.length-1;We++){const Le=Re[We],Je=[Le,Re[We+1],Pe[We+1],Pe[We],Le];fe(pe,Je)&&(we=Math.min(we,qm(pe,Je)))}}return we!==1/0&&we}(K,oe,se.isPointQuery()?se.screenBounds:se.screenGeometry)}},line:class extends Ca{constructor(u,n,s,h){const y=gy();super(u,y,n,s,h),y.layout&&(this.layout=new sh(y.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(u){if(u==="line-gradient"){const n=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=n._styleExpression&&n._styleExpression.expression instanceof jo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(u,n){super.recalculate(u,n),this.paint._values["line-floorwidth"]=(()=>{if(wf)return wf;const s=gy();return wf=new _v(s.paint.properties["line-width"].specification),wf.useIntegerZoom=!0,wf})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)}createBucket(u){return new kd(u)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(u,n,s){const h=Hm(this);return{config:new gu(this,{zoom:n,lut:s}),defines:h,overrideFog:!1}}queryRadius(u){const n=u,s=yy(jt("line-width",this,n),jt("line-gap-width",this,n)),h=jt("line-offset",this,n);return s/2+Math.abs(h)+It(this.paint.get("line-translate"))}queryIntersectsFeature(u,n,s,h,y,d){if(u.queryGeometry.isAboveHorizon)return!1;const v=ft(u.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),d.angle,u.pixelToTileUnitsFactor),M=u.pixelToTileUnitsFactor/2*yy(this.paint.get("line-width").evaluate(n,s),this.paint.get("line-gap-width").evaluate(n,s)),k=this.paint.get("line-offset").evaluate(n,s);return k&&(h=function(j,E){const D=[],B=new $t(0,0);for(let R=0;R<j.length;R++){const z=j[R],q=[];for(let W=0;W<z.length;W++){const K=z[W],oe=z[W+1],se=W===0?B:K.sub(z[W-1])._unit()._perp(),ne=W===z.length-1?B:oe.sub(K)._unit()._perp(),ce=se._add(ne)._unit();ce._mult(1/(ce.x*ne.x+ce.y*ne.y)),q.push(ce._mult(E)._add(K))}D.push(q)}return D}(h,k*u.pixelToTileUnitsFactor)),function(j,E,D){for(let B=0;B<E.length;B++){const R=E[B];if(j.length>=3){for(let z=0;z<R.length;z++)if(Ue(j,R[z]))return!0}if(Ce(j,R,D))return!0}return!1}(v,h,M)}isTileClipped(){return!0}isDraped(u){return!this.hasElevatedBuckets}},symbol:w1,background:class extends Ca{constructor(u,n,s,h){super(u,{layout:FR||(FR=new Bi({visibility:new sn(_t.layout_background.visibility)})),paint:jR||(jR=new Bi({"background-pitch-alignment":new sn(_t.paint_background["background-pitch-alignment"]),"background-color":new sn(_t.paint_background["background-color"]),"background-pattern":new sn(_t.paint_background["background-pattern"]),"background-opacity":new sn(_t.paint_background["background-opacity"]),"background-emissive-strength":new sn(_t.paint_background["background-emissive-strength"]),"background-color-use-theme":new En({type:"string",default:"default","property-type":"data-driven"})}))},n,s,h)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(u,n,s){return{overrideFog:!1}}is3D(){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:$R,"raster-particle":KR,sky:class extends Ca{constructor(u,n,s,h){super(u,{layout:YR||(YR=new Bi({visibility:new sn(_t.layout_sky.visibility)})),paint:ZR||(ZR=new Bi({"sky-type":new sn(_t.paint_sky["sky-type"]),"sky-atmosphere-sun":new sn(_t.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new sn(_t.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new sn(_t.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new sn(_t.paint_sky["sky-gradient-radius"]),"sky-gradient":new lh(_t.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new sn(_t.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new sn(_t.paint_sky["sky-atmosphere-color"]),"sky-opacity":new sn(_t.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new En({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new En({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new En({type:"string",default:"default","property-type":"data-driven"})}))},n,s,h),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="sky-gradient"?this._updateColorRamp():u!=="sky-atmosphere-sun"&&u!=="sky-atmosphere-halo-color"&&u!=="sky-atmosphere-color"&&u!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Sd({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(u){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const n=u.style.light.properties.get("position");return this._lightPosition.azimuthal!==n.azimuthal||this._lightPosition.polar!==n.polar}return!1}getCenter(u,n){if(this.paint.get("sky-type")==="atmosphere"){const h=this.paint.get("sky-atmosphere-sun"),y=!h,d=u.style.light,v=d.properties.get("position");return y&&d.properties.get("anchor")==="viewport"&&lr("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),y?oS(v.azimuthal,90-v.polar,n):oS(h[0],90-h[1],n)}const s=this.paint.get("sky-gradient-center");return oS(s[0],90-s[1],n)}isSky(){return!0}markSkyboxValid(u){this._skyboxInvalidated=!1,this._lightPosition=u.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const u=this.paint.get("sky-type");return u==="atmosphere"?["skyboxCapture","skybox"]:u==="gradient"?["skyboxGradient"]:null}},slot:class extends Ca{constructor(u,n,s,h){super(u,{paint:WR||(WR=new Bi({}))},n,null)}},model:class extends Ca{constructor(u,n,s,h){super(u,{layout:s3||(s3=new Bi({visibility:new sn(_t.layout_model.visibility),"model-id":new En(_t.layout_model["model-id"])})),paint:l3||(l3=new Bi({"model-opacity":new En(_t.paint_model["model-opacity"]),"model-rotation":new En(_t.paint_model["model-rotation"]),"model-scale":new En(_t.paint_model["model-scale"]),"model-translation":new En(_t.paint_model["model-translation"]),"model-color":new En(_t.paint_model["model-color"]),"model-color-mix-intensity":new En(_t.paint_model["model-color-mix-intensity"]),"model-type":new sn(_t.paint_model["model-type"]),"model-cast-shadows":new sn(_t.paint_model["model-cast-shadows"]),"model-receive-shadows":new sn(_t.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new sn(_t.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new En(_t.paint_model["model-emissive-strength"]),"model-roughness":new En(_t.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new En(_t.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new sn(_t.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new sn(_t.paint_model["model-front-cutoff"]),"model-color-use-theme":new En({type:"string",default:"default","property-type":"data-driven"})}))},n,s,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(u){return new uS(u)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(u){return u instanceof C1?pn-1:0}queryIntersectsFeature(u,n,s,h,y,d){if(!this.modelManager)return!1;const v=this.modelManager,M=u.tile.getBucket(this);if(!(M&&M instanceof uS))return!1;for(const k in M.instancesPerModel){const j=M.instancesPerModel[k],E=n.id!==void 0?n.id:n.properties&&n.properties.hasOwnProperty("id")?n.properties.id:void 0;if(j.idToFeaturesIndex.hasOwnProperty(E)){const D=j.features[j.idToFeaturesIndex[E]],B=v.getModel(k,this.scope);if(!B)return!1;let R=Ne.mat4.create();const z=new Gr(0,0),q=M.canonical;let W=Number.MAX_VALUE;for(let K=0;K<D.instancedDataCount;++K){const oe=16*(D.instancedDataOffset+K),se=j.instancedDataArray.float32,ne=[se[oe+4],se[oe+5],se[oe+6]];p3(q,z,se[oe],0|se[oe+1]),u3(R,B,d,z,D.rotation,D.scale,ne,!1,!1,!1),d.projection.name==="globe"&&(R=lS(R,d));const ce=Ne.mat4.multiply([],d.projMatrix,R),pe=u.queryGeometry,we=n3(pe.isPointQuery()?pe.screenBounds:pe.screenGeometry,d,ce,B.aabb);we!=null&&(W=Math.min(we,W))}return W!==Number.MAX_VALUE&&W}}return!1}_handleOverridablePaintPropertyUpdate(u,n,s){return!(!this.layout||n.isDataDriven()||s.isDataDriven()||u!=="model-color"&&u!=="model-color-mix-intensity"&&u!=="model-rotation"&&u!=="model-scale"&&u!=="model-translation"&&u!=="model-emissive-strength")}_isPropertyZoomDependent(u){const n=this._transitionablePaint._values[u];return n!=null&&n.value!=null&&n.value.expression!=null&&n.value.expression instanceof Lu}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends Ca{constructor(u,n,s,h){super(u,{layout:W_||(W_=new Bi({"clip-layer-types":new sn(_t.layout_clip["clip-layer-types"]),"clip-layer-scope":new sn(_t.layout_clip["clip-layer-scope"])})),paint:K_||(K_=new Bi({}))},n,s,h)}recalculate(u,n){super.recalculate(u,n)}createBucket(u){return new iy(u)}isTileClipped(){return!0}is3D(){return!0}}};class d9{constructor(n){this._callback=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class p9{constructor(){this.tasks={},this.taskQueue=[],ec(["process"],this),this.invoker=new d9(this.process),this.nextId=0}add(n,s){const h=this.nextId++,y=function({type:d,isSymbolTile:v,zoom:M}){return M=M||0,d==="message"?0:d!=="maybePrepare"||v?d!=="parseTile"||v?d==="parseTile"&&v?300-M:d==="maybePrepare"&&v?400-M:500:200-M:100-M}(s);if(y===0){try{n()}finally{}return null}return this.tasks[h]={fn:n,metadata:s,priority:y,id:h},this.taskQueue.push(h),this.invoker.trigger(),{cancel:()=>{delete this.tasks[h]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(h=>!!this.tasks[h]),!this.taskQueue.length)return;const n=this.pick();if(n===null)return;const s=this.tasks[n];if(delete this.tasks[n],this.taskQueue.length&&this.invoker.trigger(),!s)return;s.fn()}finally{}}pick(){let n=null,s=1/0;for(let y=0;y<this.taskQueue.length;y++){const d=this.tasks[this.taskQueue[y]];d.priority<s&&(s=d.priority,n=y)}if(n===null)return null;const h=this.taskQueue[n];return this.taskQueue.splice(n,1),h}remove(){this.invoker.remove()}}class m3{constructor(n,s,h){this.target=n,this.parent=s,this.mapId=h,this.callbacks={},this.cancelCallbacks={},ec(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new p9}send(n,s,h,y,d=!1,v){const M=Math.round(1e18*Math.random()).toString(36).substring(0,10);h&&(h.metadata=v,this.callbacks[M]=h);const k=new Set;return this.target.postMessage({id:M,type:n,hasCallback:!!h,targetMapId:y,mustQueue:d,sourceMapId:this.mapId,data:zu(s,k)},k),{cancel:()=>{h&&delete this.callbacks[M],this.target.postMessage({id:M,type:"<cancel>",targetMapId:y,sourceMapId:this.mapId})}}}receive(n){const s=n.data,h=s.id;if(h&&(!s.targetMapId||this.mapId===s.targetMapId))if(s.type==="<cancel>"){const y=this.cancelCallbacks[h];delete this.cancelCallbacks[h],y&&y.cancel()}else if(s.mustQueue||Zo()){const y=this.callbacks[h],d=this.scheduler.add(()=>this.processTask(h,s),y&&y.metadata||{type:"message"});d&&(this.cancelCallbacks[h]=d)}else this.processTask(h,s)}processTask(n,s){if(delete this.cancelCallbacks[n],s.type==="<response>"){const h=this.callbacks[n];delete this.callbacks[n],h&&(s.error?h(Ss(s.error)):h(null,Ss(s.data)))}else{const h=new Set,y=s.hasCallback?(v,M)=>{this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:v?zu(v):null,data:zu(M,h)},h)}:()=>{},d=Ss(s.data);if(this.parent[s.type])this.parent[s.type](s.sourceMapId,d,y);else if(this.parent.getWorkerSource){const v=s.type.split(".");this.parent.getWorkerSource(s.sourceMapId,v[0],d.source,d.scope)[v[1]](d,y)}else y(new Error(`Could not find function ${s.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var kv={workerUrl:"",workerClass:null,workerParams:void 0};const dS="mapboxgl_preloaded_worker_pool";class Qm{constructor(){this.active={}}acquire(n,s=Qm.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<s;)this.workers.push(kv.workerClass!=null?new kv.workerClass:new self.Worker(kv.workerUrl,kv.workerParams));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.workers&&this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[dS]}numActive(){return Object.keys(this.active).length}}Qm.workerCount=2;class My{constructor(n,s,h="Worker",y=Qm.workerCount){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=Kr();const d=this.workerPool.acquire(this.id,y);for(let v=0;v<d.length;v++){const M=new My.Actor(d[v],s,this.id);M.name=`${h} ${v}`,this.actors.push(M)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(n,s,h){Ds(this.actors,(y,d)=>{y.send(n,s,d)},h=h||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(n=>{n.remove()}),this.actors=[],this.workerPool.release(this.id)}}let Dv,pS;function P1(){return Dv||(Dv=new Qm),Dv}My.Actor=m3;const mS=new Vr(0,0,0);var gS=(u=>(u[u.PATH_RULE_UNSPECIFIED=0]="PATH_RULE_UNSPECIFIED",u[u.PATH_RULE_NON_ZERO=1]="PATH_RULE_NON_ZERO",u[u.PATH_RULE_EVEN_ODD=2]="PATH_RULE_EVEN_ODD",u))(gS||{}),R1=(u=>(u[u.LINE_CAP_UNSPECIFIED=0]="LINE_CAP_UNSPECIFIED",u[u.LINE_CAP_BUTT=1]="LINE_CAP_BUTT",u[u.LINE_CAP_ROUND=2]="LINE_CAP_ROUND",u[u.LINE_CAP_SQUARE=3]="LINE_CAP_SQUARE",u))(R1||{}),Lv=(u=>(u[u.LINE_JOIN_UNSPECIFIED=0]="LINE_JOIN_UNSPECIFIED",u[u.LINE_JOIN_MITER=1]="LINE_JOIN_MITER",u[u.LINE_JOIN_MITER_CLIP=2]="LINE_JOIN_MITER_CLIP",u[u.LINE_JOIN_ROUND=3]="LINE_JOIN_ROUND",u[u.LINE_JOIN_BEVEL=4]="LINE_JOIN_BEVEL",u))(Lv||{}),g3=(u=>(u[u.PAINT_ORDER_UNSPECIFIED=0]="PAINT_ORDER_UNSPECIFIED",u[u.PAINT_ORDER_FILL_AND_STROKE=1]="PAINT_ORDER_FILL_AND_STROKE",u[u.PAINT_ORDER_STROKE_AND_FILL=2]="PAINT_ORDER_STROKE_AND_FILL",u))(g3||{}),Oy=(u=>(u[u.PATH_COMMAND_UNSPECIFIED=0]="PATH_COMMAND_UNSPECIFIED",u[u.PATH_COMMAND_MOVE=1]="PATH_COMMAND_MOVE",u[u.PATH_COMMAND_LINE=2]="PATH_COMMAND_LINE",u[u.PATH_COMMAND_QUAD=3]="PATH_COMMAND_QUAD",u[u.PATH_COMMAND_CUBIC=4]="PATH_COMMAND_CUBIC",u[u.PATH_COMMAND_CLOSE=5]="PATH_COMMAND_CLOSE",u))(Oy||{}),y3=(u=>(u[u.MASK_TYPE_UNSPECIFIED=0]="MASK_TYPE_UNSPECIFIED",u[u.MASK_TYPE_LUMINANCE=1]="MASK_TYPE_LUMINANCE",u[u.MASK_TYPE_ALPHA=2]="MASK_TYPE_ALPHA",u))(y3||{});function m9(u,n,s){u===1&&n.icons.push(function(h,y){return function(d){if(d.usvg_tree.height||(d.usvg_tree.height=d.usvg_tree.width),!d.metadata)return d;const{metadata:v}=d;if(v.content_area){const{content_area:M}=v;M.top==null&&(M.top=M.left),M.width==null&&(M.width=d.usvg_tree.width),M.height==null&&(M.height=M.width)}return v.stretch_x&&v.stretch_x.length&&_3(v,"x"),v.stretch_y&&v.stretch_y.length&&_3(v,"y"),d}(h.readFields(g9,{name:void 0},y))}(s,s.readVarint()+s.pos))}function _3(u,n){const s=[],h=u[`stretch_${n}`];let y=null;for(let d=0;d<h.length;d++)y===null?y=s.length===0?h[0]:s[s.length-1][1]+h[d]:(s.push([y,y+h[d]]),y=null);u[`stretch_${n}_areas`]=s}function g9(u,n,s){u===1?n.name=s.readString():u===2?n.metadata=function(h,y){return h.readFields(y9,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},y)}(s,s.readVarint()+s.pos):u===3&&(n.usvg_tree=function(h,y){return h.readFields(x9,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},y)}(s,s.readVarint()+s.pos),n.data="usvg_tree")}function y9(u,n,s){u===1?n.stretch_x=s.readPackedVarint():u===2?n.stretch_y=s.readPackedVarint():u===3?n.content_area=function(h,y){return h.readFields(_9,{left:0},y)}(s,s.readVarint()+s.pos):u===4&&n.variables.push(function(h,y){return h.readFields(v9,{name:void 0},y)}(s,s.readVarint()+s.pos))}function _9(u,n,s){u===1?n.left=s.readVarint():u===2?n.width=s.readVarint():u===3?n.top=s.readVarint():u===4&&(n.height=s.readVarint())}function v9(u,n,s){u===1?n.name=s.readString():u===2&&(n.rgb_color=L1(s.readVarint()),n.value="rgb_color")}function x9(u,n,s){u===1?n.width=n.height=s.readVarint():u===2?n.height=s.readVarint():u===3?n.children.push(k1(s,s.readVarint()+s.pos)):u===4?n.linear_gradients.push(function(h,y){return h.readFields(M9,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},y)}(s,s.readVarint()+s.pos)):u===5?n.radial_gradients.push(function(h,y){return h.readFields(I9,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},y)}(s,s.readVarint()+s.pos)):u===7?n.clip_paths.push(function(h,y){return h.readFields(C9,{children:[]},y)}(s,s.readVarint()+s.pos)):u===8&&n.masks.push(function(h,y){const d=h.readFields(P9,{left:0,width:20,mask_type:1,children:[]},y);return d.height==null&&(d.height=d.width),d.top==null&&(d.top=d.left),d}(s,s.readVarint()+s.pos))}function k1(u,n){return u.readFields(b9,{},n)}function b9(u,n,s){u===1?(n.group=function(h,y){return h.readFields(w9,{opacity:255,children:[]},y)}(s,s.readVarint()+s.pos),n.node="group"):u===2&&(n.path=function(h,y){return h.readFields(T9,{paint_order:1,commands:[],step:1,diffs:[],rule:1},y)}(s,s.readVarint()+s.pos),n.node="path")}function w9(u,n,s){u===1?n.transform=D1(s,s.readVarint()+s.pos):u===2?n.opacity=s.readVarint():u===5?n.clip_path_idx=s.readVarint():u===6?n.mask_idx=s.readVarint():u===7&&n.children.push(k1(s,s.readVarint()+s.pos))}function D1(u,n){return u.readFields(S9,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},n)}function S9(u,n,s){u===1?n.sx=s.readFloat():u===2?n.ky=s.readFloat():u===3?n.kx=s.readFloat():u===4?n.sy=s.readFloat():u===5?n.tx=s.readFloat():u===6&&(n.ty=s.readFloat())}function T9(u,n,s){u===1?n.fill=function(h,y){return h.readFields(E9,{rgb_color:mS,paint:"rgb_color",opacity:255},y)}(s,s.readVarint()+s.pos):u===2?n.stroke=function(h,y){return h.readFields(A9,{rgb_color:mS,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},y)}(s,s.readVarint()+s.pos):u===3?n.paint_order=s.readVarint():u===5?s.readPackedVarint(n.commands):u===6?n.step=s.readFloat():u===7?s.readPackedSVarint(n.diffs):u===8&&(n.rule=s.readVarint())}function E9(u,n,s){u===1?(n.rgb_color=L1(s.readVarint()),n.paint="rgb_color"):u===2?(n.linear_gradient_idx=s.readVarint(),n.paint="linear_gradient_idx"):u===3?(n.radial_gradient_idx=s.readVarint(),n.paint="radial_gradient_idx"):u===5&&(n.opacity=s.readVarint())}function L1(u){return new Vr((u>>16&255)/255,(u>>8&255)/255,(255&u)/255,1)}function A9(u,n,s){u===1?(n.rgb_color=L1(s.readVarint()),n.paint="rgb_color"):u===2?(n.linear_gradient_idx=s.readVarint(),n.paint="linear_gradient_idx"):u===3?(n.radial_gradient_idx=s.readVarint(),n.paint="radial_gradient_idx"):u===5?s.readPackedFloat(n.dasharray):u===6?n.dashoffset=s.readFloat():u===7?n.miterlimit=s.readFloat():u===8?n.opacity=s.readVarint():u===9?n.width=s.readFloat():u===10?n.linecap=s.readVarint():u===11&&(n.linejoin=s.readVarint())}function M9(u,n,s){u===1?n.transform=D1(s,s.readVarint()+s.pos):u===2?n.spread_method=s.readVarint():u===3?n.stops.push(v3(s,s.readVarint()+s.pos)):u===4?n.x1=s.readFloat():u===5?n.y1=s.readFloat():u===6?n.x2=s.readFloat():u===7&&(n.y2=s.readFloat())}function v3(u,n){return u.readFields(O9,{offset:0,opacity:255,rgb_color:mS},n)}function O9(u,n,s){u===1?n.offset=s.readFloat():u===2?n.opacity=s.readVarint():u===3&&(n.rgb_color=L1(s.readVarint()))}function I9(u,n,s){u===1?n.transform=D1(s,s.readVarint()+s.pos):u===2?n.spread_method=s.readVarint():u===3?n.stops.push(v3(s,s.readVarint()+s.pos)):u===4?n.cx=s.readFloat():u===5?n.cy=s.readFloat():u===6?n.r=s.readFloat():u===7?n.fx=s.readFloat():u===8?n.fy=s.readFloat():u===9&&(n.fr=s.readFloat())}function C9(u,n,s){u===1?n.transform=D1(s,s.readVarint()+s.pos):u===2?n.clip_path_idx=s.readVarint():u===3&&n.children.push(k1(s,s.readVarint()+s.pos))}function P9(u,n,s){u===1?n.left=n.top=s.readFloat():u===2?n.width=n.height=s.readFloat():u===3?n.top=s.readFloat():u===4?n.height=s.readFloat():u===5?n.mask_type=s.readVarint():u===6?n.mask_idx=s.readVarint():u===7&&n.children.push(k1(s,s.readVarint()+s.pos))}class R9{static calculate(n,s){const h=new Map,y=new Map;if(Object.keys(n).length===0)return h;s.forEach(d=>{y.set(d.name,d.rgb_color||new Vr(0,0,0))});for(const[d,v]of Object.entries(n))y.has(d)?h.set(y.get(d).toStringPremultipliedAlpha(),v):console.warn(`Ignoring unknown image variable "${d}"`);return h}}function Iy(u,n=255,s){const h=n/255,y=u.toStringPremultipliedAlpha(),d=s.has(y)?s.get(y).clone():u.clone();return d.a=h,d.toString()}function zv(u,n){if(!Ie()){const s=document.createElement("canvas");return s.width=u,s.height=n,s}return new OffscreenCanvas(u,n)}function k9(u,n){const s=R9.calculate(n.params,u.metadata?u.metadata.variables:[]),h=u.usvg_tree,y=h.width,d=h.height,v=n.transform?n.transform:new DOMMatrix,M=Math.max(1,Math.round(y*v.a)),k=Math.max(1,Math.round(d*v.d)),j=new DOMMatrix([M/y,0,0,k/d,0,0]),E=zv(M,k).getContext("2d");return yS(E,j,h,h,s),E.getImageData(0,0,M,k)}function yS(u,n,s,h,y){for(const d of h.children)x3(u,n,s,d,y)}function x3(u,n,s,h,y){h.group?(u.save(),function(d,v,M,k,j){const E=k.mask_idx!=null?M.masks[k.mask_idx]:null,D=k.clip_path_idx!=null?M.clip_paths[k.clip_path_idx]:null;if(k.transform&&(v=z1(k.transform).preMultiplySelf(v)),!function(z,q,W){return z.opacity!==255||q||W}(k,D!=null,E!=null))return void yS(d,v,M,k,j);const B=zv(d.canvas.width,d.canvas.height),R=B.getContext("2d");yS(R,v,M,k,j),D&&M3(R,v,M,D),E&&O3(R,v,M,E,j),d.globalAlpha=k.opacity/255,d.drawImage(B,0,0)}(u,n,s,h.group,y),u.restore()):h.path&&(u.save(),function(d,v,M,k,j){const E=I3(k);d.setTransform(v),k.paint_order===g3.PAINT_ORDER_FILL_AND_STROKE?(b3(d,M,k,E,j),S3(d,M,k,E,j)):(S3(d,M,k,E,j),b3(d,M,k,E,j))}(u,n,s,h.path,y),u.restore())}function b3(u,n,s,h,y){const d=s.fill;if(!d)return;const v=d.opacity/255;switch(d.paint){case"rgb_color":u.fillStyle=Iy(d.rgb_color,d.opacity,y);break;case"linear_gradient_idx":u.fillStyle=T3(u,n.linear_gradients[d.linear_gradient_idx],v,y);break;case"radial_gradient_idx":u.fillStyle=E3(u,n.radial_gradients[d.radial_gradient_idx],v,y)}u.fill(h,w3(s))}function w3(u){return u.rule===gS.PATH_RULE_NON_ZERO?"nonzero":u.rule===gS.PATH_RULE_EVEN_ODD?"evenodd":void 0}function S3(u,n,s,h,y){const d=s.stroke;if(!d)return;u.lineWidth=d.width,u.miterLimit=d.miterlimit,u.setLineDash(d.dasharray),u.lineDashOffset=d.dashoffset;const v=d.opacity/255;switch(d.paint){case"rgb_color":u.strokeStyle=Iy(d.rgb_color,d.opacity,y);break;case"linear_gradient_idx":u.strokeStyle=T3(u,n.linear_gradients[d.linear_gradient_idx],v,y);break;case"radial_gradient_idx":u.strokeStyle=E3(u,n.radial_gradients[d.radial_gradient_idx],v,y)}switch(d.linejoin){case Lv.LINE_JOIN_MITER_CLIP:case Lv.LINE_JOIN_MITER:u.lineJoin="miter";break;case Lv.LINE_JOIN_ROUND:u.lineJoin="round";break;case Lv.LINE_JOIN_BEVEL:u.lineJoin="bevel"}switch(d.linecap){case R1.LINE_CAP_BUTT:u.lineCap="butt";break;case R1.LINE_CAP_ROUND:u.lineCap="round";break;case R1.LINE_CAP_SQUARE:u.lineCap="square"}u.stroke(h)}function T3(u,n,s,h){if(n.stops.length===1){const B=n.stops[0];return Iy(B.rgb_color,B.opacity*s,h)}const y=z1(n.transform),{x1:d,y1:v,x2:M,y2:k}=n,j=y.transformPoint(new DOMPoint(d,v)),E=y.transformPoint(new DOMPoint(M,k)),D=u.createLinearGradient(j.x,j.y,E.x,E.y);for(const B of n.stops)D.addColorStop(B.offset,Iy(B.rgb_color,B.opacity*s,h));return D}function E3(u,n,s,h){if(n.stops.length===1){const B=n.stops[0];return Iy(B.rgb_color,B.opacity*s,h)}const y=z1(n.transform),{fx:d,fy:v,cx:M,cy:k}=n,j=y.transformPoint(new DOMPoint(d,v)),E=y.transformPoint(new DOMPoint(M,k)),D=u.createRadialGradient(j.x,j.y,0,E.x,E.y,n.r*((y.a+y.d)/2));for(const B of n.stops)D.addColorStop(B.offset,Iy(B.rgb_color,B.opacity*s,h));return D}function A3(u,n,s,h){const y=h.transform?z1(h.transform).preMultiplySelf(n):n,d=zv(u.canvas.width,u.canvas.height),v=d.getContext("2d");for(const k of h.children)if(k.group)A3(v,y,s,k.group);else if(k.path){const j=k.path,E=new Path2D;E.addPath(I3(j),y),v.fill(E,w3(j))}const M=h.clip_path_idx!=null?s.clip_paths[h.clip_path_idx]:null;M&&M3(v,y,s,M),u.globalCompositeOperation="source-over",u.drawImage(d,0,0)}function M3(u,n,s,h){const y=zv(u.canvas.width,u.canvas.height);A3(y.getContext("2d"),n,s,h),u.globalCompositeOperation="destination-in",u.drawImage(y,0,0)}function O3(u,n,s,h,y){if(h.children.length===0)return;const d=h.mask_idx!=null?s.masks[h.mask_idx]:null;d&&O3(u,n,s,d,y);const v=u.canvas.width,M=u.canvas.height,k=zv(v,M),j=k.getContext("2d"),E=h.width,D=h.height,B=h.left,R=h.top,z=new Path2D,q=new Path2D;q.rect(B,R,E,D),z.addPath(q,n),j.clip(z);for(const oe of h.children)x3(j,n,s,oe,y);const W=j.getImageData(0,0,v,M),K=W.data;if(h.mask_type===y3.MASK_TYPE_LUMINANCE)for(let oe=0;oe<K.length;oe+=4)K[oe+3]=K[oe+3]/255*(.2126*K[oe]+.7152*K[oe+1]+.0722*K[oe+2]);j.putImageData(W,0,0),u.globalCompositeOperation="destination-in",u.drawImage(k,0,0)}function z1(u){return u?new DOMMatrix([u.sx,u.ky,u.kx,u.sy,u.tx,u.ty]):new DOMMatrix}function I3(u){const n=new Path2D,s=u.step;let h=u.diffs[0]*s,y=u.diffs[1]*s;n.moveTo(h,y);for(let d=0,v=2;d<u.commands.length;d++)switch(u.commands[d]){case Oy.PATH_COMMAND_MOVE:h+=u.diffs[v++]*s,y+=u.diffs[v++]*s,n.moveTo(h,y);break;case Oy.PATH_COMMAND_LINE:h+=u.diffs[v++]*s,y+=u.diffs[v++]*s,n.lineTo(h,y);break;case Oy.PATH_COMMAND_QUAD:{const M=h+u.diffs[v++]*s,k=y+u.diffs[v++]*s;h=M+u.diffs[v++]*s,y=k+u.diffs[v++]*s,n.quadraticCurveTo(M,k,h,y);break}case Oy.PATH_COMMAND_CUBIC:{const M=h+u.diffs[v++]*s,k=y+u.diffs[v++]*s,j=M+u.diffs[v++]*s,E=k+u.diffs[v++]*s;h=j+u.diffs[v++]*s,y=E+u.diffs[v++]*s,n.bezierCurveTo(M,k,j,E,h,y);break}case Oy.PATH_COMMAND_CLOSE:n.closePath()}return n}class _S{constructor(n){this.capacity=n,this.cache=new Map}get(n){if(!this.cache.has(n))return;const s=this.cache.get(n);return this.cache.delete(n),this.cache.set(n,s),s}put(n,s){this.cache.has(n)?this.cache.delete(n):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(n,s)}delete(n){this.cache.delete(n)}}class vS{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(n){return new co(n,n.data)}getFromCache(n,s,h){return this.cacheMap.has(h)||this.cacheMap.set(h,new _S(150)),this.cacheMap.get(h).get($s(n.serialize(),s))}setInCache(n,s,h,y){this.cacheDependenciesMap.has(y)||this.cacheDependenciesMap.set(y,new Map),this.cacheMap.has(y)||this.cacheMap.set(y,new _S(150));const d=this.cacheDependenciesMap.get(y);d.get($s(n.id,h))||d.set($s(n.id,h),new Set);const v=this.cacheMap.get(y),M=n.serialize();d.get($s(n.id,h)).add(M),v.put($s(n.serialize(),h),s)}removeImagesFromCacheByIds(n,s,h=""){if(!this.cacheMap.has(h)||!this.cacheDependenciesMap.has(h))return;const y=this.cacheMap.get(h),d=this.cacheDependenciesMap.get(h);for(const v of n)if(d.has($s(v,s))){for(const M of d.get($s(v,s)))y.delete(M);d.delete($s(v,s))}}rasterize(n,s,h,y,d=k9){const v=this.getFromCache(n,h,y);if(v)return v.clone();const M=d(s.icon,n.options),k=vS._getImage(M);return this.setInCache(n,k,h,y),k.clone()}}class C3{constructor(n){this.size=n,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(n,s){const h=this.toIdx(n,s);return{min:this.minimums[h],max:this.maximums[h]}}isLeaf(n,s){return this.leaves[this.toIdx(n,s)]}toIdx(n,s){return s*this.size+n}}function P3(u,n,s,h){let y=0,d=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(h[v])<1e-15){if(s[v]<u[v]||s[v]>n[v])return null}else{const M=1/h[v];let k=(u[v]-s[v])*M,j=(n[v]-s[v])*M;if(k>j){const E=k;k=j,j=E}if(k>y&&(y=k),j<d&&(d=j),y>d)return null}return y}function R3(u,n,s,h,y,d,v,M,k,j,E){const D=h-u,B=y-n,R=d-s,z=v-u,q=M-n,W=k-s,K=E[1]*W-E[2]*q,oe=E[2]*z-E[0]*W,se=E[0]*q-E[1]*z,ne=D*K+B*oe+R*se;if(Math.abs(ne)<1e-15)return null;const ce=1/ne,pe=j[0]-u,we=j[1]-n,ke=j[2]-s,Re=(pe*K+we*oe+ke*se)*ce;if(Re<0||Re>1)return null;const Pe=we*R-ke*B,We=ke*D-pe*R,Le=pe*B-we*D,Je=(E[0]*Pe+E[1]*We+E[2]*Le)*ce;return Je<0||Re+Je>1?null:(z*Pe+q*We+W*Le)*ce}function k3(u,n,s){return(u-n)/(s-n)}function D3(u,n,s,h,y,d,v,M,k){const j=1<<s,E=d-h,D=v-y,B=(u+1)/j*E+h,R=(n+0)/j*D+y,z=(n+1)/j*D+y;M[0]=(u+0)/j*E+h,M[1]=R,k[0]=B,k[1]=z}class L3{constructor(n){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=n,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const s=function(d){const v=Math.ceil(Math.log2(d.dim/8)),M=[];let k=Math.ceil(Math.pow(2,v));const j=1/k,E=(R,z,q,W,K)=>{const oe=W?1:0,se=(R+1)*q-oe,ne=z*q,ce=(z+1)*q-oe;K[0]=R*q,K[1]=ne,K[2]=se,K[3]=ce};let D=new C3(k);const B=[];for(let R=0;R<k*k;R++){E(R%k,Math.floor(R/k),j,!1,B);const z=$p(B[0],B[1],d),q=$p(B[2],B[1],d),W=$p(B[2],B[3],d),K=$p(B[0],B[3],d);D.minimums.push(Math.min(z,q,W,K)),D.maximums.push(Math.max(z,q,W,K)),D.leaves.push(1)}for(M.push(D),k/=2;k>=1;k/=2){const R=M[M.length-1];D=new C3(k);for(let z=0;z<k*k;z++){E(z%k,Math.floor(z/k),2,!0,B);const q=R.getElevation(B[0],B[1]),W=R.getElevation(B[2],B[1]),K=R.getElevation(B[2],B[3]),oe=R.getElevation(B[0],B[3]),se=R.isLeaf(B[0],B[1]),ne=R.isLeaf(B[2],B[1]),ce=R.isLeaf(B[2],B[3]),pe=R.isLeaf(B[0],B[3]),we=Math.min(q.min,W.min,K.min,oe.min),ke=Math.max(q.max,W.max,K.max,oe.max),Re=se&&ne&&ce&&pe;D.maximums.push(ke),D.minimums.push(we),D.leaves.push(ke-we<=5&&Re?1:0)}M.push(D)}return M}(this.dem),h=s.length-1,y=s[h];this._addNode(y.minimums[0],y.maximums[0],y.leaves[0]),this._construct(s,0,0,h,0)}raycastRoot(n,s,h,y,d,v,M=1){return P3([n,s,-100],[h,y,this.maximums[0]*M],d,v)}raycast(n,s,h,y,d,v,M=1){if(!this.nodeCount)return null;const k=this.raycastRoot(n,s,h,y,d,v,M);if(k==null)return null;const j=[],E=[],D=[],B=[],R=[{idx:0,t:k,nodex:0,nodey:0,depth:0}];for(;R.length>0;){const{idx:z,t:q,nodex:W,nodey:K,depth:oe}=R.pop();if(this.leaves[z]){D3(W,K,oe,n,s,h,y,D,B);const ne=1<<oe,ce=(W+0)/ne,pe=(W+1)/ne,we=(K+0)/ne,ke=(K+1)/ne,Re=$p(ce,we,this.dem)*M,Pe=$p(pe,we,this.dem)*M,We=$p(pe,ke,this.dem)*M,Le=$p(ce,ke,this.dem)*M,Je=R3(D[0],D[1],Re,B[0],D[1],Pe,B[0],B[1],We,d,v),it=R3(B[0],B[1],We,D[0],B[1],Le,D[0],D[1],Re,d,v),tt=Math.min(Je!==null?Je:Number.MAX_VALUE,it!==null?it:Number.MAX_VALUE);if(tt!==Number.MAX_VALUE)return tt;{const ot=Ne.vec3.scaleAndAdd([],d,v,q);if(z3(Re,Pe,Le,We,k3(ot[0],D[0],B[0]),k3(ot[1],D[1],B[1]))>=ot[2])return q}continue}let se=0;for(let ne=0;ne<this._siblingOffset.length;ne++){D3((W<<1)+this._siblingOffset[ne][0],(K<<1)+this._siblingOffset[ne][1],oe+1,n,s,h,y,D,B),D[2]=-100,B[2]=this.maximums[this.childOffsets[z]+ne]*M;const ce=P3(D,B,d,v);if(ce!=null){const pe=ce;j[ne]=pe;let we=!1;for(let ke=0;ke<se&&!we;ke++)pe>=j[E[ke]]&&(E.splice(ke,0,ne),we=!0);we||(E[se]=ne),se++}}for(let ne=0;ne<se;ne++){const ce=E[ne];R.push({idx:this.childOffsets[z]+ce,t:j[ce],nodex:(W<<1)+this._siblingOffset[ce][0],nodey:(K<<1)+this._siblingOffset[ce][1],depth:oe+1})}}return null}_addNode(n,s,h){return this.minimums.push(n),this.maximums.push(s),this.leaves.push(h),this.childOffsets.push(0),this.nodeCount++}_construct(n,s,h,y,d){if(n[y].isLeaf(s,h)===1)return;this.childOffsets[d]||(this.childOffsets[d]=this.nodeCount);const v=y-1,M=n[v];let k=0,j=0;for(let E=0;E<this._siblingOffset.length;E++){const D=2*s+this._siblingOffset[E][0],B=2*h+this._siblingOffset[E][1],R=M.getElevation(D,B),z=M.isLeaf(D,B),q=this._addNode(R.min,R.max,z);z&&(k|=1<<E),j||(j=q)}for(let E=0;E<this._siblingOffset.length;E++)k&1<<E||this._construct(n,2*s+this._siblingOffset[E][0],2*h+this._siblingOffset[E][1],v,j+E)}}function z3(u,n,s,h,y,d){return Nn(Nn(u,s,d),Nn(n,h,d),y)}function $p(u,n,s){const h=s.dim,y=Mn(u*h-.5,0,h-1),d=Mn(n*h-.5,0,h-1),v=Math.floor(y),M=Math.floor(d),k=Math.min(v+1,h-1),j=Math.min(M+1,h-1);return z3(s.get(v,M),s.get(k,M),s.get(v,j),s.get(k,j),y-v,d-M)}const D9={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function L9(u,n,s){return(256*u*256+256*n+s)/10-1e4}function z9(u,n,s){return 256*u+n+s/256-32768}class N1{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(n,s,h,y=!1){if(this.uid=n,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(h&&h!=="mapbox"&&h!=="terrarium")return void lr(`"${h}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=s.height;const d=this.dim=s.height-2,v=new Uint32Array(s.data.buffer);if(this.pixels=new Uint8Array(s.data.buffer),this.floatView=new Float32Array(s.data.buffer),this.borderReady=y,this._modifiedForSources={},!y){for(let k=0;k<d;k++)v[this._idx(-1,k)]=v[this._idx(0,k)],v[this._idx(d,k)]=v[this._idx(d-1,k)],v[this._idx(k,-1)]=v[this._idx(k,0)],v[this._idx(k,d)]=v[this._idx(k,d-1)];v[this._idx(-1,-1)]=v[this._idx(0,0)],v[this._idx(d,-1)]=v[this._idx(d-1,0)],v[this._idx(-1,d)]=v[this._idx(0,d-1)],v[this._idx(d,d)]=v[this._idx(d-1,d-1)]}const M=h==="terrarium"?z9:L9;for(let k=0;k<v.length;++k){const j=4*k;this.floatView[k]=M(this.pixels[j],this.pixels[j+1],this.pixels[j+2])}this._timestamp=Fe.now()}_buildQuadTree(){this._tree=new L3(this)}get(n,s,h=!1){h&&(n=Mn(n,-1,this.dim),s=Mn(s,-1,this.dim));const y=this._idx(n,s);return this.floatView[y]}set(n,s,h){const y=this._idx(n,s),d=this.floatView[y];return this.floatView[y]=h,h-d}static getUnpackVector(n){return D9[n]}_idx(n,s){if(n<-1||n>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(n+1)}static pack(n,s){const h=[0,0,0,0],y=N1.getUnpackVector(s);let d=Math.floor((n+y[3])/y[2]);return h[2]=d%256,d=Math.floor(d/256),h[1]=d%256,d=Math.floor(d/256),h[0]=d,h}getPixels(){return new Y_({width:this.stride,height:this.stride},this.pixels)}backfillBorder(n,s,h){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let y=s*this.dim,d=s*this.dim+this.dim,v=h*this.dim,M=h*this.dim+this.dim;switch(s){case-1:y=d-1;break;case 1:d=y+1}switch(h){case-1:v=M-1;break;case 1:M=v+1}const k=-s*this.dim,j=-h*this.dim;for(let E=v;E<M;E++)for(let D=y;D<d;D++){const B=4*this._idx(D,E),R=4*this._idx(D+k,E+j);this.pixels[B+0]=n.pixels[R+0],this.pixels[B+1]=n.pixels[R+1],this.pixels[B+2]=n.pixels[R+2],this.pixels[B+3]=n.pixels[R+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function N9(u,n,s){u===1?n.headerLength=s.readFixed32():u===2?n.x=s.readVarint():u===3?n.y=s.readVarint():u===4?n.z=s.readVarint():u===5&&n.layers.push(function(h,y){return h.readFields(V9,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},y)}(s,s.readVarint()+s.pos))}function B9(u,n,s){u===1?(n.delta_filter=function(h,y){return h.readFields(F9,{blockSize:0},y)}(s,s.readVarint()+s.pos),n.filter="delta_filter"):u===2?(s.readVarint(),n.filter="zigzag_filter"):u===3?(s.readVarint(),n.filter="bitshuffle_filter"):u===4&&(s.readVarint(),n.filter="byteshuffle_filter")}function F9(u,n,s){u===1&&(n.blockSize=s.readVarint())}function j9(u,n,s){u===1?(s.readVarint(),n.codec="gzip_data"):u===2?(s.readVarint(),n.codec="jpeg_image"):u===3?(s.readVarint(),n.codec="webp_image"):u===4&&(s.readVarint(),n.codec="png_image")}function U9(u,n,s){let h=0,y=0;u===1?n.firstByte=s.readFixed64():u===2?n.lastByte=s.readFixed64():u===3?n.filters.push(function(d,v){return d.readFields(B9,{},v)}(s,s.readVarint()+s.pos)):u===4?n.codec=function(d,v){return d.readFields(j9,{},v)}(s,s.readVarint()+s.pos):u===5?y=s.readFloat():u===6?h=s.readFloat():u===7?n.bands.push(s.readString()):u===8?n.offset=s.readDouble():u===9&&(n.scale=s.readDouble()),n.offset===0&&(n.offset=y),n.scale===0&&(n.scale=h)}function V9(u,n,s){u===1?n.version=s.readVarint():u===2?n.name=s.readString():u===3?n.units=s.readString():u===4?n.tileSize=s.readVarint():u===5?n.buffer=s.readVarint():u===6?n.pixelFormat=s.readVarint():u===7&&n.dataIndex.push(function(h,y){return h.readFields(U9,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},y)}(s,s.readVarint()+s.pos))}function q9(u,n,s){if(u===2)(function(h,y,d){h.readFields(G9,d,y)})(s,s.readVarint()+s.pos,n);else if(u===3)throw new Error("Not implemented")}function G9(u,n,s){if(u===1){let h=0;const y=s.readVarint()+s.pos;for(;s.pos<y;)n[h++]=s.readVarint()}}function $9(u,n){if(n.length!==4)throw new Error(`Expected data of dimension 4 but got ${n.length}.`);let s=n[3];for(let h=2;h>=1;h--){const y=h===1?1:0,d=h===2?1:0;for(let v=0;v<n[0];v++){const M=n[1]*v;for(let k=y;k<n[1];k++){const j=n[2]*(k+M);for(let E=d;E<n[2];E++){const D=n[3]*(E+j);for(let B=0;B<n[3];B++){const R=D+B;u[R]+=u[R-s]}}}}s*=n[h]}return u}function H9(u){for(let n=0,s=u.length;n<s;n++)u[n]=u[n]>>>1^-(1&u[n]);return u}function X9(u,n){switch(n){case"uint32":return u;case"uint16":for(let s=0;s<u.length;s+=2){const h=u[s],y=u[s+1];u[s]=(240&h)>>4|(61440&h)>>8|(240&y)<<4|61440&y,u[s+1]=15&h|(3840&h)>>4|(15&y)<<8|(3840&y)<<4}return u;case"uint8":for(let s=0;s<u.length;s+=4){const h=u[s],y=u[s+1],d=u[s+2],v=u[s+3];u[s+0]=(192&h)>>6|(192&y)>>4|(192&d)>>2|192&v,u[s+1]=(48&h)>>4|(48&y)>>2|48&d|(48&v)<<2,u[s+2]=(12&h)>>2|12&y|(12&d)<<2|(12&v)<<4,u[s+3]=3&h|(3&y)<<2|(3&d)<<4|(3&v)<<6}return u;default:throw new Error(`Invalid pixel format, "${n}"`)}}In(N1,"DEMData"),In(L3,"DemMinMaxQuadTree",{omit:["dem"]});var Xu=Uint8Array,Nv=Uint16Array,Y9=Int32Array,N3=new Xu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),B3=new Xu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Z9=new Xu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),F3=function(u,n){for(var s=new Nv(31),h=0;h<31;++h)s[h]=n+=1<<u[h-1];var y=new Y9(s[30]);for(h=1;h<30;++h)for(var d=s[h];d<s[h+1];++d)y[d]=d-s[h]<<5|h;return{b:s,r:y}},j3=F3(N3,2),U3=j3.b,W9=j3.r;U3[28]=258,W9[258]=28;for(var K9=F3(B3,0).b,V3=new Nv(32768),Ua=0;Ua<32768;++Ua){var Cy=(43690&Ua)>>1|(21845&Ua)<<1;V3[Ua]=((65280&(Cy=(61680&(Cy=(52428&Cy)>>2|(13107&Cy)<<2))>>4|(3855&Cy)<<4))>>8|(255&Cy)<<8)>>1}var Bv=function(u,n,s){for(var h=u.length,y=0,d=new Nv(n);y<h;++y)u[y]&&++d[u[y]-1];var v,M=new Nv(n);for(y=1;y<n;++y)M[y]=M[y-1]+d[y-1]<<1;v=new Nv(1<<n);var k=15-n;for(y=0;y<h;++y)if(u[y])for(var j=y<<4|u[y],E=n-u[y],D=M[u[y]-1]++<<E,B=D|(1<<E)-1;D<=B;++D)v[V3[D]>>k]=j;return v},Fv=new Xu(288);for(Ua=0;Ua<144;++Ua)Fv[Ua]=8;for(Ua=144;Ua<256;++Ua)Fv[Ua]=9;for(Ua=256;Ua<280;++Ua)Fv[Ua]=7;for(Ua=280;Ua<288;++Ua)Fv[Ua]=8;var q3=new Xu(32);for(Ua=0;Ua<32;++Ua)q3[Ua]=5;var J9=Bv(Fv,9),Q9=Bv(q3,5),xS=function(u){for(var n=u[0],s=1;s<u.length;++s)u[s]>n&&(n=u[s]);return n},wh=function(u,n,s){var h=n/8|0;return(u[h]|u[h+1]<<8)>>(7&n)&s},bS=function(u,n){var s=n/8|0;return(u[s]|u[s+1]<<8|u[s+2]<<16)>>(7&n)},eG=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Sh=function(u,n,s){var h=new Error(n||eG[u]);if(h.code=u,Error.captureStackTrace&&Error.captureStackTrace(h,Sh),!s)throw h;return h},tG=new Xu(0),nG=typeof TextDecoder<"u"&&new TextDecoder;try{nG.decode(tG,{stream:!0})}catch{}const rG={gzip_data:"gzip"};class Lc extends Error{constructor(n){super(n),this.name="MRTError"}}const iG={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},G3={uint32:1,uint16:2,uint8:4},aG={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let wS;class SS{constructor(n=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=n}getLayer(n){const s=this.layers[n];if(!s)throw new Lc(`Layer '${n}' not found`);return s}getHeaderLength(n){const s=new Uint8Array(n),h=new DataView(n);if(s[0]!==13)throw new Lc("File is not a valid MRT.");return h.getUint32(1,!0)}parseHeader(n){const s=new Uint8Array(n),h=this.getHeaderLength(n);if(s.length<h)throw new Lc(`Expected header with length >= ${h} but got buffer of length ${s.length}`);const y=function(d,v){return d.readFields(N9,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new wS(s.subarray(0,h)));if(!isNaN(this.x)&&(this.x!==y.x||this.y!==y.y||this.z!==y.z))throw new Lc(`Invalid attempt to parse header ${y.z}/${y.x}/${y.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=y.x,this.y=y.y,this.z=y.z;for(const d of y.layers)this.layers[d.name]=new oG(d,{cacheSize:this._cacheSize});return this}createDecodingTask(n){const s=[],h=this.getLayer(n.layerName);for(let y of n.blockIndices){const d=h.dataIndex[y],v=d.firstByte-n.firstByte,M=d.lastByte-n.firstByte;if(h._blocksInProgress.has(y))continue;const k={layerName:h.name,firstByte:v,lastByte:M,pixelFormat:h.pixelFormat,blockIndex:y,blockShape:[d.bands.length].concat(h.bandShape),buffer:h.buffer,codec:d.codec.codec,filters:d.filters.map(j=>j.filter)};h._blocksInProgress.add(y),s.push(k)}return new $3(s,()=>{s.forEach(y=>h._blocksInProgress.delete(y.blockIndex))},(y,d)=>{if(s.forEach(v=>h._blocksInProgress.delete(v.blockIndex)),y)throw y;d.forEach(v=>{this.getLayer(v.layerName).processDecodedData(v)})})}}class oG{constructor({version:n,name:s,units:h,tileSize:y,pixelFormat:d,buffer:v,dataIndex:M},k){if(this.version=n,this.version!==1)throw new Lc(`Cannot parse raster layer encoded with MRT version ${n}`);this.name=s,this.units=h,this.tileSize=y,this.buffer=v,this.pixelFormat=iG[d],this.dataIndex=M,this.bandShape=[y+2*v,y+2*v,G3[this.pixelFormat]],this._decodedBlocks=new _S(k?k.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return G3[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:n})=>n).flat()}processDecodedData(n){const s=n.blockIndex.toString();this._decodedBlocks.get(s)||this._decodedBlocks.put(s,n.data)}getBlockForBand(n){let s=0;switch(typeof n){case"string":for(const[h,y]of this.dataIndex.entries()){for(const[d,v]of y.bands.entries())if(v===n)return{bandIndex:s+d,blockIndex:h,blockBandIndex:d};s+=y.bands.length}break;case"number":for(const[h,y]of this.dataIndex.entries()){if(n>=s&&n<s+y.bands.length)return{bandIndex:n,blockIndex:h,blockBandIndex:n-s};s+=y.bands.length}break;default:throw new Lc(`Invalid band \`${JSON.stringify(n)}\`. Expected string or integer.`)}throw new Lc(`Band not found: ${JSON.stringify(n)}`)}getDataRange(n){let s=1/0,h=-1/0;const y=[],d=new Set;for(const v of n){const{blockIndex:M}=this.getBlockForBand(v);if(M<0)throw new Lc(`Invalid band: ${JSON.stringify(v)}`);const k=this.dataIndex[M];y.includes(M)||y.push(M),d.add(M),s=Math.min(s,k.firstByte),h=Math.max(h,k.lastByte)}if(d.size>this.cacheSize)throw new Lc(`Number of blocks to decode (${d.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:s,lastByte:h,blockIndices:y}}hasBand(n){const{blockIndex:s}=this.getBlockForBand(n);return s>=0}hasDataForBand(n){const{blockIndex:s}=this.getBlockForBand(n);return s>=0&&!!this._decodedBlocks.get(s.toString())}getBandView(n){const{blockIndex:s,blockBandIndex:h}=this.getBlockForBand(n),y=this._decodedBlocks.get(s.toString());if(!y)throw new Lc(`Data for band ${JSON.stringify(n)} of layer "${this.name}" not decoded.`);const d=this.dataIndex[s],v=this.bandShape.reduce((j,E)=>j*E,1),M=h*v,k=y.subarray(M,M+v);return{data:k,bytes:new Uint8Array(k.buffer).subarray(k.byteOffset,k.byteOffset+k.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:d.offset,scale:d.scale}}}SS.setPbf=function(u){wS=u};class $3{constructor(n,s,h){this.tasks=n,this._onCancel=s,this._onComplete=h,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(n,s){this._finalized||(this._onComplete(n,s),this._finalized=!0)}}SS.performDecoding=function(u,n){const s=new Uint8Array(u);return Promise.all(n.tasks.map(h=>{const{layerName:y,firstByte:d,lastByte:v,pixelFormat:M,blockShape:k,blockIndex:j,filters:E,codec:D}=h,B=s.subarray(d,v+1),R=new Uint32Array(k[0]*k[1]*k[2]);let z;if(D!=="gzip_data")throw new Lc(`Unhandled codec: ${D}`);return z=function(q,W){if(!globalThis.DecompressionStream&&W==="gzip_data")return Promise.resolve(((ne=function(we){we[0]==31&&we[1]==139&&we[2]==8||Sh(6,"invalid gzip data");var ke=we[3],Re=10;4&ke&&(Re+=2+(we[10]|we[11]<<8));for(var Pe=(ke>>3&1)+(ke>>4&1);Pe>0;Pe-=!we[Re++]);return Re+(2&ke)}(se=q))+8>se.length&&Sh(6,"invalid gzip data"),function(we,ke,Re,Pe){var We=we.length;if(!We||ke.f&&!ke.l)return Re||new Xu(0);var Le=!Re,Je=Le||ke.i!=2,it=ke.i;Le&&(Re=new Xu(3*We));var tt,ot,ut=function(Hp){var ng=Re.length;if(Hp>ng){var qv=new Xu(Math.max(2*ng,Hp));qv.set(Re),Re=qv}},pt=ke.f||0,lt=ke.p||0,Lt=ke.b||0,Wt=ke.l,Rt=ke.d,xn=ke.m,mn=ke.n,on=8*We;do{if(!Wt){pt=wh(we,lt,1);var en=wh(we,lt+1,3);if(lt+=3,!en){var zn=we[(cr=4+((lt+7)/8|0))-4]|we[cr-3]<<8,Tn=cr+zn;if(Tn>We){it&&Sh(0);break}Je&&ut(Lt+zn),Re.set(we.subarray(cr,Tn),Lt),ke.b=Lt+=zn,ke.p=lt=8*Tn,ke.f=pt;continue}if(en==1)Wt=J9,Rt=Q9,xn=9,mn=5;else if(en==2){var Pn=wh(we,lt,31)+257,ir=wh(we,lt+10,15)+4,gr=Pn+wh(we,lt+5,31)+1;lt+=14;for(var wr=new Xu(gr),Sr=new Xu(19),kr=0;kr<ir;++kr)Sr[Z9[kr]]=wh(we,lt+3*kr,7);lt+=3*ir;var Lr=xS(Sr),Ai=(1<<Lr)-1,si=Bv(Sr,Lr);for(kr=0;kr<gr;){var cr,ai=si[wh(we,lt,Ai)];if(lt+=15&ai,(cr=ai>>4)<16)wr[kr++]=cr;else{var oi=0,Fi=0;for(cr==16?(Fi=3+wh(we,lt,3),lt+=2,oi=wr[kr-1]):cr==17?(Fi=3+wh(we,lt,7),lt+=3):cr==18&&(Fi=11+wh(we,lt,127),lt+=7);Fi--;)wr[kr++]=oi}}var va=wr.subarray(0,Pn),Va=wr.subarray(Pn);xn=xS(va),mn=xS(Va),Wt=Bv(va,xn),Rt=Bv(Va,mn)}else Sh(1);if(lt>on){it&&Sh(0);break}}Je&&ut(Lt+131072);for(var xa=(1<<xn)-1,ha=(1<<mn)-1,ka=lt;;ka=lt){var Qa=(oi=Wt[bS(we,lt)&xa])>>4;if((lt+=15&oi)>on){it&&Sh(0);break}if(oi||Sh(2),Qa<256)Re[Lt++]=Qa;else{if(Qa==256){ka=lt,Wt=null;break}var is=Qa-254;Qa>264&&(is=wh(we,lt,(1<<(Eh=N3[kr=Qa-257]))-1)+U3[kr],lt+=Eh);var Li=Rt[bS(we,lt)&ha],Gl=Li>>4;if(Li||Sh(3),lt+=15&Li,Va=K9[Gl],Gl>3){var Eh=B3[Gl];Va+=bS(we,lt)&(1<<Eh)-1,lt+=Eh}if(lt>on){it&&Sh(0);break}Je&&ut(Lt+131072);var zc=Lt+is;if(Lt<Va){var Nc=0-Va,tg=Math.min(Va,zc);for(Nc+Lt<0&&Sh(3);Lt<tg;++Lt)Re[Lt]=(void 0)[Nc+Lt]}for(;Lt<zc;++Lt)Re[Lt]=Re[Lt-Va]}}ke.l=Wt,ke.p=ka,ke.b=Lt,ke.f=pt,Wt&&(pt=1,ke.m=xn,ke.d=Rt,ke.n=mn)}while(!pt);return Lt!=Re.length&&Le?(tt=Re,((ot=Lt)==null||ot>tt.length)&&(ot=tt.length),new Xu(tt.subarray(0,ot))):Re.subarray(0,Lt)}(se.subarray(ne,-8),{i:2},new Xu(((K=se)[(oe=K.length)-4]|K[oe-3]<<8|K[oe-2]<<16|K[oe-1]<<24)>>>0))));var K,oe,se,ne;const ce=rG[W];if(!ce)throw new Error(`Unhandled codec: ${W}`);const pe=new globalThis.DecompressionStream(ce);return new Response(new Blob([q]).stream().pipeThrough(pe)).arrayBuffer().then(we=>new Uint8Array(we))}(B,D).then(q=>(function(W,K){W.readFields(q9,K)}(new wS(q),R),new aG[M](R.buffer))),z.then(q=>{for(let W=E.length-1;W>=0;W--)switch(E[W]){case"delta_filter":$9(q,k);break;case"zigzag_filter":H9(q);break;case"bitshuffle_filter":X9(q,M);break;default:throw new Lc(`Unhandled filter "${E[W]}"`)}return{layerName:y,blockIndex:j,data:q}}).catch(q=>{throw q})}))},In($3,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});let jv,TS,Th,Py,ES,Ry=null;function H3(){return Zo()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:TS||Mi.DRACO_URL}function X3(){if(Zo()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Py)return Py;const u=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Py=WebAssembly.validate(u)?Mi.MESHOPT_SIMD_URL:Mi.MESHOPT_URL,Py}const B1={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},sG={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Uv={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function Y3(u,n,s){const h=s.json.bufferViews.length,y=s.buffers.length;n.bufferView=h,s.json.bufferViews[h]={buffer:y,byteLength:u.byteLength},s.buffers[y]=u}const AS="KHR_draco_mesh_compression";function lG(u,n){const s=u.extensions&&u.extensions[AS];if(!s)return;const h=new Th.Decoder,y=J3(n,s.bufferView),d=new Th.Mesh;if(!h.DecodeArrayToMesh(y,y.byteLength,d))throw new Error("Failed to decode Draco mesh");const v=n.json.accessors[u.indices],M=B1[v.componentType],k=v.count*M.BYTES_PER_ELEMENT,j=Th._malloc(k);M===Uint16Array?h.GetTrianglesUInt16Array(d,k,j):h.GetTrianglesUInt32Array(d,k,j),Y3(Th.memory.buffer.slice(j,j+k),v,n),Th._free(j);for(const E of Object.keys(s.attributes)){const D=h.GetAttributeByUniqueId(d,s.attributes[E]),B=n.json.accessors[u.attributes[E]],R=sG[B.componentType],z=B.count*Uv[B.type]*B1[B.componentType].BYTES_PER_ELEMENT,q=Th._malloc(z);h.GetAttributeDataArrayForAllPoints(d,D,Th[R],z,q),Y3(Th.memory.buffer.slice(q,q+z),B,n),Th._free(q)}h.destroy(),d.destroy(),delete u.extensions[AS]}const F1="EXT_meshopt_compression";function uG(u,n){if(!u.extensions||!u.extensions[F1])return;const s=u.extensions[F1],h=new Uint8Array(n.buffers[s.buffer],s.byteOffset||0,s.byteLength||0),y=new Uint8Array(s.count*s.byteStride);ES.decodeGltfBuffer(y,s.count,s.byteStride,h,s.mode,s.filter),u.buffer=n.buffers.length,u.byteOffset=0,n.buffers[u.buffer]=y.buffer,delete u.extensions[F1]}const Z3=1179937895,W3=new TextDecoder("utf8");function K3(u,n){return new URL(u,n).href}function cG(u,n,s,h){return fetch(K3(u.uri,h)).then(y=>y.arrayBuffer()).then(y=>{n.buffers[s]=y})}function J3(u,n){const s=u.json.bufferViews[n];return new Uint8Array(u.buffers[s.buffer],s.byteOffset||0,s.byteLength)}function hG(u,n,s,h){if(u.uri){const y=K3(u.uri,h);return fetch(y).then(d=>d.blob()).then(d=>createImageBitmap(d)).then(d=>{n.images[s]=d})}if(u.bufferView!==void 0){const y=J3(n,u.bufferView),d=new Blob([y],{type:u.mimeType});return createImageBitmap(d).then(v=>{n.images[s]=v})}}function Q3(u,n=0,s){const h={json:null,images:[],buffers:[]};if(new Uint32Array(u,n,1)[0]===Z3){const E=new Uint32Array(u,n);let D=2;const B=(E[D++]>>2)-3,R=E[D++]>>2;if(D++,h.json=JSON.parse(W3.decode(E.subarray(D,D+R))),D+=R,D<B){const z=E[D++];D++;const q=n+(D<<2);h.buffers[0]=u.slice(q,q+z)}}else h.json=JSON.parse(W3.decode(new Uint8Array(u,n)));const{buffers:y,images:d,meshes:v,extensionsUsed:M,bufferViews:k}=h.json;let j=Promise.resolve();if(y){const E=[];for(let D=0;D<y.length;D++){const B=y[D];B.uri?E.push(cG(B,h,D,s)):h.buffers[D]||(h.buffers[D]=null)}j=Promise.all(E)}return j.then(()=>{const E=[],D=M&&M.includes(AS),B=M&&M.includes(F1);if(D&&E.push(function(){if(!Th)return jv??(jv=function(R){let z,q=null;function W(){z=new Uint8Array(q.buffer)}function K(){throw new Error("Unexpected Draco error.")}const oe={a:{a:K,d:function(se,ne,ce){return z.copyWithin(se,ne,ne+ce)},c:function(se){const ne=z.length,ce=Math.max(se>>>0,Math.ceil(1.2*ne)),pe=Math.ceil((ce-ne)/65536);try{return q.grow(pe),W(),!0}catch{return!1}},b:K}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(R,oe):R.then(se=>se.arrayBuffer()).then(se=>WebAssembly.instantiate(se,oe))).then(se=>{const{Rb:ne,Qb:ce,P:pe,T:we,X:ke,Ja:Re,La:Pe,Qa:We,Va:Le,Wa:Je,eb:it,jb:tt,f:ot,e:ut,yb:pt,zb:lt,Ab:Lt,Bb:Wt,Db:Rt,Gb:xn}=se.instance.exports;q=ut;const mn=(()=>{let on=0,en=0,zn=0,Tn=0;return Pn=>{zn&&(ne(Tn),ne(on),en+=zn,zn=on=0),on||(en+=128,on=ce(en));const ir=Pn.length+7&-8;let gr=on;ir>=en&&(zn=ir,gr=Tn=ce(ir));for(let wr=0;wr<Pn.length;wr++)z[gr+wr]=Pn[wr];return gr}})();return W(),ot(),{memory:ut,_free:ne,_malloc:ce,Mesh:class{constructor(){this.ptr=pe()}destroy(){we(this.ptr)}},Decoder:class{constructor(){this.ptr=Re()}destroy(){tt(this.ptr)}DecodeArrayToMesh(on,en,zn){const Tn=mn(on),Pn=Pe(this.ptr,Tn,en,zn.ptr);return!!ke(Pn)}GetAttributeByUniqueId(on,en){return{ptr:We(this.ptr,on.ptr,en)}}GetTrianglesUInt16Array(on,en,zn){Le(this.ptr,on.ptr,en,zn)}GetTrianglesUInt32Array(on,en,zn){Je(this.ptr,on.ptr,en,zn)}GetAttributeDataArrayForAllPoints(on,en,zn,Tn,Pn){it(this.ptr,on.ptr,en.ptr,zn,Tn,Pn)}},DT_INT8:pt(),DT_UINT8:lt(),DT_INT16:Lt(),DT_UINT16:Wt(),DT_UINT32:Rt(),DT_FLOAT32:xn()}})}(fetch(H3())),jv.then(R=>{Th=R,jv=void 0}))}()),B&&E.push(function(){if(ES)return;const R=function(z){let q;const W=WebAssembly.instantiateStreaming(z,{}).then(se=>{q=se.instance,q.exports.__wasm_call_ctors()}),K={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},oe={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:W,supported:!0,decodeGltfBuffer(se,ne,ce,pe,we,ke){(function(Re,Pe,We,Le,Je,it,tt){const ot=Re.exports.sbrk,ut=Le+3&-4,pt=ot(ut*Je),lt=ot(it.length),Lt=new Uint8Array(Re.exports.memory.buffer);Lt.set(it,lt);const Wt=Pe(pt,Le,Je,lt,it.length);if(Wt===0&&tt&&tt(pt,ut,Je),We.set(Lt.subarray(pt,pt+Le*Je)),ot(pt-ot(0)),Wt!==0)throw new Error(`Malformed buffer data: ${Wt}`)})(q,q.exports[oe[we]],se,ne,ce,pe,q.exports[K[ke]])}}}(fetch(X3()));return R.ready.then(()=>{ES=R})}()),d)for(let R=0;R<d.length;R++)E.push(hG(d[R],h,R,s));return(E.length?Promise.all(E):Promise.resolve()).then(()=>{if(D&&v)for(const{primitives:R}of v)for(const z of R)lG(z,h);if(B&&v&&k)for(const R of k)uG(R,h);return h})})}function eg(u,n){const s=u.json.bufferViews[n.bufferView],h=B1[n.componentType];return new h(u.buffers[s.buffer],(n.byteOffset||0)+(s.byteOffset||0),n.count*(s.byteStride&&s.byteStride!==Uv[n.type]*h.BYTES_PER_ELEMENT?s.byteStride/h.BYTES_PER_ELEMENT:Uv[n.type]))}function MS(u,n,s,h){const y=B1[n.componentType],d=function(E){switch(E){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(y),v=u.json.bufferViews[n.bufferView],M=v.byteStride?v.byteStride/y.BYTES_PER_ELEMENT:Uv[n.type],k=s.float32,j=k.length/s.capacity;for(let E=0,D=0;E<n.count*M;E+=M,D+=j)for(let B=0;B<j;B++)k[D+B]=h[E+B]*d;s._trim()}function fG(u,n,s){const h=u.indices,y=u.attributes,d={};d.indexArray=new Ja;const v=n.json.accessors[h],M=v.count/3;d.indexArray.reserve(M);const k=eg(n,v);for(let B=0;B<M;B++)d.indexArray.emplaceBack(k[3*B],k[3*B+1],k[3*B+2]);d.indexArray._trim(),d.vertexArray=new du;const j=n.json.accessors[y.POSITION];d.vertexArray.reserve(j.count);const E=eg(n,j);for(let B=0;B<j.count;B++)d.vertexArray.emplaceBack(E[3*B],E[3*B+1],E[3*B+2]);if(d.vertexArray._trim(),d.aabb=new Sn(j.min,j.max),d.centroid=function(B,R){const z=[0,0,0],q=B.length;if(q>0){for(let W=0;W<q;W++){const K=3*B[W];z[0]+=R[K],z[1]+=R[K+1],z[2]+=R[K+2]}z[0]/=q,z[1]/=q,z[2]/=q}return z}(k,E),y.COLOR_0!==void 0){const B=n.json.accessors[y.COLOR_0],R=Uv[B.type],z=eg(n,B);d.colorArray=R===3?new du:new Sc,d.colorArray.resize(B.count),MS(n,B,d.colorArray,z)}if(y.NORMAL!==void 0){d.normalArray=new du;const B=n.json.accessors[y.NORMAL];d.normalArray.resize(B.count);const R=eg(n,B);MS(n,B,d.normalArray,R)}if(y.TEXCOORD_0!==void 0&&s.length>0){d.texcoordArray=new ch;const B=n.json.accessors[y.TEXCOORD_0];d.texcoordArray.resize(B.count);const R=eg(n,B);MS(n,B,d.texcoordArray,R)}if(y._FEATURE_ID_RGBA4444!==void 0){const B=n.json.accessors[y._FEATURE_ID_RGBA4444];n.json.extensionsUsed&&n.json.extensionsUsed.includes("EXT_meshopt_compression")&&(d.featureData=eg(n,B))}y._FEATURE_RGBA4444!==void 0&&(d.featureData=new Uint32Array(eg(n,n.json.accessors[y._FEATURE_RGBA4444]).buffer));const D=u.material;return d.material=function(B,R){const{emissiveFactor:z=[0,0,0],alphaMode:q="OPAQUE",alphaCutoff:W=.5,normalTexture:K,occlusionTexture:oe,emissiveTexture:se,doubleSided:ne}=B,{baseColorFactor:ce=[1,1,1,1],metallicFactor:pe=1,roughnessFactor:we=1,baseColorTexture:ke,metallicRoughnessTexture:Re}=B.pbrMetallicRoughness||{},Pe=oe?R[oe.index]:void 0;if(oe&&oe.extensions&&oe.extensions.KHR_texture_transform&&Pe){const We=oe.extensions.KHR_texture_transform;Pe.offsetScale=[We.offset[0],We.offset[1],We.scale[0],We.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Vr(...ce),metallicFactor:pe,roughnessFactor:we,baseColorTexture:ke?R[ke.index]:void 0,metallicRoughnessTexture:Re?R[Re.index]:void 0},doubleSided:ne,emissiveFactor:z,alphaMode:q,alphaCutoff:W,normalTexture:K?R[K.index]:void 0,occlusionTexture:Pe,emissionTexture:se?R[se.index]:void 0,defined:B.defined===void 0}}(D!==void 0?n.json.materials[D]:{defined:!1},s),d}function ek(u,n,s){const{matrix:h,rotation:y,translation:d,scale:v,mesh:M,extras:k,children:j}=u,E={};if(E.matrix=h||Ne.mat4.fromRotationTranslationScale([],y||[0,0,0,1],d||[0,0,0],v||[1,1,1]),M!==void 0){E.meshes=s[M];const D=E.anchor=[0,0];for(const B of E.meshes){const{min:R,max:z}=B.aabb;D[0]+=R[0]+z[0],D[1]+=R[1]+z[1]}D[0]=Math.floor(D[0]/E.meshes.length/2),D[1]=Math.floor(D[1]/E.meshes.length/2)}if(k&&(k.id&&(E.id=k.id),k.lights&&(E.lights=function(D){if(!D.length)return[];const B=function(K){const oe=atob(K),se=new Uint8Array(oe.length);for(let ne=0;ne<oe.length;ne++)se[ne]=oe.codePointAt(ne);return se}(D),R=[],z=B.length/24,q=new Uint16Array(B.buffer),W=new Float32Array(B.buffer);for(let K=0;K<z;K++){const oe=q[2*K*6]/30,se=q[2*K*6+1]/30,ne=q[2*K*6+10]/100,ce=W[6*K+1],pe=W[6*K+2],we=W[6*K+3],ke=W[6*K+4],Re=we-ce,Pe=ke-pe,We=Math.hypot(Re,Pe);R.push({pos:[ce+.5*Re,pe+.5*Pe,se],normal:[Pe/We,-Re/We,0],width:We,height:oe,depth:ne,points:[ce,pe,we,ke]})}return R}(k.lights))),j){const D=[];for(const B of j)D.push(ek(n.json.nodes[B],n,s));E.children=D}return E}function dG(u){if(u.vertices.length===0||u.indices.length===0)return null;const n=new J_(u.vertices,u.indices,8,256),[s,h]=[n.min.clone(),n.max.clone()];return{vertices:u.vertices,indices:u.indices,grid:n,min:s,max:h}}function pG(u){if(!u.extras||!u.extras.ground)return null;const n=u.extras.ground;if(!n||!Array.isArray(n)||n.length===0)return null;const s=n[0];if(!s||!Array.isArray(s)||s.length===0)return null;const h=[];for(const v of s){if(!Array.isArray(v)||v.length!==2)continue;const M=v[0],k=v[1];typeof M=="number"&&typeof k=="number"&&h.push(new $t(M,k))}if(h.length<3)return null;h.length>1&&h[h.length-1].equals(h[0])&&h.pop();let y=0;for(let v=0;v<h.length;v++){const M=h[v],k=h[(v+1)%h.length],j=h[(v+2)%h.length];y+=(M.x-k.x)*(j.y-k.y)-(j.x-k.x)*(M.y-k.y)}y>0&&h.reverse();const d=km(h.flatMap(v=>[v.x,v.y]),[]);return d.length===0?null:{vertices:h,indices:d}}function mG(u,n){const s=[],h=[];let y=0;const d=[];for(const v of u){y=s.length;const M=v.vertexArray.float32,k=v.indexArray.uint16;for(let j=0;j<v.vertexArray.length;j++)d[0]=M[3*j+0],d[1]=M[3*j+1],d[2]=M[3*j+2],Ne.vec3.transformMat4(d,d,n),s.push(new $t(d[0],d[1]));for(let j=0;j<3*v.indexArray.length;j++)h.push(k[j]+y)}if(h.length%3!=0)return null;for(let v=0;v<h.length;v+=3){const M=s[h[v+0]],k=s[h[v+1]],j=s[h[v+2]];(M.x-k.x)*(j.y-k.y)-(j.x-k.x)*(M.y-k.y)>0&&([h[v+1],h[v+2]]=[h[v+2],h[v+1]])}return{vertices:s,indices:h}}function tk(u){const n=function(k,j){const E=[],D=WebGL2RenderingContext;if(k.json.textures)for(const B of k.json.textures){const R={magFilter:D.LINEAR,minFilter:D.NEAREST,wrapS:D.REPEAT,wrapT:D.REPEAT};B.sampler!==void 0&&Object.assign(R,k.json.samplers[B.sampler]),E.push({image:j[B.source],sampler:R,uploaded:!1})}return E}(u,u.images),s=function(k,j){const E=[];for(const D of k.json.meshes){const B=[];for(const R of D.primitives)B.push(fG(R,k,j));E.push(B)}return E}(u,n),{scenes:h,scene:y,nodes:d}=u.json,v=h?h[y||0].nodes:d,M=[];for(const k of v)M.push(ek(d[k],u,s));return function(k,j,E){const D={},B=new Set;for(let R=0;R<k.length;R++){const z=E[j[R]];if(!z.extras)continue;const q=z.extras["mapbox:footprint:version"],W=z.extras["mapbox:footprint:id"];(q||W)&&B.add(R),q==="1.0.0"&&W&&(D[W]=R)}for(let R=0;R<k.length;R++){if(B.has(R))continue;const z=k[R],q=E[j[R]];if(!q.extras)continue;let W=null;z.id in D&&(W=mG(k[D[z.id]].meshes,z.matrix)),W||(W=pG(q)),W&&(z.footprint=dG(W))}if(B.size>0){const R=Array.from(B.values()).sort((z,q)=>z-q);for(let z=R.length-1;z>=0;z--)k.splice(R[z],1)}}(M,v,u.json.nodes),M}function gG(u){u.heightmap=new Float32Array(4096),u.heightmap.fill(-1);const n=u.vertexArray.float32,s=u.aabb.min[0]-1,h=u.aabb.min[1]-1,y=Km/(u.aabb.max[0]-s+2),d=Km/(u.aabb.max[1]-h+2);for(let v=0;v<n.length;v+=3){const M=n[v+2],k=(n[v+0]-s)*y|0,j=(n[v+1]-h)*d|0;M>u.heightmap[j*Km+k]&&(u.heightmap[j*Km+k]=M)}}function yG(u,n){const s={};s.indexArray=new Ja,s.indexArray.reserve(4*u.length),s.vertexArray=new du,s.vertexArray.reserve(10*u.length),s.colorArray=new Sc,s.vertexArray.reserve(10*u.length);let h=0;for(const v of u){const M=Math.min(10,Math.max(4,1.3*v.height))*n,k=[-v.normal[1],v.normal[0],0],j=Math.min(.29,.1*v.width/v.depth),E=v.width-2*v.depth*n*(j+.01),D=Ne.vec3.scaleAndAdd([],v.pos,k,E/2),B=Ne.vec3.scaleAndAdd([],v.pos,k,-E/2),R=[D[0],D[1],D[2]+v.height],z=[B[0],B[1],B[2]+v.height],q=Ne.vec3.scaleAndAdd([],v.normal,k,j);Ne.vec3.scale(q,q,M);const W=Ne.vec3.scaleAndAdd([],v.normal,k,-j);Ne.vec3.scale(W,W,M),Ne.vec3.add(q,D,q),Ne.vec3.add(W,B,W),D[2]+=.1,B[2]+=.1,s.vertexArray.emplaceBack(q[0],q[1],q[2]),s.vertexArray.emplaceBack(W[0],W[1],W[2]),s.vertexArray.emplaceBack(D[0],D[1],D[2]),s.vertexArray.emplaceBack(B[0],B[1],B[2]),s.vertexArray.emplaceBack(R[0],R[1],R[2]),s.vertexArray.emplaceBack(z[0],z[1],z[2]),s.vertexArray.emplaceBack(D[0],D[1],D[2]),s.vertexArray.emplaceBack(B[0],B[1],B[2]),s.vertexArray.emplaceBack(q[0],q[1],q[2]),s.vertexArray.emplaceBack(W[0],W[1],W[2]);const K=E/M/2;s.colorArray.emplaceBack(-K-j,-1,K,.8),s.colorArray.emplaceBack(K+j,-1,K,.8),s.colorArray.emplaceBack(-K,0,K,1.3),s.colorArray.emplaceBack(K,0,K,1.3),s.colorArray.emplaceBack(K+j,-.8,K,.7),s.colorArray.emplaceBack(K+j,-.8,K,.7),s.colorArray.emplaceBack(0,0,K,1.3),s.colorArray.emplaceBack(0,0,K,1.3),s.colorArray.emplaceBack(K+j,-1.2,K,.8),s.colorArray.emplaceBack(K+j,-1.2,K,.8),s.indexArray.emplaceBack(6+h,4+h,8+h),s.indexArray.emplaceBack(7+h,9+h,5+h),s.indexArray.emplaceBack(0+h,1+h,2+h),s.indexArray.emplaceBack(1+h,3+h,2+h),h+=10}const y={defined:!0,emissiveFactor:[0,0,0]},d={};return d.baseColorFactor=Vr.white,y.pbrMetallicRoughness=d,s.material=y,s.aabb=new Sn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),s}class nk{constructor(n){this._stringToNumber={},this._numberToString=[];for(let s=0;s<n.length;s++){const h=n[s];this._stringToNumber[h]=s,this._numberToString[s]=h}}encode(n){return this._stringToNumber[n]}decode(n){return this._numberToString[n]}}const _G=["id","tile","layer","source","sourceLayer","state"];class ky{constructor(n,s,h,y,d){this.type="Feature",this._vectorTileFeature=n,this._z=s,this._x=h,this._y=y,this.properties=n.properties,this.id=d}clone(){const n=new ky(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(n.state=Object.assign({},this.state)),this.layer&&(n.layer=Object.assign({},this.layer)),this.source&&(n.source=this.source),this.sourceLayer&&(n.sourceLayer=this.sourceLayer),n}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const s of _G)this[s]!==void 0&&(n[s]=this[s]);return n}}class rk{constructor(n,s){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new oh(pn,16,0),this.featureIndexArray=new ff,this.promoteId=s,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(n,s,h,y,d,v=0,M=0){const k=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,y,d,v);const j=this.grid;for(let E=0;E<s.length;E++){const D=s[E],B=[1/0,1/0,-1/0,-1/0];for(let R=0;R<D.length;R++){const z=D[R];B[0]=Math.min(B[0],z.x),B[1]=Math.min(B[1],z.y),B[2]=Math.max(B[2],z.x),B[3]=Math.max(B[3],z.y)}M!==0&&(B[0]-=M,B[1]-=M,B[2]+=M,B[3]+=M),B[0]<pn&&B[1]<pn&&B[2]>=0&&B[3]>=0&&j.insert(k,B[0],B[1],B[2],B[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Od.VectorTile(new _(this.rawTileData)).layers,this.sourceLayerCoder=new nk(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const n in this.vtLayers)this.vtFeatures[n]=[]}return this.vtLayers}query(n,s){const{tilespaceGeometry:h,transform:y,tileTransform:d,pixelPosMatrix:v,availableImages:M}=s;this.loadVTLayers(),this.serializedLayersCache.clear();const k=h.bufferedTilespaceBounds,j=this.grid.query(k.min.x,k.min.y,k.max.x,k.max.y,(R,z,q,W)=>Qe(h.bufferedTilespaceGeometry,R,z,q,W));j.sort(vG);let E=null;y.elevation&&j.length>0&&(E=Ay.create(y.elevation,this.tileID));const D={};let B;for(let R=0;R<j.length;R++){const z=j[R];if(z===B)continue;B=z;const q=this.featureIndexArray.get(z);let W=null;this.is3DTile?this.loadMatchingModelFeature(D,q,n,h,y):this.loadMatchingFeature(D,q,n,M,(K,oe,se,ne=0)=>(W||(W=Z(K,this.tileID.canonical,d)),oe.queryIntersectsFeature(h,K,se,W,this.z,y,v,E,ne)))}return D}loadMatchingFeature(n,s,h,y,d){const{featureIndex:v,bucketIndex:M,sourceLayerIndex:k,layoutVertexArrayOffset:j}=s,E=this.bucketLayerIDs[M],D=h.layers,B=Object.keys(D);if(B.length&&!function(K,oe){for(let se=0;se<K.length;se++)if(oe.indexOf(K[se])>=0)return!0;return!1}(B,E))return;const R=h.sourceCache,z=this.sourceLayerCoder.decode(k),q=this.vtLayers[z].feature(v),W=this.getId(q,z);for(let K=0;K<E.length;K++){const oe=E[K];if(!D[oe])continue;const{styleLayer:se,targets:ne}=D[oe];let ce={};W!==void 0&&(ce=R.getFeatureState(se.sourceLayer,W));const pe=!d||d(q,se,ce,j);if(!pe)continue;const we=new ky(q,this.z,this.x,this.y,W);we.tile=this.tileID.canonical,we.state=ce;let ke=this.serializedLayersCache.get(oe);ke||(ke=se.serialize(),ke.id=oe,this.serializedLayersCache.set(oe,ke)),we.source=ke.source,we.sourceLayer=ke["source-layer"],we.layer=ar({},ke),we.layer.paint=ik(ke.paint,se.paint,q,ce,y),we.layer.layout=ik(ke.layout,se.layout,q,ce,y);let Re=!1;for(const Pe of ne){this.updateFeatureProperties(we,Pe);const{filter:We}=Pe;if(We){if(q.properties=we.properties,We.needGeometry){const Le=J(q,!0);if(!We.filter(new ci(this.tileID.overscaledZ),Le,this.tileID.canonical))continue}else if(!We.filter(new ci(this.tileID.overscaledZ),q))continue}Re=!0,Pe.targetId&&this.addFeatureVariant(we,Pe)}Re&&this.appendToResult(n,oe,v,we,pe)}}loadMatchingModelFeature(n,s,h,y,d){const v=this.bucketLayerIDs[0][0],M=h.layers;if(!M[v])return;const{styleLayer:k,targets:j}=M[v];if(k.type!=="model")return;const E=y.tile,D=s.featureIndex,B=E.getBucket(k);if(!(B&&B instanceof C1))return;const R=function(ke,Re,Pe,We){const Le=ke.getNodesInfo()[Re];if(Le.hiddenByReplacement||!Le.node.meshes)return;let Je=Number.MAX_VALUE;const it=Le.node,tt=Pe.tile,ot=We.calculatePosMatrix(tt.tileID.toUnwrapped(),We.worldSize),ut=Le.evaluatedScale;let pt=0;We.elevation&&it.elevation&&(pt=it.elevation*We.elevation.exaggeration()),Ne.mat4.translate(ot,ot,[(it.anchor?it.anchor[0]:0)*(ut[0]-1),(it.anchor?it.anchor[1]:0)*(ut[1]-1),pt]),Ne.mat4.scale(ot,ot,ut);const lt=Pe.queryGeometry,Lt=lt.isPointQuery()?lt.screenBounds:lt.screenGeometry,Wt=function(xn){const mn=Ne.mat4.multiply([],ot,xn.matrix);Ne.mat4.multiply(mn,We.expandedFarZProjMatrix,mn);for(let on=0;on<xn.meshes.length;++on){const en=xn.meshes[on];if(on===xn.lightMeshIndex)continue;const zn=n3(Lt,We,mn,en.aabb);zn!=null&&(Je=Math.min(zn,Je))}if(xn.children)for(const on of xn.children)Wt(on)};if(Wt(it),Je===Number.MAX_VALUE)return;const Rt=new Gr(0,0);return p3(tt.tileID.canonical,Rt,Le.node.anchor[0],Le.node.anchor[1]),{intersectionZ:Je,position:Rt,feature:Le.feature}}(B,D,y,d);if(!R)return;const{z,x:q,y:W}=E.tileID.canonical,{feature:K,intersectionZ:oe,position:se}=R;let ne={};K.id!==void 0&&(ne=h.sourceCache.getFeatureState(k.sourceLayer,K.id));const ce=new ky({},z,q,W,K.id);ce.tile=this.tileID.canonical,ce.state=ne,ce.properties=K.properties,ce.geometry={type:"Point",coordinates:[se.lng,se.lat]};let pe=this.serializedLayersCache.get(v);pe||(pe=k.serialize(),pe.id=v,this.serializedLayersCache.set(v,pe)),ce.source=pe.source,ce.sourceLayer=pe["source-layer"],ce.layer=ar({},pe);let we=!1;for(const ke of j){this.updateFeatureProperties(ce,ke);const{filter:Re}=ke;if(Re){if(K.properties=ce.properties,Re.needGeometry){if(!Re.filter(new ci(this.tileID.overscaledZ),K,this.tileID.canonical))continue}else if(!Re.filter(new ci(this.tileID.overscaledZ),K))continue}we=!0,ke.targetId&&this.addFeatureVariant(ce,ke)}we&&this.appendToResult(n,v,D,ce,oe)}updateFeatureProperties(n,s,h){if(s.properties){const y={};for(const d in s.properties){const v=s.properties[d].evaluate({zoom:this.z},n._vectorTileFeature,n.state,n.tile,h);v!=null&&(y[d]=v)}n.properties=y}}addFeatureVariant(n,s,h){const y={target:s.target,namespace:s.namespace,uniqueFeatureID:s.uniqueFeatureID};s.properties&&(y.properties=n.properties),n.variants=n.variants||{},n.variants[s.targetId]=n.variants[s.targetId]||[],n.variants[s.targetId].push(y)}appendToResult(n,s,h,y,d){let v=n[s];v===void 0&&(v=n[s]=[]),v.push({featureIndex:h,feature:y,intersectionZ:d})}lookupSymbolFeatures(n,s,h,y,d){const v={};this.loadVTLayers();for(const M of n)this.loadMatchingFeature(v,{bucketIndex:s,sourceLayerIndex:h,featureIndex:M,layoutVertexArrayOffset:0},y,d);return v}loadFeature(n){const{featureIndex:s,sourceLayerIndex:h}=n;this.loadVTLayers();const y=this.sourceLayerCoder.decode(h),d=this.vtFeatures[y];if(d[s])return d[s];const v=this.vtLayers[y].feature(s);return d[s]=v,v}hasLayer(n){for(const s of this.bucketLayerIDs)for(const h of s)if(n===h)return!0;return!1}getId(n,s){let h=n.id;if(this.promoteId){const y=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[s];if(y!=null)if(Array.isArray(y)){if(!this.promoteIdExpression){const d=pa(y);if(d.result!=="success"){const v=d.value.map(M=>`${M.key}: ${M.message}`).join(", ");return void lr(`Failed to create expression for promoteId: ${v}`)}this.promoteIdExpression=d.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new Cl),h=this.promoteIdExpression.evaluate({zoom:0},n)}else h=n.properties[y];typeof h=="boolean"&&(h=Number(h))}return h}}function ik(u,n,s,h,y){return $a(u,(d,v)=>{const M=n instanceof sh?n.get(v):null;return M&&M.evaluate?M.evaluate(s,h,y):M})}function vG(u,n){return n-u}In(rk,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const ak=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class OS{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,h]=new Uint8Array(n,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const y=h>>4;if(y!==1)throw new Error(`Got v${y} data when expected v1.`);const d=ak[15&h];if(!d)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(n,2,1),[M]=new Uint32Array(n,4,1);return new OS(M,v,d,n)}constructor(n,s=64,h=Float64Array,y){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=h,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const d=ak.indexOf(this.ArrayType),v=2*n*this.ArrayType.BYTES_PER_ELEMENT,M=n*this.IndexArrayType.BYTES_PER_ELEMENT,k=(8-M%8)%8;if(d<0)throw new Error(`Unexpected typed array class: ${h}.`);y&&y instanceof ArrayBuffer?(this.data=y,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+M+k,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+v+M+k),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+M+k,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+d]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=n)}add(n,s){const h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=n,this.coords[this._pos++]=s,h}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return IS(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,s,h,y){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:v,nodeSize:M}=this,k=[0,d.length-1,0],j=[];for(;k.length;){const E=k.pop()||0,D=k.pop()||0,B=k.pop()||0;if(D-B<=M){for(let W=B;W<=D;W++){const K=v[2*W],oe=v[2*W+1];K>=n&&K<=h&&oe>=s&&oe<=y&&j.push(d[W])}continue}const R=B+D>>1,z=v[2*R],q=v[2*R+1];z>=n&&z<=h&&q>=s&&q<=y&&j.push(d[R]),(E===0?n<=z:s<=q)&&(k.push(B),k.push(R-1),k.push(1-E)),(E===0?h>=z:y>=q)&&(k.push(R+1),k.push(D),k.push(1-E))}return j}within(n,s,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:d,nodeSize:v}=this,M=[0,y.length-1,0],k=[],j=h*h;for(;M.length;){const E=M.pop()||0,D=M.pop()||0,B=M.pop()||0;if(D-B<=v){for(let W=B;W<=D;W++)sk(d[2*W],d[2*W+1],n,s)<=j&&k.push(y[W]);continue}const R=B+D>>1,z=d[2*R],q=d[2*R+1];sk(z,q,n,s)<=j&&k.push(y[R]),(E===0?n-h<=z:s-h<=q)&&(M.push(B),M.push(R-1),M.push(1-E)),(E===0?n+h>=z:s+h>=q)&&(M.push(R+1),M.push(D),M.push(1-E))}return k}}function IS(u,n,s,h,y,d){if(y-h<=s)return;const v=h+y>>1;ok(u,n,v,h,y,d),IS(u,n,s,h,v-1,1-d),IS(u,n,s,v+1,y,1-d)}function ok(u,n,s,h,y,d){for(;y>h;){if(y-h>600){const j=y-h+1,E=s-h+1,D=Math.log(j),B=.5*Math.exp(2*D/3),R=.5*Math.sqrt(D*B*(j-B)/j)*(E-j/2<0?-1:1);ok(u,n,s,Math.max(h,Math.floor(s-E*B/j+R)),Math.min(y,Math.floor(s+(j-E)*B/j+R)),d)}const v=n[2*s+d];let M=h,k=y;for(Vv(u,n,h,s),n[2*y+d]>v&&Vv(u,n,h,y);M<k;){for(Vv(u,n,M,k),M++,k--;n[2*M+d]<v;)M++;for(;n[2*k+d]>v;)k--}n[2*h+d]===v?Vv(u,n,h,k):(k++,Vv(u,n,k,y)),k<=s&&(h=k+1),s<=k&&(y=k-1)}}function Vv(u,n,s,h){CS(u,s,h),CS(n,2*s,2*h),CS(n,2*s+1,2*h+1)}function CS(u,n,s){const h=u[n];u[n]=u[s],u[s]=h}function sk(u,n,s,h){const y=u-s,d=n-h;return y*y+d*d}i.$=vm,i.A=la,i.B=2,i.C=Tv,i.D=My,i.E=Ol,i.F=vR,i.G=class extends O1{},i.H=js,i.I=vS,i.J=Yc,i.K=yp,i.L=Uo,i.M=Zh,i.N=Wh,i.O=Kh,i.P=$t,i.Q=sd,i.R=Nr,i.S=Qh,i.T=aS,i.U=pa,i.V=O1,i.W=xi,i.X=mi,i.Y=Qr,i.Z=qi,i._=Xa,i.a=function(u){return Mi.API_CDN_URL_REGEX.test(u)},i.a$=ky,i.a0=ll,i.a1=dp,i.a2=function(u){const n=u.value;let s=[];if(!n)return s;const h=js(n);return h!=="string"?(s=s.concat([new O1(u.key,n,`string expected, "${h}" found`)]),s):(i3(n,!0)||(s=s.concat([new O1(u.key,n,`invalid url "${n}"`)])),s)},i.a3=_t,i.a4=af,i.a5=Bi,i.a6=sn,i.a7=class{constructor(u){this.specification=u}possiblyEvaluate(u,n){return $i(u.expression.evaluate(n))}interpolate(u,n,s){return{x:Nn(u.x,n.x,s),y:Nn(u.y,n.y,s),z:Nn(u.z,n.z,s),azimuthal:Nn(u.azimuthal,n.azimuthal,s),polar:Nn(u.polar,n.polar,s)}}},i.a8=ci,i.a9=Lu,i.aA=gl,i.aB=class{constructor(u){this.entries={},this.scheduler=u}request(u,n,s,h){const y=this.entries[u]=this.entries[u]||{callbacks:[]};if(y.result){const[d,v]=y.result;return this.scheduler?this.scheduler.add(()=>{h(d,v)},n):h(d,v),()=>{}}return y.callbacks.push(h),y.cancel||(y.cancel=s((d,v)=>{y.result=[d,v];for(const M of y.callbacks)this.scheduler?this.scheduler.add(()=>{M(d,v)},n):M(d,v);setTimeout(()=>delete this.entries[u],3e3)})),()=>{y.result||(y.callbacks=y.callbacks.filter(d=>d!==h),y.callbacks.length||(y.cancel(),delete this.entries[u]))}}},i.aC=$s,i.aD=function(u,n,s){const h=JSON.stringify(u.request);return u.data&&(this.deduped.entries[h]={result:[null,u.data]}),this.deduped.request(h,{type:"parseTile",isSymbolTile:u.isSymbolTile,zoom:u.tileZoom},y=>{const d=Ri(u.request,(v,M,k,j)=>{v?y(v):M&&y(null,{vectorTile:s?void 0:new Od.VectorTile(new _(M)),rawData:M,cacheControl:k,expires:j})});return()=>{d.cancel(),y()}},n)},i.aE=function(u){Rn++,Rn>vt&&(u.getActor().send("enforceCacheSizeLimit",rt),Rn=0)},i.aF=function(u){return u<=1?1:Math.pow(2,Math.floor(Math.log(u)/Math.LN2))},i.aG=tn,i.aH=$R,i.aI=KR,i.aJ=GR,i.aK=function(u,n){const s=document.createElement("video");s.muted=!0,s.onloadstart=function(){n(null,s)};for(let h=0;h<u.length;h++){const y=document.createElement("source");Vi(u[h])||(s.crossOrigin="Anonymous"),y.src=u[h],s.appendChild(y)}return{cancel:()=>{}}},i.aL=S1,i.aM=function(u){return fetch(u).then(n=>n.arrayBuffer()).then(n=>Q3(n,0,u))},i.aN=tk,i.aO=class{constructor(u,n,s,h){this.id=u,this.position=n!=null?new Gr(n[0],n[1]):new Gr(0,0),this.orientation=s??[0,0,0],this.nodes=h,this.uploaded=!1,this.aabb=new Sn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(u,n){if(Ne.mat4.multiply(u.matrix,n,u.matrix),u.meshes)for(const s of u.meshes){const h=Sn.applyTransformFast(s.aabb,u.matrix);this.aabb.encapsulate(h)}if(u.children)for(const s of u.children)this._applyTransformations(s,u.matrix)}computeBoundsAndApplyParent(){const u=Ne.mat4.identity([]);for(const n of this.nodes)this._applyTransformations(n,u)}computeModelMatrix(u,n,s,h,y,d,v=!1){u3(this.matrix,this,u.transform,this.position,n,s,h,y,d,v)}upload(u){if(!this.uploaded){for(const n of this.nodes)cS(n,u);for(const n of this.nodes)I1(n);this.uploaded=!0}}destroy(){for(const u of this.nodes)hS(u)}},i.aP=ec,i.aQ=Av,i.aR=qo,i.aS=Pa,i.aT=zl,i.aU=Ja,i.aV=Kr,i.aW=Ep,i.aX=b1,i.aY=function(){Ii.isLoading()||Ii.isLoaded()||rf()!=="deferred"||yo()},i.aZ=xm,i.a_=J,i.aa=l,i.ab=Ne,i.ac=no,i.ad=sh,i.ae=xo,i.af=Nn,i.ag=pn,i.ah=Ya,i.ai=hr,i.aj=Vr,i.ak=class{constructor(u){this.specification=u}possiblyEvaluate(u,n){return function([s,h]){const y=$i([1,s,h]);return{x:y.x,y:y.y,z:y.z}}(u.expression.evaluate(n))}interpolate(u,n,s){return{x:Nn(u.x,n.x,s),y:Nn(u.y,n.y,s),z:Nn(u.z,n.z,s)}}},i.al=function(u,n,s=0,h=!0){const y=new $t(s,s),d=u.sub(y),v=n.add(y),M=[d,new $t(v.x,d.y),v,new $t(d.x,v.y)];return h&&M.push(d.clone()),M},i.am=function(u,n){const s=[];for(let h=0;h<u.length;h++){const y=To(h-1,-1,u.length-1),d=To(h+1,-1,u.length-1),v=u[h],M=u[d],k=u[y].sub(v).unit(),j=M.sub(v).unit(),E=j.angleWithSep(k.x,k.y),D=k.add(j).unit().mult(-1*n/Math.sin(E/2));s.push(v.add(D))}return s},i.an=CR,i.ao=Qe,i.ap=function(u,n,s=0){return Ne.vec3.fromValues(((n.x-s)*u.scale-u.x)*pn,(n.y*u.scale-u.y)*pn,_u(n.z,n.y))},i.aq=tr,i.ar=pv,i.as=function(u){let n=1/0,s=1/0,h=-1/0,y=-1/0;for(const d of u)n=Math.min(n,d.x),s=Math.min(s,d.y),h=Math.max(h,d.x),y=Math.max(y,d.y);return{min:new $t(n,s),max:new $t(h,y)}},i.at=Vl,i.au=Ue,i.av=w,i.aw=Mn,i.ax=_o,i.ay=function(u,n){const s={};for(let h=0;h<n.length;h++){const y=n[h];y in u&&(s[y]=u[y])}return s},i.az=Gu,i.b=function(u){return Mi.API_FONTS_REGEX.test(u)},i.b$=A1,i.b0=Eo,i.b1=kd,i.b2=ny,i.b3=Z,i.b4=fu,i.b5=Uu,i.b6=Un,i.b7=Yi,i.b8=km,i.b9=nS,i.bA=Kx,i.bB=W2,i.bC=AR,i.bD=Pt,i.bE=OS,i.bF=To,i.bG=zs,i.bH=vo,i.bI=function(u,n,s){u[4*n+0]=s[0],u[4*n+1]=s[1],u[4*n+2]=s[2],u[4*n+3]=s[3]},i.bJ=vd,i.bK=Hs,i.bL=Mc,i.bM=na,i.bN=ph,i.bO=Gr,i.bP=LR,i.bQ=Ut,i.bR=$r,i.bS=QR,i.bT=Yt,i.bU=ua,i.bV=function(u,n,s,h,y,d,v,M,k){if(k.name==="globe")return ua(u,n,new Yt(s,h,y),!1);const j=Av({z:s,x:h,y},k);return new Sn([(d+j.x/j.scale)*n,n*(j.y/j.scale),v],[(d+j.x2/j.scale)*n,n*(j.y2/j.scale),M])},i.bW=function(u,n,s){let h=0;for(let y=0;y<2;++y)u[y]>0&&(h+=(u[y]-0)*(u[y]-0)),n[y]<0&&(h+=(0-n[y])*(0-n[y]));return h},i.bX=hi,i.bY=qu,i.bZ=function(u){const n=Ne.mat4.identity(new Float64Array(16));Ne.mat4.multiply(n,u.pixelMatrix,u.globeMatrix);const s=[0,Co,0],h=[0,Po,0];return Ne.vec3.transformMat4(s,s,n),Ne.vec3.transformMat4(h,h,n),[s[0]>0&&s[0]<=u.width&&s[1]>0&&s[1]<=u.height&&!uo(u,new Gr(u.center.lat,90)),h[0]>0&&h[0]<=u.width&&h[1]>0&&h[1]<=u.height&&!uo(u,new Gr(u.center.lat,-90))]},i.b_=function(u,n){const{scale:s}=u.tileTransform,h=s*pn/(u.tileSize*Math.pow(2,n.zoom-u.tileID.overscaledZ+u.tileID.canonical.z));return Ne.mat2.scale(new Float32Array(4),n.inverseAdjustmentMatrix,[h,h])},i.ba=function(u,n){const s=xo(n.zoom);if(s===0)return ki(u);const h=zr(u),y=ti(h),d=Vl(h.getWest())*n.worldSize,v=Vl(h.getEast())*n.worldSize,M=gl(h.getNorth())*n.worldSize,k=gl(h.getSouth())*n.worldSize,j=[d,M,0],E=[v,M,0],D=[d,k,0],B=[v,k,0],R=Ne.mat4.invert([],n.globeMatrix);return Ne.vec3.transformMat4(j,j,R),Ne.vec3.transformMat4(E,E,R),Ne.vec3.transformMat4(D,D,R),Ne.vec3.transformMat4(B,B,R),y[0]=Wi(y[0],D,s),y[1]=Wi(y[1],B,s),y[2]=Wi(y[2],E,s),y[3]=Wi(y[3],j,s),Sn.fromPoints(y)},i.bb=aa,i.bc=ei,i.bd=Wi,i.be=uh,i.bf=Gn,i.bg=SS,i.bh=_,i.bi=Ri,i.bj=function(u){const n=[];for(const s in u)n.push(u[s]);return n},i.bk=function(u,n){const s=[];for(const h in u)h in n||s.push(h);return s},i.bl=Ds,i.bm=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.bn=Ur,i.bo=function(u,n){const{x:s,y:h}=u.point,y=Go(s,h,u.worldSize/u._pixelsPerMercatorPixel,0,0);return Ne.mat4.multiply(y,y,ii(ki(n)))},i.bp=Ld,i.bq=Ge,i.br=Dd,i.bs=function(u,n,s,h,y){const d=5*n+2;u.float32[d+0]=s,u.float32[d+1]=h,u.float32[d+2]=y},i.bt=x1,i.bu=_R,i.bv=fe,i.bw=bo,i.bx=ly,i.by=r3,i.bz=rv,i.c=Tu,i.c$=(u,n,s,h,y,d,v,M)=>{const k=u.transform,j=k.pitch<15?mv(.07,.7,Mn((14-k.zoom)/5,0,1)):.07,E=s.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:gv(u,n,s,h),u_texsize:n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:k.calculatePixelsToTileUnitsMatrix(n),u_device_pixel_ratio:y,u_width_scale:d,u_floor_width_scale:v,u_image:0,u_tile_units_to_pixels:my(n,k),u_units_to_pixels:[1/k.pixelsToGLUnits[0],1/k.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:M,u_trim_fade_range:s.paint.get("line-trim-fade-range"),u_trim_color:s.paint.get("line-trim-color").toRenderColor(E?null:s.lut).toArray01(),u_emissive_strength:s.paint.get("line-emissive-strength"),u_zbias_factor:j,u_tile_to_meter:r(n.tileID.canonical,0)}},i.c0=JR,i.c1=function(u){const n=JR(u,!0);return Ne.mat2.invert([],[n[0],n[1],n[4],n[5]])},i.c2=nr,i.c3=function(u){const{x:n,y:s}=u.point,{lng:h,lat:y}=u._center;return Go(n,s,u.worldSize,h,y)},i.c4=vn,i.c5=fn,i.c6=Ys,i.c7=function(u){const n=Math.round((u+45+360)%360/90)%4;return wa[n]},i.c8=45,i.c9=xd,i.cA=class extends pl{constructor(u){super(u),this.current=Ip}set(u,n,s){if(this.fetchUniformLocation(u,n)){for(let h=0;h<9;h++)if(s[h]!==this.current[h]){this.current=s,this.gl.uniformMatrix3fv(this.location,!1,s);break}}}},i.cB=La,i.cC=function(u,n,s){const h=xo(s.zoom),y=u.style.map._antialias,d=u.terrain&&u.terrain.exaggeration()>0;return h===0&&!y&&!d},i.cD=function(u){const n=u.pixelsPerMeter,s=n/vo(1,u.center.lat),h=Ne.mat4.identity(new Float64Array(16));return Ne.mat4.translate(h,h,[u.point.x,u.point.y,0]),Ne.mat4.scale(h,h,[s,s,n]),Float32Array.from(h)},i.cE=zr,i.cF=function(u){const n=hi-5;u=Mn(u,-80.051129,n)/n*90;const s=Math.pow(Math.abs(Math.sin(hr(u))),3);return Math.round(s*(gf.length-1))},i.cG=function(u,n,s,h){const y=n.getNorth(),d=n.getSouth(),v=n.getWest(),M=n.getEast(),k=1<<u.z,j=M-v,E=y-d,D=j/Oc,B=-E/gf[s],R=[0,D,0,B,0,0,y,v,0];if(u.z>0){const z=180/h;Ne.mat3.multiply(R,R,[z/j+1,0,0,0,z/E+1,0,-.5*z/D,.5*z/B,1])}return R[2]=k,R[5]=u.x,R[8]=u.y,R},i.cH=ki,i.cI=function(u,n,s){const h=Ne.mat4.identity(new Float64Array(16)),y=(n/(1<<u)-.5)*Math.PI*2;return Ne.mat4.rotateY(h,s.globeMatrix,y),Float32Array.from(h)},i.cJ=class{isDataAvailableAtPoint(u){const n=this._source();if(this.isUsingMockSource()||!n||u.y<0||u.y>1)return!1;const s=n.getSource().maxzoom,h=1<<s,y=Math.floor(u.x),d=Math.floor((u.x-y)*h),v=Math.floor(u.y*h),M=this.findDEMTileFor(new tn(s,y,s,d,v));return!(!M||!M.dem)}getAtPointOrZero(u,n=0){return this.getAtPoint(u,n)||0}getAtPoint(u,n,s=!0){if(this.isUsingMockSource())return null;n==null&&(n=null);const h=this._source();if(!h||u.y<0||u.y>1)return n;const y=h.getSource().maxzoom,d=1<<y,v=Math.floor(u.x),M=u.x-v,k=new tn(y,v,y,Math.floor(M*d),Math.floor(u.y*d)),j=this.findDEMTileFor(k);if(!j||!j.dem)return n;const E=j.dem,D=1<<j.tileID.canonical.z,B=(M*D-j.tileID.canonical.x)*E.dim,R=(u.y*D-j.tileID.canonical.y)*E.dim,z=Math.floor(B),q=Math.floor(R);return(s?this.exaggeration():1)*Nn(Nn(E.get(z,q),E.get(z,q+1),R-q),Nn(E.get(z+1,q),E.get(z+1,q+1),R-q),B-z)}getAtTileOffset(u,n,s){const h=1<<u.canonical.z;return this.getAtPointOrZero(new l(u.wrap+(u.canonical.x+n/pn)/h,(u.canonical.y+s/pn)/h))}getAtTileOffsetFunc(u,n,s,h){return y=>{const d=this.getAtTileOffset(u,y.x,y.y),v=h.upVector(u.canonical,y.x,y.y),M=h.upVectorScale(u.canonical,n,s).metersToTile;return Ne.vec3.scale(v,v,d*M),v}}getForTilePoints(u,n,s,h){if(this.isUsingMockSource())return!1;const y=Ay.create(this,u,h);return!!y&&(n.forEach(d=>{d[2]=this.exaggeration()*y.getElevationAt(d[0],d[1],s)}),!0)}getMinMaxForTile(u){if(this.isUsingMockSource())return null;const n=this.findDEMTileFor(u);if(!n||!n.dem)return null;const s=n.dem.tree,h=n.tileID,y=1<<u.canonical.z-h.canonical.z;let d=u.canonical.x/y-h.canonical.x,v=u.canonical.y/y-h.canonical.y,M=0;for(let k=0;k<u.canonical.z-h.canonical.z&&!s.leaves[M];k++){d*=2,v*=2;const j=2*Math.floor(v)+Math.floor(d);M=s.childOffsets[M]+j,d%=1,v%=1}return{min:this.exaggeration()*s.minimums[M],max:this.exaggeration()*s.maximums[M]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(u,n,s){throw new Error("Pure virtual method called.")}pointCoordinate(u){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(u){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const u=this.visibleDemTiles;if(u.length===0)return null;let n=!1,s=Number.MAX_VALUE,h=Number.MIN_VALUE;for(const y of u){const d=this.getMinMaxForTile(y.tileID);d&&(s=Math.min(s,d.min),h=Math.max(h,d.max),n=!0)}return n?{min:s,max:h}:null}},i.cK=Y_,i.cL=Kn,i.cM=function(u,n){return[Math.pow(u[0],2.2)*n,Math.pow(u[1],2.2)*n,Math.pow(u[2],2.2)*n]},i.cN=As,i.cO=Ml,i.cP=Jl,i.cQ=256,i.cR=function(u,n){const s=[0,0,0],h=aa(ki(n.canonical));return Ne.vec3.transformMat4(s,s,h),Ne.vec3.transformMat4(s,s,u),s},i.cS=u=>({u_camera_to_center_distance:new na(u),u_extrude_scale:new Vu(u),u_device_pixel_ratio:new na(u),u_matrix:new vd(u),u_inv_rot_matrix:new vd(u),u_merc_center:new Hs(u),u_tile_id:new Mc(u),u_zoom_transition:new na(u),u_up_dir:new Mc(u),u_emissive_strength:new na(u)}),i.cT=u=>({u_matrix:new vd(u),u_pixels_to_tile_units:new Vu(u),u_device_pixel_ratio:new na(u),u_width_scale:new na(u),u_floor_width_scale:new na(u),u_units_to_pixels:new Hs(u),u_dash_image:new ph(u),u_gradient_image:new ph(u),u_image_height:new na(u),u_texsize:new Hs(u),u_tile_units_to_pixels:new na(u),u_alpha_discard_threshold:new na(u),u_trim_offset:new Hs(u),u_trim_fade_range:new Hs(u),u_trim_color:new pf(u),u_emissive_strength:new na(u),u_zbias_factor:new na(u),u_tile_to_meter:new na(u)}),i.cU=u=>({u_matrix:new vd(u),u_texsize:new Hs(u),u_pixels_to_tile_units:new Vu(u),u_device_pixel_ratio:new na(u),u_width_scale:new na(u),u_floor_width_scale:new na(u),u_image:new ph(u),u_units_to_pixels:new Hs(u),u_tile_units_to_pixels:new na(u),u_alpha_discard_threshold:new na(u),u_trim_offset:new Hs(u),u_trim_fade_range:new Hs(u),u_trim_color:new pf(u),u_emissive_strength:new na(u),u_zbias_factor:new na(u),u_tile_to_meter:new na(u)}),i.cV=dd,i.cW=$2,i.cX=H2,i.cY=Cc,i.cZ=(u,n,s,h,y,d)=>{const v=u.transform,M=v.projection.name==="globe";let k;if(d.paint.get("circle-pitch-alignment")==="map")if(M){const E=As(v.zoom,n.canonical)*v._pixelsPerMercatorPixel;k=Float32Array.from([E,0,0,E])}else k=v.calculatePixelsToTileUnitsMatrix(s);else k=new Float32Array([v.pixelsToGLUnits[0],0,0,v.pixelsToGLUnits[1]]);const j={u_camera_to_center_distance:u.transform.getCameraToCenterDistance(v.projection),u_matrix:u.translatePosMatrix(n.projMatrix,s,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Fe.devicePixelRatio,u_extrude_scale:k,u_inv_rot_matrix:$u,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:d.paint.get("circle-emissive-strength")};if(M){j.u_inv_rot_matrix=h,j.u_merc_center=y,j.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],j.u_zoom_transition=xo(v.zoom);const E=y[0]*pn,D=y[1]*pn;j.u_up_dir=v.projection.upVector(new Yt(0,0,0),E,D)}return j},i.c_=Hm,i.ca=pf,i.cb=function(u,n,s){const h=Math.sqrt(u*u+n*n+s*s),y=h>0?Math.acos(s/h)*Qi:0;let d=u!==0||n!==0?Math.atan2(-n,-u)*Qi+90:0;return d<0&&(d+=360),[h,d,y]},i.cc=r,i.cd=Sn,i.ce=$i,i.cf=function(u){return[Math.pow(u[0],1/2.2),Math.pow(u[1],1/2.2),Math.pow(u[2],1/2.2)]},i.cg=function(u,n){return u.readFields(m9,{icons:[]},n)},i.ch=function(u){return u({pluginStatus:Qo,pluginURL:Fu}),gc.on("pluginStateChange",u),u},i.ci=P1,i.cj=wy,i.ck=Y2,i.cl=Ao,i.cm=_m,i.cn=nt,i.co=Wo,i.cp=Sa,i.cq=function(u){const n=u.indexOf(ud);return n>=0?u.slice(0,n):u},i.cr=function(u){return u.indexOf(ud)>=0},i.cs=function(u){const n=u.indexOf(ud);return n>=0?u.slice(n+1):""},i.ct=function(u){const n=[],s=u.id;return s===void 0&&n.push({message:`layers.${s}: missing required property "id"`}),u.render===void 0&&n.push({message:`layers.${s}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&n.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),n},i.cu=function(u,n,s,h){return u.type==="custom"?new t9(u,n):new f9[u.type](u,n,s,h)},i.cv=Er,i.cw=class extends ky{constructor(u,n){super(u._vectorTileFeature,u._z,u._x,u._y,u.id),u.state&&(this.state=Object.assign({},u.state)),this.target=n.target,this.namespace=n.namespace,n.properties&&(this.properties=n.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=u.source,this.sourceLayer=u.sourceLayer,this.layer=u.layer)}toJSON(){const u=super.toJSON();return u.target=this.target,u.namespace=this.namespace,u}},i.cx=gc,i.cy=ta,i.cz=mu,i.d=function(u){return Mi.API_TILEJSON_REGEX.test(u)},i.d$=rk,i.d0=(u,n,s,h,y,d,v,M,k)=>{const j=u.transform,E=j.calculatePixelsToTileUnitsMatrix(n),D=s.paint.get("line-trim-color-use-theme").constantOr("default")==="none",B=j.pitch<15?mv(.07,.7,Mn((14-j.zoom)/5,0,1)):.07;return{u_matrix:gv(u,n,s,h),u_pixels_to_tile_units:E,u_device_pixel_ratio:d,u_width_scale:v,u_floor_width_scale:M,u_units_to_pixels:[1/j.pixelsToGLUnits[0],1/j.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:y,u_texsize:s1(s)&&n.lineAtlasTexture?n.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:my(n,u.transform),u_alpha_discard_threshold:0,u_trim_offset:k,u_trim_fade_range:s.paint.get("line-trim-fade-range"),u_trim_color:s.paint.get("line-trim-color").toRenderColor(D?null:s.lut).toArray01(),u_emissive_strength:s.paint.get("line-emissive-strength"),u_zbias_factor:B,u_tile_to_meter:r(n.tileID.canonical,0)}},i.d1=Rr,i.d2=Sd,i.d3=Pd,i.d4=wn,i.d5=fy,i.d6=Ro,i.d7=450,i.d8=7,i.d9=e9,i.dA=ks,i.dB=p,i.dC=Ic,i.dD=function([u,n,s]){const h=Math.hypot(u,n,s),y=Math.atan2(u,s),d=.5*Math.PI-Math.acos(-n/h);return new Gr(vn(y),vn(d))},i.dE=sS,i.dF=function(u){const n=u.navigator?u.navigator.userAgent:null;return!!function(s){if(Al==null){const h=s.navigator?s.navigator.userAgent:null;Al=!!s.safari||!(!h||!(/\b(iPad|iPhone|iPod)\b/.test(h)||h.match("Safari")&&!h.match("Chrome")))}return Al}(u)&&n&&(n.match("Version/15.4")||n.match("Version/15.5")||n.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},i.dG=function(u,n){rt=u,vt=n},i.dH=uo,i.dI=Ws,i.dJ=function(u){const n=[0,0,0],s=Ne.mat4.identity(new Float64Array(16));return Ne.mat4.multiply(s,u.pixelMatrix,u.globeMatrix),Ne.vec3.transformMat4(n,n,s),new $t(n[0],n[1])},i.dK=function(u,n,s=!1){if(Qo===id||Qo===ma||Qo===ad)throw new Error("setRTLTextPlugin cannot be called multiple times.");Fu=Fe.resolveURL(u),Qo=id,ul=n,od(),s||yo()},i.dL=rf,i.dM=function(){P1().acquire(dS)},i.dN=function(){const u=Dv;u&&(u.isPreloaded()&&u.numActive()===1?(u.release(dS),Dv=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},i.dO=Qm,i.dP=function(u){const n=un();if(!n)return;const s=n.delete(ct);u&&s.catch(u).then(()=>u())},i.dQ=kv,i.dR=H3,i.dS=function(u){TS=Fe.resolveURL(u),Ry||(Ry=new My(P1(),new Ol)),Ry.broadcast("setDracoUrl",TS)},i.dT=X3,i.dU=function(u){Py=Fe.resolveURL(u),Ry||(Ry=new My(P1(),new Ol)),Ry.broadcast("setMeshoptUrl",Py)},i.dV=In,i.dW=_h,i.dX=bh,i.dY=Od,i.dZ=class{constructor(u,n){this.pos=u,this.dir=n}intersectsPlane(u,n,s){const h=Ne.vec2.dot(n,this.dir);if(Math.abs(h)<1e-6)return!1;const y=((u[0]-this.pos[0])*n[0]+(u[1]-this.pos[1])*n[1])/h;return s[0]=this.pos[0]+this.dir[0]*y,s[1]=this.pos[1]+this.dir[1]*y,!0}},i.d_=nk,i.da=Yr,i.db=Tp,i.dc=256,i.dd=ii,i.de=du,i.df=es,i.dg=pu,i.dh=function(u,n,s,h,y){return Mn((u-n)/(s-n)*(y-h)+h,h,y)},i.di=fc,i.dj=yh,i.dk=class{constructor(u,n,s,h){this.context=u,this.format=h,this.size=s,this.texture=u.gl.createTexture();const[y,d,v]=this.size,{gl:M}=u;M.bindTexture(M.TEXTURE_3D,this.texture),u.pixelStoreUnpackFlipY.set(!1),u.pixelStoreUnpack.set(1),u.pixelStoreUnpackPremultiplyAlpha.set(!1),M.texImage3D(M.TEXTURE_3D,0,this.format,y,d,v,0,rS(this.format),iS(this.format),n.data)}bind(u,n){const{context:s}=this,{gl:h}=s;h.bindTexture(h.TEXTURE_3D,this.texture),u!==this.minFilter&&(h.texParameteri(h.TEXTURE_3D,h.TEXTURE_MAG_FILTER,u),h.texParameteri(h.TEXTURE_3D,h.TEXTURE_MIN_FILTER,u),this.minFilter=u),n!==this.wrapS&&(h.texParameteri(h.TEXTURE_3D,h.TEXTURE_WRAP_S,n),h.texParameteri(h.TEXTURE_3D,h.TEXTURE_WRAP_T,n),this.wrapS=n)}destroy(){const{gl:u}=this.context;u.deleteTexture(this.texture),this.texture=null}},i.dl=lS,i.dm=[1,1,1],i.dn=Ay,i.dp=Ey,i.dq=Tc,i.dr=ch,i.ds=Ul,i.dt=cf,i.du=dl,i.dv=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new $t(1/0,1/0),max:new $t(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(u,n=!1){const s=cy(new $t(0,0),new $t(pn,pn),u),h=[];if(n&&!uy(s,this._globalClipBounds))return h;for(const y of this._activeRegions){if(y.hiddenByOverlap||!uy(s,y))continue;const d=D2(y.min,y.max,u);h.push({min:d.min,max:d.max,sourceId:this._sourceIds[y.priority],footprint:y.footprint,footprintTileId:y.tileId,order:y.order,clipMask:y.clipMask,clipScope:y.clipScope})}return h}setSources(u){this._setSources(u.map(n=>({getSourceId:()=>n.cache.id,getFootprints:()=>{const s=[];for(const h of n.cache.getVisibleCoordinates()){const y=n.cache.getTile(h).buckets[n.layer];y&&y.updateFootprints(h.toUnwrapped(),s)}return s},getOrder:()=>n.order,getClipMask:()=>n.clipMask,getClipScope:()=>n.clipScope})))}_addSource(u){const n=u.getFootprints();if(n.length===0)return;const s=u.getOrder(),h=u.getClipMask(),y=u.getClipScope();for(const d of n){if(!d.footprint)continue;const v=cy(d.footprint.min,d.footprint.max,d.id);this._activeRegions.push({min:v.min,max:v.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:d.id,footprint:d.footprint,order:s,clipMask:h,clipScope:y})}this._sourceIds.push(u.getSourceId())}_computeReplacement(){this._activeRegions.sort((n,s)=>n.priority-s.priority||Id(n.min,s.min)||Id(n.max,s.max)||n.order-s.order||n.clipMask-s.clipMask||function(h,y){const d=(v,M)=>v+M;return h.length-y.length||h.reduce(d,"").localeCompare(y.reduce(d,""))}(n.clipScope,s.clipScope));let u=this._activeRegions.length!==this._prevRegions.length;if(!u){let n=0;for(;!u&&n!==this._activeRegions.length;){const s=this._activeRegions[n],h=this._prevRegions[n];u=s.priority!==h.priority||!tv(s,h)||s.order!==h.order||s.clipMask!==h.clipMask||!Ur(s.clipScope,h.clipScope),++n}}if(u){++this._updateTime;for(const s of this._activeRegions)s.order!==Np&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,s.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,s.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,s.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,s.max.y));const n=s=>{const h=this._activeRegions;if(s>=h.length)return s;const y=h[s].priority;for(;s<h.length&&h[s].priority===y;)++s;return s};if(this._sourceIds.length>1){let s=0,h=n(s);for(;s!==h;){let y=s;const d=s;for(;y!==h;){const v=this._activeRegions[y];v.hiddenByOverlap=!1;for(let M=0;M<d;M++){const k=this._activeRegions[M];if(!k.hiddenByOverlap&&v.order===Np&&uy(v,k)&&(v.hiddenByOverlap=Wx(v.footprint,v.tileId,k.footprint,k.tileId),v.hiddenByOverlap))break}++y}s=h,h=n(s)}}}}_setSources(u){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let n=u.length-1;n>=0;n--)this._addSource(u[n]);this._computeReplacement()}},i.dw=class{constructor(u){this._createGrid(u),this._createPoles(u)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const u of this._poleSegments)u.destroy();for(const u of this._gridSegments)u.withSkirts.destroy(),u.withoutSkirts.destroy()}_fillGridMeshWithLods(u,n){const s=new fu,h=new Ja,y=[],d=u+1+2,v=n[0]+1,M=n[0]+1+(1+n.length),k=(j,E,D)=>{let B=j===d-1?j-2:j===0?j:j-1;return B+=D?24575:0,[B,E]};for(let j=0;j<d;++j)s.emplaceBack(...k(j,0,!0));for(let j=0;j<v;++j)for(let E=0;E<d;++E)s.emplaceBack(...k(E,j,(E===0||E===d-1)&&!0));for(let j=0;j<n.length;++j){const E=n[j];for(let D=0;D<d;++D)s.emplaceBack(...k(D,E,!0))}for(let j=0;j<n.length;++j){const E=h.length,D=n[j]+1+2,B=new Ja;for(let q=0;q<D-1;q++){const W=q===D-2,K=W?d*(M-n.length+j-q):d;for(let oe=0;oe<d-1;oe++){const se=q*d+oe;q===0||W||oe===0||oe===d-2?(B.emplaceBack(se+1,se,se+K),B.emplaceBack(se+K,se+K+1,se+1)):(h.emplaceBack(se+1,se,se+K),h.emplaceBack(se+K,se+K+1,se+1))}}const R=Yi.simpleSegment(0,E,s.length,h.length-E);for(let q=0;q<B.uint16.length;q+=3)h.emplaceBack(B.uint16[q],B.uint16[q+1],B.uint16[q+2]);const z=Yi.simpleSegment(0,E,s.length,h.length-E);y.push({withoutSkirts:R,withSkirts:z})}return{vertices:s,indices:h,segments:y}}_createGrid(u){const n=this._fillGridMeshWithLods(Oc,gf);this._gridSegments=n.segments,this._gridBuffer=u.createVertexBuffer(n.vertices,Un.members),this._gridIndexBuffer=u.createIndexBuffer(n.indices,!0)}_createPoles(u){const n=new Ja;for(let v=0;v<=Oc;v++)n.emplaceBack(0,v+1,v+2);this._poleIndexBuffer=u.createIndexBuffer(n,!0);const s=new es,h=new es,y=new es,d=new es;this._poleSegments=[];for(let v=0,M=0;v<Ys;v++){const k=360/(1<<v);s.emplaceBack(0,-_o,0,.5,0),h.emplaceBack(0,-_o,0,.5,1),y.emplaceBack(0,-_o,0,.5,.5),d.emplaceBack(0,-_o,0,.5,.5);for(let j=0;j<=Oc;j++){let E=j/Oc,D=0;const B=Nn(0,k,E),[R,z,q]=mh(Ks,Ms,B,_o);s.emplaceBack(R,z,q,E,D),h.emplaceBack(R,z,q,E,1-D);const W=hr(B);E=.5+.5*Math.sin(W),D=.5+.5*Math.cos(W),y.emplaceBack(R,z,q,E,D),d.emplaceBack(R,z,q,E,1-D)}this._poleSegments.push(Yi.simpleSegment(M,0,66,64)),M+=66}this._poleNorthVertexBuffer=u.createVertexBuffer(s,Yn,!1),this._poleSouthVertexBuffer=u.createVertexBuffer(h,Yn,!1),this._texturedPoleNorthVertexBuffer=u.createVertexBuffer(y,Yn,!1),this._texturedPoleSouthVertexBuffer=u.createVertexBuffer(d,Yn,!1)}getGridBuffers(u,n){return[this._gridBuffer,this._gridIndexBuffer,n?this._gridSegments[u].withSkirts:this._gridSegments[u].withoutSkirts]}getPoleBuffers(u,n){return[n?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,n?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[u]]}},i.dx=Np,i.dy=ya,i.dz=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},i.e=Mi,i.e0=$m,i.e1=$a,i.e2=da,i.e3=xR,i.e4=function(u,n,s,h,y,d,v,M,k,j,E=1,D,B){u.createArrays(),u.tilePixelRatio=pn/(512*u.overscaling),u.compareText={},u.iconsNeedLinear=!1;const R=u.layers[0].layout,z=u.layers[0]._unevaluatedLayout._values,q={};q.scaleFactor=E,q.textSizeScaleRange=R.get("text-size-scale-range"),q.iconSizeScaleRange=R.get("icon-size-scale-range");const[W,K]=q.textSizeScaleRange,[oe,se]=q.iconSizeScaleRange;if(q.textScaleFactor=Mn(q.scaleFactor,W,K),q.iconScaleFactor=Mn(q.scaleFactor,oe,se),u.textSizeData.kind==="composite"){const{minZoom:we,maxZoom:ke}=u.textSizeData;q.compositeTextSizes=[z["text-size"].possiblyEvaluate(new ci(we),M),z["text-size"].possiblyEvaluate(new ci(ke),M)]}if(u.iconSizeData.kind==="composite"){const{minZoom:we,maxZoom:ke}=u.iconSizeData;q.compositeIconSizes=[z["icon-size"].possiblyEvaluate(new ci(we),M),z["icon-size"].possiblyEvaluate(new ci(ke),M)]}q.layoutTextSize=z["text-size"].possiblyEvaluate(new ci(k+1),M),q.layoutIconSize=z["icon-size"].possiblyEvaluate(new ci(k+1),M),q.textMaxSize=z["text-size"].possiblyEvaluate(new ci(18),M);const ne=R.get("text-rotation-alignment")==="map"&&R.get("symbol-placement")!=="point",ce=R.get("text-size");let pe=!1;for(const we of u.features)if(we.icon&&we.icon.nameSecondary){pe=!0;break}for(const we of u.features){const ke=R.get("text-font").evaluate(we,{},M).join(","),Re=ce.evaluate(we,{},M)*q.textScaleFactor,Pe=q.layoutTextSize.evaluate(we,{},M)*q.textScaleFactor,We=(q.layoutIconSize.evaluate(we,{},M),{horizontal:{},vertical:void 0}),Le=we.text;let Je,it=[0,0];if(Le){const ut=Le.toString(),pt=R.get("text-letter-spacing").evaluate(we,{},M)*bo,lt=R.get("text-line-height").evaluate(we,{},M)*bo,Lt=Ka(ut)?pt:0,Wt=R.get("text-anchor").evaluate(we,{},M),Rt=R.get("text-variable-anchor");if(!Rt){const zn=R.get("text-radial-offset").evaluate(we,{},M);it=zn?AR(Wt,[zn*bo,Z2]):R.get("text-offset").evaluate(we,{},M).map(Tn=>Tn*bo)}let xn=ne?"center":R.get("text-justify").evaluate(we,{},M);const mn=R.get("symbol-placement")==="point",on=mn?R.get("text-max-width").evaluate(we,{},M)*bo:1/0,en=zn=>{u.allowVerticalPlacement&&Ni(ut)&&(We.vertical=yn(Le,n,s,y,ke,on,lt,Wt,zn,Lt,it,Ge.vertical,!0,Pe,Re))};if(!ne&&Rt){const zn=xn==="auto"?Rt.map(Pn=>W2(Pn)):[xn];let Tn=!1;for(let Pn=0;Pn<zn.length;Pn++){const ir=zn[Pn];if(!We.horizontal[ir])if(Tn)We.horizontal[ir]=We.horizontal[0];else{const gr=yn(Le,n,s,y,ke,on,lt,"center",ir,Lt,it,Ge.horizontal,!1,Pe,Re);gr&&(We.horizontal[ir]=gr,Tn=gr.positionedLines.length===1)}}en("left")}else{if(xn==="auto"&&(xn=W2(Wt)),mn||R.get("text-writing-mode").indexOf("horizontal")>=0||!Ni(ut)){const zn=yn(Le,n,s,y,ke,on,lt,Wt,xn,Lt,it,Ge.horizontal,!1,Pe,Re);zn&&(We.horizontal[xn]=zn)}en(mn?"left":xn)}}let tt=!1;if(we.icon&&we.icon.namePrimary){const ut=xv(u.iconSizeData,z["icon-size"],M,u.zoom,we)*q.iconScaleFactor*D,pt=we.icon.getPrimary().scaleSelf(ut).serialize(),lt=h[pt];lt&&(Je=On(y[pt],we.icon.nameSecondary?y[we.icon.getSecondary().scaleSelf(ut).serialize()]:void 0,R.get("icon-offset").evaluate(we,{},M),R.get("icon-anchor").evaluate(we,{},M)),tt=lt.sdf,u.sdfIcons===void 0?u.sdfIcons=lt.sdf:u.sdfIcons!==lt.sdf&&lr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(lt.pixelRatio!==u.pixelRatio||R.get("icon-rotate").constantOr(1)!==0)&&(u.iconsNeedLinear=!0))}const ot=OR(We.horizontal)||We.vertical;u.iconsInText||(u.iconsInText=!!ot&&ot.iconsInText),(ot||Je)&&U7(u,we,We,Je,h,q,Pe,0,it,tt,v,M,j,B,pe)}d&&u.generateCollisionDebugBuffers(k,u.collisionBoxArray,q.textScaleFactor)},i.e5=N1,i.e6=jr,i.e7=ev,i.e8=f,i.e9=P,i.ea=function(u){let n=0;if(new Uint32Array(u,0,1)[0]!==Z3){const s=new Uint32Array(u,0,7),[,,h,y,d,v]=s;n=s.byteLength+y+d+v+d,(h!==u.byteLength||n>=u.byteLength)&&lr("Invalid b3dm header information.")}return Q3(u,n)},i.eb=function(u,n){const s=tk(u);for(const h of s){for(const y of h.meshes)gG(y);h.lights&&(h.lightMeshIndex=h.meshes.length,h.meshes.push(yG(h.lights,n)))}return s},i.ec=C1,i.ed=m3,i.ee=Ii,i.ef=function(u){hn(),xt!=null&&xt.then(n=>{n.keys().then(s=>{for(let h=0;h<s.length-u;h++)n.delete(s[h])})})},i.f=function(u){return u.indexOf("mapbox:")===0},i.g=function(u,n){return ta(ar(u,{method:"GET"}),n)},i.h=tc,i.i=function(u){return Mi.API_STYLE_REGEX.test(u)&&!Tu(u)},i.j=function(u){return decodeURIComponent(atob(u).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join(""))},i.k=function(u){return btoa(encodeURIComponent(u).replace(/%([0-9A-F]{2})/g,(n,s)=>String.fromCharCode(+("0x"+s))))},i.l=ar,i.m=$n,i.n=function(u,n){return ta(ar(u,{type:"json"}),n)},i.o=us,i.p=function(u,n){return ta(ar(u,{method:"POST"}),n)},i.q=Fe,i.r=co,i.s=function(u){try{const n=self[u];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch{return!1}},i.t=Ie,i.u=function(){return function u(n){return n?(n^Math.random()*(16>>n/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,u)}()},i.v=function(u){return!!u&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(u)},i.w=lr,i.x=function(){return pS||(pS=new Qm),pS},i.y=il,i.z=Oo}),b(["./shared"],function(i){function P(wt){const de=wt?wt.url.toString():void 0;return de?performance.getEntriesByName(de):[]}function L(wt){if(typeof wt=="number"||typeof wt=="boolean"||typeof wt=="string"||wt==null)return JSON.stringify(wt);if(Array.isArray(wt)){let xe="[";for(const Ie of wt)xe+=`${L(Ie)},`;return`${xe}]`}let de="{";for(const xe of Object.keys(wt).sort())de+=`${xe}:${L(wt[xe])},`;return`${de}}`}function U(wt){let de="";for(const xe of i.bm)(wt.type!=="model"||xe!=="minzoom"&&xe!=="maxzoom")&&(de+=`/${L(wt[xe])}`);return de}class V{constructor(de){this.keyCache={},this._layers={},this._layerConfigs={},de&&this.replace(de)}replace(de,xe){this._layerConfigs={},this._layers={},this.update(de,[],xe)}update(de,xe,Ie){this._options=Ie;for(const Xe of de)this._layerConfigs[Xe.id]=Xe,(this._layers[Xe.id]=i.cu(Xe,this.scope,null,this._options)).compileFilter(Ie),this.keyCache[Xe.id]&&delete this.keyCache[Xe.id];for(const Xe of xe)delete this.keyCache[Xe],delete this._layerConfigs[Xe],delete this._layers[Xe];this.familiesBySource={};const Fe=function(Xe,nt){const ct={};for(let vt=0;vt<Xe.length;vt++){const gt=Xe[vt];let xt=nt&&nt[gt.id];!xt&&(xt=U(gt),gt.type==="line"&&gt.paint)&&function un(hn){return typeof hn=="string"&&hn==="line-progress"||(Array.isArray(hn)?hn.some(un):!(!hn||typeof hn!="object")&&Object.values(hn).some(un))}(gt.paint["line-width"])&&(xt+=`/${L(gt.paint["line-width"])}`),nt&&(nt[gt.id]=xt);let Ct=ct[xt];Ct||(Ct=ct[xt]=[]),Ct.push(gt)}const rt=[];for(const vt in ct)rt.push(ct[vt]);return rt}(i.bj(this._layerConfigs),this.keyCache);for(const Xe of Fe){const nt=Xe.map(Ct=>this._layers[Ct.id]),ct=nt[0];if(ct.visibility==="none")continue;const rt=ct.source||"";let vt=this.familiesBySource[rt];vt||(vt=this.familiesBySource[rt]={});const gt=ct.sourceLayer||"_geojsonTileLayer";let xt=vt[gt];xt||(xt=vt[gt]=[]),xt.push(nt)}}}const H=1*i.dX;class ee{constructor(de){const xe={},Ie=[];for(const ct in de){const rt=de[ct],vt=xe[ct]={};for(const gt in rt.glyphs){const xt=rt.glyphs[+gt];if(!xt||xt.bitmap.width===0||xt.bitmap.height===0)continue;const Ct=xt.metrics.localGlyph?H:1,un={x:0,y:0,w:xt.bitmap.width+2*Ct,h:xt.bitmap.height+2*Ct};Ie.push(un),vt[gt]=un}}const{w:Fe,h:Xe}=i.F(Ie),nt=new i.dW({width:Fe||1,height:Xe||1});for(const ct in de){const rt=de[ct];for(const vt in rt.glyphs){const gt=rt.glyphs[+vt];if(!gt||gt.bitmap.width===0||gt.bitmap.height===0)continue;const xt=xe[ct][vt],Ct=gt.metrics.localGlyph?H:1;i.dW.copy(gt.bitmap,nt,{x:0,y:0},{x:xt.x+Ct,y:xt.y+Ct},gt.bitmap)}}this.image=nt,this.positions=xe}}i.dV(ee,"GlyphAtlas");const ie="3d_elevation_id",le="hd_road_elevation";class ue{constructor(){this._valid=!1}reset(de){return this.feature=de,this._valid=!0,this._geometry=de.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(de,xe){return this._valid&&de(xe(this._geometry)),this}require(de,xe,Ie){return this.get(de,!0,xe,Ie)}optional(de,xe,Ie){return this.get(de,!1,xe,Ie)}success(){return this._valid}get(de,xe,Ie,Fe){const Xe=this.feature.properties.hasOwnProperty(de)?+this.feature.properties[de]:void 0;return this._valid&&Xe!==void 0?Ie(Fe?Fe(Xe):Xe):xe&&(this._valid=!1),this}}class ge{constructor(de,xe){this.featureFunc=de,this.vertexFunc=xe}parseFeature(de,xe,Ie){return this.featureFunc(de,xe,Ie)}parseVertex(de,xe,Ie){return this.vertexFunc(de,xe,Ie)}}const Se=new ge((wt,de,xe)=>wt.reset(de).require(ie,Ie=>{xe.id=Ie}).optional("fixed_height_relative",Ie=>{xe.constantHeight=Ie},Ee.decodeRelativeHeight).geometry(Ie=>{xe.bounds=Ie},Ee.computeBounds).success(),(wt,de,xe)=>wt.reset(de).require(ie,Ie=>{xe.id=Ie}).require("elevation_idx",Ie=>{xe.idx=Ie}).require("extent",Ie=>{xe.extent=Ie}).require("height_relative",Ie=>{xe.height=Ie},Ee.decodeRelativeHeight).geometry(Ie=>{xe.position=Ie},Ee.getPoint).success()),ve=new ge((wt,de,xe)=>wt.reset(de).require(ie,Ie=>{xe.id=Ie}).optional("fixed_height",Ie=>{xe.constantHeight=Ie},Ee.decodeMetricHeight).geometry(Ie=>{xe.bounds=Ie},Ee.computeBounds).success(),(wt,de,xe)=>wt.reset(de).require(ie,Ie=>{xe.id=Ie}).require("elevation_idx",Ie=>{xe.idx=Ie}).require("extent",Ie=>{xe.extent=Ie}).require("height",Ie=>{xe.height=Ie},Ee.decodeMetricHeight).geometry(Ie=>{xe.position=Ie},Ee.getPoint).success());class Ee{static computeBounds(de){const xe=new i.P(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),Ie=new i.P(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const Fe of de[0])xe.x>Fe.x&&(xe.x=Fe.x),xe.y>Fe.y&&(xe.y=Fe.y),Ie.x<Fe.x&&(Ie.x=Fe.x),Ie.y<Fe.y&&(Ie.y=Fe.y);return{min:xe,max:Ie}}static getPoint(de){return i.ab.vec2.fromValues(de[0][0].x,de[0][0].y)}static decodeRelativeHeight(de){return 1e-4*de*5}static decodeMetricHeight(de){return 1e-4*de}static parse(de){const xe=[],Ie=[],Fe=de.length,Xe=new ue;for(let ct=0;ct<Fe;ct++){const rt=de.feature(ct),vt=rt.properties.hasOwnProperty("version")?String(rt.properties.version):void 0,gt=(nt=vt)?nt==="1.0.1"?ve:void 0:Se;if(gt===void 0){i.w(`Unknown elevation feature version number ${vt||"(unknown)"}`);continue}const xt=rt.properties.hasOwnProperty("type")?rt.properties.type:void 0;if(xt){if(i.dY.VectorTileFeature.types[rt.type]==="Point"&&xt==="curve_point"){const Ct={};gt.parseVertex(Xe,rt,Ct)&&xe.push(Ct)}else if(i.dY.VectorTileFeature.types[rt.type]==="Polygon"&&xt==="curve_meta"){const Ct={};gt.parseFeature(Xe,rt,Ct)&&Ie.push(Ct)}}}var nt;return{vertices:xe,features:Ie}}}class me{constructor(de,xe,Ie,Fe,Xe,nt){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=de,this.heightRange={min:Ie,max:Ie},this.safeArea=xe,this.constantHeight=Ie,this.constantHeight==null&&(this.constantHeight!=null||Fe.length!==0)){this.vertices=Fe,this.edges=Xe,this.edges=this.edges.filter(ct=>ct.a<this.vertices.length&&ct.b<this.vertices.length&&!i.ab.vec2.exactEquals(this.vertices[ct.a].position,this.vertices[ct.b].position)),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const ct of this.vertices)this.vertexProps.push({dir:i.ab.vec2.fromValues(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,ct.height),this.heightRange.max=Math.max(this.heightRange.max,ct.height);for(const ct of this.edges){const rt=this.vertices[ct.a].position,vt=this.vertices[ct.b].position,gt=i.ab.vec2.subtract(i.ab.vec2.create(),vt,rt),xt=i.ab.vec2.length(gt),Ct=i.ab.vec2.scale(i.ab.vec2.create(),gt,1/xt);this.edgeProps.push({vec:gt,dir:Ct,len:xt});const un=this.vertexProps[ct.a].dir,hn=this.vertexProps[ct.b].dir;i.ab.vec2.add(un,un,Ct),i.ab.vec2.add(hn,hn,Ct)}for(const ct of this.vertexProps)ct.dir[0]===0&&ct.dir[1]===0||i.ab.vec2.normalize(ct.dir,ct.dir);this.tessellate(nt)}}pointElevation(de){if(this.constantHeight!=null)return this.constantHeight;const xe=this.getClosestEdge(de);if(xe==null)return 0;const[Ie,Fe]=xe;return(1-(Xe=Fe))*this.vertices[this.edges[Ie].a].height+Xe*this.vertices[this.edges[Ie].b].height;var Xe}getClosestEdge(de){if(this.edges.length===0)return;let xe=0,Ie=Number.POSITIVE_INFINITY,Fe=0;const Xe=i.ab.vec2.fromValues(de.x,de.y);for(let nt=0;nt<this.edges.length;nt++){const ct=this.edges[nt],rt=this.edgeProps[nt].dir,vt=new i.dZ(Xe,this.edgeProps[nt].dir),gt=this.vertices[ct.a].position,xt=this.vertices[ct.b].position,Ct=i.ab.vec2.create(),un=i.ab.vec2.create(),hn=vt.intersectsPlane(gt,this.vertexProps[ct.a].dir,Ct),Rn=vt.intersectsPlane(xt,this.vertexProps[ct.b].dir,un);if(!hn||!Rn)continue;const $n=i.ab.vec2.subtract(i.ab.vec2.create(),un,Ct),Xn=i.ab.vec2.subtract(i.ab.vec2.create(),Xe,Ct),Fn=i.ab.vec2.dot($n,$n),yr=Fn>0?i.ab.vec2.dot(Xn,$n)/Fn:0,Tr=i.aw(yr,0,1),or=Math.abs((yr-Tr)*this.edgeProps[nt].len),Or=i.ab.vec2.subtract(i.ab.vec2.create(),Xe,gt),Nr=or+Math.abs(i.ab.vec2.dot(Or,i.ab.vec2.fromValues(rt[1],-rt[0])));Nr<Ie&&(xe=nt,Ie=Nr,Fe=Tr)}return[xe,Fe]}tessellate(de){for(let xe=this.edges.length-1;xe>=0;--xe){const Ie=this.edges[xe].a,Fe=this.edges[xe].b,{position:Xe,height:nt,extent:ct}=this.vertices[Ie],{position:rt,height:vt,extent:gt}=this.vertices[Fe],xt=this.vertexProps[Ie].dir,Ct=this.vertexProps[Fe].dir,un=i.ab.vec3.fromValues(Xe[0]/de,Xe[1]/de,nt),hn=i.ab.vec3.fromValues(rt[0]/de,rt[1]/de,vt),Rn=i.ab.vec3.fromValues(xt[1],-xt[0],0);i.ab.vec3.scale(Rn,Rn,ct);const $n=i.ab.vec3.fromValues(Ct[1],-Ct[0],0);if(i.ab.vec3.scale($n,$n,gt),this.distSqLines(i.ab.vec3.fromValues(un[0]+.5*Rn[0],un[1]+.5*Rn[1],un[2]+.5*Rn[2]),i.ab.vec3.fromValues(hn[0]-.5*$n[0],hn[1]-.5*$n[1],hn[2]-.5*$n[2]),i.ab.vec3.fromValues(un[0]-.5*Rn[0],un[1]-.5*Rn[1],un[2]-.5*Rn[2]),i.ab.vec3.fromValues(hn[0]+.5*$n[0],hn[1]+.5*$n[1],hn[2]+.5*$n[2]))<=.05*.05)continue;const Xn=this.vertices.length,Fn=i.ab.vec2.add(i.ab.vec2.create(),Xe,rt);this.vertices.push({position:i.ab.vec2.scale(Fn,Fn,.5),height:.5*(nt+vt),extent:.5*(ct+gt)});const yr=i.ab.vec2.add(i.ab.vec2.create(),xt,Ct);this.vertexProps.push({dir:i.ab.vec2.normalize(yr,yr)}),this.edges.splice(xe,1),this.edgeProps.splice(xe,1),this.edges.push({a:Ie,b:Xn}),this.edges.push({a:Xn,b:Fe});const Tr=i.ab.vec2.subtract(i.ab.vec2.create(),this.vertices[Xn].position,Xe),or=i.ab.vec2.length(Tr),Or={vec:Tr,dir:i.ab.vec2.scale(i.ab.vec2.create(),Tr,1/or),len:or};this.edgeProps.push(Or),this.edgeProps.push(Or)}}distSqLines(de,xe,Ie,Fe){const Xe=i.ab.vec3.subtract(i.ab.vec3.create(),xe,de),nt=i.ab.vec3.subtract(i.ab.vec3.create(),Fe,Ie),ct=i.ab.vec3.subtract(i.ab.vec3.create(),de,Ie),rt=i.ab.vec3.dot(Xe,Xe),vt=i.ab.vec3.dot(Xe,nt),gt=i.ab.vec3.dot(Xe,ct),xt=i.ab.vec3.dot(nt,nt),Ct=i.ab.vec3.dot(nt,ct),un=rt*xt-vt*vt;if(un===0){const Fn=i.ab.vec3.dot(ct,nt)/i.ab.vec3.dot(nt,nt),yr=i.ab.vec3.lerp(i.ab.vec3.create(),Ie,Fe,Fn);return i.ab.vec3.squaredDistance(yr,de)}const hn=(vt*Ct-gt*xt)/un,Rn=(rt*Ct-vt*gt)/un,$n=i.ab.vec3.lerp(i.ab.vec3.create(),de,xe,hn),Xn=i.ab.vec3.lerp(i.ab.vec3.create(),Ie,Fe,Rn);return i.ab.vec3.squaredDistance($n,Xn)}}class Ae{static parseFrom(de,xe){const Ie=Ee.parse(de);if(!Ie)return[];let{vertices:Fe,features:Xe}=Ie;const nt=1/i.cc(xe);Xe.sort((gt,xt)=>gt.id-xt.id),Fe.sort((gt,xt)=>gt.id-xt.id||gt.idx-xt.idx),Fe=Fe.filter((gt,xt,Ct)=>xt===Ct.findIndex(un=>un.id===gt.id&&un.idx===gt.idx));const ct=new Array;let rt=0;const vt=Fe.length;for(const gt of Xe){if(gt.constantHeight){ct.push(new me(gt.id,gt.bounds,gt.constantHeight));continue}for(;rt!==vt&&Fe[rt].id<gt.id;)rt++;if(rt===vt||Fe[rt].id!==gt.id)continue;const xt=new Array,Ct=new Array,un=rt;for(;rt!==vt&&Fe[rt].id===gt.id;){const hn=Fe[rt];if(xt.push({position:hn.position,height:hn.height,extent:hn.extent}),rt!==un&&Fe[rt-1].idx===hn.idx-1){const Rn=rt-un;Ct.push({a:Rn-1,b:Rn})}rt++}ct.push(new me(gt.id,gt.bounds,void 0,xt,Ct,nt))}return ct}}i.dV(me,"ElevationFeature");class Oe{constructor(de){this.tileID=new i.aG(de.tileID.overscaledZ,de.tileID.wrap,de.tileID.canonical.z,de.tileID.canonical.x,de.tileID.canonical.y),this.tileZoom=de.tileZoom,this.uid=de.uid,this.zoom=de.zoom,this.lut=de.lut,this.canonical=de.tileID.canonical,this.pixelRatio=de.pixelRatio,this.tileSize=de.tileSize,this.source=de.source,this.scope=de.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=de.showCollisionBoxes,this.collectResourceTiming=!!de.request&&de.request.collectResourceTiming,this.promoteId=de.promoteId,this.isSymbolTile=de.isSymbolTile,this.tileTransform=i.aQ(de.tileID.canonical,de.projection),this.projection=de.projection,this.worldview=de.worldview,this.localizableLayerIds=de.localizableLayerIds,this.brightness=de.brightness,this.extraShadowCaster=!!de.extraShadowCaster,this.tessellationStep=de.tessellationStep,this.scaleFactor=de.scaleFactor}parse(de,xe,Ie,Fe,Xe){this.status="parsing",this.data=de,this.collisionBoxArray=new i.aW;const nt=new i.d_(Object.keys(de.layers).sort()),ct=new i.d$(this.tileID,this.promoteId);ct.bucketLayerIDs=[];const rt={},vt=new i.e0(256,256),gt={featureIndex:ct,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:vt,availableImages:Ie,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},xt=xe.familiesBySource[this.source];for(const Fn in xt){const yr=de.layers[Fn];if(!yr)continue;let Tr=!1,or=!1,Or=!1;for(const ta of xt[Fn])ta[0].type==="symbol"?Tr=!0:or=!0,ta[0].is3D()&&ta[0].type!=="model"&&(Or=!0);if(this.extraShadowCaster&&!Or||this.isSymbolTile===!0&&!Tr||this.isSymbolTile===!1&&!or)continue;yr.version===1&&i.w(`Vector tile source "${this.source}" layer "${Fn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Nr=nt.encode(Fn),Pi=[];let Ao=!1;for(let ta=0,Ri=0;ta<yr.length;ta++){const Vi=yr.feature(ta),Au=ct.getId(Vi,Fn);if(this.localizableLayerIds&&this.localizableLayerIds.has(Fn)){const rl=Vi.properties?Vi.properties.worldview:null;if(this.worldview&&typeof rl=="string")if(rl==="all")Vi.properties.$localized=!0;else{if(!rl.split(",").includes(this.worldview))continue;Vi.properties.$localized=!0,Vi.properties.worldview=this.worldview}}!Ao&&Vi.properties&&Vi.properties.hasOwnProperty(ie)&&(Ao=!0),Pi.push({feature:Vi,id:Au,index:Ri,sourceLayerIndex:Nr}),Ri++}Ao&&de.layers.hasOwnProperty(le)&&(gt.elevationFeatures=Ae.parseFrom(de.layers[le],this.canonical));for(const ta of xt[Fn]){const Ri=ta[0];(!this.extraShadowCaster||Ri.is3D()&&Ri.type!=="model")&&(this.isSymbolTile!==void 0&&Ri.type==="symbol"!==this.isSymbolTile||Ri.minzoom&&this.zoom<Math.floor(Ri.minzoom)||Ri.maxzoom&&this.zoom>=Ri.maxzoom||Ri.visibility!=="none"&&(Ye(ta,this.zoom,gt.brightness,Ie),(rt[Ri.id]=Ri.createBucket({index:ct.bucketLayerIDs.length,layers:ta,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Nr,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(Pi,gt,this.tileID.canonical,this.tileTransform),ct.bucketLayerIDs.push(ta.map(Vi=>i.aC(Vi.id,Vi.scope)))))}}let Ct,un,hn,Rn;vt.trim();const $n={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Xn=()=>{if(Ct)return this.status="done",Xe(Ct);if(this.extraShadowCaster)this.status="done",Xe(null,{buckets:i.bj(rt).filter(Fn=>!Fn.isEmpty()),featureIndex:ct,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:gt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(un&&hn&&Rn){const Fn=new ee(un),yr=new i.e3(hn,Rn,this.lut);for(const Tr in rt){const or=rt[Tr];or instanceof i.aX?(Ye(or.layers,this.zoom,gt.brightness,Ie),i.e4(or,un,Fn.positions,hn,yr.iconPositions,this.showCollisionBoxes,Ie,this.tileID.canonical,this.tileZoom,this.projection,this.scaleFactor,this.pixelRatio,this.brightness)):or.hasPattern&&(or instanceof i.b1||or instanceof i.b2||or instanceof i.d5)&&(Ye(or.layers,this.zoom,gt.brightness,Ie),or.addFeatures(gt,this.tileID.canonical,yr.patternPositions,Ie,this.tileTransform,this.brightness))}this.status="done",Xe(null,{buckets:i.bj(rt).filter(Tr=>!Tr.isEmpty()),featureIndex:ct,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Fn.image,lineAtlas:vt,imageAtlas:yr,brightness:gt.brightness})}};if(!this.extraShadowCaster){const Fn=i.e1(gt.glyphDependencies,or=>Object.keys(or).map(Number));Object.keys(Fn).length?Fe.send("getGlyphs",{uid:this.uid,stacks:Fn,scope:this.scope},(or,Or)=>{Ct||(Ct=or,un=Or,Xn())},void 0,!1,$n):un={};const yr=Object.keys(gt.iconDependencies);yr.length?Fe.send("getImages",{icons:yr,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(or,Or)=>{if(Ct)return;Ct=or;const Nr={};Object.values(Or).some(Pi=>Pi.usvg)?this.rasterize(Fe,Nr,Or,gt.iconDependencies,()=>{hn=Nr,Xn()}):(this.fillImageMap(Nr,gt.iconDependencies,Or),hn=Nr,Xn())},void 0,!1,$n):hn={};const Tr=Object.keys(gt.patternDependencies);Tr.length?Fe.send("getImages",{icons:Tr,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(or,Or)=>{if(!Ct){Ct=or;const Nr={};Object.values(Or).some(Pi=>Pi.usvg)?this.rasterize(Fe,Nr,Or,gt.patternDependencies,()=>{Rn=Nr,Xn()}):(this.fillImageMap(Nr,gt.patternDependencies,Or),Rn=Nr,Xn())}},void 0,!1,$n):Rn={}}Xn()}fillImageMap(de,xe,Ie){for(const Fe in Ie){const Xe=xe[Fe]||[];for(const nt of Xe)Ie[nt.id].usvg||(de[nt.serialize()]=Ie[nt.id])}}getImageTaskQueue(de,xe,Ie){const Fe={};for(const Xe in xe){const nt=Ie[Xe]||[];for(const ct of nt){const rt=ct.serialize();xe[ct.id].usvg?Fe[rt]||(Fe[rt]=ct):de[rt]=xe[ct.id]}}return Fe}rasterize(de,xe,Ie,Fe,Xe){const nt=this.getImageTaskQueue(xe,Ie,Fe);this.rasterizeTask=de.send("rasterizeImages",{scope:this.scope,imageTasks:nt},(ct,rt)=>{if(!ct)for(const vt in rt){const{id:gt}=i.e2.deserializeFromString(vt);xe[vt]=Object.assign({},Ie[gt],{data:rt[vt]})}Xe()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function Ye(wt,de,xe,Ie){const Fe=new i.a8(de,{brightness:xe});for(const Xe of wt)Xe.recalculate(Fe,Ie)}class He extends i.E{constructor(de,xe,Ie,Fe,Xe,nt){super(),this.actor=de,this.layerIndex=xe,this.availableImages=Ie,this.loadVectorData=Xe||i.aD,this.loading={},this.loaded={},this.deduped=new i.aB(de.scheduler),this.isSpriteLoaded=Fe,this.scheduler=de.scheduler,this.brightness=nt}loadTile(de,xe){const Ie=de.uid,Fe=de&&de.request,Xe=Fe&&Fe.collectResourceTiming,nt=this.loading[Ie]=new Oe(de);nt.abort=this.loadVectorData(de,(ct,rt)=>{const vt=!this.loading[Ie];if(delete this.loading[Ie],nt.cancelRasterize(),vt||ct||!rt)return nt.status="done",vt||(this.loaded[Ie]=nt),xe(ct);const gt=rt.rawData,xt={};rt.expires&&(xt.expires=rt.expires),rt.cacheControl&&(xt.cacheControl=rt.cacheControl),nt.vectorTile=rt.vectorTile||new i.dY.VectorTile(new i.bh(gt));const Ct=()=>{nt.parse(nt.vectorTile,this.layerIndex,this.availableImages,this.actor,(un,hn)=>{if(un||!hn)return xe(un);const Rn={};if(Xe){const $n=P(Fe);$n.length>0&&(Rn.resourceTiming=JSON.parse(JSON.stringify($n)))}xe(null,i.l({rawTileData:gt.slice(0)},hn,xt,Rn))})};this.isSpriteLoaded?Ct():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Ct,{type:"parseTile",isSymbolTile:de.isSymbolTile,zoom:de.tileZoom}):Ct()}),this.loaded=this.loaded||{},this.loaded[Ie]=nt})}reloadTile(de,xe){const Ie=this.loaded,Fe=de.uid;if(Ie&&Ie[Fe]){const Xe=Ie[Fe];Xe.scaleFactor=de.scaleFactor,Xe.showCollisionBoxes=de.showCollisionBoxes,Xe.projection=de.projection,Xe.brightness=de.brightness,Xe.tileTransform=i.aQ(de.tileID.canonical,de.projection),Xe.extraShadowCaster=de.extraShadowCaster,Xe.lut=de.lut;const nt=(ct,rt)=>{const vt=Xe.reloadCallback;vt&&(delete Xe.reloadCallback,Xe.parse(Xe.vectorTile,this.layerIndex,this.availableImages,this.actor,vt)),xe(ct,rt)};Xe.status==="parsing"?Xe.reloadCallback=nt:Xe.status==="done"&&(Xe.vectorTile?Xe.parse(Xe.vectorTile,this.layerIndex,this.availableImages,this.actor,nt):nt())}else xe(null,void 0)}abortTile(de,xe){const Ie=de.uid,Fe=this.loading[Ie];Fe&&(Fe.abort&&Fe.abort(),delete this.loading[Ie]),xe()}removeTile(de,xe){const Ie=this.loaded,Fe=de.uid;Ie&&Ie[Fe]&&delete Ie[Fe],xe()}}class st{loadTile(de,xe){const{uid:Ie,encoding:Fe,rawImageData:Xe,padding:nt}=de,ct=ImageBitmap&&Xe instanceof ImageBitmap?this.getImageData(Xe,nt):Xe;xe(null,new i.e5(Ie,ct,Fe,nt<1))}getImageData(de,xe){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(de.width,de.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=de.width,this.offscreenCanvas.height=de.height,this.offscreenCanvasContext.drawImage(de,0,0,de.width,de.height);const Ie=this.offscreenCanvasContext.getImageData(-xe,-xe,de.width+2*xe,de.height+2*xe);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Ie}}i.bg.setPbf(i.bh);class Ke{decodeRasterArray({task:de,buffer:xe},Ie){i.bg.performDecoding(xe,de).then(Fe=>{Ie(null,Fe)},Fe=>{Ie(Fe)})}}const Ot=i.dY.VectorTileFeature.prototype.toGeoJSON;class Bt{constructor(de){this._feature=de,this.extent=i.ag,this.type=de.type,this.properties=de.tags,"id"in de&&!isNaN(de.id)&&(this.id=parseInt(de.id,10))}loadGeometry(){if(this._feature.type===1){const de=[];for(const xe of this._feature.geometry)de.push([new i.P(xe[0],xe[1])]);return de}{const de=[];for(const xe of this._feature.geometry){const Ie=[];for(const Fe of xe)Ie.push(new i.P(Fe[0],Fe[1]));de.push(Ie)}return de}}toGeoJSON(de,xe,Ie){return Ot.call(this,de,xe,Ie)}}class Tt{constructor(de){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.ag,this.length=de.length,this._features=de}feature(de){return new Bt(this._features[de])}}const mt=64/4096,bt=128;class Ft{constructor(){this.features=new Map}clear(){this.features.clear()}load(de=[],xe){for(const Ie of de){const Fe=Ie.id;if(Fe==null)continue;let Xe=this.features.get(Fe);Xe&&this.updateCache(Xe,xe),Ie.geometry?(Xe=Vt(Ie),this.updateCache(Xe,xe),this.features.set(Fe,Xe)):this.features.delete(Fe),this.updateCache(Xe,xe)}}updateCache(de,xe){for(const{canonical:Ie,uid:Fe}of Object.values(xe)){const{z:Xe,x:nt,y:ct}=Ie;Zt(de,Math.pow(2,Xe),nt,ct)&&delete xe[Fe]}}getTile(de,xe,Ie){const Fe=Math.pow(2,de),Xe=[];for(const nt of this.features.values())Zt(nt,Fe,xe,Ie)&&Xe.push(qt(nt,Fe,xe,Ie));return{features:Xe}}getFeatures(){return[...this.features.values()]}}function Zt({minX:wt,minY:de,maxX:xe,maxY:Ie},Fe,Xe,nt){return wt<(Xe+1+mt)/Fe&&de<(nt+1+mt)/Fe&&xe>(Xe-mt)/Fe&&Ie>(nt-mt)/Fe}function Vt(wt){const{id:de,geometry:xe,properties:Ie}=wt;if(!xe)return;if(xe.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:Fe,coordinates:Xe}=xe,nt={id:de,type:1,geometry:[],tags:Ie,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},ct=nt.geometry;if(Fe==="Point")Ze(Xe,ct,nt);else if(Fe==="MultiPoint")for(const rt of Xe)Ze(rt,ct,nt);else if(Fe==="LineString")nt.type=2,Xt(Xe,ct,nt);else if(Fe==="MultiLineString")nt.type=2,an(Xe,ct,nt);else if(Fe==="Polygon")nt.type=3,an(Xe,ct,nt,!0);else{if(Fe!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");nt.type=3;for(const rt of Xe)an(rt,ct,nt,!0)}return nt}function Ze([wt,de],xe,Ie){const Fe=i.at(wt);let Xe=i.aA(de);Xe=Xe<0?0:Xe>1?1:Xe,xe.push(Fe,Xe),Ie.minX=Math.min(Ie.minX,Fe),Ie.minY=Math.min(Ie.minY,Xe),Ie.maxX=Math.max(Ie.maxX,Fe),Ie.maxY=Math.max(Ie.maxY,Xe)}function Xt(wt,de,xe,Ie=!1,Fe=!1){const Xe=[];for(const nt of wt)Ze(nt,Xe,xe);de.push(Xe),Ie&&function(nt,ct){let rt=0;for(let vt=0,gt=nt.length,xt=gt-2;vt<gt;xt=vt,vt+=2)rt+=(nt[vt]-nt[xt])*(nt[vt+1]+nt[xt+1]);if(rt>0===ct)for(let vt=0,gt=nt.length;vt<gt/2;vt+=2){const xt=nt[vt],Ct=nt[vt+1];nt[vt]=nt[gt-2-vt],nt[vt+1]=nt[gt-1-vt],nt[gt-2-vt]=xt,nt[gt-1-vt]=Ct}}(Xe,Fe)}function an(wt,de,xe,Ie=!1){for(let Fe=0;Fe<wt.length;Fe++)Xt(wt[Fe],de,xe,Ie,Fe===0)}function qt(wt,de,xe,Ie){const{id:Fe,type:Xe,geometry:nt,tags:ct}=wt,rt=[];if(Xe===1)(function(vt,gt,xt,Ct,un){for(let hn=0;hn<vt.length;hn+=2){const Rn=Math.round(i.ag*(vt[hn+0]*gt-xt)),$n=Math.round(i.ag*(vt[hn+1]*gt-Ct));un.push([Rn,$n])}})(nt,de,xe,Ie,rt);else for(const vt of nt)cn(vt,de,xe,Ie,rt);return{id:Fe,type:Xe,geometry:rt,tags:ct}}function cn(wt,de,xe,Ie,Fe){const nt=i.ag+bt;let ct;for(let rt=0;rt<wt.length-2;rt+=2){let vt=Math.round(i.ag*(wt[rt+0]*de-xe)),gt=Math.round(i.ag*(wt[rt+1]*de-Ie)),xt=Math.round(i.ag*(wt[rt+2]*de-xe)),Ct=Math.round(i.ag*(wt[rt+3]*de-Ie));const un=xt-vt,hn=Ct-gt;vt<-128&&xt<-128||(vt<-128?(gt+=Math.round(hn*((-128-vt)/un)),vt=-128):xt<-128&&(Ct=gt+Math.round(hn*((-128-vt)/un)),xt=-128),gt<-128&&Ct<-128||(gt<-128?(vt+=Math.round(un*((-128-gt)/hn)),gt=-128):Ct<-128&&(xt=vt+Math.round(un*((-128-gt)/hn)),Ct=-128),vt>=nt&&xt>=nt||(vt>=nt?(gt+=Math.round(hn*((nt-vt)/un)),vt=nt):xt>=nt&&(Ct=gt+Math.round(hn*((nt-vt)/un)),xt=nt),gt>=nt&&Ct>=nt||(gt>=nt?(vt+=Math.round(un*((nt-gt)/hn)),gt=nt):Ct>=nt&&(xt=vt+Math.round(un*((nt-gt)/hn)),Ct=nt),ct&&vt===ct[ct.length-1][0]&&gt===ct[ct.length-1][1]||(ct=[[vt,gt]],Fe.push(ct)),ct.push([xt,Ct])))))}}var rr,mr,Ci,Et={exports:{}},Ln=function(){if(Ci)return Et.exports;Ci=1;var wt=i.e8(),de=function(){if(mr)return rr;mr=1;var gt=i.e6(),xt=i.e7().VectorTileFeature;function Ct(hn,Rn){this.options=Rn||{},this.features=hn,this.length=hn.length}function un(hn,Rn){this.id=typeof hn.id=="number"?hn.id:void 0,this.type=hn.type,this.rawGeometry=hn.type===1?[hn.geometry]:hn.geometry,this.properties=hn.tags,this.extent=Rn||4096}return rr=Ct,Ct.prototype.feature=function(hn){return new un(this.features[hn],this.options.extent)},un.prototype.loadGeometry=function(){var hn=this.rawGeometry;this.geometry=[];for(var Rn=0;Rn<hn.length;Rn++){for(var $n=hn[Rn],Xn=[],Fn=0;Fn<$n.length;Fn++)Xn.push(new gt($n[Fn][0],$n[Fn][1]));this.geometry.push(Xn)}return this.geometry},un.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var hn=this.geometry,Rn=1/0,$n=-1/0,Xn=1/0,Fn=-1/0,yr=0;yr<hn.length;yr++)for(var Tr=hn[yr],or=0;or<Tr.length;or++){var Or=Tr[or];Rn=Math.min(Rn,Or.x),$n=Math.max($n,Or.x),Xn=Math.min(Xn,Or.y),Fn=Math.max(Fn,Or.y)}return[Rn,Xn,$n,Fn]},un.prototype.toGeoJSON=xt.prototype.toGeoJSON,rr}();function xe(gt){var xt=new wt;return function(Ct,un){for(var hn in Ct.layers)un.writeMessage(3,Ie,Ct.layers[hn])}(gt,xt),xt.finish()}function Ie(gt,xt){var Ct;xt.writeVarintField(15,gt.version||1),xt.writeStringField(1,gt.name||""),xt.writeVarintField(5,gt.extent||4096);var un={keys:[],values:[],keycache:{},valuecache:{}};for(Ct=0;Ct<gt.length;Ct++)un.feature=gt.feature(Ct),xt.writeMessage(2,Fe,un);var hn=un.keys;for(Ct=0;Ct<hn.length;Ct++)xt.writeStringField(3,hn[Ct]);var Rn=un.values;for(Ct=0;Ct<Rn.length;Ct++)xt.writeMessage(4,vt,Rn[Ct])}function Fe(gt,xt){var Ct=gt.feature;Ct.id!==void 0&&xt.writeVarintField(1,Ct.id),xt.writeMessage(2,Xe,gt),xt.writeVarintField(3,Ct.type),xt.writeMessage(4,rt,Ct)}function Xe(gt,xt){var Ct=gt.feature,un=gt.keys,hn=gt.values,Rn=gt.keycache,$n=gt.valuecache;for(var Xn in Ct.properties){var Fn=Ct.properties[Xn],yr=Rn[Xn];if(Fn!==null){yr===void 0&&(un.push(Xn),Rn[Xn]=yr=un.length-1),xt.writeVarint(yr);var Tr=typeof Fn;Tr!=="string"&&Tr!=="boolean"&&Tr!=="number"&&(Fn=JSON.stringify(Fn));var or=Tr+":"+Fn,Or=$n[or];Or===void 0&&(hn.push(Fn),$n[or]=Or=hn.length-1),xt.writeVarint(Or)}}}function nt(gt,xt){return(xt<<3)+(7&gt)}function ct(gt){return gt<<1^gt>>31}function rt(gt,xt){for(var Ct=gt.loadGeometry(),un=gt.type,hn=0,Rn=0,$n=Ct.length,Xn=0;Xn<$n;Xn++){var Fn=Ct[Xn],yr=1;un===1&&(yr=Fn.length),xt.writeVarint(nt(1,yr));for(var Tr=un===3?Fn.length-1:Fn.length,or=0;or<Tr;or++){or===1&&un!==1&&xt.writeVarint(nt(2,Tr-1));var Or=Fn[or].x-hn,Nr=Fn[or].y-Rn;xt.writeVarint(ct(Or)),xt.writeVarint(ct(Nr)),hn+=Or,Rn+=Nr}un===3&&xt.writeVarint(nt(7,1))}}function vt(gt,xt){var Ct=typeof gt;Ct==="string"?xt.writeStringField(1,gt):Ct==="boolean"?xt.writeBooleanField(7,gt):Ct==="number"&&(gt%1!=0?xt.writeDoubleField(3,gt):gt<0?xt.writeSVarintField(6,gt):xt.writeVarintField(5,gt))}return Et.exports=xe,Et.exports.fromVectorTileJs=xe,Et.exports.fromGeojsonVt=function(gt,xt){xt=xt||{};var Ct={};for(var un in gt)Ct[un]=new de(gt[un].features,xt),Ct[un].name=un,Ct[un].version=xt.version,Ct[un].extent=xt.extent;return xe({layers:Ct})},Et.exports.GeoJSONWrapper=de,Et.exports}(),Ne=i.e9(Ln);const An={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:wt=>wt},qe=Math.fround||(jr=new Float32Array(1),wt=>(jr[0]=+wt,jr[0]));var jr;const $t=3,Ur=5,Wr=6;class Qi{constructor(de){this.options=Object.assign(Object.create(An),de),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(de){const{log:xe,minZoom:Ie,maxZoom:Fe}=this.options;xe&&console.time("total time");const Xe=`prepare ${de.length} points`;xe&&console.time(Xe),this.points=de;const nt=[];for(let rt=0;rt<de.length;rt++){const vt=de[rt];if(!vt.geometry)continue;const[gt,xt]=vt.geometry.coordinates,Ct=qe(wa(gt)),un=qe(La(xt));nt.push(Ct,un,1/0,rt,-1,1),this.options.reduce&&nt.push(0)}let ct=this.trees[Fe+1]=this._createTree(nt);xe&&console.timeEnd(Xe);for(let rt=Fe;rt>=Ie;rt--){const vt=+Date.now();ct=this.trees[rt]=this._createTree(this._cluster(ct,rt)),xe&&console.log("z%d: %d clusters in %dms",rt,ct.numItems,+Date.now()-vt)}return xe&&console.timeEnd("total time"),this}getClusters(de,xe){let Ie=((de[0]+180)%360+360)%360-180;const Fe=Math.max(-90,Math.min(90,de[1]));let Xe=de[2]===180?180:((de[2]+180)%360+360)%360-180;const nt=Math.max(-90,Math.min(90,de[3]));if(de[2]-de[0]>=360)Ie=-180,Xe=180;else if(Ie>Xe){const xt=this.getClusters([Ie,Fe,180,nt],xe),Ct=this.getClusters([-180,Fe,Xe,nt],xe);return xt.concat(Ct)}const ct=this.trees[this._limitZoom(xe)],rt=ct.range(wa(Ie),La(nt),wa(Xe),La(Fe)),vt=ct.data,gt=[];for(const xt of rt){const Ct=this.stride*xt;gt.push(vt[Ct+Ur]>1?hr(vt,Ct,this.clusterProps):this.points[vt[Ct+$t]])}return gt}getChildren(de){const xe=this._getOriginId(de),Ie=this._getOriginZoom(de),Fe="No cluster with the specified id.",Xe=this.trees[Ie];if(!Xe)throw new Error(Fe);const nt=Xe.data;if(xe*this.stride>=nt.length)throw new Error(Fe);const ct=this.options.radius/(this.options.extent*Math.pow(2,Ie-1)),rt=Xe.within(nt[xe*this.stride],nt[xe*this.stride+1],ct),vt=[];for(const gt of rt){const xt=gt*this.stride;nt[xt+4]===de&&vt.push(nt[xt+Ur]>1?hr(nt,xt,this.clusterProps):this.points[nt[xt+$t]])}if(vt.length===0)throw new Error(Fe);return vt}getLeaves(de,xe,Ie){const Fe=[];return this._appendLeaves(Fe,de,xe=xe||10,Ie=Ie||0,0),Fe}getTile(de,xe,Ie){const Fe=this.trees[this._limitZoom(de)],Xe=Math.pow(2,de),{extent:nt,radius:ct}=this.options,rt=ct/nt,vt=(Ie-rt)/Xe,gt=(Ie+1+rt)/Xe,xt={features:[]};return this._addTileFeatures(Fe.range((xe-rt)/Xe,vt,(xe+1+rt)/Xe,gt),Fe.data,xe,Ie,Xe,xt),xe===0&&this._addTileFeatures(Fe.range(1-rt/Xe,vt,1,gt),Fe.data,Xe,Ie,Xe,xt),xe===Xe-1&&this._addTileFeatures(Fe.range(0,vt,rt/Xe,gt),Fe.data,-1,Ie,Xe,xt),xt.features.length?xt:null}getClusterExpansionZoom(de){let xe=this._getOriginZoom(de)-1;for(;xe<=this.options.maxZoom;){const Ie=this.getChildren(de);if(xe++,Ie.length!==1)break;de=Ie[0].properties.cluster_id}return xe}_appendLeaves(de,xe,Ie,Fe,Xe){const nt=this.getChildren(xe);for(const ct of nt){const rt=ct.properties;if(rt&&rt.cluster?Xe+rt.point_count<=Fe?Xe+=rt.point_count:Xe=this._appendLeaves(de,rt.cluster_id,Ie,Fe,Xe):Xe<Fe?Xe++:de.push(ct),de.length===Ie)break}return Xe}_createTree(de){const xe=new i.bE(de.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Ie=0;Ie<de.length;Ie+=this.stride)xe.add(de[Ie],de[Ie+1]);return xe.finish(),xe.data=de,xe}_addTileFeatures(de,xe,Ie,Fe,Xe,nt){for(const ct of de){const rt=ct*this.stride,vt=xe[rt+Ur]>1;let gt,xt,Ct;if(vt)gt=vn(xe,rt,this.clusterProps),xt=xe[rt],Ct=xe[rt+1];else{const Rn=this.points[xe[rt+$t]];gt=Rn.properties;const[$n,Xn]=Rn.geometry.coordinates;xt=wa($n),Ct=La(Xn)}const un={type:1,geometry:[[Math.round(this.options.extent*(xt*Xe-Ie)),Math.round(this.options.extent*(Ct*Xe-Fe))]],tags:gt};let hn;hn=vt||this.options.generateId?xe[rt+$t]:this.points[xe[rt+$t]].id,hn!==void 0&&(un.id=hn),nt.features.push(un)}}_limitZoom(de){return Math.max(this.options.minZoom,Math.min(Math.floor(+de),this.options.maxZoom+1))}_cluster(de,xe){const{radius:Ie,extent:Fe,reduce:Xe,minPoints:nt}=this.options,ct=Ie/(Fe*Math.pow(2,xe)),rt=de.data,vt=[],gt=this.stride;for(let xt=0;xt<rt.length;xt+=gt){if(rt[xt+2]<=xe)continue;rt[xt+2]=xe;const Ct=rt[xt],un=rt[xt+1],hn=de.within(rt[xt],rt[xt+1],ct),Rn=rt[xt+Ur];let $n=Rn;for(const Xn of hn){const Fn=Xn*gt;rt[Fn+2]>xe&&($n+=rt[Fn+Ur])}if($n>Rn&&$n>=nt){let Xn,Fn=Ct*Rn,yr=un*Rn,Tr=-1;const or=(xt/gt<<5)+(xe+1)+this.points.length;for(const Or of hn){const Nr=Or*gt;if(rt[Nr+2]<=xe)continue;rt[Nr+2]=xe;const Pi=rt[Nr+Ur];Fn+=rt[Nr]*Pi,yr+=rt[Nr+1]*Pi,rt[Nr+4]=or,Xe&&(Xn||(Xn=this._map(rt,xt,!0),Tr=this.clusterProps.length,this.clusterProps.push(Xn)),Xe(Xn,this._map(rt,Nr)))}rt[xt+4]=or,vt.push(Fn/$n,yr/$n,1/0,or,-1,$n),Xe&&vt.push(Tr)}else{for(let Xn=0;Xn<gt;Xn++)vt.push(rt[xt+Xn]);if($n>1)for(const Xn of hn){const Fn=Xn*gt;if(!(rt[Fn+2]<=xe)){rt[Fn+2]=xe;for(let yr=0;yr<gt;yr++)vt.push(rt[Fn+yr])}}}}return vt}_getOriginId(de){return de-this.points.length>>5}_getOriginZoom(de){return(de-this.points.length)%32}_map(de,xe,Ie){if(de[xe+Ur]>1){const nt=this.clusterProps[de[xe+Wr]];return Ie?Object.assign({},nt):nt}const Fe=this.points[de[xe+$t]].properties,Xe=this.options.map(Fe);return Ie&&Xe===Fe?Object.assign({},Xe):Xe}}function hr(wt,de,xe){return{type:"Feature",id:wt[de+$t],properties:vn(wt,de,xe),geometry:{type:"Point",coordinates:[(Ie=wt[de],360*(Ie-.5)),ya(wt[de+1])]}};var Ie}function vn(wt,de,xe){const Ie=wt[de+Ur],Fe=Ie>=1e4?`${Math.round(Ie/1e3)}k`:Ie>=1e3?Math.round(Ie/100)/10+"k":Ie,Xe=wt[de+Wr],nt=Xe===-1?{}:Object.assign({},xe[Xe]);return Object.assign(nt,{cluster:!0,cluster_id:wt[de+$t],point_count:Ie,point_count_abbreviated:Fe})}function wa(wt){return wt/360+.5}function La(wt){const de=Math.sin(wt*Math.PI/180),xe=.5-.25*Math.log((1+de)/(1-de))/Math.PI;return xe<0?0:xe>1?1:xe}function ya(wt){const de=(180-360*wt)*Math.PI/180;return 360*Math.atan(Math.exp(de))/Math.PI-90}function ks(wt,de,xe,Ie){let Fe=Ie;const Xe=de+(xe-de>>1);let nt,ct=xe-de;const rt=wt[de],vt=wt[de+1],gt=wt[xe],xt=wt[xe+1];for(let Ct=de+3;Ct<xe;Ct+=3){const un=Mn(wt[Ct],wt[Ct+1],rt,vt,gt,xt);if(un>Fe)nt=Ct,Fe=un;else if(un===Fe){const hn=Math.abs(Ct-Xe);hn<ct&&(nt=Ct,ct=hn)}}Fe>Ie&&(nt-de>3&&ks(wt,de,nt,Ie),wt[nt+2]=Fe,xe-nt>3&&ks(wt,nt,xe,Ie))}function Mn(wt,de,xe,Ie,Fe,Xe){let nt=Fe-xe,ct=Xe-Ie;if(nt!==0||ct!==0){const rt=((wt-xe)*nt+(de-Ie)*ct)/(nt*nt+ct*ct);rt>1?(xe=Fe,Ie=Xe):rt>0&&(xe+=nt*rt,Ie+=ct*rt)}return nt=wt-xe,ct=de-Ie,nt*nt+ct*ct}function no(wt,de,xe,Ie){const Fe={id:wt??null,type:de,geometry:xe,tags:Ie,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(de==="Point"||de==="MultiPoint"||de==="LineString")To(Fe,xe);else if(de==="Polygon")To(Fe,xe[0]);else if(de==="MultiLineString")for(const Xe of xe)To(Fe,Xe);else if(de==="MultiPolygon")for(const Xe of xe)To(Fe,Xe[0]);return Fe}function To(wt,de){for(let xe=0;xe<de.length;xe+=3)wt.minX=Math.min(wt.minX,de[xe]),wt.minY=Math.min(wt.minY,de[xe+1]),wt.maxX=Math.max(wt.maxX,de[xe]),wt.maxY=Math.max(wt.maxY,de[xe+1])}function Ds(wt,de,xe,Ie){if(!de.geometry)return;const Fe=de.geometry.coordinates;if(Fe&&Fe.length===0)return;const Xe=de.geometry.type,nt=Math.pow(xe.tolerance/((1<<xe.maxZoom)*xe.extent),2);let ct=[],rt=de.id;if(xe.promoteId?rt=de.properties[xe.promoteId]:xe.generateId&&(rt=Ie||0),Xe==="Point")ar(Fe,ct);else if(Xe==="MultiPoint")for(const vt of Fe)ar(vt,ct);else if(Xe==="LineString")Ls(Fe,ct,nt,!1);else if(Xe==="MultiLineString"){if(xe.lineMetrics){for(const vt of Fe)ct=[],Ls(vt,ct,nt,!1),wt.push(no(rt,"LineString",ct,de.properties));return}Kr(Fe,ct,nt,!1)}else if(Xe==="Polygon")Kr(Fe,ct,nt,!0);else{if(Xe!=="MultiPolygon"){if(Xe==="GeometryCollection"){for(const vt of de.geometry.geometries)Ds(wt,{id:rt,geometry:vt,properties:de.properties},xe,Ie);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const vt of Fe){const gt=[];Kr(vt,gt,nt,!0),ct.push(gt)}}wt.push(no(rt,Xe,ct,de.properties))}function ar(wt,de){de.push(Rr(wt[0]),ec(wt[1]),0)}function Ls(wt,de,xe,Ie){let Fe,Xe,nt=0;for(let rt=0;rt<wt.length;rt++){const vt=Rr(wt[rt][0]),gt=ec(wt[rt][1]);de.push(vt,gt,0),rt>0&&(nt+=Ie?(Fe*gt-vt*Xe)/2:Math.sqrt(Math.pow(vt-Fe,2)+Math.pow(gt-Xe,2))),Fe=vt,Xe=gt}const ct=de.length-3;de[2]=1,ks(de,0,ct,xe),de[ct+2]=1,de.size=Math.abs(nt),de.start=0,de.end=de.size}function Kr(wt,de,xe,Ie){for(let Fe=0;Fe<wt.length;Fe++){const Xe=[];Ls(wt[Fe],Xe,xe,Ie),de.push(Xe)}}function Rr(wt){return wt/360+.5}function ec(wt){const de=Math.sin(wt*Math.PI/180),xe=.5-.25*Math.log((1+de)/(1-de))/Math.PI;return xe<0?0:xe>1?1:xe}function Ui(wt,de,xe,Ie,Fe,Xe,nt,ct){if(Ie/=de,Xe>=(xe/=de)&&nt<Ie)return wt;if(nt<xe||Xe>=Ie)return null;const rt=[];for(const vt of wt){const gt=vt.geometry;let xt=vt.type;const Ct=Fe===0?vt.minX:vt.minY,un=Fe===0?vt.maxX:vt.maxY;if(Ct>=xe&&un<Ie){rt.push(vt);continue}if(un<xe||Ct>=Ie)continue;let hn=[];if(xt==="Point"||xt==="MultiPoint")$a(gt,hn,xe,Ie,Fe);else if(xt==="LineString")Er(gt,hn,xe,Ie,Fe,!1,ct.lineMetrics);else if(xt==="MultiLineString")za(gt,hn,xe,Ie,Fe,!1);else if(xt==="Polygon")za(gt,hn,xe,Ie,Fe,!0);else if(xt==="MultiPolygon")for(const Rn of gt){const $n=[];za(Rn,$n,xe,Ie,Fe,!0),$n.length&&hn.push($n)}if(hn.length){if(ct.lineMetrics&&xt==="LineString"){for(const Rn of hn)rt.push(no(vt.id,xt,Rn,vt.tags));continue}xt!=="LineString"&&xt!=="MultiLineString"||(hn.length===1?(xt="LineString",hn=hn[0]):xt="MultiLineString"),xt!=="Point"&&xt!=="MultiPoint"||(xt=hn.length===3?"Point":"MultiPoint"),rt.push(no(vt.id,xt,hn,vt.tags))}}return rt.length?rt:null}function $a(wt,de,xe,Ie,Fe){for(let Xe=0;Xe<wt.length;Xe+=3){const nt=wt[Xe+Fe];nt>=xe&&nt<=Ie&&lr(de,wt[Xe],wt[Xe+1],wt[Xe+2])}}function Er(wt,de,xe,Ie,Fe,Xe,nt){let ct=Sa(wt);const rt=Fe===0?_a:Kl;let vt,gt,xt=wt.start;for(let $n=0;$n<wt.length-3;$n+=3){const Xn=wt[$n],Fn=wt[$n+1],yr=wt[$n+2],Tr=wt[$n+3],or=wt[$n+4],Or=Fe===0?Xn:Fn,Nr=Fe===0?Tr:or;let Pi=!1;nt&&(vt=Math.sqrt(Math.pow(Xn-Tr,2)+Math.pow(Fn-or,2))),Or<xe?Nr>xe&&(gt=rt(ct,Xn,Fn,Tr,or,xe),nt&&(ct.start=xt+vt*gt)):Or>Ie?Nr<Ie&&(gt=rt(ct,Xn,Fn,Tr,or,Ie),nt&&(ct.start=xt+vt*gt)):lr(ct,Xn,Fn,yr),Nr<xe&&Or>=xe&&(gt=rt(ct,Xn,Fn,Tr,or,xe),Pi=!0),Nr>Ie&&Or<=Ie&&(gt=rt(ct,Xn,Fn,Tr,or,Ie),Pi=!0),!Xe&&Pi&&(nt&&(ct.end=xt+vt*gt),de.push(ct),ct=Sa(wt)),nt&&(xt+=vt)}let Ct=wt.length-3;const un=wt[Ct],hn=wt[Ct+1],Rn=Fe===0?un:hn;Rn>=xe&&Rn<=Ie&&lr(ct,un,hn,wt[Ct+2]),Ct=ct.length-3,Xe&&Ct>=3&&(ct[Ct]!==ct[0]||ct[Ct+1]!==ct[1])&&lr(ct,ct[0],ct[1],ct[2]),ct.length&&de.push(ct)}function Sa(wt){const de=[];return de.size=wt.size,de.start=wt.start,de.end=wt.end,de}function za(wt,de,xe,Ie,Fe,Xe){for(const nt of wt)Er(nt,de,xe,Ie,Fe,Xe,!1)}function lr(wt,de,xe,Ie){wt.push(de,xe,Ie)}function _a(wt,de,xe,Ie,Fe,Xe){const nt=(Xe-de)/(Ie-de);return lr(wt,Xe,xe+(Fe-xe)*nt,1),nt}function Kl(wt,de,xe,Ie,Fe,Xe){const nt=(Xe-xe)/(Fe-xe);return lr(wt,de+(Ie-de)*nt,Xe,1),nt}function $i(wt,de){const xe=[];for(let Ie=0;Ie<wt.length;Ie++){const Fe=wt[Ie],Xe=Fe.type;let nt;if(Xe==="Point"||Xe==="MultiPoint"||Xe==="LineString")nt=Zo(Fe.geometry,de);else if(Xe==="MultiLineString"||Xe==="Polygon"){nt=[];for(const ct of Fe.geometry)nt.push(Zo(ct,de))}else if(Xe==="MultiPolygon"){nt=[];for(const ct of Fe.geometry){const rt=[];for(const vt of ct)rt.push(Zo(vt,de));nt.push(rt)}}xe.push(no(Fe.id,Xe,nt,Fe.tags))}return xe}function Zo(wt,de){const xe=[];xe.size=wt.size,wt.start!==void 0&&(xe.start=wt.start,xe.end=wt.end);for(let Ie=0;Ie<wt.length;Ie+=3)xe.push(wt[Ie]+de,wt[Ie+1],wt[Ie+2]);return xe}function Eo(wt,de){if(wt.transformed)return wt;const xe=1<<wt.z,Ie=wt.x,Fe=wt.y;for(const Xe of wt.features){const nt=Xe.geometry,ct=Xe.type;if(Xe.geometry=[],ct===1)for(let rt=0;rt<nt.length;rt+=2)Xe.geometry.push(Al(nt[rt],nt[rt+1],de,xe,Ie,Fe));else for(let rt=0;rt<nt.length;rt++){const vt=[];for(let gt=0;gt<nt[rt].length;gt+=2)vt.push(Al(nt[rt][gt],nt[rt][gt+1],de,xe,Ie,Fe));Xe.geometry.push(vt)}}return wt.transformed=!0,wt}function Al(wt,de,xe,Ie,Fe,Xe){return[Math.round(xe*(wt*Ie-Fe)),Math.round(xe*(de*Ie-Xe))]}function zs(wt,de,xe,Ie,Fe){const Xe=de===Fe.maxZoom?0:Fe.tolerance/((1<<de)*Fe.extent),nt={features:[],numPoints:0,numSimplified:0,numFeatures:wt.length,source:null,x:xe,y:Ie,z:de,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const ct of wt)nl(nt,ct,Xe,Fe);return nt}function nl(wt,de,xe,Ie){const Fe=de.geometry,Xe=de.type,nt=[];if(wt.minX=Math.min(wt.minX,de.minX),wt.minY=Math.min(wt.minY,de.minY),wt.maxX=Math.max(wt.maxX,de.maxX),wt.maxY=Math.max(wt.maxY,de.maxY),Xe==="Point"||Xe==="MultiPoint")for(let ct=0;ct<Fe.length;ct+=3)nt.push(Fe[ct],Fe[ct+1]),wt.numPoints++,wt.numSimplified++;else if(Xe==="LineString")Bn(nt,Fe,wt,xe,!1,!1);else if(Xe==="MultiLineString"||Xe==="Polygon")for(let ct=0;ct<Fe.length;ct++)Bn(nt,Fe[ct],wt,xe,Xe==="Polygon",ct===0);else if(Xe==="MultiPolygon")for(let ct=0;ct<Fe.length;ct++){const rt=Fe[ct];for(let vt=0;vt<rt.length;vt++)Bn(nt,rt[vt],wt,xe,!0,vt===0)}if(nt.length){let ct=de.tags||null;if(Xe==="LineString"&&Ie.lineMetrics){ct={};for(const vt in de.tags)ct[vt]=de.tags[vt];ct.mapbox_clip_start=Fe.start/Fe.size,ct.mapbox_clip_end=Fe.end/Fe.size}const rt={geometry:nt,type:Xe==="Polygon"||Xe==="MultiPolygon"?3:Xe==="LineString"||Xe==="MultiLineString"?2:1,tags:ct};de.id!==null&&(rt.id=de.id),wt.features.push(rt)}}function Bn(wt,de,xe,Ie,Fe,Xe){const nt=Ie*Ie;if(Ie>0&&de.size<(Fe?nt:Ie))return void(xe.numPoints+=de.length/3);const ct=[];for(let rt=0;rt<de.length;rt+=3)(Ie===0||de[rt+2]>nt)&&(xe.numSimplified++,ct.push(de[rt],de[rt+1])),xe.numPoints++;Fe&&function(rt,vt){let gt=0;for(let xt=0,Ct=rt.length,un=Ct-2;xt<Ct;un=xt,xt+=2)gt+=(rt[xt]-rt[un])*(rt[xt+1]+rt[un+1]);if(gt>0===vt)for(let xt=0,Ct=rt.length;xt<Ct/2;xt+=2){const un=rt[xt],hn=rt[xt+1];rt[xt]=rt[Ct-2-xt],rt[xt+1]=rt[Ct-1-xt],rt[Ct-2-xt]=un,rt[Ct-1-xt]=hn}}(ct,Xe),wt.push(ct)}const Jl={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ml{constructor(de,xe){const Ie=(xe=this.options=function(Xe,nt){for(const ct in nt)Xe[ct]=nt[ct];return Xe}(Object.create(Jl),xe)).debug;if(Ie&&console.time("preprocess data"),xe.maxZoom<0||xe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(xe.promoteId&&xe.generateId)throw new Error("promoteId and generateId cannot be used together.");let Fe=function(Xe,nt){const ct=[];if(Xe.type==="FeatureCollection")for(let rt=0;rt<Xe.features.length;rt++)Ds(ct,Xe.features[rt],nt,rt);else Ds(ct,Xe.type==="Feature"?Xe:{geometry:Xe},nt);return ct}(de,xe);this.tiles={},this.tileCoords=[],Ie&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",xe.indexMaxZoom,xe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Fe=function(Xe,nt){const ct=nt.buffer/nt.extent;let rt=Xe;const vt=Ui(Xe,1,-1-ct,ct,0,-1,2,nt),gt=Ui(Xe,1,1-ct,2+ct,0,-1,2,nt);return(vt||gt)&&(rt=Ui(Xe,1,-ct,1+ct,0,-1,2,nt)||[],vt&&(rt=$i(vt,1).concat(rt)),gt&&(rt=rt.concat($i(gt,-1)))),rt}(Fe,xe),Fe.length&&this.splitTile(Fe,0,0,0),Ie&&(Fe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(de,xe,Ie,Fe,Xe,nt,ct){const rt=[de,xe,Ie,Fe],vt=this.options,gt=vt.debug;for(;rt.length;){Fe=rt.pop(),Ie=rt.pop(),xe=rt.pop(),de=rt.pop();const xt=1<<xe,Ct=Mi(xe,Ie,Fe);let un=this.tiles[Ct];if(!un&&(gt>1&&console.time("creation"),un=this.tiles[Ct]=zs(de,xe,Ie,Fe,vt),this.tileCoords.push({z:xe,x:Ie,y:Fe}),gt)){gt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",xe,Ie,Fe,un.numFeatures,un.numPoints,un.numSimplified),console.timeEnd("creation"));const Pi=`z${xe}`;this.stats[Pi]=(this.stats[Pi]||0)+1,this.total++}if(un.source=de,Xe==null){if(xe===vt.indexMaxZoom||un.numPoints<=vt.indexMaxPoints)continue}else{if(xe===vt.maxZoom||xe===Xe)continue;if(Xe!=null){const Pi=Xe-xe;if(Ie!==nt>>Pi||Fe!==ct>>Pi)continue}}if(un.source=null,de.length===0)continue;gt>1&&console.time("clipping");const hn=.5*vt.buffer/vt.extent,Rn=.5-hn,$n=.5+hn,Xn=1+hn;let Fn=null,yr=null,Tr=null,or=null,Or=Ui(de,xt,Ie-hn,Ie+$n,0,un.minX,un.maxX,vt),Nr=Ui(de,xt,Ie+Rn,Ie+Xn,0,un.minX,un.maxX,vt);de=null,Or&&(Fn=Ui(Or,xt,Fe-hn,Fe+$n,1,un.minY,un.maxY,vt),yr=Ui(Or,xt,Fe+Rn,Fe+Xn,1,un.minY,un.maxY,vt),Or=null),Nr&&(Tr=Ui(Nr,xt,Fe-hn,Fe+$n,1,un.minY,un.maxY,vt),or=Ui(Nr,xt,Fe+Rn,Fe+Xn,1,un.minY,un.maxY,vt),Nr=null),gt>1&&console.timeEnd("clipping"),rt.push(Fn||[],xe+1,2*Ie,2*Fe),rt.push(yr||[],xe+1,2*Ie,2*Fe+1),rt.push(Tr||[],xe+1,2*Ie+1,2*Fe),rt.push(or||[],xe+1,2*Ie+1,2*Fe+1)}}getTile(de,xe,Ie){de=+de,xe=+xe,Ie=+Ie;const Fe=this.options,{extent:Xe,debug:nt}=Fe;if(de<0||de>24)return null;const ct=1<<de,rt=Mi(de,xe=xe+ct&ct-1,Ie);if(this.tiles[rt])return Eo(this.tiles[rt],Xe);nt>1&&console.log("drilling down to z%d-%d-%d",de,xe,Ie);let vt,gt=de,xt=xe,Ct=Ie;for(;!vt&&gt>0;)gt--,xt>>=1,Ct>>=1,vt=this.tiles[Mi(gt,xt,Ct)];return vt&&vt.source?(nt>1&&(console.log("found parent tile z%d-%d-%d",gt,xt,Ct),console.time("drilling down")),this.splitTile(vt.source,gt,xt,Ct,de,xe,Ie),nt>1&&console.timeEnd("drilling down"),this.tiles[rt]?Eo(this.tiles[rt],Xe):null):null}}function Mi(wt,de,xe){return 32*((1<<wt)*xe+de)+wt}function tc(wt,de){const xe=wt.tileID.canonical;if(!this._geoJSONIndex)return void de(null,null);const Ie=this._geoJSONIndex.getTile(xe.z,xe.x,xe.y);if(!Ie)return void de(null,null);const Fe=new Tt(Ie.features);let Xe=Ne(Fe);Xe.byteOffset===0&&Xe.byteLength===Xe.buffer.byteLength||(Xe=new Uint8Array(Xe)),de(null,{vectorTile:Fe,rawData:Xe.buffer})}class Tu extends He{constructor(de,xe,Ie,Fe,Xe,nt){super(de,xe,Ie,Fe,tc,nt),Xe&&(this.loadGeoJSON=Xe),this._dynamicIndex=new Ft}loadData(de,xe){const Ie=de&&de.request,Fe=Ie&&Ie.collectResourceTiming;this.loadGeoJSON(de,(Xe,nt)=>{if(Xe||!nt)return xe(Xe);if(typeof nt!="object")return xe(new Error(`Input data given to '${de.source}' is not a valid GeoJSON object.`));{try{if(de.filter){const rt=i.U(de.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(rt.result==="error")throw new Error(rt.value.map(vt=>`${vt.key}: ${vt.message}`).join(", "));nt.features=nt.features.filter(vt=>rt.value.evaluate({zoom:0},vt))}de.dynamic?(nt.type==="Feature"&&(nt={type:"FeatureCollection",features:[nt]}),de.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(nt.features,this.loaded),de.cluster&&(nt.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=de.cluster?new Qi(function({superclusterOptions:rt,clusterProperties:vt}){if(!vt||!rt)return rt;const gt={},xt={},Ct={accumulated:null,zoom:0},un={properties:null},hn=Object.keys(vt);for(const Rn of hn){const[$n,Xn]=vt[Rn],Fn=i.U(Xn),yr=i.U(typeof $n=="string"?[$n,["accumulated"],["get",Rn]]:$n);gt[Rn]=Fn.value,xt[Rn]=yr.value}return rt.map=Rn=>{un.properties=Rn;const $n={};for(const Xn of hn)$n[Xn]=gt[Xn].evaluate(Ct,un);return $n},rt.reduce=(Rn,$n)=>{un.properties=$n;for(const Xn of hn)Ct.accumulated=Rn[Xn],Rn[Xn]=xt[Xn].evaluate(Ct,un)},rt}(de)).load(nt.features):de.dynamic?this._dynamicIndex:function(rt,vt){return new Ml(rt,vt)}(nt,de.geojsonVtOptions)}catch(rt){return xe(rt)}const ct={};if(Fe){const rt=P(Ie);rt&&(ct.resourceTiming={},ct.resourceTiming[de.source]=JSON.parse(JSON.stringify(rt)))}xe(null,ct)}})}reloadTile(de,xe){const Ie=this.loaded;return Ie&&Ie[de.uid]?de.partial?xe(null,void 0):super.reloadTile(de,xe):this.loadTile(de,xe)}loadGeoJSON(de,xe){if(de.request)i.n(de.request,xe);else{if(typeof de.data!="string")return xe(new Error(`Input data given to '${de.source}' is not a valid GeoJSON object.`));try{return xe(null,JSON.parse(de.data))}catch{return xe(new Error(`Input data given to '${de.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(de,xe){try{xe(null,this._geoJSONIndex.getClusterExpansionZoom(de.clusterId))}catch(Ie){xe(Ie)}}getClusterChildren(de,xe){try{xe(null,this._geoJSONIndex.getChildren(de.clusterId))}catch(Ie){xe(Ie)}}getClusterLeaves(de,xe){try{xe(null,this._geoJSONIndex.getLeaves(de.clusterId,de.limit,de.offset))}catch(Ie){xe(Ie)}}}class Eu{constructor(de,xe){this.tileID=new i.aG(de.tileID.overscaledZ,de.tileID.wrap,de.tileID.canonical.z,de.tileID.canonical.x,de.tileID.canonical.y),this.tileZoom=de.tileZoom,this.uid=de.uid,this.zoom=de.zoom,this.canonical=de.tileID.canonical,this.pixelRatio=de.pixelRatio,this.tileSize=de.tileSize,this.source=de.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=de.projection,this.brightness=xe}parse(de,xe,Ie,Fe){this.status="parsing";const Xe=new i.aG(Ie.tileID.overscaledZ,Ie.tileID.wrap,Ie.tileID.canonical.z,Ie.tileID.canonical.x,Ie.tileID.canonical.y),nt=[],ct=xe.familiesBySource[Ie.source],rt=new i.d$(Xe,Ie.promoteId);return rt.bucketLayerIDs=[],rt.is3DTile=!0,i.ea(de).then(vt=>{if(!vt)return Fe(new Error("Could not parse tile"));const gt=i.eb(vt,1/i.cc(Ie.tileID.canonical)),xt=vt.json.extensionsUsed&&vt.json.extensionsUsed.includes("MAPBOX_mesh_features")||vt.json.asset.extras&&vt.json.asset.extras.MAPBOX_mesh_features,Ct=vt.json.extensionsUsed&&vt.json.extensionsUsed.includes("EXT_meshopt_compression"),un=new i.a8(this.zoom,{brightness:this.brightness});for(const hn in ct)for(const Rn of ct[hn]){const $n=Rn[0];rt.bucketLayerIDs.push(Rn.map(Fn=>i.aC(Fn.id,Fn.scope))),$n.recalculate(un,[]);const Xn=new i.ec(Rn,gt,Xe,xt,Ct,this.brightness,rt);xt||(Xn.needsUpload=!0),nt.push(Xn),Xn.evaluate($n)}this.status="done",Fe(null,{buckets:nt,featureIndex:rt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(vt=>Fe(new Error(vt.message)))}}class ea{constructor(de,xe,Ie,Fe,Xe,nt){this.actor=de,this.layerIndex=xe,this.availableImages=Ie,this.brightness=nt,this.loading={},this.loaded={}}loadTile(de,xe){const Ie=de.uid,Fe=this.loading[Ie]=new Eu(de,this.brightness);i.bi(de.request,(Xe,nt)=>{const ct=!this.loading[Ie];return delete this.loading[Ie],ct||Xe?(Fe.status="done",ct||(this.loaded[Ie]=Fe),xe(Xe)):nt&&nt.byteLength!==0?void Fe.parse(nt,this.layerIndex,de,(rt,vt)=>{Fe.status="done",this.loaded=this.loaded||{},this.loaded[Ie]=Fe,rt||!vt?xe(rt):xe(null,vt)}):(Fe.status="done",this.loaded[Ie]=Fe,xe())})}reloadTile(de,xe){const Ie=this.loaded,Fe=de.uid;if(Ie&&Ie[Fe]){const Xe=Ie[Fe];Xe.projection=de.projection,Xe.brightness=de.brightness;const nt=(ct,rt)=>{Xe.reloadCallback&&(delete Xe.reloadCallback,this.loadTile(de,xe)),xe(ct,rt)};Xe.status==="parsing"?Xe.reloadCallback=nt:Xe.status==="done"&&this.loadTile(de,xe)}}abortTile(de,xe){const Ie=de.uid;this.loading[Ie]&&delete this.loading[Ie],xe()}removeTile(de,xe){const Ie=this.loaded,Fe=de.uid;Ie&&Ie[Fe]&&delete Ie[Fe],xe()}}class ls{constructor(de){this.self=de,this.actor=new i.ed(de,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.imageRasterizer=new i.I,this.projections={},this.defaultProjection=i.bP({name:"mercator"}),this.workerSourceTypes={vector:He,geojson:Tu,"batched-model":ea},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(xe,Ie)=>{if(this.workerSourceTypes[xe])throw new Error(`Worker source with name "${xe}" already registered.`);this.workerSourceTypes[xe]=Ie},this.self.registerRTLTextPlugin=xe=>{if(i.ee.isParsed())throw new Error("RTL text plugin already registered.");i.ee.applyArabicShaping=xe.applyArabicShaping,i.ee.processBidirectionalText=xe.processBidirectionalText,i.ee.processStyledBidirectionalText=xe.processStyledBidirectionalText}}clearCaches(de,xe,Ie){delete this.layerIndexes[de],delete this.availableImages[de],delete this.workerSources[de],delete this.demWorkerSources[de],delete this.rasterArrayWorkerSource,Ie()}checkIfReady(de,xe,Ie){Ie()}setReferrer(de,xe){this.referrer=xe}spriteLoaded(de,{scope:xe,isLoaded:Ie}){if(this.isSpriteLoaded[de]||(this.isSpriteLoaded[de]={}),this.isSpriteLoaded[de][xe]=Ie,this.workerSources[de]&&this.workerSources[de][xe])for(const Fe in this.workerSources[de][xe]){const Xe=this.workerSources[de][xe][Fe];for(const nt in Xe){const ct=Xe[nt];ct instanceof He&&(ct.isSpriteLoaded=Ie,ct.fire(new i.z("isSpriteLoaded")))}}}setImages(de,{scope:xe,images:Ie},Fe){if(this.availableImages[de]||(this.availableImages[de]={}),this.availableImages[de][xe]=Ie,this.workerSources[de]&&this.workerSources[de][xe]){for(const Xe in this.workerSources[de][xe]){const nt=this.workerSources[de][xe][Xe];for(const ct in nt)nt[ct].availableImages=Ie}Fe()}else Fe()}setProjection(de,xe){this.projections[de]=i.bP(xe)}setBrightness(de,xe,Ie){this.brightness=xe,Ie()}setLayers(de,xe,Ie){this.getLayerIndex(de,xe.scope).replace(xe.layers,xe.options),Ie()}updateLayers(de,xe,Ie){this.getLayerIndex(de,xe.scope).update(xe.layers,xe.removedIds,xe.options),Ie()}loadTile(de,xe,Ie){xe.projection=this.projections[de]||this.defaultProjection,this.getWorkerSource(de,xe.type,xe.source,xe.scope).loadTile(xe,Ie)}loadDEMTile(de,xe,Ie){this.getDEMWorkerSource(de,xe.source,xe.scope).loadTile(xe,Ie)}decodeRasterArray(de,xe,Ie){this.getRasterArrayWorkerSource().decodeRasterArray(xe,Ie)}reloadTile(de,xe,Ie){xe.projection=this.projections[de]||this.defaultProjection,this.getWorkerSource(de,xe.type,xe.source,xe.scope).reloadTile(xe,Ie)}abortTile(de,xe,Ie){this.getWorkerSource(de,xe.type,xe.source,xe.scope).abortTile(xe,Ie)}removeTile(de,xe,Ie){this.getWorkerSource(de,xe.type,xe.source,xe.scope).removeTile(xe,Ie)}removeSource(de,xe,Ie){if(!(this.workerSources[de]&&this.workerSources[de][xe.scope]&&this.workerSources[de][xe.scope][xe.type]&&this.workerSources[de][xe.scope][xe.type][xe.source]))return;const Fe=this.workerSources[de][xe.scope][xe.type][xe.source];delete this.workerSources[de][xe.scope][xe.type][xe.source],Fe.removeSource!==void 0?Fe.removeSource(xe,Ie):Ie()}loadWorkerSource(de,xe,Ie){try{this.self.importScripts(xe.url),Ie()}catch(Fe){Ie(Fe.toString())}}syncRTLPluginState(de,xe,Ie){try{i.ee.setState(xe);const Fe=i.ee.getPluginURL();if(i.ee.isLoaded()&&!i.ee.isParsed()&&Fe!=null){this.self.importScripts(Fe);const Xe=i.ee.isParsed();Ie(Xe?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Fe}`),Xe)}}catch(Fe){Ie(Fe.toString())}}setDracoUrl(de,xe){this.dracoUrl=xe}getAvailableImages(de,xe){this.availableImages[de]||(this.availableImages[de]={});let Ie=this.availableImages[de][xe];return Ie||(Ie=[]),Ie}getLayerIndex(de,xe){this.layerIndexes[de]||(this.layerIndexes[de]={});let Ie=this.layerIndexes[de][xe];return Ie||(Ie=this.layerIndexes[de][xe]=new V,Ie.scope=xe),Ie}getWorkerSource(de,xe,Ie,Fe){return this.workerSources[de]||(this.workerSources[de]={}),this.workerSources[de][Fe]||(this.workerSources[de][Fe]={}),this.workerSources[de][Fe][xe]||(this.workerSources[de][Fe][xe]={}),this.isSpriteLoaded[de]||(this.isSpriteLoaded[de]={}),this.workerSources[de][Fe][xe][Ie]||(this.workerSources[de][Fe][xe][Ie]=new this.workerSourceTypes[xe]({send:(Xe,nt,ct,rt,vt,gt)=>{this.actor.send(Xe,nt,ct,de,vt,gt)},scheduler:this.actor.scheduler},this.getLayerIndex(de,Fe),this.getAvailableImages(de,Fe),this.isSpriteLoaded[de][Fe],void 0,this.brightness)),this.workerSources[de][Fe][xe][Ie]}rasterizeImages(de,xe,Ie){const{imageTasks:Fe,scope:Xe}=xe,nt={};for(const ct in Fe){const{image:rt,imageIdWithOptions:vt}=Fe[ct];nt[ct]=this.imageRasterizer.rasterize(vt,rt,Xe,de)}Ie(void 0,nt)}removeRasterizedImages(de,xe,Ie){const{imageIds:Fe,scope:Xe}=xe;this.imageRasterizer.removeImagesFromCacheByIds(Fe,Xe,de),Ie()}getDEMWorkerSource(de,xe,Ie){return this.demWorkerSources[de]||(this.demWorkerSources[de]={}),this.demWorkerSources[de][Ie]||(this.demWorkerSources[de][Ie]={}),this.demWorkerSources[de][Ie][xe]||(this.demWorkerSources[de][Ie][xe]=new st),this.demWorkerSources[de][Ie][xe]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new Ke),this.rasterArrayWorkerSource}enforceCacheSizeLimit(de,xe){i.ef(xe)}getWorkerPerformanceMetrics(de,xe,Ie){Ie(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new ls(self)),ls}),b(["./shared"],function(i){var P="3.10.0";const L={create:"create",load:"load",fullLoad:"fullLoad"},U={mark(p){performance.mark(p)},measure(p,r,l){performance.measure(p,r,l)}};function V(p){const r=p.name.split("?")[0];return i.a(r)&&r.includes("mapbox-gl.js")?"javascript":i.a(r)&&r.includes("mapbox-gl.css")?"css":i.b(r)?"fontRange":i.c(r)?"sprite":i.i(r)?"style":i.d(r)?"tilejson":"other"}var H,ee={},ie=function(){if(H)return ee;function p(m){return!r(m)}function r(m){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var T,I,N=new Blob([""],{type:"text/javascript"}),G=URL.createObjectURL(N);try{I=new Worker(G),T=!0}catch{T=!1}return I&&I.terminate(),URL.revokeObjectURL(G),T}()?function(){var T=document.createElement("canvas");T.width=T.height=1;var I=T.getContext("2d");if(!I)return!1;var N=I.getImageData(0,0,1,1);return N&&N.width===T.width}()?(l[w=m&&m.failIfMajorPerformanceCaveat]===void 0&&(l[w]=function(T){var I,N=function(G){var X=document.createElement("canvas"),Z=Object.create(p.webGLContextAttributes);return Z.failIfMajorPerformanceCaveat=G,X.getContext("webgl2",Z)}(T);if(!N)return!1;try{I=N.createShader(N.VERTEX_SHADER)}catch{return!1}return!(!I||N.isContextLost())&&(N.shaderSource(I,"void main() {}"),N.compileShader(I),N.getShaderParameter(I,N.COMPILE_STATUS)===!0)}(w)),l[w]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var w}H=1,ee.supported=p,ee.notSupportedReason=r;var l={};return p.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},ee}();function le(p,r,l){const m=document.createElement(p);return r!=null&&(m.className=r),l&&l.appendChild(m),m}function ue(p,r,l){const m=document.createElementNS("http://www.w3.org/2000/svg",p);for(const w of Object.keys(r))m.setAttributeNS(null,w,String(r[w]));return l&&l.appendChild(m),m}const ge=typeof document<"u"?document.documentElement&&document.documentElement.style:null,Se=ge&&ge.userSelect!==void 0?"userSelect":"WebkitUserSelect";let ve;function Ee(){ge&&Se&&(ve=ge[Se],ge[Se]="none")}function me(){ge&&Se&&(ge[Se]=ve)}function Ae(p){p.preventDefault(),p.stopPropagation(),window.removeEventListener("click",Ae,!0)}function Oe(){window.addEventListener("click",Ae,!0),window.setTimeout(()=>{window.removeEventListener("click",Ae,!0)},0)}function Ye(p,r){const l=p.getBoundingClientRect();return Ke(p,l,r)}function He(p,r){const l=p.getBoundingClientRect(),m=[];for(let w=0;w<r.length;w++)m.push(Ke(p,l,r[w]));return m}function st(p){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&p.button===2&&p.ctrlKey?0:p.button}function Ke(p,r,l){const m=p.offsetWidth===r.width?1:p.offsetWidth/r.width;return new i.P((l.clientX-r.left)*m,(l.clientY-r.top)*m)}const Ot="01",Bt="NO_ACCESS_TOKEN";class Tt{constructor(r,l,m){this._transformRequestFn=r,this._customAccessToken=l,this._silenceAuthErrors=!!m,this._createSkuToken()}_createSkuToken(){const r=function(){let l="";for(let m=0;m<10;m++)l+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Ot,l].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(r,l){return this._transformRequestFn&&this._transformRequestFn(r,l)||{url:r}}normalizeStyleURL(r,l){if(!i.f(r))return r;const m=bt(r);return m.params.push(`sdk=js-${P}`),m.path=`/styles/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||l)}normalizeGlyphsURL(r,l){if(!i.f(r))return r;const m=bt(r);return m.path=`/fonts/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||l)}normalizeModelURL(r,l){if(!i.f(r))return r;const m=bt(r);return m.path=`/models/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||l)}normalizeSourceURL(r,l,m,w){if(!i.f(r))return r;const T=bt(r);return T.path=`/v4/${T.authority}.json`,T.params.push("secure"),m&&T.params.push(`language=${m}`),w&&T.params.push(`worldview=${w}`),this._makeAPIURL(T,this._customAccessToken||l)}normalizeIconsetURL(r,l){const m=bt(r);return i.f(r)?(m.path=`/styles/v1${m.path}/iconset.pbf`,this._makeAPIURL(m,this._customAccessToken||l)):Ft(m)}normalizeSpriteURL(r,l,m,w){const T=bt(r);return i.f(r)?(T.path=`/styles/v1${T.path}/sprite${l}${m}`,this._makeAPIURL(T,this._customAccessToken||w)):(T.path+=`${l}${m}`,Ft(T))}normalizeTileURL(r,l,m){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!i.f(r))return r;const w=bt(r);w.path=w.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${l||m&&w.authority!=="raster"&&m===512?"@2x":""}${i.m.supported?".webp":"$1"}`),w.authority==="raster"?w.path=`/${i.e.RASTER_URL_PREFIX}${w.path}`:w.authority==="rasterarrays"?w.path=`/${i.e.RASTERARRAYS_URL_PREFIX}${w.path}`:w.authority==="3dtiles"?w.path=`/${i.e.TILES3D_URL_PREFIX}${w.path}`:(w.path=w.path.replace(/^.+\/v4\//,"/"),w.path=`/${i.e.TILE_URL_VERSION}${w.path}`);const T=this._customAccessToken||function(I){for(const N of I){const G=N.match(/^access_token=(.*)$/);if(G)return G[1]}return null}(w.params)||i.e.ACCESS_TOKEN;return i.e.REQUIRE_ACCESS_TOKEN&&T&&this._skuToken&&w.params.push(`sku=${this._skuToken}`),this._makeAPIURL(w,T)}canonicalizeTileURL(r,l){const m=bt(r);if(!m.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!m.path.match(/\.[\w]+$/))return r;let w="mapbox://";m.path.match(/^\/raster\/v1\//)?w+=`raster/${m.path.replace(`/${i.e.RASTER_URL_PREFIX}/`,"")}`:m.path.match(/^\/rasterarrays\/v1\//)?w+=`rasterarrays/${m.path.replace(`/${i.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:w+=`tiles/${m.path.replace(`/${i.e.TILE_URL_VERSION}/`,"")}`;let T=m.params;return l&&(T=T.filter(I=>!I.match(/^access_token=/))),T.length&&(w+=`?${T.join("&")}`),w}canonicalizeTileset(r,l){const m=!!l&&i.f(l),w=[];for(const T of r.tiles||[])i.h(T)?w.push(this.canonicalizeTileURL(T,m)):w.push(T);return w}_makeAPIURL(r,l){const m="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",w=bt(i.e.API_URL);if(r.protocol=w.protocol,r.authority=w.authority,r.protocol==="http"){const T=r.params.indexOf("secure");T>=0&&r.params.splice(T,1)}if(w.path!=="/"&&(r.path=`${w.path}${r.path}`),!i.e.REQUIRE_ACCESS_TOKEN)return Ft(r);if(l=l||i.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!l)throw new Error(`An API access token is required to use Mapbox GL. ${m}`);if(l[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${m}`)}return r.params=r.params.filter(T=>T.indexOf("access_token")===-1),r.params.push(`access_token=${l||""}`),Ft(r)}}const mt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function bt(p){const r=p.match(mt);if(!r)throw new Error("Unable to parse URL object");return{protocol:r[1],authority:r[2],path:r[3]||"/",params:r[4]?r[4].split("&"):[]}}function Ft(p){const r=p.params.length?`?${p.params.join("&")}`:"";return`${p.protocol}://${p.authority}${p.path}${r}`}const Zt="mapbox.eventData";function Vt(p){if(!p)return null;const r=p.split(".");if(!r||r.length!==3)return null;try{return JSON.parse(i.j(r[1]))}catch{return null}}class Ze{constructor(r){this.type=r,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(r){const l=Vt(i.e.ACCESS_TOKEN);let m="";return m=l&&l.u?i.k(l.u):i.e.ACCESS_TOKEN||"",r?`${Zt}.${r}:${m}`:`${Zt}:${m}`}fetchEventData(){const r=i.s("localStorage"),l=this.getStorageKey(),m=this.getStorageKey("uuid");if(r)try{const w=localStorage.getItem(l);w&&(this.eventData=JSON.parse(w));const T=localStorage.getItem(m);T&&(this.anonId=T)}catch{i.w("Unable to read from LocalStorage")}}saveEventData(){const r=i.s("localStorage"),l=this.getStorageKey(),m=this.getStorageKey("uuid"),w=this.anonId;if(r&&w)try{localStorage.setItem(m,w),Object.keys(this.eventData).length>=1&&localStorage.setItem(l,JSON.stringify(this.eventData))}catch{i.w("Unable to write to LocalStorage")}}processRequests(r){}postEvent(r,l,m,w){if(!i.e.EVENTS_URL)return;const T=bt(i.e.EVENTS_URL);T.params.push(`access_token=${w||i.e.ACCESS_TOKEN||""}`);const I={event:this.type,created:new Date(r).toISOString()},N=l?i.l(I,l):I,G={url:Ft(T),headers:{"Content-Type":"text/plain"},body:JSON.stringify([N])};this.pendingRequest=i.p(G,X=>{this.pendingRequest=null,m(X),this.saveEventData(),this.processRequests(w)})}queueRequest(r,l){this.queue.push(r),this.processRequests(l)}}const Xt=new class extends Ze{constructor(p){super("appUserTurnstile"),this._customAccessToken=p}postTurnstileEvent(p,r){i.e.EVENTS_URL&&i.e.ACCESS_TOKEN&&Array.isArray(p)&&p.some(l=>i.f(l)||i.h(l))&&this.queueRequest(Date.now(),r)}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const r=Vt(i.e.ACCESS_TOKEN),l=r?r.u:i.e.ACCESS_TOKEN;let m=l!==this.eventData.tokenU;i.v(this.anonId)||(this.anonId=i.u(),m=!0);const w=this.queue.shift();if(this.eventData.lastSuccess){const T=new Date(this.eventData.lastSuccess),I=new Date(w),N=(w-this.eventData.lastSuccess)/864e5;m=m||N>=1||N<-1||T.getDate()!==I.getDate()}else m=!0;m?this.postEvent(w,{sdkIdentifier:"mapbox-gl-js",sdkVersion:P,skuId:Ot,"enabled.telemetry":!1,userId:this.anonId},T=>{T||(this.eventData.lastSuccess=w,this.eventData.tokenU=l)},p):this.processRequests()}},an=Xt.postTurnstileEvent.bind(Xt),qt=new class extends Ze{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(p,r,l,m){this.skuToken=r,this.errorCb=m,i.e.EVENTS_URL&&(l||i.e.ACCESS_TOKEN?this.queueRequest({id:p,timestamp:Date.now()},l):this.errorCb(new Error(Bt)))}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:l}=this.queue.shift();r&&this.success[r]||(this.anonId||this.fetchEventData(),i.v(this.anonId)||(this.anonId=i.u()),this.postEvent(l,{sdkIdentifier:"mapbox-gl-js",sdkVersion:P,skuId:Ot,skuToken:this.skuToken,userId:this.anonId},m=>{m?this.errorCb(m):r&&(this.success[r]=!0)},p))}remove(){this.errorCb=null}},cn=qt.postMapLoadEvent.bind(qt),rr=new class extends Ze{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(p){let r=this.mapInstanceIdMap.get(p);return r||(r=i.u(),this.mapInstanceIdMap.set(p,r)),r}getEventId(p){const r=this.eventIdPerMapInstanceMap.get(p)||0;return this.eventIdPerMapInstanceMap.set(p,r+1),r}postStyleLoadEvent(p,r){const{map:l,style:m,importedStyles:w}=r;if(!i.e.EVENTS_URL||!p&&!i.e.ACCESS_TOKEN)return;const T=this.getMapInstanceId(l),I={mapInstanceId:T,eventId:this.getEventId(T),style:m};w.length&&(I.importedStyles=w),this.queueRequest({timestamp:Date.now(),payload:I},p)}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,payload:l}=this.queue.shift();this.postEvent(r,l,()=>{},p)}},mr=rr.postStyleLoadEvent.bind(rr),Ci=new class extends Ze{constructor(){super("gljs.performance")}postPerformanceEvent(p,r){i.e.EVENTS_URL&&(p||i.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:r},p)}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,performanceData:l}=this.queue.shift(),m=function(w){const T=performance.getEntriesByType("resource"),I=performance.getEntriesByType("mark"),N=function(ae){const ye={};if(ae){for(const fe in ae)if(fe!=="other")for(const be of ae[fe]){const _e=`${fe}ResolveRangeMin`,Ce=`${fe}ResolveRangeMax`,ze=`${fe}RequestCount`,De=`${fe}RequestCachedCount`;ye[_e]=Math.min(ye[_e]||1/0,be.startTime),ye[Ce]=Math.max(ye[Ce]||-1/0,be.responseEnd);const $e=je=>{ye[je]===void 0&&(ye[je]=0),++ye[je]};be.transferSize!==void 0&&be.transferSize===0&&$e(De),$e(ze)}}return ye}(function(ae,ye){const fe={};if(ae)for(const be of ae){const _e=ye(be);fe[_e]===void 0&&(fe[_e]=[]),fe[_e].push(be)}return fe}(T,V)),G=window.devicePixelRatio,X=navigator.connection||navigator.mozConnection||navigator.webkitConnection,Z=X?X.effectiveType:void 0,J={counters:[],metadata:[],attributes:[]},Q=(ae,ye,fe)=>{fe!=null&&ae.push({name:ye,value:fe.toString()})};for(const ae in N)Q(J.counters,ae,N[ae]);if(w.interactionRange[0]!==1/0&&w.interactionRange[1]!==-1/0&&(Q(J.counters,"interactionRangeMin",w.interactionRange[0]),Q(J.counters,"interactionRangeMax",w.interactionRange[1])),I)for(const ae of Object.keys(L)){const ye=L[ae],fe=I.find(be=>be.name===ye);fe&&Q(J.counters,ye,fe.startTime)}return Q(J.counters,"visibilityHidden",w.visibilityHidden),Q(J.attributes,"style",function(ae){if(ae)for(const ye of ae){const fe=ye.name.split("?")[0];if(i.i(fe)){const be=fe.split("/").slice(-2);if(be.length===2)return`mapbox://styles/${be[0]}/${be[1]}`}}}(T)),Q(J.attributes,"terrainEnabled",w.terrainEnabled?"true":"false"),Q(J.attributes,"fogEnabled",w.fogEnabled?"true":"false"),Q(J.attributes,"projection",w.projection),Q(J.attributes,"zoom",w.zoom),Q(J.metadata,"devicePixelRatio",G),Q(J.metadata,"connectionEffectiveType",Z),Q(J.metadata,"navigatorUserAgent",navigator.userAgent),Q(J.metadata,"screenWidth",window.screen.width),Q(J.metadata,"screenHeight",window.screen.height),Q(J.metadata,"windowWidth",window.innerWidth),Q(J.metadata,"windowHeight",window.innerHeight),Q(J.metadata,"mapWidth",w.width/G),Q(J.metadata,"mapHeight",w.height/G),Q(J.metadata,"webglRenderer",w.renderer),Q(J.metadata,"webglVendor",w.vendor),Q(J.metadata,"sdkVersion",P),Q(J.metadata,"sdkIdentifier","mapbox-gl-js"),J}(l);for(const w of m.metadata);for(const w of m.counters);for(const w of m.attributes);this.postEvent(r,m,()=>{},p)}},Et=Ci.postPerformanceEvent.bind(Ci),Ln=new class extends Ze{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(p,r,l,m){if(!i.e.API_URL||!i.e.SESSION_PATH)return;const w=bt(i.e.API_URL+i.e.SESSION_PATH);w.params.push(`sku=${r||""}`),w.params.push(`access_token=${m||i.e.ACCESS_TOKEN||""}`);const T={url:Ft(w),headers:{"Content-Type":"text/plain"}};this.pendingRequest=i.g(T,I=>{this.pendingRequest=null,l(I),this.saveEventData(),this.processRequests(m)})}getSessionAPI(p,r,l,m){this.skuToken=r,this.errorCb=m,i.e.SESSION_PATH&&i.e.API_URL&&(l||i.e.ACCESS_TOKEN?this.queueRequest({id:p,timestamp:Date.now()},l):this.errorCb(new Error(Bt)))}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:l}=this.queue.shift();r&&this.success[r]||this.getSession(l,this.skuToken,m=>{m?this.errorCb(m):r&&(this.success[r]=!0)},p)}remove(){this.errorCb=null}},Ne=Ln.getSessionAPI.bind(Ln),An=new Set;function qe(p,r){r?An.add(p):An.delete(p)}class jr{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(r,l){this._updatedSourceCaches[r]=l,this.setDirty()}discardSourceCacheUpdate(r){delete this._updatedSourceCaches[r]}updateLayer(r){const l=r.scope;this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._updatedLayers[l].add(r.id),this.setDirty()}removeLayer(r){const l=r.scope;this._removedLayers[l]=this._removedLayers[l]||{},this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._removedLayers[l][r.id]=r,this._updatedLayers[l].delete(r.id),this._updatedPaintProps.delete(r.fqid),this.setDirty()}getRemovedLayer(r){return this._removedLayers[r.scope]?this._removedLayers[r.scope][r.id]:null}discardLayerRemoval(r){this._removedLayers[r.scope]&&delete this._removedLayers[r.scope][r.id]}getLayerUpdatesByScope(){const r={};for(const l in this._updatedLayers)r[l]=r[l]||{},r[l].updatedIds=Array.from(this._updatedLayers[l].values());for(const l in this._removedLayers)r[l]=r[l]||{},r[l].removedIds=Object.keys(this._removedLayers[l]);return r}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(r){this._updatedPaintProps.add(r.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(r){this._updatedImages.add(r),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function $t(p){const{userImage:r}=p;return!!(r&&r.render&&r.render())&&(p.data.replace(new Uint8Array(r.data.buffer)),!0)}class Ur extends i.E{constructor(r){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0,this.spriteFormat=r,r!=="raster"&&i.t()&&(this.imageRasterizerDispatcher=new i.D(i.x(),this,"Image Rasterizer Worker",1))}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new i.I),this._imageRasterizer}createScope(r){this.images[r]={},this.loaded[r]=!1,this.updatedImages[r]={},this.patterns[r]={},this.callbackDispatchedThisFrame[r]={},this.atlasImage[r]=new i.r({width:1,height:1})}isLoaded(){for(const r in this.loaded)if(!this.loaded[r])return!1;return!0}setLoaded(r,l){if(this.loaded[l]!==r&&(this.loaded[l]=r,r)){for(const{ids:m,callback:w}of this.requestors)this._notify(m,l,w);this.requestors=[]}}hasImage(r,l){return!!this.getImage(r,l)}getImage(r,l){return this.images[l][r]}addImage(r,l,m){this._validate(r,m)&&(this.images[l][r]=m)}_validate(r,l){let m=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new i.y(new Error(`Image "${r}" has invalid "stretchX" value`))),m=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new i.y(new Error(`Image "${r}" has invalid "stretchY" value`))),m=!1),this._validateContent(l.content,l)||(this.fire(new i.y(new Error(`Image "${r}" has invalid "content" value`))),m=!1),m}_validateStretch(r,l){if(!r)return!0;let m=0;for(const w of r){if(w[0]<m||w[1]<w[0]||l<w[1])return!1;m=w[1]}return!0}_validateContent(r,l){return r?r.length!==4||!l.usvg&&(r[0]<0||l.data.width<r[0]||r[1]<0||l.data.height<r[1]||r[2]<0||l.data.width<r[2]||r[3]<0||l.data.height<r[3])?!1:!(r[2]<r[0]||r[3]<r[1]):!0}updateImage(r,l,m){m.version=this.images[l][r].version+1,this.images[l][r]=m,this.updatedImages[l][r]=!0,this.removeFromImageRasterizerCache(r,l)}removeFromImageRasterizerCache(r,l){this.spriteFormat!=="raster"&&(i.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[r],scope:l}):this.imageRasterizer.removeImagesFromCacheByIds([r],l))}removeImage(r,l){const m=this.images[l][r];delete this.images[l][r],delete this.patterns[l][r],this.removeFromImageRasterizerCache(r,l),m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()}listImages(r){return Object.keys(this.images[r])}getImages(r,l,m){let w=!0;const T=!!this.loaded[l];if(!T)for(const I of r)this.images[l][I]||(w=!1);T||w?this._notify(r,l,m):this.requestors.push({ids:r,scope:l,callback:m})}rasterizeImages({scope:r,imageTasks:l},m){const w={};for(const T in l){const I=l[T],N=this.getImage(I.id,r);N&&(w[T]={image:N,imageIdWithOptions:I})}i.t()?this.imageRasterizerDispatcher.getActor().send("rasterizeImages",{imageTasks:w,scope:r},m):this.rasterizeImagesInMainThread({imageTasks:w,scope:r},m)}rasterizeImagesInMainThread(r,l){const{imageTasks:m,scope:w}=r,T={};for(const I in m){const{image:N,imageIdWithOptions:G}=m[I];T[I]=this.imageRasterizer.rasterize(G,N,w,"")}l(void 0,T)}getUpdatedImages(r){return this.updatedImages[r]}_notify(r,l,m){const w={};for(const T of r){this.images[l][T]||this.fire(new i.z("styleimagemissing",{id:T}));const I=this.images[l][T];I?w[T]={data:I.usvg?null:I.data.clone(),pixelRatio:I.pixelRatio,sdf:I.sdf,usvg:I.usvg,version:I.version,stretchX:I.stretchX,stretchY:I.stretchY,content:I.content,hasRenderCallback:!!(I.userImage&&I.userImage.render)}:i.w(`Image "${T}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}m(null,w)}getPixelSize(r){const{width:l,height:m}=this.atlasImage[r];return{width:l,height:m}}getPattern(r,l,m){const w=this.patterns[l][r],T=this.getImage(r,l);if(!T)return null;if(w&&w.position.version===T.version)return w.position;if(w)w.position.version=T.version;else{T.usvg&&!T.data&&(T.data=this.imageRasterizer.rasterize(i.A.from(r).getPrimary(),T,l,""));const I={w:T.data.width+2*i.B,h:T.data.height+2*i.B,x:0,y:0},N=new i.C(I,T,i.B);this.patterns[l][r]={bin:I,position:N}}return this._updatePatternAtlas(l,m),this.patterns[l][r].position}bind(r,l){const m=r.gl;let w=this.atlasTexture[l];w?this.dirty&&(w.update(this.atlasImage[l]),this.dirty=!1):(w=new i.T(r,this.atlasImage[l],m.RGBA8),this.atlasTexture[l]=w),w.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(r,l){const m=[];for(const N in this.patterns[r])m.push(this.patterns[r][N].bin);const{w,h:T}=i.F(m),I=this.atlasImage[r];I.resize({width:w||1,height:T||1});for(const N in this.patterns[r]){const{bin:G,position:X}=this.patterns[r][N];let Z=X.padding;const J=G.x+Z,Q=G.y+Z,ae=this.images[r][N].data,ye=ae.width,fe=ae.height;Z=Z>1?Z-1:Z,i.r.copy(ae,I,{x:0,y:0},{x:J,y:Q},{width:ye,height:fe},l),i.r.copy(ae,I,{x:0,y:fe-Z},{x:J,y:Q-Z},{width:ye,height:Z},l),i.r.copy(ae,I,{x:0,y:0},{x:J,y:Q+fe},{width:ye,height:Z},l),i.r.copy(ae,I,{x:ye-Z,y:0},{x:J-Z,y:Q},{width:Z,height:fe},l),i.r.copy(ae,I,{x:0,y:0},{x:J+ye,y:Q},{width:Z,height:fe},l),i.r.copy(ae,I,{x:ye-Z,y:fe-Z},{x:J-Z,y:Q-Z},{width:Z,height:Z},l),i.r.copy(ae,I,{x:0,y:fe-Z},{x:J+ye,y:Q-Z},{width:Z,height:Z},l),i.r.copy(ae,I,{x:0,y:0},{x:J+ye,y:Q+fe},{width:Z,height:Z},l),i.r.copy(ae,I,{x:ye-Z,y:0},{x:J-Z,y:Q+fe},{width:Z,height:Z},l)}this.dirty=!0}beginFrame(){for(const r in this.images)this.callbackDispatchedThisFrame[r]={}}dispatchRenderCallbacks(r,l){for(const m of r){if(this.callbackDispatchedThisFrame[l][m])continue;this.callbackDispatchedThisFrame[l][m]=!0;const w=this.images[l][m];$t(w)&&this.updateImage(m,l,w)}}}function Wr(p){const r=p.key,l=p.value,m=p.valueSpec||{},w=p.objectElementValidators||{},T=p.style,I=p.styleSpec;let N=[];const G=i.H(l);if(G!=="object")return[new i.V(r,l,`object expected, ${G} found`)];for(const X in l){const Z=X.split(".")[0];let J;w[Z]?J=w[Z]:m[Z]?J=lr:w["*"]?J=w["*"]:m["*"]&&(J=lr),J?N=N.concat(J({key:(r&&`${r}.`)+X,value:l[X],valueSpec:m[Z]||m["*"],style:T,styleSpec:I,object:l,objectKey:X},l)):N.push(new i.G(r,l[X],`unknown property "${X}"`))}for(const X in m)w[X]||m[X].required&&m[X].default===void 0&&l[X]===void 0&&N.push(new i.V(r,l,`missing required property "${X}"`));return N}function Qi(p){const r=p.value,l=p.valueSpec,m=p.style,w=p.styleSpec,T=p.key,I=p.arrayElementValidator||lr;if(i.H(r)!=="array")return[new i.V(T,r,`array expected, ${i.H(r)} found`)];if(l.length&&r.length!==l.length)return[new i.V(T,r,`array length ${l.length} expected, length ${r.length} found`)];if(l["min-length"]&&r.length<l["min-length"])return[new i.V(T,r,`array length at least ${l["min-length"]} expected, length ${r.length} found`)];let N={type:l.value,values:l.values,minimum:l.minimum,maximum:l.maximum,function:void 0};w.$version<7&&(N.function=l.function),i.H(l.value)==="object"&&(N=l.value);let G=[];for(let X=0;X<r.length;X++)G=G.concat(I({array:r,arrayIndex:X,value:r[X],valueSpec:N,style:m,styleSpec:w,key:`${T}[${X}]`},!0));return G}function hr(p){const r=p.key,l=p.value,m=p.valueSpec;let w=i.H(l);if(w==="number"&&l!=l&&(w="NaN"),w!=="number")return[new i.V(r,l,`number expected, ${w} found`)];if("minimum"in m){let T=m.minimum;if(i.H(m.minimum)==="array"&&(T=m.minimum[p.arrayIndex]),l<T)return[new i.V(r,l,`${l} is less than the minimum value ${T}`)]}if("maximum"in m){let T=m.maximum;if(i.H(m.maximum)==="array"&&(T=m.maximum[p.arrayIndex]),l>T)return[new i.V(r,l,`${l} is greater than the maximum value ${T}`)]}return[]}function vn(p){const r=p.valueSpec,l=i.K(p.value.type);let m,w,T,I={};const N=l!=="categorical"&&p.value.property===void 0,G=!N,X=i.H(p.value.stops)==="array"&&i.H(p.value.stops[0])==="array"&&i.H(p.value.stops[0][0])==="object",Z=Wr({key:p.key,value:p.value,valueSpec:p.styleSpec.function,style:p.style,styleSpec:p.styleSpec,objectElementValidators:{stops:function(ae){if(l==="identity")return[new i.V(ae.key,ae.value,'identity function may not have a "stops" property')];let ye=[];const fe=ae.value;return ye=ye.concat(Qi({key:ae.key,value:fe,valueSpec:ae.valueSpec,style:ae.style,styleSpec:ae.styleSpec,arrayElementValidator:J})),i.H(fe)==="array"&&fe.length===0&&ye.push(new i.V(ae.key,fe,"array must have at least one stop")),ye},default:function(ae){return lr({key:ae.key,value:ae.value,valueSpec:r,style:ae.style,styleSpec:ae.styleSpec})}}});return l==="identity"&&N&&Z.push(new i.V(p.key,p.value,'missing required property "property"')),l==="identity"||p.value.stops||Z.push(new i.V(p.key,p.value,'missing required property "stops"')),l==="exponential"&&p.valueSpec.expression&&!i.L(p.valueSpec)&&Z.push(new i.V(p.key,p.value,"exponential functions not supported")),p.styleSpec.$version>=8&&(G&&!i.M(p.valueSpec)?Z.push(new i.V(p.key,p.value,"property functions not supported")):N&&!i.N(p.valueSpec)&&Z.push(new i.V(p.key,p.value,"zoom functions not supported"))),l!=="categorical"&&!X||p.value.property!==void 0||Z.push(new i.V(p.key,p.value,'"property" property is required')),Z;function J(ae){let ye=[];const fe=ae.value,be=ae.key;if(i.H(fe)!=="array")return[new i.V(be,fe,`array expected, ${i.H(fe)} found`)];if(fe.length!==2)return[new i.V(be,fe,`array length 2 expected, length ${fe.length} found`)];if(X){if(i.H(fe[0])!=="object")return[new i.V(be,fe,`object expected, ${i.H(fe[0])} found`)];if(fe[0].zoom===void 0)return[new i.V(be,fe,"object stop key must have zoom")];if(fe[0].value===void 0)return[new i.V(be,fe,"object stop key must have value")];const _e=i.K(fe[0].zoom);if(typeof _e!="number")return[new i.V(be,fe[0].zoom,"stop zoom values must be numbers")];if(T&&T>_e)return[new i.V(be,fe[0].zoom,"stop zoom values must appear in ascending order")];_e!==T&&(T=_e,w=void 0,I={}),ye=ye.concat(Wr({key:`${be}[0]`,value:fe[0],valueSpec:{zoom:{}},style:ae.style,styleSpec:ae.styleSpec,objectElementValidators:{zoom:hr,value:Q}}))}else ye=ye.concat(Q({key:`${be}[0]`,value:fe[0],style:ae.style,styleSpec:ae.styleSpec},fe));return i.O(i.Q(fe[1]))?ye.concat([new i.V(`${be}[1]`,fe[1],"expressions are not allowed in function stops.")]):ye.concat(lr({key:`${be}[1]`,value:fe[1],valueSpec:r,style:ae.style,styleSpec:ae.styleSpec}))}function Q(ae,ye){const fe=i.H(ae.value),be=i.K(ae.value),_e=ae.value!==null?ae.value:ye;if(m){if(fe!==m)return[new i.V(ae.key,_e,`${fe} stop domain type must match previous stop domain type ${m}`)]}else m=fe;if(fe!=="number"&&fe!=="string"&&fe!=="boolean"&&typeof be!="number"&&typeof be!="string"&&typeof be!="boolean")return[new i.V(ae.key,_e,"stop domain value must be a number, string, or boolean")];if(fe!=="number"&&l!=="categorical"){let Ce=`number expected, ${fe} found`;return i.M(r)&&l===void 0&&(Ce+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new i.V(ae.key,_e,Ce)]}return l!=="categorical"||fe!=="number"||typeof be=="number"&&isFinite(be)&&Math.floor(be)===be?l!=="categorical"&&fe==="number"&&typeof be=="number"&&typeof w=="number"&&w!==void 0&&be<w?[new i.V(ae.key,_e,"stop domain values must appear in ascending order")]:(w=be,l==="categorical"&&be in I?[new i.V(ae.key,_e,"stop domain values must be unique")]:(I[be]=!0,[])):[new i.V(ae.key,_e,`integer expected, found ${String(be)}`)]}}function wa(p){const r=(p.expressionContext==="property"?i.S:i.U)(i.Q(p.value),p.valueSpec);if(r.result==="error")return r.value.map(m=>new i.V(`${p.key}${m.key}`,p.value,m.message));const l=r.value.expression||r.value._styleExpression.expression;if(p.expressionContext==="property"&&p.propertyKey==="text-font"&&!l.outputDefined())return[new i.V(p.key,p.value,`Invalid data expression for "${p.propertyKey}". Output values must be contained as literals within the expression.`)];if(p.expressionContext==="property"&&p.propertyType==="layout"&&!i.W(l))return[new i.V(p.key,p.value,'"feature-state" data expressions are not supported with layout properties.')];if(p.expressionContext==="filter")return La(l,p);if(p.expressionContext&&p.expressionContext.indexOf("cluster")===0){if(!i.X(l,["zoom","feature-state"]))return[new i.V(p.key,p.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(p.expressionContext==="cluster-initial"&&!i.Y(l))return[new i.V(p.key,p.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function La(p,r){const l=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(r.valueSpec&&r.valueSpec.expression)for(const w of r.valueSpec.expression.parameters)l.delete(w);if(l.size===0)return[];const m=[];return p instanceof i.Z&&l.has(p.name)?[new i.V(r.key,r.value,`["${p.name}"] expression is not supported in a filter for a ${r.object.type} layer with id: ${r.object.id}`)]:(p.eachChild(w=>{m.push(...La(w,r))}),m)}function ya(p){const r=p.key,l=p.value,m=p.valueSpec,w=[];return Array.isArray(m.values)?m.values.indexOf(i.K(l))===-1&&w.push(new i.V(r,l,`expected one of [${m.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(m.values).indexOf(i.K(l))===-1&&w.push(new i.V(r,l,`expected one of [${Object.keys(m.values).join(", ")}], ${JSON.stringify(l)} found`)),w}function ks(p){return i.$(i.Q(p.value))?wa(i.J({},p,{expressionContext:"filter",valueSpec:p.styleSpec[`filter_${p.layerType||"fill"}`]})):Mn(p)}function Mn(p){const r=p.value,l=p.key;if(i.H(r)!=="array")return[new i.V(l,r,`array expected, ${i.H(r)} found`)];const m=p.styleSpec;let w,T=[];if(r.length<1)return[new i.V(l,r,"filter array must have at least 1 element")];switch(T=T.concat(ya({key:`${l}[0]`,value:r[0],valueSpec:m.filter_operator,style:p.style,styleSpec:p.styleSpec})),i.K(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&i.K(r[1])==="$type"&&T.push(new i.V(l,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&T.push(new i.V(l,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(w=i.H(r[1]),w!=="string"&&T.push(new i.V(`${l}[1]`,r[1],`string expected, ${w} found`)));for(let I=2;I<r.length;I++)w=i.H(r[I]),i.K(r[1])==="$type"?T=T.concat(ya({key:`${l}[${I}]`,value:r[I],valueSpec:m.geometry_type,style:p.style,styleSpec:p.styleSpec})):w!=="string"&&w!=="number"&&w!=="boolean"&&T.push(new i.V(`${l}[${I}]`,r[I],`string, number, or boolean expected, ${w} found`));break;case"any":case"all":case"none":for(let I=1;I<r.length;I++)T=T.concat(Mn({key:`${l}[${I}]`,value:r[I],style:p.style,styleSpec:p.styleSpec}));break;case"has":case"!has":w=i.H(r[1]),r.length!==2?T.push(new i.V(l,r,`filter array for "${r[0]}" operator must have 2 elements`)):w!=="string"&&T.push(new i.V(`${l}[1]`,r[1],`string expected, ${w} found`))}return T}function no(p,r){const l=p.key,m=p.style,w=p.layer,T=p.styleSpec,I=p.value,N=p.objectKey,G=T[`${r}_${p.layerType}`];if(!G)return[];const X=N.match(/^(.*)-use-theme$/);if(r==="paint"&&X&&G[X[1]])return i.O(I)?[].concat(lr({key:p.key,value:I,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:m,styleSpec:T,expressionContext:"property",propertyType:r,propertyKey:N})):lr({key:l,value:I,valueSpec:{type:"string"},style:m,styleSpec:T});const Z=N.match(/^(.*)-transition$/);if(r==="paint"&&Z&&G[Z[1]]&&G[Z[1]].transition)return lr({key:l,value:I,valueSpec:T.transition,style:m,styleSpec:T});const J=p.valueSpec||G[N];if(!J)return[new i.G(l,I,`unknown property "${N}"`)];let Q;if(i.H(I)==="string"&&i.M(J)&&!J.tokens&&(Q=/^{([^}]+)}$/.exec(I))){const ye=`\`{ "type": "identity", "property": ${Q?JSON.stringify(Q[1]):'"_"'} }\``;return[new i.V(l,I,`"${N}" does not support interpolation syntax
Use an identity property function instead: ${ye}.`)]}const ae=[];if(p.layerType==="symbol")N!=="text-field"||!m||m.glyphs||m.imports||ae.push(new i.V(l,I,'use of "text-field" requires a style "glyphs" property')),N==="text-font"&&i.a0(i.Q(I))&&i.K(I.type)==="identity"&&ae.push(new i.V(l,I,'"text-font" does not support identity functions'));else if(p.layerType==="model"&&r==="paint"&&w&&w.layout&&w.layout.hasOwnProperty("model-id")&&i.M(J)&&(i.a1(J)||i.N(J))){const ye=i.S(i.Q(I),J),fe=ye.value.expression||ye.value._styleExpression.expression;fe&&!i.X(fe,["measure-light"])&&(N==="model-emissive-strength"&&i.Y(fe)&&i.W(fe)||ae.push(new i.V(l,I,`${N} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return ae.concat(lr({key:p.key,value:I,valueSpec:J,style:m,styleSpec:T,expressionContext:"property",propertyType:r,propertyKey:N}))}function To(p){return no(p,"paint")}function Ds(p){return no(p,"layout")}function ar(p){let r=[];const l=p.value,m=p.key,w=p.style,T=p.styleSpec;l.type||l.ref||r.push(new i.V(m,l,'either "type" or "ref" is required'));let I=i.K(l.type);const N=i.K(l.ref);if(l.id){const G=i.K(l.id);for(let X=0;X<p.arrayIndex;X++){const Z=w.layers[X];i.K(Z.id)===G&&r.push(new i.V(m,l.id,`duplicate layer id "${l.id}", previously used at line ${Z.id.__line__}`))}}if("ref"in l){let G;["type","source","source-layer","filter","layout"].forEach(X=>{X in l&&r.push(new i.V(m,l[X],`"${X}" is prohibited for ref layers`))}),w.layers.forEach(X=>{i.K(X.id)===N&&(G=X)}),G?G.ref?r.push(new i.V(m,l.ref,"ref cannot reference another ref layer")):I=i.K(G.type):typeof N=="string"&&r.push(new i.V(m,l.ref,`ref layer "${N}" not found`))}else if(I!=="background"&&I!=="sky"&&I!=="slot")if(l.source){const G=w.sources&&w.sources[l.source],X=G&&i.K(G.type);G?X==="vector"&&I==="raster"?r.push(new i.V(m,l.source,`layer "${l.id}" requires a raster source`)):X==="raster"&&I!=="raster"?r.push(new i.V(m,l.source,`layer "${l.id}" requires a vector source`)):X!=="vector"||l["source-layer"]?X==="raster-dem"&&I!=="hillshade"?r.push(new i.V(m,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):X!=="raster-array"||["raster","raster-particle"].includes(I)?I!=="line"||!l.paint||!l.paint["line-gradient"]&&!l.paint["line-trim-offset"]||X==="geojson"&&G.lineMetrics?I==="raster-particle"&&X!=="raster-array"&&r.push(new i.V(m,l.source,`layer "${l.id}" requires a 'raster-array' source.`)):r.push(new i.V(m,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new i.V(m,l.source,"raster-array source can only be used with layer type 'raster'.")):r.push(new i.V(m,l,`layer "${l.id}" must specify a "source-layer"`)):r.push(new i.V(m,l.source,`source "${l.source}" not found`))}else r.push(new i.V(m,l,'missing required property "source"'));return r=r.concat(Wr({key:m,value:l,valueSpec:T.layer,style:p.style,styleSpec:p.styleSpec,objectElementValidators:{"*":()=>[],type:()=>lr({key:`${m}.type`,value:l.type,valueSpec:T.layer.type,style:p.style,styleSpec:p.styleSpec,object:l,objectKey:"type"}),filter:G=>ks(i.J({layerType:I},G)),layout:G=>Wr({layer:l,key:G.key,value:G.value,valueSpec:{},style:G.style,styleSpec:G.styleSpec,objectElementValidators:{"*":X=>Ds(i.J({layerType:I},X))}}),paint:G=>Wr({layer:l,key:G.key,value:G.value,valueSpec:{},style:G.style,styleSpec:G.styleSpec,objectElementValidators:{"*":X=>To(i.J({layerType:I,layer:l},X))}})}})),r}function Ls(p){const r=p.value,l=p.key,m=i.H(r);return m!=="string"?[new i.V(l,r,`string expected, ${m} found`)]:[]}const Kr={promoteId:function p({key:r,value:l}){if(i.H(l)==="string")return Ls({key:r,value:l});if(Array.isArray(l)){const m=[],w=i.Q(l),T=i.U(w);return T.result==="error"&&T.value.forEach(I=>{m.push(new i.V(`${r}${I.key}`,null,`${I.message}`))}),i.X(T.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||m.push(new i.V(`${r}`,null,"promoteId expression should be only feature dependent")),m}{const m=[];for(const w in l)m.push(...p({key:`${r}.${w}`,value:l[w]}));return m}}};function Rr(p){const r=p.value,l=p.key,m=p.styleSpec,w=p.style;if(!r.type)return[new i.V(l,r,'"type" is required')];const T=i.K(r.type);let I=[];switch(["vector","raster","raster-dem","raster-array"].includes(T)&&(r.url||r.tiles||I.push(new i.G(l,r,'Either "url" or "tiles" is required.'))),T){case"vector":case"raster":case"raster-dem":case"raster-array":return I=I.concat(Wr({key:l,value:r,valueSpec:m[`source_${T.replace("-","_")}`],style:p.style,styleSpec:m,objectElementValidators:Kr})),I;case"geojson":if(I=Wr({key:l,value:r,valueSpec:m.source_geojson,style:w,styleSpec:m,objectElementValidators:Kr}),r.cluster)for(const N in r.clusterProperties){const[G,X]=r.clusterProperties[N],Z=typeof G=="string"?[G,["accumulated"],["get",N]]:G;I.push(...wa({key:`${l}.${N}.map`,value:X,expressionContext:"cluster-map"})),I.push(...wa({key:`${l}.${N}.reduce`,value:Z,expressionContext:"cluster-reduce"}))}return I;case"video":return Wr({key:l,value:r,valueSpec:m.source_video,style:w,styleSpec:m});case"image":return Wr({key:l,value:r,valueSpec:m.source_image,style:w,styleSpec:m});case"canvas":return[new i.V(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ya({key:`${l}.type`,value:r.type,valueSpec:{values:ec(m)}})}}function ec(p){return p.source.reduce((r,l)=>{const m=p[l];return m.type.type==="enum"&&(r=r.concat(Object.keys(m.type.values))),r},[])}function Ui(p){const r=p.value,l=p.styleSpec,m=l.light,w=p.style;let T=[];const I=i.H(r);if(r===void 0)return T;if(I!=="object")return T=T.concat([new i.V("light",r,`object expected, ${I} found`)]),T;for(const N in r){const G=N.match(/^(.*)-transition$/),X=N.match(/^(.*)-use-theme$/);T=T.concat(X&&m[X[1]]?lr({key:N,value:r[N],valueSpec:{type:"string"},style:w,styleSpec:l}):G&&m[G[1]]&&m[G[1]].transition?lr({key:N,value:r[N],valueSpec:l.transition,style:w,styleSpec:l}):m[N]?lr({key:N,value:r[N],valueSpec:m[N],style:w,styleSpec:l}):[new i.V(N,r[N],`unknown property "${N}"`)])}return T}function $a(p){const r=p.value;let l=[];if(!r)return l;const m=i.H(r);if(m!=="object")return l=l.concat([new i.V("light-3d",r,`object expected, ${m} found`)]),l;const w=p.styleSpec,T=w["light-3d"],I=p.key,N=p.style,G=p.style.lights;for(const J of["type","id"])if(!(J in r))return l=l.concat([new i.V("light-3d",r,`missing property ${J} on light`)]),l;if(r.type&&G)for(let J=0;J<p.arrayIndex;J++){const Q=i.K(r.type),ae=G[J];i.K(ae.type)===Q&&l.push(new i.V(I,r.id,`duplicate light type "${r.type}", previously defined at line ${ae.id.__line__}`))}const X=`properties_light_${r.type}`;if(!(X in w))return l=l.concat([new i.V("light-3d",r,`Invalid light type ${r.type}`)]),l;const Z=w[X];for(const J in r)if(J==="properties"){const Q=r[J],ae=i.H(Q);if(ae!=="object")return l=l.concat([new i.V("properties",Q,`object expected, ${ae} found`)]),l;for(const ye in Q)l=l.concat(Z[ye]?lr({key:ye,value:Q[ye],valueSpec:Z[ye],style:N,styleSpec:w}):[new i.G(p.key,Q[ye],`unknown property "${ye}"`)])}else{const Q=J.match(/^(.*)-transition$/),ae=J.match(/^(.*)-use-theme$/);l=l.concat(ae&&T[ae[1]]?lr({key:J,value:r[J],valueSpec:{type:"string"},style:N,styleSpec:w}):Q&&T[Q[1]]&&T[Q[1]].transition?lr({key:J,value:r[J],valueSpec:w.transition,style:N,styleSpec:w}):T[J]?lr({key:J,value:r[J],valueSpec:T[J],style:N,styleSpec:w}):[new i.G(J,r[J],`unknown property "${J}"`)])}return l}function Er(p){const r=p.value,l=p.key,m=p.style,w=p.styleSpec,T=w.terrain;let I=[];const N=i.H(r);if(r===void 0||N==="null")return I;if(N!=="object")return I=I.concat([new i.V("terrain",r,`object expected, ${N} found`)]),I;for(const G in r){const X=G.match(/^(.*)-transition$/),Z=G.match(/^(.*)-use-theme$/);I=I.concat(Z&&T[Z[1]]?lr({key:G,value:r[G],valueSpec:{type:"string"},style:m,styleSpec:w}):X&&T[X[1]]&&T[X[1]].transition?lr({key:G,value:r[G],valueSpec:w.transition,style:m,styleSpec:w}):T[G]?lr({key:G,value:r[G],valueSpec:T[G],style:m,styleSpec:w}):[new i.G(G,r[G],`unknown property "${G}"`)])}if(r.source){const G=m.sources&&m.sources[r.source],X=G&&i.K(G.type);G?X!=="raster-dem"&&I.push(new i.V(l,r.source,`terrain cannot be used with a source of type ${String(X)}, it only be used with a "raster-dem" source type`)):I.push(new i.V(l,r.source,`source "${r.source}" not found`))}else I.push(new i.V(l,r,'terrain is missing required property "source"'));return I}function Sa(p){const r=p.value,l=p.style,m=p.styleSpec,w=m.fog;let T=[];const I=i.H(r);if(r===void 0)return T;if(I!=="object")return T=T.concat([new i.V("fog",r,`object expected, ${I} found`)]),T;for(const N in r){const G=N.match(/^(.*)-transition$/),X=N.match(/^(.*)-use-theme$/);T=T.concat(X&&w[X[1]]?lr({key:N,value:r[N],valueSpec:{type:"string"},style:l,styleSpec:m}):G&&w[G[1]]&&w[G[1]].transition?lr({key:N,value:r[N],valueSpec:m.transition,style:l,styleSpec:m}):w[N]?lr({key:N,value:r[N],valueSpec:w[N],style:l,styleSpec:m}):[new i.G(N,r[N],`unknown property "${N}"`)])}return T}const za={"*":()=>[],array:Qi,boolean:function(p){const r=p.value,l=p.key,m=i.H(r);return m!=="boolean"?[new i.V(l,r,`boolean expected, ${m} found`)]:[]},number:hr,color:function(p){const r=p.key,l=p.value,m=i.H(l);return m!=="string"?[new i.V(r,l,`color expected, ${m} found`)]:i._.parseCSSColor(l)===null?[new i.V(r,l,`color expected, "${l}" found`)]:[]},enum:ya,filter:ks,function:vn,layer:ar,object:Wr,source:Rr,model:i.a2,light:Ui,"light-3d":$a,terrain:Er,fog:Sa,string:Ls,formatted:function(p){return Ls(p).length===0?[]:wa(p)},resolvedImage:function(p){return Ls(p).length===0?[]:wa(p)},projection:function(p){const r=p.value,l=p.styleSpec,m=l.projection,w=p.style;let T=[];const I=i.H(r);if(I==="object")for(const N in r)T=T.concat(lr({key:N,value:r[N],valueSpec:m[N],style:w,styleSpec:l}));else I!=="string"&&(T=T.concat([new i.V("projection",r,`object or string expected, ${I} found`)]));return T},import:function(p){const{value:r,styleSpec:l}=p,{data:m,...w}=r;Object.defineProperty(w,"__line__",{value:r.__line__,enumerable:!1});let T=Wr(i.J({},p,{value:w,valueSpec:l.import}));return i.K(w.id)===""&&T.push(new i.V(`${p.key}.id`,w,"import id can't be an empty string")),m&&(T=T.concat(Kl(m,l,{key:`${p.key}.data`}))),T}};function lr(p,r=!1){const l=p.value,m=p.valueSpec,w=p.styleSpec;if(m.expression&&i.a0(i.K(l)))return vn(p);if(m.expression&&i.O(i.Q(l)))return wa(p);if(m.type&&za[m.type]){const T=za[m.type](p);return r===!0&&T.length>0&&i.H(p.value)==="array"?wa(p):T}return Wr(i.J({},p,{valueSpec:m.type?w[m.type]:m}))}function _a(p){const r=p.value,l=p.key,m=Ls(p);return m.length||(r.indexOf("{fontstack}")===-1&&m.push(new i.V(l,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&m.push(new i.V(l,r,'"glyphs" url must include a "{range}" token'))),m}function Kl(p,r=i.a3,l={}){return lr({key:l.key||"",value:p,valueSpec:r.$root,styleSpec:r,style:p,objectElementValidators:{glyphs:_a,"*":()=>[]}})}function $i(p,r=i.a3){return ea(Kl(p,r))}const Zo=p=>ea(Rr(p)),Eo=p=>ea(Ui(p)),Al=p=>ea($a(p)),zs=p=>ea(Er(p)),nl=p=>ea(Sa(p)),Bn=p=>ea(function(r){const l=r.value,m=r.style,w=r.styleSpec,T=w.snow;let I=[];const N=i.H(l);if(l===void 0)return I;if(N!=="object")return I=I.concat([new i.V("snow",l,`object expected, ${N} found`)]),I;for(const G in l){const X=G.match(/^(.*)-transition$/);I=I.concat(X&&T[X[1]]&&T[X[1]].transition?lr({key:G,value:l[G],valueSpec:w.transition,style:m,styleSpec:w}):T[G]?lr({key:G,value:l[G],valueSpec:T[G],style:m,styleSpec:w}):[new i.G(G,l[G],`unknown property "${G}"`)])}return I}(p)),Jl=p=>ea(function(r){const l=r.value,m=r.style,w=r.styleSpec,T=w.rain;let I=[];const N=i.H(l);if(l===void 0)return I;if(N!=="object")return I=I.concat([new i.V("rain",l,`object expected, ${N} found`)]),I;for(const G in l){const X=G.match(/^(.*)-transition$/);I=I.concat(X&&T[X[1]]&&T[X[1]].transition?lr({key:G,value:l[G],valueSpec:w.transition,style:m,styleSpec:w}):T[G]?lr({key:G,value:l[G],valueSpec:T[G],style:m,styleSpec:w}):[new i.G(G,l[G],`unknown property "${G}"`)])}return I}(p)),Ml=p=>ea(ar(p)),Mi=p=>ea(ks(p)),tc=p=>ea(To(p)),Tu=p=>ea(Ds(p)),Eu=p=>ea(i.a2(p));function ea(p){return p.slice().sort((r,l)=>r.line&&l.line?r.line-l.line:0)}function ls(p,r){let l=!1;if(r&&r.length)for(const m of r)m instanceof i.G?i.w(m.message):(p.fire(new i.y(new Error(m.message))),l=!0);return l}let wt;class de extends i.E{constructor(r,l="flat"){super(),this._transitionable=new i.a4(wt||(wt=new i.a5({anchor:new i.a6(i.a3.light.anchor),position:new i.a7(i.a3.light.position),color:new i.a6(i.a3.light.color),intensity:new i.a6(i.a3.light.intensity)}))),this.setLight(r,l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,l,m={}){this._validate(Eo,r,m)||(this._transitionable.setTransitionOrValue(r),this.id=l)}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,l,m){return(!m||m.validate!==!1)&&ls(this,r.call($i,i.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}}let xe=class extends i.E{constructor(p,r,l,m){super(),this.scope=l,this._transitionable=new i.a4(new i.a5({source:new i.a6(i.a3.terrain.source),exaggeration:new i.a6(i.a3.terrain.exaggeration)}),l,m),this._transitionable.setTransitionOrValue(p,m),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=r}get(){return this._transitionable.serialize()}set(p,r){this._transitionable.setTransitionOrValue(p,r)}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}getExaggeration(p){return this._transitioning.possiblyEvaluate(new i.a8(p)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const p=this._transitionable._values.exaggeration;if(!p)return null;const r=p.value.expression;if(!r)return null;let l=-1,m=-1,w=1;for(const T of r.zoomStops)w=r.evaluate(new i.a8(T)),w>.01?(l=T,m=-1):m=T;return w<.01&&l>0&&m>l?[l,m]:null}isZoomDependent(){const p=this._transitionable._values.exaggeration;return p!=null&&p.value!=null&&p.value.expression!=null&&p.value.expression instanceof i.a9}};const Ie=45,Fe=65,Xe=.05;function nt(p,r,l,m){const w=i.ac(Ie,Fe,l),[T,I]=ct(p,m);let N=1-Math.min(1,Math.exp((r-T)/(I-T)*-6));return N*=N*N,N=Math.min(1,1.00747*N),N*w*p.alpha}function ct(p,r){const l=.5/Math.tan(.5*r);return[p.range[0]+l,p.range[1]+l]}function rt(p,r,l,m,w){const T=i.ab.vec3.transformMat4([],[r,l,m],w.mercatorFogMatrix);return nt(p,i.ab.vec3.length(T),w.pitch,w._fov)}function vt(p,r,l,m,w,T,I){const N=[[l,m,0],[w,m,0],[w,T,0],[l,T,0]];let G=Number.MAX_VALUE,X=-Number.MAX_VALUE;for(const Z of N){const J=i.ab.vec3.transformMat4([],Z,r),Q=i.ab.vec3.length(J);G=Math.min(G,Q),X=Math.max(X,Q)}return[nt(p,G,I.pitch,I._fov),nt(p,X,I.pitch,I._fov)]}class gt extends i.E{constructor(r,l,m,w){super();const T=new i.a5({range:new i.a6(i.a3.fog.range),color:new i.a6(i.a3.fog.color),"color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"high-color":new i.a6(i.a3.fog["high-color"]),"high-color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"space-color":new i.a6(i.a3.fog["space-color"]),"space-color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new i.a6(i.a3.fog["horizon-blend"]),"star-intensity":new i.a6(i.a3.fog["star-intensity"]),"vertical-range":new i.a6(i.a3.fog["vertical-range"])});this._transitionable=new i.a4(T,m,new Map(w)),this.set(r,w),this._transitioning=this._transitionable.untransitioned(),this._transform=l,this.properties=new i.ad(T),this.scope=m}get state(){const r=this._transform,l=r.projection.name==="globe",m=i.ae(r.zoom),w=this.properties.get("range"),T=[.5,3];return{range:l?[i.af(T[0],w[0],m),i.af(T[1],w[1],m)]:w,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,l,m={}){if(this._validate(nl,r,m))return;const w=i.l({},r);for(const T of Object.keys(i.a3.fog))w[T]===void 0&&(w[T]=i.a3.fog[T].default);this._options=w,this._transitionable.setTransitionOrValue(this._options,l)}getOpacity(r){if(!this._transform.projection.supportsFog)return 0;const l=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:i.ac(Ie,Fe,r))*l.a}getOpacityAtLatLng(r,l){return this._transform.projection.supportsFog?function(m,w,T){const I=i.aa.fromLngLat(w),N=T.elevation?T.elevation.getAtPointOrZero(I):0;return rt(m,I.x,I.y,N,T)}(this.state,r,l):0}getOpacityForTile(r){if(!this._transform.projection.supportsFog)return[1,1];const l=this._transform.calculateFogTileMatrix(r.toUnwrapped());return vt(this.state,l,0,0,i.ag,i.ag,this._transform)}getOpacityForBounds(r,l,m,w,T){return this._transform.projection.supportsFog?vt(this.state,r,l,m,w,T,this._transform):[1,1]}getFovAdjustedRange(r){return this._transform.projection.supportsFog?ct(this.state,r):[0,1]}isVisibleOnFrustum(r){if(!this._transform.projection.supportsFog)return!1;const l=[4,5,6,7];for(const m of l){const w=r.points[m];let T;if(w[2]>=0)T=w;else{const I=r.points[m-4];T=i.ah(I,w,I[2]/(I[2]-w[2]))}if(rt(this.state,T[0],T[1],0,this._transform)>=Xe)return!0}return!1}updateConfig(r){this._transitionable.setTransitionOrValue(this._options,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,l,m){return(!m||m.validate!==!1)&&ls(this,r.call($i,i.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}}let xt,Ct,un,hn,Rn=class extends i.E{constructor(p,r,l,m){super();const w=xt||(xt=new i.a5({density:new i.a6(i.a3.snow.density),intensity:new i.a6(i.a3.snow.intensity),color:new i.a6(i.a3.snow.color),opacity:new i.a6(i.a3.snow.opacity),vignette:new i.a6(i.a3.snow.vignette),"vignette-color":new i.a6(i.a3.snow["vignette-color"]),"center-thinning":new i.a6(i.a3.snow["center-thinning"]),direction:new i.a6(i.a3.snow.direction),"flake-size":new i.a6(i.a3.snow["flake-size"])}));this._transitionable=new i.a4(w,l,new Map(m)),this.set(p,m),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ad(w),this.scope=l}get state(){const p=this.properties.get("opacity"),r=this.properties.get("color"),l=this.properties.get("direction"),m=i.ai(l[0]),w=-Math.max(i.ai(l[1]),.01),T=[Math.cos(m)*Math.cos(w),Math.sin(m)*Math.cos(w),Math.sin(w)],I=this.properties.get("vignette"),N=this.properties.get("vignette-color");return N.a=I,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.aj(r.r,r.g,r.b,r.a*p),direction:T,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:N}}get(){return this._transitionable.serialize()}set(p,r,l={}){if(this._validate(Bn,p,l))return;const m=i.l({},p);for(const w of Object.keys(i.a3.snow))m[w]===void 0&&(m[w]=i.a3.snow[w].default);this._options=m,this._transitionable.setTransitionOrValue(this._options,r)}updateConfig(p){this._transitionable.setTransitionOrValue(this._options,new Map(p))}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}_validate(p,r,l){return(!l||l.validate!==!1)&&ls(this,p.call($i,i.l({value:r,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}},$n=class extends i.E{constructor(p,r,l,m){super();const w=Ct||(Ct=new i.a5({density:new i.a6(i.a3.rain.density),intensity:new i.a6(i.a3.rain.intensity),color:new i.a6(i.a3.rain.color),opacity:new i.a6(i.a3.rain.opacity),vignette:new i.a6(i.a3.rain.vignette),"vignette-color":new i.a6(i.a3.rain["vignette-color"]),"center-thinning":new i.a6(i.a3.rain["center-thinning"]),direction:new i.a6(i.a3.rain.direction),"droplet-size":new i.a6(i.a3.rain["droplet-size"]),"distortion-strength":new i.a6(i.a3.rain["distortion-strength"])}));this._transitionable=new i.a4(w,l,new Map(m)),this.set(p,m),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ad(w),this.scope=l}get state(){const p=this.properties.get("opacity"),r=this.properties.get("color"),l=this.properties.get("direction"),m=i.ai(l[0]),w=-Math.max(i.ai(l[1]),.01),T=[Math.cos(m)*Math.cos(w),Math.sin(m)*Math.cos(w),Math.sin(w)],I=this.properties.get("vignette-color");return I.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.aj(r.r,r.g,r.b,r.a*p),direction:T,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:I}}get(){return this._transitionable.serialize()}set(p,r,l={}){if(this._validate(Jl,p,l))return;const m=i.l({},p);for(const w of Object.keys(i.a3.rain))m[w]===void 0&&(m[w]=i.a3.rain[w].default);this._options=m,this._transitionable.setTransitionOrValue(this._options,r)}updateConfig(p){this._transitionable.setTransitionOrValue(this._options,new Map(p))}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}_validate(p,r,l){return(!l||l.validate!==!1)&&ls(this,p.call($i,i.l({value:r,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}};class Xn extends i.E{constructor(r,l,m,w){super(),this.scope=m,this._options=r,this.properties=new i.ad(l),this._transitionable=new i.a4(l,m,new Map(w)),this._transitionable.setTransitionOrValue(r.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(r){this._transitionable.setTransitionOrValue(this._options.properties,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(r,l){this._options=r,this._transitionable.setTransitionOrValue(r.properties,l)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class Fn{constructor(r,l,m,w){this.screenBounds=r,this.cameraPoint=l,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=m,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,w)}static createFromScreenPoints(r,l){let m,w;if(r instanceof i.P||typeof r[0]=="number"){const T=i.P.convert(r);m=[T],w=l.isPointAboveHorizon(T)}else{const T=i.P.convert(r[0]),I=i.P.convert(r[1]);m=[T,I],w=i.al(T,I).every(N=>l.isPointAboveHorizon(N))}return new Fn(m,l.getCameraPoint(),w,l)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(r){return i.al(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const l=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],w=i.al(l,m,0,!1);return this.cameraPoint.y>m.y&&(this.cameraPoint.x>l.x&&this.cameraPoint.x<m.x?w.splice(3,0,this.cameraPoint):this.cameraPoint.x>=m.x?w[2]=this.cameraPoint:this.cameraPoint.x<=l.x&&(w[3]=this.cameraPoint)),i.am(w,r)}bufferedCameraGeometryGlobe(r){const l=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],w=i.al(l,m,r),T=this.cameraPoint.clone();switch(3*((T.y>l.y)+(T.y>m.y))+((T.x>l.x)+(T.x>m.x))){case 0:w[0]=T,w[4]=T.clone();break;case 1:w.splice(1,0,T);break;case 2:w[1]=T;break;case 3:w.splice(4,0,T);break;case 5:w.splice(2,0,T);break;case 6:w[3]=T;break;case 7:w.splice(3,0,T);break;case 8:w[2]=T}return w}containsTile(r,l,m,w=0){const T=r.queryPadding/l._pixelsPerMercatorPixel+1,I=m?this._bufferedCameraMercator(T,l):this._bufferedScreenMercator(T,l);let N=r.tileID.wrap+(I.unwrapped?w:0);const G=I.polygon.map(be=>i.an(r.tileTransform,be,N));if(!i.ao(G,0,0,i.ag,i.ag))return;N=r.tileID.wrap+(this.screenGeometryMercator.unwrapped?w:0);const X=this.screenGeometryMercator.polygon.map(be=>i.ap(r.tileTransform,be,N)),Z=X.map(be=>new i.P(be[0],be[1])),J=l.getFreeCameraOptions().position||new i.aa(0,0,0),Q=i.ap(r.tileTransform,J,N),ae=X.map(be=>{const _e=i.ab.vec3.sub(be,be,Q);return i.ab.vec3.normalize(_e,_e),new i.aq(Q,_e)}),ye=i.ar(r,1,l.zoom)*l._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:Z,tilespaceRays:ae,bufferedTilespaceGeometry:G,bufferedTilespaceBounds:(fe=i.as(G),fe.min.x=i.aw(fe.min.x,0,i.ag),fe.min.y=i.aw(fe.min.y,0,i.ag),fe.max.x=i.aw(fe.max.x,0,i.ag),fe.max.y=i.aw(fe.max.y,0,i.ag),fe),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:ye};var fe}_bufferedScreenMercator(r,l){const m=or(r);if(this._screenRaycastCache[m])return this._screenRaycastCache[m];{let w;return w=l.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(r),l):{polygon:this.bufferedScreenGeometry(r).map(T=>l.pointCoordinate3D(T)),unwrapped:!0},this._screenRaycastCache[m]=w,w}}_bufferedCameraMercator(r,l){const m=or(r);if(this._cameraRaycastCache[m])return this._cameraRaycastCache[m];{let w;return w=l.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(r),l):{polygon:this.bufferedCameraGeometry(r).map(T=>l.pointCoordinate3D(T)),unwrapped:!0},this._cameraRaycastCache[m]=w,w}}_projectAndResample(r,l){const m=function(T,I){const N=i.ab.mat4.multiply([],I.pixelMatrix,I.globeMatrix),G=[0,-i.ax,0,1],X=[0,i.ax,0,1],Z=[0,0,0,1];i.ab.vec4.transformMat4(G,G,N),i.ab.vec4.transformMat4(X,X,N),i.ab.vec4.transformMat4(Z,Z,N);const J=new i.P(G[0]/G[3],G[1]/G[3]),Q=new i.P(X[0]/X[3],X[1]/X[3]),ae=i.au(T,J)&&G[3]<Z[3],ye=i.au(T,Q)&&X[3]<Z[3];if(!ae&&!ye)return null;const fe=function(Ve,Ue,Qe){for(let at=1;at<Ve.length;at++){const St=Tr(Ue.pointCoordinate3D(Ve[at-1]).x),yt=Tr(Ue.pointCoordinate3D(Ve[at]).x);if(Qe<0){if(St<yt)return{idx:at,t:-St/(yt-1-St)}}else if(yt<St)return{idx:at,t:(1-St)/(yt+1-St)}}return null}(T,I,ae?-1:1);if(!fe)return null;const{idx:be,t:_e}=fe;let Ce=be>1?yr(T.slice(0,be),I):[],ze=be<T.length?yr(T.slice(be),I):[];Ce=Ce.map(Ve=>new i.P(Tr(Ve.x),Ve.y)),ze=ze.map(Ve=>new i.P(Tr(Ve.x),Ve.y));const De=[...Ce];De.length===0&&De.push(ze[ze.length-1]);const $e=i.af(De[De.length-1].y,(ze.length===0?Ce[0]:ze[0]).y,_e);let je;return je=ae?[new i.P(0,$e),new i.P(0,0),new i.P(1,0),new i.P(1,$e)]:[new i.P(1,$e),new i.P(1,1),new i.P(0,1),new i.P(0,$e)],De.push(...je),ze.length===0?De.push(Ce[0]):De.push(...ze),{polygon:De.map(Ve=>new i.aa(Ve.x,Ve.y)),unwrapped:!1}}(r,l);if(m)return m;const w=function(T,I){let N=!1,G=-1/0,X=0;for(let J=0;J<T.length-1;J++)T[J].x>G&&(G=T[J].x,X=J);for(let J=0;J<T.length-1;J++){const Q=(X+J)%(T.length-1),ae=T[Q],ye=T[Q+1];Math.abs(ae.x-ye.x)>.5&&(ae.x<ye.x?(ae.x+=1,Q===0&&(T[T.length-1].x+=1)):(ye.x+=1,Q+1===T.length-1&&(T[0].x+=1)),N=!0)}const Z=i.at(I.center.lng);return N&&Z<Math.abs(Z-1)&&T.forEach(J=>{J.x-=1}),{polygon:T,unwrapped:N}}(yr(r,l).map(T=>new i.P(Tr(T.x),T.y)),l);return{polygon:w.polygon.map(T=>new i.aa(T.x,T.y)),unwrapped:w.unwrapped}}}function yr(p,r){return i.av(p,l=>{const m=r.pointCoordinate3D(l);l.x=m.x,l.y=m.y},1/256)}function Tr(p){return p<0?1+p%1:p%1}function or(p){return 100*p|0}function Or(p,r,l,m,w){const T=function(N,G){if(N)return w(N);if(G){if(p.url&&G.tiles&&p.tiles&&delete p.tiles,G.variants){if(!Array.isArray(G.variants))return w(new Error("variants must be an array"));for(const Z of G.variants){if(Z==null||typeof Z!="object"||Z.constructor!==Object)return w(new Error("variant must be an object"));if(!Array.isArray(Z.capabilities))return w(new Error("capabilities must be an array"));if(Z.capabilities.length===1&&Z.capabilities[0]==="meshopt"){G=i.l(G,Z);break}}}const X=i.ay(i.l({},G,p),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);X.tiles=r.canonicalizeTileset(X,p.url),w(null,X)}},I=function(N,G,X){if(!N)return null;if(!G&&!X)return N;X=X||N.worldview_default;const Z=Object.values(N.language||{});if(Z.length===0)return null;const J=Object.values(N.worldview||{});if(J.length===0)return null;const Q=Z.every(ye=>ye===G),ae=J.every(ye=>ye===X);return Q&&ae?N:G in(N.language_options||{})||X in(N.worldview_options||{})?null:N.language_options&&N.worldview_options?N:null}(p.data,l,m);return I?i.q.frame(()=>T(null,I)):p.url?i.n(r.transformRequest(r.normalizeSourceURL(p.url,null,l,m),i.R.Source),T):i.q.frame(()=>{const{data:N,...G}=p;T(null,G)})}class Nr{constructor(r,l,m){this.bounds=i.az.convert(this.validateBounds(r)),this.minzoom=l||0,this.maxzoom=m||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const l=Math.pow(2,r.z),m=Math.floor(i.at(this.bounds.getWest())*l),w=Math.floor(i.aA(this.bounds.getNorth())*l),T=Math.ceil(i.at(this.bounds.getEast())*l),I=Math.ceil(i.aA(this.bounds.getSouth())*l);return r.x>=m&&r.x<T&&r.y>=w&&r.y<I}}class Pi extends i.E{constructor(r,l,m,w){if(super(),this.id=r,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.l(this,i.ay(l,["url","scheme","tileSize","promoteId"])),this._options=i.l({type:"vector"},l),this._collectResourceTiming=!!l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w),this._tileWorkers={},this._deduped=new i.aB}load(r){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const l=Array.isArray(this.map._language)?this.map._language.join():this.map._language,m=this.map.getWorldview();this._tileJSONRequest=Or(this._options,this.map._requestManager,l,m,(w,T)=>{if(this._tileJSONRequest=null,this._loaded=!0,w)l&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${l}`),m&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${m}`),this.fire(new i.y(w));else if(T){if(i.l(this,T),this.hasWorldviews=!!T.worldview_options,T.worldview_default&&(this.worldviewDefault=T.worldview_default),T.vector_layers){this.vectorLayers=T.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const I of T.vector_layers)this.vectorLayerIds.push(I.id),T.worldview&&T.worldview[I.source]&&this.localizableLayerIds.add(I.id)}T.bounds&&(this.tileBounds=new Nr(T.bounds,this.minzoom,this.maxzoom)),an(T.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}r&&r(w)})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(r){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}loadTile(r,l){const m=r.tileID.canonical.url(this.tiles,this.scheme),w=this.map._requestManager.normalizeTileURL(m),T=this.map._requestManager.transformRequest(w,i.R.Tile),I=this.map.style?this.map.style.getLut(this.scope):null,N=I?{image:I.image.clone()}:null,G={request:T,data:void 0,uid:r.uid,tileID:r.tileID,tileZoom:r.tileZoom,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,lut:N,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:r.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:r.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&i.f(m)&&(G.worldview=this.map.getWorldview()||this.worldviewDefault,G.localizableLayerIds=this.localizableLayerIds),G.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired")r.state==="loading"?r.reloadCallback=l:r.request=r.actor.send("reloadTile",G,X.bind(this));else if(r.actor=this._tileWorkers[w]=this._tileWorkers[w]||this.dispatcher.getActor(),this.dispatcher.ready)r.request=r.actor.send("loadTile",G,X.bind(this),void 0,!0);else{const Z=i.aD.call({deduped:this._deduped},G,(J,Q)=>{J||!Q?X.call(this,J):(G.data={cacheControl:Q.cacheControl,expires:Q.expires,rawData:Q.rawData.slice(0)},r.actor&&r.actor.send("loadTile",G,X.bind(this),void 0,!0))},!0);r.request={cancel:Z}}function X(Z,J){return delete r.request,r.aborted?l(null):Z&&Z.status!==404?l(Z):(J&&J.resourceTiming&&(r.resourceTiming=J.resourceTiming),this.map._refreshExpiredTiles&&J&&r.setExpiryData(J),r.loadVectorData(J,this.map.painter),i.aE(this.dispatcher),l(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(r,l){r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope}),r.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ao extends i.E{constructor(r,l,m,w){super(),this.id=r,this.dispatcher=m,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.l({type:"raster"},l),i.l(this,i.ay(l,["url","scheme","tileSize"]))}load(r){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"})),this._tileJSONRequest=Or(this._options,this.map._requestManager,null,null,(l,m)=>{this._tileJSONRequest=null,this._loaded=!0,l?this.fire(new i.y(l)):m&&(i.l(this,m),m.raster_layers&&(this.rasterLayers=m.raster_layers,this.rasterLayerIds=this.rasterLayers.map(w=>w.id)),m.bounds&&(this.tileBounds=new Nr(m.bounds,this.minzoom,this.maxzoom)),an(m.tiles),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),r&&r(l)})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(r){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,l){const m=i.q.devicePixelRatio>=2,w=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),m,this.tileSize);r.request=i.o(this.map._requestManager.transformRequest(w,i.R.Tile),(T,I,N,G)=>(delete r.request,r.aborted?(r.state="unloaded",l(null)):T?(r.state="errored",l(T)):I?(this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:N,expires:G}),r.setTexture(I,this.map.painter),r.state="loaded",i.aE(this.dispatcher),void l(null)):l(null)))}abortTile(r,l){r.request&&(r.request.cancel(),delete r.request),l&&l()}unloadTile(r,l){r.texture&&r.texture instanceof i.T?(r.destroy(!0),r.texture&&r.texture instanceof i.T&&this.map.painter.saveTileTexture(r.texture)):r.destroy(),l&&l()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ta extends Ao{constructor(r,l,m,w){super(r,l,m,w),this.type="raster-array",this.maxzoom=22,this._options=i.l({type:"raster-array"},l)}triggerRepaint(r){const l=this.map.painter._terrain,m=this.map.style.getSourceCache(this.id);l&&l.enabled&&m&&l._clearRenderCacheForTile(m.id,r.tileID),this.map.triggerRepaint()}loadTile(r,l){const m=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),w=this.map._requestManager.transformRequest(m,i.R.Tile);r.requestParams=w,r.actor||(r.actor=this.dispatcher.getActor()),r.request=r.fetchHeader(void 0,(T,I,N,G)=>{if(delete r.request,r.aborted)return r.state="unloaded",l(null);if(T)return T.code===20?void 0:(r.state="errored",l(T));this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:N,expires:G}),r.state="empty",l(null)})}unloadTile(r,l){const m=r.texture;m&&m instanceof i.T?(r.destroy(!0),this.map.painter.saveTileTexture(m)):(r.destroy(),r.flushQueues(),r._isHeaderLoaded=!1,delete r._mrt,delete r.textureDescriptor),r.fbo&&(r.fbo.destroy(),delete r.fbo),delete r.request,delete r.requestParams,delete r.neighboringTiles,r.state="unloaded"}prepareTile(r,l,m){r._isHeaderLoaded&&(r.state!=="empty"&&(r.state="reloading"),r.fetchBand(l,m,(w,T)=>{if(w)return r.state="errored",this.fire(new i.y(w)),void this.triggerRepaint(r);T&&(r.setTexture(T,this.map.painter),r.state="loaded",this.triggerRepaint(r))}))}getInitialBand(r){if(!this.rasterLayers)return 0;const l=this.rasterLayers.find(({id:T})=>T===r),m=l&&l.fields,w=m&&m.bands&&m.bands;return w?w[0]:0}getTextureDescriptor(r,l,m){if(!r)return;const w=l.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!w)return;let T=null;l instanceof i.aH?T=l.paint.get("raster-array-band"):l instanceof i.aI&&(T=l.paint.get("raster-particle-array-band"));const I=T||this.getInitialBand(w);if(I!=null)if(r.textureDescriptor){if(!r.updateNeeded(w,I)||m)return Object.assign({},r.textureDescriptor,{texture:r.texture})}else this.prepareTile(r,w,I)}}const Ri={vector:Pi,raster:Ao,"raster-dem":class extends Ao{constructor(p,r,l,m){super(p,r,l,m),this.type="raster-dem",this.maxzoom=22,this._options=i.l({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(p,r){const l=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function m(w,T){w&&(p.state="errored",r(w)),T&&(p.dem=T,p.dem.onDeserialize(),p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0,p.state="loaded",r(null))}p.request=i.o(this.map._requestManager.transformRequest(l,i.R.Tile),(function(w,T,I,N){if(delete p.request,p.aborted)p.state="unloaded",r(null);else if(w)p.state="errored",r(w);else if(T){this.map._refreshExpiredTiles&&p.setExpiryData({cacheControl:I,expires:N});const G=ImageBitmap&&T instanceof ImageBitmap&&i.t(),X=1-(T.width-i.aF(T.width))/2;X<1||p.neighboringTiles||(p.neighboringTiles=this._getNeighboringTiles(p.tileID));const Z=G?T:i.q.getImageData(T,X),J={uid:p.uid,coord:p.tileID,source:this.id,scope:this.scope,rawImageData:Z,encoding:this.encoding,padding:X};p.actor&&p.state!=="expired"||(p.actor=this.dispatcher.getActor(),p.actor.send("loadDEMTile",J,m.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(p){const r=p.canonical,l=Math.pow(2,r.z),m=(r.x-1+l)%l,w=r.x===0?p.wrap-1:p.wrap,T=(r.x+1+l)%l,I=r.x+1===l?p.wrap+1:p.wrap,N={};return N[new i.aG(p.overscaledZ,w,r.z,m,r.y).key]={backfilled:!1},N[new i.aG(p.overscaledZ,I,r.z,T,r.y).key]={backfilled:!1},r.y>0&&(N[new i.aG(p.overscaledZ,w,r.z,m,r.y-1).key]={backfilled:!1},N[new i.aG(p.overscaledZ,p.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},N[new i.aG(p.overscaledZ,I,r.z,T,r.y-1).key]={backfilled:!1}),r.y+1<l&&(N[new i.aG(p.overscaledZ,w,r.z,m,r.y+1).key]={backfilled:!1},N[new i.aG(p.overscaledZ,p.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},N[new i.aG(p.overscaledZ,I,r.z,T,r.y+1).key]={backfilled:!1}),N}},"raster-array":ta,geojson:class extends i.E{constructor(p,r,l,m){super(),this.id=p,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=l.getActor(),this.setEventedParent(m),this._data=r.data,this._options=i.l({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.minzoom!==void 0&&(this.minzoom=r.minzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const w=i.ag/this.tileSize;this.workerOptions=i.l({source:this.id,scope:this.scope,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*w,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*w,extent:i.ag,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:i.ag,radius:(r.clusterRadius!==void 0?r.clusterRadius:50)*w,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter,dynamic:r.dynamic},r.workerOptions)}onAdd(p){this.map=p,this.setData(this._data)}setData(p){return this._data=p,this._updateWorkerData(),this}updateData(p){if(!this._options.dynamic)return this.fire(new i.y(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof p!="string"&&(p.type==="Feature"&&(p={type:"FeatureCollection",features:[p]}),p.type!=="FeatureCollection"))return this.fire(new i.y(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof p!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const r=new Map;for(const l of this._data.features)r.set(l.id,l);for(const l of p.features)r.set(l.id,l);this._data.features=[...r.values()]}else this._data=p;return this._updateWorkerData(!0),this}getClusterExpansionZoom(p,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:p,source:this.id,scope:this.scope},r),this}getClusterChildren(p,r){return this.actor.send("geojson.getClusterChildren",{clusterId:p,source:this.id,scope:this.scope},r),this}getClusterLeaves(p,r,l,m){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:p,limit:r,offset:l},m),this}_updateWorkerData(p=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new i.z("dataloading",{dataType:"source"})),this._loaded=!1;const r=i.l({append:p},this.workerOptions);r.scope=this.scope;const l=this._data;typeof l=="string"?(r.request=this.map._requestManager.transformRequest(i.q.resolveURL(l),i.R.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(l),this._pendingLoad=this.actor.send(`${this.type}.loadData`,r,(m,w)=>{if(this._loaded=!0,this._pendingLoad=null,m)this.fire(new i.y(m));else{const T={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&w&&w.resourceTiming&&w.resourceTiming[this.id]&&(T.resourceTiming=w.resourceTiming[this.id]),p&&(this._partialReload=!0),this.fire(new i.z("data",T)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(p),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const p=i.aC(this.id,this.scope);this.map.style.clearSource(p),this._updateWorkerData()}loadTile(p,r){const l=p.actor?"reloadTile":"loadTile";p.actor=this.actor;const m=this.map.style?this.map.style.getLut(this.scope):null,w=m?{image:m.image.clone()}:null,T=this._partialReload,I={type:this.type,uid:p.uid,tileID:p.tileID,tileZoom:p.tileZoom,zoom:p.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:w,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,scaleFactor:this.map.getScaleFactor(),partial:T};p.request=this.actor.send(l,I,(N,G)=>T&&!G?(p.state="loaded",r(null)):(delete p.request,p.destroy(),p.aborted?r(null):N?r(N):(p.loadVectorData(G,this.map.painter,l==="reloadTile"),r(null))),void 0,l==="loadTile")}abortTile(p){p.request&&(p.request.cancel(),delete p.request),p.aborted=!0}unloadTile(p,r){this.actor.send("removeTile",{uid:p.uid,type:this.type,source:this.id,scope:this.scope}),p.destroy()}onRemove(p){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return i.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends i.aJ{constructor(p,r,l,m){super(p,r,l,m),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const p=this.options;this.urls=[];for(const r of p.urls)this.urls.push(this.map._requestManager.transformRequest(r,i.R.Source).url);i.aK(this.urls,(r,l)=>{this._loaded=!0,r?this.fire(new i.y(r)):l&&(this.video=l,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(p){if(this.video){const r=this.video.seekable;p<r.start(0)||p>r.end(0)?this.fire(new i.y(new i.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=p}}getVideo(){return this.video}onAdd(p){this.map||(this.map=p,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const p=this.map.painter.context,r=p.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new i.T(p,this.video,r.RGBA8),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(p)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:i.aJ,model:class extends i.E{constructor(p,r,l,m){super(),this.id=p,this.type="model",this.models=[],this._loaded=!1,this._options=r}load(){const p=[];for(const r in this._options.models){const l=this._options.models[r],m=i.aM(this.map._requestManager.transformRequest(l.uri,i.R.Model).url).then(w=>{if(!w)return;const T=i.aN(w),I=new i.aO(r,l.position,l.orientation,T);I.computeBoundsAndApplyParent(),this.models.push(I)}).catch(w=>{this.fire(new i.y(new Error(`Could not load model ${r} from ${l.uri}: ${w.message}`)))});p.push(m)}return Promise.allSettled(p).then(()=>{this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(r=>{this.fire(new i.y(new Error(`Could not load models: ${r.message}`)))})}onAdd(p){this.map=p,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(p,r){}serialize(){return{type:"model"}}},"batched-model":class extends i.E{constructor(p,r,l,m){super(),this.type="batched-model",this.id=p,this.tileSize=512,this._options=r,this.tiles=this._options.tiles,this.maxzoom=r.maxzoom||19,this.minzoom=r.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=l,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(m)}onAdd(p){this.map=p,this.load()}reload(){this.cancelTileJSONRequest();const p=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(p))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(p){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const r=Array.isArray(this.map._language)?this.map._language.join():this.map._language,l=this.map.getWorldview();this._tileJSONRequest=Or(this._options,this.map._requestManager,r,l,(m,w)=>{this._tileJSONRequest=null,this._loaded=!0,m?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${r}`),l&&l.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${l}`),this.fire(new i.y(m))):w&&(i.l(this,w),w.bounds&&(this.tileBounds=new Nr(w.bounds,this.minzoom,this.maxzoom)),an(w.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),p&&p(m)})}hasTransition(){return!1}hasTile(p){return!this.tileBounds||this.tileBounds.contains(p.canonical)}loaded(){return this._loaded}loadTile(p,r){const l=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme)),m={request:this.map._requestManager.transformRequest(l,i.R.Tile),data:void 0,uid:p.uid,tileID:p.tileID,tileZoom:p.tileZoom,zoom:p.tileID.overscaledZ,tileSize:this.tileSize*p.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:p.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,lut:null,maxZoom:null,promoteId:null,pixelRatio:null,scaleFactor:null};if(p.actor&&p.state!=="expired")if(p.state==="loading")p.reloadCallback=r;else{if(p.buckets){const T=Object.values(p.buckets);for(const I of T)I.dirty=!0;return void(p.state="loaded")}p.request=p.actor.send("reloadTile",m,w.bind(this))}else p.actor=this.dispatcher.getActor(),p.request=p.actor.send("loadTile",m,w.bind(this),void 0,!0);function w(T,I){return p.aborted?r(null):T&&T.status!==404?r(T):(this.map._refreshExpiredTiles&&I&&p.setExpiryData(I),p.loadModelData(I,this.map.painter),p.state="loaded",void r(null))}}serialize(){return i.l({},this._options)}},canvas:class extends i.aJ{constructor(p,r,l,m){super(p,r,l,m),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(w=>!Array.isArray(w)||w.length!==2||w.some(T=>typeof T!="number"))||this.fire(new i.y(new i.V(`sources.${p}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.y(new i.V(`sources.${p}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new i.y(new i.V(`sources.${p}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof HTMLCanvasElement||this.fire(new i.y(new i.V(`sources.${p}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.y(new i.V(`sources.${p}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.y(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(p){this.map=p,this.load(),this.canvas&&this.animate&&this.play()}onRemove(p){this.pause()}prepare(){let p=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,p=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,p=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context;this.texture?!p&&!this._playing||this.texture instanceof i.aL||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.T(r,this.canvas,r.gl.RGBA8,{premultiply:!0}),this._prepareData(r)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const p of[this.canvas.width,this.canvas.height])if(isNaN(p)||p<=0)return!0;return!1}},custom:class extends i.E{constructor(p,r,l,m){super(),this.id=p,this.type="custom",this._dataType="raster",this._dispatcher=l,this._implementation=r,this.setEventedParent(m),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new i.y(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new i.y(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Nr(this._implementation.bounds,this.minzoom,this.maxzoom)),r.update=this._update.bind(this),r.clearTiles=this._clearTiles.bind(this),r.coveringTiles=this._coveringTiles.bind(this),i.l(this,i.ay(r,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return i.ay(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(p){this.map=p,this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(p),this.load()}onRemove(p){this._implementation.onRemove&&this._implementation.onRemove(p)}hasTile(p){if(this._implementation.hasTile){const{x:r,y:l,z:m}=p.canonical;return this._implementation.hasTile({x:r,y:l,z:m})}return!this.tileBounds||this.tileBounds.contains(p.canonical)}loadTile(p,r){const{x:l,y:m,z:w}=p.tileID.canonical,T=new AbortController;p.request=Promise.resolve(this._implementation.loadTile({x:l,y:m,z:w},{signal:T.signal})).then((function(I){return delete p.request,p.aborted?(p.state="unloaded",r(null)):I===void 0?(p.state="errored",r(null)):I===null?(this.loadTileData(p,{width:this.tileSize,height:this.tileSize,data:null}),p.state="loaded",r(null)):function(N){return N instanceof ImageData||N instanceof HTMLCanvasElement||N instanceof ImageBitmap||N instanceof HTMLImageElement}(I)?(this.loadTileData(p,I),p.state="loaded",void r(null)):(p.state="errored",r(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(I=>{I.code!==20&&(p.state="errored",r(I))}),p.request.cancel=()=>T.abort()}loadTileData(p,r){p.setTexture(r,this.map.painter)}unloadTile(p,r){if(p.texture&&p.texture instanceof i.T?(p.destroy(!0),p.texture&&p.texture instanceof i.T&&this.map.painter.saveTileTexture(p.texture)):p.destroy(),this._implementation.unloadTile){const{x:l,y:m,z:w}=p.tileID.canonical;this._implementation.unloadTile({x:l,y:m,z:w})}r&&r()}abortTile(p,r){p.request&&p.request.cancel&&(p.request.cancel(),delete p.request),r&&r()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(p=>({x:p.canonical.x,y:p.canonical.y,z:p.canonical.z}))}_clearTiles(){const p=i.aC(this.id,this.scope);this.map.style.clearSource(p)}_update(){this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}}},Vi=function(p,r,l,m){const w=new Ri[r.type](p,r,l,m);if(w.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${w.id}`);return i.aP(["load","abort","unload","serialize","prepare"],w),w};function Au(p,r,l=""){return`${l}:${r.id||""}:${r.layer.id}:${function(m){if("layerId"in m)return`layer:${m.layerId}`;{const{featuresetId:w,importId:T}=m;return`featureset:${w}${T?`:import:${T}`:""}`}}(p.target)}`}function rl(p,r,l,m=""){if(p.uniqueFeatureID){const w=Au(p,r,m);if(l.has(w))return!0;l.add(w)}return!1}function Ns(p,r,l,m,w=!1){const T=r.sourceCache.transform,I=r.sourceCache.tilesIn(p,r.has3DLayers,w);I.sort(Lh);const N=[];for(const G of I){const X=G.tile.queryRenderedFeatures(r,G,l,m,T,w);Object.keys(X).length&&N.push({wrappedTileID:G.tile.tileID.wrapped().key,queryResults:X})}return N.length===0?{}:function(G){const X={},Z={};for(const J of G){const Q=J.queryResults,ae=J.wrappedTileID,ye=Z[ae]=Z[ae]||{};for(const fe in Q){const be=Q[fe],_e=ye[fe]=ye[fe]||{},Ce=X[fe]=X[fe]||[];for(const ze of be)_e[ze.featureIndex]||(_e[ze.featureIndex]=!0,Ce.push(ze))}}return X}(N)}function us(p,r,l,m,w){const T={},I=m.queryRenderedSymbols(p),N=[];for(const G of Object.keys(I).map(Number))N.push(w[G]);N.sort(Lh);for(const G of N){const X=G.featureIndex.lookupSymbolFeatures(I[G.bucketInstanceId],G.bucketIndex,G.sourceLayerIndex,r,l);for(const Z in X){const J=T[Z]=T[Z]||[],Q=X[Z];Q.sort((ae,ye)=>{const fe=G.featureSortOrder;if(fe){const be=fe.indexOf(ae.featureIndex);return fe.indexOf(ye.featureIndex)-be}return ye.featureIndex-ae.featureIndex});for(const ae of Q)J.push(ae)}}return T}function cs(p,r){const l=p.getRenderableIds().map(T=>p.getTileByID(T)),m=[],w={};for(let T=0;T<l.length;T++){const I=l[T],N=I.tileID.canonical.key;w[N]||(w[N]=!0,I.querySourceFeatures(m,r))}return m}function Lh(p,r){const l=p.tileID,m=r.tileID;return l.overscaledZ-m.overscaledZ||l.canonical.y-m.canonical.y||l.wrap-m.wrap||l.canonical.x-m.canonical.x}function Na(p,r){const l={};if(!r)return l;for(const m of p){const w=m.layerIds.map(T=>r.getLayer(T)).filter(Boolean);if(w.length!==0){m.layers=w,m.stateDependentLayerIds&&(m.stateDependentLayers=m.stateDependentLayerIds.map(T=>w.filter(I=>I.id===T)[0]));for(const T of w)l[T.fqid]=m}}return l}const Ha=32,hs=33,Bs=new Uint16Array(8184);for(let p=0;p<2046;p++){let r=p+2,l=0,m=0,w=0,T=0,I=0,N=0;for(1&r?w=T=I=Ha:l=m=N=Ha;(r>>=1)>1;){const X=l+w>>1,Z=m+T>>1;1&r?(w=l,T=m,l=I,m=N):(l=w,m=T,w=I,T=N),I=X,N=Z}const G=4*p;Bs[G+0]=l,Bs[G+1]=m,Bs[G+2]=w,Bs[G+3]=T}const Mo=new Uint16Array(2178),Wo=new Uint8Array(1089),Oo=new Uint16Array(1089);function il(p){return p===0?-.03125:p===32?.03125:0}const Gf={type:2,extent:i.ag,loadGeometry:()=>[[new i.P(0,0),new i.P(i.ag+1,0),new i.P(i.ag+1,i.ag+1),new i.P(0,i.ag+1),new i.P(0,0)]]};class al{constructor(r,l,m,w,T){this.tileID=r,this.uid=i.aV(),this.uses=0,this.tileSize=l,this.tileZoom=m,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=T,w&&w.style&&(this._lastUpdatedBrightness=w.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",w&&w.transform&&(this.projection=w.transform.projection)}registerFadeDuration(r){const l=r+this.timeAdded;l<i.q.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=i.aQ(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(r,l,m){if(this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=Na(r.buckets,l.style),this.hasSymbolBuckets=!1;for(const w in this.buckets){const T=this.buckets[w];if(T instanceof i.aX){if(this.hasSymbolBuckets=!0,!m)break;T.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const w in this.buckets){const T=this.buckets[w];if(T instanceof i.aX&&T.hasRTLText){this.hasRTLText=!0,i.aY();break}}this.queryPadding=0;for(const w in this.buckets){const T=this.buckets[w],I=l.style.getOwnLayer(w);if(!I)continue;const N=I.queryRadius(T);this.queryPadding=Math.max(this.queryPadding,N)}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage),r.lineAtlas&&(this.lineAtlas=r.lineAtlas),this._lastUpdatedBrightness=r.brightness}else this.collisionBoxArray=new i.aW}unloadVectorData(){if(this.hasData()){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(r,l,m){r&&(r.resourceTiming&&(this.resourceTiming=r.resourceTiming),this.buckets=Object.assign({},this.buckets,Na(r.buckets,l.style)),r.featureIndex&&(this.latestFeatureIndex=r.featureIndex))}getBucket(r){return this.buckets[r.fqid]}upload(r){for(const w in this.buckets){const T=this.buckets[w];T.uploadPending()&&T.upload(r)}const l=r.gl,m=this.imageAtlas;if(m&&!m.uploaded){const w=!!Object.keys(m.patternPositions).length;this.imageAtlasTexture=new i.T(r,m.image,l.RGBA8,{useMipmap:w}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new i.T(r,this.glyphAtlasImage,l.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new i.T(r,this.lineAtlas.image,l.R8),this.lineAtlas.uploaded=!0)}prepare(r,l,m){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture,m),!l||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const w=l.style.getBrightness();(this._lastUpdatedBrightness||w)&&(this._lastUpdatedBrightness&&w&&Math.abs(this._lastUpdatedBrightness-w)<.001||(this.updateBuckets(l,this._lastUpdatedBrightness!==w),this._lastUpdatedBrightness=w))}queryRenderedFeatures(r,l,m,w,T,I){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const N=function(G,X){const Z=i.ab.mat4.fromScaling([],[.5*G.width,.5*-G.height,1]);return i.ab.mat4.translate(Z,Z,[1,-1,0]),i.ab.mat4.multiply(Z,Z,G.calculateProjMatrix(X.toUnwrapped())),Float32Array.from(Z)}(T,this.tileID);return this.latestFeatureIndex.query(r,{tilespaceGeometry:l,pixelPosMatrix:N,transform:w,availableImages:m,tileTransform:this.tileTransform})}querySourceFeatures(r,l){const m=this.latestFeatureIndex;if(!m||!m.rawTileData)return;const w=m.loadVTLayers(),T=l?l.sourceLayer:"",I=w._geojsonTileLayer||w[T];if(!I)return;const N=i.aZ(l&&l.filter),{z:G,x:X,y:Z}=this.tileID.canonical,J={z:G,x:X,y:Z};for(let Q=0;Q<I.length;Q++){const ae=I.feature(Q);if(N.needGeometry){const be=i.a_(ae,!0);if(!N.filter(new i.a8(this.tileID.overscaledZ),be,this.tileID.canonical))continue}else if(!N.filter(new i.a8(this.tileID.overscaledZ),ae))continue;const ye=m.getId(ae,T),fe=new i.a$(ae,G,X,Z,ye);fe.tile=J,r.push(fe)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const l=this.expirationTime;if(r.cacheControl){const m=i.b0(r.cacheControl);m["max-age"]&&(this.expirationTime=Date.now()+1e3*m["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const m=Date.now();let w=!1;if(this.expirationTime>m)w=!1;else if(l)if(this.expirationTime<l)w=!0;else{const T=this.expirationTime-l;T?this.expirationTime=m+Math.max(T,3e4):w=!0}else w=!0;w?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(r){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&r&&this.updateBuckets(r)}updateBuckets(r,l){if(!this.latestFeatureIndex||!r.style)return;const m=this.latestFeatureIndex.loadVTLayers(),w=r.style.listImages(),T=r.style.getBrightness();for(const I in this.buckets){if(!r.style.hasLayer(I))continue;const N=this.buckets[I],G=N.layers[0],X=G.sourceLayer||"_geojsonTileLayer",Z=m[X],J=r.style.getLayerSourceCache(G);let Q={};J&&(Q=J._state.getState(X,void 0));const ae=this.imageAtlas&&this.imageAtlas.patternPositions||{},ye=Object.keys(Q).length>0&&!l;ye&&!N.stateDependentLayers.length&&!l||N.update(Q,Z,w,ae,ye?N.stateDependentLayers:N.layers,l,T),(N instanceof i.b1||N instanceof i.b2)&&r._terrain&&r._terrain.enabled&&J&&N.programConfigurations.needsUpload&&r._terrain._clearRenderCacheForTile(J.id,this.tileID);const fe=r&&r.style&&r.style.getOwnLayer(I);fe&&(this.queryPadding=Math.max(this.queryPadding,fe.queryRadius(N)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<i.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=i.q.now()+r}setTexture(r,l){const m=l.context,w=m.gl;this.texture=this.texture||l.getTileTexture(r.width),this.texture&&this.texture instanceof i.T?this.texture.update(r):(this.texture=new i.T(m,r,w.RGBA8,{useMipmap:!0}),this.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE))}setDependencies(r,l){const m={};for(const w of l)m[w]=!0;this.dependencies[r]=m}hasDependency(r,l){for(const m of r){const w=this.dependencies[m];if(w){for(const T of l)if(w[T])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(r,l){if(!l||l.name==="mercator"||this._tileDebugBuffer)return;const m=i.b3(Gf,this.tileID.canonical,this.tileTransform)[0],w=new i.b4,T=new i.b5;for(let I=0;I<m.length;I++){const{x:N,y:G}=m[I];w.emplaceBack(N,G),T.emplaceBack(I)}T.emplaceBack(0),this._tileDebugIndexBuffer=r.createIndexBuffer(T),this._tileDebugBuffer=r.createVertexBuffer(w,i.b6.members),this._tileDebugSegments=i.b7.simpleSegment(0,0,w.length,T.length)}_makeTileBoundsBuffers(r,l){if(this._tileBoundsBuffer||!l||l.name==="mercator")return;const m=i.b3(Gf,this.tileID.canonical,this.tileTransform)[0];let w,T;if(this.isRaster){const I=function(N,G){const X=i.aQ(N,G),Z=Math.pow(2,N.z);for(let be=0;be<hs;be++)for(let _e=0;_e<hs;_e++){const Ce=i.aR((N.x+(_e+il(_e))/Ha)/Z),ze=i.aS((N.y+(be+il(be))/Ha)/Z),De=G.project(Ce,ze),$e=be*hs+_e;Mo[2*$e+0]=Math.round((De.x*X.scale-X.x)*i.ag),Mo[2*$e+1]=Math.round((De.y*X.scale-X.y)*i.ag)}Wo.fill(0),Oo.fill(0);for(let be=2045;be>=0;be--){const _e=4*be,Ce=Bs[_e+0],ze=Bs[_e+1],De=Bs[_e+2],$e=Bs[_e+3],je=Ce+De>>1,Ve=ze+$e>>1,Ue=je+Ve-ze,Qe=Ve+Ce-je,at=ze*hs+Ce,St=$e*hs+De,yt=Ve*hs+je,jt=Math.hypot((Mo[2*at+0]+Mo[2*St+0])/2-Mo[2*yt+0],(Mo[2*at+1]+Mo[2*St+1])/2-Mo[2*yt+1])>=16;Wo[yt]=Wo[yt]||(jt?1:0),be<1022&&(Wo[yt]=Wo[yt]||Wo[(ze+Qe>>1)*hs+(Ce+Ue>>1)]||Wo[($e+Qe>>1)*hs+(De+Ue>>1)])}const J=new i.aT,Q=new i.aU;let ae=0;function ye(be,_e){const Ce=_e*hs+be;return Oo[Ce]===0&&(J.emplaceBack(Mo[2*Ce+0],Mo[2*Ce+1],be*i.ag/Ha,_e*i.ag/Ha),Oo[Ce]=++ae),Oo[Ce]-1}function fe(be,_e,Ce,ze,De,$e){const je=be+Ce>>1,Ve=_e+ze>>1;if(Math.abs(be-De)+Math.abs(_e-$e)>1&&Wo[Ve*hs+je])fe(De,$e,be,_e,je,Ve),fe(Ce,ze,De,$e,je,Ve);else{const Ue=ye(be,_e),Qe=ye(Ce,ze),at=ye(De,$e);Q.emplaceBack(Ue,Qe,at)}}return fe(0,0,Ha,Ha,Ha,0),fe(Ha,Ha,0,0,0,Ha),{vertices:J,indices:Q}}(this.tileID.canonical,l);w=I.vertices,T=I.indices}else{w=new i.aT,T=new i.aU;for(const{x:N,y:G}of m)w.emplaceBack(N,G,0,0);const I=i.b8(w.int16,void 0,4);for(let N=0;N<I.length;N+=3)T.emplaceBack(I[N],I[N+1],I[N+2])}this._tileBoundsBuffer=r.createVertexBuffer(w,i.b9.members),this._tileBoundsIndexBuffer=r.createIndexBuffer(T),this._tileBoundsSegments=i.b7.simpleSegment(0,0,w.length,T.length)}_makeGlobeTileDebugBuffers(r,l){const m=l.projection;if(!m||m.name!=="globe"||l.freezeTileCoverage)return;const w=this.tileID.canonical,T=i.ba(w,l),I=i.bb(T),N=i.ae(l.zoom);let G;N>0&&(G=i.ab.mat4.invert(new Float64Array(16),l.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(r,w,l,I,G,N),this._makeGlobeTileDebugTextBuffer(r,w,l,I,G,N)}_globePoint(r,l,m,w,T,I,N){let G=i.bc(r,l,m);if(I){const X=1<<m.z,Z=i.at(w.center.lng),J=i.aA(w.center.lat),Q=(m.x+.5)/X-Z;let ae=0;Q>.5?ae=-1:Q<-.5&&(ae=1);let ye=(r/i.ag+m.x)/X+ae,fe=(l/i.ag+m.y)/X;ye=(ye-Z)*w._pixelsPerMercatorPixel+Z,fe=(fe-J)*w._pixelsPerMercatorPixel+J;const be=[ye*w.worldSize,fe*w.worldSize,0];i.ab.vec3.transformMat4(be,be,I),G=i.bd(G,be,N)}return i.ab.vec3.transformMat4(G,G,T)}_makeGlobeTileDebugBorderBuffer(r,l,m,w,T,I){const N=new i.b4,G=new i.b5,X=new i.be,Z=(Q,ae,ye,fe,be)=>{const _e=(ye-Q)/(be-1),Ce=(fe-ae)/(be-1),ze=N.length;for(let De=0;De<be;De++){const $e=Q+De*_e,je=ae+De*Ce;N.emplaceBack($e,je);const Ve=this._globePoint($e,je,l,m,w,T,I);X.emplaceBack(Ve[0],Ve[1],Ve[2]),G.emplaceBack(ze+De)}},J=i.ag;Z(0,0,J,0,16),Z(J,0,J,J,16),Z(J,J,0,J,16),Z(0,J,0,0,16),this._tileDebugIndexBuffer=r.createIndexBuffer(G),this._tileDebugBuffer=r.createVertexBuffer(N,i.b6.members),this._globeTileDebugBorderBuffer=r.createVertexBuffer(X,i.bf.members),this._tileDebugSegments=i.b7.simpleSegment(0,0,N.length,G.length)}_makeGlobeTileDebugTextBuffer(r,l,m,w,T,I){const N=i.ag/4,G=new i.b4,X=new i.aU,Z=new i.be,J=25;X.reserve(32),G.reserve(J),Z.reserve(J);const Q=(ae,ye)=>J*ae+ye;for(let ae=0;ae<J;ae++){const ye=ae*N;for(let fe=0;fe<J;fe++){const be=fe*N;G.emplaceBack(be,ye);const _e=this._globePoint(be,ye,l,m,w,T,I);Z.emplaceBack(_e[0],_e[1],_e[2])}}for(let ae=0;ae<4;ae++)for(let ye=0;ye<4;ye++){const fe=Q(ae,ye),be=Q(ae,ye+1),_e=Q(ae+1,ye),Ce=Q(ae+1,ye+1);X.emplaceBack(fe,be,_e),X.emplaceBack(_e,be,Ce)}this._tileDebugTextIndexBuffer=r.createIndexBuffer(X),this._tileDebugTextBuffer=r.createVertexBuffer(G,i.b6.members),this._globeTileDebugTextBuffer=r.createVertexBuffer(Z,i.bf.members),this._tileDebugTextSegments=i.b7.simpleSegment(0,0,J,32)}destroy(r=!1){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!r&&this.texture&&this.texture instanceof i.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}i.bg.setPbf(i.bh);class Ol extends al{constructor(r,l,m,w,T){super(r,l,m,w,T),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(r,l){const m=l.context,w=m.gl;this.texture=this.texture||l.getTileTexture(r.width),this.texture&&this.texture instanceof i.T?this.texture.update(r,{premultiply:!1}):this.texture=new i.T(m,r,w.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(r=16384,l){const m=this._mrt=new i.bg(30),w=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(r-1)}});return this.entireBuffer=null,this.request=i.bi(w,(T,I,N,G)=>{if(T)l(T);else try{const X=m.getHeaderLength(I);if(X>r)return void(this.request=this.fetchHeader(X,l));m.parseHeader(I),this._isHeaderLoaded=!0;let Z=0;for(const J of Object.values(m.layers))Z=Math.max(Z,J.dataIndex[J.dataIndex.length-1].last_byte);I.byteLength>=Z&&(this.entireBuffer=I),l(null,this.entireBuffer||I,N,G)}catch(X){l(X)}}),this.request}fetchBand(r,l,m){const w=this._mrt;if(!this._isHeaderLoaded||!w)return void m(new Error("Tile header is not ready"));const T=this.actor;if(!T)return void m(new Error("Can't fetch tile band without an actor"));let I;const N=(J,Q)=>{I.complete(J,Q),J?m(J):(this.updateTextureDescriptor(r,l),m(null,this.textureDescriptor&&this.textureDescriptor.img))},G=(J,Q)=>{if(J)return m(J);const ae=T.send("decodeRasterArray",{buffer:Q,task:I},N,void 0,!0);this._workQueue.push(()=>{ae&&ae.cancel(),I.cancel()})},X=w.getLayer(r);if(!X)return void m(new Error(`Unknown sourceLayer "${r}"`));if(X.hasDataForBand(l))return this.updateTextureDescriptor(r,l),void m(null,this.textureDescriptor?this.textureDescriptor.img:null);const Z=X.getDataRange([l]);if(I=w.createDecodingTask(Z),!I||I.tasks.length)if(this.flushQueues(),this.entireBuffer)G(null,this.entireBuffer.slice(Z.firstByte,Z.lastByte+1));else{const J=Object.assign({},this.requestParams,{headers:{Range:`bytes=${Z.firstByte}-${Z.lastByte}`}}),Q=i.bi(J,G);this._fetchQueue.push(()=>{Q.cancel(),I.cancel()})}else m(null)}updateNeeded(r,l){return(!this.textureDescriptor||this.textureDescriptor.band!==l||this.textureDescriptor.layer!==r)&&this.state!=="errored"}updateTextureDescriptor(r,l){if(!this._mrt)return;const m=this._mrt.getLayer(r);if(!m||!m.hasBand(l)||!m.hasDataForBand(l))return;const{bytes:w,tileSize:T,buffer:I,offset:N,scale:G}=m.getBandView(l),X=T+2*I,Z={data:w,width:X,height:X},J=this.texture;J&&J instanceof i.T&&J.update(Z,{premultiply:!1}),this.textureDescriptor={layer:r,band:l,img:Z,buffer:I,offset:N,tileSize:T,format:m.pixelFormat,mix:[G,256*G,65536*G,16777216*G]}}}class nc{constructor(r,l){this.max=r,this.onRemove=l,this.reset()}reset(){for(const r in this.data)for(const l of this.data[r])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(r,l,m){const w=r.wrapped().key;this.data[w]===void 0&&(this.data[w]=[]);const T={value:l,timeout:void 0};if(m!==void 0&&(T.timeout=setTimeout(()=>{this.remove(r,T)},m)),this.data[w].push(T),this.order.push(w),this.order.length>this.max){const I=this._getAndRemoveByKey(this.order[0]);I&&this.onRemove(I)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const l=this.data[r].shift();return l.timeout&&clearTimeout(l.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),l.value}getByKey(r){const l=this.data[r];return l?l[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,l){if(!this.has(r))return this;const m=r.wrapped().key,w=l===void 0?0:this.data[m].indexOf(l),T=this.data[m][w];return this.data[m].splice(w,1),T.timeout&&clearTimeout(T.timeout),this.data[m].length===0&&delete this.data[m],this.onRemove(T.value),this.order.splice(this.order.indexOf(m),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(r){const l=[];for(const m in this.data)for(const w of this.data[m])r(w.value)||l.push(w);for(const m of l)this.remove(m.value.tileID,m)}}class Hi{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,l,m){const w=String(l);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][w]=this.stateChanges[r][w]||{},i.l(this.stateChanges[r][w],m),this.deletedStates[r]===null){this.deletedStates[r]={};for(const T in this.state[r])T!==w&&(this.deletedStates[r][T]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][w]===null){this.deletedStates[r][w]={};for(const T in this.state[r][w])m[T]||(this.deletedStates[r][w][T]=null)}else for(const T in m)this.deletedStates[r]&&this.deletedStates[r][w]&&this.deletedStates[r][w][T]===null&&delete this.deletedStates[r][w][T]}removeFeatureState(r,l,m){if(this.deletedStates[r]===null)return;const w=String(l);if(this.deletedStates[r]=this.deletedStates[r]||{},m&&l!==void 0)this.deletedStates[r][w]!==null&&(this.deletedStates[r][w]=this.deletedStates[r][w]||{},this.deletedStates[r][w][m]=null);else if(l!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][w])for(m in this.deletedStates[r][w]={},this.stateChanges[r][w])this.deletedStates[r][w][m]=null;else this.deletedStates[r][w]=null;else this.deletedStates[r]=null}getState(r,l){const m=this.state[r]||{},w=this.stateChanges[r]||{},T=this.deletedStates[r];if(T===null)return{};if(l!==void 0){const N=String(l),G=i.l({},m[N],w[N]);if(T){const X=T[l];if(X===null)return{};for(const Z in X)delete G[Z]}return G}const I=i.l({},m,w);if(T)for(const N in T)delete I[N];return I}initializeTileState(r,l){r.refreshFeatureState(l)}coalesceChanges(r,l){const m={};for(const w in this.stateChanges){this.state[w]=this.state[w]||{};const T={};for(const I in this.stateChanges[w])this.state[w][I]||(this.state[w][I]={}),i.l(this.state[w][I],this.stateChanges[w][I]),T[I]=this.state[w][I];m[w]=T}for(const w in this.deletedStates){this.state[w]=this.state[w]||{};const T={};if(this.deletedStates[w]===null)for(const I in this.state[w])T[I]={},this.state[w][I]={};else for(const I in this.deletedStates[w]){if(this.deletedStates[w][I]===null)this.state[w][I]={};else if(this.state[w][I])for(const N of Object.keys(this.deletedStates[w][I]))delete this.state[w][I][N];T[I]=this.state[w][I]}m[w]=m[w]||{},i.l(m[w],T)}if(this.stateChanges={},this.deletedStates={},Object.keys(m).length!==0)for(const w in r)r[w].refreshFeatureState(l)}}class Xa extends i.E{constructor(r,l,m){super(),this.id=r,this._onlySymbols=m,l.on("data",w=>{w.dataType==="source"&&w.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&w.dataType==="source"&&w.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),l.on("error",()=>{this._sourceErrored=!0}),this._source=l,this._tiles={},this._cache=new nc(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=l.minTileCacheSize,this._maxTileCacheSize=l.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Hi,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(r){this.map=r,this._minTileCacheSize=this._minTileCacheSize===void 0&&r?r._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&r?r._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const r in this._tiles){const l=this._tiles[r];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(r,l){return r.isSymbolTile=this._onlySymbols,r.isExtraShadowCaster=this._shadowCasterTiles[r.tileID.key],this._source.loadTile(r,l)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r)}_abortTile(r){if(this._source.abortTile)return this._source.abortTile(r)}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const m=this._tiles[l];m.upload(r),m.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return i.bj(this._tiles).map(r=>r.tileID).sort(Vr).map(r=>r.key)}getRenderableIds(r,l){const m=[];for(const w in this._tiles)this._isIdRenderable(+w,r,l)&&m.push(this._tiles[w]);return r?m.sort((w,T)=>{const I=w.tileID,N=T.tileID,G=new i.P(I.canonical.x,I.canonical.y)._rotate(this.transform.angle),X=new i.P(N.canonical.x,N.canonical.y)._rotate(this.transform.angle);return I.overscaledZ-N.overscaledZ||X.y-G.y||X.x-G.x}).map(w=>w.tileID.key):m.map(w=>w.tileID).sort(Vr).map(w=>w.key)}hasRenderableParent(r){const l=this.findLoadedParent(r,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(r,l,m){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(l||!this._tiles[r].holdingForFade())&&(m||!this._shadowCasterTiles[r])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(+r,"reloading")}}_reloadTile(r,l){const m=this._tiles[r];m&&(m.state!=="loading"&&(m.state=l),this._loadTile(m,this._tileLoaded.bind(this,m,r,l)))}_tileLoaded(r,l,m,w){if(w)if(r.state="errored",w.status!==404)this._source.fire(new i.y(w,{tile:r}));else{if(this._source.fire(new i.z("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:r})),!(r.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const T=this.map.painter.terrain;this.update(this.transform,T.getScaledDemTileSize(),!0),T.resetTileLookupCache(this.id)}else this.update(this.transform)}else r.timeAdded=i.q.now(),m==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(l,r),this._source.type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),this._source.fire(new i.z("data",{dataType:"source",tile:r,coord:r.tileID,sourceCacheId:this.id}))}_backfillDEM(r){const l=this.getRenderableIds();for(let w=0;w<l.length;w++){const T=l[w];if(r.neighboringTiles&&r.neighboringTiles[T]){const I=this.getTileByID(T);m(r,I),m(I,r)}}function m(w,T){if(!w.dem||w.dem.borderReady)return;w.needsHillshadePrepare=!0,w.needsDEMTextureUpload=!0;let I=T.tileID.canonical.x-w.tileID.canonical.x;const N=T.tileID.canonical.y-w.tileID.canonical.y,G=Math.pow(2,w.tileID.canonical.z),X=T.tileID.key;I===0&&N===0||Math.abs(N)>1||(Math.abs(I)>1&&(Math.abs(I+G)===1?I+=G:Math.abs(I-G)===1&&(I-=G)),T.dem&&w.dem&&(w.dem.backfillBorder(T.dem,I,N),w.neighboringTiles&&w.neighboringTiles[X]&&(w.neighboringTiles[X].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,l,m,w){for(const T in this._tiles){let I=this._tiles[T];if(w[T]||!I.hasData()||I.tileID.overscaledZ<=l||I.tileID.overscaledZ>m)continue;let N=I.tileID;for(;I&&I.tileID.overscaledZ>l+1;){const X=I.tileID.scaledTo(I.tileID.overscaledZ-1);I=this._tiles[X.key],I&&I.hasData()&&(N=X)}let G=N;for(;G.overscaledZ>l;)if(G=G.scaledTo(G.overscaledZ-1),r[G.key]){w[N.key]=N;break}}}findLoadedParent(r,l){if(r.key in this._loadedParentTiles){const m=this._loadedParentTiles[r.key];return m&&m.tileID.overscaledZ>=l?m:null}for(let m=r.overscaledZ-1;m>=l;m--){const w=r.scaledTo(m),T=this._getLoadedTile(w);if(T)return T}}_getLoadedTile(r){const l=this._tiles[r.key];return l&&l.hasData()?l:this._cache.getByKey(this._source.reparseOverscaled?r.wrapped().key:r.canonical.key)}updateCacheSize(r,l){l=l||this._source.tileSize;const m=Math.ceil(r.width/l)+1,w=Math.ceil(r.height/l)+1,T=Math.floor(m*w*5),I=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,T):T,N=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,I):I;this._cache.setMaxSize(N)}handleWrapJump(r){const l=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,l){const m={};for(const w in this._tiles){const T=this._tiles[w];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+l),m[T.tileID.key]=T}this._tiles=m;for(const w in this._timers)clearTimeout(this._timers[w]),delete this._timers[w];for(const w in this._tiles)this._setTileReloadTimer(+w,this._tiles[w])}}update(r,l,m,w){if(this.transform=r,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!m)return;this.updateCacheSize(r,l),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const T=this._source.type==="batched-model";let I,N=this._source.maxzoom;const G=this.map&&this.map.painter?this.map.painter._terrain:null;if(G&&G.sourceCache===this&&G.attenuationRange()){const J=G.attenuationRange()[0],Q=Math.floor(J)-Math.log2(G.getDemUpscale());N>Q&&(N=Q)}if(this.used||this.usedForTerrain){if(this._source.tileID)I=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(J=>new i.aG(J.canonical.z,J.wrap,J.canonical.z,J.canonical.x,J.canonical.y));else if(this.tileCoverLift!==0){const J=r.clone();J.tileCoverLift=this.tileCoverLift,I=J.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:N,roundZoom:this._source.roundZoom&&!m,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:T}),this._source.minzoom<=1&&r.projection.name==="globe"&&(I.push(new i.aG(1,0,1,0,0)),I.push(new i.aG(1,0,1,1,0)),I.push(new i.aG(1,0,1,0,1)),I.push(new i.aG(1,0,1,1,1)))}else if(I=r.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:N,roundZoom:this._source.roundZoom&&!m,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:T}),this._source.hasTile){const J=this._source.hasTile.bind(this._source);I=I.filter(Q=>J(Q))}}else I=[];if(I.length>0&&this.castsShadows&&w&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Mu(this._source.type)){const J=r.coveringZoomLevel({tileSize:l||this._source.tileSize,roundZoom:this._source.roundZoom&&!m}),Q=Math.min(J,this._source.maxzoom);if(T){const ae=r.extendTileCover(I,Q);for(const ye of ae)I.push(ye)}else{const ae=r.extendTileCover(I,Q,w);for(const ye of ae)this._shadowCasterTiles[ye.key]=!0,I.push(ye)}}const X=this._updateRetainedTiles(I);if(Mu(this._source.type)&&I.length!==0){const J={},Q={},ae=Object.keys(X);for(const fe of ae){const be=X[fe],_e=this._tiles[fe];if(!_e||_e.fadeEndTime&&_e.fadeEndTime<=i.q.now())continue;const Ce=this.findLoadedParent(be,Math.max(be.overscaledZ-Xa.maxOverzooming,this._source.minzoom));Ce&&(this._addTile(Ce.tileID),J[Ce.tileID.key]=Ce.tileID),Q[fe]=be}const ye=I[I.length-1].overscaledZ;for(const fe in this._tiles){const be=this._tiles[fe];if(X[fe]||!be.hasData())continue;let _e=be.tileID;for(;_e.overscaledZ>ye;){_e=_e.scaledTo(_e.overscaledZ-1);const Ce=this._tiles[_e.key];if(Ce&&Ce.hasData()&&Q[_e.key]){X[fe]=be.tileID;break}}}for(const fe in J)X[fe]||(this._coveredTiles[fe]=!0,X[fe]=J[fe])}for(const J in X)this._tiles[J].clearFadeHold();const Z=i.bk(this._tiles,X);for(const J of Z){const Q=this._tiles[J];Q.hasSymbolBuckets&&!Q.holdingForFade()?Q.setHoldDuration(this.map._fadeDuration):Q.hasSymbolBuckets&&!Q.symbolFadeFinished()||this._removeTile(+J)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(+r)}_updateRetainedTiles(r){const l={};if(r.length===0)return l;const m={},w=r.reduce((X,Z)=>Math.min(X,Z.overscaledZ),1/0),T=r[0].overscaledZ,I=Math.max(T-Xa.maxOverzooming,this._source.minzoom),N=Math.max(T+Xa.maxUnderzooming,this._source.minzoom),G={};for(const X of r){const Z=this._addTile(X);l[X.key]=X,Z.hasData()||w<this._source.maxzoom&&(G[X.key]=X)}this._retainLoadedChildren(G,w,N,l);for(const X of r){let Z=this._tiles[X.key];if(Z.hasData())continue;if(X.canonical.z>=this._source.maxzoom){const Q=X.children(this._source.maxzoom)[0],ae=this.getTile(Q);if(ae&&ae.hasData()){l[Q.key]=Q;continue}}else{const Q=X.children(this._source.maxzoom);if(l[Q[0].key]&&l[Q[1].key]&&l[Q[2].key]&&l[Q[3].key])continue}let J=Z.wasRequested();for(let Q=X.overscaledZ-1;Q>=I;--Q){const ae=X.scaledTo(Q);if(m[ae.key]||(m[ae.key]=!0,Z=this.getTile(ae),!Z&&J&&(Z=this._addTile(ae)),Z&&(l[ae.key]=ae,J=Z.wasRequested(),Z.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const l=[];let m,w=this._tiles[r].tileID;for(;w.overscaledZ>0;){if(w.key in this._loadedParentTiles){m=this._loadedParentTiles[w.key];break}l.push(w.key);const T=w.scaledTo(w.overscaledZ-1);if(m=this._getLoadedTile(T),m)break;w=T}for(const T of l)this._loadedParentTiles[T]=m}}_addTile(r){let l=this._tiles[r.key];if(l)return l.isExtraShadowCaster!==!0||this._shadowCasterTiles[r.key]||this._reloadTile(r.key,"reloading"),l;l=this._cache.getAndRemove(r),l&&(this._setTileReloadTimer(r.key,l),l.tileID=r,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,l)));const m=!!l;if(!m){const w=this.map?this.map.painter:null,T=this._source.tileSize*r.overscaleFactor();l=this._source.type==="raster-array"?new Ol(r,T,this.transform.tileZoom,w,this._isRaster):new al(r,T,this.transform.tileZoom,w,this._isRaster),this._loadTile(l,this._tileLoaded.bind(this,l,r.key,l.state))}return l?(l.uses++,this._tiles[r.key]=l,m||this._source.fire(new i.z("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null}_setTileReloadTimer(r,l){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const m=l.getExpiryTimeout();m&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},m))}_removeTile(r){const l=this._tiles[r];l&&(l.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),l.uses>0||(l.hasData()&&l.state!=="reloading"||l.state==="empty"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(+r);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(r,l,m){const w=[],T=this.transform;if(!T)return w;const I=T.projection.name==="globe",N=i.at(T.center.lng);for(const G in this._tiles){const X=this._tiles[G];if(m&&X.clearQueryDebugViz(),X.holdingForFade())continue;let Z;if(I){const J=X.tileID.canonical;if(J.z===0){const Q=[Math.abs(i.aw(N,...Nn(J,-1))-N),Math.abs(i.aw(N,...Nn(J,1))-N)];Z=[0,2*Q.indexOf(Math.min(...Q))-1]}else{const Q=[Math.abs(i.aw(N,...Nn(J,-1))-N),Math.abs(i.aw(N,...Nn(J,0))-N),Math.abs(i.aw(N,...Nn(J,1))-N)];Z=[Q.indexOf(Math.min(...Q))-1]}}else Z=[0];for(const J of Z){const Q=r.containsTile(X,T,l,J);Q&&w.push(Q)}}return w}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(r){return this._getRenderableCoordinates(r)}_getRenderableCoordinates(r,l){const m=this.getRenderableIds(r,l).map(T=>this._tiles[T].tileID),w=this.transform.projection.name==="globe";for(const T of m)T.projMatrix=this.transform.calculateProjMatrix(T.toUnwrapped()),T.expandedProjMatrix=w?this.transform.calculateProjMatrix(T.toUnwrapped(),!1,!0):T.projMatrix;return m}sortCoordinatesByDistance(r){const l=r.slice(),m=this.transform._camera.position,w=this.transform._camera.forward(),T={};for(const I of l){const N=1/(1<<I.canonical.z);T[I.key]=((I.canonical.x+.5)*N+I.wrap-m[0])*w[0]+((I.canonical.y+.5)*N-m[1])*w[1]-m[2]*w[2]}return l.sort((I,N)=>T[I.key]-T[N.key]),l}hasTransition(){if(this._source.hasTransition())return!0;if(Mu(this._source.type))for(const r in this._tiles){const l=this._tiles[r];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=i.q.now())return!0}return!1}setFeatureState(r,l,m){this._state.updateState(r=r||"_geojsonTileLayer",l,m)}removeFeatureState(r,l,m){this._state.removeFeatureState(r=r||"_geojsonTileLayer",l,m)}getFeatureState(r,l){return this._state.getState(r=r||"_geojsonTileLayer",l)}setDependencies(r,l,m){const w=this._tiles[r];w&&w.setDependencies(l,m)}reloadTilesForDependencies(r,l){for(const m in this._tiles)this._tiles[m].hasDependency(r,l)&&this._reloadTile(+m,"reloading");this._cache.filter(m=>!m.hasDependency(r,l))}_preloadTiles(r,l){if(!this._sourceLoaded){const G=()=>{this._sourceLoaded&&(this._source.off("data",G),this._preloadTiles(r,l))};return void this._source.on("data",G)}const m=new Map,w=Array.isArray(r)?r:[r],T=this.map.painter.terrain,I=this.usedForTerrain&&T?T.getScaledDemTileSize():this._source.tileSize;for(const G of w){const X=G.coveringTiles({tileSize:I,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const Z of X)m.set(Z.key,Z);this.usedForTerrain&&G.updateElevation(!1)}const N=Array.from(m.values());i.bl(N,(G,X)=>{const Z=new al(G,this._source.tileSize*G.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(Z,J=>{this._source.type==="raster-dem"&&Z.dem&&this._backfillDEM(Z),X(J,Z)})},l)}}function Vr(p,r){const l=Math.abs(2*p.wrap)-+(p.wrap<0),m=Math.abs(2*r.wrap)-+(r.wrap<0);return p.overscaledZ-r.overscaledZ||m-l||r.canonical.y-p.canonical.y||r.canonical.x-p.canonical.x}function Mu(p){return p==="raster"||p==="image"||p==="video"||p==="custom"}function Nn(p,r){const l=1<<p.z;return[p.x/l+r,(p.x+1)/l+r]}Xa.maxOverzooming=10,Xa.maxUnderzooming=3;class Ya{constructor(r){this.style=r,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const r=!1,l=!1;for(const m in this.style._mergedLayers){const w=this.style._mergedLayers[m];if(w.type==="fill-extrusion")this.layers.push({layer:w,visible:r,visibilityChanged:l});else if(w.type==="model"){const T=this.style.getLayerSource(w);T&&T.type==="batched-model"&&this.layers.push({layer:w,visible:r,visibilityChanged:l})}}}onNewFrame(r){this.layersGotHidden=!1;for(const l of this.layers){const m=l.layer;let w=!1;m.type==="fill-extrusion"?w=!m.isHidden(r)&&m.paint.get("fill-extrusion-opacity")>0:m.type==="model"&&(w=!m.isHidden(r)&&m.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!w&&l.visible,l.visible=w}}updateZOffset(r,l){this.currentBuildingBuckets=[];for(const w of this.layers){const T=w.layer,I=this.style.getLayerSourceCache(T);let N=1;T.type==="fill-extrusion"&&(N=w.visible?T.paint.get("fill-extrusion-vertical-scale"):0);let G=I?I.getTile(l):null;if(!G&&I&&l.canonical.z>I.getSource().minzoom){let X=l.scaledTo(Math.min(I.getSource().maxzoom,l.overscaledZ-1));for(;X.overscaledZ>=I.getSource().minzoom&&(G=I.getTile(X),!G&&X.overscaledZ!==0);)X=X.scaledTo(X.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:G?G.getBucket(T):null,tileID:G?G.tileID:l,verticalScale:N})}r.hasAnyZOffset=!1;let m=!1;for(let w=0;w<r.symbolInstances.length;w++){const T=r.symbolInstances.get(w),I=T.zOffset,N=this._getHeightAtTileOffset(l,T.tileAnchorX,T.tileAnchorY);T.zOffset=N!==Number.NEGATIVE_INFINITY?N:I,m||I===T.zOffset||(m=!0),r.hasAnyZOffset||T.zOffset===0||(r.hasAnyZOffset=!0)}m&&(r.zOffsetBuffersNeedUpload=!0,r.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(r,l,m,w){let T=l,I=m;if(r.canonical.z!==w.canonical.z){const N=w.canonical,G=1/(1<<r.canonical.z-N.z);T=(l+r.canonical.x*i.ag)*G-N.x*i.ag|0,I=(m+r.canonical.y*i.ag)*G-N.y*i.ag|0}return{tileX:T,tileY:I}}_getHeightAtTileOffset(r,l,m){let w,T;for(let I=0;I<this.layers.length;++I){if(this.layers[I].layer.type!=="fill-extrusion")continue;const{bucket:N,tileID:G,verticalScale:X}=this.currentBuildingBuckets[I];if(!N)continue;const{tileX:Z,tileY:J}=this._mapCoordToOverlappingTile(r,l,m,G),Q=N.getHeightAtTileCoord(Z,J);Q&&Q.height!==void 0&&(Q.hidden?w=Q.height:T=Math.max(Q.height*X,T||0))}if(T!==void 0)return T;for(let I=0;I<this.layers.length;++I){const N=this.layers[I];if(N.layer.type!=="model"||!N.visible)continue;const{bucket:G,tileID:X}=this.currentBuildingBuckets[I];if(!G)continue;const{tileX:Z,tileY:J}=this._mapCoordToOverlappingTile(r,l,m,X),Q=G.getHeightAtTileCoord(Z,J);if(Q&&!Q.hidden)return Q.height===void 0&&w!==void 0?Math.min(Q.maxHeight,w)*Q.verticalScale:Q.height?Q.height*Q.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function fs(p,r){const l={};for(const m in p)m!=="ref"&&(l[m]=p[m]);return i.bm.forEach(m=>{m in r&&(l[m]=r[m])}),l}function Yc(p){p=p.slice();const r=Object.create(null);for(let l=0;l<p.length;l++)r[p[l].id]=p[l];for(let l=0;l<p.length;l++)"ref"in p[l]&&(p[l]=fs(p[l],r[p[l].ref]));return p}const _r={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function rc(p,r,l){l.push({command:_r.addSource,args:[p,r[p]]})}function Lo(p,r,l){r.push({command:_r.removeSource,args:[p]}),l[p]=!0}function kn(p,r,l,m){Lo(p,l,m),rc(p,r,l)}function qr(p,r,l){let m;for(m in p[l])if(p[l].hasOwnProperty(m)&&m!=="data"&&!i.bn(p[l][m],r[l][m]))return!1;for(m in r[l])if(r[l].hasOwnProperty(m)&&m!=="data"&&!i.bn(p[l][m],r[l][m]))return!1;return!0}function Vn(p,r,l,m,w,T){let I;for(I in r=r||{},p=p||{})p.hasOwnProperty(I)&&(i.bn(p[I],r[I])||l.push({command:T,args:[m,I,r[I],w]}));for(I in r)r.hasOwnProperty(I)&&!p.hasOwnProperty(I)&&(i.bn(p[I],r[I])||l.push({command:T,args:[m,I,r[I],w]}))}function zi(p){return p.id}function zo(p,r){return p[r.id]=r,p}class Br{constructor(r,l){this.reset(r,l)}reset(r,l){this.points=r||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(l||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=i.aw(r,0,1);let l=1,m=this._distances[l];const w=r*this.paddedLength+this.padding;for(;m<w&&l<this._distances.length;)m=this._distances[++l];const T=l-1,I=this._distances[T],N=m-I,G=N>0?(w-I)/N:0;return this.points[T].mult(1-G).add(this.points[l].mult(G))}}class ds{constructor(r,l,m){const w=this.boxCells=[],T=this.circleCells=[];this.xCellCount=Math.ceil(r/m),this.yCellCount=Math.ceil(l/m);for(let I=0;I<this.xCellCount*this.yCellCount;I++)w.push([]),T.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=l,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,l,m,w,T){this._forEachCell(l,m,w,T,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(l),this.bboxes.push(m),this.bboxes.push(w),this.bboxes.push(T)}insertCircle(r,l,m,w){this._forEachCell(l-w,m-w,l+w,m+w,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(l),this.circles.push(m),this.circles.push(w)}_insertBoxCell(r,l,m,w,T,I){this.boxCells[T].push(I)}_insertCircleCell(r,l,m,w,T,I){this.circleCells[T].push(I)}_query(r,l,m,w,T,I){if(m<0||r>this.width||w<0||l>this.height)return!T&&[];const N=[];if(r<=0&&l<=0&&this.width<=m&&this.height<=w){if(T)return!0;for(let G=0;G<this.boxKeys.length;G++)N.push({key:this.boxKeys[G],x1:this.bboxes[4*G],y1:this.bboxes[4*G+1],x2:this.bboxes[4*G+2],y2:this.bboxes[4*G+3]});for(let G=0;G<this.circleKeys.length;G++){const X=this.circles[3*G],Z=this.circles[3*G+1],J=this.circles[3*G+2];N.push({key:this.circleKeys[G],x1:X-J,y1:Z-J,x2:X+J,y2:Z+J})}return I?N.filter(I):N}return this._forEachCell(r,l,m,w,this._queryCell,N,{hitTest:T,seenUids:{box:{},circle:{}}},I),T?N.length>0:N}_queryCircle(r,l,m,w,T){const I=r-m,N=r+m,G=l-m,X=l+m;if(N<0||I>this.width||X<0||G>this.height)return!w&&[];const Z=[];return this._forEachCell(I,G,N,X,this._queryCellCircle,Z,{hitTest:w,circle:{x:r,y:l,radius:m},seenUids:{box:{},circle:{}}},T),w?Z.length>0:Z}query(r,l,m,w,T){return this._query(r,l,m,w,!1,T)}hitTest(r,l,m,w,T){return this._query(r,l,m,w,!0,T)}hitTestCircle(r,l,m,w){return this._queryCircle(r,l,m,!0,w)}_queryCell(r,l,m,w,T,I,N,G){const X=N.seenUids,Z=this.boxCells[T];if(Z!==null){const Q=this.bboxes;for(const ae of Z)if(!X.box[ae]){X.box[ae]=!0;const ye=4*ae;if(r<=Q[ye+2]&&l<=Q[ye+3]&&m>=Q[ye+0]&&w>=Q[ye+1]&&(!G||G(this.boxKeys[ae]))){if(N.hitTest)return I.push(!0),!0;I.push({key:this.boxKeys[ae],x1:Q[ye],y1:Q[ye+1],x2:Q[ye+2],y2:Q[ye+3]})}}}const J=this.circleCells[T];if(J!==null){const Q=this.circles;for(const ae of J)if(!X.circle[ae]){X.circle[ae]=!0;const ye=3*ae;if(this._circleAndRectCollide(Q[ye],Q[ye+1],Q[ye+2],r,l,m,w)&&(!G||G(this.circleKeys[ae]))){if(N.hitTest)return I.push(!0),!0;{const fe=Q[ye],be=Q[ye+1],_e=Q[ye+2];I.push({key:this.circleKeys[ae],x1:fe-_e,y1:be-_e,x2:fe+_e,y2:be+_e})}}}}}_queryCellCircle(r,l,m,w,T,I,N,G){const X=N.circle,Z=N.seenUids,J=this.boxCells[T];if(J!==null){const ae=this.bboxes;for(const ye of J)if(!Z.box[ye]){Z.box[ye]=!0;const fe=4*ye;if(this._circleAndRectCollide(X.x,X.y,X.radius,ae[fe+0],ae[fe+1],ae[fe+2],ae[fe+3])&&(!G||G(this.boxKeys[ye])))return I.push(!0),!0}}const Q=this.circleCells[T];if(Q!==null){const ae=this.circles;for(const ye of Q)if(!Z.circle[ye]){Z.circle[ye]=!0;const fe=3*ye;if(this._circlesCollide(ae[fe],ae[fe+1],ae[fe+2],X.x,X.y,X.radius)&&(!G||G(this.circleKeys[ye])))return I.push(!0),!0}}}_forEachCell(r,l,m,w,T,I,N,G){const X=this._convertToXCellCoord(r),Z=this._convertToYCellCoord(l),J=this._convertToXCellCoord(m),Q=this._convertToYCellCoord(w);for(let ae=X;ae<=J;ae++)for(let ye=Z;ye<=Q;ye++)if(T.call(this,r,l,m,w,this.xCellCount*ye+ae,I,N,G))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,l,m,w,T,I){const N=w-r,G=T-l,X=m+I;return X*X>N*N+G*G}_circleAndRectCollide(r,l,m,w,T,I,N){const G=(I-w)/2,X=Math.abs(r-(w+G));if(X>G+m)return!1;const Z=(N-T)/2,J=Math.abs(l-(T+Z));if(J>Z+m)return!1;if(X<=G||J<=Z)return!0;const Q=X-G,ae=J-Z;return Q*Q+ae*ae<=m*m}}const No={unknown:0,flipRequired:1,flipNotRequired:2},Ta=Math.tan(85*Math.PI/180);function di(p,r,l,m,w,T,I){const N=i.ab.mat4.create();if(l)if(T.name==="globe"){const G=i.bo(w,r);i.ab.mat4.multiply(N,N,G)}else{const G=i.ab.mat2.invert([],I);N[0]=G[0],N[1]=G[1],N[4]=G[2],N[5]=G[3],m||i.ab.mat4.rotateZ(N,N,w.angle)}else i.ab.mat4.multiply(N,w.labelPlaneMatrix,p);return N}function ui(p,r,l,m,w,T,I){const N=di(p,r,l,m,w,T,I);return T.name==="globe"&&l||(N[2]=N[6]=N[10]=N[14]=0),N}function Ou(p,r,l,m,w,T,I){if(l){if(T.name==="globe"){const N=di(p,r,l,m,w,T,I);return i.ab.mat4.invert(N,N),i.ab.mat4.multiply(N,p,N),N}{const N=i.ab.mat4.clone(p),G=i.ab.mat4.identity([]);return G[0]=I[0],G[1]=I[1],G[4]=I[2],G[5]=I[3],i.ab.mat4.multiply(N,N,G),m||i.ab.mat4.rotateZ(N,N,-w.angle),N}}return w.glCoordMatrix}function Ea(p,r,l,m){const w=[p,r,l,1];l?i.ab.vec4.transformMat4(w,w,m):ro(w,w,m);const T=w[3];return w[0]/=T,w[1]/=T,w[2]/=T,w}function zh(p,r){return Math.min(.5+p/r*.5,1.5)}function Ql(p,r){const l=p[0]/p[3],m=p[1]/p[3];return l>=-r[0]&&l<=r[0]&&m>=-r[1]&&m<=r[1]}function Bo(p,r,l,m,w,T,I,N,G,X){const Z=l.transform,J=m?p.textSizeData:p.iconSizeData,Q=i.bp(J,l.transform.zoom),ae=Z.projection.name==="globe",ye=[256/l.width*2+1,256/l.height*2+1],fe=m?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;fe.clear();let be=null;ae&&(be=m?p.text.globeExtVertexArray:p.icon.globeExtVertexArray);const _e=p.lineVertexArray,Ce=m?p.text.placedSymbolArray:p.icon.placedSymbolArray,ze=l.transform.width/l.transform.height;let De,$e=!1;for(let je=0;je<Ce.length;je++){const Ve=Ce.get(je),{numGlyphs:Ue,writingMode:Qe}=Ve;if(Qe!==i.bq.vertical||$e||De===i.bq.horizontal||($e=!0),De=Qe,(Ve.hidden||Qe===i.bq.vertical)&&!$e){Oi(Ue,fe);continue}$e=!1;const at=new i.P(Ve.tileAnchorX,Ve.tileAnchorY);let{x:St,y:yt,z:jt}=Z.projection.projectTilePoint(at.x,at.y,X.canonical);if(G){const[Ut,tn,fn]=G(at);St+=Ut,yt+=tn,jt+=fn}const It=[St,yt,jt,1];if(i.ab.vec4.transformMat4(It,It,r),!Ql(It,ye)){Oi(Ue,fe);continue}const ft=It[3],At=zh(l.transform.getCameraToCenterDistance(Z.projection),ft),Qt=i.br(J,Q,Ve),ht=I?Qt/At:Qt*At,zt=Ea(St,yt,jt,w);if(zt[3]<=0){Oi(Ue,fe);continue}let Mt={};const ln=I?null:G,Yt=da(Ve,ht,!1,N,r,w,T,p.glyphOffsetArray,_e,fe,be,zt,at,Mt,ze,ln,Z.projection,X,I);$e=Yt.useVertical,ln&&Yt.needsFlipping&&(Mt={}),(Yt.notEnoughRoom||$e||Yt.needsFlipping&&da(Ve,ht,!0,N,r,w,T,p.glyphOffsetArray,_e,fe,be,zt,at,Mt,ze,ln,Z.projection,X,I).notEnoughRoom)&&Oi(Ue,fe)}m?(p.text.dynamicLayoutVertexBuffer.updateData(fe),be&&p.text.globeExtVertexBuffer&&p.text.globeExtVertexBuffer.updateData(be)):(p.icon.dynamicLayoutVertexBuffer.updateData(fe),be&&p.icon.globeExtVertexBuffer&&p.icon.globeExtVertexBuffer.updateData(be))}function ps(p,r,l,m,w,T,I,N,G,X,Z,J,Q,ae,ye,fe){const{lineStartIndex:be,glyphStartIndex:_e,segment:Ce}=N,ze=_e+N.numGlyphs,De=be+N.lineLength,$e=r.getoffsetX(_e),je=r.getoffsetX(ze-1),Ve=Fo(p*$e,l,m,w,T,I,Ce,be,De,G,X,Z,J,Q,!0,ae,ye,fe);if(!Ve)return null;const Ue=Fo(p*je,l,m,w,T,I,Ce,be,De,G,X,Z,J,Q,!0,ae,ye,fe);return Ue?{first:Ve,last:Ue}:null}function Aa(p,r,l,m){return p===i.bq.horizontal&&Math.abs(m)>Math.abs(l)?{useVertical:!0}:p===i.bq.vertical?m>0?{needsFlipping:!0}:null:r!==No.unknown&&function(w,T){return w===0||Math.abs(T/w)>Ta}(l,m)?r===No.flipRequired?{needsFlipping:!0}:null:l<0?{needsFlipping:!0}:null}function da(p,r,l,m,w,T,I,N,G,X,Z,J,Q,ae,ye,fe,be,_e,Ce){const ze=r/24,De=p.lineOffsetX*ze,$e=p.lineOffsetY*ze,{lineStartIndex:je,glyphStartIndex:Ve,numGlyphs:Ue,segment:Qe,writingMode:at,flipState:St}=p,yt=je+p.lineLength,jt=It=>{if(Z){const[ht,zt,Mt]=It.up,ln=X.length;i.bs(Z,ln+0,ht,zt,Mt),i.bs(Z,ln+1,ht,zt,Mt),i.bs(Z,ln+2,ht,zt,Mt),i.bs(Z,ln+3,ht,zt,Mt)}const[ft,At,Qt]=It.point;i.bt(X,ft,At,Qt,It.angle)};if(Ue>1){const It=ps(ze,N,De,$e,l,J,Q,p,G,T,ae,fe,!1,be,_e,Ce);if(!It)return{notEnoughRoom:!0};if(m&&!l){let[ft,At,Qt]=It.first.point,[ht,zt,Mt]=It.last.point;[ft,At]=Ea(ft,At,Qt,I),[ht,zt]=Ea(ht,zt,Mt,I);const ln=Aa(at,St,(ht-ft)*ye,zt-At);if(p.flipState=ln&&ln.needsFlipping?No.flipRequired:No.flipNotRequired,ln)return ln}jt(It.first);for(let ft=Ve+1;ft<Ve+Ue-1;ft++){const At=Fo(ze*N.getoffsetX(ft),De,$e,l,J,Q,Qe,je,yt,G,T,ae,fe,!1,!1,be,_e,Ce);if(!At)return X.length-=4*(ft-Ve),{notEnoughRoom:!0};jt(At)}jt(It.last)}else{if(m&&!l){const ft=Ea(Q.x,Q.y,0,w),At=je+Qe+1,Qt=new i.P(G.getx(At),G.gety(At)),ht=Ea(Qt.x,Qt.y,0,w),zt=ht[3]>0?ht:$f(Q,Qt,ft,1,w,void 0,be,_e.canonical),Mt=Aa(at,St,(zt[0]-ft[0])*ye,zt[1]-ft[1]);if(p.flipState=Mt&&Mt.needsFlipping?No.flipRequired:No.flipNotRequired,Mt)return Mt}const It=Fo(ze*N.getoffsetX(Ve),De,$e,l,J,Q,Qe,je,yt,G,T,ae,fe,!1,!1,be,_e,Ce);if(!It)return{notEnoughRoom:!0};jt(It)}return{}}function la(p,r,l,m,w){const{x:T,y:I,z:N}=m.projectTilePoint(p.x,p.y,r);if(!w)return Ea(T,I,N,l);const[G,X,Z]=w(p);return Ea(T+G,I+X,N+Z,l)}function $f(p,r,l,m,w,T,I,N){const G=la(p.sub(r)._unit()._add(p),N,w,I,T);return i.ab.vec3.sub(G,l,G),i.ab.vec3.normalize(G,G),i.ab.vec3.scaleAndAdd(G,l,G,m)}function Fo(p,r,l,m,w,T,I,N,G,X,Z,J,Q,ae,ye,fe,be,_e){const Ce=m?p-r:p+r;let ze=Ce>0?1:-1,De=0;m&&(ze*=-1,De=Math.PI),ze<0&&(De+=Math.PI);let $e=N+I+(ze>0?0:1)|0,je=w,Ve=w,Ue=0,Qe=0;const at=Math.abs(Ce),St=[],yt=[];let jt=T,It=jt;const ft=()=>$f(It,jt,Ve,at-Ue+1,Z,Q,fe,be.canonical);for(;Ue+Qe<=at;){if($e+=ze,$e<N||$e>=G)return null;if(Ve=je,It=jt,St.push(Ve),ae&&yt.push(It),jt=new i.P(X.getx($e),X.gety($e)),je=J[$e],!je){const tn=la(jt,be.canonical,Z,fe,Q);je=tn[3]>0?J[$e]=tn:ft()}Ue+=Qe,Qe=i.ab.vec3.distance(Ve,je)}ye&&Q&&(J[$e]&&(je=ft(),Qe=i.ab.vec3.distance(Ve,je)),J[$e]=je);const At=(at-Ue)/Qe,Qt=jt.sub(It)._mult(At)._add(It),ht=i.ab.vec3.sub([],je,Ve),zt=i.ab.vec3.scaleAndAdd([],Ve,ht,At);let Mt=[0,0,1],ln=ht[0],Yt=ht[1];if(_e&&(Mt=fe.upVector(be.canonical,Qt.x,Qt.y),Mt[0]!==0||Mt[1]!==0||Mt[2]!==1)){const tn=[Mt[2],0,-Mt[0]],fn=i.ab.vec3.cross([],Mt,tn);i.ab.vec3.normalize(tn,tn),i.ab.vec3.normalize(fn,fn),ln=i.ab.vec3.dot(ht,tn),Yt=i.ab.vec3.dot(ht,fn)}if(l){const tn=i.ab.vec3.cross([],Mt,ht);i.ab.vec3.normalize(tn,tn),i.ab.vec3.scaleAndAdd(zt,zt,tn,l*ze)}const Ut=De+Math.atan2(Yt,ln);return St.push(zt),ae&&yt.push(Qt),{point:zt,angle:Ut,path:St,tilePath:yt,up:Mt}}function Oi(p,r){const l=r.length,m=l+4*p;r.resize(m),r.float32.fill(-1/0,4*l,4*m)}function ro(p,r,l){const m=r[0],w=r[1];return p[0]=l[0]*m+l[4]*w+l[12],p[1]=l[1]*m+l[5]*w+l[13],p[3]=l[3]*m+l[7]*w+l[15],p}const Ba=100;class pi{constructor(r,l,m=new ds(r.width+200,r.height+200,25),w=new ds(r.width+200,r.height+200,25)){this.transform=r,this.grid=m,this.ignoredGrid=w,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+Ba,this.screenBottomBoundary=r.height+Ba,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=l}placeCollisionBox(r,l,m,w,T,I,N,G){let X=m.projectedAnchorX,Z=m.projectedAnchorY,J=m.projectedAnchorZ;const Q=m.elevation,ae=m.tileID,ye=r.getProjection();if(Q&&ae){const[je,Ve,Ue]=ye.upVector(ae.canonical,m.tileAnchorX,m.tileAnchorY),Qe=ye.upVectorScale(ae.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;X+=je*Q*Qe,Z+=Ve*Q*Qe,J+=Ue*Q*Qe}const fe=this.projectAndGetPerspectiveRatio(N,X,Z,J,m.tileID,ye.name==="globe"||!!Q||this.transform.pitch>0,ye),be=I*fe.perspectiveRatio,_e=(m.x1*l+w.x-m.padding)*be+fe.point.x,Ce=(m.y1*l+w.y-m.padding)*be+fe.point.y,ze=(m.x2*l+w.x+m.padding)*be+fe.point.x,De=(m.y2*l+w.y+m.padding)*be+fe.point.y,$e=fe.perspectiveRatio<=.55||fe.occluded;return!this.isInsideGrid(_e,Ce,ze,De)||!T&&this.grid.hitTest(_e,Ce,ze,De,G)||$e?{box:[],offscreen:!1,occluded:fe.occluded}:{box:[_e,Ce,ze,De],offscreen:this.isOffscreen(_e,Ce,ze,De),occluded:!1}}placeCollisionCircles(r,l,m,w,T,I,N,G,X,Z,J,Q,ae,ye,fe){const be=[],_e=this.transform.elevation,Ce=r.getProjection(),ze=_e?_e.getAtTileOffsetFunc(fe,this.transform.center.lat,this.transform.worldSize,Ce):null,De=new i.P(m.tileAnchorX,m.tileAnchorY);let{x:$e,y:je,z:Ve}=Ce.projectTilePoint(De.x,De.y,fe.canonical);if(ze){const[Qt,ht,zt]=ze(De);$e+=Qt,je+=ht,Ve+=zt}const Ue=Ce.name==="globe",Qe=this.projectAndGetPerspectiveRatio(N,$e,je,Ve,fe,Ue||!!_e||this.transform.pitch>0,Ce),{perspectiveRatio:at}=Qe,St=(J?I/at:I*at)/i.bw,yt=Ea($e,je,Ve,G),jt=Qe.signedDistanceFromCamera>0?ps(St,T,m.lineOffsetX*St,m.lineOffsetY*St,!1,yt,De,m,w,G,{},_e&&!J?ze:null,J&&!!_e,Ce,fe,J):null;let It=!1,ft=!1,At=!0;if(jt&&!Qe.occluded){const Qt=.5*ae*at+ye,ht=new i.P(-100,-100),zt=new i.P(this.screenRightBoundary,this.screenBottomBoundary),Mt=new Br,{first:ln,last:Yt}=jt,Ut=ln.path.length;let tn=[];for(let Cn=Ut-1;Cn>=1;Cn--)tn.push(ln.path[Cn]);for(let Cn=1;Cn<Yt.path.length;Cn++)tn.push(Yt.path[Cn]);const fn=2.5*Qt;X&&(tn=tn.map(([Cn,Yn,Gn],Un)=>(ze&&!Ue&&(Gn=ze(Un<Ut-1?ln.tilePath[Ut-1-Un]:Yt.tilePath[Un-Ut+2])[2]),Ea(Cn,Yn,Gn,X))),tn.some(Cn=>Cn[3]<=0)&&(tn=[]));let wn=[];if(tn.length>0){let Cn=1/0,Yn=-1/0,Gn=1/0,Un=-1/0;for(const tr of tn)Cn=Math.min(Cn,tr[0]),Gn=Math.min(Gn,tr[1]),Yn=Math.max(Yn,tr[0]),Un=Math.max(Un,tr[1]);Yn>=ht.x&&Cn<=zt.x&&Un>=ht.y&&Gn<=zt.y&&(wn=[tn.map(tr=>new i.P(tr[0],tr[1]))],(Cn<ht.x||Yn>zt.x||Gn<ht.y||Un>zt.y)&&(wn=i.bu(wn,ht.x,ht.y,zt.x,zt.y)))}for(const Cn of wn){Mt.reset(Cn,.25*Qt);let Yn=0;Yn=Mt.length<=.5*Qt?1:Math.ceil(Mt.paddedLength/fn)+1;for(let Gn=0;Gn<Yn;Gn++){const Un=Gn/Math.max(Yn-1,1),tr=Mt.lerp(Un),nr=tr.x+Ba,ri=tr.y+Ba;be.push(nr,ri,Qt,0);const Zi=nr-Qt,wi=ri-Qt,ur=nr+Qt,$r=ri+Qt;if(At=At&&this.isOffscreen(Zi,wi,ur,$r),ft=ft||this.isInsideGrid(Zi,wi,ur,$r),!l&&this.grid.hitTestCircle(nr,ri,Qt,Q)&&(It=!0,!Z))return{circles:[],offscreen:!1,collisionDetected:It,occluded:!1}}}}return{circles:!Z&&It||!ft?[]:be,offscreen:At,collisionDetected:It,occluded:Qe.occluded}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const l=[];let m=1/0,w=1/0,T=-1/0,I=-1/0;for(const Z of r){const J=new i.P(Z.x+Ba,Z.y+Ba);m=Math.min(m,J.x),w=Math.min(w,J.y),T=Math.max(T,J.x),I=Math.max(I,J.y),l.push(J)}const N=this.grid.query(m,w,T,I).concat(this.ignoredGrid.query(m,w,T,I)),G={},X={};for(const Z of N){const J=Z.key;if(G[J.bucketInstanceId]===void 0&&(G[J.bucketInstanceId]={}),G[J.bucketInstanceId][J.featureIndex])continue;const Q=[new i.P(Z.x1,Z.y1),new i.P(Z.x2,Z.y1),new i.P(Z.x2,Z.y2),new i.P(Z.x1,Z.y2)];i.bv(l,Q)&&(G[J.bucketInstanceId][J.featureIndex]=!0,X[J.bucketInstanceId]===void 0&&(X[J.bucketInstanceId]=[]),X[J.bucketInstanceId].push(J.featureIndex))}return X}insertCollisionBox(r,l,m,w,T){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:w,collisionGroupID:T},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,l,m,w,T){const I=l?this.ignoredGrid:this.grid,N={bucketInstanceId:m,featureIndex:w,collisionGroupID:T};for(let G=0;G<r.length;G+=4)I.insertCircle(N,r[G],r[G+1],r[G+2])}projectAndGetPerspectiveRatio(r,l,m,w,T,I,N){const G=[l,m,w,1];let X=!1;w||this.transform.pitch>0?(i.ab.vec4.transformMat4(G,G,r),this.fogState&&T&&N.name!=="globe"&&(X=function(Q,ae,ye,fe,be,_e){const Ce=_e.calculateFogTileMatrix(be),ze=[ae,ye,fe];return i.ab.vec3.transformMat4(ze,ze,Ce),nt(Q,i.ab.vec3.length(ze),_e.pitch,_e._fov)}(this.fogState,l,m,w,T.toUnwrapped(),this.transform)>.9)):ro(G,G,r);const Z=G[3];return{point:new i.P((G[0]/Z+1)/2*this.transform.width+Ba,(-G[1]/Z+1)/2*this.transform.height+Ba),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(N)/Z*.5,1.5),signedDistanceFromCamera:Z,occluded:I&&G[2]>Z||X}}isOffscreen(r,l,m,w){return m<Ba||r>=this.screenRightBoundary||w<Ba||l>this.screenBottomBoundary}isInsideGrid(r,l,m,w){return m>=0&&r<this.gridRightBoundary&&w>=0&&l<this.gridBottomBoundary}getViewportMatrix(){const r=i.ab.mat4.identity([]);return i.ab.mat4.translate(r,r,[-100,-100,0]),r}}function ic(p,r,l){const m=r.createTileMatrix(p,p.worldSize,l.toUnwrapped());return i.ab.mat4.multiply(new Float32Array(16),p.projMatrix,m)}function Fs(p,r,l){if(r.projection.name===l.projection.name)return p.projMatrix;const m=l.clone();return m.setProjection(r.projection),ic(m,r.getProjection(),p)}function eu(p,r,l){return r.name===l.projection.name?p.projMatrix:ic(l,r,p)}class Zc{constructor(r,l,m,w){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?l:-l))):w&&m?1:0,this.placed=m}isHidden(){return this.opacity===0&&!this.placed}}class js{constructor(r,l,m,w,T,I=!1){this.text=new Zc(r?r.text:null,l,m,T),this.icon=new Zc(r?r.icon:null,l,w,T),this.clipped=I}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Hf{constructor(r,l,m,w=!1){this.text=r,this.icon=l,this.skipFade=m,this.clipped=w}}class Il{constructor(){this.invProjMatrix=i.ab.mat4.create(),this.viewportMatrix=i.ab.mat4.create(),this.circles=[]}}class Xf{constructor(r,l,m,w,T){this.bucketInstanceId=r,this.featureIndex=l,this.sourceLayerIndex=m,this.bucketIndex=w,this.tileID=T}}class Cl{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const l=++this.maxGroupID;this.collisionGroups[r]={ID:l,predicate:m=>m.collisionGroupID===l}}return this.collisionGroups[r]}}function qi(p,r,l,m,w){const{horizontalAlign:T,verticalAlign:I}=i.bD(p),N=-(T-.5)*r,G=-(I-.5)*l,X=i.bC(p,m);return new i.P(N+X[0]*w,G+X[1]*w)}function Yf(p,r,l,m,w){const T=new i.P(p,r);return l&&T._rotate(m?w:-w),T}class ac{constructor(r,l,m,w,T,I){this.transform=r.clone(),this.projection=r.projection.name,this.collisionIndex=new pi(this.transform,T),this.buildingIndex=I,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new Cl(m),this.collisionCircleArrays={},this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,l,m,w,T=1){const I=m.getBucket(l),N=m.latestFeatureIndex;if(!I||!N||l.fqid!==I.layerIds[0])return;const G=I.layers[0].layout,X=I.layers[0].paint,Z=m.collisionBoxArray,J=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),Q=m.tileSize/i.ag,ae=m.tileID.toUnwrapped();this.transform.setProjection(I.projection);const ye=(fe=m.tileID,be=I.getProjection(),_e=this.transform,be.name===this.projection?_e.calculateProjMatrix(fe.toUnwrapped()):ic(_e,be,fe));var fe,be,_e;const Ce=G.get("text-pitch-alignment")==="map",ze=G.get("text-rotation-alignment")==="map";l.compileFilter(l.options);const De=l.dynamicFilter(),$e=l.dynamicFilterNeedsFeature(),je=this.transform.calculatePixelsToTileUnitsMatrix(m),Ve=ui(ye,m.tileID.canonical,Ce,ze,this.transform,I.getProjection(),je);let Ue=null;if(Ce){const Qt=Ou(ye,m.tileID.canonical,Ce,ze,this.transform,I.getProjection(),je);Ue=i.ab.mat4.multiply([],this.transform.labelPlaneMatrix,Qt)}let Qe=null;De&&m.latestFeatureIndex&&(Qe={unwrappedTileID:ae,dynamicFilter:De,dynamicFilterNeedsFeature:$e}),this.retainedQueryData[I.bucketInstanceId]=new Xf(I.bucketInstanceId,N,I.sourceLayerIndex,I.index,m.tileID);const[at,St]=I.layers[0].layout.get("text-size-scale-range"),yt=i.aw(T,at,St),[jt,It]=G.get("icon-size-scale-range"),ft=i.aw(T,jt,It),At={bucket:I,layout:G,paint:X,posMatrix:ye,textLabelPlaneMatrix:Ve,labelToScreenMatrix:Ue,clippingData:Qe,scale:J,textPixelRatio:Q,holdingForFade:m.holdingForFade(),collisionBoxArray:Z,partiallyEvaluatedTextSize:i.bp(I.textSizeData,this.transform.zoom,yt),partiallyEvaluatedIconSize:i.bp(I.iconSizeData,this.transform.zoom,ft),collisionGroup:this.collisionGroups.get(I.sourceID),latestFeatureIndex:m.latestFeatureIndex};if(w)for(const Qt of I.sortKeyRanges){const{sortKey:ht,symbolInstanceStart:zt,symbolInstanceEnd:Mt}=Qt;r.push({sortKey:ht,symbolInstanceStart:zt,symbolInstanceEnd:Mt,parameters:At})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:I.symbolInstances.length,parameters:At})}attemptAnchorPlacement(r,l,m,w,T,I,N,G,X,Z,J,Q,ae,ye,fe,be,_e,Ce){const{textOffset0:ze,textOffset1:De,crossTileID:$e}=Q,je=[ze,De],Ve=qi(r,m,w,je,T),Ue=this.collisionIndex.placeCollisionBox(ye,T,l,Yf(Ve.x,Ve.y,I,N,this.transform.angle),J,G,X,Z.predicate);if(be){const Qe=ye.getSymbolInstanceIconSize(Ce,this.transform.zoom,Q.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ye,Qe,be,Yf(Ve.x,Ve.y,I,N,this.transform.angle),J,G,X,Z.predicate).box.length===0)return}if(Ue.box.length>0){let Qe;return this.prevPlacement&&this.prevPlacement.variableOffsets[$e]&&this.prevPlacement.placements[$e]&&this.prevPlacement.placements[$e].text&&(Qe=this.prevPlacement.variableOffsets[$e].anchor),this.variableOffsets[$e]={textOffset:je,width:m,height:w,anchor:r,textScale:T,prevAnchor:Qe},this.markUsedJustification(ye,r,Q,fe),ye.allowVerticalPlacement&&(this.markUsedOrientation(ye,fe,Q),this.placedOrientations[$e]=fe),{shift:Ve,placedGlyphBoxes:Ue}}}placeLayerBucketPart(r,l,m,w,T=1){const{bucket:I,layout:N,paint:G,posMatrix:X,textLabelPlaneMatrix:Z,labelToScreenMatrix:J,clippingData:Q,textPixelRatio:ae,holdingForFade:ye,collisionBoxArray:fe,partiallyEvaluatedTextSize:be,partiallyEvaluatedIconSize:_e,collisionGroup:Ce,latestFeatureIndex:ze}=r.parameters,De=N.get("text-optional"),$e=N.get("icon-optional"),je=N.get("text-allow-overlap"),Ve=N.get("icon-allow-overlap"),Ue=N.get("text-rotation-alignment")==="map",Qe=N.get("text-pitch-alignment")==="map",at=N.get("symbol-z-elevate"),St=G.get("symbol-z-offset"),yt=N.get("symbol-elevation-reference")==="sea",[jt,It]=N.get("text-size-scale-range"),[ft,At]=N.get("icon-size-scale-range"),Qt=i.aw(T,jt,It),ht=i.aw(T,ft,At);this.transform.setProjection(I.projection);let zt=je&&(Ve||!I.hasIconData()||$e),Mt=Ve&&(je||!I.hasTextData()||De);const ln=!St.isConstant();!I.collisionArrays&&fe&&I.deserializeCollisionBoxes(fe),m&&w&&I.updateCollisionDebugBuffers(this.transform.zoom,fe,Qt,ht);const Yt=(Ut,tn,fn)=>{const{crossTileID:wn,numVerticalGlyphVertices:Cn}=Ut;let Yn=null;if(Q&&Q.dynamicFilterNeedsFeature||ln){const ti=this.retainedQueryData[I.bucketInstanceId];Yn=ze.loadFeature({featureIndex:Ut.featureIndex,bucketIndex:ti.bucketIndex,sourceLayerIndex:ti.sourceLayerIndex,layoutVertexArrayOffset:0})}if(Q&&!(0,Q.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},Yn,this.retainedQueryData[I.bucketInstanceId].tileID.canonical,new i.P(Ut.tileAnchorX,Ut.tileAnchorY),this.transform.calculateDistanceTileData(Q.unwrappedTileID)))return this.placements[wn]=new Hf(!1,!1,!1,!0),void l.add(wn);const Gn=St.evaluate(Yn,{});if(l.has(wn))return;if(ye)return void(this.placements[wn]=new Hf(!1,!1,!1));let Un=!1,tr=!1,nr=!0,ri=!1,Zi=!1,wi=null,ur={box:null,offscreen:null,occluded:null},$r={box:null},Sn=null,Kn=null,Zn=null,Jn=0,Ir=0,Ti=0;fn.textFeatureIndex?Jn=fn.textFeatureIndex:Ut.useRuntimeCollisionCircles&&(Jn=Ut.featureIndex),fn.verticalTextFeatureIndex&&(Ir=fn.verticalTextFeatureIndex);const ki=ti=>{ti.tileID=this.retainedQueryData[I.bucketInstanceId].tileID;const ei=this.transform.elevation;ti.elevation=yt?Gn:Gn+(ei?ei.getAtTileOffset(ti.tileID,ti.tileAnchorX,ti.tileAnchorY):0),ti.elevation+=Ut.zOffset},Wi=fn.textBox;if(Wi){ki(Wi);const ti=Dr=>{let fi=i.bq.horizontal;if(I.allowVerticalPlacement&&!Dr&&this.prevPlacement){const aa=this.prevPlacement.placedOrientations[wn];aa&&(this.placedOrientations[wn]=aa,fi=aa,this.markUsedOrientation(I,fi,Ut))}return fi},ei=(Dr,fi)=>{if(I.allowVerticalPlacement&&Cn>0&&fn.verticalTextBox){for(const aa of I.writingModes)if(aa===i.bq.vertical?(ur=fi(),$r=ur):ur=Dr(),ur&&ur.box&&ur.box.length)break}else ur=Dr()};if(N.get("text-variable-anchor")){let Dr=N.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[wn]){const ii=this.prevPlacement.variableOffsets[wn];Dr.indexOf(ii.anchor)>0&&(Dr=Dr.filter(oa=>oa!==ii.anchor),Dr.unshift(ii.anchor))}const fi=(ii,oa,As)=>{const Go=I.getSymbolInstanceTextSize(be,Ut,this.transform.zoom,tn),xo=(ii.x2-ii.x1)*Go+2*ii.padding,Ws=(ii.y2-ii.y1)*Go+2*ii.padding,uo=Ut.hasIconTextFit&&!Ve?oa:null;uo&&ki(uo);let $o={box:[],offscreen:!1,occluded:!1};const Ks=je?2*Dr.length:Dr.length;for(let Ms=0;Ms<Ks;++Ms){const $u=this.attemptAnchorPlacement(Dr[Ms%Dr.length],ii,xo,Ws,Go,Ue,Qe,ae,X,Ce,Ms>=Dr.length,Ut,tn,I,As,uo,be,_e);if($u&&($o=$u.placedGlyphBoxes,$o&&$o.box&&$o.box.length)){Un=!0,wi=$u.shift;break}}return $o};ei(()=>fi(Wi,fn.iconBox,i.bq.horizontal),()=>{const ii=fn.verticalTextBox;return ii&&ki(ii),I.allowVerticalPlacement&&!(ur&&ur.box&&ur.box.length)&&Cn>0&&ii?fi(ii,fn.verticalIconBox,i.bq.vertical):{box:null,offscreen:null,occluded:null}}),ur&&(Un=ur.box,nr=ur.offscreen,ri=ur.occluded);const aa=ti(!(!ur||!ur.box));if(!Un&&this.prevPlacement){const ii=this.prevPlacement.variableOffsets[wn];ii&&(this.variableOffsets[wn]=ii,this.markUsedJustification(I,ii.anchor,Ut,aa))}}else{const Dr=(fi,aa)=>{const ii=I.getSymbolInstanceTextSize(be,Ut,this.transform.zoom,tn,T),oa=this.collisionIndex.placeCollisionBox(I,ii,fi,new i.P(0,0),je,ae,X,Ce.predicate);return oa&&oa.box&&oa.box.length&&(this.markUsedOrientation(I,aa,Ut),this.placedOrientations[wn]=aa),oa};ei(()=>Dr(Wi,i.bq.horizontal),()=>{const fi=fn.verticalTextBox;return I.allowVerticalPlacement&&Cn>0&&fi?(ki(fi),Dr(fi,i.bq.vertical)):{box:null,offscreen:null,occluded:null}}),ti(!!(ur&&ur.box&&ur.box.length))}}if(Sn=ur,Un=Sn&&Sn.box&&Sn.box.length>0,nr=Sn&&Sn.offscreen,ri=Sn&&Sn.occluded,Ut.useRuntimeCollisionCircles){const ti=I.text.placedSymbolArray.get(Ut.centerJustifiedTextSymbolIndex>=0?Ut.centerJustifiedTextSymbolIndex:Ut.verticalPlacedTextSymbolIndex),ei=i.br(I.textSizeData,be,ti),Dr=N.get("text-padding");Kn=this.collisionIndex.placeCollisionCircles(I,je,ti,I.lineVertexArray,I.glyphOffsetArray,ei,X,Z,J,m,Qe,Ce.predicate,Ut.collisionCircleDiameter*ei/i.bw,Dr,this.retainedQueryData[I.bucketInstanceId].tileID),Un=je||Kn.circles.length>0&&!Kn.collisionDetected,nr=nr&&Kn.offscreen,ri=Kn.occluded}if(fn.iconFeatureIndex&&(Ti=fn.iconFeatureIndex),fn.iconBox){const ti=ei=>{ki(ei);const Dr=Ut.hasIconTextFit&&wi?Yf(wi.x,wi.y,Ue,Qe,this.transform.angle):new i.P(0,0),fi=I.getSymbolInstanceIconSize(_e,this.transform.zoom,Ut.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(I,fi,ei,Dr,Ve,ae,X,Ce.predicate)};$r&&$r.box&&$r.box.length&&fn.verticalIconBox?(Zn=ti(fn.verticalIconBox),tr=Zn.box.length>0):(Zn=ti(fn.iconBox),tr=Zn.box.length>0),nr=nr&&Zn.offscreen,Zi=Zn.occluded}const rs=De||Ut.numHorizontalGlyphVertices===0&&Cn===0,ua=$e||Ut.numIconVertices===0;if(rs||ua?ua?rs||(tr=tr&&Un):Un=tr&&Un:tr=Un=tr&&Un,Un&&Sn&&Sn.box&&this.collisionIndex.insertCollisionBox(Sn.box,N.get("text-ignore-placement"),I.bucketInstanceId,$r&&$r.box&&Ir?Ir:Jn,Ce.ID),tr&&Zn&&this.collisionIndex.insertCollisionBox(Zn.box,N.get("icon-ignore-placement"),I.bucketInstanceId,Ti,Ce.ID),Kn&&(Un&&this.collisionIndex.insertCollisionCircles(Kn.circles,N.get("text-ignore-placement"),I.bucketInstanceId,Jn,Ce.ID),m)){const ti=I.bucketInstanceId;let ei=this.collisionCircleArrays[ti];ei===void 0&&(ei=this.collisionCircleArrays[ti]=new Il);for(let Dr=0;Dr<Kn.circles.length;Dr+=4)ei.circles.push(Kn.circles[Dr+0]),ei.circles.push(Kn.circles[Dr+1]),ei.circles.push(Kn.circles[Dr+2]),ei.circles.push(Kn.collisionDetected?1:0)}const zr=I.projection.name!=="globe";zt=zt&&(zr||!ri),Mt=Mt&&(zr||!Zi),this.placements[wn]=new Hf(Un||zt,tr||Mt,nr||I.justReloaded),l.add(wn)};if(at&&this.buildingIndex&&(this.buildingIndex.updateZOffset(I,this.retainedQueryData[I.bucketInstanceId].tileID),I.updateZOffset()),I.sortFeaturesByY){const Ut=I.getSortedSymbolIndexes(this.transform.angle);for(let tn=Ut.length-1;tn>=0;--tn){const fn=Ut[tn];Yt(I.symbolInstances.get(fn),fn,I.collisionArrays[fn])}I.hasAnyZOffset&&i.w(`${I.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(I.hasAnyZOffset){const Ut=I.getSortedIndexesByZOffset();for(let tn=0;tn<Ut.length;++tn){const fn=Ut[tn];Yt(I.symbolInstances.get(fn),fn,I.collisionArrays[fn])}}else for(let Ut=r.symbolInstanceStart;Ut<r.symbolInstanceEnd;Ut++)Yt(I.symbolInstances.get(Ut),Ut,I.collisionArrays[Ut]);if(m&&I.bucketInstanceId in this.collisionCircleArrays){const Ut=this.collisionCircleArrays[I.bucketInstanceId];i.ab.mat4.invert(Ut.invProjMatrix,X),Ut.viewportMatrix=this.collisionIndex.getViewportMatrix()}I.justReloaded=!1}markUsedJustification(r,l,m,w){const{leftJustifiedTextSymbolIndex:T,centerJustifiedTextSymbolIndex:I,rightJustifiedTextSymbolIndex:N,verticalPlacedTextSymbolIndex:G,crossTileID:X}=m,Z=i.bB(l),J=w===i.bq.vertical?G:Z==="left"?T:Z==="center"?I:Z==="right"?N:-1;T>=0&&(r.text.placedSymbolArray.get(T).crossTileID=J>=0&&T!==J?0:X),I>=0&&(r.text.placedSymbolArray.get(I).crossTileID=J>=0&&I!==J?0:X),N>=0&&(r.text.placedSymbolArray.get(N).crossTileID=J>=0&&N!==J?0:X),G>=0&&(r.text.placedSymbolArray.get(G).crossTileID=J>=0&&G!==J?0:X)}markUsedOrientation(r,l,m){const w=l===i.bq.horizontal||l===i.bq.horizontalOnly?l:0,T=l===i.bq.vertical?l:0,{leftJustifiedTextSymbolIndex:I,centerJustifiedTextSymbolIndex:N,rightJustifiedTextSymbolIndex:G,verticalPlacedTextSymbolIndex:X}=m,Z=r.text.placedSymbolArray;I>=0&&(Z.get(I).placedOrientation=w),N>=0&&(Z.get(N).placedOrientation=w),G>=0&&(Z.get(G).placedOrientation=w),X>=0&&(Z.get(X).placedOrientation=T)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const l=this.prevPlacement;let m=!1;this.prevZoomAdjustment=l?l.zoomAdjustment(this.transform.zoom):0;const w=l?l.symbolFadeChange(r):1,T=l?l.opacities:{},I=l?l.variableOffsets:{},N=l?l.placedOrientations:{};for(const G in this.placements){const X=this.placements[G],Z=T[G];Z?(this.opacities[G]=new js(Z,w,X.text,X.icon,null,X.clipped),m=m||X.text!==Z.text.placed||X.icon!==Z.icon.placed):(this.opacities[G]=new js(null,w,X.text,X.icon,X.skipFade,X.clipped),m=m||X.text||X.icon)}for(const G in T){const X=T[G];if(!this.opacities[G]){const Z=new js(X,w,!1,!1);Z.isHidden()||(this.opacities[G]=Z,m=m||X.text.placed||X.icon.placed)}}for(const G in I)this.variableOffsets[G]||!this.opacities[G]||this.opacities[G].isHidden()||(this.variableOffsets[G]=I[G]);for(const G in N)this.placedOrientations[G]||!this.opacities[G]||this.opacities[G].isHidden()||(this.placedOrientations[G]=N[G]);m?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=l?l.lastPlacementChangeTime:r)}updateLayerOpacities(r,l,m,w){const T=new Set;for(const I of l){const N=I.getBucket(r);N&&I.latestFeatureIndex&&r.fqid===N.layerIds[0]&&(this.updateBucketOpacities(N,T,I,I.collisionBoxArray,m,w,I.tileID,r.scope),N.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(N,I.tileID),N.updateZOffset()))}}updateBucketOpacities(r,l,m,w,T,I,N,G){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const X=r.layers[0].layout,Z=r.layers[0].paint,J=!!r.layers[0].dynamicFilter(),Q=new js(null,0,!1,!1,!0),ae=X.get("text-allow-overlap"),ye=X.get("icon-allow-overlap"),fe=X.get("text-variable-anchor"),be=X.get("text-rotation-alignment")==="map",_e=X.get("text-pitch-alignment")==="map",Ce=Z.get("symbol-z-offset"),ze=X.get("symbol-elevation-reference")==="sea",De=!Ce.isConstant(),$e=new js(null,0,ae&&(ye||!r.hasIconData()||X.get("icon-optional")),ye&&(ae||!r.hasTextData()||X.get("text-optional")),!0);!r.collisionArrays&&w&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(w);const je=(Ue,Qe,at)=>{for(let St=0;St<Qe/4;St++)Ue.opacityVertexArray.emplaceBack(at)};let Ve=0;I&&r.updateReplacement(N,I);for(let Ue=0;Ue<r.symbolInstances.length;Ue++){const Qe=r.symbolInstances.get(Ue),{numHorizontalGlyphVertices:at,numVerticalGlyphVertices:St,crossTileID:yt,numIconVertices:jt,tileAnchorX:It,tileAnchorY:ft}=Qe;let At=null;const Qt=this.retainedQueryData[r.bucketInstanceId];De&&Qe&&Qt&&(At=m.latestFeatureIndex.loadFeature({featureIndex:Qe.featureIndex,bucketIndex:Qt.bucketIndex,sourceLayerIndex:Qt.sourceLayerIndex,layoutVertexArrayOffset:0}));const ht=Ce.evaluate(At,{}),zt=l.has(yt);let Mt=this.opacities[yt];zt?Mt=Q:Mt||(Mt=$e,this.opacities[yt]=Mt),l.add(yt);const ln=at>0||St>0,Yt=jt>0,Ut=this.placedOrientations[yt],tn=Ut===i.bq.vertical,fn=Ut===i.bq.horizontal||Ut===i.bq.horizontalOnly;!ln&&!Yt||Mt.isHidden()||Ve++;let wn=!1;if((ln||Yt)&&I)for(const Cn of r.activeReplacements){if(i.bx(Cn,T,i.by.Symbol,G)||Cn.min.x>It||It>Cn.max.x||Cn.min.y>ft||ft>Cn.max.y)continue;const Yn=i.bz(It,ft,N.canonical,Cn.footprintTileId.canonical);if(wn=i.bA(Yn,Cn.footprint),wn)break}if(ln){const Cn=wn?Us:Cu(Mt.text);je(r.text,at,tn?Us:Cn),je(r.text,St,fn?Us:Cn);const Yn=Mt.text.isHidden(),{leftJustifiedTextSymbolIndex:Gn,centerJustifiedTextSymbolIndex:Un,rightJustifiedTextSymbolIndex:tr,verticalPlacedTextSymbolIndex:nr}=Qe,ri=r.text.placedSymbolArray,Zi=Yn||tn?1:0;Gn>=0&&(ri.get(Gn).hidden=Zi),Un>=0&&(ri.get(Un).hidden=Zi),tr>=0&&(ri.get(tr).hidden=Zi),nr>=0&&(ri.get(nr).hidden=Yn||fn?1:0);const wi=this.variableOffsets[yt];wi&&this.markUsedJustification(r,wi.anchor,Qe,Ut);const ur=this.placedOrientations[yt];ur&&(this.markUsedJustification(r,"left",Qe,ur),this.markUsedOrientation(r,ur,Qe))}if(Yt){const Cn=wn?Us:Cu(Mt.icon),{placedIconSymbolIndex:Yn,verticalPlacedIconSymbolIndex:Gn}=Qe,Un=r.icon.placedSymbolArray,tr=Mt.icon.isHidden()?1:0;Yn>=0&&(je(r.icon,jt,tn?Us:Cn),Un.get(Yn).hidden=tr),Gn>=0&&(je(r.icon,Qe.numVerticalIconVertices,fn?Us:Cn),Un.get(Gn).hidden=tr)}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const Cn=r.collisionArrays[Ue];if(Cn){let Yn=new i.P(0,0),Gn=!0;if(Cn.textBox||Cn.verticalTextBox){if(fe){const tr=this.variableOffsets[yt];tr?(Yn=qi(tr.anchor,tr.width,tr.height,tr.textOffset,tr.textScale),be&&Yn._rotate(_e?this.transform.angle:-this.transform.angle)):Gn=!1}J&&(Gn=!Mt.clipped),Cn.textBox&&Wc(r.textCollisionBox.collisionVertexArray,Mt.text.placed,!Gn||tn,ht,ze,Yn.x,Yn.y),Cn.verticalTextBox&&Wc(r.textCollisionBox.collisionVertexArray,Mt.text.placed,!Gn||fn,ht,ze,Yn.x,Yn.y)}const Un=Gn&&!!(!fn&&Cn.verticalIconBox);Cn.iconBox&&Wc(r.iconCollisionBox.collisionVertexArray,Mt.icon.placed,Un,ht,ze,Qe.hasIconTextFit?Yn.x:0,Qe.hasIconTextFit?Yn.y:0),Cn.verticalIconBox&&Wc(r.iconCollisionBox.collisionVertexArray,Mt.icon.placed,!Un,ht,ze,Qe.hasIconTextFit?Yn.x:0,Qe.hasIconTextFit?Yn.y:0)}}}if(r.fullyClipped=Ve===0,r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const Ue=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=Ue.invProjMatrix,r.placementViewportMatrix=Ue.viewportMatrix,r.collisionCircleArray=Ue.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,l){const m=this.zoomAtLastRecencyCheck===l?1-this.zoomAdjustment(l):1;return this.zoomAtLastRecencyCheck=l,this.commitTime+this.fadeDuration*m>r}setStale(){this.stale=!0}}function Wc(p,r,l,m,w,T,I){p.emplaceBack(r?1:0,l?1:0,T||0,I||0,m,w?1:0),p.emplaceBack(r?1:0,l?1:0,T||0,I||0,m,w?1:0),p.emplaceBack(r?1:0,l?1:0,T||0,I||0,m,w?1:0),p.emplaceBack(r?1:0,l?1:0,T||0,I||0,m,w?1:0)}const Iu=Math.pow(2,25),np=Math.pow(2,24),Zf=Math.pow(2,17),oc=Math.pow(2,16),Io=Math.pow(2,9),rp=Math.pow(2,8),Za=Math.pow(2,1);function Cu(p){if(p.opacity===0&&!p.placed)return 0;if(p.opacity===1&&p.placed)return 4294967295;const r=p.placed?1:0,l=Math.floor(127*p.opacity);return l*Iu+r*np+l*Zf+r*oc+l*Io+r*rp+l*Za+r}const Us=0;class Ko{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(r,l,m,w,T,I){const N=this._bucketParts;for(;this._currentTileIndex<r.length;)if(l.getBucketParts(N,w,r[this._currentTileIndex],this._sortAcrossTiles,I),this._currentTileIndex++,T())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,N.sort((G,X)=>G.sortKey-X.sortKey));this._currentPartIndex<N.length;){const G=N[this._currentPartIndex];if(l.placeLayerBucketPart(G,this._seenCrossTileIDs,m,G.symbolInstanceStart===0,I),this._currentPartIndex++,T())return!0}return!1}}class ip{constructor(r,l,m,w,T,I,N,G,X){this.placement=new ac(r,T,I,N,G,X),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(r,l,m,w,T){const I=i.q.now(),N=()=>{const G=i.q.now()-I;return!this._forceFullPlacement&&G>2};for(;this._currentPlacementIndex>=0;){const G=l[r[this._currentPlacementIndex]],X=this.placement.collisionIndex.transform.zoom;if(G.type==="symbol"&&(!G.minzoom||G.minzoom<=X)&&(!G.maxzoom||G.maxzoom>X)){const Z=G,J=Z.layout.get("symbol-z-elevate"),Q=Z.layout.get("symbol-sort-key").constantOr(1)!==void 0,ae=Z.layout.get("symbol-z-order"),ye=ae==="viewport-y"||ae==="auto"&&!(ae!=="viewport-y"&&Q),fe=Z.layout.get("text-allow-overlap")||Z.layout.get("icon-allow-overlap")||Z.layout.get("text-ignore-placement")||Z.layout.get("icon-ignore-placement"),be=ye&&fe,_e=this._inProgressLayer=this._inProgressLayer||new Ko(Z),Ce=i.aC(G.source,G.scope);if(_e.continuePlacement(J||be?w[Ce]:m[Ce],this.placement,this._showCollisionBoxes,G,N,T))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const Kc=512/i.ag/2;class Nh{constructor(r,l,m){this.tileID=r,this.bucketInstanceId=m,this.index=new i.bE(l.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const w=r.canonical.x*i.ag,T=r.canonical.y*i.ag;for(let I=0;I<l.length;I++){const{key:N,crossTileID:G,tileAnchorX:X,tileAnchorY:Z}=l.get(I),J=Math.floor((w+X)*Kc),Q=Math.floor((T+Z)*Kc);this.index.add(J,Q),this.keys.push(N),this.crossTileIDs.push(G)}this.index.finish()}findMatches(r,l,m){const w=this.tileID.canonical.z<l.canonical.z?1:Math.pow(2,this.tileID.canonical.z-l.canonical.z),T=Kc/Math.pow(2,l.canonical.z-this.tileID.canonical.z),I=l.canonical.x*i.ag,N=l.canonical.y*i.ag;for(let G=0;G<r.length;G++){const X=r.get(G);if(X.crossTileID)continue;const{key:Z,tileAnchorX:J,tileAnchorY:Q}=X,ae=Math.floor((I+J)*T),ye=Math.floor((N+Q)*T),fe=this.index.range(ae-w,ye-w,ae+w,ye+w);for(const be of fe){const _e=this.crossTileIDs[be];if(this.keys[be]===Z&&!m.has(_e)){m.add(_e),X.crossTileID=_e;break}}}}}class Wf{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ap{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const l=Math.round((r-this.lng)/360);if(l!==0)for(const m in this.indexes){const w=this.indexes[m],T={};for(const I in w){const N=w[I];N.tileID=N.tileID.unwrapTo(N.tileID.wrap+l),T[N.tileID.key]=N}this.indexes[m]=T}this.lng=r}addBucket(r,l,m){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===l.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let T=0;T<l.symbolInstances.length;T++)l.symbolInstances.get(T).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]=new Set);const w=this.usedCrossTileIDs[r.overscaledZ];for(const T in this.indexes){const I=this.indexes[T];if(Number(T)>r.overscaledZ)for(const N in I){const G=I[N];G.tileID.isChildOf(r)&&G.findMatches(l.symbolInstances,r,w)}else{const N=I[r.scaledTo(Number(T)).key];N&&N.findMatches(l.symbolInstances,r,w)}}for(let T=0;T<l.symbolInstances.length;T++){const I=l.symbolInstances.get(T);I.crossTileID||(I.crossTileID=m.generate(),w.add(I.crossTileID))}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new Nh(r,l.symbolInstances,l.bucketInstanceId),!0}removeBucketCrossTileIDs(r,l){for(const m of l.crossTileIDs)this.usedCrossTileIDs[r].delete(m)}removeStaleBuckets(r){let l=!1;for(const m in this.indexes){const w=this.indexes[m];for(const T in w)r[w[T].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,w[T]),delete w[T],l=!0)}return l}}class Bh{constructor(){this.layerIndexes={},this.crossTileIDs=new Wf,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,l,m,w){let T=this.layerIndexes[r.fqid];T===void 0&&(T=this.layerIndexes[r.fqid]=new ap);let I=!1;const N={};w.name!=="globe"&&T.handleWrapJump(m);for(const G of l){const X=G.getBucket(r);X&&r.fqid===X.layerIds[0]&&(X.bucketInstanceId||(X.bucketInstanceId=++this.maxBucketInstanceId),T.addBucket(G.tileID,X,this.crossTileIDs)&&(I=!0),N[X.bucketInstanceId]=!0)}return T.removeStaleBuckets(N)&&(I=!0),I}pruneUnusedLayers(r){const l={};r.forEach(m=>{l[m]=!0});for(const m in this.layerIndexes)l[m]||delete this.layerIndexes[m]}}const ms=771;class vr{constructor(r,l,m,w){this.blendFunction=r,this.blendColor=l,this.mask=m,this.blendEquation=w}}vr.Replace=[1,0,1,0],vr.disabled=new vr(vr.Replace,i.aj.transparent,[!1,!1,!1,!1]),vr.unblended=new vr(vr.Replace,i.aj.transparent,[!0,!0,!0,!0]),vr.alphaBlended=new vr([1,ms,1,ms],i.aj.transparent,[!0,!0,!0,!0]),vr.alphaBlendedNonPremultiplied=new vr([770,ms,770,ms],i.aj.transparent,[!0,!0,!0,!0]),vr.multiply=new vr([774,0,774,0],i.aj.transparent,[!0,!0,!0,!0]);class qn{constructor(r,l,m){this.func=r,this.mask=l,this.range=m}}qn.ReadOnly=!1,qn.ReadWrite=!0,qn.disabled=new qn(519,qn.ReadOnly,[0,1]);const Fh=7680;class Qn{constructor(r,l,m,w,T,I){this.test=r,this.ref=l,this.mask=m,this.fail=w,this.depthFail=T,this.pass=I}}Qn.disabled=new Qn({func:519,mask:0},0,0,Fh,Fh,Fh);const tu=1029,nu=2305;class Wn{constructor(r,l,m){this.enable=r,this.mode=l,this.frontFace=m}}function sc(p,r){const l=i.bG(p,3);i.ab.mat4.fromQuat(p,r),i.bI(p,3,l)}function ol(p,r){const l=i.ab.quat.identity([]);return i.ab.quat.rotateZ(l,l,-r),i.ab.quat.rotateX(l,l,-p),l}function jh(p,r){const l=[p[0],p[1],0],m=[r[0],r[1],0];if(i.ab.vec3.length(l)>=1e-15){const I=i.ab.vec3.normalize([],l);i.ab.vec3.scale(m,I,i.ab.vec3.dot(m,I)),r[0]=m[0],r[1]=m[1]}const w=i.ab.vec3.cross([],r,p);if(i.ab.vec3.len(w)<1e-15)return null;const T=Math.atan2(-w[1],w[0]);return ol(Math.atan2(Math.sqrt(p[0]*p[0]+p[1]*p[1]),-p[2]),T)}Wn.disabled=new Wn(!1,tu,nu),Wn.backCCW=new Wn(!0,tu,nu),Wn.backCW=new Wn(!0,tu,2304),Wn.frontCW=new Wn(!0,1028,2304),Wn.frontCCW=new Wn(!0,1028,nu);class Jc{constructor(r,l){this.position=r,this.orientation=l}get position(){return this._position}set position(r){if(r){const l=r instanceof i.aa?r:new i.aa(r[0],r[1],r[2]);this._renderWorldCopies&&(l.x=i.bF(l.x,0,1)),this._position=l}else this._position=null}lookAtPoint(r,l){if(this.orientation=null,!this.position)return;const m=this.position,w=this._elevation?this._elevation.getAtPointOrZero(i.aa.fromLngLat(r)):0,T=i.aa.fromLngLat(r,w),I=[T.x-m.x,T.y-m.y,T.z-m.z];l||(l=[0,0,1]),l[2]=Math.abs(l[2]),this.orientation=jh(I,l)}setPitchBearing(r,l){this.orientation=ol(i.ai(r),i.ai(-l))}}class io{constructor(r,l){this._transform=i.ab.mat4.identity([]),this.orientation=l,this.position=r}get mercatorPosition(){const r=this.position;return new i.aa(r[0],r[1],r[2])}get position(){const r=i.bG(this._transform,3);return[r[0],r[1],r[2]]}set position(r){var l;r&&i.bI(this._transform,3,[(l=r)[0],l[1],l[2],1])}get orientation(){return this._orientation}set orientation(r){this._orientation=r||i.ab.quat.identity([]),r&&sc(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),l=this.right();return{bearing:Math.atan2(-l[1],l[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,l){this._orientation=ol(r,l),sc(this._transform,this._orientation)}forward(){const r=i.bG(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=i.bG(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=i.bG(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,l){const m=new Float64Array(16);return i.ab.mat4.invert(m,this.getWorldToCamera(r,l)),m}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(r,l,m){const w=this.position;i.ab.vec3.scale(w,w,-r);const T=new Float64Array(16);return i.ab.mat4.fromScaling(T,[m,m,m]),i.ab.mat4.translate(T,T,w),T[10]*=l,T}getWorldToCamera(r,l){const m=new Float64Array(16),w=new Float64Array(4),T=this.position;return i.ab.quat.conjugate(w,this._orientation),i.ab.vec3.scale(T,T,-r),i.ab.mat4.fromQuat(m,w),i.ab.mat4.translate(m,m,T),m[1]*=-1,m[5]*=-1,m[9]*=-1,m[13]*=-1,m[8]*=l,m[9]*=l,m[10]*=l,m[11]*=l,m}getCameraToClipPerspective(r,l,m,w){const T=new Float64Array(16);return i.ab.mat4.perspective(T,r,l,m,w),T}getCameraToClipOrthographic(r,l,m,w,T,I){const N=new Float64Array(16);return i.ab.mat4.ortho(N,r,l,m,w,T,I),N}getDistanceToElevation(r,l=!1){const m=r===0?0:i.bH(r,l?i.aS(this.position[1]):this.position[1]),w=this.forward();return(m-this.position[2])/w[2]}clone(){return new io([...this.position],[...this.orientation])}}const Ma={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class pn{constructor(r=0,l=0,m=0,w=0){if(isNaN(r)||r<0||isNaN(l)||l<0||isNaN(m)||m<0||isNaN(w)||w<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=l,this.left=m,this.right=w}interpolate(r,l,m){return l.top!=null&&r.top!=null&&(this.top=i.af(r.top,l.top,m)),l.bottom!=null&&r.bottom!=null&&(this.bottom=i.af(r.bottom,l.bottom,m)),l.left!=null&&r.left!=null&&(this.left=i.af(r.left,l.left,m)),l.right!=null&&r.right!=null&&(this.right=i.af(r.right,l.right,m)),this}getCenter(r,l){const m=i.aw((this.left+r-this.right)/2,0,r),w=i.aw((this.top+l-this.bottom)/2,0,l);return new i.P(m,w)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new pn(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Qc=(p,r,l)=>(1-l)*p+l*r,lc=p=>p*p*p*p*p;class uc{constructor(r,l,m,w,T,I,N){this.tileSize=512,this._renderWorldCopies=T===void 0||T,this._minZoom=r||0,this._maxZoom=l||22,this._minPitch=m??0,this._maxPitch=w??60,this.setProjection(I),this.setMaxBounds(N),this.width=0,this.height=0,this._center=new i.bO(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new pn,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new io,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const r=new uc(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,r.tileSize=this.tileSize,r.mercatorFromTransition=this.mercatorFromTransition,r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._seaLevelZoom=this._seaLevelZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._nearZ=this._nearZ,r._farZ=this._farZ,r._averageElevation=this._averageElevation,r._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r.frustumCorners=this.frustumCorners,r}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(r,l=!1){const m=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||m)&&this._updateCameraOnTerrain(),(r||m)&&this._constrainCamera(l),this._calcMatrices()}getProjection(){return i.ay(this.projection,["name","center","parallels"])}setProjection(r){this.projectionOptions=r||{name:"mercator"};const l=this.projection?this.getProjection():void 0;this.projection=i.bP(this.projectionOptions);const m=this.getProjection(),w=!i.bn(l,m);return w&&this._calcMatrices(),this.mercatorFromTransition=!1,w}setOrthographicProjectionAtLowPitch(r){return this._orthographicProjectionAtLowPitch!==r&&(this._orthographicProjectionAtLowPitch=r,this._calcMatrices(),!0)}setMercatorFromTransition(){const r=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=i.bP({name:"mercator"});const l=r!==this.projection.name;return l&&this._calcMatrices(),l}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return i.bH(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.P(this.width,this.height)}get bearing(){return i.bF(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const l=-r*Math.PI/180;this.angle!==l&&(this._unmodified=!1,this.angle=l,this._calcMatrices(),this.rotationMatrix=i.ab.mat2.create(),i.ab.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const l=i.aw(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==l&&(this._unmodified=!1,this._pitch=l,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const r=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/r)}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=i.ai(r),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(r){const l=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==l&&(this._unmodified=!1,this._setZoom(l),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(r){this._tileCoverLift!==r&&(this._tileCoverLift=r)}_updateCameraOnTerrain(){const r=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,l=this.elevation&&r===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||r===Number.NEGATIVE_INFINITY&&(!l||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const m=this._elevation;l||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&m.exaggeration()&&this._centerAltitudeValidForExaggeration!==m.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*m.exaggeration(),this._centerAltitudeValidForExaggeration=m.exaggeration()):(this._centerAltitude=r||0,this._centerAltitudeValidForExaggeration=m.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,l=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],m=this.horizonLineFromTop();let w=0,T=0;for(let I=0;I<l.length;I++){const N=new i.P(l[I][0]*this.width,m+l[I][1]*(this.height-m)),G=r.pointCoordinate(N);if(!G)continue;const X=1/Math.hypot(G[0]-this._camera.position[0],G[1]-this._camera.position[1]);w+=G[3]*X,T+=X}return T===0?NaN:w/T}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const r=this._seaLevelZoom,l=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),m=this.pixelsPerMeter/this.worldSize*l,w=this._mercatorZfromZoom(r),T=this._mercatorZfromZoom(this._maxZoom),I=Math.max(w-m,T);this._setZoom(this._zoomFromMercatorZ(I))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const l=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let m;m=r.z<this._camera.position[2]?[l.x,l.y,l.z]:[r.x,r.y,r.z];const w=i.ab.vec3.length(i.ab.vec3.sub([],this._camera.position,m));return i.aw(this._zoomFromMercatorZ(w),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let l=!1;if(r.orientation&&!i.ab.quat.exactEquals(r.orientation,this._camera.orientation)&&(l=this._setCameraOrientation(r.orientation)),r.position){const m=[r.position.x,r.position.y,r.position.z];i.ab.vec3.exactEquals(m,this._camera.position)||(this._setCameraPosition(m),l=!0)}l&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,l=new Jc;return l.position=new i.aa(r[0],r[1],r[2]),l.orientation=this._camera.orientation,l._elevation=this.elevation,l._renderWorldCopies=this.renderWorldCopies,l}_setCameraOrientation(r){if(!i.ab.quat.length(r))return!1;i.ab.quat.normalize(r,r);const l=i.ab.vec3.transformQuat([],[0,0,-1],r),m=i.ab.vec3.transformQuat([],[0,-1,0],r);if(m[2]<0)return!1;const w=jh(l,m);return!!w&&(this._camera.orientation=w,!0)}_setCameraPosition(r){const l=this.zoomScale(this.minZoom)*this.tileSize,m=this.zoomScale(this.maxZoom)*this.tileSize,w=this.cameraToCenterDistance;r[2]=i.aw(r[2],w/m,w/l),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,l,m){this._unmodified=!1,this._edgeInsets.interpolate(r,l,m),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const l=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,l)}getVisibleUnwrappedCoordinates(r){const l=[new i.bQ(0,r)];if(this.renderWorldCopies){const m=this.pointCoordinate(new i.P(0,0)),w=this.pointCoordinate(new i.P(this.width,0)),T=this.pointCoordinate(new i.P(this.width,this.height)),I=this.pointCoordinate(new i.P(0,this.height)),N=Math.floor(Math.min(m.x,w.x,T.x,I.x)),G=Math.floor(Math.max(m.x,w.x,T.x,I.x)),X=1;for(let Z=N-X;Z<=G+X;Z++)Z!==0&&l.push(new i.bQ(Z,r))}return l}isLODDisabled(r){return(!r||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(r,l,m){let w=[];const T=m!==void 0,I=!T;if(I&&this.zoom<l||T&&m[0]===0&&m[1]===0)return w;const N=new Set,G=(Z,J,Q,ae,ye)=>{const fe=i.c5(J,Z,Q,ae,ye);N.has(fe)||(w.push(new i.aG(Z,J,Q,ae,ye)),N.add(fe))};for(let Z=0;Z<r.length;Z++){const J=r[Z];if(I&&J.canonical.z!==l)continue;const Q=J.canonical,ae=J.overscaledZ,ye=J.wrap,fe=1<<Q.z,be=Q.x+1<fe,_e=Q.x>0,Ce=Q.y+1<fe,ze=Q.y>0,De=J.wrap-(_e?0:1),$e=J.wrap+(be?0:1),je=_e?Q.x-1:fe-1,Ve=be?Q.x+1:0;if(T)m[0]<0?(G(ae,$e,Q.z,Ve,Q.y),m[1]<0&&Ce&&(G(ae,ye,Q.z,Q.x,Q.y+1),G(ae,$e,Q.z,Ve,Q.y+1)),m[1]>0&&ze&&(G(ae,ye,Q.z,Q.x,Q.y-1),G(ae,$e,Q.z,Ve,Q.y-1))):m[0]>0?(G(ae,De,Q.z,je,Q.y),m[1]<0&&Ce&&(G(ae,ye,Q.z,Q.x,Q.y+1),G(ae,De,Q.z,je,Q.y+1)),m[1]>0&&ze&&(G(ae,ye,Q.z,Q.x,Q.y-1),G(ae,De,Q.z,je,Q.y-1))):m[1]<0&&Ce?G(ae,ye,Q.z,Q.x,Q.y+1):ze&&G(ae,ye,Q.z,Q.x,Q.y-1);else{const Ue=J.visibleQuadrants;1&Ue&&(G(ae,De,Q.z,je,Q.y),ze&&(G(ae,ye,Q.z,Q.x,Q.y-1),G(ae,De,Q.z,je,Q.y-1))),2&Ue&&(G(ae,$e,Q.z,Ve,Q.y),ze&&(G(ae,ye,Q.z,Q.x,Q.y-1),G(ae,$e,Q.z,Ve,Q.y-1))),4&Ue&&(G(ae,De,Q.z,je,Q.y),Ce&&(G(ae,ye,Q.z,Q.x,Q.y+1),G(ae,De,Q.z,je,Q.y+1))),8&Ue&&(G(ae,$e,Q.z,Ve,Q.y),Ce&&(G(ae,ye,Q.z,Q.x,Q.y+1),G(ae,$e,Q.z,Ve,Q.y+1)))}}const X=[];for(const Z of w)w.some(J=>Z.isChildOf(J))||X.push(Z);if(w=X.filter(Z=>!r.some(J=>!!(Z.overscaledZ<l&&J.isChildOf(Z))||Z.equals(J)||Z.isChildOf(J))),I){const Z=1<<l,J=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Q=[Z*J.x,Z*J.y],ae=4,ye=ae*ae;w=w.filter(fe=>{const be=fe.canonical.x+.5-Q[0],_e=fe.canonical.y+.5-Q[1];return be*be+_e*_e<ye})}return w}coveringTiles(r){let l=this.coveringZoomLevel(r);const m=l,w=this.elevation&&this.elevation.exaggeration(),T=w&&!r.isTerrainDEM,I=this.projection.name==="mercator";if(r.minzoom!==void 0&&l<r.minzoom)return[];r.maxzoom!==void 0&&l>r.maxzoom&&(l=r.maxzoom);const N=this.locationCoordinate(this.center),G=this.center.lat,X=1<<l,Z=[X*N.x,X*N.y,0],J=this.projection.name==="globe",Q=!J,ae=i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l,Q),ye=J?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),fe=X*i.bH(1,this.center.lat),be=this._camera.position[2]/i.bH(1,this.center.lat),_e=[X*ye.x,X*ye.y,be*(Q?1:fe)],Ce=J||w,ze=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),De=this.isLODDisabled(!0)?l:0;let $e;if(this._elevation&&r.isTerrainDEM)$e=1e4*this._elevation.exaggeration();else if(this._elevation){const ht=this._elevation.getMinMaxForVisibleTiles();$e=ht?ht.max:this._centerAltitude}else $e=this._centerAltitude;const je=r.isTerrainDEM?-$e:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ve=this.projection.isReprojectedInTileSpace?i.bS(this):1,Ue=ht=>{const Mt=new i.aa(ht.x+25e-6,ht.y,ht.z),ln=new i.aa(ht.x,ht.y+25e-6,ht.z),Yt=ht.toLngLat(),Ut=Mt.toLngLat(),tn=ln.toLngLat(),fn=this.locationCoordinate(Yt),wn=this.locationCoordinate(Ut),Cn=this.locationCoordinate(tn),Yn=Math.hypot(wn.x-fn.x,wn.y-fn.y),Gn=Math.hypot(Cn.x-fn.x,Cn.y-fn.y);return Math.sqrt(Yn*Gn)*Ve/25e-6},Qe=ht=>{const zt=$e,Mt=je;return{aabb:i.bV(this,X,0,0,0,ht,Mt,zt,this.projection),zoom:0,x:0,y:0,minZ:Mt,maxZ:zt,wrap:ht,fullyVisible:!1}},at=[];let St=[];const yt=l,jt=r.reparseOverscaled?m:l,It=(be-this._centerAltitude)*fe,ft=ht=>{if(!this._elevation||!ht.tileID||!I)return;const zt=this._elevation.getMinMaxForTile(ht.tileID),Mt=ht.aabb;zt?(Mt.min[2]=zt.min,Mt.max[2]=zt.max,Mt.center[2]=(Mt.min[2]+Mt.max[2])/2):(ht.shouldSplit=Qt(ht),ht.shouldSplit||(Mt.min[2]=Mt.max[2]=Mt.center[2]=this._centerAltitude))},At=(ht,zt)=>{if(.707*zt<ht)return 1;const Mt=zt/ht;return Mt/(1.4144271570014144+(Math.pow(1.1,Mt-1.4144271570014144+1)-1)/(1.1-1)-1)},Qt=ht=>{if(ht.zoom<De)return!0;if(ht.zoom===yt)return!1;if(ht.shouldSplit!=null)return ht.shouldSplit;const zt=ht.aabb.distanceX(_e),Mt=ht.aabb.distanceY(_e);let ln=It,Yt=1;if(J){ln=ht.aabb.distanceZ(_e);const Gn=Math.pow(2,ht.zoom),Un=i.aS((ht.y+1)/Gn),tr=i.aS(ht.y/Gn),nr=Math.min(Math.max(G,Un),tr),ri=i.c9(nr)/i.c9(G);if(Yt=nr===G?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,ri/this._mercatorScaleRatio),this.zoom<=i.c6&&ht.zoom===yt-1&&ri>=.9)return!0}else if(T&&(ln=ht.aabb.distanceZ(_e)*fe),this.projection.isReprojectedInTileSpace&&m<=5){const Gn=Math.pow(2,ht.zoom),Un=Ue(new i.aa((ht.x+.5)/Gn,(ht.y+.5)/Gn));Yt=Un>.85?1:Un}if(!I){const Gn=Math.sqrt(zt*zt+Mt*Mt+ln*ln);let Un=(1<<yt-ht.zoom)*ze*Yt;return Un*=At(Math.max(ln,It),Gn),Gn<Un}let Ut=Number.MAX_VALUE,tn=0;const fn=ht.aabb.getCorners(),wn=[];for(const Gn of fn){i.ab.vec3.sub(wn,Gn,_e),J||(T?wn[2]*=fe:wn[2]=It);const Un=i.ab.vec3.dot(wn,this._camera.forward());Un<Ut&&(Ut=Un,tn=Math.abs(wn[2]))}let Cn=(1<<yt-ht.zoom)*ze*Yt;if(Cn*=At(Math.max(tn,It),Ut),Ut<Cn)return!0;const Yn=ht.aabb.closestPoint(Z);return Yn[0]===Z[0]&&Yn[1]===Z[1]};if(this.renderWorldCopies)for(let ht=1;ht<=3;ht++)at.push(Qe(-ht)),at.push(Qe(ht));for(at.push(Qe(0));at.length>0;){const ht=at.pop(),zt=ht.x,Mt=ht.y;let ln=ht.fullyVisible;const Yt=()=>this.projection.name==="globe"&&(ht.y===0||ht.y===(1<<ht.zoom)-1);if(!ln){let Ut=Ce?ht.aabb.intersects(ae):ht.aabb.intersectsFlat(ae);if(Ut===0&&Yt()){const tn=new i.bT(ht.zoom,zt,Mt);Ut=i.bU(this,X,tn,!0).intersects(ae)}if(Ut===0)continue;ln=Ut===2}if(ht.zoom!==yt&&Qt(ht))for(let Ut=0;Ut<4;Ut++){const tn=(zt<<1)+Ut%2,fn=(Mt<<1)+(Ut>>1),wn={aabb:I?ht.aabb.quadrant(Ut):i.bV(this,X,ht.zoom+1,tn,fn,ht.wrap,ht.minZ,ht.maxZ,this.projection),zoom:ht.zoom+1,x:tn,y:fn,wrap:ht.wrap,fullyVisible:ln,tileID:void 0,shouldSplit:void 0,minZ:ht.minZ,maxZ:ht.maxZ};T&&!J&&(wn.tileID=new i.aG(ht.zoom+1===yt?jt:ht.zoom+1,ht.wrap,ht.zoom+1,tn,fn),ft(wn)),at.push(wn)}else{const Ut=ht.zoom===yt?jt:ht.zoom;if(r.minzoom&&r.minzoom>Ut)continue;let tn=0;if(!ln){let Yn=Ce?ht.aabb.intersectsPrecise(ae):ht.aabb.intersectsPreciseFlat(ae);if(Yn===0&&Yt()){const Gn=new i.bT(ht.zoom,zt,Mt);Yn=i.bU(this,X,Gn,!0).intersectsPrecise(ae)}if(Yn===0)continue;if(r.calculateQuadrantVisibility)if(ae.containsPoint(ht.aabb.center))tn=15;else for(let Gn=0;Gn<4;Gn++)ht.aabb.quadrant(Gn).intersects(ae)!==0&&(tn|=1<<Gn)}const fn=Z[0]-(.5+zt+(ht.wrap<<ht.zoom))*(1<<l-ht.zoom),wn=Z[1]-.5-Mt,Cn=ht.tileID?ht.tileID:new i.aG(Ut,ht.wrap,ht.zoom,zt,Mt);r.calculateQuadrantVisibility&&(Cn.visibleQuadrants=tn),St.push({tileID:Cn,distanceSq:fn*fn+wn*wn})}}if(this.fogCullDistSq){const ht=this.fogCullDistSq,zt=this.horizonLineFromTop();St=St.filter(Mt=>{const ln=[0,0,0,1],Yt=[i.ag,i.ag,0,1],Ut=this.calculateFogTileMatrix(Mt.tileID.toUnwrapped());i.ab.vec4.transformMat4(ln,ln,Ut),i.ab.vec4.transformMat4(Yt,Yt,Ut);const tn=i.ab.vec4.min([],ln,Yt),fn=i.ab.vec4.max([],ln,Yt),wn=i.bW(tn,fn);if(wn===0)return!0;let Cn=!1;const Yn=this._elevation;if(Yn&&wn>ht&&zt!==0){const Gn=this.calculateProjMatrix(Mt.tileID.toUnwrapped());let Un;r.isTerrainDEM||(Un=Yn.getMinMaxForTile(Mt.tileID)),Un||(Un={min:je,max:$e});const tr=i.c7(this.rotation),nr=[tr[0]*i.ag,tr[1]*i.ag,Un.max];i.ab.vec3.transformMat4(nr,nr,Gn),Cn=(1-nr[1])*this.height*.5<zt}return wn<ht||Cn})}return St.sort((ht,zt)=>ht.distanceSq-zt.distanceSq).map(ht=>ht.tileID)}resize(r,l){this.width=r,this.height=l,this.pixelsToGLUnits=[2/r,-2/l],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const l=i.aw(r.lat,-i.bX,i.bX),m=this.projection.project(r.lng,l);return new i.P(m.x*this.worldSize,m.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/i.bH(1,this.center.lat)/this.worldSize}setLocationAtPoint(r,l){let m,w;const T=this.centerPoint;if(this.projection.name==="globe"){const N=this.worldSize;m=(l.x-T.x)/N,w=(l.y-T.y)/N}else{const N=this.pointCoordinate(l),G=this.pointCoordinate(T);m=N.x-G.x,w=N.y-G.y}const I=this.locationCoordinate(r);this.setLocation(new i.aa(I.x-m,I.y-w))}setLocation(r){this.center=this.coordinateLocation(r),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(r){return this.projection.locationPoint(this,r)}locationPoint3D(r){return this.projection.locationPoint(this,r,!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r){return this.coordinateLocation(this.pointCoordinate3D(r))}locationCoordinate(r,l){const m=l?i.bH(l,r.lat):void 0,w=this.projection.project(r.lng,r.lat);return new i.aa(w.x,w.y,m)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,l){const m=l??this._centerAltitude,w=[r.x,r.y,0,1],T=[r.x,r.y,1,1];i.ab.vec4.transformMat4(w,w,this.pixelMatrixInverse),i.ab.vec4.transformMat4(T,T,this.pixelMatrixInverse);const I=T[3];i.ab.vec4.scale(w,w,1/w[3]),i.ab.vec4.scale(T,T,1/I);const N=w[2],G=T[2];return{p0:w,p1:T,t:N===G?0:(m-N)/(G-N)}}screenPointToMercatorRay(r){const l=[r.x,r.y,0,1],m=[r.x,r.y,1,1];return i.ab.vec4.transformMat4(l,l,this.pixelMatrixInverse),i.ab.vec4.transformMat4(m,m,this.pixelMatrixInverse),i.ab.vec4.scale(l,l,1/l[3]),i.ab.vec4.scale(m,m,1/m[3]),l[2]=i.bH(l[2],this._center.lat)*this.worldSize,m[2]=i.bH(m[2],this._center.lat)*this.worldSize,i.ab.vec4.scale(l,l,1/this.worldSize),i.ab.vec4.scale(m,m,1/this.worldSize),new i.aq([l[0],l[1],l[2]],i.ab.vec3.normalize([],i.ab.vec3.sub([],m,l)))}rayIntersectionCoordinate(r){const{p0:l,p1:m,t:w}=r,T=i.bH(l[2],this._center.lat),I=i.bH(m[2],this._center.lat);return new i.aa(i.af(l[0],m[0],w)/this.worldSize,i.af(l[1],m[1],w)/this.worldSize,i.af(T,I,w))}pointCoordinate(r,l=this._centerAltitude){return this.projection.pointCoordinate(this,r.x,r.y,l)}pointCoordinate3D(r){if(!this.elevation)return this.pointCoordinate(r);let l=this.projection.pointCoordinate3D(this,r.x,r.y);if(l)return new i.aa(l[0],l[1],l[2]);let m=0,w=this.horizonLineFromTop();if(r.y>w)return this.pointCoordinate(r);const T=.02*w,I=r.clone();for(let N=0;N<10&&w-m>T;N++){I.y=i.af(m,w,.66);const G=this.projection.pointCoordinate3D(this,I.x,I.y);G?(w=I.y,l=G):m=I.y}return l?new i.aa(l[0],l[1],l[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){return this.projection.isPointAboveHorizon(this,r)}isPointOnSurface(r){if(r.y<0||r.y>this.height||r.x<0||r.x>this.width)return!1;if(this.elevation||this.zoom>=i.bY)return!this.isPointAboveHorizon(r);const l=this.pointCoordinate(r);return l.y>=0&&l.y<=1}_coordinatePoint(r,l){const m=l&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,w=[r.x*this.worldSize,r.y*this.worldSize,m+r.toAltitude(),1];return i.ab.vec4.transformMat4(w,w,this.pixelMatrix),w[3]>0?new i.P(w[0]/w[3],w[1]/w[3]):new i.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:r,left:l}=this._edgeInsets,m=this.height-this._edgeInsets.bottom,w=this.width-this._edgeInsets.right,T=this.pointLocation3D(new i.P(l,r)),I=this.pointLocation3D(new i.P(w,r)),N=this.pointLocation3D(new i.P(w,m)),G=this.pointLocation3D(new i.P(l,m));let X=Math.min(T.lng,I.lng,N.lng,G.lng),Z=Math.max(T.lng,I.lng,N.lng,G.lng),J=Math.min(T.lat,I.lat,N.lat,G.lat),Q=Math.max(T.lat,I.lat,N.lat,G.lat);const ae=Math.pow(2,-this.zoom)/16*270,ye=this.projection.name==="globe"?1:4,fe=(be,_e,Ce,ze,De)=>{const $e=(be+Ce)/2,je=(_e+ze)/2,Ve=new i.P($e,je),{lng:Ue,lat:Qe}=this.pointLocation3D(Ve),at=Math.max(0,X-Ue,J-Qe,Ue-Z,Qe-Q);X=Math.min(X,Ue),Z=Math.max(Z,Ue),J=Math.min(J,Qe),Q=Math.max(Q,Qe),(De<ye||at>ae)&&(fe(be,_e,$e,je,De+1),fe($e,je,Ce,ze,De+1))};if(fe(l,r,w,r,1),fe(w,r,w,m,1),fe(w,m,l,m,1),fe(l,m,l,r,1),this.projection.name==="globe"){const[be,_e]=i.bZ(this);be?(Q=90,Z=180,X=-180):_e&&(J=-90,Z=180,X=-180)}return new i.az(new i.bO(X,J),new i.bO(Z,Q))}_getBoundsRectangular(r,l){const{top:m,left:w}=this._edgeInsets,T=this.height-this._edgeInsets.bottom,I=this.width-this._edgeInsets.right,N=new i.P(w,m),G=new i.P(I,m),X=new i.P(I,T),Z=new i.P(w,T);let J=this.pointCoordinate(N,r),Q=this.pointCoordinate(G,r);const ae=this.pointCoordinate(X,l),ye=this.pointCoordinate(Z,l),fe=(be,_e)=>(_e.y-be.y)/(_e.x-be.x);return J.y>1&&Q.y>=0?J=new i.aa((1-ye.y)/fe(ye,J)+ye.x,1):J.y<0&&Q.y<=1&&(J=new i.aa(-ye.y/fe(ye,J)+ye.x,0)),Q.y>1&&J.y>=0?Q=new i.aa((1-ae.y)/fe(ae,Q)+ae.x,1):Q.y<0&&J.y<=1&&(Q=new i.aa(-ae.y/fe(ae,Q)+ae.x,0)),new i.az().extend(this.coordinateLocation(J)).extend(this.coordinateLocation(Q)).extend(this.coordinateLocation(ye)).extend(this.coordinateLocation(ae))}_getBoundsRectangularTerrain(){const r=this.elevation;if(!r.visibleDemTiles.length||r.isUsingMockSource())return this._getBoundsRectangular(0,0);const l=r.visibleDemTiles.reduce((m,w)=>{if(w.dem){const T=w.dem.tree;m.min=Math.min(m.min,T.minimums[0]),m.max=Math.max(m.max,T.maximums[0])}return m},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(l.min*r.exaggeration(),l.max*r.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(r=!0){const l=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,m=this.height/2-l*(1-this._horizonShift);return r?Math.max(0,m):m}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-i.bX,this.maxLat=i.bX,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=i.at(this.minLng)*this.tileSize,this.worldMaxX=i.at(this.maxLng)*this.tileSize,this.worldMinY=i.aA(this.maxLat)*this.tileSize,this.worldMaxY=i.aA(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,l){return this.projection.createTileMatrix(this,l,r)}calculateDistanceTileData(r){const l=r.key,m=this._distanceTileDataCache;if(m[l])return m[l];const w=r.canonical,T=1/this.height,I=this.cameraWorldSize,N=I/this.zoomScale(w.z),G=(w.x+Math.pow(2,w.z)*r.wrap)*N,X=w.y*N,Z=this.point;Z.x*=I/this.worldSize,Z.y*=I/this.worldSize;const J=this.angle,Q=Math.sin(-J),ae=-Math.cos(-J);return m[l]={bearing:[Q,ae],center:[(Z.x-G)*T,(Z.y-X)*T],scale:N/i.ag*T},m[l]}calculateFogTileMatrix(r){const l=r.key,m=this._fogTileMatrixCache;if(m[l])return m[l];const w=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,r);return i.ab.mat4.multiply(w,this.worldToFogMatrix,w),m[l]=new Float32Array(w),m[l]}calculateProjMatrix(r,l=!1,m=!1){const w=r.key;let T;if(T=m?this._expandedProjMatrixCache:l?this._alignedProjMatrixCache:this._projMatrixCache,T[w])return T[w];const I=this.calculatePosMatrix(r,this.worldSize);let N;return N=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:m?this.expandedFarZProjMatrix:l?this.alignedProjMatrix:this.projMatrix,i.ab.mat4.multiply(I,N,I),T[w]=new Float32Array(I),T[w]}calculatePixelsToTileUnitsMatrix(r){const l=r.tileID.key,m=this._pixelsToTileUnitsCache;if(m[l])return m[l];const w=i.b_(r,this);return m[l]=w,m[l]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const r=1/this.worldSize,l=i.ab.mat4.fromScaling([],[r,r,r]);return i.ab.mat4.multiply(l,l,this.globeMatrix),l}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const r=this._elevation;this._updateCameraState();const l=i.bH(1,this._center.lat)*this.worldSize,m=this._computeCameraPosition(l),w=this._camera.forward(),T=i.bH(1,this._center.lat);m[2]/=T,w[2]/=T,i.ab.vec3.normalize(w,w);const I=r.raycast(m,w,r.exaggeration());if(I){const N=i.ab.vec3.scaleAndAdd([],m,w,I),G=new i.aa(N[0],N[1],i.bH(N[2],i.aS(N[1]))),X=(G.z+i.ab.vec3.length([G.x-m[0],G.y-m[1],G.z-m[2]*T]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(X),this._centerAltitude=G.toAltitude(),this._center=this.coordinateLocation(G),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(r=!1){if(!this._elevation)return;const l=this._elevation,m=i.bH(1,this._center.lat)*this.worldSize,w=this._computeCameraPosition(m),T=l.getAtPointOrZero(new i.aa(...w)),I=this.pixelsPerMeter/this.worldSize*T,N=this._minimumHeightOverTerrain(),G=w[2]-I;if(G<=N)if(G<0||r){const X=this.locationCoordinate(this._center,this._centerAltitude),Z=[w[0],w[1],X.z-w[2]],J=i.ab.vec3.length(Z);Z[2]-=(N-G)/this._pixelsPerMercatorPixel;const Q=i.ab.vec3.length(Z);if(Q===0)return;i.ab.vec3.scale(Z,Z,J/Q*this._pixelsPerMercatorPixel),this._camera.position=[w[0],w[1],X.z*this._pixelsPerMercatorPixel-Z[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||r){const Q=this.center;return Q.lat=i.aw(Q.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!r)&&(Q.lng=i.aw(Q.lng,this.minLng,this.maxLng)),this.center=Q,void(this._constraining=!1)}const l=this._unmodified,{x:m,y:w}=this.point;let T=0,I=m,N=w;const G=this.width/2,X=this.height/2,Z=this.worldMinY*this.scale,J=this.worldMaxY*this.scale;if(w-X<Z&&(N=Z+X),w+X>J&&(N=J-X),J-Z<this.height&&(T=Math.max(T,this.height/(J-Z)),N=(J+Z)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Q=this.worldMinX*this.scale,ae=this.worldMaxX*this.scale,ye=this.worldSize/2-(Q+ae)/2;I=(m+ye+this.worldSize)%this.worldSize-ye,I-G<Q&&(I=Q+G),I+G>ae&&(I=ae-G),ae-Q<this.width&&(T=Math.max(T,this.width/(ae-Q)),I=(ae+Q)/2)}I===m&&N===w||(this.center=this.unproject(new i.P(I,N))),T&&(this.zoom+=this.scaleZoom(T)),this._constrainCamera(),this._unmodified=l,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,l=this.projection.name==="globe",m=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=i.bH(1,this.center.lat)/i.bH(1,i.c8));const w=i.b$(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,w),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const T=this.projection.zAxisUnit==="meters"?m:1,I=this._camera.getWorldToCamera(this.worldSize,T);let N;const G=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(G[8]=2*-r.x/this.width,G[9]=2*r.y/this.height,this.isOrthographic){let Qe=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),at=Qe*this.aspect,St=-at,yt=-Qe;at-=r.x,St-=r.x,Qe+=r.y,yt+=r.y,N=this._camera.getCameraToClipOrthographic(St,at,yt,Qe,this._nearZ,this._farZ),((jt,It,ft,At)=>{for(let Qt=0;Qt<16;Qt++)jt[Qt]=Qc(It[Qt],ft[Qt],At)})(N,N,G,lc(this.pitch>=15?1:this.pitch/15))}else N=G;const X=i.ab.mat4.mul([],G,I);let Z=i.ab.mat4.mul([],N,I);if(this.projection.isReprojectedInTileSpace){const Qe=this.locationCoordinate(this.center),at=i.ab.mat4.identity([]);i.ab.mat4.translate(at,at,[Qe.x*this.worldSize,Qe.y*this.worldSize,0]),i.ab.mat4.multiply(at,at,i.c0(this)),i.ab.mat4.translate(at,at,[-Qe.x*this.worldSize,-Qe.y*this.worldSize,0]),i.ab.mat4.multiply(Z,Z,at),i.ab.mat4.multiply(X,X,at),this.inverseAdjustmentMatrix=i.c1(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=i.ab.mat4.scale([],Z,[this.worldSize,this.worldSize,this.worldSize/T,1]),this.projMatrix=Z,this.invProjMatrix=i.ab.mat4.invert(new Float64Array(16),this.projMatrix),l){const Qe=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Qe[8]=2*-r.x/this.width,Qe[9]=2*r.y/this.height,this.expandedFarZProjMatrix=i.ab.mat4.mul([],Qe,I)}else this.expandedFarZProjMatrix=this.projMatrix;const J=i.ab.mat4.invert([],N);this.frustumCorners=i.c2.fromInvProjectionMatrix(J,this.horizonLineFromTop(),this.height),this.cameraFrustum=i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!l);const Q=new Float32Array(16);i.ab.mat4.identity(Q),i.ab.mat4.scale(Q,Q,[1,-1,1]),i.ab.mat4.rotateX(Q,Q,this._pitch),i.ab.mat4.rotateZ(Q,Q,this.angle);const ae=i.ab.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=i.ab.mat4.clone(ae);const ye=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;ae[8]=2*-r.x/this.width,ae[9]=2*(r.y+ye)/this.height,this.skyboxMatrix=i.ab.mat4.multiply(Q,ae,Q);const fe=this.point,be=fe.x,_e=fe.y,Ce=this.width%2/2,ze=this.height%2/2,De=Math.cos(this.angle),$e=Math.sin(this.angle),je=be-Math.round(be)+De*Ce+$e*ze,Ve=_e-Math.round(_e)+De*ze+$e*Ce,Ue=new Float64Array(Z);if(i.ab.mat4.translate(Ue,Ue,[je>.5?je-1:je,Ve>.5?Ve-1:Ve,0]),this.alignedProjMatrix=Ue,Z=i.ab.mat4.create(),i.ab.mat4.scale(Z,Z,[this.width/2,-this.height/2,1]),i.ab.mat4.translate(Z,Z,[1,-1,0]),this.labelPlaneMatrix=Z,Z=i.ab.mat4.create(),i.ab.mat4.scale(Z,Z,[1,-1,1]),i.ab.mat4.translate(Z,Z,[-1,-1,0]),i.ab.mat4.scale(Z,Z,[2/this.width,2/this.height,1]),this.glCoordMatrix=Z,this.pixelMatrix=i.ab.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,X),this._calcFogMatrices(),this._distanceTileDataCache={},Z=i.ab.mat4.invert(new Float64Array(16),this.pixelMatrix),!Z)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=Z,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=i.c3(this);const Qe=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=i.ab.vec3.transformMat4(Qe,Qe,I),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=Z;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSizeForFog,l=this.cameraPixelsPerMeter,m=this._camera.position,w=1/this.height/this._pixelsPerMercatorPixel,T=[r,r,l];i.ab.vec3.scale(T,T,w),i.ab.vec3.scale(m,m,-1),i.ab.vec3.multiply(m,m,T);const I=i.ab.mat4.create();i.ab.mat4.translate(I,I,m),i.ab.mat4.scale(I,I,T),this.mercatorFogMatrix=I,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,l,w)}_computeCameraPosition(r){const l=(r=r||this.pixelsPerMeter)/this.pixelsPerMeter,m=this._camera.forward(),w=this.point,T=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*l-r/this.worldSize*this._centerAltitude;return[w.x/this.worldSize-m[0]*T,w.y/this.worldSize-m[1]*T,r/this.worldSize*this._centerAltitude-m[2]*T]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(r){const l=this._maxCameraBoundsDistance()*Math.cos(this._pitch),m=this._camera.position[2],w=r[2];let T=1;this.projection.wrap&&(this.center=this.center.wrap()),w>0&&(T=Math.min((l-m)/w,1)),this._camera.position=i.ab.vec3.scaleAndAdd([],this._camera.position,r,T),this._updateStateFromCamera()}_updateStateFromCamera(){const r=this._camera.position,l=this._camera.forward(),{pitch:m,bearing:w}=this._camera.getPitchBearing(),T=i.bH(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,I=this._mercatorZfromZoom(this._maxZoom)*Math.cos(i.ai(this._maxPitch)),N=Math.max((r[2]-T)/Math.cos(m),I),G=this._zoomFromMercatorZ(N);i.ab.vec3.scaleAndAdd(r,r,l,N),this._pitch=i.aw(m,i.ai(this.minPitch),i.ai(this.maxPitch)),this.angle=i.bF(w,-Math.PI,Math.PI),this._setZoom(i.aw(G,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new i.aa(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(r*this.tileSize))}zoomFromMercatorZAdjusted(r){let l=0,m=i.bY,w=0,T=1/0;for(;m-l>1e-6&&m>l;){const I=l+.5*(m-l),N=this.tileSize*Math.pow(2,I),G=this.getCameraToCenterDistance(this.projection,I,N),X=this.scaleZoom(G/(r*this.tileSize)),Z=Math.abs(I-X);Z<T&&(T=Z,w=I),I<X?l=I:m=I}return w}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(i.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(r,l){const m=Math.min(r.x,l.x),w=Math.max(r.x,l.x),T=Math.min(r.y,l.y),I=Math.max(r.y,l.y);if(T<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const N=[new i.P(m,T),new i.P(w,I),new i.P(m,I),new i.P(w,T)],G=this.renderWorldCopies?-3:0,X=this.renderWorldCopies?4:1;for(const Z of N){const J=this.pointRayIntersection(Z);if(J.t<0)return!0;const Q=this.rayIntersectionCoordinate(J);if(Q.x<G||Q.y<0||Q.x>X||Q.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+i.c4(this.fovAboveCenter)>88||this.anyCornerOffEdge(new i.P(0,0),new i.P(this.width,this.height))}zoomDeltaToMovement(r,l){const m=i.ab.vec3.length(i.ab.vec3.sub([],this._camera.position,r)),w=this._zoomFromMercatorZ(m)+l;return m-this._mercatorZfromZoom(w)}getCameraPoint(){if(this.projection.name==="globe"){const r=function([l,m,w],T){const I=[l,m,w,1];i.ab.vec4.transformMat4(I,I,T);const N=I[3]=Math.max(I[3],1e-6);return I[0]/=N,I[1]/=N,I[2]/=N,I}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new i.P(r[0],r[1])}{const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.P(0,r))}}getCameraToCenterDistance(r,l=this.zoom,m=this.worldSize){const w=i.b$(r,l,this.width,this.height,1024),T=r.pixelSpaceConversion(this.center.lat,m,w);let I=.5/Math.tan(.5*this._fov)*this.height*T;return this.isOrthographic&&(I=Qc(1,I,lc(this.pitch>=15?1:this.pitch/15))),I}getWorldToCameraMatrix(){const r=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&i.ab.mat4.multiply(r,r,this.globeMatrix),r}getFrustum(r){return i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r,this.projection.zAxisUnit==="meters")}}const ru=(p,r)=>{if(r>0&&p.terrain&&i.w("Cutoff is currently disabled on terrain"),r<=0||p.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const l=p.transform,m=Math.max(Math.abs(l._zoom-(p.minCutoffZoom-1)),1),w=l.isLODDisabled(!1)?i.ac(60,45,l.pitch):i.ac(30,15,l.pitch),T=l._farZ-l._nearZ,I=r*l.height,N=((1-(G=w))*l.cameraToCenterDistance+G*(l._farZ+I))*m;var G;return{shouldRenderCutoff:w<1,uniformValues:{u_cutoff_params:[l._nearZ,l._farZ,(N-l._nearZ)/T,(N-I-l._nearZ)/T]}}},Oa={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Vs{constructor(r,l){this.aabb=r,this.lastCascade=l}}class Kf{add(r,l){const m=this.receivers[r.key];m!==void 0?(m.aabb.min[0]=Math.min(m.aabb.min[0],l.min[0]),m.aabb.min[1]=Math.min(m.aabb.min[1],l.min[1]),m.aabb.min[2]=Math.min(m.aabb.min[2],l.min[2]),m.aabb.max[0]=Math.max(m.aabb.max[0],l.max[0]),m.aabb.max[1]=Math.max(m.aabb.max[1],l.max[1]),m.aabb.max[2]=Math.max(m.aabb.max[2],l.max[2])):this.receivers[r.key]=new Vs(l,null)}clear(){this.receivers={}}get(r){return this.receivers[r.key]}computeRequiredCascades(r,l,m){const w=i.cd.fromPoints(r.points);let T=0;for(const I in this.receivers){const N=this.receivers[I];if(!N||!w.intersectsAabb(N.aabb))continue;N.aabb.min=w.closestPoint(N.aabb.min),N.aabb.max=w.closestPoint(N.aabb.max);const G=N.aabb.getCorners();for(let X=0;X<m.length;X++){let Z=!0;for(const J of G){const Q=[J[0]*l,J[1]*l,J[2]];if(i.ab.vec3.transformMat4(Q,Q,m[X].matrix),Q[0]<-1||Q[0]>1||Q[1]<-1||Q[1]>1){Z=!1;break}}if(N.lastCascade=X,T=Math.max(T,X),Z)break}}return T+1}}class Ia{constructor(r){this.painter=r,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new Kf,this._depthMode=new qn(r.context.gl.LEQUAL,qn.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,r.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),r.tp.registerParameter(Oa,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),r.tp.registerParameter(Oa,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),r.tp.registerParameter(Oa,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),r.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const r of this._cascades)r.texture.destroy(),r.framebuffer.destroy();this._cascades=[]}updateShadowParameters(r,l){const m=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!l||!l.properties)return;const w=l.properties.get("shadow-intensity");if(!l.shadowsEnabled()||w<=0||(this._shadowLayerCount=m.style.order.reduce((ye,fe)=>{const be=m.style._mergedLayers[fe];return ye+(be.hasShadowPass()&&!be.isHidden(r.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const T=m.context,I=Oa.shadowMapResolution,N=Oa.shadowMapResolution;if(this._cascades.length===0||Oa.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ye=0;ye<Oa.cascadeCount;++ye){const fe=m._shadowMapDebug,be=T.gl,_e=T.createFramebuffer(I,N,fe,"texture"),Ce=new i.T(T,{width:I,height:N,data:null},be.DEPTH_COMPONENT16);if(_e.depthAttachment.set(Ce.texture),fe){const ze=new i.T(T,{width:I,height:N,data:null},be.RGBA8);_e.colorAttachment.set(ze.texture)}this._cascades.push({framebuffer:_e,texture:Ce,matrix:[],far:0,boundingSphereRadius:0,frustum:new i.bR,scale:0})}}this.shadowDirection=iu(l);let G=0;if(r.elevation){const ye=r.elevation,fe=[1e4,-1e4];ye.visibleDemTiles.filter(be=>be.dem).forEach(be=>{const _e=be.dem.tree;fe[0]=Math.min(fe[0],_e.minimums[0]),fe[1]=Math.max(fe[1],_e.maximums[0])}),fe[0]!==1e4&&(G=(fe[1]-fe[0])*ye.exaggeration())}const X=1.5*r.cameraToCenterDistance,Z=3*X,J=new Float64Array(16);for(let ye=0;ye<this._cascades.length;++ye){const fe=this._cascades[ye];let be=r.height/50,_e=1;Oa.cascadeCount===1?_e=Z:ye===0?_e=X:(be=X,_e=Z);const[Ce,ze]=Pu(r,this.shadowDirection,be,_e,Oa.shadowMapResolution,G);fe.scale=r.scale,fe.matrix=Ce,fe.boundingSphereRadius=ze,i.ab.mat4.invert(J,fe.matrix),fe.frustum=i.bR.fromInvProjectionMatrix(J,1,0,!0),fe.far=_e}const Q=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[Q].far,this._cascades[Q].far],this._uniformValues.u_shadow_intensity=w,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Oa.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Oa.shadowMapResolution,this._uniformValues.u_shadowmap_0=Ma.ShadowMap0,this._uniformValues.u_shadowmap_1=Ma.ShadowMap0+1,this._groundShadowTiles=m.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const ae=m.transform.elevation;for(const ye of this._groundShadowTiles){let fe={min:0,max:0};if(ae){const be=ae.getMinMaxForTile(ye);be&&(fe=be)}this.addShadowReceiver(ye.toUnwrapped(),fe.min,fe.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(r){this._enabled=r}drawShadowPass(r,l){if(!this.enabled)return;const m=this.painter,w=m.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(m.transform.getFrustum(0),m.transform.worldSize,this._cascades),w.viewport.set([0,0,Oa.shadowMapResolution,Oa.shadowMapResolution]);for(let T=0;T<this._numCascadesToRender;++T){m.currentShadowCascade=T,w.bindFramebuffer.set(this._cascades[T].framebuffer.framebuffer),w.clear({color:i.aj.white,depth:1});for(const I of r.order){const N=r._mergedLayers[I];if(!N.hasShadowPass()||N.isHidden(m.transform.zoom))continue;const G=r.getLayerSourceCache(N),X=G?l[G.id]:void 0;(N.type==="model"||X&&X.length)&&m.renderLayer(m,G,N,X)}}m.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const r=this.painter,l=r.style,m=r.context,w=l.directionalLight,T=l.ambientLight;if(!w||!T)return;const I=[],N=ru(r,r.longestCutoffRange);N.shouldRenderCutoff&&I.push("RENDER_CUTOFF"),I.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&I.push("NORMAL_OFFSET");const G=Uh(l,w,T),X=new qn(m.gl.LEQUAL,qn.ReadOnly,r.depthRangeFor3D);for(const Z of this._groundShadowTiles){const J=Z.toUnwrapped(),Q=r.isTileAffectedByFog(Z),ae=r.getOrCreateProgram("groundShadow",{defines:I,overrideFog:Q});this.setupShadows(J,ae),r.uploadCommonUniforms(m,ae,J,null,N);const ye={u_matrix:r.transform.calculateProjMatrix(J),u_ground_shadow_factor:G};ae.draw(r,m.gl.TRIANGLES,X,Qn.disabled,vr.multiply,Wn.disabled,ye,"ground_shadow",r.tileExtentBuffer,r.quadTriangleIndexBuffer,r.tileExtentSegments,{},r.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?vr.unblended:vr.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(r){const l=this.painter.transform,m=l.calculatePosMatrix(r,l.worldSize);return i.ab.mat4.multiply(m,this._cascades[this.painter.currentShadowCascade].matrix,m),Float32Array.from(m)}calculateShadowPassMatrixFromMatrix(r){return i.ab.mat4.multiply(r,this._cascades[this.painter.currentShadowCascade].matrix,r),Float32Array.from(r)}setupShadows(r,l,m,w=0){if(!this.enabled)return;const T=this.painter.transform,I=this.painter.context,N=I.gl,G=this._uniformValues,X=new Float64Array(16),Z=T.calculatePosMatrix(r,T.worldSize);for(let J=0;J<this._cascades.length;J++)i.ab.mat4.multiply(X,this._cascades[J].matrix,Z),G[J===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(X),I.activeTexture.set(N.TEXTURE0+Ma.ShadowMap0+J),this._cascades[J].texture.bind(N.NEAREST,N.CLAMP_TO_EDGE);if(this.useNormalOffset=!!m,this.useNormalOffset){const J=i.cc(r.canonical),Q=2/T.tileSize*i.ag/Oa.shadowMapResolution,ae=Q*this._cascades[0].boundingSphereRadius,ye=Q*this._cascades[this._cascades.length-1].boundingSphereRadius,fe=(m==="vector-tile"?1:3)/Math.pow(2,w-r.canonical.z-(1-T.zoom+Math.floor(T.zoom)));G.u_shadow_normal_offset=[J,ae*fe,ye*fe],G.u_shadow_bias=[6e-5,.0012,.012]}else G.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(I,G)}setupShadowsFromMatrix(r,l,m=!1){if(!this.enabled)return;const w=this.painter.context,T=w.gl,I=this._uniformValues,N=new Float64Array(16);for(let G=0;G<Oa.cascadeCount;G++)i.ab.mat4.multiply(N,this._cascades[G].matrix,r),I[G===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(N),w.activeTexture.set(T.TEXTURE0+Ma.ShadowMap0+G),this._cascades[G].texture.bind(T.NEAREST,T.CLAMP_TO_EDGE);if(this.useNormalOffset=m,m){const G=Oa.normalOffset;I.u_shadow_normal_offset=[1,G,G],I.u_shadow_bias=[6e-5,.0012,.012]}else I.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(w,I)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(r,l,m,w){if(w[2]>=0)return{};const T=function(G,X,Z){const J=Z/(1<<G.canonical.z);return new i.cd([G.canonical.x*J+G.wrap*Z,G.canonical.y*J+G.wrap*Z,0],[(G.canonical.x+1)*J+G.wrap*Z,(G.canonical.y+1)*J+G.wrap*Z,X])}(r,l,m).getCorners(),I=l/-w[2];w[0]<0?(i.ab.vec3.add(T[0],T[0],[w[0]*I,0,0]),i.ab.vec3.add(T[3],T[3],[w[0]*I,0,0])):w[0]>0&&(i.ab.vec3.add(T[1],T[1],[w[0]*I,0,0]),i.ab.vec3.add(T[2],T[2],[w[0]*I,0,0])),w[1]<0?(i.ab.vec3.add(T[0],T[0],[0,w[1]*I,0]),i.ab.vec3.add(T[1],T[1],[0,w[1]*I,0])):w[1]>0&&(i.ab.vec3.add(T[2],T[2],[0,w[1]*I,0]),i.ab.vec3.add(T[3],T[3],[0,w[1]*I,0]));const N={};return N.vertices=T,N.planes=[gs(T[1],T[0],T[4]),gs(T[2],T[1],T[5]),gs(T[3],T[2],T[6]),gs(T[0],T[3],T[7])],N}addShadowReceiver(r,l,m){this._receivers.add(r,i.cd.fromTileIdAndHeight(r,l,m))}getMaxCascadeForTile(r){const l=this._receivers.get(r);return l&&l.lastCascade?l.lastCascade:0}}function gs(p,r,l){const m=i.ab.vec3.sub([],l,r),w=i.ab.vec3.sub([],p,r),T=i.ab.vec3.cross([],m,w),I=i.ab.vec3.length(T);return I===0?[0,0,1,0]:(i.ab.vec3.scale(T,T,1/I),[T[0],T[1],T[2],-i.ab.vec3.dot(T,r)])}function iu(p){const r=p.properties.get("direction"),l=i.cb(r.x,r.y,r.z);l[2]=i.aw(l[2],0,75);const m=i.ce([l[0],l[1],l[2]]);return i.ab.vec3.fromValues(m.x,m.y,m.z)}function Uh(p,r,l){const m=r.properties.get("color-use-theme")==="none",w=r.properties.get("color"),T=r.properties.get("intensity"),I=r.properties.get("direction"),N=[I.x,I.y,I.z],G=l.properties.get("color-use-theme")==="none",X=l.properties.get("color"),Z=l.properties.get("intensity"),J=Math.max(i.ab.vec3.dot([0,0,1],N),0),Q=[0,0,0];i.ab.vec3.scale(Q,X.toRenderColor(G?null:p.getLut(r.scope)).toArray01Linear().slice(0,3),Z);const ae=[0,0,0];return i.ab.vec3.scale(ae,w.toRenderColor(m?null:p.getLut(l.scope)).toArray01Linear().slice(0,3),J*T),i.cf([Q[0]>0?Q[0]/(Q[0]+ae[0]):0,Q[1]>0?Q[1]/(Q[1]+ae[1]):0,Q[2]>0?Q[2]/(Q[2]+ae[2]):0])}function Pu(p,r,l,m,w,T){const I=p.zoom,N=p.scale,G=p.worldSize,X=1/G,Z=p.aspect,J=Math.sqrt(1+Z*Z)*Math.tan(.5*p.fovX),Q=J*J,ae=m-l,ye=m+l;let fe,be;Q>ae/ye?(fe=m,be=m*J):(fe=.5*ye*(1+Q),be=.5*Math.sqrt(ae*ae+2*(m*m+l*l)*Q+ye*ye*Q*Q));const _e=p.projection.pixelsPerMeter(p.center.lat,G),Ce=p._camera.getCameraToWorldMercator(),ze=[0,0,-fe*X];i.ab.vec3.transformMat4(ze,ze,Ce);let De=be*X;const $e=p._edgeInsets;if(!($e.left===0&&$e.top===0&&$e.right===0&&$e.bottom===0||$e.left===$e.right&&$e.top===$e.bottom)){const ln=p._camera.getWorldToCamera(p.worldSize,p.projection.zAxisUnit==="meters"?_e:1),Yt=p._camera.getCameraToClipPerspective(p._fov,p.width/p.height,l,m);Yt[8]=2*-p.centerOffset.x/p.width,Yt[9]=2*p.centerOffset.y/p.height;const Ut=new Float64Array(16);i.ab.mat4.mul(Ut,Yt,ln);const tn=new Float64Array(16);i.ab.mat4.invert(tn,Ut);const fn=i.bR.fromInvProjectionMatrix(tn,G,I,!0);for(const wn of fn.points){const Cn=((je=wn)[0]/=N,je[1]/=N,je[2]=i.bH(je[2],p._center.lat),je);De=Math.max(De,i.ab.vec3.len(i.ab.vec3.subtract([],ze,Cn)))}}var je;De*=w/(w-1);const Ve=Math.acos(r[2]),Ue=Math.atan2(-r[0],-r[1]),Qe=new io;Qe.position=ze,Qe.setPitchBearing(Ve,Ue);const at=Qe.getWorldToCamera(G,_e),St=De*G,yt=Math.min(p._mercatorZfromZoom(17)*G*-2,-2*St),jt=Qe.getCameraToClipOrthographic(-St,St,-St,St,yt,(St+T*_e)/r[2]),It=new Float64Array(16);i.ab.mat4.multiply(It,jt,at);const ft=i.ab.vec3.fromValues(Math.floor(1e6*ze[0])/1e6*G,Math.floor(1e6*ze[1])/1e6*G,0),At=.5*w,Qt=[0,0,0];i.ab.vec3.transformMat4(Qt,ft,It),i.ab.vec3.scale(Qt,Qt,At);const ht=[Math.floor(Qt[0]),Math.floor(Qt[1]),Math.floor(Qt[2])],zt=[0,0,0];i.ab.vec3.sub(zt,Qt,ht),i.ab.vec3.scale(zt,zt,-1/At);const Mt=new Float64Array(16);return i.ab.mat4.identity(Mt),i.ab.mat4.translate(Mt,Mt,zt),i.ab.mat4.multiply(It,Mt,It),[It,St]}class Vh extends i.E{constructor(r){super(),this.requestManager=r,this.models={"":{}},this.modelUris={"":{}},this.numModelsLoading={}}loadModel(r,l){return i.aM(this.requestManager.transformRequest(l,i.R.Model).url).then(m=>{if(!m)return;const w=i.aN(m),T=new i.aO(r,void 0,void 0,w);return T.computeBoundsAndApplyParent(),T}).catch(m=>{if(m&&m.status===404)return null;this.fire(new i.y(new Error(`Could not load model ${r} from ${l}: ${m.message}`)))})}load(r,l,m={keepNumReferences:!1}){this.models[l]||(this.models[l]={});const w=Object.keys(r);this.numModelsLoading[l]=(this.numModelsLoading[l]||0)+w.length;const T=[];for(const I of w)T.push(this.loadModel(I,r[I]));Promise.allSettled(T).then(I=>{for(let N=0;N<I.length;N++){const{status:G,value:X}=I[N];if(G==="fulfilled"&&X){const Z=this.models[l][w[N]];this.models[l][w[N]]={model:X,numReferences:m.keepNumReferences&&Z?Z.numReferences:1}}}this.numModelsLoading[l]-=w.length,this.fire(new i.z("data",{dataType:"style"}))}).catch(I=>{this.fire(new i.y(new Error(`Could not load models: ${I.message}`)))})}isLoaded(){for(const r in this.numModelsLoading)if(this.numModelsLoading[r]>0)return!1;return!0}hasModel(r,l){return!!this.getModel(r,l)}getModel(r,l){return this.models[l]||(this.models[l]={}),this.models[l][r]?this.models[l][r].model:void 0}addModel(r,l,m){this.models[m]||(this.models[m]={}),this.modelUris[m]||(this.modelUris[m]={}),this.hasModel(r,m)&&this.models[m][r].numReferences++,this.modelUris[m][r]=this.requestManager.normalizeModelURL(l),this.load({[r]:this.modelUris[m][r]},m)}addModels(r,l){this.models[l]||(this.models[l]={}),this.modelUris[l]||(this.modelUris[l]={});const m=this.modelUris[l];for(const w in r)this.models[l][w]={},m[w]=this.requestManager.normalizeModelURL(r[w]);this.load(m,l,{keepNumReferences:!0})}reloadModels(r){this.load(this.modelUris[r],r)}addModelsFromBucket(r,l){this.models[l]||(this.models[l]={}),this.modelUris[l]||(this.modelUris[l]={});const m={};for(const w of r)this.hasModel(w,l)?this.models[l][w].numReferences++:(this.modelUris[l][w]=this.requestManager.normalizeModelURL(w),m[w]=this.modelUris[l][w]);this.load(m,l)}removeModel(r,l){if(this.models[l]&&this.models[l][r]&&(this.models[l][r].numReferences--,this.models[l][r].numReferences===0)){const m=this.models[l][r].model;delete this.models[l][r],delete this.modelUris[l][r],m.destroy()}}listModels(r){return this.models[r]||(this.models[r]={}),Object.keys(this.models[r])}upload(r,l){this.models[l]||(this.models[l]={});for(const m in this.models[l])this.models[l][m].model&&this.models[l][m].model.upload(r.context)}}const qh=new i.a5({data:new i.a6(i.a3.colorTheme.data)}),Jo={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function ys(p){return p=p||{},Object.assign(p,Jo)}class C extends i.E{constructor(r){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._selectedLevel=void 0,this._floorplanStates={},i.aP(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=r,this._checkFloorplanVisible(!0),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(r=>{r.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new i.y(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=r.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=r.stylesheet.indoor.buildingFeaturesetId,this._scope=r.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:r=>(r.feature&&r.feature.properties.floorplan&&this.selectFloorplan(r.feature.properties.floorplan),!0)}),this._checkFloorplanVisible(!0)}_onMove(){this._checkFloorplanVisible(!1)}_checkFloorplanVisible(r){if(!this._queryFeatureSetId||!this._map.isStyleLoaded()||this._map.transform.zoom<13)return;this._indoorData&&!function(I,N){const[G,X]=I,{center:Z,radius:J}=N,[Q,ae]=Z,ye=Math.abs(G-Q);return Math.sqrt((ye>180?360-ye:ye)**2+(X-ae)**2)<=J}([this._map.getCenter().lng,this._map.getCenter().lat],this._indoorData.circumCircle)&&(this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new i.z("floorplangone")));const l={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},m=new i.P(this._map.transform.width/2,this._map.transform.height/2),w=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],T=this._map.queryRenderedFeatures(r?w:m,l);T.length>0&&(this._selectedFloorplan&&T[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=T[0],this._floorplanSelected(!1)))}_floorplanSelected(r){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._indoorData.circumCircle=function(T){const[[I,N],[G,X]]=T,Z=(G-I+360)%360,J=Z>180?360-Z:Z;return{center:[(I+J/2+360)%360,(N+X)/2],radius:Math.sqrt(J**2+(X-N)**2)/2}}(this._indoorData.extent),this._floorplanStates[this._indoorData.id]||(this._floorplanStates[this._indoorData.id]={});const l=this._floorplanStates[this._indoorData.id].selectedBuilding,m=this._floorplanStates[this._indoorData.id].selectedLevel;let w;if(this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",this._indoorData.floorplanIDs),this._selectedLevel)for(const T of this._indoorData.levels)T.id===this._selectedLevel.id&&(w=T.id);if(this.fire(new i.z("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:w})),l){const T=this._indoorData.buildings.find(I=>I.id===l);this._buildingSelected(T,!1)}else this._indoorData.buildings.length>0&&this._buildingSelected(this._indoorData.buildings[0],!1);if(m){const T=this._indoorData.levels.find(I=>I.id===m);this._updateLevels(T,r)}else r&&this._indoorData["default-levels"].length>0&&this.selectLevel(this._indoorData["default-levels"][0])}_buildingSelected(r,l){l&&r&&r.extent&&this._map.fitBounds(r.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=r?r.id:void 0;const m=this._indoorData.levels.filter(w=>r.levels.includes(w.id));this.fire(new i.z("buildingselected",{buildingId:r.id,levels:m}))}_levelSelected(r){if(r==="overview")this._updateLevels(void 0,!0);else{const l=this._indoorData.levels.find(m=>m.id===r);this._updateLevels(l,!0)}this.fire(new i.z("levelselected",{levelId:r==="overview"?void 0:r}))}_updateLevels(r,l){if(!r)return this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",[]]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._floorplanStates[this._indoorData.id].selectedLevel=void 0,void(l&&this._indoorData.extent&&this._map.fitBounds(this._indoorData.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}));function m(X){const Z=X.indexOf("/floor/");if(Z===-1)return X;const J=Z+7,Q=X.indexOf("/",J);return Q===-1?X.slice(J):X.slice(J,Q)}this._selectedLevel=r,this._floorplanStates[this._indoorData.id].selectedLevel=r?r.id:void 0;const w=[],T={},I={},N={},G={};for(const X of this._indoorData.levels)if(w.push(X.id),T[X.id]=X.height,I[X.id]=X.base,r){if(this.mergeFloors){const Z=m(r.id),J=m(X.id);N[X.id]=J===Z?"true":"false"}else N[X.id]=X.id===r.id?"true":"false";G[X.id]=X.base<r.base?"true":"false"}else G[X.id]=!0;if(this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",w]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",T]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",I]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",N]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",G]),r&&(this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!!r.isUnderground),l&&r.extent)){const X=this._map.cameraForBounds(r.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),Z=this._map.getZoom(),J=X.zoom?Math.abs(Z-X.zoom):0;this._map.fitBounds(r.extent,J>=1?{pitch:this._map.getPitch(),bearing:this._map.getBearing()}:{pitch:this._map.getPitch(),bearing:this._map.getBearing(),zoom:Z})}}selectFloorplan(r){const l={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},m=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],w=this._map.queryRenderedFeatures(m,l);if(w.length>0){for(const T of w)if(JSON.parse(T.properties["indoor-data"]).floorplanIDs.includes(r)){this._selectedFloorplan=T,this._floorplanSelected(!0);break}}}selectBuilding(r){const l=this._indoorData.buildings.find(m=>m.id===r);this._buildingSelected(l,!0)}selectLevel(r){this._levelSelected(r)}}function g(p){if(!p.metadata||!p.metadata.content_area)return;const r=i.q.devicePixelRatio,{left:l,top:m,width:w,height:T}=p.metadata.content_area,I=l*r,N=m*r;return[I,N,I+w*r,N+T*r]}function x(p){if(p)return p.map(([r,l])=>[r*i.q.devicePixelRatio,l*i.q.devicePixelRatio])}const O=(p,r)=>ls(p,r&&r.filter(l=>l.identifier!=="source.canvas")),$=i.ay(_r,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport"]),te=i.ay(_r,["setCenter","setZoom","setBearing","setPitch"]),he=new Set(["background","sky","slot","custom"]),Te={version:8,layers:[],sources:{}},Be={duration:300,delay:0};class et extends i.E{constructor(r,l={}){super(),this.map=r,this.scope=l.scope||"",this.globalId=null,this.fragments=[],this.importDepth=l.importDepth||0,this.importsCache=l.importsCache||new Map,this.resolvedImports=l.resolvedImports||new Set,this.transition=i.l({},Be),this._buildingIndex=new Ya(this),this.crossTileSymbolIndex=new Bh,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=l.styleChanges||new jr,this.dispatcher=l.dispatcher?l.dispatcher:new i.D(i.ci(),this),l.imageManager?this.imageManager=l.imageManager:(this.imageManager=new Ur(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=l.glyphManager?l.glyphManager:new i.cj(r._requestManager,l.localFontFamily?i.ck.all:l.localIdeographFontFamily?i.ck.ideographs:i.ck.none,l.localFontFamily||l.localIdeographFontFamily),l.modelManager?this.modelManager=l.modelManager:(this.modelManager=new Vh(r._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=l.configOptions?l.configOptions:new Map,this._configDependentLayers=l.configDependentLayers?l.configDependentLayers:new Set,this._config=l.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:l.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=l.initialConfig,this.dispatcher.broadcast("setReferrer",i.cl());const m=this;this._rtlTextPluginCallback=et.registerForPluginStateChange(w=>{m.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:w.pluginStatus,pluginURL:w.pluginURL},(T,I)=>{if(i.cm(T),I&&I.every(N=>N))for(const N in m._sourceCaches){const G=m._sourceCaches[N],X=G.getSource().type;X!=="vector"&&X!=="geojson"||G.reload()}})}),this.on("data",w=>{if(w.dataType!=="source"||w.sourceDataType!=="metadata")return;const T=this.getOwnSource(w.sourceId);if(T&&T.vectorLayerIds)for(const I in this._layers){const N=this._layers[I];N.source===T.id&&this._validateLayer(N)}})}load(r){return r?(typeof r=="string"?this.loadURL(r):this.loadJSON(r),this):this}_getGlobalId(r){if(!r)return null;if(typeof r=="string"){if(i.f(r))return r;const l=i.cn(r);if(!l.startsWith("http"))try{return new URL(l,location.href).toString()}catch{return l}return l}return`json://${i.co(JSON.stringify(r))}`}_diffStyle(r,l,m){this.globalId=this._getGlobalId(r);const w=(T,I)=>{try{I(null,this.setState(T,m))}catch(N){I(N,!1)}};if(typeof r=="string"){const T=this.map._requestManager.normalizeStyleURL(r),I=this.map._requestManager.transformRequest(T,i.R.Style);i.n(I,(N,G)=>{N?this.fire(new i.y(N)):G&&w(G,l)})}else typeof r=="object"&&w(r,l)}loadURL(r,l={}){this.fire(new i.z("dataloading",{dataType:"style"}));const m=typeof l.validate=="boolean"?l.validate:!i.f(r);this.globalId=this._getGlobalId(r),r=this.map._requestManager.normalizeStyleURL(r,l.accessToken),this.resolvedImports.add(r);const w=this.importsCache.get(r);if(w)return this._load(w,m);const T=this.map._requestManager.transformRequest(r,i.R.Style);this._request=i.n(T,(I,N)=>{if(this._request=null,I)this.fire(new i.y(I));else if(N)return this.importsCache.set(r,N),this._load(N,m)})}loadJSON(r,l={}){this.fire(new i.z("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(r),this._request=i.q.frame(()=>{this._request=null,this._load(r,l.validate!==!1)})}loadEmpty(){this.fire(new i.z("dataloading",{dataType:"style"})),this._load(Te,!1)}_loadImports(r,l,m){if(this.importDepth>=4)return i.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const w=[];for(const T of r){const I=this._createFragmentStyle(T),N=new Promise(Z=>{I.once("style.import.load",Z),I.once("error",Z)}).then(()=>this.mergeAll());if(w.push(N),this.resolvedImports.has(T.url)){I.loadEmpty();continue}const G=T.data||this.importsCache.get(T.url);G?(I.loadJSON(G,{validate:l}),this._isInternalStyle(G)&&(I.globalId=null)):T.url?I.loadURL(T.url,{validate:l}):I.loadEmpty();const X={style:I,id:T.id,config:T.config};if(m){const Z=this.fragments.findIndex(({id:J})=>J===m);this.fragments=this.fragments.slice(0,Z).concat(X).concat(this.fragments.slice(Z))}else this.fragments.push(X)}return Promise.allSettled(w)}getImportGlobalIds(r=this,l=new Set){for(const m of r.fragments)m.style.globalId&&l.add(m.style.globalId),this.getImportGlobalIds(m.style,l);return[...l.values()]}_createFragmentStyle(r){const l=this.scope?i.aC(r.id,this.scope):r.id;let m;const w=this._initialConfig&&this._initialConfig[l];(r.config||w)&&(m=i.l({},r.config,w));const T=new et(this.map,{scope:l,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:m,configOptions:this.options,colorThemeOverride:r["color-theme"],configDependentLayers:this._configDependentLayers});return T.setEventedParent(this.map,{style:T}),T}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(r){return this.isRootStyle()&&(r.fragment||!!r.schema&&r.fragment!==!1)}_load(r,l){const m=r.indoor?ys(r.schema):r.schema;if(this._isInternalStyle(r)){const I=i.l({},Te,{imports:[{id:"basemap",data:r,url:""}]});return void this._load(I,l)}if(this.updateConfig(this._config,m),l&&O(this,$i(r)))return;this._loaded=!0,this.stylesheet=i.cp(r);const w=()=>{for(const X in r.sources)this.addSource(X,r.sources[X],{validate:!1,isInitialLoad:!0});r.sprite?this._loadIconset(r.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(r.glyphs,this.scope);const I=Yc(this.stylesheet.layers);if(this._order=I.map(X=>X.id),this.stylesheet.light&&i.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const X=this.stylesheet.lights[0];this.light=new de(X.properties,X.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new de(this.stylesheet.light)),this._layers={};for(const X of I){const Z=i.cu(X,this.scope,this._styleColorTheme.lut,this.options);Z.configDependencies.size!==0&&this._configDependentLayers.add(Z.fqid),Z.setEventedParent(this,{layer:{id:Z.id}}),this._layers[Z.id]=Z;const J=this.getOwnLayerSourceCache(Z),Q=!!this.directionalLight&&this.directionalLight.shadowsEnabled();J&&Z.canCastShadows()&&Q&&(J.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const N=this.stylesheet.terrain;N&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(N,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new i.z("data",{dataType:"style"}));const G=this.isRootStyle();r.imports?this._loadImports(r.imports,l).then(()=>{this._reloadImports(),this.fire(new i.z(G?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new i.z(G?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const T=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(T){const I=this._evaluateColorThemeData(T);this._loadColorTheme(I).then(()=>{w()}).catch(N=>{i.w(`Couldn't load color theme from the stylesheet: ${N}`),w()})}else this._styleColorTheme.lut=null,w()}isRootStyle(){return this.importDepth===0}mergeAll(){let r,l,m,w,T,I,N,G,X,Z;const J={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(Q=>{if(Q.stylesheet){if(Q.light!=null&&(r=Q.light),Q.stylesheet.lights)for(const ae of Q.stylesheet.lights)ae.type==="ambient"&&Q.ambientLight!=null&&(l=Q.ambientLight),ae.type==="directional"&&Q.directionalLight!=null&&(m=Q.directionalLight);w=this._prioritizeTerrain(w,Q.terrain,Q.stylesheet.terrain),Q.stylesheet.fog&&Q.fog!=null&&(T=Q.fog),Q.stylesheet.snow&&Q.snow!=null&&(I=Q.snow),Q.stylesheet.rain&&Q.rain!=null&&(N=Q.rain),Q.stylesheet.camera!=null&&(Z=Q.stylesheet.camera),Q.stylesheet.projection!=null&&(G=Q.stylesheet.projection),Q.stylesheet.transition!=null&&(X=Q.stylesheet.transition),J[Q.scope]=Q._styleColorTheme}}),this.light=r,this.ambientLight=l,this.directionalLight=m,this.fog=T,this.snow=I,this.rain=N,this._styleColorThemeForScope=J,w===null?delete this.terrain:this.terrain=w,this.camera=Z||{"camera-projection":"perspective"},this.projection=G||{name:"mercator"},this.transition=i.l({},Be,X),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(r){const l=m=>{for(const w of m.fragments)l(w.style);r(m)};l(this)}_prioritizeTerrain(r,l,m){const w=r&&r.drapeRenderMode===0;return m===null?l&&l.drapeRenderMode===0?l:w?r:null:l!=null&&(!r||w||l&&l.drapeRenderMode===1)?l:r}mergeTerrain(){let r;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(l=>{r=this._prioritizeTerrain(r,l.terrain,l.stylesheet.terrain)}),r===null?delete this.terrain:this.terrain=r}mergeProjection(){let r;this.forEachFragmentStyle(l=>{l.stylesheet.projection!=null&&(r=l.stylesheet.projection)}),this.projection=r||{name:"mercator"}}mergeSources(){const r={},l={},m={};this.forEachFragmentStyle(w=>{for(const T in w._sourceCaches){const I=i.aC(T,w.scope);r[I]=w._sourceCaches[T]}for(const T in w._otherSourceCaches){const I=i.aC(T,w.scope);l[I]=w._otherSourceCaches[T]}for(const T in w._symbolSourceCaches){const I=i.aC(T,w.scope);m[I]=w._symbolSourceCaches[T]}}),this._mergedSourceCaches=r,this._mergedOtherSourceCaches=l,this._mergedSymbolSourceCaches=m}mergeLayers(){const r={},l=[],m={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(T=>{for(const I of T._order){const N=T._layers[I];if(N.type==="slot"){const G=i.cq(I);if(r[G])continue;r[G]=[]}N.slot&&r[N.slot]?r[N.slot].push(N):l.push(N)}}),this._mergedOrder=[];const w=(T=[])=>{for(const I of T)if(I.type==="slot"){const N=i.cq(I.id);r[N]&&w(r[N]),this._mergedSlots.push(N)}else{const N=i.aC(I.id,I.scope);this._mergedOrder.push(N),m[N]=I,I.is3D()&&(this._has3DLayers=!0),I.type==="circle"&&(this._hasCircleLayers=!0),I.type==="symbol"&&(this._hasSymbolLayers=!0),I.type==="clip"&&(this._clipLayerPresent=!0)}};w(l),this._mergedOrder.sort((T,I)=>{const N=m[T],G=m[I];return N.hasInitialOcclusionOpacityProperties?G.is3D()?1:0:N.is3D()&&G.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=m,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(r){return this.stylesheet.camera=i.l({},this.stylesheet.camera,r),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(r){return r.data?function(l,m,w){const T=i.l({},m);for(const N of Object.keys(i.a3.colorTheme))T[N]===void 0&&(T[N]=i.a3.colorTheme[N].default);const I=new i.a4(qh,l,new Map(w));return I.setTransitionOrValue(T,w),I.untransitioned().possiblyEvaluate(new i.a8(0))}(this.scope,r,this.options).get("data"):null}_loadColorTheme(r){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const l=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((m,w)=>{const T="data:image/png;base64,";if(!r||r.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void m();let I=r;I.startsWith(T)||(I=T+I);const N="mapbox-reserved-lut",G=new Image;G.src=I,G.onerror=()=>{this._styleColorTheme.lutLoading=!1,w(new Error("Failed to load image data"))},G.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==l)return void m();this._styleColorTheme.lutLoading=!1;const{width:X,height:Z,data:J}=i.q.getImageData(G);if(Z>32)return void w(new Error("The height of the image must be less than or equal to 32 pixels."));if(X!==Z*Z)return void w(new Error("The width of the image must be equal to the height squared."));this.getImage(N)&&this.removeImage(N),this.addImage(N,{data:new i.r({width:X,height:Z},J),pixelRatio:1,sdf:!1,usvg:!1,version:0});const Q=this.imageManager.getImage(N,this.scope);Q?(this._styleColorTheme.lut={image:Q.data,data:r},m()):w(new Error("Missing LUT image."))}})}getLut(r){const l=this._styleColorThemeForScope[r];return l?l.lut:null}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(r){this._spriteRequest=function(l,m,w){let T,I,N;const G=i.q.devicePixelRatio>1?"@2x":"";let X=i.n(m.transformRequest(m.normalizeSpriteURL(l,G,".json"),i.R.SpriteJSON),(Q,ae)=>{X=null,N||(N=Q,T=ae,J())}),Z=i.o(m.transformRequest(m.normalizeSpriteURL(l,G,".png"),i.R.SpriteImage),(Q,ae)=>{Z=null,N||(N=Q,I=ae,J())});function J(){if(N)w(N);else if(T&&I){const Q=i.q.getImageData(I),ae={};for(const ye in T){const{width:fe,height:be,x:_e,y:Ce,sdf:ze,pixelRatio:De,stretchX:$e,stretchY:je,content:Ve}=T[ye],Ue=new i.r({width:fe,height:be});i.r.copy(Q,Ue,{x:_e,y:Ce},{x:0,y:0},{width:fe,height:be},null),ae[ye]={data:Ue,pixelRatio:De,sdf:ze,stretchX:$e,stretchY:je,content:Ve,usvg:!1}}w(null,ae)}}return{cancel(){X&&(X.cancel(),X=null),Z&&(Z.cancel(),Z=null)}}}(r,this.map._requestManager,(l,m)=>{if(this._spriteRequest=null,l)this.fire(new i.y(l));else if(m)for(const w in m)this.imageManager.addImage(w,this.scope,m[w]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))})}_loadIconset(r){if(!i.f(r)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(r);const l=this.map._spriteFormat==="auto";var m,w;this._spriteRequest=(w=(T,I)=>{if(this._spriteRequest=null,T)l?this._loadSprite(r):this.fire(new i.y(T));else if(I)for(const N in I)this.imageManager.addImage(N,this.scope,I[N]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))},i.bi((m=this.map._requestManager).transformRequest(m.normalizeIconsetURL(r),i.R.Iconset),(T,I)=>{if(T)return void w(T);const N={},G=i.cg(new i.bh(I));for(const X of G.icons){const Z={version:1,pixelRatio:i.q.devicePixelRatio,content:g(X),stretchX:X.metadata?x(X.metadata.stretch_x_areas):void 0,stretchY:X.metadata?x(X.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:X};N[X.name]=Z}w(null,N)}))}_validateLayer(r){const l=this.getOwnSource(r.source);if(!l)return;const m=r.sourceLayer;m&&(l.type==="geojson"||l.vectorLayerIds&&l.vectorLayerIds.indexOf(m)===-1)&&this.fire(new i.y(new Error(`Source layer "${m}" does not exist on source "${l.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:r}of this.fragments)if(!r.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((r,l)=>{const m=this.fragments[l];return m&&m.style&&(r.data=m.style.serialize()),r})}_serializeSources(){const r={};for(const l in this._sourceCaches){const m=this._sourceCaches[l].getSource();r[m.id]||(r[m.id]=m.serialize())}return r}_serializeLayers(r){const l=[];for(const m of r){const w=this._layers[m];w&&w.type!=="custom"&&l.push(w.serialize())}return l}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(r){return r?this.order:this._mergedOrder}isLayerDraped(r){return!!this.terrain&&r.isDraped(this.getLayerSourceCache(r))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(r){const l=this.getOwnLayer(r);if(l)return l;this.fire(new i.y(new Error(`The layer '${r}' does not exist in the map's style.`)))}_checkSource(r){const l=this.getOwnSource(r);if(l)return l;this.fire(new i.y(new Error(`The source '${r}' does not exist in the map's style.`)))}precompilePrograms(r,l){const m=this.map.painter;if(m)for(let w=r.minzoom||0;w<(r.maxzoom||25.5);w++){const T=r.getProgramIds();if(T)for(const I of T){const N=r.getDefaultProgramParams(I,l.zoom,this._styleColorTheme.lut);N&&(m.style=this,this.fog&&(m._fogVisible=!0,N.overrideFog=!0,m.getOrCreateProgram(I,N)),m._fogVisible=!1,N.overrideFog=!1,m.getOrCreateProgram(I,N),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(N.overrideRtt=!0,m.getOrCreateProgram(I,N)))}}}update(r){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(r),this.directionalLight&&this.directionalLight.recalculate(r);const l=this.calculateLightsBrightness();r.brightness=l||0,l!==this._brightness&&(this._brightness=l,this.dispatcher.broadcast("setBrightness",l));const m=this._changes.isDirty();let w=!1;if(this._changes.isDirty()){const I=this._changes.getLayerUpdatesByScope();for(const N in I){const{updatedIds:G,removedIds:X}=I[N];(G||X)&&(this._updateWorkerLayers(N,G,X),w=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(r),this.light&&this.light.updateTransitions(r),this.ambientLight&&this.ambientLight.updateTransitions(r),this.directionalLight&&this.directionalLight.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this.snow&&this.snow.updateTransitions(r),this.rain&&this.rain.updateTransitions(r),this._changes.reset()}const T={};for(const I in this._mergedSourceCaches){const N=this._mergedSourceCaches[I];T[I]=N.used,N.used=!1,N.tileCoverLift=0}for(const I of this._mergedOrder){const N=this._mergedLayers[I];if(N.recalculate(r,this._availableImages),!N.isHidden(r.zoom)){const G=this.getLayerSourceCache(N);G&&(G.used=!0,G.tileCoverLift=Math.max(G.tileCoverLift,N.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(N,r)}):this.precompilePrograms(N,r))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&w&&this.mergeLayers();for(const I in T){const N=this._mergedSourceCaches[I];T[I]!==N.used&&N.getSource().fire(new i.z("data",{sourceDataType:"visibility",dataType:"source",sourceId:N.getSource().id}))}this.light&&this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.snow&&this.snow.recalculate(r),this.rain&&this.rain.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),m&&this.fire(new i.z("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=this._changes.getUpdatedImages();if(r.length){for(const l in this._sourceCaches)this._sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],r);this._changes.resetUpdatedImages()}}_updateWorkerLayers(r,l,m){const w=this.getFragmentStyle(r);w&&this.dispatcher.broadcast("updateLayers",{layers:l?w._serializeLayers(l):[],scope:r,removedIds:m||[],options:w.options})}setState(r,l){if(this._checkLoaded(),O(this,$i(r)))return!1;(r=i.cp(r)).layers=Yc(r.layers);const m=function(I,N){if(!I)return[{command:_r.setStyle,args:[N]}];let G=[];try{if(!i.bn(I.version,N.version))return[{command:_r.setStyle,args:[N]}];if(i.bn(I.center,N.center)||G.push({command:_r.setCenter,args:[N.center]}),i.bn(I.zoom,N.zoom)||G.push({command:_r.setZoom,args:[N.zoom]}),i.bn(I.bearing,N.bearing)||G.push({command:_r.setBearing,args:[N.bearing]}),i.bn(I.pitch,N.pitch)||G.push({command:_r.setPitch,args:[N.pitch]}),i.bn(I.sprite,N.sprite)||G.push({command:_r.setSprite,args:[N.sprite]}),i.bn(I.glyphs,N.glyphs)||G.push({command:_r.setGlyphs,args:[N.glyphs]}),i.bn(I.imports,N.imports)||function(ae=[],ye=[],fe){ye=ye||[];const be=(ae=ae||[]).map(zi),_e=ye.map(zi),Ce=ae.reduce(zo,{}),ze=ye.reduce(zo,{}),De=be.slice();let $e,je,Ve,Ue;for($e=0,je=0;$e<be.length;$e++)Ve=be[$e],ze.hasOwnProperty(Ve)?je++:(fe.push({command:_r.removeImport,args:[Ve]}),De.splice(De.indexOf(Ve,je),1));for($e=0,je=0;$e<_e.length;$e++)Ve=_e[_e.length-1-$e],De[De.length-1-$e]!==Ve&&(Ce.hasOwnProperty(Ve)?(fe.push({command:_r.removeImport,args:[Ve]}),De.splice(De.lastIndexOf(Ve,De.length-je),1)):je++,Ue=De[De.length-$e],fe.push({command:_r.addImport,args:[ze[Ve],Ue]}),De.splice(De.length-$e,0,Ve));for(const Qe of ye){const at=Ce[Qe.id];at&&!i.bn(at,Qe)&&fe.push({command:_r.updateImport,args:[Qe.id,Qe]})}}(I.imports,N.imports,G),i.bn(I.transition,N.transition)||G.push({command:_r.setTransition,args:[N.transition]}),i.bn(I.light,N.light)||G.push({command:_r.setLight,args:[N.light]}),i.bn(I.fog,N.fog)||G.push({command:_r.setFog,args:[N.fog]}),i.bn(I.snow,N.snow)||G.push({command:_r.setSnow,args:[N.snow]}),i.bn(I.rain,N.rain)||G.push({command:_r.setRain,args:[N.rain]}),i.bn(I.projection,N.projection)||G.push({command:_r.setProjection,args:[N.projection]}),i.bn(I.lights,N.lights)||G.push({command:_r.setLights,args:[N.lights]}),i.bn(I.camera,N.camera)||G.push({command:_r.setCamera,args:[N.camera]}),!i.bn(I["color-theme"],N["color-theme"]))return[{command:_r.setStyle,args:[N]}];const X={},Z=[];(function(ae,ye,fe,be){let _e;for(_e in ye=ye||{},ae=ae||{})ae.hasOwnProperty(_e)&&(ye.hasOwnProperty(_e)||Lo(_e,fe,be));for(_e in ye){if(!ye.hasOwnProperty(_e))continue;const Ce=ye[_e];ae.hasOwnProperty(_e)?i.bn(ae[_e],Ce)||(ae[_e].type==="geojson"&&Ce.type==="geojson"&&qr(ae,ye,_e)?fe.push({command:_r.setGeoJSONSourceData,args:[_e,Ce.data]}):kn(_e,ye,fe,be)):rc(_e,ye,fe)}})(I.sources,N.sources,Z,X);const J=[];I.layers&&I.layers.forEach(ae=>{ae.source&&X[ae.source]?G.push({command:_r.removeLayer,args:[ae.id]}):J.push(ae)});let Q=I.terrain;Q&&X[Q.source]&&(G.push({command:_r.setTerrain,args:[void 0]}),Q=void 0),G=G.concat(Z),i.bn(Q,N.terrain)||G.push({command:_r.setTerrain,args:[N.terrain]}),function(ae,ye,fe){ye=ye||[];const be=(ae=ae||[]).map(zi),_e=ye.map(zi),Ce=ae.reduce(zo,{}),ze=ye.reduce(zo,{}),De=be.slice(),$e=Object.create(null);let je,Ve,Ue,Qe,at,St,yt;for(je=0,Ve=0;je<be.length;je++)Ue=be[je],ze.hasOwnProperty(Ue)?Ve++:(fe.push({command:_r.removeLayer,args:[Ue]}),De.splice(De.indexOf(Ue,Ve),1));for(je=0,Ve=0;je<_e.length;je++)Ue=_e[_e.length-1-je],De[De.length-1-je]!==Ue&&(Ce.hasOwnProperty(Ue)?(fe.push({command:_r.removeLayer,args:[Ue]}),De.splice(De.lastIndexOf(Ue,De.length-Ve),1)):Ve++,St=De[De.length-je],fe.push({command:_r.addLayer,args:[ze[Ue],St]}),De.splice(De.length-je,0,Ue),$e[Ue]=!0);for(je=0;je<_e.length;je++)if(Ue=_e[je],Qe=Ce[Ue],at=ze[Ue],!$e[Ue]&&!i.bn(Qe,at))if(i.bn(Qe.source,at.source)&&i.bn(Qe["source-layer"],at["source-layer"])&&i.bn(Qe.type,at.type)){for(yt in Vn(Qe.layout,at.layout,fe,Ue,null,_r.setLayoutProperty),Vn(Qe.paint,at.paint,fe,Ue,null,_r.setPaintProperty),i.bn(Qe.slot,at.slot)||fe.push({command:_r.setSlot,args:[Ue,at.slot]}),i.bn(Qe.filter,at.filter)||fe.push({command:_r.setFilter,args:[Ue,at.filter]}),i.bn(Qe.minzoom,at.minzoom)&&i.bn(Qe.maxzoom,at.maxzoom)||fe.push({command:_r.setLayerZoomRange,args:[Ue,at.minzoom,at.maxzoom]}),Qe)Qe.hasOwnProperty(yt)&&yt!=="layout"&&yt!=="paint"&&yt!=="filter"&&yt!=="metadata"&&yt!=="minzoom"&&yt!=="maxzoom"&&yt!=="slot"&&(yt.indexOf("paint.")===0?Vn(Qe[yt],at[yt],fe,Ue,yt.slice(6),_r.setPaintProperty):i.bn(Qe[yt],at[yt])||fe.push({command:_r.setLayerProperty,args:[Ue,yt,at[yt]]}));for(yt in at)at.hasOwnProperty(yt)&&!Qe.hasOwnProperty(yt)&&yt!=="layout"&&yt!=="paint"&&yt!=="filter"&&yt!=="metadata"&&yt!=="minzoom"&&yt!=="maxzoom"&&yt!=="slot"&&(yt.indexOf("paint.")===0?Vn(Qe[yt],at[yt],fe,Ue,yt.slice(6),_r.setPaintProperty):i.bn(Qe[yt],at[yt])||fe.push({command:_r.setLayerProperty,args:[Ue,yt,at[yt]]}))}else fe.push({command:_r.removeLayer,args:[Ue]}),St=De[De.lastIndexOf(Ue)+1],fe.push({command:_r.addLayer,args:[at,St]})}(J,N.layers,G)}catch(X){console.warn("Unable to compute style diff:",X),G=[{command:_r.setStyle,args:[N]}]}return G}(this.serialize(),r).filter(I=>!(I.command in te));if(m.length===0)return!1;const w=m.filter(I=>!(I.command in $));if(w.length>0)throw new Error(`Unimplemented: ${w.map(I=>I.command).join(", ")}.`);const T=[];return m.forEach(I=>{T.push(this[I.command].apply(this,I.args))}),l&&Promise.all(T).then(l),this.stylesheet=r,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(r,l){return this.getImage(r)?this.fire(new i.y(new Error("An image with this name already exists."))):(this.imageManager.addImage(r,this.scope,l),this._afterImageUpdated(r),this)}updateImage(r,l,m=!1){this.imageManager.updateImage(r,this.scope,l),m&&this._afterImageUpdated(r)}getImage(r){return this.imageManager.getImage(r,this.scope)}removeImage(r){return this.getImage(r)?(this.imageManager.removeImage(r,this.scope),this._afterImageUpdated(r),this):this.fire(new i.y(new Error("No image with this name exists.")))}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(r),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new i.z("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(r,l,m={}){return this._checkLoaded(),this._validate(Eu,`models.${r}`,l,null,m)||(this.modelManager.addModel(r,l,this.scope),this._changes.setDirty()),this}hasModel(r){return this.modelManager.hasModel(r,this.scope)}removeModel(r){return this.hasModel(r)?(this.modelManager.removeModel(r,this.scope),this):this.fire(new i.y(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(r,l,m={}){if(this._checkLoaded(),this.getOwnSource(r)!==void 0)throw new Error(`There is already a source with ID "${r}".`);if(!l.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(l).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(Zo,`sources.${r}`,l,null,m))return;this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);const w=Vi(r,l,this.dispatcher,this);w.scope=this.scope,w.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(w.id),source:w.serialize(),sourceId:w.id}));const T=I=>{const N=(I?"symbol:":"other:")+w.id,G=i.aC(N,this.scope),X=this._sourceCaches[N]=new Xa(G,w,I);(I?this._symbolSourceCaches:this._otherSourceCaches)[w.id]=X,X.onAdd(this.map)};T(!1),l.type!=="vector"&&l.type!=="geojson"||T(!0),w.onAdd&&w.onAdd(this.map),m.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(r){this._checkLoaded();const l=this.getOwnSource(r);if(!l)throw new Error("There is no source with this ID");for(const w in this._layers)if(this._layers[w].source===r)return this.fire(new i.y(new Error(`Source "${r}" cannot be removed while layer "${w}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===r)return this.fire(new i.y(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));const m=this.getOwnSourceCaches(r);for(const w of m){const T=i.cq(w.id);delete this._sourceCaches[T],this._changes.discardSourceCacheUpdate(w.id),w.fire(new i.z("data",{sourceDataType:"metadata",dataType:"source",sourceId:w.getSource().id})),w.setEventedParent(null),w.clearTiles()}return delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],this.mergeSources(),l.setEventedParent(null),l.onRemove&&l.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(r,l){this._checkLoaded(),this.getOwnSource(r).setData(l),this._changes.setDirty()}getOwnSource(r){const l=this.getOwnSourceCache(r);return l&&l.getSource()}getOwnSources(){const r=[];for(const l in this._otherSourceCaches){const m=this.getOwnSourceCache(l);m&&r.push(m.getSource())}return r}areTilesLoaded(){const r=this._mergedSourceCaches;for(const l in r){const m=r[l]._tiles;for(const w in m){const T=m[w];if(T.state!=="loaded"&&T.state!=="errored")return!1}}return!0}setLights(r){if(this._checkLoaded(),!r)return delete this.ambientLight,void delete this.directionalLight;const l=this._getTransitionParameters();for(const w of r){if(this._validate(Al,"lights",w))return;switch(w.type){case"ambient":if(this.ambientLight){const T=this.ambientLight;T.set(w),T.updateTransitions(l)}else this.ambientLight=new Xn(w,un||(un=new i.a5({color:new i.a6(i.a3.properties_light_ambient.color),"color-use-theme":new i.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a6(i.a3.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const T=this.directionalLight;T.set(w),T.updateTransitions(l)}else this.directionalLight=new Xn(w,hn||(hn=new i.a5({direction:new i.ak(i.a3.properties_light_directional.direction),color:new i.a6(i.a3.properties_light_directional.color),"color-use-theme":new i.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a6(i.a3.properties_light_directional.intensity),"cast-shadows":new i.a6(i.a3.properties_light_directional["cast-shadows"]),"shadow-quality":new i.a6(i.a3.properties_light_directional["shadow-quality"]),"shadow-intensity":new i.a6(i.a3.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const m=new i.a8(this.z||0,l);this.ambientLight&&this.ambientLight.recalculate(m),this.directionalLight&&this.directionalLight.recalculate(m),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const r=this.directionalLight,l=this.ambientLight;if(!r||!l)return;const m=Q=>.2126*(Q[0]<=.03928?Q[0]/12.92:Math.pow((Q[0]+.055)/1.055,2.4))+.7152*(Q[1]<=.03928?Q[1]/12.92:Math.pow((Q[1]+.055)/1.055,2.4))+.0722*(Q[2]<=.03928?Q[2]/12.92:Math.pow((Q[2]+.055)/1.055,2.4)),w=r.properties.get("color").toRenderColor(null).toArray01(),T=r.properties.get("intensity"),I=r.properties.get("direction"),N=1-i.cb(I.x,I.y,I.z)[2]/90,G=m(w)*T*N,X=l.properties.get("color").toRenderColor(null).toArray01(),Z=l.properties.get("intensity"),J=m(X)*Z;return Number(((G+J)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const r=[];return this.directionalLight&&r.push(this.directionalLight.get()),this.ambientLight&&r.push(this.ambientLight.get()),r}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(r){if(!r)return this;if(i.cr(r)){const l=i.cs(r),m=this.fragments.find(({id:T})=>T===l);if(!m)throw new Error(`Style import '${r}' not found`);const w=i.cq(r);return m.style.getFragmentStyle(w)}{const l=this.fragments.find(({id:m})=>m===r);return l?l.style:void 0}}setFeaturesetSelectors(r){if(!r)return;const l={},m=(w,T="")=>`${w}::${T}`;this._featuresetSelectors={};for(const w in r){const T=this._featuresetSelectors[w]=[];for(const I of r[w].selectors){if(I.featureNamespace){const G=this.getOwnLayer(I.layer);if(!G){i.w(`Layer is undefined for selector: ${I.layer}`);continue}const X=m(G.source,G.sourceLayer);if(X in l&&l[X]!==I.featureNamespace){i.w(`"featureNamespace ${I.featureNamespace} of featureset ${w}'s selector is not associated to the same source, skip this selector`);continue}l[X]=I.featureNamespace}let N;if(I.properties)for(const G in I.properties){const X=i.U(I.properties[G]);X.result==="success"&&(N=N||{},N[G]=X.value)}T.push({layerId:I.layer,namespace:I.featureNamespace,properties:N,uniqueFeatureID:I._uniqueFeatureID})}}}getFeaturesetDescriptors(r){const l=this.getFragmentStyle(r);if(!l||!l.stylesheet.featuresets)return[];const m=[];for(const w in l.stylesheet.featuresets)m.push({featuresetId:w,importId:l.scope?l.scope:void 0});return m}getFeaturesetLayers(r,l){const m=this.getFragmentStyle(l),w=m.stylesheet.featuresets;if(!w||!w[r])return this.fire(new i.y(new Error(`The featureset '${r}' does not exist in the map's style and cannot be queried.`))),[];const T=[];for(const I of w[r].selectors){const N=m.getOwnLayer(I.layer);N&&T.push(N)}return T}getConfigProperty(r,l){const m=this.getFragmentStyle(r);if(!m)return null;const w=i.aC(l,m.scope),T=m.options.get(w),I=T?T.value||T.default:null;return I?I.serialize():null}setConfigProperty(r,l,m){const w=this.getFragmentStyle(r);if(!w)return;const T=w.stylesheet.indoor?ys(w.stylesheet.schema):w.stylesheet.schema;if(!T||!T[l])return;const I=i.U(m);if(I.result!=="success")return void O(this,I.value);const N=I.value.expression,G=i.aC(l,w.scope),X=w.options.get(G);if(!X)return;let Z;const{minValue:J,maxValue:Q,stepValue:ae,type:ye,values:fe}=T[l],be=i.U(T[l].default);be.result==="success"&&(Z=be.value.expression),Z?(this.options.set(G,Object.assign({},X,{value:N,default:Z,minValue:J,maxValue:Q,stepValue:ae,type:ye,values:fe})),this.updateConfigDependencies(l)):this.fire(new i.y(new Error(`No schema defined for the config option "${l}" in the "${r}" fragment.`)))}getConfig(r){const l=this.getFragmentStyle(r);if(!l)return null;const m=l.stylesheet.schema;if(!m)return null;const w={};for(const T in m){const I=i.aC(T,l.scope),N=l.options.get(I),G=N?N.value||N.default:null;w[T]=G?G.serialize():null}return w}setConfig(r,l){const m=this.getFragmentStyle(r);m&&(m.updateConfig(l,m.stylesheet.schema),this.updateConfigDependencies())}getSchema(r){const l=this.getFragmentStyle(r);return l?l.stylesheet.schema:null}setSchema(r,l){const m=this.getFragmentStyle(r);m&&(m.stylesheet.schema=l,m.updateConfig(m._config,l),this.updateConfigDependencies())}updateConfig(r,l){if(this._config=r,r||l)if(l)for(const m in l){let w,T;const I=i.U(l[m].default);if(I.result==="success"&&(w=I.value.expression),r&&r[m]!==void 0){const Q=i.U(r[m]);Q.result==="success"&&(T=Q.value.expression)}const{minValue:N,maxValue:G,stepValue:X,type:Z,values:J}=l[m];if(w){const Q=i.aC(m,this.scope);this.options.set(Q,{default:w,value:T,minValue:N,maxValue:G,stepValue:X,type:Z,values:J})}else this.fire(new i.y(new Error(`No schema defined for config option "${m}".`)))}else this.fire(new i.y(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(r){for(const l of this._configDependentLayers){const m=this.getLayer(l);if(m){if(r&&!m.configDependencies.has(r))continue;m.possiblyEvaluateVisibility(),this._updateLayer(m)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(l=>{const m=l._styleColorTheme.colorThemeOverride?l._styleColorTheme.colorThemeOverride:l._styleColorTheme.colorTheme;if(m){const w=l._evaluateColorThemeData(m);(!l._styleColorTheme.lut&&w!==""||l._styleColorTheme.lut&&w!==l._styleColorTheme.lut.data)&&l.setColorTheme(m)}}),this._changes.setDirty()}addLayer(r,l,m={}){this._checkLoaded();const w=r.id;if(this._layers[w])return void this.fire(new i.y(new Error(`Layer with id "${w}" already exists on this map`)));let T;if(r.type==="custom"){if(O(this,i.ct(r)))return;T=i.cu(r,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof r.source=="object"&&(this.addSource(w,r.source),r=i.cp(r),r=i.l(r,{source:w})),this._validate(Ml,`layers.${w}`,r,{arrayIndex:-1},m))return;T=i.cu(r,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(T),T.setEventedParent(this,{layer:{id:w}})}T.configDependencies.size!==0&&this._configDependentLayers.add(T.fqid);let I=this._order.length;if(l){const Z=this._order.indexOf(l);if(Z===-1)return void this.fire(new i.y(new Error(`Layer with id "${l}" does not exist on this map.`)));T.slot===this._layers[l].slot?I=Z:i.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(I,0,w),this._layerOrderChanged=!0,this._layers[w]=T;const N=this.getOwnLayerSourceCache(T),G=!!this.directionalLight&&this.directionalLight.shadowsEnabled();N&&T.canCastShadows()&&G&&(N.castsShadows=!0);const X=this._changes.getRemovedLayer(T);if(X&&T.source&&N&&T.type!=="custom"){this._changes.discardLayerRemoval(T);const Z=i.aC(T.source,T.scope);X.type!==T.type?this._changes.updateSourceCache(Z,"clear"):(this._changes.updateSourceCache(Z,"reload"),N.pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map),T.scope=this.scope,this.mergeLayers()}moveLayer(r,l){this._checkLoaded();const m=this._checkLayer(r);if(!m||r===l)return;const w=this._order.indexOf(r);this._order.splice(w,1);let T=this._order.length;if(l){const I=this._order.indexOf(l);if(I===-1)return void this.fire(new i.y(new Error(`Layer with id "${l}" does not exist on this map.`)));m.slot===this._layers[l].slot?T=I:i.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(T,0,r),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(r){this._checkLoaded();const l=this._checkLayer(r);if(!l)return;l.setEventedParent(null);const m=this._order.indexOf(r);this._order.splice(m,1),delete this._layers[r],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(l.fqid),this._changes.removeLayer(l);const w=this.getOwnLayerSourceCache(l);if(w&&w.castsShadows){let T=!1;for(const I in this._layers)if(this._layers[I].source===l.source&&this._layers[I].canCastShadows()){T=!0;break}w.castsShadows=T}l.onRemove&&l.onRemove(this.map),this.mergeLayers()}getOwnLayer(r){return this._layers[r]}hasLayer(r){return r in this._mergedLayers}hasLayerType(r){for(const l in this._layers)if(this._layers[l].type===r)return!0;return!1}setLayerZoomRange(r,l,m){this._checkLoaded();const w=this._checkLayer(r);w&&(w.minzoom===l&&w.maxzoom===m||(l!=null&&(w.minzoom=l),m!=null&&(w.maxzoom=m),this._updateLayer(w)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(r,l){this._checkLoaded();const m=this._checkLayer(r);m&&m.slot!==l&&(m.slot=l,this._updateLayer(m))}setFilter(r,l,m={}){this._checkLoaded();const w=this._checkLayer(r);if(w&&!i.bn(w.filter,l))return l==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(Mi,`layers.${w.id}.filter`,l,{layerType:w.type},m)||(w.filter=i.cp(l),this._updateLayer(w)))}getFilter(r){const l=this._checkLayer(r);if(l)return i.cp(l.filter)}setLayoutProperty(r,l,m,w={}){this._checkLoaded();const T=this._checkLayer(r);if(T&&!i.bn(T.getLayoutProperty(l),m)){if(m!=null&&(!w||w.validate!==!1)&&O(T,Tu.call($i,{key:`layers.${r}.layout.${l}`,layerType:T.type,objectKey:l,value:m,styleSpec:i.a3,style:{glyphs:!0,sprite:!0}})))return;T.setLayoutProperty(l,m),T.configDependencies.size!==0&&this._configDependentLayers.add(T.fqid),this._updateLayer(T)}}getLayoutProperty(r,l){const m=this._checkLayer(r);if(m)return m.getLayoutProperty(l)}setPaintProperty(r,l,m,w={}){this._checkLoaded();const T=this._checkLayer(r);if(!T||i.bn(T.getPaintProperty(l),m)||m!=null&&(!w||w.validate!==!1)&&O(T,tc.call($i,{key:`layers.${r}.paint.${l}`,layerType:T.type,objectKey:l,value:m,styleSpec:i.a3})))return;const I=T.setPaintProperty(l,m);T.configDependencies.size!==0&&this._configDependentLayers.add(T.fqid),I&&this._updateLayer(T),this._changes.updatePaintProperties(T)}getPaintProperty(r,l){const m=this._checkLayer(r);if(m)return m.getPaintProperty(l)}setFeatureState(r,l){if(this._checkLoaded(),"target"in r){if("featuresetId"in r.target){const{featuresetId:G,importId:X}=r.target,Z=this.getFragmentStyle(X),J=Z.getFeaturesetLayers(G);for(const{source:Q,sourceLayer:ae}of J)Z.setFeatureState({id:r.id,source:Q,sourceLayer:ae},l)}else if("layerId"in r.target){const{layerId:G}=r.target,X=this.getLayer(G);this.setFeatureState({id:r.id,source:X.source,sourceLayer:X.sourceLayer},l)}return}const m=r.source,w=r.sourceLayer,T=this._checkSource(m);if(!T)return;const I=T.type;if(I==="geojson"&&w)return void this.fire(new i.y(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(I==="vector"&&!w)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));r.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided.")));const N=this.getOwnSourceCaches(m);for(const G of N)G.setFeatureState(w,r.id,l)}removeFeatureState(r,l){if(this._checkLoaded(),"target"in r){if("featuresetId"in r.target){const{featuresetId:G,importId:X}=r.target,Z=this.getFragmentStyle(X),J=Z.getFeaturesetLayers(G);for(const{source:Q,sourceLayer:ae}of J)Z.removeFeatureState({id:r.id,source:Q,sourceLayer:ae},l)}else if("layerId"in r.target){const{layerId:G}=r.target,X=this.getLayer(G);this.removeFeatureState({id:r.id,source:X.source,sourceLayer:X.sourceLayer},l)}return}const m=r.source,w=this._checkSource(m);if(!w)return;const T=w.type,I=T==="vector"?r.sourceLayer:void 0;if(T==="vector"&&!I)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));if(l&&typeof r.id!="string"&&typeof r.id!="number")return void this.fire(new i.y(new Error("A feature id is required to remove its specific state property.")));const N=this.getOwnSourceCaches(m);for(const G of N)G.removeFeatureState(I,r.id,l)}getFeatureState(r){if(this._checkLoaded(),"target"in r){let T;if("featuresetId"in r.target){const{featuresetId:I,importId:N}=r.target,G=this.getFragmentStyle(N),X=G.getFeaturesetLayers(I);for(const{source:Z,sourceLayer:J}of X){const Q=G.getFeatureState({id:r.id,source:Z,sourceLayer:J});if(Q&&!T)T=Q;else if(!i.bn(T,Q))return void this.fire(new i.y(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in r.target){const{layerId:I}=r.target,N=this.getLayer(I);T=this.getFeatureState({id:r.id,source:N.source,sourceLayer:N.sourceLayer})}return T}const l=r.source,m=r.sourceLayer,w=this._checkSource(l);if(w){if(w.type!=="vector"||m)return r.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(l)[0].getFeatureState(m,r.id);this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(r){return this.stylesheet.transition=i.l({},this.stylesheet.transition,r),this.transition=this.stylesheet.transition,this}getTransition(){return i.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const r=this.getTerrain(),l=r&&this.terrain&&this.terrain.scope===this.scope?r:this.stylesheet.terrain;return i.cv({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:l,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},m=>m!==void 0)}_updateFilteredLayers(r){for(const l of Object.values(this._mergedLayers))r(l)&&this._updateLayer(l)}_updateLayer(r){this._changes.updateLayer(r);const l=this.getLayerSourceCache(r),m=i.aC(r.source,r.scope),w=this._changes.getUpdatedSourceCaches();r.source&&!w[m]&&l&&l.getSource().type!=="raster"&&(this._changes.updateSourceCache(m,"reload"),l.pause()),r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const l=N=>this._mergedLayers[N].is3D(),m=this.order,w={},T=[];for(let N=m.length-1;N>=0;N--){const G=m[N];if(l(G)){w[G]=N;for(const X of r){const Z=X[G];if(Z)for(const J of Z)T.push(J)}}}T.sort((N,G)=>G.intersectionZ-N.intersectionZ);const I=[];for(let N=m.length-1;N>=0;N--){const G=m[N];if(l(G))for(let X=T.length-1;X>=0;X--){const Z=T[X].feature;if(Z.layer&&w[Z.layer.id]<N)break;I.push(Z),T.pop()}else for(const X of r){const Z=X[G];if(Z)for(const J of Z)I.push(J.feature)}}return I}queryRenderedFeatures(r,l,m){let w;l&&!Array.isArray(l)&&l.filter&&(this._validate(Mi,"queryRenderedFeatures.filter",l.filter,null,l),w=i.aZ(l.filter));const T={},I=Z=>{if(he.has(Z.type))return;const J=this.getOwnLayerSourceCache(Z),Q=T[J.id]=T[J.id]||{sourceCache:J,layers:{},has3DLayers:!1};Z.is3D()&&(Q.has3DLayers=!0),Q.layers[Z.fqid]=Q.layers[Z.fqid]||{styleLayer:Z,targets:[]},Q.layers[Z.fqid].targets.push({filter:w})};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new i.y(new Error("parameters.layers must be an Array."))),[];for(const Z of l.layers){const J=this._layers[Z];if(!J)return this.fire(new i.y(new Error(`The layer '${Z}' does not exist in the map's style and cannot be queried for features.`))),[];I(J)}}else for(const Z in this._layers)I(this._layers[Z]);const N=this._queryRenderedFeatures(r,T,m),G=this._flattenAndSortRenderedFeatures(N),X=[];for(const Z of G)i.cs(Z.layer.id)===this.scope&&X.push(Z);return X}queryRenderedFeatureset(r,l,m){let w;l&&!Array.isArray(l)&&l.filter&&(this._validate(Mi,"queryRenderedFeatures.filter",l.filter,null,l),w=i.aZ(l.filter));const T="mock",I=[];if(l&&l.target)I.push(Object.assign({},l,{targetId:T,filter:w}));else{const Z=this.getFeaturesetDescriptors();for(const J of Z)I.push({targetId:T,filter:w,target:J});for(const{style:J}of this.fragments){const Q=J.getFeaturesetDescriptors();for(const ae of Q)I.push({targetId:T,filter:w,target:ae})}}const N=this.queryRenderedTargets(r,I,m),G=[],X=new Set;for(const Z of N)for(const J of Z.variants[T])rl(J,Z,X)||G.push(new i.cw(Z,J));return G}queryRenderedTargets(r,l,m){const w={},T=(N,G,X,Z)=>{const J=w[G.id]=w[G.id]||{sourceCache:G,layers:{},has3DLayers:!1};if(J.layers[N.fqid]=J.layers[N.fqid]||{styleLayer:N,targets:[]},N.is3D()&&(J.has3DLayers=!0),!Z)return X.uniqueFeatureID=!1,void J.layers[N.fqid].targets.push(X);J.layers[N.fqid].targets.push(Object.assign({},X,{namespace:Z.namespace,properties:Z.properties,uniqueFeatureID:Z.uniqueFeatureID}))};for(const N of l)if("featuresetId"in N.target){const{featuresetId:G,importId:X}=N.target,Z=this.getFragmentStyle(X);if(!Z||!Z._featuresetSelectors)continue;const J=Z._featuresetSelectors[G];if(!J){this.fire(new i.y(new Error(`The featureset '${G}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const Q of J){const ae=Z.getOwnLayer(Q.layerId);ae&&!he.has(ae.type)&&T(ae,Z.getOwnLayerSourceCache(ae),N,Q)}}else if("layerId"in N.target){const{layerId:G}=N.target,X=this.getLayer(G);if(!X||he.has(X.type))continue;T(X,this.getLayerSourceCache(X),N)}const I=this._queryRenderedFeatures(r,w,m);return this._flattenAndSortRenderedFeatures(I)}_queryRenderedFeatures(r,l,m){const w=[],T=!!this.map._showQueryGeometry,I=Fn.createFromScreenPoints(r,m);for(const N in l){const G=Ns(I,l[N],this._availableImages,m,T);Object.keys(G).length&&w.push(G)}if(this.placement)for(const N in l){if(!l[N].sourceCache._onlySymbols)continue;const G=us(I.screenGeometry,l[N],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData);Object.keys(G).length&&w.push(G)}return w}querySourceFeatures(r,l){const m=l&&l.filter;m&&this._validate(Mi,"querySourceFeatures.filter",m,null,l);let w=[];const T=this.getOwnSourceCaches(r);for(const I of T)w=w.concat(cs(I,l));return w}addSourceType(r,l,m){return et.getSourceType(r)?m(new Error(`A source type called "${r}" already exists.`)):(et.setSourceType(r,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:l.workerSourceURL},m):m(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(r,l,m={}){this._checkLoaded();const w=this.light.getLight();let T=!1;for(const N in r)if(!i.bn(r[N],w[N])){T=!0;break}if(!T)return;const I=this._getTransitionParameters();this.light.setLight(r,l,m),this.light.updateTransitions(I)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=i.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&i.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(r,l=1){if(this._checkLoaded(),!r)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),l===0&&delete this.terrain,r===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let m=r;const w=r.source==null;if(l===1){if(this.disableElevatedTerrain)return;if(typeof m.source=="object"){const N="terrain-dem-src";this.addSource(N,m.source),m=i.cp(m),m=i.l(m,{source:N})}const T=i.l({},m),I={};if(this.terrain&&w){T.source=this.terrain.get().source;const N=this.terrain?this.getFragmentStyle(this.terrain.scope):null;N&&(I.style=N.serialize())}if(this._validate(zs,"terrain",T,I))return}if(!this.terrain||this.terrain.scope!==this.scope&&!w||this.terrain&&l!==this.terrain.drapeRenderMode){if(!m)return;this._createTerrain(m,l),this.fire(new i.z("data",{dataType:"style"}))}else{const T=this.terrain,I=T.get();for(const N of Object.keys(i.a3.terrain))!m.hasOwnProperty(N)&&i.a3.terrain[N].default&&(m[N]=i.a3.terrain[N].default);for(const N in r)if(!i.bn(r[N],I[N])){T.set(r,this.options),this.stylesheet.terrain=r;const G=this._getTransitionParameters({duration:0});T.updateTransitions(G),this.fire(new i.z("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(r){const l=this.fog=new gt(r,this.map.transform,this.scope,this.options);this.stylesheet.fog=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}_createSnow(r){const l=this.snow=new Rn(r,this.map.transform,this.scope,this.options);this.stylesheet.snow=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}_createRain(r){const l=this.rain=new $n(r,this.map.transform,this.scope,this.options);this.stylesheet.rain=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const l=this.fog;if(!i.bn(l.get(),r)){l.set(r,this.options),this.stylesheet.fog=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}}else this._createFog(r);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(r){if(this._checkLoaded(),!r)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const l=this.snow;if(!i.bn(l.get(),r)){l.set(r,this.options),this.stylesheet.snow=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}}else this._createSnow(r);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(r){if(this._checkLoaded(),!r)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const l=this.rain;if(!i.bn(l.get(),r)){l.set(r,this.options),this.stylesheet.rain=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}}else this._createRain(r);this._markersNeedUpdate=!0}_reloadColorTheme(){const r=()=>{for(const w in this._layers)this._layers[w].lut=this._styleColorTheme.lut;for(const w in this._sourceCaches)this._sourceCaches[w].clearTiles()},l=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!l)return this._styleColorTheme.lut=null,void r();const m=this._evaluateColorThemeData(l);this._loadColorTheme(m).then(()=>{this.fire(new i.z("colorthemeset")),r()}).catch(w=>{i.w(`Couldn't set color theme: ${w}`)})}setColorTheme(r){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&i.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=r,this._reloadColorTheme()}setImportColorTheme(r,l){const m=this.getFragmentStyle(r);m&&(m._styleColorTheme.colorThemeOverride=l,m._reloadColorTheme())}_getTransitionParameters(r){return{now:i.q.now(),transition:i.l(this.transition,r)}}updateDrapeFirstLayers(){if(!this.terrain)return;const r=[],l=[];for(const m of this._mergedOrder)this.isLayerDraped(this._mergedLayers[m])?r.push(m):l.push(m);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...l)}_createTerrain(r,l){const m=this.terrain=new xe(r,l,this.scope,this.options);l===1&&(this.stylesheet.terrain=r),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const w=this._getTransitionParameters({duration:0});m.updateTransitions(w)}_force3DLayerUpdate(){for(const r in this._layers){const l=this._layers[r];l.type==="fill-extrusion"&&this._updateLayer(l)}}_forceSymbolLayerUpdate(){for(const r in this._layers){const l=this._layers[r];l.type==="symbol"&&this._updateLayer(l)}}_validate(r,l,m,w,T={}){if(T&&T.validate===!1)return!1;const I=i.l({},this.serialize());return O(this,r.call($i,i.l({key:l,style:I,value:m,styleSpec:i.a3},w)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.cx.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._mergedLayers)this._mergedLayers[r].setEventedParent(null);for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles(),this._mergedSourceCaches[r].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(r){const l=this.getSourceCaches(r);for(const m of l)m.clearTiles()}clearSources(){for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles()}reloadSource(r){const l=this.getSourceCaches(r);for(const m of l)m.resume(),m.reload()}reloadSources(){for(const r of this.getSources())r.reload&&r.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(r=>{r.modelManager.reloadModels(r.scope)})}updateSources(r){let l;this.directionalLight&&(l=iu(this.directionalLight));for(const m in this._mergedSourceCaches)this._mergedSourceCaches[m].update(r,void 0,void 0,l)}_generateCollisionBoxes(){for(const r in this._sourceCaches){const l=this._sourceCaches[r];l.resume(),l.reload()}}_updatePlacement(r,l,m,w,T,I,N=!1){let G=!1,X=!1;const Z={},J={};for(const Q of this._mergedOrder){const ae=this._mergedLayers[Q];if(ae.type!=="symbol")continue;const ye=i.aC(ae.source,ae.scope);let fe=Z[ye];if(!fe){const _e=this.getLayerSourceCache(ae);if(!_e)continue;const Ce=_e.getRenderableIds(!0).map(ze=>_e.getTileByID(ze));J[ye]=Ce.slice(),fe=Z[ye]=Ce.sort((ze,De)=>De.tileID.overscaledZ-ze.tileID.overscaledZ||(ze.tileID.isLessThan(De.tileID)?-1:1))}const be=this.crossTileSymbolIndex.addLayer(ae,fe,l.center.lng,l.projection);G=G||be}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),N=N||this._layerOrderChanged||w===0,this._layerOrderChanged&&this.fire(new i.z("neworder")),(N||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.q.now(),l.zoom))&&(this.pauseablePlacement=new ip(l,this._mergedOrder,N,m,w,T,this.placement,this.fog&&l.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,Z,J,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.q.now()),X=!0),G&&this.pauseablePlacement.placement.setStale()),X||G){this._buildingIndex.onNewFrame(l.zoom);for(let Q=0;Q<this._mergedOrder.length;Q++){const ae=this._mergedLayers[this._mergedOrder[Q]];if(ae.type!=="symbol")continue;const ye=this.isLayerClipped(ae);this.placement.updateLayerOpacities(ae,Z[i.aC(ae.source,ae.scope)],Q,ye?I:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.q.now())}}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}addImport(r,l){this._checkLoaded();const m=this.stylesheet.imports=this.stylesheet.imports||[];if(m.findIndex(({id:T})=>T===r.id)!==-1)return void this.fire(new i.y(new Error(`Import with id '${r.id}' already exists in the map's style.`)));if(!l)return m.push(r),this._loadImports([r],!0);const w=m.findIndex(({id:T})=>T===l);return w===-1&&this.fire(new i.y(new Error(`Import with id "${l}" does not exist on this map.`))),this.stylesheet.imports=m.slice(0,w).concat(r).concat(m.slice(w)),this._loadImports([r],!0,l)}updateImport(r,l){this._checkLoaded();const m=this.stylesheet.imports||[],w=this.getImportIndex(r);return w===-1?this:typeof l=="string"?(this.setImportUrl(r,l),this):(l.url&&l.url!==m[w].url&&this.setImportUrl(r,l.url),i.bn(l.config,m[w].config)||this.setImportConfig(r,l.config,l.data.schema),i.bn(l.data,m[w].data)||this.setImportData(r,l.data),this)}moveImport(r,l){this._checkLoaded();let m=this.stylesheet.imports||[];const w=this.getImportIndex(r);if(w===-1)return this;const T=this.getImportIndex(l);if(T===-1)return this;const I=m[w],N=this.fragments[w];return m=m.filter(({id:G})=>G!==r),this.fragments=this.fragments.filter(({id:G})=>G!==r),this.stylesheet.imports=m.slice(0,T).concat(I).concat(m.slice(T)),this.fragments=this.fragments.slice(0,T).concat(N).concat(this.fragments.slice(T)),this.mergeLayers(),this}setImportUrl(r,l){this._checkLoaded();const m=this.stylesheet.imports||[],w=this.getImportIndex(r);if(w===-1)return this;m[w].url=l;const T=this.fragments[w];return T.style=this._createFragmentStyle(m[w]),T.style.on("style.import.load",()=>this.mergeAll()),T.style.loadURL(l),this}setImportData(r,l){this._checkLoaded();const m=this.getImportIndex(r),w=this.stylesheet.imports||[];return m===-1?this:l?(this.fragments[m].style.setState(l),this._reloadImports(),this):(delete w[m].data,this.setImportUrl(r,w[m].url))}setImportConfig(r,l,m){this._checkLoaded();const w=this.getImportIndex(r),T=this.stylesheet.imports||[];if(w===-1)return this;l?T[w].config=l:delete T[w].config;const I=this.fragments[w];m&&I.style.stylesheet&&(I.style.stylesheet.schema=m);const N=I.style.stylesheet&&I.style.stylesheet.schema;return I.config=l,I.style.updateConfig(l,N),this.updateConfigDependencies(),this}removeImport(r){this._checkLoaded();const l=this.stylesheet.imports||[],m=this.getImportIndex(r);m!==-1&&(l.splice(m,1),this.fragments[m].style._remove(),this.fragments.splice(m,1),this._reloadImports())}getImportIndex(r){const l=(this.stylesheet.imports||[]).findIndex(m=>m.id===r);return l===-1&&this.fire(new i.y(new Error(`Import '${r}' does not exist in the map's style and cannot be updated.`))),l}getLayer(r){return this._mergedLayers[r]}getSources(){const r=[];for(const l in this._mergedOtherSourceCaches){const m=this._mergedOtherSourceCaches[l];m&&r.push(m.getSource())}return r}getSource(r,l){const m=this.getSourceCache(r,l);return m&&m.getSource()}getLayerSource(r){const l=this.getLayerSourceCache(r);return l&&l.getSource()}getSourceCache(r,l){const m=i.aC(r,l);return this._mergedOtherSourceCaches[m]}getLayerSourceCache(r){const l=i.aC(r.source,r.scope);return r.type==="symbol"?this._mergedSymbolSourceCaches[l]:this._mergedOtherSourceCaches[l]}getSourceCaches(r){if(r==null)return Object.values(this._mergedSourceCaches);const l=[];return this._mergedOtherSourceCaches[r]&&l.push(this._mergedOtherSourceCaches[r]),this._mergedSymbolSourceCaches[r]&&l.push(this._mergedSymbolSourceCaches[r]),l}updateSourceCaches(){const r=this._changes.getUpdatedSourceCaches();for(const l in r){const m=r[l];m==="reload"?this.reloadSource(l):m==="clear"&&this.clearSource(l)}}updateLayers(r){const l=this._changes.getUpdatedPaintProperties();for(const m of l){const w=this.getLayer(m);w&&w.updateTransitions(r)}}getImages(r,l,m){this.imageManager.getImages(l.icons,l.scope,m),this._updateTilesForChangedImages();const w=T=>{T&&T.setDependencies(l.tileID.key,l.type,l.icons)};w(this._otherSourceCaches[l.source]),w(this._symbolSourceCaches[l.source])}rasterizeImages(r,l,m){this.imageManager.rasterizeImages(l,m)}getGlyphs(r,l,m){this.glyphManager.getGlyphs(l.stacks,l.scope,m)}getResource(r,l,m){return i.cy(l,m)}getOwnSourceCache(r){return this._otherSourceCaches[r]}getOwnLayerSourceCache(r){return r.type==="symbol"?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}getOwnSourceCaches(r){const l=[];return this._otherSourceCaches[r]&&l.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&l.push(this._symbolSourceCaches[r]),l}_isSourceCacheLoaded(r){const l=this.getOwnSourceCaches(r);return l.length===0?(this.fire(new i.y(new Error(`There is no source with ID '${r}'`))),!1):l.every(m=>m.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(r,l){if(!this._clipLayerPresent&&r.type!=="fill-extrusion")return!1;const m=r.type==="fill-extrusion"&&r.sourceLayer==="building";if(r.is3D()){if(m||l&&l.type==="batched-model"||r.type==="model")return!0}else if(r.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(r=>{r.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}et.getSourceType=function(p){return Ri[p]},et.setSourceType=function(p,r){Ri[p]=r},et.registerForPluginStateChange=i.ch;var Dt=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,Ht=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,bn=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,Hn="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",sr=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,xr=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Jr=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,Qr=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,xi=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,Si=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,mi=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz/=light_view_pos0.w;vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const Wa=[];Rl(Dt,Wa),Rl(bn,Wa),Rl(Ht,Wa);const _s={"_prelude_fog.vertex.glsl":xr,"_prelude_terrain.vertex.glsl":sr,"_prelude_shadow.vertex.glsl":Si,"_prelude_fog.fragment.glsl":Jr,"_prelude_shadow.fragment.glsl":mi,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":Qr,"_prelude_raster_particle.glsl":xi},Pl={};Ar("",sr),Ar(Jr,xr),Ar(mi,Si),Ar(Qr,""),Ar(xi,"");const au=Ar(Ht,bn),ou=Dt;var jo={background:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Ar("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ar(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Ar(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Ar("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Ar("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Ar("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Ar(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Ar(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Ar(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Ar(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Ar("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Ar("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Ar(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:Ar(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#endif
}`),terrainRaster:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Ar("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Ar(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Hn),skyboxGradient:Ar(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Hn),skyboxCapture:Ar(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Ar(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Ar(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Ar(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:Ar("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:Ar("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:Ar("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:Ar("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Rl(p,r){const l=p.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let m of l)if(m=m.trim(),m[0]==="#"&&m.includes("if")&&!m.includes("endif")){m=m.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const w=m.split(" ");for(const T of w)r.includes(T)||r.push(T)}}function Ar(p,r){const l=/#include\s+"([^"]+)"/g,m=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let w=r.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);w&&(w=w.map(X=>{const Z=X.split(" ");return Z[Z.length-1]}),w=[...new Set(w)]);const T={},I=[],N=[];if(p=p.replace(l,(X,Z)=>(N.push(Z),"")),(r=r.replace(l,(X,Z)=>(I.push(Z),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let G=[...Wa];Rl(p,G),Rl(r,G);for(const X of[...I,...N])_s[X]||console.error(`Undefined include: ${X}`),Pl[X]||(Pl[X]=[],Rl(_s[X],Pl[X])),G=[...G,...Pl[X]];return{fragmentSource:p=p.replace(m,(X,Z,J,Q,ae)=>(T[ae]=!0,Z==="define"?`
#ifndef HAS_UNIFORM_u_${ae}
in ${J} ${Q} ${ae};
#else
uniform ${J} ${Q} u_${ae};
#endif
`:Z==="initialize"?`
#ifdef HAS_UNIFORM_u_${ae}
    ${J} ${Q} ${ae} = u_${ae};
#endif
`:Z==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    in ${J} ${Q} ${ae};
#endif
`:Z==="initialize-attribute"?"":void 0)),vertexSource:r=r.replace(m,(X,Z,J,Q,ae)=>{const ye=Q==="float"?"vec2":Q,fe=ae.match(/color/)?"color":ye;return Z==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
in ${J} ${Q} a_${ae};
#endif
`:T[ae]?Z==="define"?`
#ifndef HAS_UNIFORM_u_${ae}
uniform lowp float u_${ae}_t;
in ${J} ${ye} a_${ae};
out ${J} ${Q} ${ae};
#else
uniform ${J} ${Q} u_${ae};
#endif
`:Z==="initialize"?fe==="vec4"?`
#ifndef HAS_UNIFORM_u_${ae}
    ${ae} = a_${ae};
#else
    ${J} ${Q} ${ae} = u_${ae};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ae}
    ${ae} = unpack_mix_${fe}(a_${ae}, u_${ae}_t);
#else
    ${J} ${Q} ${ae} = u_${ae};
#endif
`:Z==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    in ${J} ${Q} a_${ae};
    out ${J} ${Q} ${ae};
#endif
`:Z==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    ${ae} = a_${ae};
#endif
`:void 0:Z==="define"?`
#ifndef HAS_UNIFORM_u_${ae}
uniform lowp float u_${ae}_t;
in ${J} ${ye} a_${ae};
#else
uniform ${J} ${Q} u_${ae};
#endif
`:Z==="define-instanced"?fe==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${ae}0;
in vec4 a_${ae}1;
in vec4 a_${ae}2;
in vec4 a_${ae}3;
#else
uniform ${J} ${Q} u_${ae};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${J} ${ye} a_${ae};
#else
uniform ${J} ${Q} u_${ae};
#endif
`:Z==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    ${J} ${Q} ${ae} = a_${ae};
#endif
`:fe==="vec4"?`
#ifndef HAS_UNIFORM_u_${ae}
    ${J} ${Q} ${ae} = a_${ae};
#else
    ${J} ${Q} ${ae} = u_${ae};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ae}
    ${J} ${Q} ${ae} = unpack_mix_${fe}(a_${ae}, u_${ae}_t);
#else
    ${J} ${Q} ${ae} = u_${ae};
#endif
`}),staticAttributes:w,usedDefines:G,vertexIncludes:I,fragmentIncludes:N}}class kl{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(r,l,m,w,T,I,N,G){this.context=r;let X=this.boundPaintVertexBuffers.length!==w.length;for(let J=0;!X&&J<w.length;J++)this.boundPaintVertexBuffers[J]!==w[J]&&(X=!0);let Z=this.boundDynamicVertexBuffers.length!==N.length;for(let J=0;!Z&&J<N.length;J++)this.boundDynamicVertexBuffers[J]!==N[J]&&(Z=!0);if(!this.vao||this.boundProgram!==l||this.boundLayoutVertexBuffer!==m||X||Z||this.boundIndexBuffer!==T||this.boundVertexOffset!==I)this.freshBind(l,m,w,T,I,N,G);else{r.bindVertexArrayOES.set(this.vao);for(const J of N)J&&(J.bind(),G&&J.instanceCount&&J.setVertexAttribDivisor(r.gl,l,G));T&&T.dynamicDraw&&T.bind()}}freshBind(r,l,m,w,T,I,N){const G=r.numAttributes,X=this.context,Z=X.gl;this.vao&&this.destroy(),this.vao=X.gl.createVertexArray(),X.bindVertexArrayOES.set(this.vao),this.boundProgram=r,this.boundLayoutVertexBuffer=l,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=w,this.boundVertexOffset=T,this.boundDynamicVertexBuffers=I,l.enableAttributes(Z,r),l.bind(),l.setVertexAttribPointers(Z,r,T);for(const J of m)J.enableAttributes(Z,r),J.bind(),J.setVertexAttribPointers(Z,r,T);for(const J of I)J&&(J.enableAttributes(Z,r),J.bind(),J.setVertexAttribPointers(Z,r,T),N&&J.instanceCount&&J.setVertexAttribDivisor(Z,r,N));w&&w.bind(),X.currentNumAttributes=G}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Dl(p,r){const l=Math.pow(2,r.canonical.z),m=r.canonical.y;return[new i.aa(0,m/l).toLngLat().lat,new i.aa(0,(m+1)/l).toLngLat().lat]}function qs(p,r,l,m,w,T,I){const N=p.context,G=N.gl,X=l.hillshadeFBO;if(!X)return;p.prepareDrawTile();const Z=p.isTileAffectedByFog(r),J=p.getOrCreateProgram("hillshade",{overrideFog:Z});N.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,X.colorAttachment.get());const Q=((be,_e,Ce,ze)=>{const De=Ce.paint.get("hillshade-shadow-color"),$e=Ce.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",je=Ce.paint.get("hillshade-highlight-color"),Ve=Ce.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",Ue=Ce.paint.get("hillshade-accent-color"),Qe=Ce.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",at=Ce.paint.get("hillshade-emissive-strength");let St=i.ai(Ce.paint.get("hillshade-illumination-direction"));if(Ce.paint.get("hillshade-illumination-anchor")==="viewport")St-=be.transform.angle;else if(be.style&&be.style.enable3dLights()&&be.style.directionalLight){const jt=be.style.directionalLight.properties.get("direction"),It=i.cb(jt.x,jt.y,jt.z);St=i.ai(It[1])}const yt=!be.options.moving;return{u_matrix:ze||be.transform.calculateProjMatrix(_e.tileID.toUnwrapped(),yt),u_image:0,u_latrange:Dl(0,_e.tileID),u_light:[Ce.paint.get("hillshade-exaggeration"),St],u_shadow:De.toRenderColor($e?null:Ce.lut),u_highlight:je.toRenderColor(Ve?null:Ce.lut),u_emissive_strength:at,u_accent:Ue.toRenderColor(Qe?null:Ce.lut)}})(p,l,m,p.terrain?r.projMatrix:null);p.uploadCommonUniforms(N,J,r.toUnwrapped());const{tileBoundsBuffer:ae,tileBoundsIndexBuffer:ye,tileBoundsSegments:fe}=p.getTileBoundsBuffers(l);J.draw(p,G.TRIANGLES,w,T,I,Wn.disabled,Q,m.id,ae,ye,fe)}function eh(p,r,l){if(!r.needsDEMTextureUpload)return;const m=p.context,w=m.gl;m.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||p.getTileTexture(l.stride);const T=l.getPixels();r.demTexture?r.demTexture.update(T,{premultiply:!1}):r.demTexture=new i.T(m,T,w.R32F,{premultiply:!1}),r.needsDEMTextureUpload=!1}function Gh(p,r,l){const m=p.context,w=m.gl;if(!r.dem)return;const T=r.dem;if(m.activeTexture.set(w.TEXTURE1),eh(p,r,T),!r.demTexture)return;r.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE);const I=T.dim;m.activeTexture.set(w.TEXTURE0);let N=r.hillshadeFBO;if(!N){const Q=new i.T(m,{width:I,height:I,data:null},w.RGBA8);Q.bind(w.LINEAR,w.CLAMP_TO_EDGE),N=r.hillshadeFBO=m.createFramebuffer(I,I,!0,"renderbuffer"),N.colorAttachment.set(Q.texture)}m.bindFramebuffer.set(N.framebuffer),m.viewport.set([0,0,I,I]);const{tileBoundsBuffer:G,tileBoundsIndexBuffer:X,tileBoundsSegments:Z}=p.getMercatorTileBoundsBuffers(),J=[];p.linearFloatFilteringSupported()&&J.push("TERRAIN_DEM_FLOAT_FORMAT"),p.getOrCreateProgram("hillshadePrepare",{defines:J}).draw(p,w.TRIANGLES,qn.disabled,Qn.disabled,vr.unblended,Wn.disabled,((Q,ae)=>{const ye=ae.stride,fe=i.ab.mat4.create();return i.ab.mat4.ortho(fe,0,i.ag,-i.ag,0,0,1),i.ab.mat4.translate(fe,fe,[0,-i.ag,0]),{u_matrix:fe,u_image:1,u_dimension:[ye,ye],u_zoom:Q.overscaledZ}})(r.tileID,T),l.id,G,X,Z),r.needsHillshadePrepare=!1}class gi{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class $h extends gi{getDefault(){return i.aj.transparent}set(r){const l=this.current;(r.r!==l.r||r.g!==l.g||r.b!==l.b||r.a!==l.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class vs extends gi{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class xs extends gi{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class Ru extends gi{getDefault(){return[!0,!0,!0,!0]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class su extends gi{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class lu extends gi{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class th extends gi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const l=this.current;(r.func!==l.func||r.ref!==l.ref||r.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class Hh extends gi{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class nh extends gi{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=r,this.dirty=!1}}class op extends gi{getDefault(){return[0,1]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class Xi extends gi{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=r,this.dirty=!1}}class ao extends gi{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class yi extends gi{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.BLEND):l.disable(l.BLEND),this.current=r,this.dirty=!1}}class bs extends gi{getDefault(){const r=this.gl;return[r.ONE,r.ZERO,r.ONE,r.ZERO]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.blendFuncSeparate(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class sl extends gi{getDefault(){return i.aj.transparent}set(r){const l=this.current;(r.r!==l.r||r.g!==l.g||r.b!==l.b||r.a!==l.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Jf extends gi{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(r,r),this.current=r,this.dirty=!1)}}class uu extends gi{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=r,this.dirty=!1}}class sp extends gi{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class lp extends gi{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}let cc=class extends gi{getDefault(){return null}set(p){(p!==this.current||this.dirty)&&(this.gl.useProgram(p),this.current=p,this.dirty=!1)}};class Xh extends gi{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class Yh extends gi{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class cu extends gi{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class Dg extends gi{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class gm extends gi{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindTexture(l.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class Lg extends gi{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class up extends gi{getDefault(){return null}set(r){const l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class zg extends gi{getDefault(){return null}set(r){this.gl&&(r!==this.current||this.dirty)&&(this.gl.bindVertexArray(r),this.current=r,this.dirty=!1)}}class Qf extends gi{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class cp extends gi{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class hc extends gi{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class fc extends gi{constructor(r,l){super(r),this.context=r,this.parent=l}getDefault(){return null}}class ku extends fc{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class rh extends fc{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,this.attachment(),l.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class ed extends fc{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,this.attachment(),l.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class ym extends rh{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const hp=(p,r,l)=>({u_matrix:p,u_image0:0,u_skirt_height:r,u_ground_shadow_factor:l}),ws=(p,r,l,m,w,T,I,N,G,X,Z,J,Q,ae,ye,fe)=>({u_proj_matrix:Float32Array.from(p),u_globe_matrix:r,u_normalize_matrix:Float32Array.from(m),u_merc_matrix:l,u_zoom_transition:w,u_merc_center:T,u_image0:0,u_frustum_tl:I,u_frustum_tr:N,u_frustum_br:G,u_frustum_bl:X,u_globe_pos:Z,u_globe_radius:J,u_viewport:Q,u_grid_matrix:fe?Float32Array.from(fe):new Float32Array(9),u_skirt_height:ae,u_far_z_cutoff:ye});function fp(p,r){return p!=null&&r!=null&&!(!p.hasData()||!r.hasData())&&p.demTexture!=null&&r.demTexture!=null&&p.tileID.key!==r.tileID.key}const go=new class{constructor(){this.operations={}}newMorphing(p,r,l,m,w){if(p in this.operations){const T=this.operations[p];T.to.tileID.key!==l.tileID.key&&(T.queued=l)}else this.operations[p]={startTime:m,phase:0,duration:w,from:r,to:l,queued:null}}getMorphValuesForProxy(p){if(!(p in this.operations))return null;const r=this.operations[p];return{from:r.from,to:r.to,phase:r.phase}}update(p){for(const r in this.operations){const l=this.operations[r];for(l.phase=(p-l.startTime)/l.duration;l.phase>=1||!this._validOp(l);)if(!this._nextOp(l,p)){delete this.operations[r];break}}}_nextOp(p,r){return!!p.queued&&(p.from=p.to,p.to=p.queued,p.queued=null,p.phase=0,p.startTime=r,!0)}_validOp(p){return p.from.hasData()&&p.to.hasData()}},ih={0:null,1:"TERRAIN_VERTEX_MORPHING"};function Zh(p,r,l){if(r===0)return 0;const m=r<1&&l===514?.25/r:1;return 6*Math.pow(1.5,22-p)*Math.max(r,1)*m}function dp(p,r){const l=1<<p.z;return!r&&(p.x===0||p.x===l-1)||p.y===0||p.y===l-1}const Wh=p=>({u_matrix:p});function Uo(p,r,l,m,w){if(w>0){const T=i.q.now(),I=(T-p.timeAdded)/w,N=r?(T-r.timeAdded)/w:-1,G=l.getSource(),X=m.coveringZoomLevel({tileSize:G.tileSize,roundZoom:G.roundZoom}),Z=!r||Math.abs(r.tileID.overscaledZ-X)>Math.abs(p.tileID.overscaledZ-X),J=Z&&p.refreshedUponExpiration?1:i.aw(Z?I:1-N,0,1);return p.refreshedUponExpiration&&I>=1&&(p.refreshedUponExpiration=!1),r?{opacity:1,mix:1-J}:{opacity:J,mix:0}}return{opacity:1,mix:0}}class ll extends Xa{constructor(r){const l={type:"raster-dem",maxzoom:r.transform.maxZoom},m=new i.D(i.ci(),null),w=Vi("mock-dem",l,m,r.style);super("mock-dem",w,!1),w.setEventedParent(this),this._sourceLoaded=!0}_loadTile(r,l){r.state="loaded",l(null)}}class dc extends Xa{constructor(r){const l=Vi("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new i.D(i.ci(),null),r.style);super("proxy",l,!1),l.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,l,m){if(r.freezeTileCoverage)return;this.transform=r;const w=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((T,I)=>{if(T[I.key]="",!this._tiles[I.key]){const N=new al(I,this._source.tileSize*I.overscaleFactor(),r.tileZoom);N.state="loaded",this._tiles[I.key]=N}return T},{});for(const T in this._tiles)T in w||(this.freeFBO(T),this._tiles[T].unloadVectorData(),delete this._tiles[T])}freeFBO(r){const l=this.proxyCachedFBO[r];if(l!==void 0){const m=Object.values(l);this.renderCachePool.push(...m),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class pp extends i.aG{constructor(r,l,m){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=l,this.projMatrix=m}}class Gs extends i.cJ{constructor(r,l){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},r.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[m,w,T]=function(G){const X=new i.b4,Z=new i.aU,J=131;X.reserve(17161),Z.reserve(33800);const Q=i.ag/128,ae=i.ag+Q/2,ye=ae+Q;for(let be=-Q;be<ye;be+=Q)for(let _e=-Q;_e<ye;_e+=Q){const Ce=_e<0||_e>ae||be<0||be>ae?24575:0,ze=i.aw(Math.round(_e),0,i.ag),De=i.aw(Math.round(be),0,i.ag);X.emplaceBack(ze+Ce,De)}const fe=(be,_e)=>{const Ce=_e*J+be;Z.emplaceBack(Ce+1,Ce,Ce+J),Z.emplaceBack(Ce+J,Ce+J+1,Ce+1)};for(let be=1;be<129;be++)for(let _e=1;_e<129;_e++)fe(_e,be);return[0,129].forEach(be=>{for(let _e=0;_e<130;_e++)fe(_e,be),fe(be,_e)}),[X,Z,32768]}(),I=r.context;this.gridBuffer=I.createVertexBuffer(m,i.b6.members),this.gridIndexBuffer=I.createIndexBuffer(w),this.gridSegments=i.b7.simpleSegment(0,0,m.length,w.length),this.gridNoSkirtSegments=i.b7.simpleSegment(0,0,m.length,T),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new dc(l.map),this.orthoMatrix=i.ab.mat4.create(),i.ab.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,i.ag,0,i.ag,0,1);const N=I.gl;this._overlapStencilMode=new Qn({func:N.GEQUAL,mask:255},0,255,N.KEEP,N.KEEP,N.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=l,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new ll(l.map),this._pendingGroundEffectLayers=[]}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),this._style=r,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(r,l,m){if(r&&r.terrain){this._style!==r&&(this.style=r,this._evaluationZoom=void 0);const w=r.terrain.properties,T=r.terrain.drapeRenderMode===0,I=r.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=i.q.now();const N=r.terrain&&r.terrain.scope,G=w.get("source"),X=T?this._mockSourceCache:r.getSourceCache(G,N);if(!X)return void i.w(`Couldn't find terrain source "${G}".`);if(this.sourceCache=X,this._attenuationRange=r.terrain.getAttenuationRange(),this._exaggeration=I?this.calculateExaggeration(l):w.get("exaggeration"),!l.projection.requiresDraping&&I&&this._exaggeration===0)return void this._disable();this.enabled=!0;const Z=()=>{this.sourceCache.used&&i.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const J=this.getScaledDemTileSize();this.sourceCache.update(l,J,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,Z(),this._initializing=!0),Z(),l.updateElevation(!0,m),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(l),this._emptyDEMTextureDirty=!0,this._previousZoom=l.zoom}else this._disable()}calculateExaggeration(r){if(this._attenuationRange&&r.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(r.zoom);const l=this._previousCameraAltitude,m=r.getFreeCameraOptions().position.z/r.pixelsPerMeter*r.worldSize;this._previousCameraAltitude=m;const w=l!=null?m-l:Number.MAX_VALUE;if(Math.abs(w)<2)return this._exaggeration;const T=r.zoom,I=this._style.terrain;if(!this._previousUpdateTimestamp)return I.getExaggeration(T);let N=T-this._previousZoom;const G=this._previousUpdateTimestamp;let X=T;this._evaluationZoom!=null&&(X=this._evaluationZoom,Math.abs(T-X)>.5&&(N=.5*(T-X+N)),N*w<0&&(X+=N)),this._evaluationZoom=X;const Z=I.getExaggeration(X),J=Z===I.getExaggeration(Math.max(0,X-.1));if(J&&Math.abs(Z-this._exaggeration)<.01)return Z;let Q=Math.min(.1,.00375*(this._updateTimestamp-G));return(J||Z<.1||Math.abs(N)<1e-4)&&(Q=Math.min(.2,4*Q)),i.af(this._exaggeration,Z,Q)}resetTileLookupCache(r){this._findCoveringTileCache[r]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(r){r.coord&&r.dataType==="source"?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):r.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._mergedSourceCaches)this._style._mergedSourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const l=this.proxySourceCache,m=this.painter.transform;this._initializing&&(this._initializing=m._centerAltitude===0&&this.getAtPointOrZero(i.aa.fromLngLat(m.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const w=this.proxyCoords=l.getIds().map(G=>{const X=l.getTileByID(G).tileID;return X.projMatrix=m.calculateProjMatrix(X.toUnwrapped()),X});(function(G,X){const Z=X.transform.pointCoordinate(X.transform.getCameraPoint()),J=new i.P(Z.x,Z.y);G.sort((Q,ae)=>{if(ae.overscaledZ-Q.overscaledZ)return ae.overscaledZ-Q.overscaledZ;const ye=new i.P(Q.canonical.x+(1<<Q.canonical.z)*Q.wrap,Q.canonical.y),fe=new i.P(ae.canonical.x+(1<<ae.canonical.z)*ae.wrap,ae.canonical.y),be=J.mult(1<<Q.canonical.z);return be.x-=.5,be.y-=.5,be.distSqr(ye)-be.distSqr(fe)})})(w,this.painter);const T=this.proxyToSource||{};this.proxyToSource={},w.forEach(G=>{this.proxyToSource[G.key]={}}),this.terrainTileForTile={};const I=this._style._mergedSourceCaches;for(const G in I){const X=I[G];if(!X.used||(X!==this.sourceCache&&this.resetTileLookupCache(X.id),this._setupProxiedCoordsForOrtho(X,r[G],T),X.usedForTerrain))continue;const Z=r[G];X.getSource().reparseOverscaled&&this._assignTerrainTiles(Z)}this.proxiedCoords[l.id]=w.map(G=>new pp(G,G.key,this.orthoMatrix)),this._assignTerrainTiles(w),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(T),this.renderingToTexture=!1;const N={};this._visibleDemTiles=[];for(const G of this.proxyCoords){const X=this.terrainTileForTile[G.key];if(!X)continue;const Z=X.tileID.key;Z in N||(this._visibleDemTiles.push(X),N[Z]=Z)}}_assignTerrainTiles(r){this._initializing||r.forEach(l=>{if(this.terrainTileForTile[l.key])return;const m=this._findTileCoveringTileID(l,this.sourceCache);m&&(this.terrainTileForTile[l.key]=m)})}_prepareDEMTextures(){const r=this.painter.context,l=r.gl;for(const m in this.terrainTileForTile){const w=this.terrainTileForTile[m],T=w.dem;!T||w.demTexture&&!w.needsDEMTextureUpload||(r.activeTexture.set(l.TEXTURE1),eh(this.painter,w,T))}}_prepareDemTileUniforms(r,l,m,w){if(!l||l.demTexture==null)return!1;const T=r.tileID.canonical,I=Math.pow(2,l.tileID.canonical.z-T.z),N=w||"";return m[`u_dem_tl${N}`]=[T.x*I%1,T.y*I%1],m[`u_dem_scale${N}`]=I,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let r=0;const l=this._visibleDemTiles.reduce((m,w)=>{if(!w.dem)return m;const T=w.dem.tree.minimums[0];return T>0&&r++,m+T},0);return r?l/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,l=r.gl;r.activeTexture.set(l.TEXTURE2);const m=this._getLoadedAreaMinimum(),w=new i.cK({width:1,height:1},new Float32Array([m]));this._emptyDEMTextureDirty=!1;let T=this._emptyDEMTexture;return T?T.update(w,{premultiply:!1}):T=this._emptyDEMTexture=new i.T(r,w,l.R32F,{premultiply:!1}),T}setupElevationDraw(r,l,m){const w=this.painter.context,T=w.gl,I={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};I.u_exaggeration=this.exaggeration();let N=null,G=null,X=1;if(m&&m.morphing&&this._useVertexMorphing){const ae=m.morphing.srcDemTile,ye=m.morphing.dstDemTile;X=m.morphing.phase,ae&&ye&&(this._prepareDemTileUniforms(r,ae,I,"_prev")&&(G=ae),this._prepareDemTileUniforms(r,ye,I)&&(N=ye))}const Z=ae=>ae&&ae.demTexture&&this.painter.linearFloatFilteringSupported()?T.LINEAR:T.NEAREST;let J=null;var Q;if(this.enabled?G&&N?(J=N.demTexture,w.activeTexture.set(T.TEXTURE4),G.demTexture.bind(Z(G),T.CLAMP_TO_EDGE),I.u_dem_lerp=X):(N=this.terrainTileForTile[r.tileID.key],J=this._prepareDemTileUniforms(r,N,I)?N.demTexture:this.emptyDEMTexture):J=this.emptyDEMTexture,w.activeTexture.set(T.TEXTURE2),J&&(I.u_dem_size=(Q=J).size[0]===1?1:Q.size[0]-2,J.bind(Z(N),T.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(m&&m.useDepthForOcclusion,l,I),m&&m.useMeterToDem&&N){const ae=(1<<N.tileID.canonical.z)*i.bH(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;I.u_meter_to_dem=ae}if(m&&m.labelPlaneMatrixInv&&(I.u_label_plane_matrix_inv=m.labelPlaneMatrixInv),l.setTerrainUniformValues(w,I),this.painter.transform.projection.name==="globe"){const ae=this.globeUniformValues(this.painter.transform,r.tileID.canonical,m&&m.useDenormalizedUpVectorScale);l.setGlobeUniformValues(w,ae)}}globeUniformValues(r,l,m){const w=r.projection;return{u_tile_tl_up:w.upVector(l,0,0),u_tile_tr_up:w.upVector(l,i.ag,0),u_tile_br_up:w.upVector(l,i.ag,i.ag),u_tile_bl_up:w.upVector(l,0,i.ag),u_tile_up_scale:m?i.cL(1):w.upVectorScale(l,r.center.lat,r.worldSize).metersToTile}}renderToBackBuffer(r){const l=this.painter,m=this.painter.context;r.length!==0&&(m.bindFramebuffer.set(null),m.viewport.set([0,0,l.width,l.height]),l.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(w,T,I,N,G){if(w.transform.projection.name==="globe")(function(X,Z,J,Q,ae){const ye=X.context,fe=ye.gl;let be,_e;const Ce=X.transform,ze=i.cC(X,ye,Ce),De=(jt,It)=>{if(_e===It)return;const ft=[ih[It],"PROJECTION_GLOBE_VIEW"];ze&&ft.push("CUSTOM_ANTIALIASING");const At=X.isTileAffectedByFog(jt);be=X.getOrCreateProgram("globeRaster",{defines:ft,overrideFog:At}),_e=It},$e=X.colorModeForRenderPass(),je=new qn(fe.LEQUAL,qn.ReadWrite,X.depthRangeFor3D);go.update(ae);const Ve=i.cD(Ce),Ue=[i.at(Ce.center.lng),i.aA(Ce.center.lat)],Qe=X.globeSharedBuffers,at=[Ce.width*i.q.devicePixelRatio,Ce.height*i.q.devicePixelRatio],St=Float32Array.from(Ce.globeMatrix),yt={useDenormalizedUpVectorScale:!0};{const jt=X.transform,It=Zh(jt.zoom,Z.exaggeration(),Z.sourceCache._source.tileSize);_e=-1;const ft=fe.TRIANGLES;for(const At of Q){const Qt=J.getTile(At),ht=Qn.disabled,zt=Z.prevTerrainTileForTile[At.key],Mt=Z.terrainTileForTile[At.key];fp(zt,Mt)&&go.newMorphing(At.key,zt,Mt,ae,250),ye.activeTexture.set(fe.TEXTURE0),Qt.texture&&Qt.texture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE);const ln=go.getMorphValuesForProxy(At.key),Yt=ln?1:0;ln&&i.J(yt,{morphing:{srcDemTile:ln.from,dstDemTile:ln.to,phase:i.cB(ln.phase)}});const Ut=i.cE(At.canonical),tn=i.cF(Ut.getCenter().lat),fn=i.cG(At.canonical,Ut,tn,jt.worldSize/jt._pixelsPerMercatorPixel),wn=i.bb(i.cH(At.canonical)),Cn=ws(jt.expandedFarZProjMatrix,St,Ve,wn,i.ae(jt.zoom),Ue,jt.frustumCorners.TL,jt.frustumCorners.TR,jt.frustumCorners.BR,jt.frustumCorners.BL,jt.globeCenterInViewSpace,jt.globeRadius,at,It,jt._farZ,fn);if(De(At,Yt),be&&(Z.setupElevationDraw(Qt,be,yt),X.uploadCommonUniforms(ye,be,At.toUnwrapped()),Qe)){const[Yn,Gn,Un]=Qe.getGridBuffers(tn,It!==0);be.draw(X,ft,je,ht,$e,Wn.backCCW,Cn,"globe_raster",Yn,Gn,Un)}}}if(Qe&&(X.renderDefaultNorthPole||X.renderDefaultSouthPole)){const jt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];ze&&jt.push("CUSTOM_ANTIALIASING"),be=X.getOrCreateProgram("globeRaster",{defines:jt});for(const It of Q){const{x:ft,y:At,z:Qt}=It.canonical,ht=At===0,zt=At===(1<<Qt)-1,[Mt,ln,Yt,Ut]=Qe.getPoleBuffers(Qt,!1);if(Ut&&(ht||zt)){const tn=J.getTile(It);ye.activeTexture.set(fe.TEXTURE0),tn.texture&&tn.texture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE);let fn=i.cI(Qt,ft,Ce);const wn=i.bb(i.cH(It.canonical)),Cn=(Yn,Gn)=>Yn.draw(X,fe.TRIANGLES,je,Qn.disabled,$e,Wn.disabled,ws(Ce.expandedFarZProjMatrix,fn,fn,wn,0,Ue,Ce.frustumCorners.TL,Ce.frustumCorners.TR,Ce.frustumCorners.BR,Ce.frustumCorners.BL,Ce.globeCenterInViewSpace,Ce.globeRadius,at,0,Ce._farZ),"globe_pole_raster",Gn,Yt,Ut);Z.setupElevationDraw(tn,be,yt),X.uploadCommonUniforms(ye,be,It.toUnwrapped()),ht&&X.renderDefaultNorthPole&&Cn(be,Mt),zt&&X.renderDefaultSouthPole&&(fn=i.ab.mat4.scale(i.ab.mat4.create(),fn,[1,-1,1]),Cn(be,ln))}}}})(w,T,I,N,G);else{const X=w.context,Z=X.gl;let J,Q;const ae=w.shadowRenderer,ye=ru(w,w.longestCutoffRange),fe=$e=>{if(Q===$e)return;const je=[];je.push(ih[$e]),ye.shouldRenderCutoff&&je.push("RENDER_CUTOFF"),ae&&(je.push("RENDER_SHADOWS","DEPTH_TEXTURE"),ae.useNormalOffset&&je.push("NORMAL_OFFSET")),J=w.getOrCreateProgram("terrainRaster",{defines:je}),Q=$e},be=w.colorModeForRenderPass(),_e=new qn(Z.LEQUAL,qn.ReadWrite,w.depthRangeFor3D);go.update(G);const Ce=w.transform,ze=Zh(Ce.zoom,T.exaggeration(),T.sourceCache._source.tileSize);let De=[0,0,0];if(ae){const $e=w.style.directionalLight,je=w.style.ambientLight;$e&&je&&(De=Uh(w.style,$e,je))}{Q=-1;const $e=Z.TRIANGLES,[je,Ve]=[T.gridIndexBuffer,T.gridSegments];for(const Ue of N){const Qe=I.getTile(Ue),at=Qn.disabled,St=T.prevTerrainTileForTile[Ue.key],yt=T.terrainTileForTile[Ue.key];fp(St,yt)&&go.newMorphing(Ue.key,St,yt,G,250),X.activeTexture.set(Z.TEXTURE0),Qe.texture&&Qe.texture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE);const jt=go.getMorphValuesForProxy(Ue.key),It=jt?1:0;let ft;jt&&(ft={morphing:{srcDemTile:jt.from,dstDemTile:jt.to,phase:i.cB(jt.phase)}});const At=hp(Ue.projMatrix,dp(Ue.canonical,Ce.renderWorldCopies)?ze/10:ze,De);if(fe(It),!J)continue;T.setupElevationDraw(Qe,J,ft);const Qt=Ue.toUnwrapped();ae&&ae.setupShadows(Qt,J),w.uploadCommonUniforms(X,J,Qt,null,ye),J.draw(w,$e,_e,at,be,Wn.backCCW,At,"terrain_raster",T.gridBuffer,je,Ve)}}}}(l,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,l.gpuTimingDeferredRenderEnd(),r.splice(0,r.length))}renderBatch(r){if(this._drapedRenderBatches.length===0)return r+1;this.renderingToTexture=!0;const l=this.painter,m=this.painter.context,w=this.proxySourceCache,T=this.proxiedCoords[w.id],I=this._drapedRenderBatches.shift(),N=l.style.order,G=[];let X=0;for(const Z of T){const J=w.getTileByID(Z.proxyTileKey),Q=w.proxyCachedFBO[Z.key]?w.proxyCachedFBO[Z.key][r]:void 0,ae=Q!==void 0?w.renderCache[Q]:this.pool[X++],ye=Q!==void 0;if(J.texture=ae.tex,ye&&!ae.dirty){G.push(J.tileID);continue}let fe;m.bindFramebuffer.set(ae.fb.framebuffer),this.renderedToTile=!1,ae.dirty&&(m.clear({color:i.aj.transparent,stencil:0}),ae.dirty=!1);for(let be=I.start;be<=I.end;++be){const _e=l.style._mergedLayers[N[be]];if(_e.isHidden(l.transform.zoom))continue;const Ce=l.style.getLayerSourceCache(_e),ze=Ce?this.proxyToSource[Z.key][Ce.id]:[Z];if(!ze)continue;const De=ze;m.viewport.set([0,0,ae.fb.width,ae.fb.height]),fe!==(Ce?Ce.id:null)&&(this._setupStencil(ae,ze,_e,Ce),fe=Ce?Ce.id:null),l.renderLayer(l,Ce,_e,De)}if(this._drapedRenderBatches.length===0)for(const be of this._pendingGroundEffectLayers){const _e=l.style._mergedLayers[N[be]];if(_e.isHidden(l.transform.zoom))continue;const Ce=l.style.getLayerSourceCache(_e),ze=Ce?this.proxyToSource[Z.key][Ce.id]:[Z];if(!ze)continue;const De=ze;m.viewport.set([0,0,ae.fb.width,ae.fb.height]),fe!==(Ce?Ce.id:null)&&(this._setupStencil(ae,ze,_e,Ce),fe=Ce?Ce.id:null),l.renderLayer(l,Ce,_e,De)}this.renderedToTile?(ae.dirty=!0,G.push(J.tileID)):ye||--X,X===5&&(X=0,this.renderToBackBuffer(G))}return this.renderToBackBuffer(G),this.renderingToTexture=!1,m.bindFramebuffer.set(null),m.viewport.set([0,0,l.width,l.height]),I.end+1}postRender(){}isLayerOrderingCorrect(r){const l=r.order.length;let m=-1,w=l;for(let T=0;T<l;++T)this._style.isLayerDraped(r._mergedLayers[r.order[T]])?m=Math.max(m,T):w=Math.min(w,T);return w>m}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(l=>l.dem).forEach(l=>{r=Math.min(r,l.dem.tree.minimums[0])}),r===0?r:(r-30)*this._exaggeration}raycast(r,l,m){if(!this._visibleDemTiles)return null;const w=this._visibleDemTiles.filter(T=>T.dem).map(T=>{const I=T.tileID,N=1<<I.overscaledZ,{x:G,y:X}=I.canonical,Z=G/N,J=(G+1)/N,Q=X/N,ae=(X+1)/N;return{minx:Z,miny:Q,maxx:J,maxy:ae,t:T.dem.tree.raycastRoot(Z,Q,J,ae,r,l,m),tile:T}});w.sort((T,I)=>(T.t!==null?T.t:Number.MAX_VALUE)-(I.t!==null?I.t:Number.MAX_VALUE));for(const T of w){if(T.t==null)return null;const I=T.tile.dem.tree.raycast(T.minx,T.miny,T.maxx,T.maxy,r,l,m);if(I!=null)return I}return null}_createFBO(){const r=this.painter.context,l=r.gl,m=this.drapeBufferSize;r.activeTexture.set(l.TEXTURE0);const w=new i.T(r,{width:m[0],height:m[1],data:null},l.RGBA8);w.bind(l.LINEAR,l.CLAMP_TO_EDGE);const T=r.createFramebuffer(m[0],m[1],!0,null);return T.colorAttachment.set(w.texture),T.depthAttachment=new ym(r,T.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,m[0],m[1]),this._stencilRef=0,T.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):T.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&l.texParameterf(l.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:T,tex:w,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const r in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const l=this._style._mergedLayers[r],m=l.isHidden(this.painter.transform.zoom);return l.type==="hillshade"||l.type==="custom"?!m&&l.shouldRedrape():!m&&l.hasTransition()})}_clearLineLayersFromRenderCache(){let r=!1;for(const m of this._style.getSources())if(m instanceof Pi){r=!0;break}if(!r)return;const l={};for(let m=0;m<this._style.order.length;++m){const w=this._style._mergedLayers[this._style.order[m]],T=this._style.getLayerSourceCache(w);if(T&&!l[T.id]&&!w.isHidden(this.painter.transform.zoom)&&w.type==="line"&&w.widthExpression()instanceof i.a9){l[T.id]=!0;for(const I of this.proxyCoords){const N=this.proxyToSource[I.key][T.id];if(N)for(const G of N)this._clearRenderCacheForTile(T.id,G)}}}}_clearRasterLayersFromRenderCache(){let r=!1;for(const m in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[m]._source instanceof Ao){r=!0;break}if(!r)return;const l={};for(let m=0;m<this._style.order.length;++m){const w=this._style._mergedLayers[this._style.order[m]],T=this._style.getLayerSourceCache(w);if(!T||l[T.id]||w.isHidden(this.painter.transform.zoom)||w.type!=="raster")continue;const I=w.paint.get("raster-fade-duration");for(const N of this.proxyCoords){const G=this.proxyToSource[N.key][T.id];if(G)for(const X of G){const Z=Uo(T.getTile(X),T.findLoadedParent(X,0),T,this.painter.transform,I);(Z.opacity!==1||Z.mix!==0)&&this._clearRenderCacheForTile(T.id,X)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const r=this._style.order,l=r.length;if(l===0)return;const m=[];this._pendingGroundEffectLayers=[];let w,T=0,I=this._style._mergedLayers[r[T]];for(;!this._style.isLayerDraped(I)&&I.isHidden(this.painter.transform.zoom)&&++T<l;)I=this._style._mergedLayers[r[T]];for(;T<l;++T){const N=this._style._mergedLayers[r[T]];N.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(N)?w===void 0&&(w=T):(N.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(T),w!==void 0&&(m.push({start:w,end:T-1}),w=void 0)))}if(w!==void 0&&m.push({start:w,end:T-1}),m.length!==0){const N=m[m.length-1];this._pendingGroundEffectLayers.every(G=>G>N.end)||i.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=m}_setupRenderCache(r){const l=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,l.renderCache.length>l.renderCachePool.length){const I=Object.values(l.proxyCachedFBO);l.proxyCachedFBO={};for(let N=0;N<I.length;++N){const G=Object.values(I[N]);l.renderCachePool.push(...G)}}return}this._clearRasterLayersFromRenderCache();const m=this.proxyCoords,w=this._tilesDirty;for(let I=m.length-1;I>=0;I--){const N=m[I];if(l.getTileByID(N.key),l.proxyCachedFBO[N.key]!==void 0){const G=r[N.key],X=this.proxyToSource[N.key];let Z=0;for(const J in X){const Q=X[J],ae=G[J];if(!ae||ae.length!==Q.length||Q.some((ye,fe)=>ye!==ae[fe]||w[J]&&w[J].hasOwnProperty(ye.key))){Z=-1;break}++Z}for(const J in l.proxyCachedFBO[N.key])l.renderCache[l.proxyCachedFBO[N.key][J]].dirty=Z<0||Z!==Object.values(G).length}}const T=[...this._drapedRenderBatches];T.sort((I,N)=>N.end-N.start-(I.end-I.start));for(const I of T)for(const N of m){if(l.proxyCachedFBO[N.key])continue;let G=l.renderCachePool.pop();G===void 0&&l.renderCache.length<50&&(G=l.renderCache.length,l.renderCache.push(this._createFBO())),G!==void 0&&(l.proxyCachedFBO[N.key]={},l.proxyCachedFBO[N.key][I.start]=G,l.renderCache[G].dirty=!0)}this._tilesDirty={}}_setupStencil(r,l,m,w){if(!w||!this._sourceTilesOverlap[w.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const T=this.painter.context,I=T.gl;if(l.length<=1)return void(this._overlapStencilType=!1);let N;if(m.isTileClipped())N=l.length,this._overlapStencilMode.test={func:I.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(l[0].overscaledZ>l[l.length-1].overscaledZ))return void(this._overlapStencilType=!1);N=1,this._overlapStencilMode.test={func:I.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+N>255&&(T.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=N,this._overlapStencilMode.ref=this._stencilRef,m.isTileClipped()&&this._renderTileClippingMasks(l,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):Qn.disabled}_renderTileClippingMasks(r,l){const m=this.painter,w=this.painter.context,T=w.gl;m._tileClippingMaskIDs={},w.setColorMode(vr.disabled),w.setDepthMode(qn.disabled);const I=m.getOrCreateProgram("clippingMask");for(const N of r){const G=m._tileClippingMaskIDs[N.key]=--l;I.draw(m,T.TRIANGLES,qn.disabled,new Qn({func:T.ALWAYS,mask:0},G,255,T.KEEP,T.KEEP,T.REPLACE),vr.disabled,Wn.disabled,Wh(N.projMatrix),"$clipping",m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}}pointCoordinate(r){const l=this.painter.transform;if(r.x<0||r.x>l.width||r.y<0||r.y>l.height)return null;const m=[r.x,r.y,1,1];i.ab.vec4.transformMat4(m,m,l.pixelMatrixInverse),i.ab.vec4.scale(m,m,1/m[3]),m[0]/=l.worldSize,m[1]/=l.worldSize;const w=l._camera.position,T=i.bH(1,l.center.lat),I=[w[0],w[1],w[2]/T,0],N=i.ab.vec3.subtract([],m.slice(0,3),I);i.ab.vec3.normalize(N,N);const G=this.raycast(I,N,this._exaggeration);return G!==null&&G?(i.ab.vec3.scaleAndAdd(I,I,N,G),I[3]=I[2],I[2]*=T,I):null}_setupProxiedCoordsForOrtho(r,l,m){if(r.getSource()instanceof i.aJ)return this._setupProxiedCoordsForImageSource(r,l,m);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const w=this.proxiedCoords[r.id]=[],T=this.proxyCoords;for(let G=0;G<T.length;G++){const X=T[G],Z=this._findTileCoveringTileID(X,r);if(Z){const J=this._createProxiedId(X,Z,m[X.key]&&m[X.key][r.id]);w.push(J),this.proxyToSource[X.key][r.id]=[J]}}let I=!1;const N=new Set;for(let G=0;G<l.length;G++){const X=r.getTile(l[G]);if(!X||!X.hasData())continue;const Z=this._findTileCoveringTileID(X.tileID,this.proxySourceCache);if(Z&&Z.tileID.canonical.z!==X.tileID.canonical.z){const J=this.proxyToSource[Z.tileID.key][r.id],Q=this._createProxiedId(Z.tileID,X,m[Z.tileID.key]&&m[Z.tileID.key][r.id]);J?J.splice(J.length-1,0,Q):this.proxyToSource[Z.tileID.key][r.id]=[Q];const ae=this.proxyToSource[Z.tileID.key][r.id];N.has(ae)||N.add(ae),w.push(Q),I=!0}}if(this._sourceTilesOverlap[r.id]=I,I&&this._debugParams.sortTilesHiZFirst)for(const G of N)G.sort((X,Z)=>Z.overscaledZ-X.overscaledZ)}_setupProxiedCoordsForImageSource(r,l,m){if(!r.getSource().loaded())return;const w=this.proxiedCoords[r.id]=[],T=this.proxyCoords,I=r.getSource(),N=I.tileID;if(!N)return;const G=new i.P(N.x,N.y)._div(1<<N.z),X=I.coordinates.map(i.aa.fromLngLat).reduce((J,Q)=>(J.min.x=Math.min(J.min.x,Q.x-G.x),J.min.y=Math.min(J.min.y,Q.y-G.y),J.max.x=Math.max(J.max.x,Q.x-G.x),J.max.y=Math.max(J.max.y,Q.y-G.y),J),{min:new i.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new i.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),Z=(J,Q)=>{const ae=J.wrap+J.canonical.x/(1<<J.canonical.z),ye=J.canonical.y/(1<<J.canonical.z),fe=i.ag/(1<<J.canonical.z),be=Q.wrap+Q.canonical.x/(1<<Q.canonical.z),_e=Q.canonical.y/(1<<Q.canonical.z);return ae+fe<be+X.min.x||ae>be+X.max.x||ye+fe<_e+X.min.y||ye>_e+X.max.y};for(let J=0;J<T.length;J++){const Q=T[J];for(let ae=0;ae<l.length;ae++){const ye=r.getTile(l[ae]);if(!ye||!ye.hasData()||Z(Q,ye.tileID))continue;const fe=this._createProxiedId(Q,ye,m[Q.key]&&m[Q.key][r.id]),be=this.proxyToSource[Q.key][r.id];be?be.push(fe):this.proxyToSource[Q.key][r.id]=[fe],w.push(fe)}}}_createProxiedId(r,l,m){let w=this.orthoMatrix;if(m){const T=m.find(I=>I.key===l.tileID.key);if(T)return T}if(l.tileID.key!==r.key){const T=r.canonical.z-l.tileID.canonical.z;let I,N,G;w=i.ab.mat4.create();const X=l.tileID.wrap-r.wrap<<r.overscaledZ;T>0?(I=i.ag>>T,N=I*((l.tileID.canonical.x<<T)-r.canonical.x+X),G=I*((l.tileID.canonical.y<<T)-r.canonical.y)):(I=i.ag<<-T,N=i.ag*(l.tileID.canonical.x-(r.canonical.x+X<<-T)),G=i.ag*(l.tileID.canonical.y-(r.canonical.y<<-T))),i.ab.mat4.ortho(w,0,I,0,I,0,1),i.ab.mat4.translate(w,w,[N,G,0])}return new pp(l.tileID,r.key,w)}_findTileCoveringTileID(r,l){let m=l.getTile(r);if(m&&m.hasData())return m;const w=this._findCoveringTileCache[l.id],T=w[r.key];if(m=T?l.getTileByID(T):null,m&&m.hasData()||T===null)return m;let I=m?m.tileID:r,N=I.overscaledZ;const G=l.getSource().minzoom,X=[];if(!T){const J=l.getSource().maxzoom;if(r.canonical.z>=J){const Q=r.canonical.z-J;l.getSource().reparseOverscaled?(N=Math.max(r.canonical.z+2,l.transform.tileZoom),I=new i.aG(N,r.wrap,J,r.canonical.x>>Q,r.canonical.y>>Q)):Q!==0&&(N=J,I=new i.aG(N,r.wrap,J,r.canonical.x>>Q,r.canonical.y>>Q))}I.key!==r.key&&(X.push(I.key),m=l.getTile(I))}const Z=J=>{X.forEach(Q=>{w[Q]=J}),X.length=0};for(N-=1;N>=G&&(!m||!m.hasData());N--){m&&Z(m.tileID.key);const J=I.calculateScaledKey(N);if(m=l.getTileByID(J),m&&m.hasData())break;const Q=w[J];if(Q===null)break;Q===void 0?X.push(J):m=l.getTileByID(Q)}return Z(m?m.tileID.key:null),m&&m.hasData()?m:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(r,l){let m=this._tilesDirty[r];m||(m=this._tilesDirty[r]={}),m[l.key]=!0}}function Du(p,r,l){const m=function(N,G,X){const Z=i.ab.vec3.dot(G,N),J=i.ab.vec3.dot(X,[.2126,.7152,.0722]),Q=(ye,fe,be)=>(1-be)*ye+be*fe,ae=Q(1-.3*Math.min(J,1),1,Math.min(Z+1,1));return Q(.92,1,Math.asin(i.aw(G[2],-1,1))/Math.PI+.5)*ae}(p,[0,0,1],r),w=[0,0,0];i.ab.vec3.scale(w,l.slice(0,3),m);const T=[0,0,0];i.ab.vec3.scale(T,r.slice(0,3),p[2]);const I=[0,0,0];return i.ab.vec3.add(I,w,T),i.cf(I)}const oo=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],td=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class Ng{static cacheKey(r,l,m,w){let T=`${l}${w?w.cacheKey:""}`;for(const I of m)r.usedDefines.includes(I)&&(T+=`/${I}`);return T}constructor(r,l,m,w,T,I){const N=r.gl;this.program=N.createProgram(),this.configuration=w,this.name=l,this.fixedDefines=[...I];const G=w?w.getBinderAttributes():[],X=(m.staticAttributes||[]).concat(G);let Z=w?w.defines():[];Z=Z.concat(I.map(be=>`#define ${be}`));const J=`#version 300 es
`;let Q=J+Z.concat("precision mediump float;",ou,au.fragmentSource).join(`
`);for(const be of m.fragmentIncludes)Q+=`
${_s[be]}`;Q+=`
${m.fragmentSource}`;let ae=J+Z.concat("precision highp float;",ou,au.vertexSource).join(`
`);for(const be of m.vertexIncludes)ae+=`
${_s[be]}`;this.forceManualRenderingForInstanceIDShaders=r.forceManualRenderingForInstanceIDShaders&&m.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(ae+=`
uniform int u_instanceID;
`),ae+=`
${m.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(ae=ae.replaceAll("gl_InstanceID","u_instanceID"));const ye=N.createShader(N.FRAGMENT_SHADER);if(N.isContextLost())return void(this.failedToCreate=!0);N.shaderSource(ye,Q),N.compileShader(ye),N.attachShader(this.program,ye);const fe=N.createShader(N.VERTEX_SHADER);if(N.isContextLost())this.failedToCreate=!0;else{N.shaderSource(fe,ae),N.compileShader(fe),N.attachShader(this.program,fe),this.attributes={},this.numAttributes=X.length;for(let be=0;be<this.numAttributes;be++)if(X[be]){const _e=X[be].startsWith("a_")?X[be]:`a_${X[be]}`;N.bindAttribLocation(this.program,be,_e),this.attributes[_e]=be}N.linkProgram(this.program),N.deleteShader(fe),N.deleteShader(ye),this.fixedUniforms=T(r),this.binderUniforms=w?w.getUniforms(r):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(be=>({u_instanceID:new i.bN(be)}))(r)),(I.includes("TERRAIN")||l.indexOf("symbol")!==-1||l.indexOf("circle")!==-1)&&(this.terrainUniforms=(be=>({u_dem:new i.bN(be),u_dem_prev:new i.bN(be),u_dem_tl:new i.bK(be),u_dem_scale:new i.bM(be),u_dem_tl_prev:new i.bK(be),u_dem_scale_prev:new i.bM(be),u_dem_size:new i.bM(be),u_dem_lerp:new i.bM(be),u_exaggeration:new i.bM(be),u_depth:new i.bN(be),u_depth_size_inv:new i.bK(be),u_depth_range_unpack:new i.bK(be),u_occluder_half_size:new i.bM(be),u_occlusion_depth_offset:new i.bM(be),u_meter_to_dem:new i.bM(be),u_label_plane_matrix_inv:new i.bJ(be)}))(r)),I.includes("GLOBE")&&(this.globeUniforms=(be=>({u_tile_tl_up:new i.bL(be),u_tile_tr_up:new i.bL(be),u_tile_br_up:new i.bL(be),u_tile_bl_up:new i.bL(be),u_tile_up_scale:new i.bM(be)}))(r)),I.includes("FOG")&&(this.fogUniforms=(be=>({u_fog_matrix:new i.bJ(be),u_fog_range:new i.bK(be),u_fog_color:new i.ca(be),u_fog_horizon_blend:new i.bM(be),u_fog_vertical_limit:new i.bK(be),u_fog_temporal_offset:new i.bM(be),u_frustum_tl:new i.bL(be),u_frustum_tr:new i.bL(be),u_frustum_br:new i.bL(be),u_frustum_bl:new i.bL(be),u_globe_pos:new i.bL(be),u_globe_radius:new i.bM(be),u_globe_transition:new i.bM(be),u_is_globe:new i.bN(be),u_viewport:new i.bK(be)}))(r)),I.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(be=>({u_cutoff_params:new i.ca(be)}))(r)),I.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(be=>({u_lighting_ambient_color:new i.bL(be),u_lighting_directional_dir:new i.bL(be),u_lighting_directional_color:new i.bL(be),u_ground_radiance:new i.bL(be)}))(r)),I.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(be=>({u_light_matrix_0:new i.bJ(be),u_light_matrix_1:new i.bJ(be),u_fade_range:new i.bK(be),u_shadow_normal_offset:new i.bL(be),u_shadow_intensity:new i.bM(be),u_shadow_texel_size:new i.bM(be),u_shadow_map_resolution:new i.bM(be),u_shadow_direction:new i.bL(be),u_shadow_bias:new i.bL(be),u_shadowmap_0:new i.bN(be),u_shadowmap_1:new i.bN(be)}))(r))}}setTerrainUniformValues(r,l){if(!this.terrainUniforms)return;const m=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const w in l)m[w]&&m[w].set(this.program,w,l[w])}}setGlobeUniformValues(r,l){if(!this.globeUniforms)return;const m=this.globeUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const w in l)m[w]&&m[w].set(this.program,w,l[w])}}setFogUniformValues(r,l){if(!this.fogUniforms)return;const m=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const w in l)m[w].set(this.program,w,l[w])}}setCutoffUniformValues(r,l){if(!this.cutoffUniforms)return;const m=this.cutoffUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const w in l)m[w].set(this.program,w,l[w])}}setLightsUniformValues(r,l){if(!this.lightsUniforms)return;const m=this.lightsUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const w in l)m[w].set(this.program,w,l[w])}}setShadowUniformValues(r,l){if(this.failedToCreate||!this.shadowUniforms)return;const m=this.shadowUniforms;r.program.set(this.program);for(const w in l)m[w].set(this.program,w,l[w])}_drawDebugWireframe(r,l,m,w,T,I,N,G,X,Z){const J=r.options.wireframe;if(J.terrain===!1&&J.layers2D===!1&&J.layers3D===!1)return;const Q=r.context;if(!(!(!J.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!J.layers2D||r._terrain&&r._terrain.renderingToTexture||!oo.includes(this.name))||!(!J.layers3D||!td.includes(this.name))))return;const ae=Q.gl,ye=r.wireframeDebugCache.getLinesFromTrianglesBuffer(r.frameCounter,T,Q);if(!ye)return;const fe=[...this.fixedDefines];fe.push("DEBUG_WIREFRAME");const be=r.getOrCreateProgram(this.name,{config:this.configuration,defines:fe});Q.program.set(be.program);const _e=(De,$e,je)=>{if($e[De]&&je[De])for(const Ve in $e[De])je[De][Ve]&&je[De][Ve].set(je.program,Ve,$e[De][Ve].current)};X&&X.setUniforms(be.program,Q,be.binderUniforms,N,{zoom:G}),_e("fixedUniforms",this,be),_e("terrainUniforms",this,be),_e("globeUniforms",this,be),_e("fogUniforms",this,be),_e("lightsUniforms",this,be),_e("shadowUniforms",this,be),ye.bind(),Q.setColorMode(new vr([ae.ONE,ae.ONE_MINUS_SRC_ALPHA,ae.ZERO,ae.ONE],i.aj.transparent,[!0,!0,!0,!1])),Q.setDepthMode(new qn(l.func===ae.LESS?ae.LEQUAL:l.func,qn.ReadOnly,l.range)),Q.setStencilMode(Qn.disabled);const Ce=3*I.primitiveLength*2,ze=3*I.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const De=Z||1;for(let $e=0;$e<De;++$e)be.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",$e),ae.drawElements(ae.LINES,Ce,ae.UNSIGNED_SHORT,ze)}else Z&&Z>1?ae.drawElementsInstanced(ae.LINES,Ce,ae.UNSIGNED_SHORT,ze,Z):ae.drawElements(ae.LINES,Ce,ae.UNSIGNED_SHORT,ze);T.bind(),Q.program.set(this.program),Q.setDepthMode(l),Q.setStencilMode(m),Q.setColorMode(w)}checkUniforms(r,l,m){if(this.fixedDefines.includes(l)){for(const w of Object.keys(m))if(!m[w].initialized)throw new Error(`Program '${this.name}', from draw '${r}': uniform ${w} not set but required by ${l} being defined`)}}draw(r,l,m,w,T,I,N,G,X,Z,J,Q,ae,ye,fe,be){const _e=r.context,Ce=_e.gl;if(this.failedToCreate)return;_e.program.set(this.program),_e.setDepthMode(m),_e.setStencilMode(w),_e.setColorMode(T),_e.setCullFace(I);for(const $e of Object.keys(this.fixedUniforms))this.fixedUniforms[$e].set(this.program,$e,N[$e]);ye&&ye.setUniforms(this.program,_e,this.binderUniforms,Q,{zoom:ae});const ze={[Ce.POINTS]:1,[Ce.LINES]:2,[Ce.TRIANGLES]:3,[Ce.LINE_STRIP]:1}[l];this.checkUniforms(G,"RENDER_SHADOWS",this.shadowUniforms);const De=be&&be>0?1:void 0;for(const $e of J.get()){const je=$e.vaos||($e.vaos={});if((je[G]||(je[G]=new kl)).bind(_e,this,X,ye?ye.getPaintVertexBuffers():[],Z,$e.vertexOffset,fe||[],De),this.forceManualRenderingForInstanceIDShaders){const Ve=be||1;for(let Ue=0;Ue<Ve;++Ue)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Ue),Z?Ce.drawElements(l,$e.primitiveLength*ze,Ce.UNSIGNED_SHORT,$e.primitiveOffset*ze*2):Ce.drawArrays(l,$e.vertexOffset,$e.vertexLength)}else be&&be>1?Ce.drawElementsInstanced(l,$e.primitiveLength*ze,Ce.UNSIGNED_SHORT,$e.primitiveOffset*ze*2,be):Z?Ce.drawElements(l,$e.primitiveLength*ze,Ce.UNSIGNED_SHORT,$e.primitiveOffset*ze*2):Ce.drawArrays(l,$e.vertexOffset,$e.vertexLength);l===Ce.TRIANGLES&&Z&&this._drawDebugWireframe(r,m,w,T,Z,$e,Q,ae,ye,be)}}}function mp(p,r){const l=Math.pow(2,r.tileID.overscaledZ),m=r.tileSize*Math.pow(2,p.transform.tileZoom)/l,w=m*(r.tileID.canonical.x+r.tileID.wrap*l),T=m*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture?r.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/i.ar(r,1,p.transform.tileZoom),u_pixel_coord_upper:[w>>16,T>>16],u_pixel_coord_lower:[65535&w,65535&T]}}const Kh={terrain:0,flat:1},pa=i.ab.mat4.create(),Jh=(p,r,l,m,w,T,I,N,G,X,Z,J,Q,ae,ye,fe,be,_e)=>{const Ce=r.style.light,ze=Ce.properties.get("position"),De=[ze.x,ze.y,ze.z],$e=i.ab.mat3.create();Ce.properties.get("anchor")==="viewport"&&(i.ab.mat3.fromRotation($e,-r.transform.angle),i.ab.vec3.transformMat3(De,De,$e));const je=Ce.properties.get("color"),Ve=r.transform,Ue={u_matrix:p,u_lightpos:De,u_lightintensity:Ce.properties.get("intensity"),u_lightcolor:[je.r,je.g,je.b],u_vertical_gradient:+l,u_opacity:m,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:pa,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:Kh[X],u_base_type:Kh[Z],u_ao:w,u_edge_radius:T,u_width_scale:I,u_flood_light_color:ye,u_vertical_scale:fe,u_flood_light_intensity:be,u_ground_shadow_factor:_e};return Ve.projection.name==="globe"&&(Ue.u_tile_id=[N.canonical.x,N.canonical.y,1<<N.canonical.z],Ue.u_zoom_transition=J,Ue.u_inv_rot_matrix=ae,Ue.u_merc_center=Q,Ue.u_up_dir=Ve.projection.upVector(new i.bT(0,0,0),Q[0]*i.ag,Q[1]*i.ag),Ue.u_height_lift=G),Ue},Lu=(p,r,l,m,w,T)=>({u_matrix:p,u_edge_radius:r,u_width_scale:l,u_vertical_scale:m,u_height_type:Kh[w],u_base_type:Kh[T]}),Qh=(p,r,l,m,w,T,I,N,G,X,Z,J,Q,ae,ye,fe,be)=>{const _e=Jh(p,r,l,m,w,T,I,N,X,Z,J,Q,ae,ye,fe,be,1,[0,0,0]),Ce={u_height_factor:-Math.pow(2,N.overscaledZ)/G.tileSize/8};return i.l(_e,mp(r,G),Ce)},ah=(p,r)=>({u_matrix:p,u_emissive_strength:r}),hu=(p,r,l,m)=>i.l(ah(p,r),mp(l,m)),pc=(p,r,l)=>({u_matrix:p,u_world:l,u_emissive_strength:r}),Bg=(p,r,l,m,w)=>i.l(hu(p,r,l,m),{u_world:w}),Fg=(p,r,l,m)=>{const w=i.ag/l.tileSize;return{u_matrix:p,u_camera_to_center_distance:r.getCameraToCenterDistance(m),u_extrude_scale:[r.pixelsToGLUnits[0]/w,r.pixelsToGLUnits[1]/w]}},oh=(p,r,l=1)=>({u_matrix:p,u_color:r.toRenderColor(null),u_overlay:0,u_overlay_scale:l}),nd=i.ab.mat4.create(),In=(p,r,l,m,w,T,I)=>{const N=p.transform,G=N.projection.name==="globe",X=G?i.cN(N.zoom,r.canonical)*N._pixelsPerMercatorPixel:i.ar(l,1,T),Z={u_matrix:r.projMatrix,u_extrude_scale:X,u_intensity:I,u_inv_rot_matrix:nd,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(G){Z.u_inv_rot_matrix=m,Z.u_merc_center=w,Z.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],Z.u_zoom_transition=i.ae(N.zoom);const J=w[0]*i.ag,Q=w[1]*i.ag;Z.u_up_dir=N.projection.upVector(new i.bT(0,0,0),J,Q)}return Z};function rd(p,[r,l,m,w],[T,I]){if(T===I)return[0,0,0,0];const N=255*(p-1)/(p*(I-T));return[r*N,l*N,m*N,w*N]}function ef(p,r,[l,m]){return l===m?0:.5/p+(r-l)*(p-1)/(p*(m-l))}const zu=(p,r,l,m,w,T,I,N,G,X,Z,J,Q,ae,ye,fe,be,_e,Ce,ze,De)=>({u_matrix:p,u_normalize_matrix:r,u_globe_matrix:l,u_merc_matrix:m,u_grid_matrix:w,u_tl_parent:T,u_scale_parent:X,u_fade_t:Z.mix,u_opacity:Z.opacity*J.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:J.paint.get("raster-brightness-min"),u_brightness_high:J.paint.get("raster-brightness-max"),u_saturation_factor:i.cO(J.paint.get("raster-saturation")),u_contrast_factor:i.cP(J.paint.get("raster-contrast")),u_spin_weights:Ss(J.paint.get("raster-hue-rotate")),u_perspective_transform:Q,u_raster_elevation:ae,u_zoom_transition:I,u_merc_center:N,u_cutoff_params:G,u_colorization_mix:rd(i.cQ,fe,_e),u_colorization_offset:ef(i.cQ,be,_e),u_color_ramp:ye,u_texture_offset:[ze/(Ce+2*ze),Ce/(Ce+2*ze)],u_texture_res:[Ce+2*ze,Ce+2*ze],u_emissive_strength:De});function Ss(p){p*=Math.PI/180;const r=Math.sin(p),l=Math.cos(p);return[(2*l+1)/3,(-Math.sqrt(3)*r-l+1)/3,(Math.sqrt(3)*r-l+1)/3]}const dn=.05,Ni=(p,r,l,m,w,T,I,N,G,X,Z,J)=>({u_matrix:p,u_normalize_matrix:r,u_globe_matrix:l,u_merc_matrix:m,u_grid_matrix:w,u_tl_parent:T,u_scale_parent:X,u_fade_t:Z.mix,u_opacity:Z.opacity,u_image0:0,u_image1:1,u_raster_elevation:J,u_zoom_transition:I,u_merc_center:N,u_cutoff_params:G}),Ka=(p,r,l,m,w,T,I,N,G,X)=>({u_particle_texture:p,u_particle_texture_side_len:r,u_tile_offset:l,u_velocity:m,u_color_ramp:T,u_velocity_res:w,u_max_speed:I,u_uv_offset:N,u_data_scale:[255*G[0],255*G[1]],u_data_offset:X,u_particle_pos_scale:1.1,u_particle_pos_offset:[dn,dn]}),gp=(p,r,l,m,w,T,I,N,G,X)=>({u_particle_texture:p,u_particle_texture_side_len:r,u_velocity:l,u_velocity_res:m,u_max_speed:w,u_speed_factor:T,u_reset_rate:I,u_rand_seed:Math.random(),u_uv_offset:N,u_data_scale:[255*G[0],255*G[1]],u_data_offset:X,u_particle_pos_scale:1.1,u_particle_pos_offset:[dn,dn]}),Nu=i.ab.mat4.create(),Bu=(p,r,l,m,w,T,I,N,G,X,Z,J,Q,ae,ye,fe,be,_e,Ce,ze,De,$e)=>{const je=w.transform,Ve={u_is_size_zoom_constant:+(p==="constant"||p==="source"),u_is_size_feature_constant:+(p==="constant"||p==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:je.getCameraToCenterDistance(Ce),u_rotate_symbol:+l,u_aspect_ratio:je.width/je.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:T,u_label_plane_matrix:I,u_coord_matrix:N,u_is_text:+X,u_elevation_from_sea:G?1:0,u_pitch_with_map:+m,u_texsize:Z,u_texsize_icon:J,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Nu,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Nu,u_up_vector:[0,-1,0],u_color_adj_mat:ze,u_icon_transition:De||0,u_gamma_scale:m?w.transform.getCameraToCenterDistance(Ce)*Math.cos(w.terrain?0:w.transform._pitch):1,u_device_pixel_ratio:i.q.devicePixelRatio,u_is_halo:1,u_scale_factor:$e||1};return Ce.name==="globe"&&(Ve.u_tile_id=[ae.canonical.x,ae.canonical.y,1<<ae.canonical.z],Ve.u_zoom_transition=ye,Ve.u_inv_rot_matrix=be,Ve.u_merc_center=fe,Ve.u_camera_forward=je._camera.forward(),Ve.u_ecef_origin=i.cR(je.globeMatrix,ae.toUnwrapped()),Ve.u_tile_matrix=Float32Array.from(je.globeMatrix),Ve.u_up_vector=_e),Ve},tf=(p,r,l,m)=>({u_matrix:p,u_emissive_strength:r,u_opacity:l,u_color:m}),nf=(p,r,l,m,w,T,I,N,G)=>i.l(function(X,Z,J,Q,ae,ye){const{width:fe,height:be}=Q.imageManager.getPixelSize(Z),_e=Math.pow(2,ye.tileID.overscaledZ),Ce=ye.tileSize*Math.pow(2,Q.transform.tileZoom)/_e,ze=Ce*(ye.tileID.canonical.x+ye.tileID.wrap*_e),De=Ce*ye.tileID.canonical.y;return{u_image:0,u_pattern_tl:J.tl,u_pattern_br:J.br,u_texsize:[fe,be],u_pattern_size:J.displaySize,u_pattern_units_to_pixels:ae?[Q.transform.width,-1*Q.transform.height]:[1/i.ar(ye,1,Q.transform.tileZoom),1/i.ar(ye,1,Q.transform.tileZoom)],u_pixel_coord_upper:[ze>>16,De>>16],u_pixel_coord_lower:[65535&ze,65535&De]}}(0,T,I,m,N,G),{u_matrix:p,u_emissive_strength:r,u_opacity:l}),mc=new Float32Array(i.ab.mat4.identity([])),id=(p,r,l,m,w,T,I,N,G,X,Z,J,Q,ae=[0,0,0],ye)=>{const fe=w.style.light,be=fe.properties.get("position"),_e=[-be.x,-be.y,be.z],Ce=i.ab.mat3.create();fe.properties.get("anchor")==="viewport"&&(i.ab.mat3.fromRotation(Ce,-w.transform.angle),i.ab.vec3.transformMat3(_e,_e,Ce));const ze=Z.alphaMode==="MASK",De=fe.properties.get("color").toRenderColor(null),$e=Q.paint.get("model-ambient-occlusion-intensity"),je=Q.paint.get("model-color").constantOr(i.aj.white).toRenderColor(null),Ve=Q.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:p,u_lighting_matrix:r,u_normal_matrix:l,u_node_matrix:m||mc,u_lightpos:_e,u_lightintensity:fe.properties.get("intensity"),u_lightcolor:[De.r,De.g,De.b],u_camera_pos:ae,u_opacity:T,u_baseTextureIsAlpha:0,u_alphaMask:+ze,u_alphaCutoff:Z.alphaCutoff,u_baseColorFactor:[I.r,I.g,I.b,I.a],u_emissiveFactor:[N[0],N[1],N[2],1],u_metallicFactor:G,u_roughnessFactor:X,u_baseColorTexture:Ma.BaseColor,u_metallicRoughnessTexture:Ma.MetallicRoughness,u_normalTexture:Ma.Normal,u_occlusionTexture:Ma.Occlusion,u_emissionTexture:Ma.Emission,u_lutTexture:Ma.LUT,u_color_mix:[je.r,je.g,je.b,Ve],u_aoIntensity:$e,u_emissive_strength:J,u_occlusionTextureTransform:ye||[0,0,0,0]}},ma=(p,r=mc,l=mc)=>({u_matrix:p,u_instance:r,u_node_matrix:l}),ad={fillExtrusion:p=>({u_matrix:new i.bJ(p),u_lightpos:new i.bL(p),u_lightintensity:new i.bM(p),u_lightcolor:new i.bL(p),u_vertical_gradient:new i.bM(p),u_opacity:new i.bM(p),u_edge_radius:new i.bM(p),u_width_scale:new i.bM(p),u_ao:new i.bK(p),u_height_type:new i.bN(p),u_base_type:new i.bN(p),u_tile_id:new i.bL(p),u_zoom_transition:new i.bM(p),u_inv_rot_matrix:new i.bJ(p),u_merc_center:new i.bK(p),u_up_dir:new i.bL(p),u_height_lift:new i.bM(p),u_flood_light_color:new i.bL(p),u_vertical_scale:new i.bM(p),u_flood_light_intensity:new i.bM(p),u_ground_shadow_factor:new i.bL(p)}),fillExtrusionDepth:p=>({u_matrix:new i.bJ(p),u_edge_radius:new i.bM(p),u_width_scale:new i.bM(p),u_vertical_scale:new i.bM(p),u_height_type:new i.bN(p),u_base_type:new i.bN(p)}),fillExtrusionPattern:p=>({u_matrix:new i.bJ(p),u_lightpos:new i.bL(p),u_lightintensity:new i.bM(p),u_lightcolor:new i.bL(p),u_vertical_gradient:new i.bM(p),u_height_factor:new i.bM(p),u_edge_radius:new i.bM(p),u_width_scale:new i.bM(p),u_ao:new i.bK(p),u_height_type:new i.bN(p),u_base_type:new i.bN(p),u_tile_id:new i.bL(p),u_zoom_transition:new i.bM(p),u_inv_rot_matrix:new i.bJ(p),u_merc_center:new i.bK(p),u_up_dir:new i.bL(p),u_height_lift:new i.bM(p),u_image:new i.bN(p),u_texsize:new i.bK(p),u_pixel_coord_upper:new i.bK(p),u_pixel_coord_lower:new i.bK(p),u_tile_units_to_pixels:new i.bM(p),u_opacity:new i.bM(p)}),fillExtrusionGroundEffect:p=>({u_matrix:new i.bJ(p),u_opacity:new i.bM(p),u_ao_pass:new i.bM(p),u_meter_to_tile:new i.bM(p),u_ao:new i.bK(p),u_flood_light_intensity:new i.bM(p),u_flood_light_color:new i.bL(p),u_attenuation:new i.bM(p),u_edge_radius:new i.bM(p),u_fb:new i.bN(p),u_fb_size:new i.bM(p),u_dynamic_offset:new i.bM(p)}),fill:p=>({u_matrix:new i.bJ(p),u_emissive_strength:new i.bM(p)}),fillPattern:p=>({u_matrix:new i.bJ(p),u_emissive_strength:new i.bM(p),u_image:new i.bN(p),u_texsize:new i.bK(p),u_pixel_coord_upper:new i.bK(p),u_pixel_coord_lower:new i.bK(p),u_tile_units_to_pixels:new i.bM(p)}),fillOutline:p=>({u_matrix:new i.bJ(p),u_emissive_strength:new i.bM(p),u_world:new i.bK(p)}),fillOutlinePattern:p=>({u_matrix:new i.bJ(p),u_emissive_strength:new i.bM(p),u_world:new i.bK(p),u_image:new i.bN(p),u_texsize:new i.bK(p),u_pixel_coord_upper:new i.bK(p),u_pixel_coord_lower:new i.bK(p),u_tile_units_to_pixels:new i.bM(p)}),circle:i.cS,collisionBox:p=>({u_matrix:new i.bJ(p),u_camera_to_center_distance:new i.bM(p),u_extrude_scale:new i.bK(p)}),collisionCircle:p=>({u_matrix:new i.bJ(p),u_inv_matrix:new i.bJ(p),u_camera_to_center_distance:new i.bM(p),u_viewport_size:new i.bK(p)}),debug:p=>({u_color:new i.cz(p),u_matrix:new i.bJ(p),u_overlay:new i.bN(p),u_overlay_scale:new i.bM(p)}),clippingMask:p=>({u_matrix:new i.bJ(p)}),heatmap:p=>({u_extrude_scale:new i.bM(p),u_intensity:new i.bM(p),u_matrix:new i.bJ(p),u_inv_rot_matrix:new i.bJ(p),u_merc_center:new i.bK(p),u_tile_id:new i.bL(p),u_zoom_transition:new i.bM(p),u_up_dir:new i.bL(p)}),heatmapTexture:p=>({u_image:new i.bN(p),u_color_ramp:new i.bN(p),u_opacity:new i.bM(p)}),hillshade:p=>({u_matrix:new i.bJ(p),u_image:new i.bN(p),u_latrange:new i.bK(p),u_light:new i.bK(p),u_shadow:new i.cz(p),u_highlight:new i.cz(p),u_emissive_strength:new i.bM(p),u_accent:new i.cz(p)}),hillshadePrepare:p=>({u_matrix:new i.bJ(p),u_image:new i.bN(p),u_dimension:new i.bK(p),u_zoom:new i.bM(p)}),line:i.cT,linePattern:i.cU,raster:p=>({u_matrix:new i.bJ(p),u_normalize_matrix:new i.bJ(p),u_globe_matrix:new i.bJ(p),u_merc_matrix:new i.bJ(p),u_grid_matrix:new i.cA(p),u_tl_parent:new i.bK(p),u_scale_parent:new i.bM(p),u_fade_t:new i.bM(p),u_opacity:new i.bM(p),u_image0:new i.bN(p),u_image1:new i.bN(p),u_brightness_low:new i.bM(p),u_brightness_high:new i.bM(p),u_saturation_factor:new i.bM(p),u_contrast_factor:new i.bM(p),u_spin_weights:new i.bL(p),u_perspective_transform:new i.bK(p),u_raster_elevation:new i.bM(p),u_zoom_transition:new i.bM(p),u_merc_center:new i.bK(p),u_cutoff_params:new i.ca(p),u_colorization_mix:new i.ca(p),u_colorization_offset:new i.bM(p),u_color_ramp:new i.bN(p),u_texture_offset:new i.bK(p),u_texture_res:new i.bK(p),u_emissive_strength:new i.bM(p)}),rasterParticle:p=>({u_matrix:new i.bJ(p),u_normalize_matrix:new i.bJ(p),u_globe_matrix:new i.bJ(p),u_merc_matrix:new i.bJ(p),u_grid_matrix:new i.cA(p),u_tl_parent:new i.bK(p),u_scale_parent:new i.bM(p),u_fade_t:new i.bM(p),u_opacity:new i.bM(p),u_image0:new i.bN(p),u_image1:new i.bN(p),u_raster_elevation:new i.bM(p),u_zoom_transition:new i.bM(p),u_merc_center:new i.bK(p),u_cutoff_params:new i.ca(p)}),rasterParticleTexture:p=>({u_texture:new i.bN(p),u_opacity:new i.bM(p)}),rasterParticleDraw:p=>({u_particle_texture:new i.bN(p),u_particle_texture_side_len:new i.bM(p),u_tile_offset:new i.bK(p),u_velocity:new i.bN(p),u_color_ramp:new i.bN(p),u_velocity_res:new i.bK(p),u_max_speed:new i.bM(p),u_uv_offset:new i.bK(p),u_data_scale:new i.bK(p),u_data_offset:new i.bM(p),u_particle_pos_scale:new i.bM(p),u_particle_pos_offset:new i.bK(p)}),rasterParticleUpdate:p=>({u_particle_texture:new i.bN(p),u_particle_texture_side_len:new i.bM(p),u_velocity:new i.bN(p),u_velocity_res:new i.bK(p),u_max_speed:new i.bM(p),u_speed_factor:new i.bM(p),u_reset_rate:new i.bM(p),u_rand_seed:new i.bM(p),u_uv_offset:new i.bK(p),u_data_scale:new i.bK(p),u_data_offset:new i.bM(p),u_particle_pos_scale:new i.bM(p),u_particle_pos_offset:new i.bK(p)}),symbol:p=>({u_is_size_zoom_constant:new i.bN(p),u_is_size_feature_constant:new i.bN(p),u_size_t:new i.bM(p),u_size:new i.bM(p),u_camera_to_center_distance:new i.bM(p),u_rotate_symbol:new i.bN(p),u_aspect_ratio:new i.bM(p),u_fade_change:new i.bM(p),u_matrix:new i.bJ(p),u_label_plane_matrix:new i.bJ(p),u_coord_matrix:new i.bJ(p),u_is_text:new i.bN(p),u_elevation_from_sea:new i.bN(p),u_pitch_with_map:new i.bN(p),u_texsize:new i.bK(p),u_texsize_icon:new i.bK(p),u_texture:new i.bN(p),u_texture_icon:new i.bN(p),u_gamma_scale:new i.bM(p),u_device_pixel_ratio:new i.bM(p),u_tile_id:new i.bL(p),u_zoom_transition:new i.bM(p),u_inv_rot_matrix:new i.bJ(p),u_merc_center:new i.bK(p),u_camera_forward:new i.bL(p),u_tile_matrix:new i.bJ(p),u_up_vector:new i.bL(p),u_ecef_origin:new i.bL(p),u_is_halo:new i.bN(p),u_icon_transition:new i.bM(p),u_color_adj_mat:new i.bJ(p),u_scale_factor:new i.bM(p)}),background:p=>({u_matrix:new i.bJ(p),u_emissive_strength:new i.bM(p),u_opacity:new i.bM(p),u_color:new i.cz(p)}),backgroundPattern:p=>({u_matrix:new i.bJ(p),u_emissive_strength:new i.bM(p),u_opacity:new i.bM(p),u_image:new i.bN(p),u_pattern_tl:new i.bK(p),u_pattern_br:new i.bK(p),u_texsize:new i.bK(p),u_pattern_size:new i.bK(p),u_pixel_coord_upper:new i.bK(p),u_pixel_coord_lower:new i.bK(p),u_pattern_units_to_pixels:new i.bK(p)}),terrainRaster:p=>({u_matrix:new i.bJ(p),u_image0:new i.bN(p),u_skirt_height:new i.bM(p),u_ground_shadow_factor:new i.bL(p)}),skybox:p=>({u_matrix:new i.bJ(p),u_sun_direction:new i.bL(p),u_cubemap:new i.bN(p),u_opacity:new i.bM(p),u_temporal_offset:new i.bM(p)}),skyboxGradient:p=>({u_matrix:new i.bJ(p),u_color_ramp:new i.bN(p),u_center_direction:new i.bL(p),u_radius:new i.bM(p),u_opacity:new i.bM(p),u_temporal_offset:new i.bM(p)}),skyboxCapture:p=>({u_matrix_3f:new i.cA(p),u_sun_direction:new i.bL(p),u_sun_intensity:new i.bM(p),u_color_tint_r:new i.ca(p),u_color_tint_m:new i.ca(p),u_luminance:new i.bM(p)}),globeRaster:p=>({u_proj_matrix:new i.bJ(p),u_globe_matrix:new i.bJ(p),u_normalize_matrix:new i.bJ(p),u_merc_matrix:new i.bJ(p),u_zoom_transition:new i.bM(p),u_merc_center:new i.bK(p),u_image0:new i.bN(p),u_grid_matrix:new i.cA(p),u_skirt_height:new i.bM(p),u_far_z_cutoff:new i.bM(p),u_frustum_tl:new i.bL(p),u_frustum_tr:new i.bL(p),u_frustum_br:new i.bL(p),u_frustum_bl:new i.bL(p),u_globe_pos:new i.bL(p),u_globe_radius:new i.bM(p),u_viewport:new i.bK(p)}),globeAtmosphere:p=>({u_frustum_tl:new i.bL(p),u_frustum_tr:new i.bL(p),u_frustum_br:new i.bL(p),u_frustum_bl:new i.bL(p),u_horizon:new i.bM(p),u_transition:new i.bM(p),u_fadeout_range:new i.bM(p),u_color:new i.ca(p),u_high_color:new i.ca(p),u_space_color:new i.ca(p),u_temporal_offset:new i.bM(p),u_horizon_angle:new i.bM(p)}),model:p=>({u_matrix:new i.bJ(p),u_lighting_matrix:new i.bJ(p),u_normal_matrix:new i.bJ(p),u_node_matrix:new i.bJ(p),u_lightpos:new i.bL(p),u_lightintensity:new i.bM(p),u_lightcolor:new i.bL(p),u_camera_pos:new i.bL(p),u_opacity:new i.bM(p),u_baseColorFactor:new i.ca(p),u_emissiveFactor:new i.ca(p),u_metallicFactor:new i.bM(p),u_roughnessFactor:new i.bM(p),u_baseTextureIsAlpha:new i.bN(p),u_alphaMask:new i.bN(p),u_alphaCutoff:new i.bM(p),u_baseColorTexture:new i.bN(p),u_metallicRoughnessTexture:new i.bN(p),u_normalTexture:new i.bN(p),u_occlusionTexture:new i.bN(p),u_emissionTexture:new i.bN(p),u_lutTexture:new i.bN(p),u_color_mix:new i.ca(p),u_aoIntensity:new i.bM(p),u_emissive_strength:new i.bM(p),u_occlusionTextureTransform:new i.ca(p)}),modelDepth:p=>({u_matrix:new i.bJ(p),u_instance:new i.bJ(p),u_node_matrix:new i.bJ(p)}),groundShadow:p=>({u_matrix:new i.bJ(p),u_ground_shadow_factor:new i.bL(p)}),stars:p=>({u_matrix:new i.bJ(p),u_up:new i.bL(p),u_right:new i.bL(p),u_intensity_multiplier:new i.bM(p)}),snowParticle:p=>({u_modelview:new i.bJ(p),u_projection:new i.bJ(p),u_time:new i.bM(p),u_cam_pos:new i.bL(p),u_velocityConeAperture:new i.bM(p),u_velocity:new i.bM(p),u_horizontalOscillationRadius:new i.bM(p),u_horizontalOscillationRate:new i.bM(p),u_boxSize:new i.bM(p),u_billboardSize:new i.bM(p),u_simpleShapeParameters:new i.bK(p),u_screenSize:new i.bK(p),u_thinningCenterPos:new i.bK(p),u_thinningShape:new i.bL(p),u_thinningAffectedRatio:new i.bM(p),u_thinningParticleOffset:new i.bM(p),u_particleColor:new i.ca(p),u_direction:new i.bL(p)}),rainParticle:p=>({u_modelview:new i.bJ(p),u_projection:new i.bJ(p),u_time:new i.bM(p),u_cam_pos:new i.bL(p),u_texScreen:new i.bN(p),u_velocityConeAperture:new i.bM(p),u_velocity:new i.bM(p),u_boxSize:new i.bM(p),u_rainDropletSize:new i.bK(p),u_distortionStrength:new i.bM(p),u_rainDirection:new i.bL(p),u_color:new i.ca(p),u_screenSize:new i.bK(p),u_thinningCenterPos:new i.bK(p),u_thinningShape:new i.bL(p),u_thinningAffectedRatio:new i.bM(p),u_thinningParticleOffset:new i.bM(p),u_shapeDirectionalPower:new i.bM(p),u_shapeNormalPower:new i.bM(p),u_mode:new i.bM(p)}),vignette:p=>({u_vignetteShape:new i.bL(p),u_vignetteColor:new i.ca(p)}),occlusion:p=>({u_matrix:new i.bJ(p),u_anchorPos:new i.bL(p),u_screenSizePx:new i.bK(p),u_occluderSizePx:new i.bK(p),u_color:new i.ca(p)})};class ul{constructor(r,l,m,w){this.id=ul.uniqueIdxCounter,ul.uniqueIdxCounter++,this.context=r;const T=r.gl;this.buffer=T.createBuffer(),this.dynamicDraw=!!m,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),T.bufferData(T.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||w||l.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){this.id=ul.uniqueIdxCounter,ul.uniqueIdxCounter++;const l=this.context.gl;this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}ul.uniqueIdxCounter=0;const Qo={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Fu{constructor(r,l,m,w,T,I){this.length=l.length,this.attributes=m,this.itemSize=l.bytesPerElement,this.dynamicDraw=w,this.instanceCount=I,this.context=r;const N=r.gl;this.buffer=N.createBuffer(),r.bindVertexBuffer.set(this.buffer),N.bufferData(N.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?N.DYNAMIC_DRAW:N.STATIC_DRAW),this.dynamicDraw||T||l.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const l=this.context.gl;this.bind(),l.bufferSubData(l.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,l){for(let m=0;m<this.attributes.length;m++){const w=l.attributes[this.attributes[m].name];w!==void 0&&r.enableVertexAttribArray(w)}}setVertexAttribPointers(r,l,m){for(let w=0;w<this.attributes.length;w++){const T=this.attributes[w],I=l.attributes[T.name];I!==void 0&&r.vertexAttribPointer(I,T.components,r[Qo[T.type]],!1,this.itemSize,T.offset+this.itemSize*(m||0))}}setVertexAttribDivisor(r,l,m){for(let w=0;w<this.attributes.length;w++){const T=l.attributes[this.attributes[w].name];T!==void 0&&this.instanceCount&&this.instanceCount>0&&r.vertexAttribDivisor(T,m)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class _m{constructor(r,l,m,w,T){this.context=r,this.width=l,this.height=m;const I=this.framebuffer=r.gl.createFramebuffer();w&&(this.colorAttachment=new ku(r,I)),T&&(this.depthAttachmentType=T,this.depthAttachment=T==="renderbuffer"?new rh(r,I):new ed(r,I))}destroy(){const r=this.context.gl;if(this.colorAttachment){const l=this.colorAttachment.get();l&&r.deleteTexture(l)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const l=this.depthAttachment.get();l&&r.deleteRenderbuffer(l)}else{const l=this.depthAttachment.get();l&&r.deleteTexture(l)}r.deleteFramebuffer(this.framebuffer)}}class od{constructor(r,l){this.gl=r,this.clearColor=new $h(this),this.clearDepth=new vs(this),this.clearStencil=new xs(this),this.colorMask=new Ru(this),this.depthMask=new su(this),this.stencilMask=new lu(this),this.stencilFunc=new th(this),this.stencilOp=new Hh(this),this.stencilTest=new nh(this),this.depthRange=new op(this),this.depthTest=new Xi(this),this.depthFunc=new ao(this),this.blend=new yi(this),this.blendFunc=new bs(this),this.blendColor=new sl(this),this.blendEquation=new Jf(this),this.cullFace=new uu(this),this.cullFaceSide=new sp(this),this.frontFace=new lp(this),this.program=new cc(this),this.activeTexture=new Xh(this),this.viewport=new Yh(this),this.bindFramebuffer=new cu(this),this.bindRenderbuffer=new Dg(this),this.bindTexture=new gm(this),this.bindVertexBuffer=new Lg(this),this.bindElementBuffer=new up(this),this.bindVertexArrayOES=new zg(this),this.pixelStoreUnpack=new Qf(this),this.pixelStoreUnpackPremultiplyAlpha=new cp(this),this.pixelStoreUnpackFlipY=new hc(this),this.options=l?Object.assign({},l):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=r.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=r.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=r.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=l&&!!l.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=r.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),this.maxPointSize=r.getParameter(r.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,l,m){return new ul(this,r,l,m)}createVertexBuffer(r,l,m,w,T){return new Fu(this,r,l,m,w,T)}createRenderbuffer(r,l,m){const w=this.gl,T=w.createRenderbuffer();return this.bindRenderbuffer.set(T),w.renderbufferStorage(w.RENDERBUFFER,r,l,m),this.bindRenderbuffer.set(null),T}createFramebuffer(r,l,m,w){return new _m(this,r,l,m,w)}clear({color:r,depth:l,stencil:m,colorMask:w}){const T=this.gl;let I=0;r&&(I|=T.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set(w||[!0,!0,!0,!0])),l!==void 0&&(I|=T.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),m!==void 0&&(I|=T.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255)),T.clear(I)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){i.bn(r.blendFunction,vr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor),r.blendEquation?this.blendEquation.set(r.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(r.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let gc;function rf(p,r,l,m,w,T,I){const N=p.context,G=N.gl,X=p.transform,Z=p.getOrCreateProgram("collisionBox"),J=[];let Q=0,ae=0;for(let De=0;De<m.length;De++){const $e=m[De],je=r.getTile($e),Ve=je.getBucket(l);if(!Ve)continue;const Ue=Fs($e,Ve,X);let Qe=Ue;w[0]===0&&w[1]===0||(Qe=p.translatePosMatrix(Ue,je,w,T));const at=I?Ve.textCollisionBox:Ve.iconCollisionBox,St=Ve.collisionCircleArray;if(St.length>0){const yt=i.ab.mat4.create(),jt=Qe;i.ab.mat4.mul(yt,Ve.placementInvProjMatrix,X.glCoordMatrix),i.ab.mat4.mul(yt,yt,Ve.placementViewportMatrix),J.push({circleArray:St,circleOffset:ae,transform:jt,invTransform:yt,projection:Ve.getProjection()}),Q+=St.length/4,ae=Q}at&&(p.terrain&&p.terrain.setupElevationDraw(je,Z),Z.draw(p,G.LINES,qn.disabled,Qn.disabled,p.colorModeForRenderPass(),Wn.disabled,Fg(Qe,X,je,Ve.getProjection()),l.id,at.layoutVertexBuffer,at.indexBuffer,at.segments,null,X.zoom,null,[at.collisionVertexBuffer,at.collisionVertexBufferExt]))}if(!I||!J.length)return;const ye=p.getOrCreateProgram("collisionCircle"),fe=new i.cV;fe.resize(4*Q),fe._trim();let be=0;for(const De of J)for(let $e=0;$e<De.circleArray.length/4;$e++){const je=4*$e,Ve=De.circleArray[je+0],Ue=De.circleArray[je+1],Qe=De.circleArray[je+2],at=De.circleArray[je+3];fe.emplace(be++,Ve,Ue,Qe,at,0),fe.emplace(be++,Ve,Ue,Qe,at,1),fe.emplace(be++,Ve,Ue,Qe,at,2),fe.emplace(be++,Ve,Ue,Qe,at,3)}(!gc||gc.length<2*Q)&&(gc=function(De){const $e=2*De,je=new i.aU;je.resize($e),je._trim();for(let Ve=0;Ve<$e;Ve++){const Ue=6*Ve;je.uint16[Ue+0]=4*Ve+0,je.uint16[Ue+1]=4*Ve+1,je.uint16[Ue+2]=4*Ve+2,je.uint16[Ue+3]=4*Ve+2,je.uint16[Ue+4]=4*Ve+3,je.uint16[Ue+5]=4*Ve+0}return je}(Q));const _e=N.createIndexBuffer(gc,!0),Ce=N.createVertexBuffer(fe,i.cW.members,!0);for(const De of J){const $e={u_matrix:De.transform,u_inv_matrix:De.invTransform,u_camera_to_center_distance:(ze=X).getCameraToCenterDistance(De.projection),u_viewport_size:[ze.width,ze.height]};ye.draw(p,G.TRIANGLES,qn.disabled,Qn.disabled,p.colorModeForRenderPass(),Wn.disabled,$e,l.id,Ce,_e,i.b7.simpleSegment(0,2*De.circleOffset,De.circleArray.length,De.circleArray.length/2),null,X.zoom)}var ze;Ce.destroy(),_e.destroy()}const yo=i.ab.mat4.create();function Ii(p){const r=p._camera.getWorldToCamera(p.worldSize,1),l=i.ab.mat4.multiply([],r,p.globeMatrix);i.ab.mat4.invert(l,l);const m=[0,0,0],w=[0,1,0,0];return i.ab.vec4.transformMat4(w,w,l),m[0]=w[0],m[1]=w[1],m[2]=w[2],i.ab.vec3.normalize(m,m),m}function ci({width:p,height:r,anchor:l,textOffset:m,textScale:w},T){const{horizontalAlign:I,verticalAlign:N}=i.bD(l),G=-(I-.5)*p,X=-(N-.5)*r,Z=i.bC(l,m);return new i.P((G/w+Z[0])*T,(X/w+Z[1])*T)}function yc(p,r,l,m,w,T,I,N,G,X,Z){const J=p.text.placedSymbolArray,Q=p.text.dynamicLayoutVertexArray,ae=p.icon.dynamicLayoutVertexArray,ye={},fe=p.getProjection(),be=eu(N,fe,T),_e=T.elevation,Ce=fe.upVectorScale(N.canonical,T.center.lat,T.worldSize).metersToTile;Q.clear();for(let ze=0;ze<J.length;ze++){const De=J.get(ze),{tileAnchorX:$e,tileAnchorY:je,numGlyphs:Ve}=De,Ue=De.hidden||!De.crossTileID||p.allowVerticalPlacement&&!De.placedOrientation?null:m[De.crossTileID];if(Ue){let Qe=0,at=0,St=0;if(_e){const Mt=_e?_e.getAtTileOffset(N,$e,je):0,[ln,Yt,Ut]=fe.upVector(N.canonical,$e,je);Qe=Mt*ln*Ce,at=Mt*Yt*Ce,St=Mt*Ut*Ce}let[yt,jt,It,ft]=Ea(De.projectedAnchorX+Qe,De.projectedAnchorY+at,De.projectedAnchorZ+St,l?be:I);const At=zh(T.getCameraToCenterDistance(fe),ft);let Qt=w.evaluateSizeForFeature(p.textSizeData,X,De)*At/i.bw;l&&(Qt*=p.tilePixelRatio/G);const ht=ci(Ue,Qt);l?({x:yt,y:jt,z:It}=fe.projectTilePoint($e+ht.x,je+ht.y,N.canonical),[yt,jt,It]=Ea(yt+Qe,jt+at,It+St,I)):(r&&ht._rotate(-T.angle),yt+=ht.x,jt+=ht.y,It=0);const zt=p.allowVerticalPlacement&&De.placedOrientation===i.bq.vertical?Math.PI/2:0;for(let Mt=0;Mt<Ve;Mt++)i.bt(Q,yt,jt,It,zt);Z&&De.associatedIconIndex>=0&&(ye[De.associatedIconIndex]={x:yt,y:jt,z:It,angle:zt})}else Oi(Ve,Q)}if(Z){ae.clear();const ze=p.icon.placedSymbolArray;for(let De=0;De<ze.length;De++){const $e=ze.get(De),{numGlyphs:je}=$e,Ve=ye[De];if($e.hidden||!Ve)Oi(je,ae);else{const{x:Ue,y:Qe,z:at,angle:St}=Ve;for(let yt=0;yt<je;yt++)i.bt(ae,Ue,Qe,at,St)}}p.icon.dynamicLayoutVertexBuffer.updateData(ae)}p.text.dynamicLayoutVertexBuffer.updateData(Q)}function _c(p,r,l,m,w,T,I={}){const N=l.paint.get("icon-translate"),G=l.paint.get("text-translate"),X=l.paint.get("icon-translate-anchor"),Z=l.paint.get("text-translate-anchor"),J=l.layout.get("icon-rotation-alignment"),Q=l.layout.get("text-rotation-alignment"),ae=l.layout.get("icon-pitch-alignment"),ye=l.layout.get("text-pitch-alignment"),fe=l.layout.get("icon-keep-upright"),be=l.layout.get("text-keep-upright"),_e=l.paint.get("icon-color-saturation"),Ce=l.paint.get("icon-color-contrast"),ze=l.paint.get("icon-color-brightness-min"),De=l.paint.get("icon-color-brightness-max"),$e=l.layout.get("symbol-elevation-reference")==="sea",je=p.context,Ve=je.gl,Ue=p.transform,Qe=J==="map",at=Q==="map",St=ae==="map",yt=ye==="map",jt=l.layout.get("symbol-sort-key").constantOr(1)!==void 0;let It=!1;const ft=p.depthModeForSublayer(0,qn.ReadOnly),At=[i.at(Ue.center.lng),i.aA(Ue.center.lat)],Qt=l.layout.get("text-variable-anchor"),ht=Ue.projection.name==="globe",zt=[],Mt=[0,-1,0];for(const ln of m){const Yt=r.getTile(ln),Ut=Yt.getBucket(l);if(!Ut||Ut.projection.name==="mercator"&&ht||Ut.fullyClipped)continue;const tn=Ut.projection.name==="globe",fn=tn?i.ae(Ue.zoom):0,wn=eu(ln,Ut.getProjection(),Ue),Cn=Ue.calculatePixelsToTileUnitsMatrix(Yt),Yn=Qt&&Ut.hasTextData(),Gn=Ut.hasIconTextFit()&&Yn&&Ut.hasIconData(),Un=Ut.getProjection().createInversionMatrix(Ue,ln.canonical),tr=Zn=>{Ue.depthOcclusionForSymbolsAndCircles&&(l.hasInitialOcclusionOpacityProperties||p.terrain)&&(Zn.push("DEPTH_D24"),Zn.push("DEPTH_OCCLUSION"))},nr=()=>{const Zn=Qe&&l.layout.get("symbol-placement")!=="point",Jn=[];tr(Jn);const Ir=Zn||Gn,Ti=l.paint.get("icon-image-cross-fade").constantOr(0);p.terrainRenderModeElevated()&&St&&Jn.push("PITCH_WITH_MAP_TERRAIN"),tn&&(Jn.push("PROJECTION_GLOBE_VIEW"),Ir&&Jn.push("PROJECTED_POS_ON_VIEWPORT")),Ti>0&&Jn.push("ICON_TRANSITION"),Ut.icon.zOffsetVertexBuffer&&Jn.push("Z_OFFSET"),_e===0&&Ce===0&&ze===0&&De===1||Jn.push("COLOR_ADJUSTMENT"),Ut.sdfIcons&&Jn.push("RENDER_SDF");const ki=Ut.icon.programConfigurations.get(l.id),Wi=p.getOrCreateProgram("symbol",{config:ki,defines:Jn}),rs=Yt.imageAtlasTexture?Yt.imageAtlasTexture.size:[0,0],ua=Ut.iconSizeData,zr=i.bp(ua,Ue.zoom),ti=St||Ue.pitch!==0,ei=di(wn,Yt.tileID.canonical,St,Qe,Ue,Ut.getProjection(),Cn),Dr=Ou(wn,Yt.tileID.canonical,St,Qe,Ue,Ut.getProjection(),Cn),fi=p.translatePosMatrix(Dr,Yt,N,X,!0),aa=p.translatePosMatrix(wn,Yt,N,X),ii=Ir?yo:ei,oa=Qe&&!St&&!Zn;let As=Mt;!ht&&!Ue.mercatorFromTransition||Qe||(As=Ii(Ue));const Go=tn?As:Mt,xo=l.getColorAdjustmentMatrix(_e,Ce,ze,De),Ws=Bu(ua.kind,zr,oa,St,p,aa,ii,fi,$e,!1,rs,[0,0],!0,ln,fn,At,Un,Go,Ut.getProjection(),xo,Ti),uo=Yt.imageAtlasTexture?Yt.imageAtlasTexture:null,$o=l.layout.get("icon-size").constantOr(0)!==1||Ut.iconsNeedLinear,Ks=Ut.sdfIcons||p.options.rotating||p.options.zooming||$o||ti?Ve.LINEAR:Ve.NEAREST,Ms=Ut.sdfIcons&&l.paint.get("icon-halo-width").constantOr(1)!==0,$u=p.terrain&&St&&Zn?i.ab.mat4.invert(i.ab.mat4.create(),ei):yo;if(Zn&&Ut.icon){const Cc=Ue.elevation,Pc=Cc?Cc.getAtTileOffsetFunc(ln,Ue.center.lat,Ue.worldSize,Ut.getProjection()):null,wd=ui(wn,Yt.tileID.canonical,St,Qe,Ue,Ut.getProjection(),Cn);Bo(Ut,wn,p,!1,wd,Dr,St,fe,Pc,ln)}return{program:Wi,buffers:Ut.icon,uniformValues:Ws,atlasTexture:uo,atlasTextureIcon:null,atlasInterpolation:Ks,atlasInterpolationIcon:null,isSDF:Ut.sdfIcons,hasHalo:Ms,tile:Yt,labelPlaneMatrixInv:$u}},ri=()=>{const Zn=at&&l.layout.get("symbol-placement")!=="point",Jn=[],Ir=Zn||Qt||Gn;p.terrainRenderModeElevated()&&yt&&Jn.push("PITCH_WITH_MAP_TERRAIN"),tn&&(Jn.push("PROJECTION_GLOBE_VIEW"),Ir&&Jn.push("PROJECTED_POS_ON_VIEWPORT")),Ut.text.zOffsetVertexBuffer&&Jn.push("Z_OFFSET"),Ut.iconsInText&&Jn.push("RENDER_TEXT_AND_SYMBOL"),Jn.push("RENDER_SDF"),tr(Jn);const Ti=Ut.text.programConfigurations.get(l.id),ki=p.getOrCreateProgram("symbol",{config:Ti,defines:Jn});let Wi,rs=[0,0],ua=null;const zr=Ut.textSizeData;Ut.iconsInText&&(rs=Yt.imageAtlasTexture?Yt.imageAtlasTexture.size:[0,0],ua=Yt.imageAtlasTexture?Yt.imageAtlasTexture:null,Wi=yt||Ue.pitch!==0||p.options.rotating||p.options.zooming||zr.kind==="composite"||zr.kind==="camera"?Ve.LINEAR:Ve.NEAREST);const ti=Yt.glyphAtlasTexture?Yt.glyphAtlasTexture.size:[0,0],ei=l.layout.get("text-size-scale-range"),Dr=i.aw(p.scaleFactor,ei[0],ei[1]),fi=i.bp(zr,Ue.zoom,Dr),aa=di(wn,Yt.tileID.canonical,yt,at,Ue,Ut.getProjection(),Cn),ii=Ou(wn,Yt.tileID.canonical,yt,at,Ue,Ut.getProjection(),Cn),oa=p.translatePosMatrix(ii,Yt,G,Z,!0),As=p.translatePosMatrix(wn,Yt,G,Z),Go=Ir?yo:aa,xo=at&&!yt&&!Zn;let Ws=Mt;!ht&&!Ue.mercatorFromTransition||at||(Ws=Ii(Ue));const uo=Bu(zr.kind,fi,xo,yt,p,As,Go,oa,$e,!0,ti,rs,!0,ln,fn,At,Un,tn?Ws:Mt,Ut.getProjection(),null,null,Dr),$o=Yt.glyphAtlasTexture?Yt.glyphAtlasTexture:null,Ks=Ve.LINEAR,Ms=l.paint.get("text-halo-width").constantOr(1)!==0,$u=p.terrain&&yt&&Zn?i.ab.mat4.invert(i.ab.mat4.create(),aa):yo;if(Zn&&Ut.text){const Cc=Ue.elevation,Pc=Cc?Cc.getAtTileOffsetFunc(ln,Ue.center.lat,Ue.worldSize,Ut.getProjection()):null,wd=ui(wn,Yt.tileID.canonical,yt,at,Ue,Ut.getProjection(),Cn);Bo(Ut,wn,p,!0,wd,ii,yt,be,Pc,ln)}return{program:ki,buffers:Ut.text,uniformValues:uo,atlasTexture:$o,atlasTextureIcon:ua,atlasInterpolation:Ks,atlasInterpolationIcon:Wi,isSDF:!0,hasHalo:Ms,tile:Yt,labelPlaneMatrixInv:$u}},Zi=Ut.icon.segments.get().length,wi=Ut.text.segments.get().length,ur=Zi&&!I.onlyText?nr():null,$r=wi&&!I.onlyIcons?ri():null,Sn=l.paint.get("icon-opacity").constantOr(1),Kn=l.paint.get("text-opacity").constantOr(1);if(jt&&Ut.canOverlap){It=!0;const Zn=Sn&&!I.onlyText?Ut.icon.segments.get():[],Jn=Kn&&!I.onlyIcons?Ut.text.segments.get():[];for(const Ir of Zn)zt.push({segments:new i.b7([Ir]),sortKey:Ir.sortKey,state:ur});for(const Ir of Jn)zt.push({segments:new i.b7([Ir]),sortKey:Ir.sortKey,state:$r})}else I.onlyText||zt.push({segments:Sn?Ut.icon.segments:new i.b7([]),sortKey:0,state:ur}),I.onlyIcons||zt.push({segments:Kn?Ut.text.segments:new i.b7([]),sortKey:0,state:$r})}It&&zt.sort((ln,Yt)=>ln.sortKey-Yt.sortKey);for(const ln of zt){const Yt=ln.state;if(Yt)if(p.terrain?p.terrain.setupElevationDraw(Yt.tile,Yt.program,{useDepthForOcclusion:Ue.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Yt.labelPlaneMatrixInv}):p.setupDepthForOcclusion(Ue.depthOcclusionForSymbolsAndCircles,Yt.program),je.activeTexture.set(Ve.TEXTURE0),Yt.atlasTexture&&Yt.atlasTexture.bind(Yt.atlasInterpolation,Ve.CLAMP_TO_EDGE,!0),Yt.atlasTextureIcon&&(je.activeTexture.set(Ve.TEXTURE1),Yt.atlasTextureIcon&&Yt.atlasTextureIcon.bind(Yt.atlasInterpolationIcon,Ve.CLAMP_TO_EDGE,!0)),p.uploadCommonLightUniforms(p.context,Yt.program),Yt.hasHalo){const Ut=Yt.uniformValues;Ut.u_is_halo=1,af(Yt.buffers,ln.segments,l,p,Yt.program,ft,w,T,Ut,2),Ut.u_is_halo=0}else{if(Yt.isSDF){const Ut=Yt.uniformValues;Yt.hasHalo&&(Ut.u_is_halo=1,af(Yt.buffers,ln.segments,l,p,Yt.program,ft,w,T,Ut,1)),Ut.u_is_halo=0}af(Yt.buffers,ln.segments,l,p,Yt.program,ft,w,T,Yt.uniformValues,1)}}}function af(p,r,l,m,w,T,I,N,G,X){const Z=[p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer,p.iconTransitioningVertexBuffer,p.globeExtVertexBuffer,p.zOffsetVertexBuffer];w.draw(m,m.context.gl.TRIANGLES,T,I,N,Wn.disabled,G,l.id,p.layoutVertexBuffer,p.indexBuffer,r,l.paint,m.transform.zoom,p.programConfigurations.get(l.id),Z,X)}function Ll(p,r,l,m,w,T,I){const N=p.context.gl,G=l.paint.get("fill-pattern"),X=l.is3D(),Z=X?p.stencilModeFor3D():Qn.disabled,J=G&&G.constantOr(1);let Q,ae,ye,fe,be;I?(ae=J&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Q=N.LINES):(ae=J?"fillPattern":"fill",Q=N.TRIANGLES);for(const _e of m){const Ce=r.getTile(_e);if(J&&!Ce.patternsLoaded())continue;const ze=Ce.getBucket(l);if(!ze)continue;p.prepareDrawTile();const De=ze.programConfigurations.get(l.id),$e=p.isTileAffectedByFog(_e),je=p.getOrCreateProgram(ae,{config:De,overrideFog:$e});J&&(p.context.activeTexture.set(N.TEXTURE0),Ce.imageAtlasTexture&&Ce.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),De.updatePaintBuffers());const Ve=G.constantOr(null);if(Ve&&Ce.imageAtlas){const at=Ce.imageAtlas,St=i.A.from(Ve).getPrimary().scaleSelf(i.q.devicePixelRatio).serialize(),yt=at.patternPositions[St];yt&&De.setConstantPatternPositions(yt)}const Ue=p.translatePosMatrix(_e.projMatrix,Ce,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor")),Qe=l.paint.get("fill-emissive-strength");if(I){fe=ze.indexBuffer2,be=ze.segments2;const at=p.terrain&&p.terrain.renderingToTexture?p.terrain.drapeBufferSize:[N.drawingBufferWidth,N.drawingBufferHeight];ye=ae==="fillOutlinePattern"&&J?Bg(Ue,Qe,p,Ce,at):pc(Ue,Qe,at)}else fe=ze.indexBuffer,be=ze.segments,ye=J?hu(Ue,Qe,p,Ce):ah(Ue,Qe);p.uploadCommonUniforms(p.context,je,_e.toUnwrapped()),je.draw(p,Q,w,X?Z:p.stencilModeForClipping(_e),T,Wn.disabled,ye,l.id,ze.layoutVertexBuffer,fe,be,l.paint,p.transform.zoom,De,void 0)}}function vc(p,r,l,m,w,T,I,N){l.resetLayerRenderingStats(p);const G=p.context,X=G.gl,Z=p.transform,J=l.paint.get("fill-extrusion-pattern"),Q=J.constantOr(1),ae=l.paint.get("fill-extrusion-opacity"),ye=p.style.enable3dLights(),fe=l.paint.get(ye&&!Q?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),be=[l.paint.get("fill-extrusion-ambient-occlusion-intensity"),fe],_e=l.layout.get("fill-extrusion-edge-radius"),Ce=_e>0&&!l.paint.get("fill-extrusion-rounded-roof"),ze=Ce?0:_e,De=Z.projection.name==="globe"?i.d3():0,$e=Z.projection.name==="globe",je=$e?i.ae(Z.zoom):0,Ve=[i.at(Z.center.lng),i.aA(Z.center.lat)],Ue=l.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Qe=l.paint.get("fill-extrusion-flood-light-color").toRenderColor(Ue?null:l.lut).toArray01().slice(0,3),at=l.paint.get("fill-extrusion-flood-light-intensity"),St=l.paint.get("fill-extrusion-vertical-scale"),yt=l.paint.get("fill-extrusion-line-width").constantOr(1)!==0,jt=l.paint.get("fill-extrusion-height-alignment"),It=l.paint.get("fill-extrusion-base-alignment"),ft=ru(p,l.paint.get("fill-extrusion-cutoff-fade-range")),At=[];let Qt;$e&&At.push("PROJECTION_GLOBE_VIEW"),be[0]>0&&At.push("FAUX_AO"),Ce&&At.push("ZERO_ROOF_RADIUS"),N&&At.push("HAS_CENTROID"),at>0&&At.push("FLOOD_LIGHT"),ft.shouldRenderCutoff&&At.push("RENDER_CUTOFF"),yt&&At.push("RENDER_WALL_MODE");const ht=p.renderPass==="shadow",zt=p.shadowRenderer,Mt=ht&&!!zt;p.shadowRenderer&&(p.shadowRenderer.useNormalOffset=!0);let ln=[0,0,0];if(zt){const tn=p.style.directionalLight,fn=p.style.ambientLight;tn&&fn&&(ln=Uh(p.style,tn,fn)),ht||(At.push("RENDER_SHADOWS","DEPTH_TEXTURE"),zt.useNormalOffset&&At.push("NORMAL_OFFSET")),Qt=At.concat(["SHADOWS_SINGLE_CASCADE"])}const Yt=Mt?"fillExtrusionDepth":Q?"fillExtrusionPattern":"fillExtrusion",Ut=l.getLayerRenderingStats();for(const tn of m){const fn=r.getTile(tn),wn=fn.getBucket(l);if(!wn||wn.projection.name!==Z.projection.name)continue;let Cn=!1;zt&&(Cn=zt.getMaxCascadeForTile(tn.toUnwrapped())===0);const Yn=p.isTileAffectedByFog(tn),Gn=wn.programConfigurations.get(l.id),Un=p.getOrCreateProgram(Yt,{config:Gn,defines:Cn?Qt:At,overrideFog:Yn});if(p.terrain&&p.terrain.setupElevationDraw(fn,Un,{useMeterToDem:!0}),!wn.centroidVertexBuffer){const $r=Un.attributes.a_centroid_pos;$r!==void 0&&X.vertexAttrib2f($r,0,0)}!ht&&zt&&zt.setupShadows(fn.tileID.toUnwrapped(),Un,"vector-tile",fn.tileID.overscaledZ),Q&&(p.context.activeTexture.set(X.TEXTURE0),fn.imageAtlasTexture&&fn.imageAtlasTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE),Gn.updatePaintBuffers());const tr=J.constantOr(null);if(tr&&fn.imageAtlas){const $r=fn.imageAtlas,Sn=i.A.from(tr).getPrimary().scaleSelf(i.q.devicePixelRatio),Kn=$r.patternPositions[Sn.serialize()];Kn&&Gn.setConstantPatternPositions(Kn)}const nr=l.paint.get("fill-extrusion-vertical-gradient"),ri=1/wn.tileToMeter;let Zi;if(ht&&zt){if(lh(fn.tileID,wn,p))continue;const $r=zt.calculateShadowPassMatrixFromTile(fn.tileID.toUnwrapped());Zi=Lu($r,ze,ri,St,jt,It)}else{const $r=p.translatePosMatrix(tn.expandedProjMatrix,fn,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),Sn=Z.projection.createInversionMatrix(Z,tn.canonical);Zi=Q?Qh($r,p,nr,ae,be,ze,ri,tn,fn,De,jt,It,je,Ve,Sn,Qe,St):Jh($r,p,nr,ae,be,ze,ri,tn,De,jt,It,je,Ve,Sn,Qe,St,at,ln)}p.uploadCommonUniforms(G,Un,tn.toUnwrapped(),null,ft);let wi=wn.segments;if(Z.projection.name==="mercator"&&!ht&&(wi=wn.getVisibleSegments(fn.tileID,p.terrain,p.transform.getFrustum(0)),!wi.get().length))continue;if(Ut)if(ht)for(const $r of wi.get())Ut.numRenderedVerticesInShadowPass+=$r.primitiveLength;else for(const $r of wi.get())Ut.numRenderedVerticesInTransparentPass+=$r.primitiveLength;const ur=[];(p.terrain||N)&&ur.push(wn.centroidVertexBuffer),$e&&ur.push(wn.layoutVertexExtBuffer),yt&&ur.push(wn.wallVertexBuffer),Un.draw(p,G.gl.TRIANGLES,w,T,I,Wn.backCCW,Zi,l.id,wn.layoutVertexBuffer,wn.indexBuffer,wi,l.paint,p.transform.zoom,Gn,ur)}p.shadowRenderer&&(p.shadowRenderer.useNormalOffset=!1)}function xc(p,r,l,m,w,T,I,N,G,X,Z,J,Q,ae,ye,fe,be,_e,Ce){const ze=p.context,De=ze.gl,$e=p.transform,je=p.transform.zoom,Ve=[],Ue=ru(p,l.paint.get("fill-extrusion-cutoff-fade-range"));X==="clear"?(Ve.push("CLEAR_SUBPASS"),Ce&&(Ve.push("CLEAR_FROM_TEXTURE"),ze.activeTexture.set(De.TEXTURE0),Ce.bind(De.LINEAR,De.CLAMP_TO_EDGE))):X==="sdf"&&Ve.push("SDF_SUBPASS"),be&&Ve.push("HAS_CENTROID"),Ue.shouldRenderCutoff&&Ve.push("RENDER_CUTOFF");const Qe=l.layout.get("fill-extrusion-edge-radius"),at=(St,yt,jt,It,ft)=>{const At=yt.programConfigurations.get(l.id),Qt=p.isTileAffectedByFog(St),ht=p.getOrCreateProgram("fillExtrusionGroundEffect",{config:At,defines:Ve,overrideFog:Qt}),zt=((ln,Yt,Ut,tn,fn,wn,Cn,Yn,Gn,Un,tr)=>({u_matrix:Yt,u_opacity:Ut,u_ao_pass:tn?1:0,u_meter_to_tile:fn,u_ao:wn,u_flood_light_intensity:Cn,u_flood_light_color:Yn,u_attenuation:Gn,u_edge_radius:Un,u_fb:0,u_fb_size:tr,u_dynamic_offset:1}))(0,It,Z,G,ft,[J,Q*ft],ae,ye,fe,je>=17?0:Qe*ft,Ce?Ce.size[0]:0),Mt=[];be&&Mt.push(yt.hiddenByLandmarkVertexBuffer),p.uploadCommonUniforms(ze,ht,St.toUnwrapped(),null,Ue),ht.draw(p,ze.gl.TRIANGLES,w,T,I,N,zt,l.id,yt.vertexBuffer,yt.indexBuffer,jt,l.paint,je,At,Mt)};for(const St of m){const yt=r.getTile(St),jt=yt.getBucket(l);if(!jt||jt.projection.name!==$e.projection.name||!jt.groundEffect||jt.groundEffect&&!jt.groundEffect.hasData())continue;const It=jt.groundEffect,ft=1/jt.tileToMeter;{const At=p.translatePosMatrix(St.projMatrix,yt,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),Qt=It.getDefaultSegment();at(St,It,Qt,At,ft)}if(_e)for(let At=0;At<4;At++){const Qt=i.d4[At](St),ht=r.getTile(Qt);if(!ht)continue;const zt=ht.getBucket(l);if(!zt||zt.projection.name!==$e.projection.name||!zt.groundEffect||zt.groundEffect&&!zt.groundEffect.hasData())continue;const Mt=zt.groundEffect;let ln,Yt;At===0?(ln=[-i.ag,0,0],Yt=1):At===1?(ln=[i.ag,0,0],Yt=0):At===2?(ln=[0,-i.ag,0],Yt=3):(ln=[0,i.ag,0],Yt=2);const Ut=Mt.regionSegments[Yt];if(!Ut)continue;const tn=new Float32Array(16);i.ab.mat4.translate(tn,St.projMatrix,ln),at(St,Mt,Ut,p.translatePosMatrix(tn,yt,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),ft)}}}function bc(p,r,l,m,w,T,I){m.centroidVertexArray.length===0&&m.createCentroidsBuffer();const N=T?T.findDEMTileFor(l):null;if(!(N&&N.dem||I))return;T&&N&&N.dem&&m.selfDEMTileTimestamp!==N.dem._timestamp&&(m.borderDoneWithNeighborZ=[-1,-1,-1,-1],m.selfDEMTileTimestamp=N.dem._timestamp);const G=_e=>new i.P(Math.ceil((_e+i.d7)*i.d8),0),X=_e=>{const Ce=r.getSource().minzoom,ze=$e=>{const je=r.getTileByID($e);if(je&&je.hasData())return je.getBucket(w)},De=[0,-1,1];for(const $e of De){if(_e.overscaledZ+$e<Ce)continue;const je=ze(_e.calculateScaledKey(_e.overscaledZ+$e));if(je)return je}},Z=[0,0,0],J=(_e,Ce)=>(Z[0]=Math.min(_e.min.y,Ce.min.y),Z[1]=Math.max(_e.max.y,Ce.max.y),Z[2]=i.ag-Ce.min.x>_e.max.x?Ce.min.x-i.ag:_e.max.x,Z),Q=(_e,Ce)=>(Z[0]=Math.min(_e.min.x,Ce.min.x),Z[1]=Math.max(_e.max.x,Ce.max.x),Z[2]=i.ag-Ce.min.y>_e.max.y?Ce.min.y-i.ag:_e.max.y,Z),ae=[(_e,Ce)=>J(_e,Ce),(_e,Ce)=>J(Ce,_e),(_e,Ce)=>Q(_e,Ce),(_e,Ce)=>Q(Ce,_e)],ye=(_e,Ce,ze,De,$e,je,Ve)=>{if(!T)return 0;const Ue=[[je?ze:_e,je?_e:ze,0],[je?ze:Ce,je?Ce:ze,0]],Qe=Ve<0?i.ag+Ve:Ve,at=[je?Qe:(_e+Ce)/2,je?(_e+Ce)/2:Qe,0];return ze===0&&Ve<0||ze!==0&&Ve>0?T.getForTilePoints($e,[at],!0,De):Ue.push(at),T.getForTilePoints(l,Ue,!0,N),Math.max(Ue[0][2],Ue[1][2],at[2])/T.exaggeration()};for(let _e=0;_e<4;_e++){const Ce=m.borderFeatureIndices[_e];if(Ce.length===0)continue;const ze=i.d4[_e](l),De=X(ze);if(!(De&&De instanceof i.d5))continue;const $e=T?T.findDEMTileFor(ze):null;if(!($e&&$e.dem||I)||(T&&$e&&$e.dem&&m.borderDEMTileTimestamp[_e]!==$e.dem._timestamp&&(m.borderDoneWithNeighborZ[_e]=-1,m.borderDEMTileTimestamp[_e]=$e.dem._timestamp),m.borderDoneWithNeighborZ[_e]===De.canonical.z))continue;De.centroidVertexArray.length===0&&De.createCentroidsBuffer();const je=(_e<2?1:5)-_e,Ve=De.borderDoneWithNeighborZ[je]!==m.canonical.z,Ue=De.borderFeatureIndices[je];let Qe=0;if(m.canonical.z!==De.canonical.z){for(const at of Ce)m.showCentroid(m.featuresOnBorder[at]);if(Ve)for(const at of Ue)De.showCentroid(De.featuresOnBorder[at]);m.borderDoneWithNeighborZ[_e]=De.canonical.z,De.borderDoneWithNeighborZ[je]=m.canonical.z}for(const at of Ce){const St=m.featuresOnBorder[at],yt=m.centroidData[St.centroidDataIndex],jt=St.borders[_e];let It;for(;Qe<Ue.length;){It=De.featuresOnBorder[Ue[Qe]];const ft=It.borders[je];if(ft[1]>jt[0]+3||ft[0]>jt[0]-3)break;De.showCentroid(It),Qe++}if(It&&Qe<Ue.length){const ft=Qe;let At=0;for(;!(It.borders[je][0]>jt[1]-3)&&(At++,++Qe!==Ue.length);)It=De.featuresOnBorder[Ue[Qe]];It=De.featuresOnBorder[Ue[ft]];let Qt=!1;if(At>=1){const Mt=It.borders[je];Math.abs(jt[0]-Mt[0])<3&&Math.abs(jt[1]-Mt[1])<3&&(At=1,Qt=!0,Qe=ft+1)}else if(At===0){m.showCentroid(St);continue}const ht=De.centroidData[It.centroidDataIndex];I&&Qt&&(((fe=yt).flags|(be=ht).flags)&i.d6?(fe.flags|=i.d6,be.flags|=i.d6):(fe.flags&=~i.d6,be.flags&=~i.d6));const zt=St.intersectsCount()>1||It.intersectsCount()>1;if(At>1)Qe=ft,yt.centroidXY=ht.centroidXY=new i.P(0,0);else if($e&&$e.dem&&!zt){const Mt=ae[_e](yt,ht),ln=_e%2?i.ag-1:0,Yt=ye(Mt[0],Math.min(i.ag-1,Mt[1]),ln,$e,ze,_e<2,Mt[2]);yt.centroidXY=ht.centroidXY=G(Yt)}else zt?yt.centroidXY=ht.centroidXY=new i.P(0,0):(yt.centroidXY=m.encodeBorderCentroid(St),ht.centroidXY=De.encodeBorderCentroid(It));m.writeCentroidToBuffer(yt),De.writeCentroidToBuffer(ht)}else m.showCentroid(St)}m.borderDoneWithNeighborZ[_e]=De.canonical.z,De.borderDoneWithNeighborZ[je]=m.canonical.z}var fe,be;(m.needsCentroidUpdate||!m.centroidVertexBuffer&&m.centroidVertexArray.length!==0)&&m.uploadCentroid(p)}const sh=[1,0,0],sn=[0,1,0],En=[0,0,1];function lh(p,r,l){const m=l.transform,w=l.shadowRenderer;if(!w)return!0;const T=p.toUnwrapped(),I=m.tileSize*w._cascades[l.currentShadowCascade].scale;let N=r.maxHeight;if(m.elevation){const fe=m.elevation.getMinMaxForTile(p);fe&&(N+=fe.max)}const G=[...w.shadowDirection];G[2]=-G[2];const X=w.computeSimplifiedTileShadowVolume(T,N,I,G);if(!X)return!1;const Z=[sh,sn,En,G,[G[0],0,G[2]],[0,G[1],G[2]]],J=m.projection.name==="globe",Q=m.scaleZoom(I),ae=i.bR.fromInvProjectionMatrix(m.invProjMatrix,m.worldSize,Q,!J),ye=w.getCurrentCascadeFrustum();return ae.intersectsPrecise(X.vertices,X.planes,Z)===0||ye.intersectsPrecise(X.vertices,X.planes,Z)===0}function Bi(p){return[p[0]*i.d9,p[1]*i.d9,p[2]*i.d9,0]}function _t(p,r,l,m,w,T,I,N,G){const X=m.getSource(),Z=l.globeSharedBuffers;if(!Z)return;let J,Q,ae;if(r&&(J=m.getTile(r)),X instanceof i.aJ?(Q=X.texture,ae=i.cI(0,0,l.transform)):J&&r&&(Q=J.texture,ae=i.cI(r.canonical.z,r.canonical.x,l.transform)),!Q||!ae)return;p||(ae=i.ab.mat4.scale(i.ab.mat4.create(),ae,[1,-1,1]));const ye=l.context,fe=ye.gl,be=w.paint.get("raster-resampling")==="nearest"?fe.NEAREST:fe.LINEAR,_e=l.colorModeForDrapableLayerRenderPass(T),Ce=I.defines;Ce.push("GLOBE_POLES");const ze=new qn(fe.LEQUAL,qn.ReadWrite,l.depthRangeFor3D),De=Float32Array.from(l.transform.expandedFarZProjMatrix),$e=Float32Array.from(i.bb(i.cH(new i.bT(0,0,0))));l.terrain&&l.terrain.prepareDrawTile(),ye.activeTexture.set(fe.TEXTURE0),Q.bind(be,fe.CLAMP_TO_EDGE),ye.activeTexture.set(fe.TEXTURE1),Q.bind(be,fe.CLAMP_TO_EDGE),Q.useMipmap&&ye.extTextureFilterAnisotropic&&l.transform.pitch>20&&fe.texParameterf(fe.TEXTURE_2D,ye.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ye.extTextureFilterAnisotropicMax);const[je,Ve,Ue,Qe]=r?Z.getPoleBuffers(r.canonical.z,!1):Z.getPoleBuffers(0,!0),at=w.paint.get("raster-elevation");let St;p?(St=je,l.renderDefaultNorthPole=at!==0):(St=Ve,l.renderDefaultSouthPole=at!==0);const yt=Bi(I.mix),jt=((ft,At,Qt,ht,zt,Mt,ln,Yt,Ut,tn,fn,wn,Cn)=>zu(ft,At,Qt,new Float32Array(16),new Float32Array(9),[0,0],ht,[0,0],[0,0,0,0],1,{opacity:1,mix:0},Mt,[0,0],Yt,2,tn,fn,wn,1,0,Cn))(De,$e,ae,i.ae(l.transform.zoom),0,w,0,at,0,yt,I.offset,I.range,T),It=l.getOrCreateProgram("raster",{defines:Ce});l.uploadCommonUniforms(ye,It,null),It.draw(l,fe.TRIANGLES,ze,G,_e,N,jt,w.id,St,Ue,Qe)}function yp(p){const r=p._nearZ,l=p.projection.farthestPixelDistance(p),m=l-r,w=.2*p.height,T=r+w;return[r,l,(T-w-r)/m,(T-r)/m]}function sd(p,r,l,m){if(p)return r instanceof ta&&p instanceof Ol?r.getTextureDescriptor(p,l,!0):{texture:p.texture,mix:Bi(m.mix),offset:m.offset,buffer:0,tileSize:1}}var vm=i.da([{name:"a_index",type:"Int16",components:1}]);class xm{constructor(r,l,m,w){const T={width:m[0],height:m[1],data:null},I=r.gl;this.targetColorTexture=new i.T(r,T,I.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new i.T(r,T,I.RGBA8,{useMipmap:!1}),this.context=r,this.updateParticleTexture(l,w),this.lastInvalidatedAt=0}updateParticleTexture(r,l){if(this.particleTextureDimension===l.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const m=this.context.gl,w=l.width*l.height;this.particleTexture0=new i.T(this.context,l,m.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new i.T(this.context,l,m.RGBA8,{premultiply:!1,useMipmap:!1});const T=new i.db;T.reserve(w);for(let I=0;I<w;I++)T.emplaceBack(I);this.particleIndexBuffer=this.context.createVertexBuffer(T,vm.members,!0),this.particleSegment=i.b7.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=l.width}update(r){return!(this.lastInvalidatedAt<r&&(this.lastInvalidatedAt=i.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function bm(p,r,l){if(!p)return null;const m=r.getTextureDescriptor(p,l,!0);if(!m)return null;let{texture:w,mix:T,offset:I,tileSize:N,buffer:G,format:X}=m;if(!w||!X)return null;let Z=!1;return X==="uint32"&&(Z=!0,T[3]=0,T=rd(i.dc,T,[0,l.paint.get("raster-particle-max-speed")]),I=ef(i.dc,I,[0,l.paint.get("raster-particle-max-speed")])),{texture:w,textureOffset:[G/(N+2*G),N/(N+2*G)],tileSize:N,scalarData:Z,scale:T,offset:I,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[X]]}}function wm(p){const r=p._nearZ,l=p.projection.farthestPixelDistance(p),m=l-r,w=.2*p.height,T=r+w;return[r,l,(T-w-r)/m,(T-r)/m]}const wc=new i.aj(1,0,0,1),jg=new i.aj(0,1,0,1),Ug=new i.aj(0,0,1,1),Sm=new i.aj(1,0,1,1),ld=new i.aj(0,1,1,1);function ju(p,r,l,m,w,T,I){const N=p.context,G=p.transform,X=N.gl,Z=G.projection.name==="globe",J=Z?["PROJECTION_GLOBE_VIEW"]:[];let Q=i.ab.mat4.clone(l.projMatrix);if(Z&&i.ae(G.zoom)>0){const yt=i.ba(l.canonical,G),jt=i.dd(yt);Q=i.ab.mat4.multiply(new Float32Array(16),G.globeMatrix,jt),i.ab.mat4.multiply(Q,G.projMatrix,Q)}const ae=i.ab.mat4.create();ae[12]+=2*w/(i.q.devicePixelRatio*G.width),ae[13]+=2*T/(i.q.devicePixelRatio*G.height),i.ab.mat4.multiply(Q,ae,Q);const ye=p.getOrCreateProgram("debug",{defines:J}),fe=r.getTileByID(l.key);p.terrain&&p.terrain.setupElevationDraw(fe,ye);const be=qn.disabled,_e=Qn.disabled,Ce=p.colorModeForRenderPass(),ze="$debug";N.activeTexture.set(X.TEXTURE0),p.emptyTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE),Z?fe._makeGlobeTileDebugBuffers(p.context,G):fe._makeDebugTileBoundsBuffers(p.context,G.projection);const De=fe._tileDebugBuffer||p.debugBuffer,$e=fe._tileDebugIndexBuffer||p.debugIndexBuffer,je=fe._tileDebugSegments||p.debugSegments;if(ye.draw(p,X.LINE_STRIP,be,_e,Ce,Wn.disabled,oh(Q,m),ze,De,$e,je,null,null,null,[fe._globeTileDebugBorderBuffer]),I){const yt=fe.latestRawTileData,jt=Math.floor((yt&&yt.byteLength||0)/1024);let It=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(It+=` => ${l.overscaledZ}`),It+=` ${fe.state}`,It+=` ${jt}kb`,function(ft,At){ft.initDebugOverlayCanvas();const Qt=ft.debugOverlayCanvas,ht=ft.context.gl,zt=ft.debugOverlayCanvas.getContext("2d");zt.clearRect(0,0,Qt.width,Qt.height),zt.shadowColor="white",zt.shadowBlur=2,zt.lineWidth=1.5,zt.strokeStyle="white",zt.textBaseline="top",zt.font="bold 36px Open Sans, sans-serif",zt.fillText(At,5,5),zt.strokeText(At,5,5),ft.debugOverlayTexture.update(Qt),ft.debugOverlayTexture.bind(ht.LINEAR,ht.CLAMP_TO_EDGE)}(p,It)}const Ve=r.getTile(l).tileSize,Ue=512/Math.min(Ve,512)*(l.overscaledZ/G.zoom)*.5,Qe=fe._tileDebugTextBuffer||p.debugBuffer,at=fe._tileDebugTextIndexBuffer||p.quadTriangleIndexBuffer,St=fe._tileDebugTextSegments||p.debugSegments;ye.draw(p,X.TRIANGLES,be,_e,vr.alphaBlended,Wn.disabled,oh(Q,i.aj.transparent,Ue),ze,Qe,at,St,null,null,null,[fe._globeTileDebugTextBuffer])}function Tm(p,r,l,m){cl(p,0,r+l/2,p.transform.width,l,m)}function _p(p,r,l,m){cl(p,r-l/2,0,l,p.transform.height,m)}function cl(p,r,l,m,w,T){const I=p.context,N=I.gl;N.enable(N.SCISSOR_TEST),N.scissor(r*i.q.devicePixelRatio,l*i.q.devicePixelRatio,m*i.q.devicePixelRatio,w*i.q.devicePixelRatio),I.clear({color:T}),N.disable(N.SCISSOR_TEST)}const ud=i.da([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:$s}=ud;function hl(p,r,l,m){p.emplaceBack(r,l,m)}class Em{constructor(r){this.vertexArray=new i.de,this.indices=new i.aU,hl(this.vertexArray,-1,-1,1),hl(this.vertexArray,1,-1,1),hl(this.vertexArray,-1,1,1),hl(this.vertexArray,1,1,1),hl(this.vertexArray,-1,-1,-1),hl(this.vertexArray,1,-1,-1),hl(this.vertexArray,-1,1,-1),hl(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,$s),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=i.b7.simpleSegment(0,0,36,12)}}function Ca(p,r,l,m,w,T){const I=p.context.gl,N=r.paint.get("sky-atmosphere-color"),G=r.paint.get("sky-atmosphere-halo-color"),X=r.paint.get("sky-atmosphere-sun-intensity"),Z=((J,Q,ae,ye,fe)=>({u_matrix_3f:J,u_sun_direction:Q,u_sun_intensity:ae,u_color_tint_r:[ye.r,ye.g,ye.b,ye.a],u_color_tint_m:[fe.r,fe.g,fe.b,fe.a],u_luminance:5e-5}))(i.ab.mat3.fromMat4(i.ab.mat3.create(),m),w,X,N,G);I.framebufferTexture2D(I.FRAMEBUFFER,I.COLOR_ATTACHMENT0,I.TEXTURE_CUBE_MAP_POSITIVE_X+T,r.skyboxTexture,0),l.draw(p,I.TRIANGLES,qn.disabled,Qn.disabled,vr.unblended,Wn.frontCW,Z,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const Vg=i.da([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class of{constructor(r){const l=new i.df;l.emplaceBack(-1,1,1,0,0),l.emplaceBack(1,1,1,1,0),l.emplaceBack(1,-1,1,1,1),l.emplaceBack(-1,-1,1,0,1);const m=new i.aU;m.emplaceBack(0,1,2),m.emplaceBack(2,3,0),this.vertexBuffer=r.createVertexBuffer(l,Vg.members),this.indexBuffer=r.createIndexBuffer(m),this.segments=i.b7.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const bi=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class Yr{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class vp{constructor(r){this.colorModeAlphaBlendedWriteRGB=new vr([1,ms,1,ms],i.aj.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new vr([1,0,1,0],i.aj.transparent,[!1,!1,!1,!0]),this.params=new Yr,this.updateNeeded=!0,r.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),r.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(r){const l=r.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new of(l);const m=this.params.sizeRange,w=this.params.intensityRange,T=function(Z){const J=i.di(30),Q=[];for(let ae=0;ae<Z;++ae){const ye=2*Math.PI*J(),fe=Math.acos(1-2*J())-.5*Math.PI;Q.push(i.ab.vec3.fromValues(Math.cos(fe)*Math.cos(ye),Math.cos(fe)*Math.sin(ye),Math.sin(fe)))}return Q}(this.params.starsCount),I=i.di(300),N=new i.dg,G=new i.aU;let X=0;for(let Z=0;Z<T.length;++Z){const J=i.ab.vec3.scale([],T[Z],200),Q=Math.max(0,1+.01*m*(1*I()-.5)),ae=Math.max(0,1+.01*w*(1*I()-.5));N.emplaceBack(J[0],J[1],J[2],-1,-1,Q,ae),N.emplaceBack(J[0],J[1],J[2],1,-1,Q,ae),N.emplaceBack(J[0],J[1],J[2],1,1,Q,ae),N.emplaceBack(J[0],J[1],J[2],-1,1,Q,ae),G.emplaceBack(X+0,X+1,X+2),G.emplaceBack(X+0,X+2,X+3),X+=4}this.starsVx=l.createVertexBuffer(N,bi.members),this.starsIdx=l.createIndexBuffer(G),this.starsSegments=i.b7.simpleSegment(0,0,N.length,G.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(r,l){const m=r.context,w=m.gl,T=r.transform,I=new qn(w.LEQUAL,qn.ReadOnly,[0,1]),N=i.ae(T.zoom),G=r.style.getLut(l.scope),X=l.properties.get("color-use-theme")==="none",Z=l.properties.get("color").toRenderColor(X?null:G).toArray01(),J=l.properties.get("high-color-use-theme")==="none",Q=l.properties.get("high-color").toRenderColor(J?null:G).toArray01(),ae=l.properties.get("space-color-use-theme")==="none",ye=l.properties.get("space-color").toRenderColor(ae?null:G).toArray01PremultipliedAlpha(),fe=5e-4,be=i.dh(l.properties.get("horizon-blend"),0,1,fe,.25),_e=i.cC(r,m,T)&&be===fe?T.worldSize/(2*Math.PI*1.025)-1:T.globeRadius,Ce=r.frameCounter/1e3%1,ze=i.ab.vec3.length(T.globeCenterInViewSpace),De=Math.sqrt(Math.pow(ze,2)-Math.pow(_e,2)),$e=Math.acos(De/ze),je=Ve=>{const Ue=T.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Ve&&Ue.push("ALPHA_PASS");const Qe=r.getOrCreateProgram("globeAtmosphere",{defines:Ue}),at=((yt,jt,It,ft,At,Qt,ht,zt,Mt,ln,Yt,Ut)=>({u_frustum_tl:yt,u_frustum_tr:jt,u_frustum_br:It,u_frustum_bl:ft,u_horizon:At,u_transition:Qt,u_fadeout_range:ht,u_color:zt,u_high_color:Mt,u_space_color:ln,u_temporal_offset:Yt,u_horizon_angle:Ut}))(T.frustumCorners.TL,T.frustumCorners.TR,T.frustumCorners.BR,T.frustumCorners.BL,T.frustumCorners.horizon,N,be,Z,Q,ye,Ce,$e);r.uploadCommonUniforms(m,Qe);const St=this.atmosphereBuffer;St&&Qe.draw(r,w.TRIANGLES,I,Qn.disabled,Ve?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Wn.backCW,at,Ve?"atmosphere_glow_alpha":"atmosphere_glow",St.vertexBuffer,St.indexBuffer,St.segments)};je(!1),je(!0)}drawStars(r,l){const m=i.aw(l.properties.get("star-intensity"),0,1);if(m===0)return;const w=r.context,T=w.gl,I=r.transform,N=r.getOrCreateProgram("stars"),G=i.ab.quat.identity([]);i.ab.quat.rotateX(G,G,-I._pitch),i.ab.quat.rotateZ(G,G,-I.angle),i.ab.quat.rotateX(G,G,i.ai(I._center.lat)),i.ab.quat.rotateY(G,G,-i.ai(I._center.lng));const X=i.ab.mat4.fromQuat(new Float32Array(16),G),Z=i.ab.mat4.multiply([],I.starsProjMatrix,X),J=i.ab.mat3.fromMat4([],X),Q=i.ab.mat3.invert([],J),ae=[0,1,0];i.ab.vec3.transformMat3(ae,ae,Q),i.ab.vec3.scale(ae,ae,this.params.sizeMultiplier);const ye=[1,0,0];i.ab.vec3.transformMat3(ye,ye,Q),i.ab.vec3.scale(ye,ye,this.params.sizeMultiplier);const fe=(be=ae,_e=ye,Ce=m,{u_matrix:Float32Array.from(Z),u_up:be,u_right:_e,u_intensity_multiplier:Ce});var be,_e,Ce;r.uploadCommonUniforms(w,N),this.starsVx&&this.starsIdx&&N.draw(r,T.TRIANGLES,qn.disabled,Qn.disabled,this.colorModeAlphaBlendedWriteRGB,Wn.disabled,fe,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function fu(p,r){const l=[...p],m=r.cameraWorldSizeForFog/r.worldSize,w=i.ab.mat4.identity([]);return i.ab.mat4.scale(w,w,[m,m,1]),i.ab.mat4.multiply(l,w,l),i.ab.mat4.multiply(l,r.worldToFogMatrix,l),l}function uh(p,r,l,m,w){const T=l.material,I=m.context,{baseColorTexture:N,metallicRoughnessTexture:G}=T.pbrMetallicRoughness,{normalTexture:X,occlusionTexture:Z,emissionTexture:J}=T;function Q(ye,fe,be){if(ye&&(p.push(fe),I.activeTexture.set(I.gl.TEXTURE0+be),ye.gfxTexture)){const{minFilter:_e,magFilter:Ce,wrapS:ze,wrapT:De}=ye.sampler;ye.gfxTexture.bindExtraParam(_e,Ce,ze,De)}}Q(N,"HAS_TEXTURE_u_baseColorTexture",Ma.BaseColor),Q(G,"HAS_TEXTURE_u_metallicRoughnessTexture",Ma.MetallicRoughness),Q(X,"HAS_TEXTURE_u_normalTexture",Ma.Normal),Q(Z,"HAS_TEXTURE_u_occlusionTexture",Ma.Occlusion),Q(J,"HAS_TEXTURE_u_emissionTexture",Ma.Emission),w&&(w.texture||(w.texture=new i.dk(m.context,w.image,[w.image.height,w.image.height,w.image.height],I.gl.RGBA8)),I.activeTexture.set(I.gl.TEXTURE0+Ma.LUT),w.texture&&w.texture.bind(I.gl.LINEAR,I.gl.CLAMP_TO_EDGE),p.push("APPLY_LUT_ON_GPU")),l.texcoordBuffer&&(p.push("HAS_ATTRIBUTE_a_uv_2f"),r.push(l.texcoordBuffer)),l.colorBuffer&&(p.push(l.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),r.push(l.colorBuffer)),l.normalBuffer&&(p.push("HAS_ATTRIBUTE_a_normal_3f"),r.push(l.normalBuffer)),l.pbrBuffer&&(p.push("HAS_ATTRIBUTE_a_pbr"),p.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),r.push(l.pbrBuffer)),T.alphaMode!=="OPAQUE"&&T.alphaMode!=="MASK"||p.push("UNPREMULT_TEXTURE_IN_SHADER"),T.defined||p.push("DIFFUSE_SHADED");const ae=m.shadowRenderer;ae&&(p.push("RENDER_SHADOWS","DEPTH_TEXTURE"),ae.useNormalOffset&&p.push("NORMAL_OFFSET"))}function zl(p,r,l,m,w,T){const I=l.paint.get("model-opacity").constantOr(1),N=r.context,G=new qn(r.context.gl.LEQUAL,qn.ReadWrite,r.depthRangeFor3D),X=r.transform,Z=p.mesh,J=Z.material,Q=J.pbrMetallicRoughness,ae=r.style.fog;let ye;ye=r.transform.projection.zAxisUnit==="pixels"?[...p.nodeModelMatrix]:i.ab.mat4.multiply([],m.zScaleMatrix,p.nodeModelMatrix),i.ab.mat4.multiply(ye,m.negCameraPosMatrix,ye);const fe=i.ab.mat4.invert([],ye);i.ab.mat4.transpose(fe,fe);const be=l.paint.get("model-color-use-theme").constantOr("default")==="none",_e=l.paint.get("model-emissive-strength").constantOr(0),Ce=id(new Float32Array(p.worldViewProjection),new Float32Array(ye),new Float32Array(fe),null,r,I,Q.baseColorFactor.toRenderColor(null),J.emissiveFactor,Q.metallicFactor,Q.roughnessFactor,J,_e,l),ze={defines:[]},De=[],$e=r.shadowRenderer;$e&&($e.useNormalOffset=!1),uh(ze.defines,De,Z,r,be?null:l.lut);let je=null;if(ae){const Qe=fu(p.nodeModelMatrix,r.transform);if(je=new Float32Array(Qe),X.projection.name!=="globe"){const at=Z.aabb.min,St=Z.aabb.max,[yt,jt]=ae.getOpacityForBounds(Qe,at[0],at[1],St[0],St[1]);ze.overrideFog=yt>=Xe||jt>=Xe}}const Ve=ru(r,l.paint.get("model-cutoff-fade-range"));Ve.shouldRenderCutoff&&ze.defines.push("RENDER_CUTOFF");const Ue=r.getOrCreateProgram("model",ze);r.uploadCommonUniforms(N,Ue,null,je,Ve),r.renderPass!=="shadow"&&$e&&$e.setupShadowsFromMatrix(p.nodeModelMatrix,Ue),Ue.draw(r,N.gl.TRIANGLES,G,w,T,Z.material.doubleSided?Wn.disabled:Wn.backCCW,Ce,l.id,Z.vertexBuffer,Z.indexBuffer,Z.segments,l.paint,r.transform.zoom,void 0,De)}function cd(p,r,l,m,w,T,I){let N;N=p.projection.name==="globe"?i.dl(l,p):[...l],i.ab.mat4.multiply(N,N,r.matrix);const G=i.ab.mat4.multiply([],m,N);if(r.meshes)for(const X of r.meshes){if(X.material.alphaMode!=="BLEND"){I.push({mesh:X,depth:0,modelIndex:w,worldViewProjection:G,nodeModelMatrix:N});continue}const Z=i.ab.vec3.transformMat4([],X.centroid,G);!p.isOrthographic&&Z[2]<=0||T.push({mesh:X,depth:Z[2],modelIndex:w,worldViewProjection:G,nodeModelMatrix:N})}if(r.children)for(const X of r.children)cd(p,X,l,m,w,T,I)}function sf(p,r,l,m){const w=l.shadowRenderer;if(!w)return;const T=w.getShadowPassDepthMode(),I=w.getShadowPassColorMode(),N=w.calculateShadowPassMatrixFromMatrix(r),G=ma(N);l.getOrCreateProgram("modelDepth",{defines:l._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(l,l.context.gl.TRIANGLES,T,Qn.disabled,I,Wn.backCCW,G,m.id,p.vertexBuffer,p.indexBuffer,p.segments,m.paint,l.transform.zoom,void 0,void 0)}function du(p,r,l){const m=r.updateZoomBasedPaintProperties(),w=function(T,I,N){let G,X,Z,J=T.terrain?T.terrain.exaggeration():0;if(T.terrain&&J>0){const Q=T.terrain,ae=Q.findDEMTileFor(N);ae&&ae.dem?G=i.dn.create(Q,N,ae):J=0}if(J===0&&(I.terrainElevationMin=0,I.terrainElevationMax=0),J===I.validForExaggeration&&(J===0||G&&G._demTile&&G._demTile.tileID===I.validForDEMTile.id&&G._dem._timestamp===I.validForDEMTile.timestamp))return!1;for(const Q in I.instancesPerModel){const ae=I.instancesPerModel[Q];for(let ye=0;ye<ae.instancedDataArray.length;++ye){const fe=(G?J*G.getElevationAt(0|ae.instancedDataArray.float32[16*ye],0|ae.instancedDataArray.float32[16*ye+1],!0,!0):0)+ae.instancesEvaluatedElevation[ye];ae.instancedDataArray.float32[16*ye+6]=fe,X=X?Math.min(I.terrainElevationMin,fe):fe,Z=Z?Math.max(I.terrainElevationMax,fe):fe}}return I.terrainElevationMin=X||0,I.terrainElevationMax=Z||0,I.validForExaggeration=J,I.validForDEMTile=G&&G._demTile?{id:G._demTile.tileID,timestamp:G._dem._timestamp}:{id:void 0,timestamp:0},!0}(p,r,l);(m||w)&&(r.uploaded=!1,r.upload(p.context))}const so={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new i.cd([0,0,0],[i.ag,i.ag,0])};function hd(p,r){const l=1<<p.canonical.z,m=r.getFreeCameraOptions().position,w=r.elevation,T=p.canonical.x/l,I=(p.canonical.x+1)/l,N=p.canonical.y/l,G=(p.canonical.y+1)/l;let X=r._centerAltitude;if(w){const ae=w.getMinMaxForTile(p);ae&&ae.max>X&&(X=ae.max)}const Z=i.aw(m.x,T,I)-m.x,J=i.aw(m.y,N,G)-m.y,Q=i.bH(X,r.center.lat)-m.z;return r._zoomFromMercatorZ(Math.sqrt(Z*Z+J*J+Q*Q))}function lf(p,r,l,m,w,T,I){const N=p.context,G=p.renderPass==="shadow",X=p.shadowRenderer,Z=G&&X?X.getShadowPassDepthMode():new qn(N.gl.LEQUAL,qn.ReadWrite,p.depthRangeFor3D),J=p.isTileAffectedByFog(T);if(l.meshes)for(const Q of l.meshes){const ae=["MODEL_POSITION_ON_GPU"],ye=[];let fe,be,_e;m.instancedDataArray.length>20&&ae.push("INSTANCED_ARRAYS");const Ce=ru(p,r.paint.get("model-cutoff-fade-range"));if(Ce.shouldRenderCutoff&&ae.push("RENDER_CUTOFF"),G&&X)fe=p.getOrCreateProgram("modelDepth",{defines:ae}),be=ma(I.shadowTileMatrix,I.shadowTileMatrix,Float32Array.from(l.matrix)),_e=X.getShadowPassColorMode();else{uh(ae,ye,Q,p,r.paint.get("model-color-use-theme").constantOr("default")==="none"?null:r.lut),fe=p.getOrCreateProgram("model",{defines:ae,overrideFog:J});const De=Q.material,$e=De.pbrMetallicRoughness,je=r.paint.get("model-opacity").constantOr(1),Ve=r.paint.get("model-emissive-strength").constantOr(0);be=id(T.expandedProjMatrix,Float32Array.from(l.matrix),new Float32Array(16),null,p,je,$e.baseColorFactor.toRenderColor(null),De.emissiveFactor,$e.metallicFactor,$e.roughnessFactor,De,Ve,r,w),X&&(I.shadowUniformsInitialized?fe.setShadowUniformValues(N,X.getShadowUniformValues()):(X.setupShadows(T.toUnwrapped(),fe,"model-tile",T.overscaledZ),I.shadowUniformsInitialized=!0)),_e=Ce.shouldRenderCutoff||je<1||De.alphaMode!=="OPAQUE"?vr.alphaBlended:vr.unblended}p.uploadCommonUniforms(N,fe,T.toUnwrapped(),null,Ce);const ze=Q.material.doubleSided?Wn.disabled:Wn.backCCW;if(m.instancedDataArray.length>20)ye.push(m.instancedDataBuffer),fe.draw(p,N.gl.TRIANGLES,Z,Qn.disabled,_e,ze,be,r.id,Q.vertexBuffer,Q.indexBuffer,Q.segments,r.paint,p.transform.zoom,void 0,ye,m.instancedDataArray.length);else{const De=G?"u_instance":"u_normal_matrix";for(let $e=0;$e<m.instancedDataArray.length;++$e)be[De]=new Float32Array(m.instancedDataArray.arrayBuffer,64*$e,16),fe.draw(p,N.gl.TRIANGLES,Z,Qn.disabled,_e,ze,be,r.id,Q.vertexBuffer,Q.indexBuffer,Q.segments,r.paint,p.transform.zoom,void 0,ye)}}if(l.children)for(const Q of l.children)lf(p,r,Q,m,w,T,I)}const fd=[1,-1,1];function xp(p,r,l,m){if(!l.modelManager)return!0;const w=l.modelManager;if(!l.shadowRenderer)return!0;const T=l.shadowRenderer,I=r.aabb;let N=!0,G=p.maxHeight;if(G===0){let Z=0;for(const J in p.instancesPerModel){const Q=w.getModel(J,m);Q?Z=Math.max(Z,Math.max(Math.max(Q.aabb.max[0],Q.aabb.max[1]),Q.aabb.max[2])):N=!1}G=p.maxScale*Z*1.41+p.maxVerticalOffset,N&&(p.maxHeight=G)}I.max[2]=G,I.min[2]+=p.terrainElevationMin,I.max[2]+=p.terrainElevationMax,i.ab.vec3.transformMat4(I.min,I.min,r.tileMatrix),i.ab.vec3.transformMat4(I.max,I.max,r.tileMatrix);const X=I.intersects(T.getCurrentCascadeFrustum());return l.currentShadowCascade===0&&(p.isInsideFirstShadowMapFrustum=X===2),X===0}function Sc(p,r){const l=p.uniformValues.u_cutoff_params[0],m=p.uniformValues.u_cutoff_params[1],w=p.uniformValues.u_cutoff_params[2],T=p.uniformValues.u_cutoff_params[3];return m===l||T===w?1:i.aw(((r-l)/(m-l)-w)/(T-w),0,1)}function Am(p,r,l,m){if(r.pitch<20)return 1;const w=r.getWorldToCameraMatrix();i.ab.mat4.multiply(w,w,p);const T=i.ab.vec4.fromValues(l.min[0],l.min[1],l.min[2],1);let I=i.ab.vec4.transformMat4(i.ab.vec4.create(),T,w),N=I,G=I;T[1]=l.max[1],I=i.ab.vec4.transformMat4(i.ab.vec4.create(),T,w),N=I[1]<N[1]?I:N,G=I[1]>G[1]?I:G,T[0]=l.max[0],I=i.ab.vec4.transformMat4(i.ab.vec4.create(),T,w),N=I[1]<N[1]?I:N,G=I[1]>G[1]?I:G,T[1]=l.min[1],I=i.ab.vec4.transformMat4(i.ab.vec4.create(),T,w),N=I[1]<N[1]?I:N,G=I[1]>G[1]?I:G;const X=i.aw(m[0],0,1),Z=100*r.pixelsPerMeter*i.aw(m[1],0,1),J=i.aw(m[2],0,1),Q=i.ab.vec4.lerp(i.ab.vec4.create(),N,G,X),ae=Math.tan(.5*r.fovX),ye=-Q[2]*ae;if(Z===0)return Q[1]<-Math.abs(ye)?J:1;const fe=(-Math.abs(ye)-Q[1])/Z,be=(Ce,ze,De)=>(1-De)*Ce+De*ze,_e=i.aw(be(1,J,fe),J,1);return be(1,_e,i.aw((r.pitch-20)/20,0,1))}class Tc{}class bp{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(r,l,m){{const J=this._storage.get(l.id);if(J)return J.lastUsedFrameIdx=r,J.buf}const w=m.gl,T=w.getBufferParameter(w.ELEMENT_ARRAY_BUFFER,w.BUFFER_SIZE),I=new ArrayBuffer(T),N=new Int16Array(I);w.getBufferSubData(w.ELEMENT_ARRAY_BUFFER,0,new Int16Array(I));const G=new i.dq;for(let J=0;J<T/2;J+=3){const Q=N[J],ae=N[J+1],ye=N[J+2];G.emplaceBack(Q,ae),G.emplaceBack(ae,ye),G.emplaceBack(ye,Q)}const X=m.bindVertexArrayOES.current,Z=new Tc;return Z.buf=new ul(m,G),Z.lastUsedFrameIdx=r,this._storage.set(l.id,Z),m.bindVertexArrayOES.set(X),Z.buf}update(r){for(const[l,m]of this._storage)r-m.lastUsedFrameIdx>30&&(m.buf.destroy(),this._storage.delete(l))}destroy(){for(const[r,l]of this._storage)l.buf.destroy(),this._storage.delete(r)}}class Ec{constructor(r){this.occluderSize=30,this.depthOffset=-1e-4,r.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),r.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const dd=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class uf{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class Ja{constructor(r,l){this.revealStart=11,this.revealRange=2,r.registerParameter(this,[...l,"Reveal"],"revealStart",{min:0,max:17,step:.05}),r.registerParameter(this,[...l,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const wp=i.da([{type:"Float32",name:"a_pos_2f",components:2}]);class fl{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(r,l){const m=r.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const I=new i.dr,N=new i.aU;I.emplaceBack(-1,-1),I.emplaceBack(1,-1),I.emplaceBack(1,1),I.emplaceBack(-1,1),N.emplaceBack(0,1,2),N.emplaceBack(0,2,3),this.vignetteVx=r.context.createVertexBuffer(I,wp.members),this.vignetteIdx=r.context.createIndexBuffer(N)}const w=i.b7.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){r.uploadCommonUniforms(r.context,m);const I={u_vignetteShape:(T={vignetteShape:[l.start,l.range,Math.pow(10,l.fadePower)],vignetteColor:[l.color.r,l.color.g,l.color.b,l.color.a*l.strength]}).vignetteShape,u_vignetteColor:T.vignetteColor};m.draw(r,r.context.gl.TRIANGLES,qn.disabled,Qn.disabled,vr.alphaBlended,Wn.disabled,I,"vignette",this.vignetteVx,this.vignetteIdx,w,{})}var T}}class Nl{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(r,l){const m=r.getFreeCameraOptions().position,w=m.toAltitude(),T=m.toLngLat(),I=i.ai(T.lng),N=i.ai(T.lat),G=r.pixelsPerMeter/l,X=I*i.ds,Z=i.ds*Math.log(Math.tan(Math.PI/4+N/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const J=-this._offsetYPrev+Z,Q=-this._elevationPrev+w;this._accumulatedOffsetX+=(-this._offsetXPrev+X)*G,this._accumulatedOffsetY+=J*G,this._accumulatedElevation+=Q*G,this._offsetXPrev=X,this._offsetYPrev=Z,this._elevationPrev=w}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function es(p,r){return[-(p[0]-Math.floor(p[0]/r)*r),-(p[1]-Math.floor(p[1]/r)*r),-(p[2]-Math.floor(p[2]/r)*r)]}function pu(p){const r=i.di(1323123451230),l=[];for(let m=0;m<p;++m){const w=2*r()-1,T=2*r()-1,I=2*r()-1;l.push(i.ab.vec3.fromValues(w,T,I))}return l}function dl(p,r,l,m,w){const T=i.aw((w-l)/(m-l),0,1);return(1-T)*p+T*r}class cf{constructor(r){this._movement=new Nl,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new fl,this._ppmScaleFactor=r}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(r,l){const m=r.transform;this._movement.update(m,this._ppmScaleFactor);const w=m.starsProjMatrix,T=i.ab.quat.identity([]);i.ab.quat.rotateX(T,T,i.ai(90)-m._pitch),i.ab.quat.rotateZ(T,T,-m.angle);const I=i.ab.mat4.fromQuat(new Float32Array(16),T),N=i.ab.mat4.fromValues(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),G=i.ab.mat4.transpose([],N),X=i.ab.mat4.multiply([],G,I),Z=Date.now()/1e3;return this._accumulatedTimeFromStart+=(Z-this._prevTime)*l,this._prevTime=Z,{projectionMatrix:w,modelviewMatrix:X}}}class ch extends cf{constructor(r){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new Ja(r.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(r){const l=r.context;if(!this.particlesVx){const m=pu(this.particlesCount),w=new i.dt,T=new i.aU;let I=0;const N=i.di(1323123451230);for(let G=0;G<m.length;++G){const X=m[G],Z=[2*N()-1,N(),N(),N()];w.emplaceBack(X[0],X[1],X[2],-1,-1,...Z),w.emplaceBack(X[0],X[1],X[2],1,-1,...Z),w.emplaceBack(X[0],X[1],X[2],1,1,...Z),w.emplaceBack(X[0],X[1],X[2],-1,1,...Z),T.emplaceBack(I+0,I+1,I+2),T.emplaceBack(I+0,I+2,I+3),I+=4}this.particlesVx=l.createVertexBuffer(w,dd.members),this.particlesIdx=l.createIndexBuffer(T)}}draw(r){if(!this._params.overrideStyleParameters&&!r.style.rain)return;const l=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},m=r.transform.zoom;if(l.revealStart>m)return;const w=dl(0,1,l.revealStart,l.revealStart+l.revealRange,m);if(!this.particlesVx||!this.particlesIdx)return;const T=structuredClone(this._params);let I=[-T.direction.x,T.direction.y,-100];i.ab.vec3.normalize(I,I);const N=structuredClone(this._vignetteParams);N.strength*=w,T.overrideStyleParameters||(T.intensity=r.style.rain.state.density,T.timeFactor=r.style.rain.state.intensity,T.color=structuredClone(r.style.rain.state.color),I=structuredClone(r.style.rain.state.direction),T.screenThinning.intensity=r.style.rain.state.centerThinning,T.dropletSizeX=r.style.rain.state.dropletSize[0],T.dropletSizeYScale=r.style.rain.state.dropletSize[1]/r.style.rain.state.dropletSize[0],T.distortionStrength=100*r.style.rain.state.distortionStrength,N.strength=1,N.color=structuredClone(r.style.rain.state.vignetteColor));const G=this.updateOnRender(r,T.timeFactor),X=r.context,Z=X.gl,J=r.transform;this.screenTexture&&this.screenTexture.size[0]===r.width&&this.screenTexture.size[1]===r.height||(this.screenTexture=new i.T(X,{width:r.width,height:r.height,data:null},Z.RGBA8)),T.distortionStrength>0&&(X.activeTexture.set(Z.TEXTURE0),this.screenTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),Z.copyTexSubImage2D(Z.TEXTURE_2D,0,0,0,0,0,r.width,r.height));const Q=r.getOrCreateProgram("rainParticle");r.uploadCommonUniforms(X,Q),X.activeTexture.set(Z.TEXTURE0),this.screenTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE);const ae=[T.color.r,T.color.g,T.color.b,T.color.a],ye=(fe,be)=>{const _e=es(this._movement.getPosition(),fe),Ce=T.dropletSizeX,ze=T.dropletSizeX*T.dropletSizeYScale,De=r.width/2,$e=r.height/2,je=dl(0,T.screenThinning.start,0,1,T.screenThinning.intensity),Ve=dl(.001,T.screenThinning.range,0,1,T.screenThinning.intensity),Ue=dl(0,T.screenThinning.particleOffset,0,1,T.screenThinning.intensity),Qe=(at={modelview:G.modelviewMatrix,projection:G.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:_e,velocityConeAperture:T.velocityConeAperture,velocity:T.velocity,boxSize:fe,rainDropletSize:[Ce,ze],distortionStrength:T.distortionStrength,rainDirection:I,color:ae,screenSize:[J.width,J.height],thinningCenterPos:[De,$e],thinningShape:[je,Ve,Math.pow(10,T.screenThinning.fadePower)],thinningAffectedRatio:T.screenThinning.affectedRatio,thinningParticleOffset:Ue,shapeDirectionalPower:T.shapeDirPower,shapeNormalPower:T.shapeNormalPower,mode:be?0:1},{u_modelview:Float32Array.from(at.modelview),u_projection:Float32Array.from(at.projection),u_time:at.time,u_cam_pos:at.camPos,u_texScreen:0,u_velocityConeAperture:at.velocityConeAperture,u_velocity:at.velocity,u_boxSize:at.boxSize,u_rainDropletSize:at.rainDropletSize,u_distortionStrength:at.distortionStrength,u_rainDirection:at.rainDirection,u_color:at.color,u_screenSize:at.screenSize,u_thinningCenterPos:at.thinningCenterPos,u_thinningShape:at.thinningShape,u_thinningAffectedRatio:at.thinningAffectedRatio,u_thinningParticleOffset:at.thinningParticleOffset,u_shapeDirectionalPower:at.shapeDirectionalPower,u_shapeNormalPower:at.shapeNormalPower,u_mode:at.mode});var at;const St=Math.round(T.intensity*this.particlesCount),yt=i.b7.simpleSegment(0,0,4*St,2*St);Q.draw(r,Z.TRIANGLES,qn.disabled,Qn.disabled,vr.alphaBlended,Wn.disabled,Qe,"rain_particles",this.particlesVx,this.particlesIdx,yt,{})};T.distortionStrength>0&&ye(T.boxSize,!0),ye(T.boxSize,!1),this._vignette.draw(r,N)}}const Sp=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class Uu extends cf{constructor(r){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new Ja(r.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(r){const l=r.context;if(!this.particlesVx){const m=pu(this.particlesCount),w=new i.du,T=new i.aU;let I=0;const N=i.di(1323123451230);for(let G=0;G<m.length;++G){const X=m[G],Z=N(),J=N(),Q=N(),ae=[G/m.length,Z,J,Q],ye=[N(),N()];w.emplaceBack(X[0],X[1],X[2],-1,-1,...ae,...ye),w.emplaceBack(X[0],X[1],X[2],1,-1,...ae,...ye),w.emplaceBack(X[0],X[1],X[2],1,1,...ae,...ye),w.emplaceBack(X[0],X[1],X[2],-1,1,...ae,...ye),T.emplaceBack(I+0,I+1,I+2),T.emplaceBack(I+0,I+2,I+3),I+=4}this.particlesVx=l.createVertexBuffer(w,Sp.members),this.particlesIdx=l.createIndexBuffer(T)}}draw(r){if(!this._params.overrideStyleParameters&&!r.style.snow)return;const l=structuredClone(this._params);let m=[-l.direction.x,l.direction.y,-100];i.ab.vec3.normalize(m,m);const w=structuredClone(this._vignetteParams),T=l.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},I=r.transform.zoom;if(T.revealStart>I)return;const N=dl(0,1,T.revealStart,T.revealStart+T.revealRange,I);w.strength*=N,l.overrideStyleParameters||(l.intensity=r.style.snow.state.density,l.timeFactor=r.style.snow.state.intensity,l.color=structuredClone(r.style.snow.state.color),m=structuredClone(r.style.snow.state.direction),l.screenThinning.intensity=r.style.snow.state.centerThinning,l.billboardSize=2.79*r.style.snow.state.flakeSize,w.strength=1,w.color=structuredClone(r.style.snow.state.vignetteColor));const G=this.updateOnRender(r,l.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const X=r.context,Z=X.gl,J=r.transform,Q=r.getOrCreateProgram("snowParticle");r.uploadCommonUniforms(X,Q),((ae,ye,fe)=>{const be=es(this._movement.getPosition(),ae),_e=J.width/2,Ce=J.height/2,ze=dl(0,fe.screenThinning.start,0,1,fe.screenThinning.intensity),De=dl(.001,fe.screenThinning.range,0,1,fe.screenThinning.intensity),$e=dl(0,fe.screenThinning.particleOffset,0,1,fe.screenThinning.intensity),je=(Ve={modelview:G.modelviewMatrix,projection:G.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:be,velocityConeAperture:fe.velocityConeAperture,velocity:fe.velocity,horizontalOscillationRadius:fe.horizontalOscillationRadius,horizontalOscillationRate:fe.horizontalOscillationRate,boxSize:ae,billboardSize:1*fe.billboardSize,simpleShapeParameters:[fe.shapeFadeStart,fe.shapeFadePower],screenSize:[J.width,J.height],thinningCenterPos:[_e,Ce],thinningShape:[ze,De,Math.pow(10,fe.screenThinning.fadePower)],thinningAffectedRatio:fe.screenThinning.affectedRatio,thinningParticleOffset:$e,color:[fe.color.r,fe.color.g,fe.color.b,fe.color.a],direction:m},{u_modelview:Float32Array.from(Ve.modelview),u_projection:Float32Array.from(Ve.projection),u_time:Ve.time,u_cam_pos:Ve.camPos,u_velocityConeAperture:Ve.velocityConeAperture,u_velocity:Ve.velocity,u_horizontalOscillationRadius:Ve.horizontalOscillationRadius,u_horizontalOscillationRate:Ve.horizontalOscillationRate,u_boxSize:Ve.boxSize,u_billboardSize:Ve.billboardSize,u_simpleShapeParameters:Ve.simpleShapeParameters,u_screenSize:Ve.screenSize,u_thinningCenterPos:Ve.thinningCenterPos,u_thinningShape:Ve.thinningShape,u_thinningAffectedRatio:Ve.thinningAffectedRatio,u_thinningParticleOffset:Ve.thinningParticleOffset,u_particleColor:Ve.color,u_direction:Ve.direction});var Ve;const Ue=Math.round(fe.intensity*this.particlesCount),Qe=i.b7.simpleSegment(0,0,4*Ue,2*Ue);this.particlesVx&&this.particlesIdx&&Q.draw(r,Z.TRIANGLES,qn.disabled,Qn.disabled,vr.alphaBlended,Wn.disabled,je,"snow_particles",this.particlesVx,this.particlesIdx,Qe,{})})(l.boxSize,0,l),this._vignette.draw(r,w)}}const Ac={symbol:function(p,r,l,m,w){if(p.renderPass!=="translucent")return;const T=Qn.disabled,I=p.colorModeForRenderPass(),N=l.layout.get("text-variable-anchor"),G=l.layout.get("text-size-scale-range"),X=i.aw(p.scaleFactor,G[0],G[1]);N&&function(Q,ae,ye,fe,be,_e,Ce,ze){const De=ae.transform,$e=be==="map",je=_e==="map";for(const Ve of Q){const Ue=fe.getTile(Ve),Qe=Ue.getBucket(ye);if(!Qe||!Qe.text||!Qe.text.segments.get().length)continue;const at=i.bp(Qe.textSizeData,De.zoom,ze),St=eu(Ve,Qe.getProjection(),De),yt=De.calculatePixelsToTileUnitsMatrix(Ue),jt=di(St,Ue.tileID.canonical,je,$e,De,Qe.getProjection(),yt),It=Qe.hasIconTextFit()&&Qe.hasIconData();if(at){const ft=Math.pow(2,De.zoom-Ue.tileID.overscaledZ);yc(Qe,$e,je,Ce,i.cX,De,jt,Ve,ft,at,It)}}}(m,p,l,r,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),w,X);const Z=l.paint.get("icon-opacity").constantOr(1)!==0,J=l.paint.get("text-opacity").constantOr(1)!==0;l.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(Z||J)?_c(p,r,l,m,T,I):(Z&&_c(p,r,l,m,T,I,{onlyIcons:!0}),J&&_c(p,r,l,m,T,I,{onlyText:!0})),r.map.showCollisionBoxes&&(rf(p,r,l,m,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),rf(p,r,l,m,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))},circle:function(p,r,l,m){if(p.renderPass!=="translucent")return;const w=l.paint.get("circle-opacity"),T=l.paint.get("circle-stroke-width"),I=l.paint.get("circle-stroke-opacity"),N=l.layout.get("circle-sort-key").constantOr(1)!==void 0,G=l.paint.get("circle-emissive-strength");if(w.constantOr(1)===0&&(T.constantOr(1)===0||I.constantOr(1)===0))return;const X=p.context,Z=X.gl,J=p.transform,Q=p.depthModeForSublayer(0,qn.ReadOnly),ae=Qn.disabled,ye=p.colorModeForDrapableLayerRenderPass(G),fe=J.projection.name==="globe",be=[i.at(J.center.lng),i.aA(J.center.lat)],_e=[];for(let ze=0;ze<m.length;ze++){const De=m[ze],$e=r.getTile(De),je=$e.getBucket(l);if(!je||je.projection.name!==J.projection.name)continue;const Ve=je.programConfigurations.get(l.id),Ue=i.cY(l),Qe=p.isTileAffectedByFog(De);fe&&Ue.push("PROJECTION_GLOBE_VIEW"),Ue.push("DEPTH_D24"),p.terrain&&J.depthOcclusionForSymbolsAndCircles&&Ue.push("DEPTH_OCCLUSION");const at=p.getOrCreateProgram("circle",{config:Ve,defines:Ue,overrideFog:Qe}),St=je.layoutVertexBuffer,yt=je.globeExtVertexBuffer,jt=je.indexBuffer,It=J.projection.createInversionMatrix(J,De.canonical),ft={programConfiguration:Ve,program:at,layoutVertexBuffer:St,globeExtVertexBuffer:yt,indexBuffer:jt,uniformValues:i.cZ(p,De,$e,It,be,l),tile:$e};if(N){const At=je.segments.get();for(const Qt of At)_e.push({segments:new i.b7([Qt]),sortKey:Qt.sortKey,state:ft})}else _e.push({segments:je.segments,sortKey:0,state:ft})}N&&_e.sort((ze,De)=>ze.sortKey-De.sortKey);const Ce={useDepthForOcclusion:J.depthOcclusionForSymbolsAndCircles};for(const ze of _e){const{programConfiguration:De,program:$e,layoutVertexBuffer:je,globeExtVertexBuffer:Ve,indexBuffer:Ue,uniformValues:Qe,tile:at}=ze.state,St=ze.segments;p.terrain&&p.terrain.setupElevationDraw(at,$e,Ce),p.uploadCommonUniforms(X,$e,at.tileID.toUnwrapped()),$e.draw(p,Z.TRIANGLES,Q,ae,ye,Wn.disabled,Qe,l.id,je,Ue,St,l.paint,J.zoom,De,[Ve])}},heatmap:function(p,r,l,m){if(l.paint.get("heatmap-opacity")!==0)if(p.renderPass==="offscreen"){const w=p.context,T=w.gl,I=Qn.disabled,N=new vr([T.ONE,T.ONE,T.ONE,T.ONE],i.aj.transparent,[!0,!0,!0,!0]);(function(ae,ye,fe,be){const _e=ae.gl,Ce=ye.width*be,ze=ye.height*be;ae.activeTexture.set(_e.TEXTURE1),ae.viewport.set([0,0,Ce,ze]);let De=fe.heatmapFbo;if(!De||De&&(De.width!==Ce||De.height!==ze)){De&&De.destroy();const $e=_e.createTexture();_e.bindTexture(_e.TEXTURE_2D,$e),_e.texParameteri(_e.TEXTURE_2D,_e.TEXTURE_WRAP_S,_e.CLAMP_TO_EDGE),_e.texParameteri(_e.TEXTURE_2D,_e.TEXTURE_WRAP_T,_e.CLAMP_TO_EDGE),_e.texParameteri(_e.TEXTURE_2D,_e.TEXTURE_MIN_FILTER,_e.LINEAR),_e.texParameteri(_e.TEXTURE_2D,_e.TEXTURE_MAG_FILTER,_e.LINEAR),De=fe.heatmapFbo=ae.createFramebuffer(Ce,ze,!0,null),function(je,Ve,Ue,Qe,at,St){const yt=je.gl;yt.texImage2D(yt.TEXTURE_2D,0,je.extRenderToTextureHalfFloat?yt.RGBA16F:yt.RGBA,at,St,0,yt.RGBA,je.extRenderToTextureHalfFloat?yt.HALF_FLOAT:yt.UNSIGNED_BYTE,null),Qe.colorAttachment.set(Ue)}(ae,0,$e,De,Ce,ze)}else _e.bindTexture(_e.TEXTURE_2D,De.colorAttachment.get()),ae.bindFramebuffer.set(De.framebuffer)})(w,p,l,p.transform.projection.name==="globe"?.5:.25),w.clear({color:i.aj.transparent});const G=p.transform,X=G.projection.name==="globe",Z=X?["PROJECTION_GLOBE_VIEW"]:[],J=X?Wn.frontCCW:Wn.disabled,Q=[i.at(G.center.lng),i.aA(G.center.lat)];for(let ae=0;ae<m.length;ae++){const ye=m[ae];if(r.hasRenderableParent(ye))continue;const fe=r.getTile(ye),be=fe.getBucket(l);if(!be||be.projection.name!==G.projection.name)continue;const _e=p.isTileAffectedByFog(ye),Ce=be.programConfigurations.get(l.id),ze=p.getOrCreateProgram("heatmap",{config:Ce,defines:Z,overrideFog:_e}),{zoom:De}=p.transform;p.terrain&&p.terrain.setupElevationDraw(fe,ze),p.uploadCommonUniforms(w,ze,ye.toUnwrapped());const $e=G.projection.createInversionMatrix(G,ye.canonical);ze.draw(p,T.TRIANGLES,qn.disabled,I,N,J,In(p,ye,fe,$e,Q,De,l.paint.get("heatmap-intensity")),l.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,l.paint,p.transform.zoom,Ce,X?[be.globeExtVertexBuffer]:null)}w.viewport.set([0,0,p.width,p.height])}else p.renderPass==="translucent"&&(p.context.setColorMode(p.colorModeForRenderPass()),function(w,T){const I=w.context,N=I.gl,G=T.heatmapFbo;if(!G)return;I.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,G.colorAttachment.get()),I.activeTexture.set(N.TEXTURE1);let X=T.colorRampTexture;X||(X=T.colorRampTexture=new i.T(I,T.colorRamp,N.RGBA8)),X.bind(N.LINEAR,N.CLAMP_TO_EDGE),w.getOrCreateProgram("heatmapTexture").draw(w,N.TRIANGLES,qn.disabled,Qn.disabled,w.colorModeForRenderPass(),Wn.disabled,((Z,J,Q,ae)=>({u_image:0,u_color_ramp:1,u_opacity:J.paint.get("heatmap-opacity")}))(0,T),T.id,w.viewportBuffer,w.quadTriangleIndexBuffer,w.viewportSegments,T.paint,w.transform.zoom)}(p,l))},line:function(p,r,l,m){if(p.renderPass!=="translucent")return;const w=l.paint.get("line-opacity"),T=l.paint.get("line-width");if(w.constantOr(1)===0||T.constantOr(1)===0)return;const I=l.paint.get("line-emissive-strength"),N=l.paint.get("line-occlusion-opacity"),G=l.layout.get("line-elevation-reference"),X=l.layout.get("line-width-unit")==="meters",Z=G==="sea",J=p.context,Q=J.gl;if(l.hasElevatedBuckets&&p.transform.projection.name==="globe")return;const ae=l.layout.get("line-cross-slope"),ye=ae!==void 0,fe=ae<1,be=p.colorModeForDrapableLayerRenderPass(I),_e=p.terrain&&p.terrain.renderingToTexture,Ce=_e?1:i.q.devicePixelRatio,ze=l.paint.get("line-dasharray"),De=ze.constantOr(1),$e=l.layout.get("line-cap"),je=ze.constantOr(null),Ve=$e.constantOr(null),Ue=l.paint.get("line-pattern"),Qe=Ue.constantOr(1),at=Ue.constantOr(null),St=l.paint.get("line-opacity").constantOr(1);let yt=!Qe&&St!==1||p.depthOcclusion&&N>0&&N<1;const jt=l.paint.get("line-gradient"),It=Qe?"linePattern":"line",ft=i.c_(l);let At;if(_e&&p.terrain&&p.terrain.clipOrMaskOverlapStencilType()&&(yt=!1),N!==0&&p.depthOcclusion){const ht=l.paint._values["line-opacity"];ht&&ht.value&&ht.value.kind==="constant"?At=ht.value:i.w(`Occlusion opacity for layer ${l.id} is supported only when line-opacity isn't data-driven.`)}T.value.kind!=="constant"&&T.value.isLineProgressConstant===!1&&ft.push("VARIABLE_LINE_WIDTH");const Qt=(ht,zt,Mt,ln,Yt)=>{for(const Ut of ht){const tn=r.getTile(Ut);if(Qe&&!tn.patternsLoaded())continue;const fn=tn.getBucket(l);if(!fn||fn.hasZOffset&&!Yt||!fn.hasZOffset&&Yt)continue;p.prepareDrawTile();const wn=fn.programConfigurations.get(l.id),Cn=p.isTileAffectedByFog(Ut),Yn=p.getOrCreateProgram(It,{config:wn,defines:zt,overrideFog:Cn,overrideRtt:!Yt&&void 0});if(at&&tn.imageAtlas){const ur=i.A.from(at).getPrimary().scaleSelf(Ce).serialize(),$r=tn.imageAtlas.patternPositions[ur];$r&&wn.setConstantPatternPositions($r)}if(!Qe&&je&&Ve&&tn.lineAtlas){const ur=tn.lineAtlas.getDash(je,Ve);ur&&wn.setConstantPatternPositions(ur)}let[Gn,Un]=l.paint.get("line-trim-offset");(Ve==="round"||Ve==="square")&&Gn!==Un&&(Gn===0&&(Gn-=1),Un===1&&(Un+=1));const tr=_e?Ut.projMatrix:null,nr=X?1/fn.tileToMeter/i.ar(tn,1,p.transform.zoom):1,ri=X?1/fn.tileToMeter/i.ar(tn,1,Math.floor(p.transform.zoom)):1,Zi=Qe?i.c$(p,tn,l,tr,Ce,nr,ri,[Gn,Un]):i.d0(p,tn,l,tr,fn.lineClipsArray.length,Ce,nr,ri,[Gn,Un]);if(jt){const ur=fn.gradients[l.id];let $r=ur.texture;if(l.gradientVersion!==ur.version){let Sn=256;if(l.stepInterpolant){const Kn=r.getSource().maxzoom,Zn=Ut.canonical.z===Kn?Math.ceil(1<<p.transform.maxZoom-Ut.canonical.z):1;Sn=i.aw(i.d1(fn.maxLineLength/i.ag*1024*Zn),256,J.maxTextureSize)}ur.gradient=i.d2({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:Sn,image:ur.gradient||void 0,clips:fn.lineClipsArray}),ur.texture?ur.texture.update(ur.gradient):ur.texture=new i.T(J,ur.gradient,Q.RGBA8),ur.version=l.gradientVersion,$r=ur.texture}J.activeTexture.set(Q.TEXTURE1),$r.bind(l.stepInterpolant?Q.NEAREST:Q.LINEAR,Q.CLAMP_TO_EDGE)}De&&(J.activeTexture.set(Q.TEXTURE0),tn.lineAtlasTexture&&tn.lineAtlasTexture.bind(Q.LINEAR,Q.REPEAT),wn.updatePaintBuffers()),Qe&&(J.activeTexture.set(Q.TEXTURE0),tn.imageAtlasTexture&&tn.imageAtlasTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),wn.updatePaintBuffers()),Yt&&!Z&&p.terrain.setupElevationDraw(tn,Yn),p.uploadCommonUniforms(J,Yn,Ut.toUnwrapped());const wi=ur=>{At!=null&&(At.value=St*N),Yn.draw(p,Q.TRIANGLES,Mt,ur,be,Wn.disabled,Zi,l.id,fn.layoutVertexBuffer,fn.indexBuffer,fn.segments,l.paint,p.transform.zoom,wn,[fn.layoutVertexBuffer2,fn.patternVertexBuffer,fn.zOffsetVertexBuffer]),At!=null&&(At.value=St)};if(yt&&!Yt){const ur=p.stencilModeForClipping(Ut).ref;ur===0&&_e&&J.clear({stencil:0});const $r={func:Q.EQUAL,mask:255};Zi.u_alpha_discard_threshold=.8,wi(new Qn($r,ur,255,Q.KEEP,Q.KEEP,Q.INVERT)),Zi.u_alpha_discard_threshold=0,wi(new Qn($r,ur,255,Q.KEEP,Q.KEEP,Q.KEEP))}else yt&&Yt&&(Zi.u_alpha_discard_threshold=.001),wi(Yt?ln:p.stencilModeForClipping(Ut))}};if(l.hasNonElevatedBuckets){const ht=!_e&&p.terrain;N!==0&&ht?i.w(`Occlusion opacity for layer ${l.id} is supported on terrain only if the layer has line-z-offset enabled.`):ht?i.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${l.id}.`):Qt(m,ft,p.depthModeForSublayer(0,qn.ReadOnly),Qn.disabled,!1)}if(l.hasElevatedBuckets){ft.push("ELEVATED"),ye&&ft.push(fe?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),Z&&ft.push("ELEVATION_REFERENCE_SEA");const ht=yt?p.stencilModeFor3D():Qn.disabled,zt=new qn(p.depthOcclusion?Q.GREATER:Q.LEQUAL,qn.ReadOnly,p.depthRangeFor3D);p.forceTerrainMode=!0,Qt(m,ft,zt,ht,!0),p.forceTerrainMode=!1}yt&&(p.resetStencilClippingMasks(),_e&&J.clear({stencil:0})),N===0||p.depthOcclusion||_e||p.layersWithOcclusionOpacity.push(p.currentLayer)},fill:function(p,r,l,m){const w=l.paint.get("fill-color"),T=l.paint.get("fill-opacity"),I=l.is3D(),N=new qn(p.context.gl.LEQUAL,qn.ReadWrite,p.depthRangeFor3D);if(T.constantOr(1)===0)return;const G=l.paint.get("fill-emissive-strength"),X=p.colorModeForDrapableLayerRenderPass(G),Z=l.paint.get("fill-pattern"),J=p.opaquePassEnabledForLayer()&&!Z.constantOr(1)&&w.constantOr(i.aj.transparent).a===1&&T.constantOr(0)===1?"opaque":"translucent";if(p.renderPass===J){const Q=I?N:p.depthModeForSublayer(1,p.renderPass==="opaque"?qn.ReadWrite:qn.ReadOnly);Ll(p,r,l,m,Q,X,!1)}if(!I&&p.renderPass==="translucent"&&l.paint.get("fill-antialias")){const Q=I?N:p.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,qn.ReadOnly);Ll(p,r,l,m,Q,X,!0)}},"fill-extrusion":function(p,r,l,m){const w=l.paint.get("fill-extrusion-opacity"),T=p.context,I=T.gl,N=p.terrain,G=N&&N.renderingToTexture;if(w===0)return;const X=p.conflationActive&&p.style.isLayerClipped(l,r.getSource()),Z=p.style.order.indexOf(l.fqid);if(X&&function(J,Q,ae,ye,fe){for(const be of ye){const _e=Q.getTile(be).getBucket(ae);_e&&(_e.updateReplacement(be,J.replacementSource,fe),_e.uploadCentroid(J.context))}}(p,r,l,m,Z),N||X)for(const J of m){const Q=r.getTile(J).getBucket(l);Q&&bc(p.context,r,J,Q,l,N,X)}if(p.renderPass==="shadow"&&p.shadowRenderer){const J=p.shadowRenderer;if(N&&w<.65&&l._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof i.a9)return;const Q=J.getShadowPassDepthMode(),ae=J.getShadowPassColorMode();vc(p,r,l,m,Q,Qn.disabled,ae,X)}else if(p.renderPass==="translucent"){const J=!l.paint.get("fill-extrusion-pattern").constantOr(1),Q=l.paint.get("fill-extrusion-color").constantOr(i.aj.white);if(!G&&Q.a!==0){const ae=new qn(p.context.gl.LEQUAL,qn.ReadWrite,p.depthRangeFor3D);w===1&&J?vc(p,r,l,m,ae,Qn.disabled,vr.unblended,X):(vc(p,r,l,m,ae,Qn.disabled,vr.disabled,X),vc(p,r,l,m,ae,p.stencilModeFor3D(),p.colorModeForRenderPass(),X),p.resetStencilClippingMasks())}if(p.style.enable3dLights()&&J&&(!N&&p.transform.projection.name!=="globe"||G)){const ae=l.paint.get("fill-extrusion-opacity"),ye=l.paint.get("fill-extrusion-ambient-occlusion-intensity"),fe=l.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),be=l.paint.get("fill-extrusion-flood-light-intensity"),_e=l.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Ce=l.paint.get("fill-extrusion-flood-light-color").toRenderColor(_e?null:l.lut).toArray01().slice(0,3),ze=ye>0&&fe>0,De=be>0,$e=(Ve,Ue,Qe)=>(1-Qe)*Ve+Qe*Ue,je=Ve=>{const Ue=p.depthModeForSublayer(1,qn.ReadOnly,I.LEQUAL,!0),Qe=l.paint.get(Ve?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),at=$e(.1,3,Qe),St=p._showOverdrawInspector;if(!St){const yt=new Qn({func:I.ALWAYS,mask:255},255,255,I.KEEP,I.KEEP,I.REPLACE),jt=new vr([I.ONE,I.ONE,I.ONE,I.ONE],i.aj.transparent,[!1,!1,!1,!0],I.MIN);xc(p,r,l,m,Ue,yt,jt,Wn.disabled,Ve,"sdf",ae,ye,fe,be,Ce,at,X,!1)}{const yt=St?Qn.disabled:new Qn({func:I.EQUAL,mask:255},255,255,I.KEEP,I.DECR,I.DECR),jt=St?p.colorModeForRenderPass():new vr([I.ONE_MINUS_DST_ALPHA,I.DST_ALPHA,I.ONE,I.ONE],i.aj.transparent,[!0,!0,!0,!0]);xc(p,r,l,m,Ue,yt,jt,Wn.disabled,Ve,"color",ae,ye,fe,be,Ce,at,X,!1)}};if(G){const Ve=(Ue,Qe,at)=>{const St=p.depthModeForSublayer(1,qn.ReadOnly,I.LEQUAL,!1),yt=l.paint.get(Ue?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),jt=$e(.1,3,yt);{const It=new vr([I.ONE,I.ONE,I.ONE,I.ONE],i.aj.transparent,[!1,!1,!1,!0]);xc(p,r,l,m,St,Qn.disabled,It,Wn.disabled,Ue,"clear",ae,ye,fe,be,Ce,jt,X,Qe)}{const It=new Qn({func:I.ALWAYS,mask:255},255,255,I.KEEP,I.KEEP,I.REPLACE),ft=new vr([I.ONE,I.ONE,I.ONE,I.ONE],i.aj.transparent,[!1,!1,!1,!0],I.MIN);xc(p,r,l,m,St,It,ft,Wn.disabled,Ue,"sdf",ae,ye,fe,be,Ce,jt,X,Qe)}{const It=Ue?I.ZERO:I.ONE_MINUS_DST_ALPHA,ft=new Qn({func:I.EQUAL,mask:255},255,255,I.KEEP,I.DECR,I.DECR),At=new vr([It,I.DST_ALPHA,I.ONE_MINUS_DST_ALPHA,I.ZERO],i.aj.transparent,[!0,!0,!0,!0]);xc(p,r,l,m,St,ft,At,Wn.disabled,Ue,"color",ae,ye,fe,be,Ce,jt,X,Qe)}{const It=new vr([I.ONE,I.ONE,I.ONE,Ue?I.ZERO:I.ONE],i.aj.transparent,[!1,!1,!1,!0],Ue?I.FUNC_ADD:I.MAX);xc(p,r,l,m,St,Qn.disabled,It,Wn.disabled,Ue,"clear",ae,ye,fe,be,Ce,jt,X,Qe,at)}};if(ze||De){let Ue;if(p.prepareDrawTile(),N){const Qe=N.drapeBufferSize[0],at=N.drapeBufferSize[1];Ue=N.framebufferCopyTexture,Ue&&(!Ue||Ue.size[0]===Qe&&Ue.size[1]===at)||(Ue&&Ue.destroy(),Ue=N.framebufferCopyTexture=new i.T(T,new i.r({width:Qe,height:at}),I.RGBA8)),Ue.bind(I.LINEAR,I.CLAMP_TO_EDGE),I.copyTexSubImage2D(I.TEXTURE_2D,0,0,0,0,0,Qe,at)}ze&&Ve(!0,!1,Ue),De&&Ve(!1,!0,Ue)}}else ze&&je(!0),De&&je(!1),(ze||De)&&p.resetStencilClippingMasks()}}},hillshade:function(p,r,l,m){if(p.renderPass!=="offscreen"&&p.renderPass!=="translucent"||p.style.disableElevatedTerrain)return;const w=p.context,T=p.terrain&&p.terrain.renderingToTexture,[I,N]=p.renderPass!=="translucent"||T?[{},m]:p.stencilConfigForOverlap(m);for(const G of N){const X=r.getTile(G);if(X.needsHillshadePrepare&&p.renderPass==="offscreen")Gh(p,X,l);else if(p.renderPass==="translucent"){const Z=p.depthModeForSublayer(0,qn.ReadOnly),J=l.paint.get("hillshade-emissive-strength"),Q=p.colorModeForDrapableLayerRenderPass(J),ae=T&&p.terrain?p.terrain.stencilModeForRTTOverlap(G):I[G.overscaledZ];qs(p,G,X,l,Z,ae,Q)}}w.viewport.set([0,0,p.width,p.height]),p.resetStencilClippingMasks()},raster:function(p,r,l,m,w,T){if(p.renderPass!=="translucent"||l.paint.get("raster-opacity")===0)return;const I=p.transform.projection.name==="globe",N=l.paint.get("raster-elevation")!==0,G=N&&I;if(p.renderElevatedRasterBackface&&!G)return;const X=p.context,Z=X.gl,J=r.getSource(),Q=function(je,Ve,Ue,Qe){const at=Ve.paint.get("raster-color"),St=je.type==="raster-array",yt=[],jt=Ve.paint.get("raster-resampling"),It=Ve.paint.get("raster-color-mix");let ft=Ve.paint.get("raster-color-range");const At=[It[0],It[1],It[2],0],Qt=It[3];let ht=jt==="nearest"?Qe.NEAREST:Qe.LINEAR;if(St&&(yt.push("RASTER_ARRAY"),at||yt.push("RASTER_COLOR"),jt==="linear"&&yt.push("RASTER_ARRAY_LINEAR"),ht=Qe.NEAREST,!ft&&je.rasterLayers)){const zt=je.rasterLayers.find(({id:Mt})=>Mt===Ve.sourceLayer);zt&&zt.fields&&zt.fields.range&&(ft=zt.fields.range)}if(ft=ft||[0,1],at){yt.push("RASTER_COLOR"),Ue.activeTexture.set(Qe.TEXTURE2),Ve.updateColorRamp(ft);let zt=Ve.colorRampTexture;zt||(zt=Ve.colorRampTexture=new i.T(Ue,Ve.colorRamp,Qe.RGBA8)),zt.bind(Qe.LINEAR,Qe.CLAMP_TO_EDGE)}return{mix:At,range:ft,offset:Qt,defines:yt,resampling:ht}}(J,l,X,Z);if(J instanceof i.aJ&&!m.length&&!I)return;const ae=l.paint.get("raster-emissive-strength"),ye=p.colorModeForDrapableLayerRenderPass(ae),fe=p.terrain&&p.terrain.renderingToTexture,be=!p.options.moving,_e=l.paint.get("raster-resampling")==="nearest"?Z.NEAREST:Z.LINEAR;if(J instanceof i.aJ&&!m.length&&(J.onNorthPole||J.onSouthPole)){const je=N?p.stencilModeFor3D():Qn.disabled;return void _t(!!J.onNorthPole,null,p,r,l,ae,Q,Wn.disabled,je)}if(!m.length)return;const[Ce,ze]=J instanceof i.aJ||fe?[{},m]:p.stencilConfigForOverlap(m),De=ze[ze.length-1].overscaledZ;G&&Q.defines.push("PROJECTION_GLOBE_VIEW"),N&&Q.defines.push("RENDER_CUTOFF");const $e=(je,Ve,Ue)=>{for(const Qe of je){const at=Qe.toUnwrapped(),St=r.getTile(Qe);if(fe&&(!St||!St.hasData()))continue;X.activeTexture.set(Z.TEXTURE0);const yt=sd(St,J,l,Q);if(!yt||!yt.texture)continue;const{texture:jt,mix:It,offset:ft,tileSize:At,buffer:Qt}=yt;let ht,zt;fe?(ht=qn.disabled,zt=Qe.projMatrix):N?(ht=new qn(Z.LEQUAL,qn.ReadWrite,p.depthRangeFor3D),zt=I?Float32Array.from(p.transform.expandedFarZProjMatrix):p.transform.calculateProjMatrix(at,be)):(ht=p.depthModeForSublayer(Qe.overscaledZ-De,l.paint.get("raster-opacity")===1?qn.ReadWrite:qn.ReadOnly,Z.LESS),zt=p.transform.calculateProjMatrix(at,be));const Mt=p.terrain&&fe?p.terrain.stencilModeForRTTOverlap(Qe):Ce[Qe.overscaledZ],ln=T?0:l.paint.get("raster-fade-duration");St.registerFadeDuration(ln);const Yt=r.findLoadedParent(Qe,0),Ut=Uo(St,Yt,r,p.transform,ln);let tn,fn;p.terrain&&p.terrain.prepareDrawTile(),X.activeTexture.set(Z.TEXTURE0),jt.bind(_e,Z.CLAMP_TO_EDGE),X.activeTexture.set(Z.TEXTURE1),Yt?(Yt.texture&&Yt.texture.bind(_e,Z.CLAMP_TO_EDGE),tn=Math.pow(2,Yt.tileID.overscaledZ-St.tileID.overscaledZ),fn=[St.tileID.canonical.x*tn%1,St.tileID.canonical.y*tn%1]):jt.bind(_e,Z.CLAMP_TO_EDGE),jt.useMipmap&&X.extTextureFilterAnisotropic&&p.transform.pitch>20&&Z.texParameterf(Z.TEXTURE_2D,X.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,X.extTextureFilterAnisotropicMax);const wn=p.transform;let Cn;const Yn=N?yp(wn):[0,0,0,0];let Gn,Un,tr,nr,ri,Zi=0;if(G&&J instanceof i.aJ&&J.coordinates.length>3)Gn=Float32Array.from(i.bb(i.cH(new i.bT(0,0,0)))),Un=Float32Array.from(wn.globeMatrix),tr=Float32Array.from(i.cD(wn)),nr=[i.at(wn.center.lng),i.aA(wn.center.lat)],Cn=J.elevatedGlobePerspectiveTransform,ri=J.elevatedGlobeGridMatrix||new Float32Array(9);else if(G){const Sn=i.cE(Qe.canonical);Zi=i.cF(Sn.getCenter().lat),Gn=Float32Array.from(i.bb(i.cH(Qe.canonical))),Un=Float32Array.from(wn.globeMatrix),tr=Float32Array.from(i.cD(wn)),nr=[i.at(wn.center.lng),i.aA(wn.center.lat)],Cn=[0,0],ri=Float32Array.from(i.cG(Qe.canonical,Sn,Zi,wn.worldSize/wn._pixelsPerMercatorPixel))}else Cn=J instanceof i.aJ?J.perspectiveTransform:[0,0],Gn=new Float32Array(16),Un=new Float32Array(9),tr=new Float32Array(16),nr=[0,0],ri=new Float32Array(9);const wi=zu(zt,Gn,Un,tr,ri,fn||[0,0],i.ae(p.transform.zoom),nr,Yn,tn||1,Ut,l,Cn,N?l.paint.get("raster-elevation"):0,2,It,ft,Q.range,At,Qt,ae),ur=p.isTileAffectedByFog(Qe),$r=p.getOrCreateProgram("raster",{defines:Q.defines,overrideFog:ur});if(p.uploadCommonUniforms(X,$r,at),J instanceof i.aJ){const Sn=J.elevatedGlobeVertexBuffer,Kn=J.elevatedGlobeIndexBuffer;if(fe||!I)J.boundsBuffer&&J.boundsSegments&&$r.draw(p,Z.TRIANGLES,ht,Qn.disabled,ye,Wn.disabled,wi,l.id,J.boundsBuffer,p.quadTriangleIndexBuffer,J.boundsSegments);else if(Sn&&Kn){const Zn=wn.zoom<=i.c6?J.elevatedGlobeSegments:J.getSegmentsForLongitude(wn.center.lng);Zn&&$r.draw(p,Z.TRIANGLES,ht,Qn.disabled,ye,Ve,wi,l.id,Sn,Kn,Zn)}}else if(G){ht=new qn(Z.LEQUAL,qn.ReadOnly,p.depthRangeFor3D);const Sn=p.globeSharedBuffers;if(Sn){const[Kn,Zn,Jn]=Sn.getGridBuffers(Zi,!1);$r.draw(p,Z.TRIANGLES,ht,Ue||Mt,p.colorModeForRenderPass(),Ve,wi,l.id,Kn,Zn,Jn)}}else{const{tileBoundsBuffer:Sn,tileBoundsIndexBuffer:Kn,tileBoundsSegments:Zn}=p.getTileBoundsBuffers(St);$r.draw(p,Z.TRIANGLES,ht,Mt,ye,Wn.disabled,wi,l.id,Sn,Kn,Zn)}}if(!(J instanceof i.aJ)&&G)for(const Qe of je){const at=Qe.canonical.y===(1<<Qe.canonical.z)-1;Qe.canonical.y===0&&_t(!0,Qe,p,r,l,ae,Q,Ve,Ue||Qn.disabled),at&&_t(!1,Qe,p,r,l,ae,Q,Ve===Wn.frontCW?Wn.backCW:Wn.frontCW,Ue||Qn.disabled)}};G?$e(ze,p.renderElevatedRasterBackface?Wn.backCW:Wn.frontCW,p.stencilModeFor3D()):$e(ze,Wn.disabled,void 0),p.resetStencilClippingMasks()},"raster-particle":function(p,r,l,m,w,T){p.renderPass==="offscreen"&&function(I,N,G,X){if(!X.length)return;const Z=I.context,J=Z.gl,Q=N.getSource();if(!(Q instanceof ta))return;const ae=Math.ceil(Math.sqrt(G.paint.get("raster-particle-count")));let ye=G.particlePositionRGBAImage;if(!ye||ye.width!==ae){const ze=function(De){const $e=De*De,je=new Uint8Array(4*$e),Ve=function(Qe){return Qe|=0,Qe=Math.imul(2747636419^Qe,2654435769),Qe=Math.imul(Qe^Qe>>>16,2654435769),((Qe=Math.imul(Qe^Qe>>>16,2654435769))>>>0)/4294967296},Ue=1/1.1;for(let Qe=0;Qe<$e;Qe++){const at=Ue*(Ve(2*Qe+0)+dn),St=Ue*(Ve(2*Qe+1)+dn),yt=255*at%1,jt=255*St%1,It=yt,ft=St-jt/255,At=jt;je[4*Qe+0]=255*(at-yt/255),je[4*Qe+1]=255*It,je[4*Qe+2]=255*ft,je[4*Qe+3]=255*At}return je}(ae);ye=G.particlePositionRGBAImage=new i.r({width:ae,height:ae},ze)}let fe=G.particleFramebuffer;fe?fe.width!==ae&&(fe.destroy(),fe=G.particleFramebuffer=Z.createFramebuffer(ae,ae,!0,null)):fe=G.particleFramebuffer=Z.createFramebuffer(ae,ae,!0,null);const be=[];for(const ze of X){const De=N.getTile(ze);if(!(De instanceof Ol))continue;const $e=bm(De,Q,G);if(!$e)continue;const je=[De.tileSize,De.tileSize];let Ve=G.tileFramebuffer;Ve||(Ve=G.tileFramebuffer=Z.createFramebuffer(je[0],je[1],!0,null));let Ue=De.rasterParticleState;Ue||(Ue=De.rasterParticleState=new xm(Z,ze,je,ye));const Qe=Ue.update(G.lastInvalidatedAt);Ue.particleTextureDimension!==ae&&Ue.updateParticleTexture(ze,ye);const at=Ue.targetColorTexture;Ue.targetColorTexture=Ue.backgroundColorTexture,Ue.backgroundColorTexture=at;const St=Ue.particleTexture0;Ue.particleTexture0=Ue.particleTexture1,Ue.particleTexture1=St,be.push([ze,$e,Ue,Qe])}if(be.length===0)return;const _e=i.q.now(),Ce=G.previousDrawTimestamp?.001*(_e-G.previousDrawTimestamp):.0167;if(G.previousDrawTimestamp=_e,G.hasColorMap()){Z.activeTexture.set(J.TEXTURE0+2);let ze=G.colorRampTexture;ze||(ze=G.colorRampTexture=new i.T(Z,G.colorRamp,J.RGBA8)),ze.bind(J.LINEAR,J.CLAMP_TO_EDGE)}Z.bindFramebuffer.set(G.tileFramebuffer.framebuffer),function(ze,De,$e){const je=ze.context,Ve=je.gl,Ue=De.tileFramebuffer;je.activeTexture.set(Ve.TEXTURE0);const Qe={u_texture:0,u_opacity:1.05*(St=De.paint.get("raster-particle-fade-opacity-factor"))/(St+.05)},at=ze.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var St;for(const yt of $e){const[,,jt,It]=yt;Ue.colorAttachment.set(jt.targetColorTexture.texture),je.viewport.set([0,0,Ue.width,Ue.height]),je.clear({color:i.aj.transparent}),It&&(jt.backgroundColorTexture.bind(Ve.NEAREST,Ve.CLAMP_TO_EDGE),at.draw(ze,Ve.TRIANGLES,qn.disabled,Qn.disabled,vr.alphaBlended,Wn.disabled,Qe,De.id,ze.viewportBuffer,ze.quadTriangleIndexBuffer,ze.viewportSegments))}}(I,G,be),function(ze,De,$e,je){const Ve=ze.context,Ue=Ve.gl,Qe=$e.tileFramebuffer,at=ze.transform.projection.name==="globe",St=$e.paint.get("raster-particle-max-speed");for(const yt of je){const[jt,It,ft]=yt;Ve.activeTexture.set(Ue.TEXTURE0+0),It.texture.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE),Qe.colorAttachment.set(ft.targetColorTexture.texture);const At=ze.getOrCreateProgram("rasterParticleDraw",{defines:It.defines,overrideFog:!1});Ve.activeTexture.set(Ue.TEXTURE0+1);const Qt=It.scalarData?[]:[0,1,2,3].map(Mt=>i.d4[Mt](jt));Qt.push(jt);const ht=jt.canonical.x,zt=jt.canonical.y;for(const Mt of Qt){const ln=De.getTile(at?Mt.wrapped():Mt);if(!ln)continue;const Yt=ln.rasterParticleState;if(!Yt)continue;const Ut=Mt.canonical.x+(1<<Mt.canonical.z)*(Mt.wrap-jt.wrap),tn=Mt.canonical.y;Yt.particleTexture0.bind(Ue.NEAREST,Ue.CLAMP_TO_EDGE);const fn=Ka(1,Yt.particleTexture0.size[0],[Ut-ht,tn-zt],0,It.texture.size,2,St,It.textureOffset,It.scale,It.offset);At.draw(ze,Ue.POINTS,qn.disabled,Qn.disabled,vr.alphaBlended,Wn.disabled,fn,$e.id,Yt.particleIndexBuffer,void 0,Yt.particleSegment)}}}(I,N,G,be),Z.bindFramebuffer.set(G.particleFramebuffer.framebuffer),function(ze,De,$e,je){const Ve=ze.context,Ue=Ve.gl,Qe=De.paint.get("raster-particle-max-speed"),at=je*De.paint.get("raster-particle-speed-factor")*.15,St=function(jt){return Math.pow(jt,6)}(.01+1*De.paint.get("raster-particle-reset-rate-factor")),yt=De.particleFramebuffer;Ve.viewport.set([0,0,yt.width,yt.height]);for(const jt of $e){const[,It,ft]=jt;Ve.activeTexture.set(Ue.TEXTURE0+0),It.texture.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE),Ve.activeTexture.set(Ue.TEXTURE0+1);const At=ft.particleTexture0;At.bind(Ue.NEAREST,Ue.CLAMP_TO_EDGE);const Qt=gp(1,At.size[0],0,It.texture.size,Qe,at,St,It.textureOffset,It.scale,It.offset);yt.colorAttachment.set(ft.particleTexture1.texture),Ve.clear({color:i.aj.transparent}),ze.getOrCreateProgram("rasterParticleUpdate",{defines:It.defines}).draw(ze,Ue.TRIANGLES,qn.disabled,Qn.disabled,vr.unblended,Wn.disabled,Qt,De.id,ze.viewportBuffer,ze.quadTriangleIndexBuffer,ze.viewportSegments)}}(I,G,be,Ce)}(p,r,l,m),p.renderPass==="translucent"&&(function(I,N,G,X,Z){const J=I.context,Q=J.gl,ae=N.getSource().tileSize,ye=5*(1-i.ac(i.bY,i.bY+1,I.transform.zoom))*ae+G.paint.get("raster-particle-elevation"),fe=!I.options.moving,be=I.transform.projection.name==="globe";if(!X.length)return;const[_e,Ce]=I.stencilConfigForOverlap(X),ze=[];be&&ze.push("PROJECTION_GLOBE_VIEW");const De=I.stencilModeFor3D();for(const $e of Ce){const je=$e.toUnwrapped(),Ve=N.getTile($e);if(!Ve.rasterParticleState)continue;const Ue=Ve.rasterParticleState,Qe=100;Ve.registerFadeDuration(Qe);const at=N.findLoadedParent($e,0),St=Uo(Ve,at,N,I.transform,Qe);let yt,jt;I.terrain&&I.terrain.prepareDrawTile(),J.activeTexture.set(Q.TEXTURE0),Ue.targetColorTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),J.activeTexture.set(Q.TEXTURE1),at&&at.rasterParticleState?(at.rasterParticleState.targetColorTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),yt=Math.pow(2,at.tileID.overscaledZ-Ve.tileID.overscaledZ),jt=[Ve.tileID.canonical.x*yt%1,Ve.tileID.canonical.y*yt%1]):Ue.targetColorTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE);const It=be?Float32Array.from(I.transform.expandedFarZProjMatrix):I.transform.calculateProjMatrix(je,fe),ft=I.transform,At=wm(ft),Qt=i.cE($e.canonical),ht=i.cF(Qt.getCenter().lat);let zt,Mt,ln,Yt,Ut;be?(zt=Float32Array.from(i.bb(i.cH($e.canonical))),Mt=Float32Array.from(ft.globeMatrix),ln=Float32Array.from(i.cD(ft)),Yt=[i.at(ft.center.lng),i.aA(ft.center.lat)],Ut=Float32Array.from(i.cG($e.canonical,Qt,ht,ft.worldSize/ft._pixelsPerMercatorPixel))):(zt=new Float32Array(16),Mt=new Float32Array(9),ln=new Float32Array(16),Yt=[0,0],Ut=new Float32Array(9));const tn=Ni(It,zt,Mt,ln,Ut,jt||[0,0],i.ae(I.transform.zoom),Yt,At,yt||1,St,ye),fn=I.isTileAffectedByFog($e),wn=I.getOrCreateProgram("rasterParticle",{defines:ze,overrideFog:fn});if(I.uploadCommonUniforms(J,wn,je),be){const Cn=new qn(Q.LEQUAL,qn.ReadOnly,I.depthRangeFor3D),Yn=0,Gn=I.globeSharedBuffers;if(Gn){const[Un,tr,nr]=Gn.getGridBuffers(ht,Yn!==0);wn.draw(I,Q.TRIANGLES,Cn,De,vr.alphaBlended,I.renderElevatedRasterBackface?Wn.frontCCW:Wn.backCCW,tn,G.id,Un,tr,nr)}}else{const Cn=I.depthModeForSublayer(0,qn.ReadOnly),Yn=_e[$e.overscaledZ],{tileBoundsBuffer:Gn,tileBoundsIndexBuffer:Un,tileBoundsSegments:tr}=I.getTileBoundsBuffers(Ve);wn.draw(I,Q.TRIANGLES,Cn,Yn,vr.alphaBlended,Wn.disabled,tn,G.id,Gn,Un,tr)}}I.resetStencilClippingMasks()}(p,r,l,m),p.style.map.triggerRepaint())},background:function(p,r,l,m){const w=l.paint.get("background-color"),T=l.paint.get("background-color-use-theme").constantOr("default")==="none",I=l.paint.get("background-opacity"),N=l.paint.get("background-emissive-strength"),G=l.paint.get("background-pitch-alignment")==="viewport";if(I===0)return;const X=p.context,Z=X.gl,J=p.transform,Q=J.tileSize,ae=l.paint.get("background-pattern");let ye;if(ae!==void 0&&(ae===null||(ye=p.imageManager.getPattern(ae.toString(),l.scope,p.style.getLut(l.scope)),!ye)))return;const fe=!ae&&w.a===1&&I===1&&p.opaquePassEnabledForLayer()?"opaque":"translucent";if(p.renderPass!==fe)return;const be=Qn.disabled,_e=p.depthModeForSublayer(0,fe==="opaque"?qn.ReadWrite:qn.ReadOnly),Ce=p.colorModeForDrapableLayerRenderPass(N),ze=ae?"backgroundPattern":"background";let De,$e=m;if($e||(De=p.getBackgroundTiles(),$e=Object.values(De).map(je=>je.tileID)),ae&&(X.activeTexture.set(Z.TEXTURE0),p.imageManager.bind(p.context,l.scope)),G){const je=p.getOrCreateProgram(ze,{overrideFog:!1,overrideRtt:!0}),Ve=new Float32Array(i.ab.mat4.identity([])),Ue=new i.aG(0,0,0,0,0),Qe=ae?nf(Ve,N,I,p,0,l.scope,ye,G,{tileID:Ue,tileSize:Q}):tf(Ve,N,I,w.toRenderColor(T?null:l.lut));je.draw(p,Z.TRIANGLES,_e,be,Ce,Wn.disabled,Qe,l.id,p.viewportBuffer,p.quadTriangleIndexBuffer,p.viewportSegments)}else for(const je of $e){const Ve=p.isTileAffectedByFog(je),Ue=p.getOrCreateProgram(ze,{overrideFog:Ve}),Qe=je.toUnwrapped(),at=m?je.projMatrix:p.transform.calculateProjMatrix(Qe);p.prepareDrawTile();const St=r?r.getTile(je):De?De[je.key]:new al(je,Q,J.zoom,p),yt=ae?nf(at,N,I,p,0,l.scope,ye,G,{tileID:je,tileSize:Q}):tf(at,N,I,w.toRenderColor(T?null:l.lut));p.uploadCommonUniforms(X,Ue,Qe);const{tileBoundsBuffer:jt,tileBoundsIndexBuffer:It,tileBoundsSegments:ft}=p.getTileBoundsBuffers(St);Ue.draw(p,Z.TRIANGLES,_e,be,Ce,Wn.disabled,yt,l.id,jt,It,ft)}},sky:function(p,r,l){const m=p._atmosphere?i.ae(p.transform.zoom):1,w=l.paint.get("sky-opacity")*m;if(w===0)return;const T=p.context,I=l.paint.get("sky-type"),N=new qn(T.gl.LEQUAL,qn.ReadOnly,[0,1]),G=p.frameCounter/1e3%1;I==="atmosphere"?p.renderPass==="offscreen"?l.needsSkyboxCapture(p)&&(function(X,Z,J,Q){const ae=X.context,ye=ae.gl;let fe=Z.skyboxFbo;if(!fe){fe=Z.skyboxFbo=ae.createFramebuffer(32,32,!0,null),Z.skyboxGeometry=new Em(ae),Z.skyboxTexture=ae.gl.createTexture(),ye.bindTexture(ye.TEXTURE_CUBE_MAP,Z.skyboxTexture),ye.texParameteri(ye.TEXTURE_CUBE_MAP,ye.TEXTURE_WRAP_S,ye.CLAMP_TO_EDGE),ye.texParameteri(ye.TEXTURE_CUBE_MAP,ye.TEXTURE_WRAP_T,ye.CLAMP_TO_EDGE),ye.texParameteri(ye.TEXTURE_CUBE_MAP,ye.TEXTURE_MIN_FILTER,ye.LINEAR),ye.texParameteri(ye.TEXTURE_CUBE_MAP,ye.TEXTURE_MAG_FILTER,ye.LINEAR);for(let ze=0;ze<6;++ze)ye.texImage2D(ye.TEXTURE_CUBE_MAP_POSITIVE_X+ze,0,ye.RGBA,32,32,0,ye.RGBA,ye.UNSIGNED_BYTE,null)}ae.bindFramebuffer.set(fe.framebuffer),ae.viewport.set([0,0,32,32]);const be=Z.getCenter(X,!0),_e=X.getOrCreateProgram("skyboxCapture"),Ce=new Float64Array(16);i.ab.mat4.identity(Ce),i.ab.mat4.rotateY(Ce,Ce,.5*-Math.PI),Ca(X,Z,_e,Ce,be,0),i.ab.mat4.identity(Ce),i.ab.mat4.rotateY(Ce,Ce,.5*Math.PI),Ca(X,Z,_e,Ce,be,1),i.ab.mat4.identity(Ce),i.ab.mat4.rotateX(Ce,Ce,.5*-Math.PI),Ca(X,Z,_e,Ce,be,2),i.ab.mat4.identity(Ce),i.ab.mat4.rotateX(Ce,Ce,.5*Math.PI),Ca(X,Z,_e,Ce,be,3),i.ab.mat4.identity(Ce),Ca(X,Z,_e,Ce,be,4),i.ab.mat4.identity(Ce),i.ab.mat4.rotateY(Ce,Ce,Math.PI),Ca(X,Z,_e,Ce,be,5),ae.viewport.set([0,0,X.width,X.height])}(p,l),l.markSkyboxValid(p)):p.renderPass==="sky"&&function(X,Z,J,Q,ae){const ye=X.context,fe=ye.gl,be=X.transform,_e=X.getOrCreateProgram("skybox");ye.activeTexture.set(fe.TEXTURE0),fe.bindTexture(fe.TEXTURE_CUBE_MAP,Z.skyboxTexture);const Ce=((ze,De,$e,je,Ve)=>({u_matrix:ze,u_sun_direction:De,u_cubemap:0,u_opacity:je,u_temporal_offset:Ve}))(be.skyboxMatrix,Z.getCenter(X,!1),0,Q,ae);X.uploadCommonUniforms(ye,_e),_e.draw(X,fe.TRIANGLES,J,Qn.disabled,X.colorModeForRenderPass(),Wn.backCW,Ce,"skybox",Z.skyboxGeometry.vertexBuffer,Z.skyboxGeometry.indexBuffer,Z.skyboxGeometry.segment)}(p,l,N,w,G):I==="gradient"&&p.renderPass==="sky"&&function(X,Z,J,Q,ae){const ye=X.context,fe=ye.gl,be=X.transform,_e=X.getOrCreateProgram("skyboxGradient");Z.skyboxGeometry||(Z.skyboxGeometry=new Em(ye)),ye.activeTexture.set(fe.TEXTURE0);let Ce=Z.colorRampTexture;Ce||(Ce=Z.colorRampTexture=new i.T(ye,Z.colorRamp,fe.RGBA8)),Ce.bind(fe.LINEAR,fe.CLAMP_TO_EDGE);const ze=((De,$e,je,Ve,Ue)=>({u_matrix:De,u_color_ramp:0,u_center_direction:$e,u_radius:i.ai(je),u_opacity:Ve,u_temporal_offset:Ue}))(be.skyboxMatrix,Z.getCenter(X,!1),Z.paint.get("sky-gradient-radius"),Q,ae);X.uploadCommonUniforms(ye,_e),_e.draw(X,fe.TRIANGLES,J,Qn.disabled,X.colorModeForRenderPass(),Wn.backCW,ze,"skyboxGradient",Z.skyboxGeometry.vertexBuffer,Z.skyboxGeometry.indexBuffer,Z.skyboxGeometry.segment)}(p,l,N,w,G)},debug:function(p,r,l,m,w,T){for(let I=0;I<l.length;I++)if(w){const X=new i.aj(m.r*.8,m.g*.8,m.b*.8,1);ju(p,r,l[I],m,-1,-1,T),ju(p,r,l[I],m,-1,1,T),ju(p,r,l[I],m,1,1,T),ju(p,r,l[I],m,1,-1,T),ju(p,r,l[I],X,0,0,T)}else ju(p,r,l[I],m,0,0,T)},custom:function(p,r,l,m){const w=p.context,T=l.implementation;if(!p.transform.projection.unsupportedLayers||!p.transform.projection.unsupportedLayers.includes("custom")||p.terrain&&(p.terrain.renderingToTexture||p.renderPass==="offscreen")&&l.isDraped(r)){if(p.renderPass==="offscreen"){const I=T.prerender;if(I){if(p.setCustomLayerDefaults(),w.setColorMode(p.colorModeForRenderPass()),p.transform.projection.name==="globe"){const N=p.transform.pointMerc;I.call(T,w.gl,p.transform.customLayerMatrix(),p.transform.getProjection(),p.transform.globeToMercatorMatrix(),i.ae(p.transform.zoom),[N.x,N.y],p.transform.pixelsPerMeterRatio)}else I.call(T,w.gl,p.transform.customLayerMatrix());w.setDirty(),p.setBaseState()}}else if(p.renderPass==="translucent"){if(p.terrain&&p.terrain.renderingToTexture){const N=T.renderToTile;if(N){const G=m[0].canonical,X=new i.aa(G.x+m[0].wrap*(1<<G.z),G.y,G.z);w.setDepthMode(qn.disabled),w.setStencilMode(Qn.disabled),w.setColorMode(p.colorModeForRenderPass()),p.setCustomLayerDefaults(),N.call(T,w.gl,X),w.setDirty(),p.setBaseState()}return}p.setCustomLayerDefaults(),w.setColorMode(p.colorModeForRenderPass()),w.setStencilMode(Qn.disabled);const I=T.renderingMode==="3d"?new qn(p.context.gl.LEQUAL,qn.ReadWrite,p.depthRangeFor3D):p.depthModeForSublayer(0,qn.ReadOnly);if(w.setDepthMode(I),p.transform.projection.name==="globe"){const N=p.transform.pointMerc;T.render(w.gl,p.transform.customLayerMatrix(),p.transform.getProjection(),p.transform.globeToMercatorMatrix(),i.ae(p.transform.zoom),[N.x,N.y],p.transform.pixelsPerMeterRatio)}else T.render(w.gl,p.transform.customLayerMatrix());w.setDirty(),p.setBaseState(),w.bindFramebuffer.set(null)}}else i.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(p,r,l,m){if(p.renderPass==="opaque")return;const w=l.paint.get("model-opacity").constantOr(1);if(w===0)return;const T=l.paint.get("model-cast-shadows");if(p.renderPass==="shadow"&&(!T||p.terrain&&w<.65&&l._transitionablePaint._values["model-opacity"].value.expression instanceof i.a9))return;const I=p.shadowRenderer,N=l.paint.get("model-receive-shadows");I&&(I.useNormalOffset=!0,N||(I.enabled=!1));const G=()=>{I&&(I.useNormalOffset=!0,N||(I.enabled=!0))},X=r.getSource();if(p.renderPass==="light-beam"&&X.type!=="batched-model")return;if(X.type==="vector"||X.type==="geojson")return function(_e,Ce,ze,De,$e){const je=_e.transform;if(je.projection.name!=="mercator")return void i.w(`Drawing 3D models for ${je.projection.name} projection is not yet implemented`);const Ve=je.getFreeCameraOptions().position;if(!_e.modelManager)return;const Ue=_e.modelManager;ze.modelManager=Ue;const Qe=_e.shadowRenderer;if(!ze._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const at=ze._unevaluatedLayout._values["model-id"],St=Object.assign({},ze.layout.get("model-id").parameters),yt=_e.style.order.indexOf(ze.fqid);for(const jt of De){const It=Ce.getTile(jt).getBucket(ze);if(!It||It.projection.name!==je.projection.name)continue;const ft=It.getModelUris();ft&&!It.modelsRequested&&(Ue.addModelsFromBucket(ft,$e),It.modelsRequested=!0);const At=hd(jt,je);St.zoom=At;const Qt=at.possiblyEvaluate(St);if(du(_e,It,jt),so.shadowUniformsInitialized=!1,so.useSingleShadowCascade=!!Qe&&Qe.getMaxCascadeForTile(jt.toUnwrapped())===0,_e.renderPass==="shadow"&&Qe){if(_e.currentShadowCascade===1&&It.isInsideFirstShadowMapFrustum)continue;const Mt=je.calculatePosMatrix(jt.toUnwrapped(),je.worldSize);if(so.tileMatrix.set(Mt),so.shadowTileMatrix=Float32Array.from(Qe.calculateShadowPassMatrixFromMatrix(Mt)),so.aabb.min.fill(0),so.aabb.max[0]=so.aabb.max[1]=i.ag,so.aabb.max[2]=0,xp(It,so,_e,ze.scope))continue}const ht=1<<jt.canonical.z,zt=[((Ve.x-jt.wrap)*ht-jt.canonical.x)*i.ag,(Ve.y*ht-jt.canonical.y)*i.ag,Ve.z*ht*i.ag];_e.conflationActive&&Object.keys(It.instancesPerModel).length>0&&_e.style.isLayerClipped(ze,Ce.getSource())&&It.updateReplacement(jt,_e.replacementSource,yt,$e)&&(It.uploaded=!1,It.upload(_e.context));for(let Mt in It.instancesPerModel){const ln=It.instancesPerModel[Mt];ln.features.length>0&&(Mt=Qt.evaluate(ln.features[0].feature,{}));const Yt=Ue.getModel(Mt,$e);if(Yt&&Yt.uploaded)for(const Ut of Yt.nodes)lf(_e,ze,Ut,ln,zt,jt,so)}}}(p,r,l,m,X.type==="vector"?l.scope:""),void G();if(!X.loaded())return;if(X.type==="batched-model")return function(_e,Ce,ze,De){ze.resetLayerRenderingStats(_e);const $e=_e.context,je=_e.transform,Ve=_e.style.fog,Ue=_e.shadowRenderer;if(je.projection.name!=="mercator")return void i.w(`Drawing 3D landmark models for ${je.projection.name} projection is not yet implemented`);const Qe=_e.transform.getFreeCameraOptions().position,at=i.ab.vec3.scale([],[Qe.x,Qe.y,Qe.z],_e.transform.worldSize),St=i.ab.vec3.negate([],at),yt=i.ab.mat4.identity([]),jt=i.dj(je.center.lat,je.zoom),It=i.ab.mat4.fromScaling([],[1,1,1/jt]);i.ab.mat4.translate(yt,yt,St);const ft=ze.paint.get("model-opacity").constantOr(1),At=new qn($e.gl.LEQUAL,qn.ReadWrite,_e.depthRangeFor3D),Qt=new qn($e.gl.LEQUAL,qn.ReadOnly,_e.depthRangeFor3D),ht=new i.cd([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),zt=_e.renderPass==="shadow",Mt=zt&&Ue?Ue.getCurrentCascadeFrustum():je.getFrustum(je.scaleZoom(je.worldSize)),ln=ze.paint.get("model-front-cutoff"),Yt=ln[2]<1,Ut=ru(_e,ze.paint.get("model-cutoff-fade-range")),tn=ze.getLayerRenderingStats();(function(fn,wn,Cn,Yn){const Gn=fn.terrain?fn.terrain.exaggeration():0,Un=fn.transform.zoom;for(const tr of Yn){const nr=wn.getTile(tr).getBucket(Cn);nr&&(fn.conflationActive&&nr.updateReplacement(tr,fn.replacementSource),nr.evaluateScale(fn,Cn),fn.terrain&&Gn>0&&nr.elevationUpdate(fn.terrain,Gn,tr,Cn.source),nr.needsReEvaluation(fn,Un,Cn)&&nr.evaluate(Cn))}})(_e,Ce,ze,De),function(){let fn,wn,Cn;Yt?(fn=De.length-1,wn=-1,Cn=-1):(fn=0,wn=De.length,Cn=1);const Yn=new Float64Array(16),Gn=i.ab.vec3.create(),Un=new i.P(0,0);for(let tr=fn;tr!==wn;tr+=Cn){const nr=De[tr],ri=Ce.getTile(nr).getBucket(ze);if(!ri||!ri.uploaded)continue;let Zi=!1;Ue&&(Zi=Ue.getMaxCascadeForTile(nr.toUnwrapped())===0);const wi=je.calculatePosMatrix(nr.toUnwrapped(),je.worldSize),ur=ri.modelTraits;!zt&&Yt&&(i.ab.mat4.invert(Yn,wi),i.ab.vec3.transformMat4(Gn,at,Yn),Un.x=Gn[0],Un.y=Gn[1]);const $r=[];for(const Sn of ri.getNodesInfo()){if(Sn.hiddenByReplacement||!Sn.node.meshes)continue;const Kn=Sn.node;let Zn=0;_e.terrain&&Kn.elevation&&(Zn=Kn.elevation*_e.terrain.exaggeration());const Jn=(()=>{const Dr=Sn.aabb;return ht.min=[...Dr.min],ht.max=[...Dr.max],ht.min[2]+=Zn,ht.max[2]+=Zn,i.ab.vec3.transformMat4(ht.min,ht.min,wi),i.ab.vec3.transformMat4(ht.max,ht.max,wi),ht})(),Ir=Sn.evaluatedScale;if(Ir[0]<=1&&Ir[1]<=1&&Ir[2]<=1&&Jn.intersects(Mt)===0)continue;if(!zt&&Yt){const Dr=.16666666666666666;Sn.cameraCollisionOpacity=at[0]>Jn.min[0]&&at[0]<Jn.max[0]&&at[1]>Jn.min[1]&&at[1]<Jn.max[1]&&at[2]*jt<Jn.max[2]&&Kn.footprint&&i.bA(Un,Kn.footprint)?Math.max(Sn.cameraCollisionOpacity-Dr,0):Math.min(1,Sn.cameraCollisionOpacity+Dr)}const Ti=[...wi],ki=Kn.anchor?Kn.anchor[0]:0,Wi=Kn.anchor?Kn.anchor[1]:0;i.ab.mat4.translate(Ti,Ti,[ki*(Ir[0]-1),Wi*(Ir[1]-1),Zn]),i.ab.vec3.exactEquals(Ir,i.dm)||i.ab.mat4.scale(Ti,Ti,Ir);const rs=i.ab.mat4.multiply([],Ti,Kn.matrix),ua=i.ab.mat4.multiply([],je.expandedFarZProjMatrix,rs),zr=i.ab.mat4.multiply([],je.expandedFarZProjMatrix,Ti),ti=i.ab.vec4.transformMat4([],[ki,Wi,Zn,1],ua)[2];Kn.hidden=!1;let ei=ft;zt||(Yt&&(ei*=Sn.cameraCollisionOpacity,ei*=Am(Ti,je,Sn.aabb,ln)),ei*=Sc(Ut,ti)),ei!==0?$r.push({nodeInfo:Sn,depth:ti,opacity:ei,wvpForNode:ua,wvpForTile:zr,nodeModelMatrix:rs,tileModelMatrix:Ti}):Kn.hidden=!0}zt||$r.sort((Sn,Kn)=>!Yt||Sn.opacity===1&&Kn.opacity===1?Sn.depth<Kn.depth?-1:1:Sn.opacity===1?-1:Kn.opacity===1?1:Sn.depth>Kn.depth?-1:1);for(const Sn of $r){const Kn=Sn.nodeInfo,Zn=Kn.node;let Jn=i.ab.mat4.multiply([],It,Sn.tileModelMatrix);i.ab.mat4.multiply(Jn,yt,Jn);const Ir=i.ab.mat4.invert([],Jn);i.ab.mat4.transpose(Ir,Ir),i.ab.mat4.scale(Ir,Ir,fd),Jn=i.ab.mat4.multiply(Jn,Jn,Zn.matrix);const Ti=_e.renderPass==="light-beam",ki=ze.paint.get("model-color-use-theme").constantOr("default")==="none",Wi=ur&i.dp.HasMapboxMeshFeatures,rs=Wi?0:Kn.evaluatedRMEA[0][2];for(let ua=0;ua<Zn.meshes.length;++ua){const zr=Zn.meshes[ua],ti=ua===Zn.lightMeshIndex;let ei=Sn.wvpForNode;if(ti){if(!Ti&&!_e.terrain&&_e.shadowRenderer){_e.currentLayer<_e.firstLightBeamLayer&&(_e.firstLightBeamLayer=_e.currentLayer);continue}ei=Sn.wvpForTile}else if(Ti)continue;const Dr={defines:[]},fi=[];if(!zt&&Ue&&(Ue.useNormalOffset=!!zr.normalBuffer),uh(Dr.defines,fi,zr,_e,ki?null:ze.lut),Wi||Dr.defines.push("DIFFUSE_SHADED"),Zi&&Dr.defines.push("SHADOWS_SINGLE_CASCADE"),tn&&(zt?tn.numRenderedVerticesInShadowPass+=zr.vertexArray.length:tn.numRenderedVerticesInTransparentPass+=zr.vertexArray.length),zt){sf(zr,Sn.nodeModelMatrix,_e,ze);continue}let aa=null;if(Ve){const Ws=fu(Sn.nodeModelMatrix,_e.transform);if(aa=new Float32Array(Ws),je.projection.name!=="globe"){const uo=zr.aabb.min,$o=zr.aabb.max,[Ks,Ms]=Ve.getOpacityForBounds(Ws,uo[0],uo[1],$o[0],$o[1]);Dr.overrideFog=Ks>=Xe||Ms>=Xe}}const ii=zr.material;let oa;ii.occlusionTexture&&ii.occlusionTexture.offsetScale&&(oa=ii.occlusionTexture.offsetScale,Dr.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const As=_e.getOrCreateProgram("model",Dr);!zt&&Ue&&Ue.setupShadowsFromMatrix(Sn.tileModelMatrix,As,Ue.useNormalOffset),_e.uploadCommonUniforms($e,As,null,aa);const Go=ii.pbrMetallicRoughness;Go.metallicFactor=.9,Go.roughnessFactor=.5;const xo=id(new Float32Array(ei),new Float32Array(Jn),new Float32Array(Ir),new Float32Array(Zn.matrix),_e,Sn.opacity,Go.baseColorFactor.toRenderColor(null),ii.emissiveFactor,Go.metallicFactor,Go.roughnessFactor,ii,rs,ze,[0,0,0],oa);!ti&&(Kn.hasTranslucentParts||Sn.opacity<1)&&As.draw(_e,$e.gl.TRIANGLES,At,Qn.disabled,vr.disabled,Wn.backCCW,xo,ze.id,zr.vertexBuffer,zr.indexBuffer,zr.segments,ze.paint,_e.transform.zoom,void 0,fi),As.draw(_e,$e.gl.TRIANGLES,ti?Qt:At,Qn.disabled,ti||Sn.opacity<1||Kn.hasTranslucentParts?vr.alphaBlended:vr.unblended,Wn.backCCW,xo,ze.id,zr.vertexBuffer,zr.indexBuffer,zr.segments,ze.paint,_e.transform.zoom,void 0,fi)}}}}()}(p,r,l,m),void G();if(X.type!=="model")return;const Z=X.getModels(),J=[],Q=p.transform.getFreeCameraOptions().position,ae=i.ab.vec3.scale([],[Q.x,Q.y,Q.z],p.transform.worldSize);i.ab.vec3.negate(ae,ae);const ye=[],fe=[];let be=0;for(const _e of Z){const Ce=l.paint.get("model-rotation").constantOr(null),ze=l.paint.get("model-scale").constantOr(null),De=l.paint.get("model-translation").constantOr(null);_e.computeModelMatrix(p,Ce,ze,De,!0,!0,!1);const $e=i.ab.mat4.identity([]),je=i.dj(_e.position.lat,p.transform.zoom),Ve=i.ab.mat4.fromScaling([],[1,1,1/je]);i.ab.mat4.translate($e,$e,ae),J.push({zScaleMatrix:Ve,negCameraPosMatrix:$e});for(const Ue of _e.nodes)cd(p.transform,Ue,_e.matrix,p.transform.expandedFarZProjMatrix,be,ye,fe);be++}if(ye.sort((_e,Ce)=>Ce.depth-_e.depth),p.renderPass!=="shadow"){if(w===1)for(const _e of fe)zl(_e,p,l,J[_e.modelIndex],Qn.disabled,p.colorModeForRenderPass());else{for(const _e of fe)zl(_e,p,l,J[_e.modelIndex],Qn.disabled,vr.disabled);for(const _e of fe)zl(_e,p,l,J[_e.modelIndex],p.stencilModeFor3D(),p.colorModeForRenderPass());p.resetStencilClippingMasks()}for(const _e of ye)zl(_e,p,l,J[_e.modelIndex],Qn.disabled,p.colorModeForRenderPass());G()}else{for(const _e of fe)sf(_e.mesh,_e.nodeModelMatrix,p,l);for(const _e of ye)sf(_e.mesh,_e.nodeModelMatrix,p,l);G()}}},hf={line:function(p,r,l){if(p.hasElevatedBuckets=!1,p.hasNonElevatedBuckets=!1,p._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||p._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(r){const m=r.getVisibleCoordinates();for(const w of m){const T=r.getTile(w).getBucket(p);if(T&&(T.hasZOffset?p.hasElevatedBuckets=!0:p.hasNonElevatedBuckets=!0,p.hasElevatedBuckets&&p.hasNonElevatedBuckets))break}}}else p.hasNonElevatedBuckets=!0},model:function(p,r,l){const m=r.getSource();if(!m.loaded())return;if(m.type==="vector"||m.type==="geojson")return void(l.modelManager&&l.modelManager.upload(l,m.type==="vector"?p.scope:""));if(m.type==="batched-model"||m.type!=="model")return;const w=m.getModels();for(const T of w)T.upload(l.context)},raster:function(p,r,l){const m=r.getSource();if(!(m instanceof ta&&m.loaded()))return;const w=p.sourceLayer||m.rasterLayerIds&&m.rasterLayerIds[0];if(!w)return;const T=p.paint.get("raster-array-band")||m.getInitialBand(w);if(T==null)return;const I=r.getIds().map(N=>r.getTileByID(N));for(const N of I)N.updateNeeded(w,T)&&m.prepareTile(N,w,T)},"raster-particle":function(p,r,l){const m=r.getSource();if(!(m instanceof ta&&m.loaded()))return;const w=p.sourceLayer||m.rasterLayerIds&&m.rasterLayerIds[0];if(!w)return;const T=p.paint.get("raster-particle-array-band")||m.getInitialBand(w);if(T==null)return;const I=r.getIds().map(N=>r.getTileByID(N));for(const N of I)N.updateNeeded(w,T)&&m.prepareTile(N,w,T)}};class Tp{constructor(r,l,m,w,T){this.context=new od(r,l),this.transform=m,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=T,this._timeStamp=i.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const I=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const G of I)this._debugParams.enabledLayers[G]=!0;T.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),T.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),T.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),T.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),T.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),T.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const G of I)T.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],G);this.occlusionParams=new Ec(T),this.setup(),this.numSublayers=Xa.maxUnderzooming+Xa.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new i.dv,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Ia(this),this._wireframeDebugCache=new bp,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const N=new i.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new i.T(this.context,N,r.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=w}updateTerrain(r,l){const m=!!r&&!!r.terrain&&this.transform.projection.supportsTerrain;if(!(m||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Gs(this,r));const w=this._terrain;this.transform.elevation=m?w:null,w.update(r,this.transform,l),this.transform.elevation&&!w.enabled&&(this.transform.elevation=null)}_updateFog(r){const l=r.fog;if(!l||this.transform.projection.name==="globe"||l.getOpacity(this.transform.pitch)<1||l.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[m,w]=l.getFovAdjustedRange(this.transform._fov);if(m>w)return void(this.transform.fogCullDistSq=null);const T=m+.78*(w-m);this.transform.fogCullDistSq=T*T}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(r){r&&!this._terrain&&(this._terrain=new Gs(this,this.style)),this._forceTerrainMode=r}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(r,l){if(this.width=r*i.q.devicePixelRatio,this.height=l*i.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style.order)this.style._mergedLayers[m].resize()}setup(){const r=this.context,l=new i.b4;l.emplaceBack(0,0),l.emplaceBack(i.ag,0),l.emplaceBack(0,i.ag),l.emplaceBack(i.ag,i.ag),this.tileExtentBuffer=r.createVertexBuffer(l,i.b6.members),this.tileExtentSegments=i.b7.simpleSegment(0,0,4,2);const m=new i.b4;m.emplaceBack(0,0),m.emplaceBack(i.ag,0),m.emplaceBack(0,i.ag),m.emplaceBack(i.ag,i.ag),this.debugBuffer=r.createVertexBuffer(m,i.b6.members),this.debugSegments=i.b7.simpleSegment(0,0,4,5);const w=new i.b4;w.emplaceBack(-1,-1),w.emplaceBack(1,-1),w.emplaceBack(-1,1),w.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(w,i.b6.members),this.viewportSegments=i.b7.simpleSegment(0,0,4,2);const T=new i.aT;T.emplaceBack(0,0,0,0),T.emplaceBack(i.ag,0,i.ag,0),T.emplaceBack(0,i.ag,0,i.ag),T.emplaceBack(i.ag,i.ag,i.ag,i.ag),this.mercatorBoundsBuffer=r.createVertexBuffer(T,i.b9.members),this.mercatorBoundsSegments=i.b7.simpleSegment(0,0,4,2);const I=new i.aU;I.emplaceBack(0,1,2),I.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(I);const N=new i.b5;for(const X of[0,1,3,2,0])N.emplaceBack(X);this.debugIndexBuffer=r.createIndexBuffer(N),this.emptyTexture=new i.T(r,new i.r({width:1,height:1},Uint8Array.of(0,0,0,0)),r.gl.RGBA8),this.identityMat=i.ab.mat4.create();const G=this.context.gl;this.stencilClearMode=new Qn({func:G.ALWAYS,mask:0},0,255,G.ZERO,G.ZERO,G.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,r.TRIANGLES,qn.disabled,this.stencilClearMode,vr.disabled,Wn.disabled,Wh(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(r,l,m){if(!l||this.currentStencilSource===l.id||!r.isTileClipped()||!m||m.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let N=!1;for(const G of m)if(this._tileClippingMaskIDs[G.key]===void 0){N=!0;break}if(!N)return}this.currentStencilSource=l.id;const w=this.context,T=w.gl;this.nextStencilID+m.length>256&&this.clearStencil(),w.setColorMode(vr.disabled),w.setDepthMode(qn.disabled);const I=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const N of m){const G=l.getTile(N),X=this._tileClippingMaskIDs[N.key]=this.nextStencilID++,{tileBoundsBuffer:Z,tileBoundsIndexBuffer:J,tileBoundsSegments:Q}=this.getTileBoundsBuffers(G);I.draw(this,T.TRIANGLES,qn.disabled,new Qn({func:T.ALWAYS,mask:0},X,255,T.KEEP,T.KEEP,T.REPLACE),vr.disabled,Wn.disabled,Wh(N.projMatrix),"$clipping",Z,J,Q)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,l=this.context.gl;return new Qn({func:l.NOTEQUAL,mask:255},r,255,l.KEEP,l.KEEP,l.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const l=this.context.gl;return new Qn({func:l.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,l.KEEP,l.KEEP,l.REPLACE)}stencilConfigForOverlap(r){const l=this.context.gl,m=r.sort((I,N)=>N.overscaledZ-I.overscaledZ),w=m[m.length-1].overscaledZ,T=m[0].overscaledZ-w+1;if(T>1){this.currentStencilSource=void 0,this.nextStencilID+T>256&&this.clearStencil();const I={};for(let N=0;N<T;N++)I[N+w]=new Qn({func:l.GEQUAL,mask:255},N+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=T,[I,m]}return[{[w]:Qn.disabled},m]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new vr([r.CONSTANT_COLOR,r.ONE,r.CONSTANT_COLOR,r.ONE],new i.aj(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?vr.unblended:vr.alphaBlended}colorModeForDrapableLayerRenderPass(r){const l=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new vr([l.ONE,l.ONE_MINUS_SRC_ALPHA,l.CONSTANT_ALPHA,l.ONE_MINUS_SRC_ALPHA],new i.aj(0,0,0,r===void 0?0:r),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(r,l,m,w=!1){if(this.depthOcclusion)return new qn(this.context.gl.GREATER,qn.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!w)return qn.disabled;const T=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new qn(m||this.context.gl.LEQUAL,l,[T,T])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const r=this.context.gl,l=Math.ceil(this.width),m=Math.ceil(this.height),w=this.context.bindFramebuffer.get(),T=r.getParameter(r.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===l&&this.depthFBO.height===m||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),l!==0&&m!==0&&(this.depthFBO=new _m(this.context,l,m,!1,"texture"),this.depthTexture=new i.T(this.context,{width:l,height:m,data:null},r.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(w),r.bindTexture(r.TEXTURE_2D,T),this.depthFBO&&(r.bindFramebuffer(r.READ_FRAMEBUFFER,null),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),r.blitFramebuffer(0,0,l,m,0,0,l,m,r.DEPTH_BUFFER_BIT,r.NEAREST),r.bindFramebuffer(r.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((r,l)=>r+l/this._fpsHistory.length,0))}render(r,l){const m=i.q.now();this._dt=m-this._timeStamp,this._timeStamp=m,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=r.map.repaint,this.style=r,this.options=l;const w=this.style._mergedLayers,T=!(!this.terrain||!this.terrain.enabled),I=()=>this.style._getOrder(T).filter(ft=>{const At=w[ft];return!(At.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[At.type]});let N=I(),G=!1,X=!1;for(const ft of N){const At=w[ft];At.type==="circle"&&(G=!0),At.type==="symbol"&&(At.hasInitialOcclusionOpacityProperties?X=!0:G=!0)}let Z=N.map(ft=>w[ft]);const J=this.style._mergedSourceCaches;this.imageManager=r.imageManager,this.modelManager=r.modelManager,this.symbolFadeChange=r.placement.symbolFadeChange(i.q.now()),this.imageManager.beginFrame();let Q=0,ae=!1;for(const ft in J){const At=J[ft];At.used&&(At.prepare(this.context),At.getSource().usedInConflation&&++Q)}let ye=!1;for(const ft of Z)ft.isHidden(this.transform.zoom)||(ft.type==="clip"&&(ye=!0),this.prepareLayer(ft));const fe={},be={},_e={},Ce={},ze={};for(const ft in J){const At=J[ft];fe[ft]=At.getVisibleCoordinates(),be[ft]=fe[ft].slice().reverse(),_e[ft]=At.getVisibleCoordinates(!0).reverse(),Ce[ft]=At.getShadowCasterCoordinates(),ze[ft]=At.sortCoordinatesByDistance(fe[ft])}const De=ft=>{const At=this.style.getLayerSourceCache(ft);return At&&At.used?At.getSource():null};if(Q||ye||this._clippingActiveLastFrame){const ft=[],At=[];let Qt=0;for(const ht of Z)this.isSourceForClippingOrConflation(ht,De(ht))&&(ft.push(ht),At.push(Qt)),Qt++;if(ft&&(ye||ft.length>1)||this._clippingActiveLastFrame){ye=!1;const ht=[];for(let zt=0;zt<ft.length;zt++){const Mt=ft[zt],ln=At[zt],Yt=this.style.getLayerSourceCache(Mt);if(!Yt||!Yt.used||!Yt.getSource().usedInConflation&&Mt.type!=="clip")continue;let Ut=i.dx,tn=i.by.None;const fn=[];let wn=!0;if(Mt.type==="clip"){Ut=ln;for(const Cn of Mt.layout.get("clip-layer-types"))tn|=Cn==="model"?i.by.Model:Cn==="symbol"?i.by.Symbol:i.by.FillExtrusion;for(const Cn of Mt.layout.get("clip-layer-scope"))fn.push(Cn);Mt.isHidden(this.transform.zoom)?wn=!1:ye=!0}wn&&ht.push({layer:Mt.fqid,cache:Yt,order:Ut,clipMask:tn,clipScope:fn})}this.replacementSource.setSources(ht),ae=!0}}this._clippingActiveLastFrame=ye,ae||this.replacementSource.clear(),this.conflationActive=ae,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let ft=0;ft<Z.length;ft++){const At=Z[ft],Qt=At.cutoffRange();if(this.longestCutoffRange=Math.max(Qt,this.longestCutoffRange),Qt>0){const ht=De(At);ht&&(this.minCutoffZoom=Math.max(ht.minzoom,this.minCutoffZoom)),At.minzoom&&(this.minCutoffZoom=Math.max(At.minzoom,this.minCutoffZoom))}At.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=ft),this._lastOcclusionLayer=ft)}const $e=this.style&&this.style.fog;$e?(this._fogVisible=$e.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=$e.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(_e),this.opaquePassCutoff=0,N=I(),Z=N.map(ft=>w[ft]));const je=this._shadowRenderer;if(je){je.updateShadowParameters(this.transform,this.style.directionalLight);for(const ft in J)for(const At of fe[ft]){let Qt={min:0,max:0};this.terrain&&(Qt=this.terrain.getMinMaxForTile(At)||Qt),je.addShadowReceiver(At.toUnwrapped(),Qt.min,Qt.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new i.dw(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new vp(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const Ve=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),Ue=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(Ve&&!this._snow&&(this._snow=new Uu(this)),!Ve&&this._snow&&(this._snow.destroy(),delete this._snow),Ue&&!this._rain&&(this._rain=new ch(this)),!Ue&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!An.has(this.context.gl))return;this.renderPass="offscreen";for(const ft of Z){const At=r.getLayerSourceCache(ft);if(!ft.hasOffscreenPass()||ft.isHidden(this.transform.zoom))continue;const Qt=At?be[At.id]:void 0;(ft.type==="custom"||ft.type==="raster"||ft.type==="raster-particle"||ft.isSky()||Qt&&Qt.length)&&this.renderLayer(this,At,ft,Qt)}this.depthRangeFor3D=[0,1-(Z.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,Ce)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const Qe=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),at=(()=>{if(l.showOverdrawInspector)return i.aj.black;const ft=this.style.fog;if(ft&&this.transform.projection.supportsFog){const At=this.style.getLut(ft.scope);if(!Qe){const Qt=ft.properties.get("color-use-theme")==="none",ht=ft.properties.get("color").toRenderColor(Qt?null:At).toArray01();return new i.aj(...ht)}if(Qe){const Qt=ft.properties.get("space-color-use-theme")==="none",ht=ft.properties.get("space-color").toRenderColor(Qt?null:At).toArray01();return new i.aj(...ht)}}return i.aj.transparent})();if(this.context.clear({color:at,depth:1}),this.clearStencil(),this._showOverdrawInspector=l.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Qe&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=N.length-1;this.currentLayer>=0;this.currentLayer--){const ft=Z[this.currentLayer],At=r.getLayerSourceCache(ft);if(ft.isSky())continue;const Qt=At?(ft.is3D()?ze:be)[At.id]:void 0;this._renderTileClippingMasks(ft,At,Qt),this.renderLayer(this,At,ft,Qt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Qe&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||i.ae(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<N.length;this.currentLayer++){const ft=Z[this.currentLayer],At=r.getLayerSourceCache(ft);ft.isSky()&&this.renderLayer(this,At,ft,At?be[At.id]:void 0)}function St(ft,At){let Qt;return At&&(Qt=(ft.type==="symbol"?_e:ft.is3D()?ze:be)[At.id]),Qt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<N.length;){const ft=Z[this.currentLayer];if(ft.type==="raster"||ft.type==="raster-particle"){const At=r.getLayerSourceCache(ft);this.renderLayer(this,At,ft,St(ft,At))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let yt=0;je&&(yt=je.getShadowCastingLayerCount());let jt=!1,It=-1;for(let ft=0;ft<N.length;++ft){const At=Z[ft];At.isHidden(this.transform.zoom)||At.is3D()&&(It=ft)}for(X&&It===-1&&(G=!0);this.currentLayer<N.length;){const ft=Z[this.currentLayer],At=r.getLayerSourceCache(ft);if(ft.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(ft)){if(ft.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(G&&!jt&&this.terrain&&!this.transform.isOrthographic&&(jt=!0,this.blitDepth()),X&&It!==-1&&this.currentLayer===It+1&&!this.transform.isOrthographic&&this.blitDepth(),ft.is3D()||this.terrain||this._renderTileClippingMasks(ft,At,At?fe[At.id]:void 0),this.renderLayer(this,At,ft,St(ft,At)),!this.terrain&&je&&yt>0&&ft.hasShadowPass()&&--yt==0&&(je.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const Qt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Qt;this.currentLayer++){const ht=Z[this.currentLayer];if(!ht.hasLightBeamPass())continue;const zt=r.getLayerSourceCache(ht);this.renderLayer(this,zt,ht,zt?be[zt.id]:void 0)}this.currentLayer=Qt,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const Qt=this.currentLayer;this.depthOcclusion=!0;for(const ht of this.layersWithOcclusionOpacity){this.currentLayer=ht;const zt=Z[this.currentLayer],Mt=r.getLayerSourceCache(zt),ln=Mt?be[Mt.id]:void 0;zt.is3D()||this.terrain||this._renderTileClippingMasks(zt,Mt,Mt?fe[Mt.id]:void 0),this.renderLayer(this,Mt,zt,ln)}this.depthOcclusion=!1,this.currentLayer=Qt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let ft=null;Z.forEach(At=>{const Qt=r.getLayerSourceCache(At);Qt&&!At.isHidden(this.transform.zoom)&&Qt.getVisibleCoordinates().length&&(!ft||ft.getSource().maxzoom<Qt.getSource().maxzoom)&&(ft=Qt)}),ft&&this.options.showTileBoundaries&&Ac.debug(this,ft,ft.getVisibleCoordinates(),i.aj.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Ac.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new i.aj(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(ft){const At=ft.transform.padding;Tm(ft,ft.transform.height-(At.top||0),3,wc),Tm(ft,At.bottom||0,3,jg),_p(ft,At.left||0,3,Ug),_p(ft,ft.transform.width-(At.right||0),3,Sm);const Qt=ft.transform.centerPoint;(function(ht,zt,Mt,ln){cl(ht,zt-1,Mt-10,2,20,ln),cl(ht,zt-10,Mt-1,20,2,ln)})(ft,Qt.x,ft.transform.height-Qt.y,ld)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),ae||(this.conflationActive=!1)}prepareLayer(r){this.gpuTimingStart(r);const{unsupportedLayers:l}=this.transform.projection,m=!l||!l.includes(r.type);if(hf[r.type]&&(m||this.terrain&&r.type==="custom")){const w=this.style.getLayerSourceCache(r);hf[r.type](r,w,this)}this.gpuTimingEnd()}renderLayer(r,l,m,w){m.isHidden(this.transform.zoom)||(m.type==="background"||m.type==="sky"||m.type==="custom"||m.type==="model"||m.type==="raster"||m.type==="raster-particle"||w&&w.length)&&(this.id=m.id,this.gpuTimingStart(m),r.transform.projection.unsupportedLayers&&r.transform.projection.unsupportedLayers.includes(m.type)&&(!r.terrain||m.type!=="custom")||m.type==="clip"||Ac[m.type](r,l,m,w,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery,m=this.context.gl;let w=this.gpuTimers[r.id];w||(w=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:m.createQuery()}),w.calls++,m.beginQuery(l.TIME_ELAPSED_EXT,w.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const r=this.context.extTimerQuery,l=this.context.gl,m=l.createQuery();this.deferredRenderGpuTimeQueries.push(m),l.beginQuery(r.TIME_ELAPSED_EXT,m)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}collectDeferredRenderGpuQueries(){const r=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],r}queryGpuTimers(r){const l={};for(const m in r){const w=r[m],T=this.context.extTimerQuery,I=T.getQueryParameter(w.query,this.context.gl.QUERY_RESULT)/1e6;T.deleteQueryEXT(w.query),l[m]=I}return l}queryGpuTimeDeferredRender(r){if(!this.options.gpuTimingDeferredRender)return 0;const l=this.context.gl;let m=0;for(const w of r)m+=l.getQueryParameter(w,l.QUERY_RESULT)/1e6,l.deleteQuery(w);return m}translatePosMatrix(r,l,m,w,T){if(!m[0]&&!m[1])return r;const I=T?w==="map"?this.transform.angle:0:w==="viewport"?-this.transform.angle:0;if(I){const X=Math.sin(I),Z=Math.cos(I);m=[m[0]*Z-m[1]*X,m[0]*X+m[1]*Z]}const N=[T?m[0]:i.ar(l,m[0],this.transform.zoom),T?m[1]:i.ar(l,m[1],this.transform.zoom),0],G=new Float32Array(16);return i.ab.mat4.translate(G,r,N),G}saveTileTexture(r){const l=r.size[0],m=this._tileTextures[l];m?m.push(r):this._tileTextures[l]=[r]}getTileTexture(r){const l=this._tileTextures[r];return l&&l.length>0?l.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(r,l,m){const w=m===void 0?this.terrain&&this.terrain.renderingToTexture:m,T=[];return this.style&&this.style.enable3dLights()&&(r==="globeRaster"||r==="terrainRaster"?(T.push("LIGHTING_3D_MODE"),T.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):w||T.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||T.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(T.push("TERRAIN"),this.linearFloatFilteringSupported()&&T.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&T.push("GLOBE"),!this._fogVisible||w||l!==void 0&&!l||T.push("FOG","FOG_DITHERING"),w&&T.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&T.push("OVERDRAW_INSPECTOR"),T}getOrCreateProgram(r,l){this.cache=this.cache||{};const m=l&&l.defines||[],w=l&&l.config,T=this.currentGlobalDefines(r,l&&l.overrideFog,l&&l.overrideRtt).concat(m),I=Ng.cacheKey(jo[r],r,T,w);return this.cache[I]||(this.cache[I]=new Ng(this.context,r,jo[r],w,ad[r],T)),this.cache[I]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(r,l){if(this.style.enable3dLights()){const m=this.style.directionalLight,w=this.style.ambientLight;if(m&&w){const T=((I,N,G)=>{const X=I.properties.get("direction"),Z=I.properties.get("color-use-theme")==="none",J=I.properties.get("color").toRenderColor(Z?null:G.getLut(I.scope)).toArray01(),Q=I.properties.get("intensity"),ae=N.properties.get("color-use-theme")==="none",ye=N.properties.get("color").toRenderColor(ae?null:G.getLut(N.scope)).toArray01(),fe=N.properties.get("intensity"),be=[X.x,X.y,X.z],_e=i.cM(ye,fe),Ce=i.cM(J,Q);return{u_lighting_ambient_color:_e,u_lighting_directional_dir:be,u_lighting_directional_color:Ce,u_ground_radiance:Du(be,Ce,_e)}})(m,w,this.style);l.setLightsUniformValues(r,T)}}}uploadCommonUniforms(r,l,m,w,T){if(this.uploadCommonLightUniforms(r,l),this.terrain&&this.terrain.renderingToTexture)return;const I=this.style.fog;if(I){const N=I.getOpacity(this.transform.pitch),G=((X,Z,J,Q,ae,ye,fe,be,_e,Ce,ze,De)=>{const $e=X.transform,je=Z.properties.get("color-use-theme")==="none",Ve=Z.properties.get("color").toRenderColor(je?null:X.style.getLut(Z.scope)).toArray01();Ve[3]=Q;const Ue=X.frameCounter/1e3%1,[Qe,at]=Z.properties.get("vertical-range");return{u_fog_matrix:J?$e.calculateFogTileMatrix(J):De||X.identityMat,u_fog_range:Z.getFovAdjustedRange($e._fov),u_fog_color:Ve,u_fog_horizon_blend:Z.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Qe,at),at],u_fog_temporal_offset:Ue,u_frustum_tl:ae,u_frustum_tr:ye,u_frustum_br:fe,u_frustum_bl:be,u_globe_pos:_e,u_globe_radius:Ce,u_viewport:ze,u_globe_transition:i.ae($e.zoom),u_is_globe:+($e.projection.name==="globe")}})(this,I,m,N,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*i.q.devicePixelRatio,this.transform.height*i.q.devicePixelRatio],w);l.setFogUniformValues(r,G)}T&&l.setCutoffUniformValues(r,T.uniformValues)}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){const r=this.canvasCopy();r&&(this.frameCopies.push(r),this.tileLoaded=!1)}canvasCopy(){const r=this.context.gl,l=r.createTexture();return r.bindTexture(r.TEXTURE_2D,l),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),l}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&r.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const r=this._backgroundTiles,l=this._backgroundTiles={},m=this.transform.coveringTiles({tileSize:512});for(const w of m)l[w.key]=r[w.key]||new al(w,512,this.transform.tileZoom,this);return l}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(r,l){return!(!r.is3D()||r.type!=="clip"&&(r.minzoom&&r.minzoom>this.transform.zoom||(this.style._clipLayerPresent||r.sourceLayer!=="building")&&(!l||l.type!=="batched-model")))}isTileAffectedByFog(r){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let l=this._cachedTileFogOpacities[r.key];return l||(this._cachedTileFogOpacities[r.key]=l=this.style.fog.getOpacityForTile(r)),l[0]>=Xe||l[1]>=Xe}setupDepthForOcclusion(r,l,m){const w=this.context,T=w.gl,I=!!m;var N;m||(m={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),w.activeTexture.set(T.TEXTURE3),r&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),m.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],m.u_depth_range_unpack=[2/((N=this.depthRangeFor3D)[1]-N[0]),-1-2*N[0]/(N[1]-N[0])],m.u_occluder_half_size=.5*this.occlusionParams.occluderSize,m.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),w.activeTexture.set(T.TEXTURE0),I||l.setTerrainUniformValues(w,m)}}function pd(p,r){let l=!1,m=null;const w=()=>{m=null,l&&(p(),m=setTimeout(w,r),l=!1)};return()=>(l=!0,m||w(),m)}class md{constructor(r){this._hashName=r&&encodeURIComponent(r),i.aP(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=pd(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,window.addEventListener("hashchange",this._onHashChange,!1),r.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const r=this._map;if(!r)return"";const l=Ep(r);if(this._hashName){const m=this._hashName;let w=!1;const T=location.hash.slice(1).split("&").map(I=>{const N=I.split("=")[0];return N===m?(w=!0,`${N}=${l}`):I}).filter(I=>I);return w||T.push(`${m}=${l}`),`#${T.join("&")}`}return`#${l}`}_getCurrentHash(){const r=location.hash.replace("#","");if(this._hashName){let l;return r.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(l=m)}),(l&&l[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._map;if(!r)return!1;const l=this._getCurrentHash();if(l.length>=3&&!l.some(m=>isNaN(m))){const m=r.dragRotate.isEnabled()&&r.touchZoomRotate.isEnabled()?+(l[3]||0):r.getBearing();return r.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:m,pitch:+(l[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Ep(p,r){const l=p.getCenter(),m=Math.round(100*p.getZoom())/100,w=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),T=Math.pow(10,w),I=Math.round(l.lng*T)/T,N=Math.round(l.lat*T)/T,G=p.getBearing(),X=p.getPitch();let Z=r?`/${I}/${N}/${m}`:`${m}/${N}/${I}`;return(G||X)&&(Z+="/"+Math.round(10*G)/10),X&&(Z+=`/${Math.round(X)}`),Z}const hh={linearity:.3,easing:i.dy(0,0,.3,1)},Mm=i.l({deceleration:2500,maxSpeed:1400},hh),Om=i.l({deceleration:20,maxSpeed:1400},hh),qg=i.l({deceleration:1e3,maxSpeed:360},hh),Im=i.l({deceleration:1e3,maxSpeed:90},hh);class lo{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.q.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,l=i.q.now();for(;r.length>0&&l-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const l={zoom:0,bearing:0,pitch:0,pan:new i.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:T}of this._inertiaBuffer)l.zoom+=T.zoomDelta||0,l.bearing+=T.bearingDelta||0,l.pitch+=T.pitchDelta||0,T.panDelta&&l.pan._add(T.panDelta),T.around&&(l.around=T.around),T.pinchAround&&(l.pinchAround=T.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,w={};if(l.pan.mag()){const T=ff(l.pan.mag(),m,i.l({},Mm,r||{}));w.offset=l.pan.mult(T.amount/l.pan.mag()),w.center=this._map.transform.center,Fa(w,T)}if(l.zoom){const T=ff(l.zoom,m,Om);w.zoom=this._map.transform.zoom+T.amount,Fa(w,T)}if(l.bearing){const T=ff(l.bearing,m,qg);w.bearing=this._map.transform.bearing+i.aw(T.amount,-179,179),Fa(w,T)}if(l.pitch){const T=ff(l.pitch,m,Im);w.pitch=this._map.transform.pitch+T.amount,Fa(w,T)}if(w.zoom||w.bearing){const T=l.pinchAround===void 0?l.around:l.pinchAround;w.around=T?this._map.unproject(T):this._map.getCenter()}return this.clear(),w.noMoveStart=!0,w}}function Fa(p,r){(!p.duration||p.duration<r.duration)&&(p.duration=r.duration,p.easing=r.easing)}function ff(p,r,l){const{maxSpeed:m,linearity:w,deceleration:T}=l,I=i.aw(p*w/(r/1e3),-m,m),N=Math.abs(I)/(T*w);return{easing:l.easing,duration:1e3*N,amount:I*(N/2)}}class ts extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l,m,w={}){const T=Ye(l.getCanvasContainer(),m),I=l.unproject(T);super(r,i.l({point:T,lngLat:I,originalEvent:m},w)),this._defaultPrevented=!1,this.target=l}}class df extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l,m){const w=r==="touchend"?m.changedTouches:m.touches,T=He(l.getCanvasContainer(),w),I=T.map(G=>l.unproject(G)),N=T.reduce((G,X,Z,J)=>G.add(X.div(J.length)),new i.P(0,0));super(r,{points:T,point:N,lngLats:I,lngLat:l.unproject(N),originalEvent:m}),this._defaultPrevented=!1}}class Cm extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l){super("wheel",{originalEvent:l}),this._defaultPrevented=!1}}class Gg{constructor(r,l){this._map=r,this._clickTolerance=l.clickTolerance}reset(){this._mousedownPos=void 0}wheel(r){return this._firePreventable(new Cm(this._map,r))}mousedown(r,l){return this._mousedownPos=l,this._firePreventable(new ts(r.type,this._map,r))}mouseup(r){this._map.fire(new ts(r.type,this._map,r))}preclick(r){const l=i.l({},r);l.type="preclick",this._map.fire(new ts(l.type,this._map,l))}click(r,l){this._mousedownPos&&this._mousedownPos.dist(l)>=this._clickTolerance||(this.preclick(r),this._map.fire(new ts(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new ts(r.type,this._map,r))}mouseover(r){this._map.fire(new ts(r.type,this._map,r))}mouseout(r){this._map.fire(new ts(r.type,this._map,r))}touchstart(r){return this._firePreventable(new df(r.type,this._map,r))}touchmove(r){this._map.fire(new df(r.type,this._map,r))}touchend(r){this._map.fire(new df(r.type,this._map,r))}touchcancel(r){this._map.fire(new df(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class gd{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(r){this._map.fire(new ts(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ts("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new ts(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Yi{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=l.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,l){this.isEnabled()&&r.shiftKey&&r.button===0&&(Ee(),this._startPos=this._lastPos=l,this._active=!0)}mousemoveWindow(r,l){if(!this._active)return;const m=l,w=this._startPos,T=this._lastPos;if(!w||!T||T.equals(m)||!this._box&&m.dist(w)<this._clickTolerance)return;this._lastPos=m,this._box||(this._box=le("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const I=Math.min(w.x,m.x),N=Math.max(w.x,m.x),G=Math.min(w.y,m.y),X=Math.max(w.y,m.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${I}px,${G}px)`,this._box.style.width=N-I+"px",this._box.style.height=X-G+"px")})}mouseupWindow(r,l){if(!this._active)return;const m=this._startPos,w=l;if(m&&r.button===0){if(this.reset(),Oe(),m.x!==w.x||m.y!==w.y)return this._map.fire(new i.z("boxzoomend",{originalEvent:r})),{cameraAnimation:T=>T.fitScreenCoordinates(m,w,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),me(),delete this._startPos,delete this._lastPos}_fireEvent(r,l){return this._map.fire(new i.z(r,{originalEvent:l}))}}function yd(p,r){const l={};for(let m=0;m<p.length;m++)l[p[m].identifier]=r[m];return l}class $g{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(r,l,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=r.timeStamp),m.length===this.numTouches&&(this.centroid=function(w){const T=new i.P(0,0);for(const I of w)T._add(I);return T.div(w.length)}(l),this.touches=yd(m,l)))}touchmove(r,l,m){if(this.aborted||!this.centroid)return;const w=yd(m,l);for(const T in this.touches){const I=w[T];(!I||I.dist(this.touches[T])>30)&&(this.aborted=!0)}}touchend(r,l,m){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),m.length===0){const w=!this.aborted&&this.centroid;if(this.reset(),w)return w}}}class Ap{constructor(r){this.singleTap=new $g(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(r,l,m){this.singleTap.touchstart(r,l,m)}touchmove(r,l,m){this.singleTap.touchmove(r,l,m)}touchend(r,l,m){const w=this.singleTap.touchend(r,l,m);if(w){const T=r.timeStamp-this.lastTime<500,I=!this.lastTap||this.lastTap.dist(w)<30;if(T&&I||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=w,this.count===this.numTaps)return this.reset(),w}}}class fh{constructor(){this._zoomIn=new Ap({numTouches:1,numTaps:2}),this._zoomOut=new Ap({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,l,m){this._zoomIn.touchstart(r,l,m),this._zoomOut.touchstart(r,l,m)}touchmove(r,l,m){this._zoomIn.touchmove(r,l,m),this._zoomOut.touchmove(r,l,m)}touchend(r,l,m){const w=this._zoomIn.touchend(r,l,m),T=this._zoomOut.touchend(r,l,m);return w?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:I.getZoom()+1,around:I.unproject(w)},{originalEvent:r})}):T?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:I.getZoom()-1,around:I.unproject(T)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Mp={0:1,2:2};class dh{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(r,l){return!1}_move(r,l){return{}}mousedown(r,l){if(this._lastPoint)return;const m=st(r);this._correctButton(r,m)&&(this._lastPoint=l,this._eventButton=m)}mousemoveWindow(r,l){const m=this._lastPoint;if(m){if(r.preventDefault(),this._eventButton!=null&&function(w,T){const I=Mp[T];return w.buttons===void 0||(w.buttons&I)!==I}(r,this._eventButton))this.reset();else if(this._moved||!(l.dist(m)<this._clickTolerance))return this._moved=!0,this._lastPoint=l,this._move(m,l)}}mouseupWindow(r){this._lastPoint&&st(r)===this._eventButton&&(this._moved&&Oe(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _d extends dh{mousedown(r,l){super.mousedown(r,l),this._lastPoint&&(this._active=!0)}_correctButton(r,l){return l===0&&!r.ctrlKey}_move(r,l){return{around:l,panDelta:l.sub(r)}}}class pl extends dh{_correctButton(r,l){return l===0&&r.ctrlKey||l===2}_move(r,l){const m=.8*(l.x-r.x);if(m)return this._active=!0,{bearingDelta:m}}contextmenu(r){r.preventDefault()}}class ph extends dh{_correctButton(r,l){return l===0&&r.ctrlKey||l===2}_move(r,l){const m=-.5*(l.y-r.y);if(m)return this._active=!0,{pitchDelta:m}}contextmenu(r){r.preventDefault()}}class na{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=l.clickTolerance||1,this.reset(),i.aP(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new i.P(0,0)}touchstart(r,l,m){return this._calculateTransform(r,l,m)}touchmove(r,l,m){if(this._active&&!(m.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(m.length===1&&!i.dz())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.cancelable&&r.preventDefault(),this._calculateTransform(r,l,m)}}touchend(r,l,m){this._calculateTransform(r,l,m),this._active&&m.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,l,m){m.length>0&&(this._active=!0);const w=yd(m,l),T=new i.P(0,0),I=new i.P(0,0);let N=0;for(const X in w){const Z=w[X],J=this._touches[X];J&&(T._add(Z),I._add(Z.sub(J)),N++,w[X]=Z)}if(this._touches=w,N<this._minTouches||!I.mag())return;const G=I.div(N);return this._sum._add(G),this._sum.mag()<this._clickTolerance?void 0:{around:T.div(N),panDelta:G}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=le("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Hs{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(r){}_move(r,l,m){return{}}touchstart(r,l,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([l[0],l[1]]))}touchmove(r,l,m){const w=this._firstTwoTouches;if(!w)return;r.preventDefault();const[T,I]=w,N=Mc(m,l,T),G=Mc(m,l,I);if(!N||!G)return;const X=this._aroundCenter?null:N.add(G).div(2);return this._move([N,G],X,r)}touchend(r,l,m){if(!this._firstTwoTouches)return;const[w,T]=this._firstTwoTouches,I=Mc(m,l,w),N=Mc(m,l,T);I&&N||(this._active&&Oe(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Mc(p,r,l){for(let m=0;m<p.length;m++)if(p[m].identifier===l)return r[m]}function pf(p,r){return Math.log(p/r)/Math.LN2}class mu extends Hs{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,l){const m=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(pf(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:pf(this._distance,m),pinchAround:l}}}function Op(p,r){return 180*p.angleWith(r)/Math.PI}class vd extends Hs{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,l){const m=this._vector;if(this._vector=r[0].sub(r[1]),m&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Op(this._vector,m),pinchAround:l}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const l=25/(Math.PI*this._minDiameter)*360,m=this._startVector;if(!m)return!1;const w=Op(r,m);return Math.abs(w)<l}}function Ip(p){return Math.abs(p.y)>Math.abs(p.x)}class Pm extends Hs{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(r){this._lastPoints=r,Ip(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,l,m){const w=this._lastPoints;if(!w)return;const T=r[0].sub(w[0]),I=r[1].sub(w[1]);return this._map._cooperativeGestures&&!i.dz()&&m.touches.length<3||(this._valid=this.gestureBeginsVertically(T,I,m.timeStamp),!this._valid)?void 0:(this._lastPoints=r,this._active=!0,{pitchDelta:(T.y+I.y)/2*-.5})}gestureBeginsVertically(r,l,m){if(this._valid!==void 0)return this._valid;const w=r.mag()>=2,T=l.mag()>=2;if(!w&&!T)return;if(!w||!T)return this._firstMove==null&&(this._firstMove=m),m-this._firstMove<100&&void 0;const I=r.y>0==l.y>0;return Ip(r)&&Ip(l)&&I}}const Vu={panStep:100,bearingStep:15,pitchStep:10};class Bl{constructor(){const r=Vu;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let l=0,m=0,w=0,T=0,I=0;switch(r.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:r.shiftKey?m=-1:(r.preventDefault(),T=-1);break;case 39:r.shiftKey?m=1:(r.preventDefault(),T=1);break;case 38:r.shiftKey?w=1:(r.preventDefault(),I=-1);break;case 40:r.shiftKey?w=-1:(r.preventDefault(),I=1);break;default:return}return this._rotationDisabled&&(m=0,w=0),{cameraAnimation:N=>{const G=N.getZoom();N.easeTo({duration:300,easeId:"keyboardHandler",easing:Ts,zoom:l?Math.round(G)+l*(r.shiftKey?2:1):G,bearing:N.getBearing()+m*this._bearingStep,pitch:N.getPitch()+w*this._pitchStep,offset:[-T*this._panStep,-I*this._panStep],center:N.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ts(p){return p*(2-p)}const ns=4.000244140625,Fl=1/450;class Xs{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._handler=l,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Fl,i.aP(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||i.dz()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let l=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const m=i.q.now(),w=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,l!==0&&l%ns==0?this._type="wheel":l!==0&&Math.abs(l)<4?this._type="trackpad":w>400?(this._type=null,this._lastValue=l,this._timeout=window.setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(w*l)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,l+=this._lastValue)),r.shiftKey&&l&&(l/=4),this._type&&(this._lastWheelEvent=r,this._delta-=l,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const l=Ye(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:l,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform;this._type==="wheel"&&r.projection.wrap&&(r._center.lng>=180||r._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const l=()=>r._terrainEnabled()&&this._aroundCoord?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(this._delta!==0){const X=this._type==="wheel"&&Math.abs(this._delta)>ns?this._wheelZoomRate:this._defaultZoomRate;let Z=2/(1+Math.exp(-Math.abs(this._delta*X)));this._delta<0&&Z!==0&&(Z=1/Z);const J=l(),Q=Math.pow(2,J),ae=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):Q;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(ae*Z))),this._type==="wheel"&&(this._startZoom=J,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const m=typeof this._targetZoom=="number"?this._targetZoom:l(),w=this._startZoom,T=this._easing;let I,N=!1;if(this._type==="wheel"&&w&&T){const X=Math.min((i.q.now()-this._lastWheelEventTime)/200,1),Z=T(X);I=i.af(w,m,Z),X<1?this._frameId||(this._frameId=!0):N=!0}else I=m,N=!0;this._active=!0,N&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let G=I-l();return G*this._lastDelta<0&&(G=0),{noInertia:!0,needsRenderFrame:!N,zoomDelta:G,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let l=i.dA;if(this._prevEase){const m=this._prevEase,w=(i.q.now()-m.start)/m.duration,T=m.easing(w+.01)-m.easing(w),I=.27/Math.sqrt(T*T+1e-4)*.01,N=Math.sqrt(.0729-I*I);l=i.dy(I,N,.25,1)}return this._prevEase={start:i.q.now(),duration:r,easing:l},l}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=le("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class ml{constructor(r,l){this._clickZoom=r,this._tapZoom=l}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class gu{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,l){return r.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:m.getZoom()+(r.shiftKey?-1:1),around:m.unproject(l)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Es{constructor(){this._tap=new Ap({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(r,l,m){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?m.length>0&&(this._swipePoint=l[0],this._swipeTouch=m[0].identifier):this._tap.touchstart(r,l,m))}touchmove(r,l,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const w=l[0],T=w.y-this._swipePoint.y;return this._swipePoint=w,r.preventDefault(),this._active=!0,{zoomDelta:T/128}}}else this._tap.touchmove(r,l,m)}touchend(r,l,m){this._tapTime?this._swipePoint&&m.length===0&&this.reset():this._tap.touchend(r,l,m)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vo{constructor(r,l,m){this._el=r,this._mousePan=l,this._touchPan=m}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Cp{constructor(r,l,m){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=l,this._mousePitch=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Hg{constructor(r,l,m,w){this._el=r,this._touchZoom=l,this._touchRotate=m,this._tapDragZoom=w,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const jl=p=>p.zoom||p.drag||p.pitch||p.rotate;class Pp extends i.z{}class _o{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,l){const m=i.ab.vec3.sub([],l,r);this.radius=i.ab.vec3.length(m[2]<0?i.ab.vec3.div([],m,this.constants):[m[0],m[1],0])}projectRay(r){i.ab.vec3.div(r,r,this.constants),i.ab.vec3.normalize(r,r),i.ab.vec3.mul(r,r,this.constants);const l=i.ab.vec3.scale([],r,this.radius);if(l[2]>0){const m=i.ab.vec3.scale([],[0,0,1],i.ab.vec3.dot(l,[0,0,1])),w=i.ab.vec3.scale([],i.ab.vec3.normalize([],[l[0],l[1],0]),this.radius),T=i.ab.vec3.add([],l,i.ab.vec3.scale([],i.ab.vec3.sub([],i.ab.vec3.add([],w,m),l),2));l[0]=T[0],l[1]=T[1]}return l}}function Ys(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta}class qu{constructor(r,l){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new lo(r),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new _o,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(l),i.aP(["handleEvent","handleWindowEvent"],this);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[window,"blur",void 0]];for(const[w,T,I]of this._listeners){const N=w===document?this.handleWindowEvent:this.handleEvent;w.addEventListener(T,N,I)}}destroy(){for(const[r,l,m]of this._listeners){const w=r===document?this.handleWindowEvent:this.handleEvent;r.removeEventListener(l,w,m)}}_addDefaultHandlers(r){const l=this._map,m=l.getCanvasContainer();this._add("mapEvent",new Gg(l,r));const w=l.boxZoom=new Yi(l,r);this._add("boxZoom",w);const T=new fh,I=new gu;l.doubleClickZoom=new ml(I,T),this._add("tapZoom",T),this._add("clickZoom",I);const N=new Es;this._add("tapDragZoom",N);const G=l.touchPitch=new Pm(l);this._add("touchPitch",G);const X=new pl(r),Z=new ph(r);l.dragRotate=new Cp(r,X,Z),this._add("mouseRotate",X,["mousePitch"]),this._add("mousePitch",Z,["mouseRotate"]);const J=new _d(r),Q=new na(l,r);l.dragPan=new Vo(m,J,Q),this._add("mousePan",J),this._add("touchPan",Q,["touchZoom","touchRotate"]);const ae=new vd,ye=new mu;l.touchZoomRotate=new Hg(m,ye,ae,N),this._add("touchRotate",ae,["touchPan","touchZoom"]),this._add("touchZoom",ye,["touchPan","touchRotate"]),this._add("blockableMapEvent",new gd(l));const fe=l.scrollZoom=new Xs(l,this);this._add("scrollZoom",fe,["mousePan"]);const be=l.keyboard=new Bl;this._add("keyboard",be);for(const _e of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[_e]&&l[_e].enable(r[_e])}_add(r,l,m){this._handlers.push({handlerName:r,handler:l,allowed:m}),this._handlersById[r]=l}stop(r){if(!this._updatingCamera){for(const{handler:l}of this._handlers)l.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!jl(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(r,l,m){for(const w in r)if(w!==m&&(!l||l.indexOf(w)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const l=[];for(const m of r)this._el.contains(m.target)&&l.push(m);return l}handleEvent(r,l){this._updatingCamera=!0;const m=r.type==="renderFrame",w=m?void 0:r,T={needsRenderFrame:!1},I={},N={},G=r.touches?this._getMapTouches(r.touches):void 0,X=G?He(this._el,G):m?void 0:Ye(this._el,r);for(const{handlerName:Q,handler:ae,allowed:ye}of this._handlers){if(!ae.isEnabled())continue;let fe;this._blockedByActive(N,ye,Q)?ae.reset():ae[l||r.type]&&(fe=ae[l||r.type](r,X,G),this.mergeHandlerResult(T,I,fe,Q,w),fe&&fe.needsRenderFrame&&this._triggerRenderFrame()),(fe||ae.isActive())&&(N[Q]=ae)}const Z={};for(const Q in this._previousActiveHandlers)N[Q]||(Z[Q]=w);this._previousActiveHandlers=N,(Object.keys(Z).length||Ys(T))&&(this._changes.push([T,I,Z]),this._triggerRenderFrame()),(Object.keys(N).length||Ys(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:J}=T;J&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],J(this._map))}mergeHandlerResult(r,l,m,w,T){if(!m)return;i.l(r,m);const I={handlerName:w,originalEvent:m.originalEvent||T};m.zoomDelta!==void 0&&(l.zoom=I),m.panDelta!==void 0&&(l.drag=I),m.pitchDelta!==void 0&&(l.pitch=I),m.bearingDelta!==void 0&&(l.rotate=I)}_applyChanges(){const r={},l={},m={};for(const[w,T,I]of this._changes)w.panDelta&&(r.panDelta=(r.panDelta||new i.P(0,0))._add(w.panDelta)),w.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+w.zoomDelta),w.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+w.bearingDelta),w.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+w.pitchDelta),w.around!==void 0&&(r.around=w.around),w.aroundCoord!==void 0&&(r.aroundCoord=w.aroundCoord),w.pinchAround!==void 0&&(r.pinchAround=w.pinchAround),w.noInertia&&(r.noInertia=w.noInertia),i.l(l,T),i.l(m,I);this._updateMapTransform(r,l,m),this._changes=[]}_updateMapTransform(r,l,m){const w=this._map,T=w.transform,I=Ce=>[Ce.x,Ce.y,Ce.z];if((Ce=>{const ze=this._eventsInProgress.drag;return ze&&!this._handlersById[ze.handlerName].isActive()})()&&!Ys(r)){const Ce=T.zoom;T.cameraElevationReference="sea",this._originalZoom!=null&&T._orthographicProjectionAtLowPitch&&T.projection.name!=="globe"&&T.pitch===0?(T.cameraElevationReference="ground",T.zoom=this._originalZoom):(T.recenterOnTerrain(),T.cameraElevationReference="ground"),Ce!==T.zoom&&this._map._update(!0)}if(T._isCameraConstrained&&w._stop(!0),!Ys(r))return void this._fireEvents(l,m,!0);let{panDelta:N,zoomDelta:G,bearingDelta:X,pitchDelta:Z,around:J,aroundCoord:Q,pinchAround:ae}=r;T._isCameraConstrained&&(G>0&&(G=0),T._isCameraConstrained=!1),ae!==void 0&&(J=ae),(G||(Ce=>l[Ce]&&!this._eventsInProgress[Ce])("drag"))&&J&&(this._dragOrigin=I(T.pointCoordinate3D(J)),this._originalZoom=T.zoom,this._trackingEllipsoid.setup(T._camera.position,this._dragOrigin)),T.cameraElevationReference="sea",w._stop(!0),J=J||w.transform.centerPoint,X&&(T.bearing+=X),Z&&(T.pitch+=Z),T._updateCameraState();const ye=[0,0,0];if(N)if(T.projection.name==="mercator"){const Ce=this._trackingEllipsoid.projectRay(T.screenPointToMercatorRay(J).dir),ze=this._trackingEllipsoid.projectRay(T.screenPointToMercatorRay(J.sub(N)).dir);ye[0]=ze[0]-Ce[0],ye[1]=ze[1]-Ce[1]}else{const Ce=T.pointCoordinate(J);if(T.projection.name==="globe"){N=N.rotate(-T.angle);const ze=T._pixelsPerMercatorPixel/T.worldSize;ye[0]=-N.x*i.dB(i.aS(Ce.y))*ze,ye[1]=-N.y*i.dB(T.center.lat)*ze}else{const ze=T.pointCoordinate(J.sub(N));Ce&&ze&&(ye[0]=ze.x-Ce.x,ye[1]=ze.y-Ce.y)}}const fe=T.zoom,be=[0,0,0];if(G){const Ce=I(Q||T.pointCoordinate3D(J)),ze={dir:i.ab.vec3.normalize([],i.ab.vec3.sub([],Ce,T._camera.position))};if(ze.dir[2]<0){const De=T.zoomDeltaToMovement(Ce,G);i.ab.vec3.scale(be,ze.dir,De)}}const _e=i.ab.vec3.add(ye,ye,be);T._translateCameraConstrained(_e),G&&Math.abs(T.zoom-fe)>1e-4&&T.recenterOnTerrain(),T.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(l,m,!0)}_fireEvents(r,l,m){const w=jl(this._eventsInProgress),T=jl(r),I={};for(const Z in r){const{originalEvent:J}=r[Z];this._eventsInProgress[Z]||(I[`${Z}start`]=J),this._eventsInProgress[Z]=r[Z]}!w&&T&&this._fireEvent("movestart",T.originalEvent);for(const Z in I)this._fireEvent(Z,I[Z]);T&&this._fireEvent("move",T.originalEvent);for(const Z in r){const{originalEvent:J}=r[Z];this._fireEvent(Z,J)}const N={};let G;for(const Z in this._eventsInProgress){const{handlerName:J,originalEvent:Q}=this._eventsInProgress[Z];this._handlersById[J].isActive()||(delete this._eventsInProgress[Z],G=l[J]||Q,N[`${Z}end`]=G)}for(const Z in N)this._fireEvent(Z,N[Z]);const X=jl(this._eventsInProgress);if(m&&(w||T)&&!X){this._updatingCamera=!0;const Z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),J=Q=>Q!==0&&-this._bearingSnap<Q&&Q<this._bearingSnap;Z?(J(Z.bearing||this._map.getBearing())&&(Z.bearing=0),this._map.easeTo(Z,{originalEvent:G})):(this._map.fire(new i.z("moveend",{originalEvent:G})),J(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,l){this._map.fire(new i.z(r,l?{originalEvent:l}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{this._frameId=void 0,this.handleEvent(new Pp("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const mf="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Oc extends i.E{constructor(r,l){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=l.bearingSnap,this._respectPrefersReducedMotion=l.respectPrefersReducedMotion!==!1,i.aP(["_renderFrameCallback"],this)}getCenter(){return new i.bO(this.transform.center.lng,this.transform.center.lat)}setCenter(r,l){return this.jumpTo({center:r},l)}panBy(r,l,m){return r=i.P.convert(r).mult(-1),this.panTo(this.transform.center,i.l({offset:r},l),m)}panTo(r,l,m){return this.easeTo(i.l({center:r},l),m)}getZoom(){return this.transform.zoom}setZoom(r,l){return this.jumpTo({zoom:r},l),this}zoomTo(r,l,m){return this.easeTo(i.l({zoom:r},l),m)}zoomIn(r,l){return this.zoomTo(this.getZoom()+1,r,l),this}zoomOut(r,l){return this.zoomTo(this.getZoom()-1,r,l),this}getBearing(){return this.transform.bearing}setBearing(r,l){return this.jumpTo({bearing:r},l),this}getPadding(){return this.transform.padding}setPadding(r,l){return this.jumpTo({padding:r},l),this}rotateTo(r,l,m){return this.easeTo(i.l({bearing:r},l),m)}resetNorth(r,l){return this.rotateTo(0,i.l({duration:1e3},r),l),this}resetNorthPitch(r,l){return this.easeTo(i.l({bearing:0,pitch:0,duration:1e3},r),l),this}snapToNorth(r,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,l):this}getPitch(){return this.transform.pitch}setPitch(r,l){return this.jumpTo({pitch:r},l),this}cameraForBounds(r,l){r=i.az.convert(r);const m=l&&l.bearing||0,w=l&&l.pitch||0,T=r.getNorthWest(),I=r.getSouthEast();return this._cameraForBounds(this.transform,T,I,m,w,l)}_extendPadding(r){const l={top:0,right:0,bottom:0,left:0};return r==null?i.l({},l,this.transform.padding):typeof r=="number"?{top:r,bottom:r,right:r,left:r}:i.l({},l,r)}_extendCameraOptions(r){return(r=i.l({offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding=this._extendPadding(r.padding),r}_minimumAABBFrustumDistance(r,l){const m=l.max[0]-l.min[0],w=l.max[1]-l.min[1];return m/w>r.aspect?m/(2*Math.tan(.5*r.fovX)*r.aspect):w/(2*Math.tan(.5*r.fovY)*r.aspect)}_cameraForBoundsOnGlobe(r,l,m,w,T,I){const N=r.clone(),G=this._extendCameraOptions(I);N.bearing=w,N.pitch=T;const X=i.bO.convert(l),Z=i.bO.convert(m),J=.5*(X.lat+Z.lat),Q=.5*(X.lng+Z.lng),ae=i.dC(J,Q),ye=i.ab.vec3.normalize([],ae),fe=i.ab.vec3.normalize([],i.ab.vec3.cross([],ye,[0,1,0])),be=i.ab.vec3.cross([],fe,ye),_e=[fe[0],fe[1],fe[2],0,be[0],be[1],be[2],0,ye[0],ye[1],ye[2],0,0,0,0,1],Ce=[ae,i.dC(X.lat,X.lng),i.dC(Z.lat,X.lng),i.dC(Z.lat,Z.lng),i.dC(X.lat,Z.lng),i.dC(J,X.lng),i.dC(J,Z.lng),i.dC(X.lat,Q),i.dC(Z.lat,Q)];let ze=i.cd.fromPoints(Ce.map(Mt=>[i.ab.vec3.dot(fe,Mt),i.ab.vec3.dot(be,Mt),i.ab.vec3.dot(ye,Mt)]));const De=i.ab.vec3.transformMat4([],ze.center,_e);i.ab.vec3.squaredLength(De)===0&&i.ab.vec3.set(De,0,0,1),i.ab.vec3.normalize(De,De),i.ab.vec3.scale(De,De,i.ax),N.center=i.dD(De);const $e=N.getWorldToCameraMatrix(),je=i.ab.mat4.invert(new Float64Array(16),$e);ze=i.cd.applyTransform(ze,i.ab.mat4.multiply([],$e,_e));const Ve=this._extendAABB(ze,N,G,w);if(!Ve)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");ze=Ve,i.ab.vec3.transformMat4(De,De,$e);const Ue=.5*(ze.max[2]-ze.min[2]),Qe=this._minimumAABBFrustumDistance(N,ze),at=i.ab.vec3.scale([],[0,0,1],Ue),St=i.ab.vec3.add(at,De,at),yt=Qe+(N.pitch===0?0:i.ab.vec3.distance(De,St)),jt=N.globeCenterInViewSpace,It=i.ab.vec3.sub([],De,[jt[0],jt[1],jt[2]]);i.ab.vec3.normalize(It,It),i.ab.vec3.scale(It,It,yt);const ft=i.ab.vec3.add([],De,It);i.ab.vec3.transformMat4(ft,ft,je);const At=i.ds/i.ax,Qt=i.ab.vec3.length(ft),ht=i.bH(Math.max(Qt*At-i.ds,Number.EPSILON),0),zt=Math.min(N.zoomFromMercatorZAdjusted(ht),G.maxZoom);return zt>.5*(i.c6+i.bY)?(N.setProjection({name:"mercator"}),N.zoom=zt,this._cameraForBounds(N,l,m,w,T,I)):{center:N.center,zoom:zt,bearing:w,pitch:T}}_extendAABB(r,l,m,w){const T=.5*((m.padding.left||0)+(m.padding.right||0)),I=.5*((m.padding.top||0)+(m.padding.bottom||0)),N=I,G=T,X=T,Z=I,J=l.width-(G+X),Q=l.height-(N+Z),ae=i.ab.vec3.sub([],r.max,r.min),ye=Math.min(J/ae[0],Q/ae[1]),fe=Math.min(l.scaleZoom(l.scale*ye),m.maxZoom);if(isNaN(fe))return null;const be=l.scale/l.zoomScale(fe),_e=new i.cd([r.min[0]-G*be,r.min[1]-Z*be,r.min[2]],[r.max[0]+X*be,r.max[1]+N*be,r.max[2]]),Ce=(typeof m.offset.x=="number"&&typeof m.offset.y=="number"?new i.P(m.offset.x,m.offset.y):i.P.convert(m.offset)).rotate(-i.ai(w));return _e.center[0]-=Ce.x*be,_e.center[1]+=Ce.y*be,_e}queryTerrainElevation(r,l){const m=this.transform.elevation;return m?(l=i.l({},{exaggerated:!0},l),m.getAtPoint(i.aa.fromLngLat(r),null,l.exaggerated)):null}_cameraForBounds(r,l,m,w,T,I){if(r.projection.name==="globe")return this._cameraForBoundsOnGlobe(r,l,m,w,T,I);const N=r.clone(),G=this._extendCameraOptions(I);N.bearing=w,N.pitch=T;const X=i.bO.convert(l),Z=i.bO.convert(m),J=new i.bO(X.lng,Z.lat),Q=new i.bO(Z.lng,X.lat),ae=N.project(X),ye=N.project(Z),fe=this.queryTerrainElevation(X),be=this.queryTerrainElevation(Z),_e=this.queryTerrainElevation(J),Ce=this.queryTerrainElevation(Q),ze=[[ae.x,ae.y,Math.min(fe||0,be||0,_e||0,Ce||0)],[ye.x,ye.y,Math.max(fe||0,be||0,_e||0,Ce||0)]];let De=i.cd.fromPoints(ze);const $e=N.getWorldToCameraMatrix(),je=i.ab.mat4.invert(new Float64Array(16),$e);De=i.cd.applyTransform(De,$e);const Ve=this._extendAABB(De,N,G,w);if(!Ve)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");De=Ve;const Ue=.5*i.ab.vec3.sub([],De.max,De.min)[2],Qe=this._minimumAABBFrustumDistance(N,De),at=[0,0,1,0];i.ab.vec4.transformMat4(at,at,$e),i.ab.vec4.normalize(at,at);const St=i.ab.vec3.scale([],at,Qe+Ue),yt=i.ab.vec3.add([],De.center,St);i.ab.vec3.transformMat4(De.center,De.center,je),i.ab.vec3.transformMat4(yt,yt,je);const jt=N.unproject(new i.P(De.center[0],De.center[1])),It=i.dE(N.projection,jt),ft=Math.pow(2,It),At=Math.min(N._zoomFromMercatorZ(yt[2]*N.pixelsPerMeter*ft/N.worldSize),G.maxZoom);return N.mercatorFromTransition&&At<.5*(i.c6+i.bY)?(N.setProjection({name:"globe"}),N.zoom=At,this._cameraForBounds(N,l,m,w,T,I)):{center:jt,zoom:At,bearing:w,pitch:T}}fitBounds(r,l,m){const w=this.cameraForBounds(r,l);return this._fitInternal(w,l,m)}fitScreenCoordinates(r,l,m,w,T){const I=i.P.convert(r),N=i.P.convert(l),G=new i.P(Math.min(I.x,N.x),Math.min(I.y,N.y)),X=new i.P(Math.max(I.x,N.x),Math.max(I.y,N.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(I,N))return this;const Z=this.transform.pointLocation3D(G),J=this.transform.pointLocation3D(X),Q=this.transform.pointLocation3D(new i.P(G.x,X.y)),ae=this.transform.pointLocation3D(new i.P(X.x,G.y)),ye=[Math.min(Z.lng,J.lng,Q.lng,ae.lng),Math.min(Z.lat,J.lat,Q.lat,ae.lat)],fe=[Math.max(Z.lng,J.lng,Q.lng,ae.lng),Math.max(Z.lat,J.lat,Q.lat,ae.lat)],be=w&&w.pitch?w.pitch:this.getPitch(),_e=this._cameraForBounds(this.transform,ye,fe,m,be,w);return this._fitInternal(_e,w,T)}_fitInternal(r,l,m){return r?(l=i.l(r,l)).linear?this.easeTo(l,m):this.flyTo(l,m):this}jumpTo(r,l){this.stop();const m=r.preloadOnly?this.transform.clone():this.transform;let w=!1,T=!1,I=!1;"zoom"in r&&m.zoom!==+r.zoom&&(w=!0,m.zoom=+r.zoom),r.center!==void 0&&(m.center=i.bO.convert(r.center)),"bearing"in r&&m.bearing!==+r.bearing&&(T=!0,m.bearing=+r.bearing),"pitch"in r&&m.pitch!==+r.pitch&&(I=!0,m.pitch=+r.pitch);const N=typeof r.padding=="number"?this._extendPadding(r.padding):r.padding;if(r.padding!=null&&!m.isPaddingEqual(N))if(r.retainPadding===!1){const G=m.clone();G.padding=N,m.setLocationAtPoint(m.center,G.centerPoint)}else m.padding=N;return r.preloadOnly?(this._preloadTiles(m),this):(this.fire(new i.z("movestart",l)).fire(new i.z("move",l)),w&&this.fire(new i.z("zoomstart",l)).fire(new i.z("zoom",l)).fire(new i.z("zoomend",l)),T&&this.fire(new i.z("rotatestart",l)).fire(new i.z("rotate",l)).fire(new i.z("rotateend",l)),I&&this.fire(new i.z("pitchstart",l)).fire(new i.z("pitch",l)).fire(new i.z("pitchend",l)),this.fire(new i.z("moveend",l)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||i.w(mf),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,l){const m=this.transform;if(!m.projection.supportsFreeCamera)return i.w(mf),this;this.stop();const w=m.zoom,T=m.pitch,I=m.bearing;m.setFreeCameraOptions(r);const N=w!==m.zoom,G=T!==m.pitch,X=I!==m.bearing;return this.fire(new i.z("movestart",l)).fire(new i.z("move",l)),N&&this.fire(new i.z("zoomstart",l)).fire(new i.z("zoom",l)).fire(new i.z("zoomend",l)),X&&this.fire(new i.z("rotatestart",l)).fire(new i.z("rotate",l)).fire(new i.z("rotateend",l)),G&&this.fire(new i.z("pitchstart",l)).fire(new i.z("pitch",l)).fire(new i.z("pitchend",l)),this.fire(new i.z("moveend",l)),this}easeTo(r,l){this._stop(!1,r.easeId),((r=i.l({offset:[0,0],duration:500,easing:i.dA},r)).animate===!1||this._prefersReducedMotion(r))&&(r.duration=0);const m=this.transform,w=this.getZoom(),T=this.getBearing(),I=this.getPitch(),N=this.getPadding(),G="zoom"in r?+r.zoom:w,X="bearing"in r?this._normalizeBearing(r.bearing,T):T,Z="pitch"in r?+r.pitch:I,J=this._extendPadding(r.padding),Q=i.P.convert(r.offset);let ae,ye,fe;if(m.projection.name==="globe"){const at=i.aa.fromLngLat(m.center),St=Q.rotate(-m.angle);at.x+=St.x/m.worldSize,at.y+=St.y/m.worldSize;const yt=at.toLngLat(),jt=i.bO.convert(r.center||yt);this._normalizeCenter(jt),ae=m.centerPoint.add(St),ye=new i.P(at.x,at.y).mult(m.worldSize),fe=new i.P(i.at(jt.lng),i.aA(jt.lat)).mult(m.worldSize).sub(ye)}else{ae=m.centerPoint.add(Q);const at=m.pointLocation(ae),St=i.bO.convert(r.center||at);this._normalizeCenter(St),ye=m.project(at),fe=m.project(St).sub(ye)}const be=m.zoomScale(G-w);let _e,Ce;r.around&&(_e=i.bO.convert(r.around),Ce=m.locationPoint(_e));const ze=this._zooming||G!==w,De=this._rotating||T!==X,$e=this._pitching||Z!==I,je=!m.isPaddingEqual(J),Ve=r.retainPadding===!1?m.clone():m,Ue=at=>St=>{if(ze&&(at.zoom=i.af(w,G,St)),De&&(at.bearing=i.af(T,X,St)),$e&&(at.pitch=i.af(I,Z,St)),je&&(Ve.interpolatePadding(N,J,St),ae=Ve.centerPoint.add(Q)),_e)at.setLocationAtPoint(_e,Ce);else{const yt=at.zoomScale(at.zoom-w),jt=G>w?Math.min(2,be):Math.max(.5,be),It=Math.pow(jt,1-St),ft=at.unproject(ye.add(fe.mult(St*It)).mult(yt));at.setLocationAtPoint(at.renderWorldCopies?ft.wrap():ft,ae)}return r.preloadOnly||this._fireMoveEvents(l),at};if(r.preloadOnly){const at=this._emulate(Ue,r.duration,m);return this._preloadTiles(at),this}const Qe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ze,this._rotating=De,this._pitching=$e,this._padding=je,this._easeId=r.easeId,this._prepareEase(l,r.noMoveStart,Qe),this._ease(Ue(m),at=>{m.cameraElevationReference==="sea"&&m.recenterOnTerrain(),this._afterEase(l,at)},r),this}_prepareEase(r,l,m={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),l||m.moving||this.fire(new i.z("movestart",r)),this._zooming&&!m.zooming&&this.fire(new i.z("zoomstart",r)),this._rotating&&!m.rotating&&this.fire(new i.z("rotatestart",r)),this._pitching&&!m.pitching&&this.fire(new i.z("pitchstart",r))}_fireMoveEvents(r){this.fire(new i.z("move",r)),this._zooming&&this.fire(new i.z("zoom",r)),this._rotating&&this.fire(new i.z("rotate",r)),this._pitching&&this.fire(new i.z("pitch",r))}_afterEase(r,l){if(this._easeId&&l&&this._easeId===l)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const m=this._zooming,w=this._rotating,T=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new i.z("zoomend",r)),w&&this.fire(new i.z("rotateend",r)),T&&this.fire(new i.z("pitchend",r)),this.fire(new i.z("moveend",r))}flyTo(r,l){if(this._prefersReducedMotion(r)){const Mt=i.ay(r,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(Mt,l)}this.stop(),r=i.l({offset:[0,0],speed:1.2,curve:1.42,easing:i.dA},r);const m=this.transform,w=this.getZoom(),T=this.getBearing(),I=this.getPitch(),N=this.getPadding(),G="zoom"in r?i.aw(+r.zoom,m.minZoom,m.maxZoom):w,X="bearing"in r?this._normalizeBearing(r.bearing,T):T,Z="pitch"in r?+r.pitch:I,J=this._extendPadding(r.padding),Q=m.zoomScale(G-w),ae=i.P.convert(r.offset);let ye=m.centerPoint.add(ae);const fe=m.pointLocation(ye),be=i.bO.convert(r.center||fe);this._normalizeCenter(be);const _e=m.project(fe),Ce=m.project(be).sub(_e);let ze=r.curve;const De=Math.max(m.width,m.height),$e=De/Q,je=Ce.mag();if("minZoom"in r){const Mt=i.aw(Math.min(r.minZoom,w,G),m.minZoom,m.maxZoom),ln=De/m.zoomScale(Mt-w);ze=Math.sqrt(ln/je*2)}const Ve=ze*ze;function Ue(Mt){const ln=($e*$e-De*De+(Mt?-1:1)*Ve*Ve*je*je)/(2*(Mt?$e:De)*Ve*je);return Math.log(Math.sqrt(ln*ln+1)-ln)}function Qe(Mt){return(Math.exp(Mt)-Math.exp(-Mt))/2}function at(Mt){return(Math.exp(Mt)+Math.exp(-Mt))/2}const St=Ue(0);let yt=function(Mt){return at(St)/at(St+ze*Mt)},jt=function(Mt){return De*((at(St)*(Qe(ln=St+ze*Mt)/at(ln))-Qe(St))/Ve)/je;var ln},It=(Ue(1)-St)/ze;if(Math.abs(je)<1e-6||!isFinite(It)){if(Math.abs(De-$e)<1e-6)return this.easeTo(r,l);const Mt=$e<De?-1:1;It=Math.abs(Math.log($e/De))/ze,jt=function(){return 0},yt=function(ln){return Math.exp(Mt*ze*ln)}}r.duration="duration"in r?+r.duration:1e3*It/("screenSpeed"in r?+r.screenSpeed/ze:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0);const ft=T!==X,At=Z!==I,Qt=!m.isPaddingEqual(J),ht=r.retainPadding===!1?m.clone():m,zt=Mt=>ln=>{const Yt=ln*It,Ut=1/yt(Yt);Mt.zoom=ln===1?G:w+Mt.scaleZoom(Ut),ft&&(Mt.bearing=i.af(T,X,ln)),At&&(Mt.pitch=i.af(I,Z,ln)),Qt&&(ht.interpolatePadding(N,J,ln),ye=ht.centerPoint.add(ae));const tn=ln===1?be:Mt.unproject(_e.add(Ce.mult(jt(Yt))).mult(Ut));return Mt.setLocationAtPoint(Mt.renderWorldCopies?tn.wrap():tn,ye),Mt._updateCameraOnTerrain(),r.preloadOnly||this._fireMoveEvents(l),Mt};if(r.preloadOnly){const Mt=this._emulate(zt,r.duration,m);return this._preloadTiles(Mt),this}return this._zooming=!0,this._rotating=ft,this._pitching=At,this._padding=Qt,this._prepareEase(l,!1),this._ease(zt(m),()=>this._afterEase(l),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(r){}_cancelRenderFrame(r){}_stop(r,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const m=this._onEaseEnd;this._onEaseEnd=void 0,m.call(this,l)}if(!r){const m=this.handlers;m&&m.stop(!1)}return this}_ease(r,l,m){m.animate===!1||m.duration===0?(r(1),l()):(this._easeStart=i.q.now(),this._easeOptions=m,this._onEaseFrame=r,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((i.q.now()-this._easeStart)/this._easeOptions.duration,1),l=this._onEaseFrame;l&&l(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,l){r=i.bF(r,-180,180);const m=Math.abs(r-l);return Math.abs(r-360-l)<m&&(r-=360),Math.abs(r+360-l)<m&&(r+=360),r}_normalizeCenter(r){const l=this.transform;if(l.maxBounds||l.projection.name!=="globe"&&!l.renderWorldCopies)return;const m=r.lng-l.center.lng;r.lng+=m>180?-360:m<-180?360:0}_prefersReducedMotion(r){return this._respectPrefersReducedMotion&&i.q.prefersReducedMotion&&!(r&&r.essential)}_emulate(r,l,m){const w=Math.ceil(15*l/1e3),T=[],I=r(m.clone());for(let N=0;N<=w;N++){const G=I(N/w);T.push(G.clone())}return T}_preloadTiles(r,l){}}class gf{constructor(r={}){this.options=r,i.aP(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const l=this.options&&this.options.compact,m=r._getUIString("AttributionControl.ToggleAttribution");this._map=r,this._container=le("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=le("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",m);const w=le("span","mapboxgl-ctrl-icon",this._compactButton);return w.setAttribute("aria-hidden","true"),w.setAttribute("title",m),this._innerContainer=le("div","mapboxgl-ctrl-attrib-inner",this._container),l&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),l===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const l=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.e.ACCESS_TOKEN}];if(r){const m=l.reduce((w,T,I)=>(T.value&&(w+=`${T.key}=${T.value}${I<l.length-1?"&":""}`),w),"?");r.href=`${i.e.FEEDBACK_URL}/${m}#${Ep(this._map,!0)}`,r.rel="noopener nofollow"}}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this._map.style.stylesheet){const w=this._map.style.stylesheet;this.styleOwner=w.owner,this.styleId=w.id}const l=this._map.style._mergedSourceCaches;for(const w in l){const T=l[w];if(T.used){const I=T.getSource();I.attribution&&r.indexOf(I.attribution)<0&&r.push(I.attribution)}}r.sort((w,T)=>w.length-T.length),r=r.filter((w,T)=>{for(let I=T+1;I<r.length;I++)if(r[I].indexOf(w)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=[...this.options.customAttribution,...r]:r.unshift(this.options.customAttribution));const m=r.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,r.length?(this._innerContainer.innerHTML=m,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Co{constructor(){i.aP(["_updateLogo","_updateCompact"],this)}onAdd(r){this._map=r,this._container=le("div","mapboxgl-ctrl");const l=le("a","mapboxgl-ctrl-logo");return l.target="_blank",l.rel="noopener nofollow",l.href="https://www.mapbox.com/",l.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),l.setAttribute("rel","noopener nofollow"),this._container.appendChild(l),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(Object.entries(r).length===0)return!0;for(const l in r){const m=r[l].getSource();if(m.hasOwnProperty("mapbox_logo")&&!m.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const l=r[0];this._map.getCanvasContainer().offsetWidth<250?l.classList.add("mapboxgl-compact"):l.classList.remove("mapboxgl-compact")}}}class Po{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const l=++this._id;return this._queue.push({callback:r,id:l,cancelled:!1}),l}remove(r){const l=this._currentlyRunning,m=l?this._queue.concat(l):this._queue;for(const w of m)if(w.id===r)return void(w.cancelled=!0)}run(r=0){const l=this._currentlyRunning=this._queue;this._queue=[];for(const m of l)if(!m.cancelled&&(m.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class mh{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const l=i.cB((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-l)+this._end*l}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,l,m){this._start=this.getValue(l),this._end=r,this._startTime=l,this._endTime=l+m}}const Ic={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class Ul extends i.z{constructor(r,l,m,w){const{point:T,lngLat:I,originalEvent:N,target:G}=r;super(r.type,{point:T,lngLat:I,originalEvent:N,target:G}),this.preventDefault=()=>{r.preventDefault()},this.id=l,this.interaction=m,this.feature=w}}class yu{constructor(r){this.map=r,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(r,l){if(this.typeById.has(r))throw new Error(`Interaction id "${r}" already exists.`);const m=l.filter;let w=l.type;m&&this.filters.set(r,i.aZ(m)),w==="mouseover"&&(w="mouseenter"),w==="mouseout"&&(w="mouseleave");const T=this.interactionsByType.get(w)||new Map;w==="mouseenter"||w==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(r,l)):T.size===0&&this.map.on(w,this.handleType),T.size===0&&this.interactionsByType.set(w,T),T.set(r,l),this.typeById.set(r,w)}get(r){const l=this.typeById.get(r);if(!l)return;const m=this.interactionsByType.get(l);return m?m.get(r):void 0}remove(r){const l=this.typeById.get(r);if(!l)return;this.typeById.delete(r),this.filters.delete(r);const m=this.interactionsByType.get(l);m&&(m.delete(r),l==="mouseenter"||l==="mouseleave"?(this.delegatedInteractions.delete(r),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):m.size===0&&this.map.off(l,this.handleType))}queryTargets(r,l){const m=[];for(const[w,T]of l)T.target&&m.push({targetId:w,target:T.target,filter:this.filters.get(w)});return this.map.style.queryRenderedTargets(r,m,this.map.transform)}handleMove(r){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const l=this.queryTargets(r.point,Array.from(this.delegatedInteractions).reverse());l.length&&(r.type="mouseenter",this.handleType(r,l));const m=new Map;for(const[w,{feature:T}]of this.prevHoveredFeatures)this.hoveredFeatures.has(w)||m.set(T.id,T);m.size&&(r.type="mouseleave",this.handleType(r,Array.from(m.values())))}handleOut(r){const l=Array.from(this.hoveredFeatures.values()).map(({feature:m})=>m);l.length&&(r.type="mouseleave",this.handleType(r,l)),this.hoveredFeatures.clear()}handleType(r,l){const m=Array.from(this.interactionsByType.get(r.type)).reverse(),w=!!l;l=l||this.queryTargets(r.point,m);const T=r.type==="mouseenter";let I=!1;const N=new Set;for(const G of l){for(const[X,Z]of m){if(!Z.target)continue;const J=G.variants?G.variants[X]:null;if(J){for(const Q of J){if(rl(Q,G,N,X))continue;const ae=new i.cw(G,Q),ye=Au(Q,G,X);w&&(ae.state=this.map.getFeatureState(ae));const fe=T?this.prevHoveredFeatures.get(ye):null,be=new Ul(r,X,Z,ae),_e=fe?fe.stop:Z.handler(be);if(T&&this.hoveredFeatures.set(ye,{feature:G,stop:_e}),_e!==!1){I=!0;break}}if(I)break}}if(I)break}if(!I)for(const[G,X]of m){const{handler:Z,target:J}=X;if(!J&&Z(new Ul(r,G,X,null))!==!1)break}}}function Gr(p,r){if(Array.isArray(p)&&Array.isArray(r)){const l=new Set(p),m=new Set(r);return l.size===m.size&&p.every(w=>m.has(w))}return i.bn(p,r)}const Gu={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},gh={showCompass:!0,showZoom:!0,visualizePitch:!1};class Zs{constructor(r,l,m=!1){this._clickTolerance=10,this.element=l,this.mouseRotate=new pl({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,m&&(this.mousePitch=new ph({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),i.aP(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),l.addEventListener("mousedown",this.mousedown),l.addEventListener("touchstart",this.touchstart,{passive:!1}),l.addEventListener("touchmove",this.touchmove),l.addEventListener("touchend",this.touchend),l.addEventListener("touchcancel",this.reset)}down(r,l){this.mouseRotate.mousedown(r,l),this.mousePitch&&this.mousePitch.mousedown(r,l),Ee()}move(r,l){const m=this.map,w=this.mouseRotate.mousemoveWindow(r,l),T=w&&w.bearingDelta;if(T&&m.setBearing(m.getBearing()+T),this.mousePitch){const I=this.mousePitch.mousemoveWindow(r,l),N=I&&I.pitchDelta;N&&m.setPitch(m.getPitch()+N)}}off(){const r=this.element;r.removeEventListener("mousedown",this.mousedown),r.removeEventListener("touchstart",this.touchstart,{passive:!1}),r.removeEventListener("touchmove",this.touchmove),r.removeEventListener("touchend",this.touchend),r.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){me(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(r){this.down(i.l({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),Ye(this.element,r)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(r){this.move(r,Ye(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=He(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=He(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function xd(p,r,l){if(p=new i.bO(p.lng,p.lat),r){const m=new i.bO(p.lng-360,p.lat),w=new i.bO(p.lng+360,p.lat),T=360*Math.ceil(Math.abs(p.lng-l.center.lng)/360),I=l.locationPoint(p).distSqr(r),N=r.x<0||r.y<0||r.x>l.width||r.y>l.height;l.locationPoint(m).distSqr(r)<I&&(N||Math.abs(m.lng-l.center.lng)<T)?p=m:l.locationPoint(w).distSqr(r)<I&&(N||Math.abs(w.lng-l.center.lng)<T)&&(p=w)}for(;Math.abs(p.lng-l.center.lng)>180;){const m=l.locationPoint(p);if(m.x>=0&&m.y>=0&&m.x<=l.width&&m.y<=l.height)break;p.lng>l.center.lng?p.lng-=360:p.lng+=360}return p}const Vl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class gl extends i.E{constructor(r,l){if(super(),(r instanceof HTMLElement||l)&&(r=i.l({element:r},l)),i.aP(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=r&&r.occludedOpacity||.2,r&&r.element)this._element=r.element,this._offset=i.P.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=le("div");const T=41,I=27,N=ue("svg",{display:"block",height:T*this._scale+"px",width:I*this._scale+"px",viewBox:`0 0 ${I} ${T}`},this._element),G=ue("radialGradient",{id:"shadowGradient"},ue("defs",{},N));ue("stop",{offset:"10%","stop-opacity":.4},G),ue("stop",{offset:"100%","stop-opacity":.05},G),ue("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},N),ue("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},N),ue("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},N),ue("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},N),this._offset=i.P.convert(r&&r.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",T=>{T.preventDefault()}),this._element.addEventListener("mousedown",T=>{T.preventDefault()});const m=this._element.classList;for(const T in Vl)m.remove(`mapboxgl-marker-anchor-${T}`);m.add(`mapboxgl-marker-anchor-${this._anchor}`);const w=r&&r.className?r.className.trim().split(/\s+/):[];m.add(...w),this._popup=null}addTo(r){return r===this._map||(this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._updateMoving),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),r.on("click",this._onMapClick)),this}remove(){const r=this._map;return r&&(r.off("click",this._onMapClick),r.off("move",this._updateMoving),r.off("moveend",this._update),r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler),r.off("mouseup",this._onUp),r.off("touchend",this._onUp),r.off("mousemove",this._onMove),r.off("touchmove",this._onMove),r.off("remove",this._clearFadeTimer),r._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=i.bO.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const w=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[w,-1*(38.1-13.5+w)],"bottom-right":[-w,-1*(38.1-13.5+w)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,r._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const l=r.code,m=r.charCode||r.keyCode;l!=="Space"&&l!=="Enter"&&m!==32&&m!==13||this.togglePopup()}_onMapClick(r){const l=r.originalEvent.target,m=this._element;this._popup&&(l===m||m.contains(l))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const r=this._map,l=this._pos;if(!r||!l)return!1;const m=r.unproject(l),w=r.getFreeCameraOptions();if(!w.position)return!1;const T=w.position.toLngLat();return T.distanceTo(m)<.9*T.distanceTo(this._lngLat)}_evaluateOpacity(){const r=this._map;if(!r)return;const l=this._pos;if(!l||l.x<0||l.x>r.transform.width||l.y<0||l.y>r.transform.height)return void this._clearFadeTimer();const m=r.unproject(l);let w;r._showingGlobe()&&i.dH(r.transform,this._lngLat)?w=0:(w=1-r._queryFogOpacity(m),r.transform._terrainEnabled()&&r.getTerrain()&&this._behindTerrain()&&(w*=this._occludedOpacity)),this._element.style.opacity=`${w}`,this._element.style.pointerEvents=w>0?"auto":"none",this._popup&&this._popup._setOpacity(w),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const r=this._pos;if(!r||!this._map)return;const l=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${r.x}px,${r.y}px)
            ${Vl[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${l.x}px,${l.y}px)
        `}_calculateXYTransform(){const r=this._pos,l=this._map,m=this.getPitchAlignment();if(!l||!r||m!=="map")return"";if(!l._showingGlobe()){const G=l.getPitch();return G?`rotateX(${G}deg)`:""}const w=i.c4(i.dI(l.transform,this._lngLat)),T=r.sub(i.dJ(l.transform)),I=Math.abs(T.x)+Math.abs(T.y);if(I===0)return"";const N=w/I;return`rotateX(${-T.y*N}deg) rotateY(${T.x*N}deg)`}_calculateZTransform(){const r=this._pos,l=this._map;if(!l||!r)return"";let m=0;const w=this.getRotationAlignment();if(w==="map")if(l._showingGlobe()){const T=l.project(new i.bO(this._lngLat.lng,this._lngLat.lat+.001)),I=l.project(new i.bO(this._lngLat.lng,this._lngLat.lat-.001)).sub(T);m=i.c4(Math.atan2(I.y,I.x))-90}else m=-l.getBearing();else if(w==="horizon"){const T=i.ac(4,6,l.getZoom()),I=i.dJ(l.transform);I.y+=T*l.transform.height;const N=r.sub(I),G=i.c4(Math.atan2(N.y,N.x));m=(G>90?G-270:G+90)*(1-T)}return m+=this._rotation,m?`rotateZ(${m}deg)`:""}_update(r){cancelAnimationFrame(this._updateFrameId);const l=this._map;l&&(l.transform.renderWorldCopies&&(this._lngLat=xd(this._lngLat,this._pos,l.transform)),this._pos=l.project(this._lngLat),r===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),l._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(l._showingGlobe()||l.getTerrain()||l.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(r){return this._offset=i.P.convert(r),this._update(),this}addClassName(r){return this._element.classList.add(r),this}removeClassName(r){return this._element.classList.remove(r),this}toggleClassName(r){return this._element.classList.toggle(r)}_onMove(r){const l=this._map;if(!l)return;const m=this._pointerdownPos,w=this._positionDelta;if(m&&w){if(!this._isDragging){const T=this._clickTolerance||l._clickTolerance;if(r.point.dist(m)<T)return;this._isDragging=!0}this._pos=r.point.sub(w),this._lngLat=l.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.z("dragstart"))),this.fire(new i.z("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const r=this._map;r&&(r.off("mousemove",this._onMove),r.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new i.z("dragend")),this._state="inactive"}_addDragHandler(r){const l=this._map,m=this._pos;l&&m&&this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(m),this._pointerdownPos=r.point,this._state="pending",l.on("mousemove",this._onMove),l.on("touchmove",this._onMove),l.once("mouseup",this._onUp),l.once("touchend",this._onUp))}setDraggable(r){this._draggable=!!r;const l=this._map;return l&&(r?(l.on("mousedown",this._addDragHandler),l.on("touchstart",this._addDragHandler)):(l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(r){return this._occludedOpacity=r||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const vo={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},qo={maxWidth:100,unit:"metric"},Pa={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},_u={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},hi=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function bd(p=new i.P(0,0),r="bottom"){if(typeof p=="number"){const l=Math.round(Math.sqrt(.5*Math.pow(p,2)));switch(r){case"top":return new i.P(0,p);case"top-left":return new i.P(l,l);case"top-right":return new i.P(-l,l);case"bottom":return new i.P(0,-p);case"bottom-left":return new i.P(l,-l);case"bottom-right":return new i.P(-l,-l);case"left":return new i.P(p,0);case"right":return new i.P(-p,0)}return new i.P(0,0)}return p instanceof i.P||Array.isArray(p)?i.P.convert(p):i.P.convert(p[r]||[0,0])}return{version:P,supported:ie.supported,setRTLTextPlugin:i.dK,getRTLTextPluginStatus:i.dL,Map:class extends Oc{constructor(p){U.mark(L.create);const r=p;if((p=i.l({},Gu,p)).minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(p.antialias&&i.dF(window)&&(p.antialias=!1,i.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new uc(p.minZoom,p.maxZoom,p.minPitch,p.maxPitch,p.renderWorldCopies),p),this._repaint=!!p.repaint,this._interactive=p.interactive,this._minTileCacheSize=p.minTileCacheSize,this._maxTileCacheSize=p.maxTileCacheSize,this._failIfMajorPerformanceCaveat=p.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=p.preserveDrawingBuffer,this._antialias=p.antialias,this._trackResize=p.trackResize,this._bearingSnap=p.bearingSnap,this._refreshExpiredTiles=p.refreshExpiredTiles,this._fadeDuration=p.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=p.crossSourceCollisions,this._collectResourceTiming=p.collectResourceTiming,this._language=this._parseLanguage(p.language),this._worldview=p.worldview,this._renderTaskQueue=new Po,this._domRenderTaskQueue=new Po,this._controls=[],this._markers=[],this._popups=[],this._mapId=i.aV(),this._locale=i.l({},Ic,p.locale),this._clickTolerance=p.clickTolerance,this._cooperativeGestures=p.cooperativeGestures,this._performanceMetricsCollection=p.performanceMetricsCollection,this._tessellationStep=p.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=p.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new mh(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=p.scaleFactor,this._requestManager=new Tt(p.transformRequest,p.accessToken,p.testMode),this._silenceAuthErrors=!!p.testMode,this._contextCreateOptions=p.contextCreateOptions?Object.assign({},p.contextCreateOptions):{},typeof p.container=="string"){const l=document.getElementById(p.container);if(!l)throw new Error(`Container '${p.container.toString()}' not found.`);this._container=l}else{if(!(p.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(this._container.childNodes.length>0&&i.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),p.maxBounds&&this.setMaxBounds(p.maxBounds),this._spriteFormat=p.spriteFormat,i.aP(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new uf),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new qu(this,p),this._localFontFamily=p.localFontFamily,this._localIdeographFontFamily=p.localIdeographFontFamily,(p.style||!p.testMode)&&this.setStyle(p.style||i.e.DEFAULT_STYLE,{config:p.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),p.projection&&this.setProjection(p.projection),this.indoor=new C(this),p.hash&&(this._hash=new md(typeof p.hash=="string"&&p.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){r.center==null&&r.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch});const l=p.bounds;l&&(this.resize(),this.fitBounds(l,i.l({},p.fitBoundsOptions,{duration:0})))}this.resize(),p.attributionControl&&this.addControl(new gf({customAttribution:p.customAttribution})),this._logoControl=new Co,this.addControl(this._logoControl,p.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",l=>{this._update(l.dataType==="style"),this.fire(new i.z(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new i.z(`${l.dataType}dataloading`,l))}),this._interactions=new yu(this)}_getMapId(){return this._mapId}addControl(p,r){if(r===void 0&&(r=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new i.y(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const l=p.onAdd(this);this._controls.push(p);const m=this._controlPositions[r];return r.indexOf("bottom")!==-1?m.insertBefore(l,m.firstChild):m.appendChild(l),this}removeControl(p){if(!p||!p.onRemove)return this.fire(new i.y(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(p);return r>-1&&this._controls.splice(r,1),p.onRemove(this),this}hasControl(p){return this._controls.indexOf(p)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(p){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new i.z("movestart",p)).fire(new i.z("move",p)),this.fire(new i.z("resize",p)),r&&this.fire(new i.z("moveend",p)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(p){return this.transform.setMaxBounds(i.az.convert(p)),this._update()}setMinZoom(p){if((p=p??-2)>=-2&&p<=this.transform.maxZoom)return this.transform.minZoom=p,this._update(),this.getZoom()<p?this.setZoom(p):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(p){if((p=p??22)>=this.transform.minZoom)return this.transform.maxZoom=p,this._update(),this.getZoom()>p?this.setZoom(p):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(p){if((p=p??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.minPitch=p,this._update(),this.getPitch()<p?this.setPitch(p):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(p){if((p=p??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(p>=this.transform.minPitch)return this.transform.maxPitch=p,this._update(),this.getPitch()>p?this.setPitch(p):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(p){return this._scaleFactor=p,this.painter.scaleFactor=p,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(r=>r.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(p){return this.transform.renderWorldCopies=p,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(p){return p==="auto"?navigator.language:Array.isArray(p)?p.length===0?void 0:p.map(r=>r==="auto"?navigator.language:r):p}setLanguage(p){const r=this._parseLanguage(p);if(!this.style||r===this._language)return this;this._language=r,this.style.reloadSources();for(const l of this._controls)l._setLanguage&&l._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(p){return this.style&&p!==this._worldview?(this._worldview=p,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(p){return this._lazyInitEmptyStyle(),p?typeof p=="string"&&(p={name:p}):p=null,this._useExplicitProjection=!!p,this._prioritizeAndUpdateProjection(p,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const p=this.transform,r=p.projection.name;let l;r==="globe"&&p.zoom>=i.bY?(p.setMercatorFromTransition(),l=!0):r==="mercator"&&p.zoom<i.bY&&(p.setProjection({name:"globe"}),l=!0),l&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(p,r){return this._updateProjection(p||r||{name:"mercator"})}_updateProjection(p){let r;return r=p.name==="globe"&&this.transform.zoom>=i.bY?this.transform.setMercatorFromTransition():this.transform.setProjection(p),this.style.applyProjectionUpdate(),r&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(p){return this.transform.locationPoint3D(i.bO.convert(p))}unproject(p){return this.transform.pointLocation3D(i.P.convert(p))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(p,r,l){const m=w=>{let T=[];if(Array.isArray(r)){const I=r.filter(N=>this.getLayer(N));T=I.length?this.queryRenderedFeatures(w,{layers:I}):[]}else T=this.queryRenderedFeatures(w,{target:r});return T};if(p==="mouseenter"||p==="mouseover"){let w=!1;return{listener:l,targets:r,delegates:{mousemove:I=>{const N=m(I.point);N.length?w||(w=!0,l.call(this,new ts(p,this,I.originalEvent,{features:N}))):w=!1},mouseout:()=>{w=!1}}}}if(p==="mouseleave"||p==="mouseout"){let w=!1;return{listener:l,targets:r,delegates:{mousemove:N=>{m(N.point).length?w=!0:w&&(w=!1,l.call(this,new ts(p,this,N.originalEvent)))},mouseout:N=>{w&&(w=!1,l.call(this,new ts(p,this,N.originalEvent)))}}}}{const w=T=>{const I=m(T.point);I.length&&(T.features=I,l.call(this,T),delete T.features)};return{listener:l,targets:r,delegates:{[p]:w}}}}on(p,r,l){if(typeof r=="function"||l===void 0)return super.on(p,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const m=this._createDelegatedListener(p,r,l);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(m);for(const w in m.delegates)this.on(w,m.delegates[w]);return this}once(p,r,l){if(typeof r=="function"||l===void 0)return super.once(p,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const m=this._createDelegatedListener(p,r,l);for(const w in m.delegates)this.once(w,m.delegates[w]);return this}off(p,r,l){if(typeof r=="function"||l===void 0)return super.off(p,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const m=this._delegatedListeners?this._delegatedListeners[p]:void 0;return m&&(w=>{for(let T=0;T<w.length;T++){const I=w[T];if(I.listener===l&&Gr(I.targets,r)){for(const N in I.delegates)this.off(N,I.delegates[N]);return w.splice(T,1),this}}})(m),this}queryRenderedFeatures(p,r){if(!this.style)return[];if(p===void 0||p instanceof i.P||Array.isArray(p)||r!==void 0||(r=p,p=void 0),p=p||[[0,0],[this.transform.width,this.transform.height]],!r){const T=this.style.queryRenderedFeatures(p,void 0,this.transform),I=this.style.queryRenderedFeatureset(p,void 0,this.transform);return T.concat(I)}let l=!0;if(r.target&&(l=this._isTargetValid(r.target),l&&!r.layers))return this.style.queryRenderedFeatureset(p,r,this.transform);let m=!0;if(r.layers&&Array.isArray(r.layers)){for(const T of r.layers)if(!this._isValidId(T)){m=!1;break}if(m&&!r.target)return this.style.queryRenderedFeatures(p,r,this.transform)}let w=[];return m&&(w=w.concat(this.style.queryRenderedFeatures(p,r,this.transform))),l&&(w=w.concat(this.style.queryRenderedFeatureset(p,r,this.transform))),w}querySourceFeatures(p,r){return!p||typeof p=="string"&&!this._isValidId(p)?[]:this.style.querySourceFeatures(p,r)}isPointOnSurface(p){const{name:r}=this.transform.projection;return r!=="globe"&&r!=="mercator"&&i.w(`${r} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(i.P.convert(p))}addInteraction(p,r){return this._interactions.add(p,r),this}removeInteraction(p){return this._interactions.remove(p),this}setStyle(p,r){return r=i.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r),this.style&&p&&r.diff!==!1&&r.localFontFamily===this._localFontFamily&&r.localIdeographFontFamily===this._localIdeographFontFamily&&!r.config?(this.style._diffStyle(p,(l,m)=>{l?(i.w(`Unable to perform style diff: ${String(l.message||l.error||l)}. Rebuilding the style from scratch.`),this._updateStyle(p,r)):m&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(p,r))}_getUIString(p){const r=this._locale[p];if(r==null)throw new Error(`Missing UI string '${p}'`);return r}_updateStyle(p,r){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),p){const l=i.l({},r);r&&r.config&&(l.initialConfig=r.config,delete l.config),this.style=new et(this,l).load(p),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new et(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(i.w("There is no style added to the map."),!1)}_isValidId(p){return p==null?(this.fire(new i.y(new Error("IDs can't be empty."))),!1):!i.cr(p)||(this.fire(new i.y(new Error(`IDs can't contain special symbols: "${p}".`))),!1)}_isTargetValid(p){return"featuresetId"in p?this._isValidId("importId"in p?p.importId:p.featuresetId):"layerId"in p&&this._isValidId(p.layerId)}_areTargetsValid(p){if(Array.isArray(p)){for(const r of p)if(!this._isValidId(r))return!1;return!0}return this._isTargetValid(p)}addSource(p,r){return this._isValidId(p)?(this._lazyInitEmptyStyle(),this.style.addSource(p,r),this._update(!0)):this}isSourceLoaded(p){return!!this._isValidId(p)&&!!this.style&&this.style._isSourceCacheLoaded(p)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(p,r,l){this._lazyInitEmptyStyle(),this.style.addSourceType(p,r,l)}removeSource(p){return this._isValidId(p)?(this.style.removeSource(p),this._updateTerrain(),this._update(!0)):this}getSource(p){return this._isValidId(p)?this.style.getOwnSource(p):null}addImage(p,r,{pixelRatio:l=1,sdf:m=!1,stretchX:w,stretchY:T,content:I}={}){if(this._lazyInitEmptyStyle(),r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap){const{width:N,height:G,data:X}=i.q.getImageData(r);this.style.addImage(p,{data:new i.r({width:N,height:G},X),pixelRatio:l,stretchX:w,stretchY:T,content:I,sdf:m,version:0,usvg:!1})}else if(r.width===void 0||r.height===void 0)this.fire(new i.y(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:N,height:G}=r,X=r;this.style.addImage(p,{data:new i.r({width:N,height:G},new Uint8Array(X.data)),pixelRatio:l,stretchX:w,stretchY:T,content:I,sdf:m,usvg:!1,version:0,userImage:X}),X.onAdd&&X.onAdd(this,p)}}updateImage(p,r){this._lazyInitEmptyStyle();const l=this.style.getImage(p);if(!l)return void this.fire(new i.y(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const m=r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap?i.q.getImageData(r):r,{width:w,height:T,data:I}=m;if(w===void 0||T===void 0)return void this.fire(new i.y(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(w!==(l.usvg?l.icon.usvg_tree.width:l.data.width)||T!==(l.usvg?l.icon.usvg_tree.height:l.data.height))return void this.fire(new i.y(new Error(`The width and height of the updated image (${w}, ${T})
                must be that same as the previous version of the image
                (${l.data.width}, ${l.data.height})`)));const N=!(r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap);let G=!1;l.usvg?(l.data=new i.r({width:w,height:T},new Uint8Array(I)),l.usvg=!1,l.icon=void 0,G=!0):l.data.replace(I,N),this.style.updateImage(p,l,G)}hasImage(p){return p?!!this.style&&!!this.style.getImage(p):(this.fire(new i.y(new Error("Missing required image id"))),!1)}removeImage(p){this.style.removeImage(p)}loadImage(p,r){i.o(this._requestManager.transformRequest(p,i.R.Image),(l,m)=>{r(l,m instanceof HTMLImageElement?i.q.getImageData(m):m)})}listImages(){return this.style.listImages()}addModel(p,r){this._lazyInitEmptyStyle(),this.style.addModel(p,r)}hasModel(p){return p?this.style.hasModel(p):(this.fire(new i.y(new Error("Missing required model id"))),!1)}removeModel(p){this.style.removeModel(p)}listModels(){return this.style.listModels()}addLayer(p,r){return this._isValidId(p.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(p,r),this._update(!0)):this}getSlot(p){const r=this.getLayer(p);return r&&r.slot||null}setSlot(p,r){return this.style.setSlot(p,r),this.style.mergeLayers(),this._update(!0)}addImport(p,r){return this.style.addImport(p,r),this}updateImport(p,r){return typeof r!="string"&&r.id!==p?(this.removeImport(p),this.addImport(r)):(this.style.updateImport(p,r),this._update(!0))}removeImport(p){return this.style.removeImport(p),this}moveImport(p,r){return this.style.moveImport(p,r),this._update(!0)}moveLayer(p,r){return this._isValidId(p)?(this.style.moveLayer(p,r),this._update(!0)):this}removeLayer(p){return this._isValidId(p)?(this.style.removeLayer(p),this._update(!0)):this}getLayer(p){if(!this._isValidId(p))return null;const r=this.style.getOwnLayer(p);return r?r.type==="custom"?r.implementation:r.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(p,r,l){return this._isValidId(p)?(this.style.setLayerZoomRange(p,r,l),this._update(!0)):this}setFilter(p,r,l={}){return this._isValidId(p)?(this.style.setFilter(p,r,l),this._update(!0)):this}getFilter(p){return this._isValidId(p)?this.style.getFilter(p):null}setPaintProperty(p,r,l,m={}){return this._isValidId(p)?(this.style.setPaintProperty(p,r,l,m),this._update(!0)):this}getPaintProperty(p,r){return this._isValidId(p)?this.style.getPaintProperty(p,r):null}setLayoutProperty(p,r,l,m={}){return this._isValidId(p)?(this.style.setLayoutProperty(p,r,l,m),this._update(!0)):this}getLayoutProperty(p,r){return this._isValidId(p)?this.style.getLayoutProperty(p,r):null}getSchema(p){return this.style.getSchema(p)}setSchema(p,r){return this.style.setSchema(p,r),this._update(!0)}getConfig(p){return this.style.getConfig(p)}setConfig(p,r){return this.style.setConfig(p,r),this._update(!0)}getConfigProperty(p,r){return this.style.getConfigProperty(p,r)}setConfigProperty(p,r,l){return this.style.setConfigProperty(p,r,l),this._update(!0)}getFeaturesetDescriptors(p){return this.style.getFeaturesetDescriptors(p)}setLights(p){if(this._lazyInitEmptyStyle(),p&&p.length===1&&p[0].type==="flat"){const r=p[0];r.properties?this.style.setFlatLight(r.properties,r.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(p),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const p=this.style.getLights()||[];return p.length===0&&p.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),p}setLight(p,r={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:p}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(p){return this._lazyInitEmptyStyle(),!p&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(p),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(p){return this._lazyInitEmptyStyle(),this.style.setFog(p),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(p){return this._lazyInitEmptyStyle(),this.style.setSnow(p),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(p){return this._lazyInitEmptyStyle(),this.style.setRain(p),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(p){return this._lazyInitEmptyStyle(),this.style.setColorTheme(p),this._update(!0)}setImportColorTheme(p,r){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(p,r),this._update(!0)}setCamera(p){return this.style.setCamera(p),this._triggerCameraUpdate(p)}_triggerCameraUpdate(p){return this._update(this.transform.setOrthographicProjectionAtLowPitch(p["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(p){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(i.bO.convert(p),this.transform):0}setFeatureState(p,r){return p.source&&!this._isValidId(p.source)?this:(this.style.setFeatureState(p,r),this._update())}removeFeatureState(p,r){return p.source&&!this._isValidId(p.source)?this:(this.style.removeFeatureState(p,r),this._update())}getFeatureState(p){return p.source&&!this._isValidId(p.source)?null:this.style.getFeatureState(p)}_updateContainerDimensions(){if(!this._container)return;const p=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300;let l,m,w,T=this._container;for(;T&&(!m||!w);){const I=window.getComputedStyle(T).transform;I&&I!=="none"&&(l=I.match(/matrix.*\((.+)\)/)[1].split(", "),l[0]&&l[0]!=="0"&&l[0]!=="1"&&(m=l[0]),l[3]&&l[3]!=="0"&&l[3]!=="1"&&(w=l[3])),T=T.parentElement}this._containerWidth=m?Math.abs(p/m):p,this._containerHeight=w?Math.abs(r/w):r}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const p=this._container;p.classList.add("mapboxgl-map"),(this._missingCSSCanary=le("div","mapboxgl-canary",p)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=le("div","mapboxgl-canvas-container",p);this._canvas=le("canvas","mapboxgl-canvas",r),this._interactive&&(r.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const l=this._controlContainer=le("div","mapboxgl-control-container",p),m=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(w=>{m[w]=le("div",`mapboxgl-ctrl-${w}`,l)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(p,r){const l=i.q.devicePixelRatio||1;this._canvas.width=l*Math.ceil(p),this._canvas.height=l*Math.ceil(r),this._canvas.style.width=`${p}px`,this._canvas.style.height=`${r}px`}_addMarker(p){this._markers.push(p)}_removeMarker(p){const r=this._markers.indexOf(p);r!==-1&&this._markers.splice(r,1)}_addPopup(p){this._popups.push(p)}_removePopup(p){const r=this._popups.indexOf(p);r!==-1&&this._popups.splice(r,1)}_setupPainter(){const p=i.l({},ie.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl2",p);r?(qe(r,!0),this.painter=new Tp(r,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",l=>{l.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),i.m.testSupport(r)):this.fire(new i.y(new Error("Failed to initialize WebGL")))}_contextLost(p){p.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.z("webglcontextlost",{originalEvent:p}))}_contextRestored(p){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style.reloadModels(),this.style.clearSources(),this._update(),this.fire(new i.z("webglcontextrestored",{originalEvent:p}))}_onMapScroll(p){if(p.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(p){return this.style?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(p){return this._update(),this._renderTaskQueue.add(p)}_cancelRenderFrame(p){this._renderTaskQueue.remove(p)}_requestDomTask(p){!this.loaded()||this.loaded()&&!this.isMoving()?p():this._domRenderTaskQueue.add(p)}_render(p){let r;this.fire(new i.z("renderstart")),++this._frameId;const l=this.painter.context.extTimerQuery,m=i.q.now(),w=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(r=w.createQuery(),w.beginQuery(l.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(p),this._domRenderTaskQueue.run(p),this._removed)return;this._updateProjectionTransition();const T=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const X=this.transform.zoom,Z=this.transform.pitch,J=i.q.now(),Q=new i.a8(X,{now:J,fadeDuration:T,pitch:Z,transition:this.style.transition});this.style.update(Q)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let I=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),I=this._updateAverageElevation(m),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):I=this._updateAverageElevation(m);const N=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,T,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),N&&(this._placementDirty=N.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:T,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new i.z("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,U.mark(L.load),this.fire(new i.z("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const X=i.q.now()-m;w.endQuery(l.TIME_ELAPSED_EXT),setTimeout(()=>{const Z=w.getQueryParameter(r,w.QUERY_RESULT)/1e6;w.deleteQuery(r),this.fire(new i.z("gpu-timing-frame",{cpuTime:X,gpuTime:Z}))},50)}if(this.listens("gpu-timing-layer")){const X=this.painter.collectGpuTimers();setTimeout(()=>{const Z=this.painter.queryGpuTimers(X);this.fire(new i.z("gpu-timing-layer",{layerTimes:Z}))},50)}if(this.listens("gpu-timing-deferred-render")){const X=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const Z=this.painter.queryGpuTimeDeferredRender(X);this.fire(new i.z("gpu-timing-deferred-render",{gpuTime:Z}))},50)}const G=this._sourcesDirty||this._styleDirty||this._placementDirty||I;if(G||this._repaint)this.triggerRepaint();else{const X=this.idle();if(X&&(I=this._updateAverageElevation(m,!0)),I)this.triggerRepaint();else if(this._triggerFrame(!1),X&&(this.fire(new i.z("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const Z=this._calculateSpeedIndex();this.fire(new i.z("speedindexcompleted",{speedIndex:Z})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||G||(this._fullyLoaded=!0,U.mark(L.fullLoad),this._performanceMetricsCollection&&Et(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(p){for(const r of this._markers)p&&!this.getRenderWorldCopies()&&(r._lngLat=r._lngLat.wrap()),r._update();for(const r of this._popups)!p||this.getRenderWorldCopies()||r._trackPointer||(r._lngLat=r._lngLat.wrap()),r._update()}_updateAverageElevation(p,r=!1){const l=w=>(this.transform.averageElevation=w,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&l(0);const m=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(m||(r||p-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(p)){const w=this.transform.averageElevation;let T=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(T)?T=0:this._averageElevationLastSampledAt=p;const I=Math.abs(w-T);if(I>1){if(this._isInitialLoad||m)return this._averageElevation.jumpTo(T),l(T);this._averageElevation.easeTo(T,p,300)}else if(I>1e-4)return this._averageElevation.jumpTo(T),l(T)}return!!this._averageElevation.isEasing(p)&&l(this._averageElevation.getValue(p))}_authenticate(){Ne(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,p=>{if(p&&(p.message===Bt||p.status===401)){const r=this.painter.context.gl;qe(r,!1),this._logoControl instanceof Co&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new i.y(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),cn(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&mr(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const p=this._isDragging();this.painter.updateTerrain(this.style,p)}_calculateSpeedIndex(){const p=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const l=this.painter.context.gl,m=l.createFramebuffer();function w(T){l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,T,0);const I=new Uint8Array(l.drawingBufferWidth*l.drawingBufferHeight*4);return l.readPixels(0,0,l.drawingBufferWidth,l.drawingBufferHeight,l.RGBA,l.UNSIGNED_BYTE,I),I}return l.bindFramebuffer(l.FRAMEBUFFER,m),this._canvasPixelComparison(w(p),r.canvasCopies.map(w),r.timeStamps)}_canvasPixelComparison(p,r,l){let m=l[1]-l[0];const w=p.length/4;for(let T=0;T<r.length;T++){const I=r[T];let N=0;for(let G=0;G<I.length;G+=4)I[G]===p[G]&&I[G+1]===p[G+1]&&I[G+2]===p[G+2]&&I[G+3]===p[G+3]&&(N+=1);m+=(l[T+2]-l[T+1])*(1-N/w)}return m}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const p=this.painter.context.gl.getExtension("WEBGL_lose_context");p&&p.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),An.delete(this.painter.context.gl),Ln.remove(),qt.remove(),this._removed=!0,this.fire(new i.z("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(p){this._renderNextFrame=this._renderNextFrame||p,this.style&&!this._frame&&(this._frame=i.q.frame(r=>{const l=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,l&&this._render(r)}))}_preloadTiles(p){const r=this.style?this.style.getSourceCaches():[];return i.bl(r,(l,m)=>l._preloadTiles(p,m),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(p){this._trackResize&&this.resize({originalEvent:p})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(p){this._showParseStatus!==p&&(this._showParseStatus=p,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(p){this._showTerrainWireframe!==p&&(this._showTerrainWireframe=p,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(p){this._showLayers2DWireframe!==p&&(this._showLayers2DWireframe=p,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(p){this._showLayers3DWireframe!==p&&(this._showLayers3DWireframe=p,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(p){this._speedIndexTiming!==p&&(this._speedIndexTiming=p,this._update())}get showPadding(){return!!this._showPadding}set showPadding(p){this._showPadding!==p&&(this._showPadding=p,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,this._tp.refreshUI(),p?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(p){this._repaint!==p&&(this._repaint=p,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(p){this._vertices=p,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(p){this._showTileAABBs!==p&&(this._showTileAABBs=p,this._tp.refreshUI(),p&&this._update())}_setCacheLimits(p,r){i.dG(p,r)}get version(){return P}},NavigationControl:class{constructor(p={}){this.options=i.l({},gh,p),this._container=le("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(i.aP(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>{this._map&&this._map.zoomIn({},{originalEvent:r})}),le("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>{this._map&&this._map.zoomOut({},{originalEvent:r})}),le("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.aP(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{const l=this._map;l&&(this.options.visualizePitch?l.resetNorthPitch({},{originalEvent:r}):l.resetNorth({},{originalEvent:r}))}),this._compassIcon=le("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const p=this._map;if(!p)return;const r=p.getZoom(),l=r===p.getMaxZoom(),m=r===p.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())}_rotateCompassArrow(){const p=this._map;if(!p)return;const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(p.transform.pitch*(Math.PI/180)),.5)}) rotateX(${p.transform.pitch}deg) rotateZ(${p.transform.angle*(180/Math.PI)}deg)`:`rotate(${p.transform.angle*(180/Math.PI)}deg)`;p._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=r)})}onAdd(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),p.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&p.on("pitch",this._rotateCompassArrow),p.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Zs(p,this._compass,this.options.visualizePitch)),this._container}onRemove(){const p=this._map;p&&(this._container.remove(),this.options.showZoom&&p.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&p.off("pitch",this._rotateCompassArrow),p.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(p,r){const l=le("button",p,this._container);return l.type="button",l.addEventListener("click",r),l}_setButtonTitle(p,r){if(!this._map)return;const l=this._map._getUIString(`NavigationControl.${r}`);p.setAttribute("aria-label",l),p.firstElementChild&&p.firstElementChild.setAttribute("title",l)}},GeolocateControl:class extends i.E{constructor(p={}){super();const r=navigator.geolocation;this.options=i.l({geolocation:r},vo,p),i.aP(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=pd(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(p){return this._map=p,this._container=le("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(p){const r=(l=!!this.options.geolocation)=>{this._supportsGeolocation=l,p(l)};this._supportsGeolocation!==void 0?p(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(l=>r(l.state!=="denied")).catch(()=>r()):r()}_isOutOfMapMaxBounds(p){const r=this._map.getMaxBounds(),l=p.coords;return!!r&&(l.longitude<r.getWest()||l.longitude>r.getEast()||l.latitude<r.getSouth()||l.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(p){if(this._map){if(this._isOutOfMapMaxBounds(p))return this._setErrorState(),this.fire(new i.z("outofmaxbounds",p)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=p,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(p),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(p),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("geolocate",p)),this._finish()}}_updateCamera(p){const r=new i.bO(p.coords.longitude,p.coords.latitude),l=p.coords.accuracy,m=this._map.getBearing(),w=i.l({bearing:m},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(l),w,{geolocateSource:!0})}_updateMarker(p){if(p){const r=new i.bO(p.coords.longitude,p.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=p.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const p=this._map.transform,r=i.bH(1,p._center.lat)*p.worldSize,l=Math.ceil(2*this._accuracy*r);this._circleElement.style.width=`${l}px`,this._circleElement.style.height=`${l}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(p){if(this._map){if(this.options.trackUserLocation)if(p.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(p.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("error",p)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(p){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=le("button","mapboxgl-ctrl-geolocate",this._container),le("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",p===!1){i.w("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=le("div","mapboxgl-user-location"),this._dotElement.appendChild(le("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(le("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new gl({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=le("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new gl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new i.z("trackuserlocationend")))})}}_onDeviceOrientation(p){this._userLocationDotMarker&&(p.webkitCompassHeading?this._heading=p.webkitCompassHeading:p.absolute===!0&&(this._heading=-1*p.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return i.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.z("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.z("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.z("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let p;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(p={maximumAge:6e5,timeout:0},this._noTimeout=!0):(p=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,p),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const p=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&p()}).catch(console.error):p()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:gf,ScaleControl:class{constructor(p={}){this.options=i.l({},qo,p),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),i.aP(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const p=this.options.maxWidth||100,r=this._map,l=r._containerHeight/2,m=r._containerWidth/2-p/2,w=r.unproject([m,l]),T=r.unproject([m+p,l]),I=w.distanceTo(T);if(this.options.unit==="imperial"){const N=3.2808*I;N>5280?this._setScale(p,N/5280,"mile"):this._setScale(p,N,"foot")}else this.options.unit==="nautical"?this._setScale(p,I/1852,"nautical-mile"):I>=1e3?this._setScale(p,I/1e3,"kilometer"):this._setScale(p,I,"meter")}_setScale(p,r,l){this._map._requestDomTask(()=>{const m=function(T){const I=Math.pow(10,`${Math.floor(T)}`.length-1);let N=T/I;return N=N>=10?10:N>=5?5:N>=3?3:N>=2?2:N>=1?1:function(G){const X=Math.pow(10,Math.ceil(-Math.log(G)/Math.LN10));return Math.round(G*X)/X}(N),I*N}(r),w=m/r;this._container.innerHTML=this._isNumberFormatSupported&&l!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:l}).format(m):`${m}&nbsp;${Pa[l]}`,this._container.style.width=p*w+"px"})}onAdd(p){return this._map=p,this._language=p.getLanguage(),this._container=le("div","mapboxgl-ctrl mapboxgl-ctrl-scale",p.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(p){this._language=p,this._update()}setUnit(p){this.options.unit=p,this._update()}},FullscreenControl:class{constructor(p={}){this._fullscreen=!1,p&&p.container&&(p.container instanceof HTMLElement?this._container=p.container:i.w("Full screen control 'container' must be a DOM element.")),i.aP(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=le("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const p=this._fullscreenButton=le("button","mapboxgl-ctrl-fullscreen",this._controlContainer);le("span","mapboxgl-ctrl-icon",p).setAttribute("aria-hidden","true"),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",p)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends i.E{constructor(p){super(),this.options=i.l(Object.create(_u),p),i.aP(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(p&&p.className?p.className.trim().split(/\s+/):[])}addTo(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&p.on("preclick",this._onClose),this.options.closeOnMove&&p.on("move",this._onClose),p.on("remove",this.remove),this._update(),p._addPopup(this),this._focusFirstElement(),this._trackPointer?(p.on("mousemove",this._onMouseEvent),p.on("mouseup",this._onMouseEvent),p._canvasContainer.classList.add("mapboxgl-track-pointer")):p.on("move",this._update),this.fire(new i.z("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const p=this._map;return p&&(p.off("move",this._update),p.off("move",this._onClose),p.off("preclick",this._onClose),p.off("click",this._onClose),p.off("remove",this.remove),p.off("mousemove",this._onMouseEvent),p.off("mouseup",this._onMouseEvent),p.off("drag",this._onMouseEvent),p._canvasContainer&&p._canvasContainer.classList.remove("mapboxgl-track-pointer"),p._removePopup(this),this._map=void 0),this.fire(new i.z("close")),this}getLngLat(){return this._lngLat}setLngLat(p){this._lngLat=i.bO.convert(p),this._pos=null,this._trackPointer=!1,this._update();const r=this._map;return r&&(r.on("move",this._update),r.off("mousemove",this._onMouseEvent),r._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const p=this._map;return p&&(p.off("move",this._update),p.on("mousemove",this._onMouseEvent),p.on("drag",this._onMouseEvent),p._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(p){return this.setDOMContent(document.createTextNode(p))}setHTML(p){const r=document.createDocumentFragment(),l=document.createElement("body");let m;for(l.innerHTML=p;m=l.firstChild,m;)r.appendChild(m);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(p){return this.options.maxWidth=p,this._update(),this}setDOMContent(p){let r=this._content;if(r)for(;r.hasChildNodes();)r.firstChild&&r.removeChild(r.firstChild);else r=this._content=le("div","mapboxgl-popup-content",this._container||void 0);if(r.appendChild(p),this.options.closeButton){const l=this._closeButton=le("button","mapboxgl-popup-close-button",r);l.type="button",l.setAttribute("aria-label","Close popup"),l.innerHTML='<span aria-hidden="true">&#215;</span>',l.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(p){return this._classList.add(p),this._updateClassList(),this}removeClassName(p){return this._classList.delete(p),this._updateClassList(),this}setOffset(p){return this.options.offset=p,this._update(),this}toggleClassName(p){let r;return this._classList.delete(p)?r=!1:(this._classList.add(p),r=!0),this._updateClassList(),r}_onMouseEvent(p){this._update(p.point)}_getAnchor(p){if(this.options.anchor)return this.options.anchor;const r=this._map,l=this._container,m=this._pos;if(!r||!l||!m)return"bottom";const w=l.offsetWidth,T=l.offsetHeight,I=m.x<w/2,N=m.x>r.transform.width-w/2;if(m.y+p<T)return I?"top-left":N?"top-right":"top";if(m.y>r.transform.height-T){if(I)return"bottom-left";if(N)return"bottom-right"}return I?"left":N?"right":"bottom"}_updateClassList(){const p=this._container;if(!p)return;const r=[...this._classList];r.push("mapboxgl-popup"),this._anchor&&r.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&r.push("mapboxgl-popup-track-pointer"),p.className=r.join(" ")}_update(p){const r=this._map,l=this._content;if(!r||!this._lngLat&&!this._trackPointer||!l)return;let m=this._container;if(m||(m=this._container=le("div","mapboxgl-popup",r.getContainer()),this._tip=le("div","mapboxgl-popup-tip",m),m.appendChild(l)),this.options.maxWidth&&m.style.maxWidth!==this.options.maxWidth&&(m.style.maxWidth=this.options.maxWidth),r.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=xd(this._lngLat,this._pos,r.transform)),!this._trackPointer||p){const w=this._pos=this._trackPointer&&p instanceof i.P?p:r.project(this._lngLat),T=bd(this.options.offset),I=this._anchor=this._getAnchor(T.y),N=bd(this.options.offset,I),G=w.add(N).round();r._requestDomTask(()=>{this._container&&I&&(this._container.style.transform=`${Vl[I]} translate(${G.x}px,${G.y}px)`)})}if(!this._marker&&r._showingGlobe()){const w=i.dH(r.transform,this._lngLat)?0:1;this._setOpacity(w)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const p=this._container.querySelector(hi);p&&p.focus()}_onClose(){this.remove()}_setOpacity(p){this._container&&(this._container.style.opacity=`${p}`),this._content&&(this._content.style.pointerEvents=p?"auto":"none")}},Marker:gl,Style:et,LngLat:i.bO,LngLatBounds:i.az,Point:i.P,MercatorCoordinate:i.aa,FreeCameraOptions:Jc,Evented:i.E,config:i.e,prewarm:i.dM,clearPrewarmedResources:i.dN,get accessToken(){return i.e.ACCESS_TOKEN},set accessToken(p){i.e.ACCESS_TOKEN=p},get baseApiUrl(){return i.e.API_URL},set baseApiUrl(p){i.e.API_URL=p},get workerCount(){return i.dO.workerCount},set workerCount(p){i.dO.workerCount=p},get maxParallelImageRequests(){return i.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(p){i.e.MAX_PARALLEL_IMAGE_REQUESTS=p},clearStorage(p){i.dP(p)},get workerUrl(){return i.dQ.workerUrl},set workerUrl(p){i.dQ.workerUrl=p},get workerClass(){return i.dQ.workerClass},set workerClass(p){i.dQ.workerClass=p},get workerParams(){return i.dQ.workerParams},set workerParams(p){i.dQ.workerParams=p},get dracoUrl(){return i.dR()},set dracoUrl(p){i.dS(p)},get meshoptUrl(){return i.dT()},set meshoptUrl(p){i.dU(p)},setNow:i.q.setNow,restoreNow:i.q.restoreNow}});var S=c;return S})}(bb)),bb.exports}var aJ=iJ();const Wy=fa(aJ),_0={type:"FeatureCollection",features:[{type:"Feature",properties:{year:2023,location:"Aceh",magnitude:5.1,depth_km:10},geometry:{type:"Point",coordinates:[95.321,5.556]}},{type:"Feature",properties:{year:2022,location:"Sabang",magnitude:4.8,depth_km:15},geometry:{type:"Point",coordinates:[96.123,4.789]}},{type:"Feature",properties:{year:2024,location:"Nias",magnitude:6.2,depth_km:30},geometry:{type:"Point",coordinates:[97.421,2.789]}},{type:"Feature",properties:{year:2021,location:"Padang",magnitude:5.5,depth_km:25},geometry:{type:"Point",coordinates:[99.567,.912]}},{type:"Feature",properties:{year:2020,location:"Mentawai",magnitude:6.7,depth_km:50},geometry:{type:"Point",coordinates:[100.213,-2.345]}},{type:"Feature",properties:{year:2023,location:"Bengkulu",magnitude:5.9,depth_km:35},geometry:{type:"Point",coordinates:[102.345,-3.789]}},{type:"Feature",properties:{year:2022,location:"Lampung",magnitude:6.3,depth_km:40},geometry:{type:"Point",coordinates:[104.567,-5.112]}},{type:"Feature",properties:{year:2024,location:"Ujung Kulon",magnitude:5.2,depth_km:20},geometry:{type:"Point",coordinates:[105.789,-6.456]}},{type:"Feature",properties:{year:2023,location:"Pelabuhan Ratu",magnitude:4.9,depth_km:15},geometry:{type:"Point",coordinates:[106.987,-7.543]}},{type:"Feature",properties:{year:2021,location:"Cilacap",magnitude:5.6,depth_km:30},geometry:{type:"Point",coordinates:[108.213,-8.789]}},{type:"Feature",properties:{year:2020,location:"Pacitan",magnitude:6.8,depth_km:50},geometry:{type:"Point",coordinates:[110.345,-9.123]}},{type:"Feature",properties:{year:2022,location:"Banyuwangi",magnitude:5.3,depth_km:25},geometry:{type:"Point",coordinates:[113.456,-8.456]}},{type:"Feature",properties:{year:2024,location:"Bali",magnitude:5.9,depth_km:30},geometry:{type:"Point",coordinates:[115.789,-8.789]}},{type:"Feature",properties:{year:2023,location:"Lombok",magnitude:6.5,depth_km:40},geometry:{type:"Point",coordinates:[116.987,-8.234]}},{type:"Feature",properties:{year:2021,location:"Sumbawa",magnitude:5.8,depth_km:35},geometry:{type:"Point",coordinates:[118.345,-8.789]}},{type:"Feature",properties:{year:2020,location:"Flores",magnitude:6.2,depth_km:45},geometry:{type:"Point",coordinates:[120.567,-8.123]}},{type:"Feature",properties:{year:2022,location:"Kupang",magnitude:5.4,depth_km:20},geometry:{type:"Point",coordinates:[123.456,-10.234]}},{type:"Feature",properties:{year:2024,location:"Talaud",magnitude:6.7,depth_km:55},geometry:{type:"Point",coordinates:[126.789,4.567]}},{type:"Feature",properties:{year:2023,location:"Ambon",magnitude:5.9,depth_km:30},geometry:{type:"Point",coordinates:[128.345,-3.456]}},{type:"Feature",properties:{year:2021,location:"Jayapura",magnitude:6.3,depth_km:40},geometry:{type:"Point",coordinates:[140.123,-2.123]}}]},IL={type:"FeatureCollection",features:[{type:"Feature",properties:{category:"GRASS LAND"},geometry:{type:"MultiPolygon",coordinates:[[[[112.32902259145486,-7.458080900132387],[112.32927080199998,-7.457845371000019],[112.329279971,-7.457846656],[112.329280858,-7.457956977],[112.32932169599998,-7.457960823],[112.32932833899999,-7.458289254],[112.329324919,-7.458381922],[112.32935414299999,-7.458628403],[112.32931044100002,-7.458624487],[112.329161123,-7.458616571],[112.32915734200002,-7.458557653],[112.329139619,-7.458471754],[112.32912052300001,-7.458385696],[112.32909313200001,-7.458237665],[112.32902259145486,-7.458080900132387]]]]}},{type:"Feature",properties:{category:"GRASS LAND"},geometry:{type:"MultiPolygon",coordinates:[[[[112.32938793551769,-7.457965942586056],[112.32938051469077,-7.45829571573262],[112.3293283388545,-7.458289253921832],[112.3293216958612,-7.457960822911942],[112.32938793551769,-7.457965942586056]]]]}},{type:"Feature",properties:{category:"URBAN"},geometry:{type:"MultiPolygon",coordinates:[[[[112.3295223526036,-7.458378186773868],[112.32952600738415,-7.458640257992371],[112.32942604012916,-7.458634938069349],[112.32940531970316,-7.458387122880453],[112.32948838673124,-7.458392336589346],[112.32948991227492,-7.458375584634339],[112.3295223526036,-7.458378186773868]]]]}},{type:"Feature",properties:{category:"URBAN"},geometry:{type:"MultiPolygon",coordinates:[[[[112.32942604012916,-7.458634938069349],[112.3293541434848,-7.458628403441951],[112.32932491934899,-7.458381922391013],[112.32940531970316,-7.458387122880453],[112.32942604012916,-7.458634938069349]]]]}},{type:"Feature",properties:{category:"URBAN"},geometry:{type:"MultiPolygon",coordinates:[[[[112.32952600738415,-7.458640257992371],[112.32961979001065,-7.458644940634469],[112.32959867561758,-7.458855639252824],[112.32959304584965,-7.458861996931831],[112.32958666574068,-7.458865163383628],[112.32951694507355,-7.458856011001055],[112.32952600738415,-7.458640257992371]]]]}},{type:"Feature",properties:{category:"URBAN"},geometry:{type:"MultiPolygon",coordinates:[[[[112.32952600738415,-7.458640257992371],[112.32951694507355,-7.458856011001055],[112.32942266526501,-7.458842334734279],[112.32942604012916,-7.458634938069349],[112.32952600738415,-7.458640257992371]]]]}},{type:"Feature",properties:{category:"GRASS LAND"},geometry:{type:"MultiPolygon",coordinates:[[[[112.32942604012916,-7.458634938069349],[112.32942266526501,-7.458842334734279],[112.32932197425284,-7.458835031467065],[112.32932071427979,-7.458752214266815],[112.32930238933437,-7.458750894544147],[112.32931044134158,-7.458624486541191],[112.3293541434848,-7.458628403441951],[112.32942604012916,-7.458634938069349]]]]}},{type:"Feature",properties:{category:"GRASS LAND"},geometry:{type:"MultiPolygon",coordinates:[[[[112.32930238933437,-7.458750894544147],[112.32916005610753,-7.458745470492094],[112.32916112318857,-7.458616570898299],[112.32931044134158,-7.458624486541191],[112.32930238933437,-7.458750894544147]]]]}},{type:"Feature",properties:{category:"URBAN"},geometry:{type:"MultiPolygon",coordinates:[[[[112.329387936,-7.457965943],[112.32971677938708,-7.457989901216706],[112.32966849962482,-7.458343617011323],[112.329477513,-7.458342125],[112.32946641300002,-7.458300904000012],[112.329380515,-7.458295715999981],[112.329387936,-7.457965943]]]]}},{type:"Feature",properties:{category:"AGRICULTURE"},geometry:{type:"MultiPolygon",coordinates:[[[[112.329279971,-7.457846656],[112.32934717899998,-7.457757012],[112.329742805,-7.457683875],[112.329716779,-7.457989901],[112.329387936,-7.457965943],[112.329280858,-7.457956977],[112.329279971,-7.457846656]]]]}},{type:"Feature",properties:{category:"GRASS LAND"},geometry:{type:"MultiPolygon",coordinates:[[[[112.328745201,-7.458508784],[112.32873123600001,-7.458426814],[112.328884891,-7.458410067],[112.32899069800001,-7.458399807000021],[112.32912052300001,-7.458385696],[112.329139619,-7.458471754],[112.328745201,-7.458508784]]]]}},{type:"Feature",properties:{category:"URBAN"},geometry:{type:"MultiPolygon",coordinates:[[[[112.32884112298896,-7.458201090002646],[112.32894729553999,-7.458132815830538],[112.32899069800001,-7.458399807000021],[112.328884891,-7.458410067],[112.32884112298896,-7.458201090002646]]]]}},{type:"Feature",properties:{category:"GRASS LAND"},geometry:{type:"MultiPolygon",coordinates:[[[[112.32899069800001,-7.458399807000021],[112.32894649804693,-7.458127910033312],[112.32902466951697,-7.458085518287589],[112.32909313200001,-7.458237665],[112.32912052300001,-7.458385696],[112.32899069800001,-7.458399807000021]]]]}},{type:"Feature",properties:{category:"URBAN"},geometry:{type:"MultiPolygon",coordinates:[[[[112.328899246,-7.458580425999983],[112.32890330175782,-7.458811587570764],[112.3287571213665,-7.458804938787381],[112.32874371,-7.458592177999989],[112.328899246,-7.458580425999983]]]]}},{type:"Feature",properties:{category:"GRASS LAND"},geometry:{type:"MultiPolygon",coordinates:[[[[112.32930238900002,-7.458750895],[112.329320714,-7.458752214],[112.32932197399998,-7.458835031],[112.32916184055287,-7.458804931708073],[112.329160056,-7.45874547],[112.32930238900002,-7.458750895]]]]}},{type:"Feature",properties:{category:"URBAN"},geometry:{type:"MultiPolygon",coordinates:[[[[112.3287437103214,-7.458592177665679],[112.328745201,-7.458508784],[112.329139619,-7.458471754],[112.32915734200002,-7.458557653],[112.32902057,-7.458569031],[112.328899246,-7.458580425999983],[112.3287437103214,-7.458592177665679]]]]}},{type:"Feature",properties:{category:"URBAN"},geometry:{type:"MultiPolygon",coordinates:[[[[112.32966305293112,-7.458377313018971],[112.32961979,-7.458644941],[112.32952600700001,-7.458640258],[112.32952235299999,-7.458378187],[112.32966305293112,-7.458377313018971]]]]}},{type:"Feature",properties:{category:"URBAN"},geometry:{type:"MultiPolygon",coordinates:[[[[112.32932833899999,-7.458289254],[112.329380515,-7.458295715999981],[112.32946641300002,-7.458300904000012],[112.329477513,-7.458342125],[112.3296685,-7.458343617],[112.32966305293112,-7.458377313018971],[112.32952235299999,-7.458378187],[112.329489912,-7.458375585000013],[112.32948838699998,-7.458392337],[112.32940532,-7.458387123],[112.329324919,-7.458381922],[112.32932833899999,-7.458289254]]]]}},{type:"Feature",properties:{category:"URBAN"},geometry:{type:"MultiPolygon",coordinates:[[[[112.32871919408053,-7.45827360083284],[112.328841909,-7.458204842],[112.328884891,-7.458410067],[112.32873123600001,-7.458426814],[112.32871919408053,-7.45827360083284]]]]}},{type:"Feature",properties:{category:"URBAN"},geometry:{type:"MultiPolygon",coordinates:[[[[112.329160056,-7.45874547],[112.329161841,-7.458804932],[112.32903865399999,-7.458803668],[112.32902057,-7.458569031],[112.32915734200002,-7.458557653],[112.329161123,-7.458616571],[112.329160056,-7.45874547]]]]}},{type:"Feature",properties:{category:"URBAN"},geometry:{type:"MultiPolygon",coordinates:[[[[112.32903846600001,-7.458801232],[112.32890330200001,-7.458811588],[112.328899246,-7.458580425999983],[112.32902057,-7.458569031],[112.32903846600001,-7.458801232]]]]}},{type:"Feature",properties:{category:"AGRICULTURE"},geometry:{type:"MultiPolygon",coordinates:[[[[112.3293471792897,-7.457757011769658],[112.32948562338264,-7.457611847835693],[112.32956577932444,-7.457526963251468],[112.32963283454981,-7.457495048996606],[112.32976292168703,-7.457433880001659],[112.32974280511941,-7.457683874970598],[112.3293471792897,-7.457757011769658]]]]}}]};function tV(e){var t,a,o="";if(typeof e=="string"||typeof e=="number")o+=e;else if(typeof e=="object")if(Array.isArray(e)){var c=e.length;for(t=0;t<c;t++)e[t]&&(a=tV(e[t]))&&(o&&(o+=" "),o+=a)}else for(a in e)e[a]&&(o&&(o+=" "),o+=a);return o}function ia(){for(var e,t,a=0,o="",c=arguments.length;a<c;a++)(e=arguments[a])&&(t=tV(e))&&(o&&(o+=" "),o+=t);return o}var dT,CL;function Su(){if(CL)return dT;CL=1;var e=Array.isArray;return dT=e,dT}var pT,PL;function nV(){if(PL)return pT;PL=1;var e=typeof j1=="object"&&j1&&j1.Object===Object&&j1;return pT=e,pT}var mT,RL;function qf(){if(RL)return mT;RL=1;var e=nV(),t=typeof self=="object"&&self&&self.Object===Object&&self,a=e||t||Function("return this")();return mT=a,mT}var gT,kL;function Sx(){if(kL)return gT;kL=1;var e=qf(),t=e.Symbol;return gT=t,gT}var yT,DL;function oJ(){if(DL)return yT;DL=1;var e=Sx(),t=Object.prototype,a=t.hasOwnProperty,o=t.toString,c=e?e.toStringTag:void 0;function b(S){var i=a.call(S,c),P=S[c];try{S[c]=void 0;var L=!0}catch{}var U=o.call(S);return L&&(i?S[c]=P:delete S[c]),U}return yT=b,yT}var _T,LL;function sJ(){if(LL)return _T;LL=1;var e=Object.prototype,t=e.toString;function a(o){return t.call(o)}return _T=a,_T}var vT,zL;function Qd(){if(zL)return vT;zL=1;var e=Sx(),t=oJ(),a=sJ(),o="[object Null]",c="[object Undefined]",b=e?e.toStringTag:void 0;function S(i){return i==null?i===void 0?c:o:b&&b in Object(i)?t(i):a(i)}return vT=S,vT}var xT,NL;function ep(){if(NL)return xT;NL=1;function e(t){return t!=null&&typeof t=="object"}return xT=e,xT}var bT,BL;function L_(){if(BL)return bT;BL=1;var e=Qd(),t=ep(),a="[object Symbol]";function o(c){return typeof c=="symbol"||t(c)&&e(c)==a}return bT=o,bT}var wT,FL;function fP(){if(FL)return wT;FL=1;var e=Su(),t=L_(),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;function c(b,S){if(e(b))return!1;var i=typeof b;return i=="number"||i=="symbol"||i=="boolean"||b==null||t(b)?!0:o.test(b)||!a.test(b)||S!=null&&b in Object(S)}return wT=c,wT}var ST,jL;function cm(){if(jL)return ST;jL=1;function e(t){var a=typeof t;return t!=null&&(a=="object"||a=="function")}return ST=e,ST}var TT,UL;function dP(){if(UL)return TT;UL=1;var e=Qd(),t=cm(),a="[object AsyncFunction]",o="[object Function]",c="[object GeneratorFunction]",b="[object Proxy]";function S(i){if(!t(i))return!1;var P=e(i);return P==o||P==c||P==a||P==b}return TT=S,TT}var ET,VL;function lJ(){if(VL)return ET;VL=1;var e=qf(),t=e["__core-js_shared__"];return ET=t,ET}var AT,qL;function uJ(){if(qL)return AT;qL=1;var e=lJ(),t=function(){var o=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}();function a(o){return!!t&&t in o}return AT=a,AT}var MT,GL;function rV(){if(GL)return MT;GL=1;var e=Function.prototype,t=e.toString;function a(o){if(o!=null){try{return t.call(o)}catch{}try{return o+""}catch{}}return""}return MT=a,MT}var OT,$L;function cJ(){if($L)return OT;$L=1;var e=dP(),t=uJ(),a=cm(),o=rV(),c=/[\\^$.*+?()[\]{}|]/g,b=/^\[object .+?Constructor\]$/,S=Function.prototype,i=Object.prototype,P=S.toString,L=i.hasOwnProperty,U=RegExp("^"+P.call(L).replace(c,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function V(H){if(!a(H)||t(H))return!1;var ee=e(H)?U:b;return ee.test(o(H))}return OT=V,OT}var IT,HL;function hJ(){if(HL)return IT;HL=1;function e(t,a){return t==null?void 0:t[a]}return IT=e,IT}var CT,XL;function Ig(){if(XL)return CT;XL=1;var e=cJ(),t=hJ();function a(o,c){var b=t(o,c);return e(b)?b:void 0}return CT=a,CT}var PT,YL;function Zw(){if(YL)return PT;YL=1;var e=Ig(),t=e(Object,"create");return PT=t,PT}var RT,ZL;function fJ(){if(ZL)return RT;ZL=1;var e=Zw();function t(){this.__data__=e?e(null):{},this.size=0}return RT=t,RT}var kT,WL;function dJ(){if(WL)return kT;WL=1;function e(t){var a=this.has(t)&&delete this.__data__[t];return this.size-=a?1:0,a}return kT=e,kT}var DT,KL;function pJ(){if(KL)return DT;KL=1;var e=Zw(),t="__lodash_hash_undefined__",a=Object.prototype,o=a.hasOwnProperty;function c(b){var S=this.__data__;if(e){var i=S[b];return i===t?void 0:i}return o.call(S,b)?S[b]:void 0}return DT=c,DT}var LT,JL;function mJ(){if(JL)return LT;JL=1;var e=Zw(),t=Object.prototype,a=t.hasOwnProperty;function o(c){var b=this.__data__;return e?b[c]!==void 0:a.call(b,c)}return LT=o,LT}var zT,QL;function gJ(){if(QL)return zT;QL=1;var e=Zw(),t="__lodash_hash_undefined__";function a(o,c){var b=this.__data__;return this.size+=this.has(o)?0:1,b[o]=e&&c===void 0?t:c,this}return zT=a,zT}var NT,ez;function yJ(){if(ez)return NT;ez=1;var e=fJ(),t=dJ(),a=pJ(),o=mJ(),c=gJ();function b(S){var i=-1,P=S==null?0:S.length;for(this.clear();++i<P;){var L=S[i];this.set(L[0],L[1])}}return b.prototype.clear=e,b.prototype.delete=t,b.prototype.get=a,b.prototype.has=o,b.prototype.set=c,NT=b,NT}var BT,tz;function _J(){if(tz)return BT;tz=1;function e(){this.__data__=[],this.size=0}return BT=e,BT}var FT,nz;function pP(){if(nz)return FT;nz=1;function e(t,a){return t===a||t!==t&&a!==a}return FT=e,FT}var jT,rz;function Ww(){if(rz)return jT;rz=1;var e=pP();function t(a,o){for(var c=a.length;c--;)if(e(a[c][0],o))return c;return-1}return jT=t,jT}var UT,iz;function vJ(){if(iz)return UT;iz=1;var e=Ww(),t=Array.prototype,a=t.splice;function o(c){var b=this.__data__,S=e(b,c);if(S<0)return!1;var i=b.length-1;return S==i?b.pop():a.call(b,S,1),--this.size,!0}return UT=o,UT}var VT,az;function xJ(){if(az)return VT;az=1;var e=Ww();function t(a){var o=this.__data__,c=e(o,a);return c<0?void 0:o[c][1]}return VT=t,VT}var qT,oz;function bJ(){if(oz)return qT;oz=1;var e=Ww();function t(a){return e(this.__data__,a)>-1}return qT=t,qT}var GT,sz;function wJ(){if(sz)return GT;sz=1;var e=Ww();function t(a,o){var c=this.__data__,b=e(c,a);return b<0?(++this.size,c.push([a,o])):c[b][1]=o,this}return GT=t,GT}var $T,lz;function Kw(){if(lz)return $T;lz=1;var e=_J(),t=vJ(),a=xJ(),o=bJ(),c=wJ();function b(S){var i=-1,P=S==null?0:S.length;for(this.clear();++i<P;){var L=S[i];this.set(L[0],L[1])}}return b.prototype.clear=e,b.prototype.delete=t,b.prototype.get=a,b.prototype.has=o,b.prototype.set=c,$T=b,$T}var HT,uz;function mP(){if(uz)return HT;uz=1;var e=Ig(),t=qf(),a=e(t,"Map");return HT=a,HT}var XT,cz;function SJ(){if(cz)return XT;cz=1;var e=yJ(),t=Kw(),a=mP();function o(){this.size=0,this.__data__={hash:new e,map:new(a||t),string:new e}}return XT=o,XT}var YT,hz;function TJ(){if(hz)return YT;hz=1;function e(t){var a=typeof t;return a=="string"||a=="number"||a=="symbol"||a=="boolean"?t!=="__proto__":t===null}return YT=e,YT}var ZT,fz;function Jw(){if(fz)return ZT;fz=1;var e=TJ();function t(a,o){var c=a.__data__;return e(o)?c[typeof o=="string"?"string":"hash"]:c.map}return ZT=t,ZT}var WT,dz;function EJ(){if(dz)return WT;dz=1;var e=Jw();function t(a){var o=e(this,a).delete(a);return this.size-=o?1:0,o}return WT=t,WT}var KT,pz;function AJ(){if(pz)return KT;pz=1;var e=Jw();function t(a){return e(this,a).get(a)}return KT=t,KT}var JT,mz;function MJ(){if(mz)return JT;mz=1;var e=Jw();function t(a){return e(this,a).has(a)}return JT=t,JT}var QT,gz;function OJ(){if(gz)return QT;gz=1;var e=Jw();function t(a,o){var c=e(this,a),b=c.size;return c.set(a,o),this.size+=c.size==b?0:1,this}return QT=t,QT}var eE,yz;function gP(){if(yz)return eE;yz=1;var e=SJ(),t=EJ(),a=AJ(),o=MJ(),c=OJ();function b(S){var i=-1,P=S==null?0:S.length;for(this.clear();++i<P;){var L=S[i];this.set(L[0],L[1])}}return b.prototype.clear=e,b.prototype.delete=t,b.prototype.get=a,b.prototype.has=o,b.prototype.set=c,eE=b,eE}var tE,_z;function iV(){if(_z)return tE;_z=1;var e=gP(),t="Expected a function";function a(o,c){if(typeof o!="function"||c!=null&&typeof c!="function")throw new TypeError(t);var b=function(){var S=arguments,i=c?c.apply(this,S):S[0],P=b.cache;if(P.has(i))return P.get(i);var L=o.apply(this,S);return b.cache=P.set(i,L)||P,L};return b.cache=new(a.Cache||e),b}return a.Cache=e,tE=a,tE}var nE,vz;function IJ(){if(vz)return nE;vz=1;var e=iV(),t=500;function a(o){var c=e(o,function(S){return b.size===t&&b.clear(),S}),b=c.cache;return c}return nE=a,nE}var rE,xz;function CJ(){if(xz)return rE;xz=1;var e=IJ(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g,o=e(function(c){var b=[];return c.charCodeAt(0)===46&&b.push(""),c.replace(t,function(S,i,P,L){b.push(P?L.replace(a,"$1"):i||S)}),b});return rE=o,rE}var iE,bz;function yP(){if(bz)return iE;bz=1;function e(t,a){for(var o=-1,c=t==null?0:t.length,b=Array(c);++o<c;)b[o]=a(t[o],o,t);return b}return iE=e,iE}var aE,wz;function PJ(){if(wz)return aE;wz=1;var e=Sx(),t=yP(),a=Su(),o=L_(),c=e?e.prototype:void 0,b=c?c.toString:void 0;function S(i){if(typeof i=="string")return i;if(a(i))return t(i,S)+"";if(o(i))return b?b.call(i):"";var P=i+"";return P=="0"&&1/i==-1/0?"-0":P}return aE=S,aE}var oE,Sz;function aV(){if(Sz)return oE;Sz=1;var e=PJ();function t(a){return a==null?"":e(a)}return oE=t,oE}var sE,Tz;function oV(){if(Tz)return sE;Tz=1;var e=Su(),t=fP(),a=CJ(),o=aV();function c(b,S){return e(b)?b:t(b,S)?[b]:a(o(b))}return sE=c,sE}var lE,Ez;function Qw(){if(Ez)return lE;Ez=1;var e=L_();function t(a){if(typeof a=="string"||e(a))return a;var o=a+"";return o=="0"&&1/a==-1/0?"-0":o}return lE=t,lE}var uE,Az;function _P(){if(Az)return uE;Az=1;var e=oV(),t=Qw();function a(o,c){c=e(c,o);for(var b=0,S=c.length;o!=null&&b<S;)o=o[t(c[b++])];return b&&b==S?o:void 0}return uE=a,uE}var cE,Mz;function sV(){if(Mz)return cE;Mz=1;var e=_P();function t(a,o,c){var b=a==null?void 0:e(a,o);return b===void 0?c:b}return cE=t,cE}var RJ=sV();const $c=fa(RJ);var hE,Oz;function kJ(){if(Oz)return hE;Oz=1;function e(t){return t==null}return hE=e,hE}var DJ=kJ();const vi=fa(DJ);var fE,Iz;function LJ(){if(Iz)return fE;Iz=1;var e=Qd(),t=Su(),a=ep(),o="[object String]";function c(b){return typeof b=="string"||!t(b)&&a(b)&&e(b)==o}return fE=c,fE}var zJ=LJ();const Tx=fa(zJ);var NJ=dP();const _i=fa(NJ);var BJ=cm();const z_=fa(BJ);var dE={exports:{}},sa={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cz;function FJ(){if(Cz)return sa;Cz=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),b=Symbol.for("react.provider"),S=Symbol.for("react.context"),i=Symbol.for("react.server_context"),P=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),U=Symbol.for("react.suspense_list"),V=Symbol.for("react.memo"),H=Symbol.for("react.lazy"),ee=Symbol.for("react.offscreen"),ie;ie=Symbol.for("react.module.reference");function le(ue){if(typeof ue=="object"&&ue!==null){var ge=ue.$$typeof;switch(ge){case e:switch(ue=ue.type,ue){case a:case c:case o:case L:case U:return ue;default:switch(ue=ue&&ue.$$typeof,ue){case i:case S:case P:case H:case V:case b:return ue;default:return ge}}case t:return ge}}}return sa.ContextConsumer=S,sa.ContextProvider=b,sa.Element=e,sa.ForwardRef=P,sa.Fragment=a,sa.Lazy=H,sa.Memo=V,sa.Portal=t,sa.Profiler=c,sa.StrictMode=o,sa.Suspense=L,sa.SuspenseList=U,sa.isAsyncMode=function(){return!1},sa.isConcurrentMode=function(){return!1},sa.isContextConsumer=function(ue){return le(ue)===S},sa.isContextProvider=function(ue){return le(ue)===b},sa.isElement=function(ue){return typeof ue=="object"&&ue!==null&&ue.$$typeof===e},sa.isForwardRef=function(ue){return le(ue)===P},sa.isFragment=function(ue){return le(ue)===a},sa.isLazy=function(ue){return le(ue)===H},sa.isMemo=function(ue){return le(ue)===V},sa.isPortal=function(ue){return le(ue)===t},sa.isProfiler=function(ue){return le(ue)===c},sa.isStrictMode=function(ue){return le(ue)===o},sa.isSuspense=function(ue){return le(ue)===L},sa.isSuspenseList=function(ue){return le(ue)===U},sa.isValidElementType=function(ue){return typeof ue=="string"||typeof ue=="function"||ue===a||ue===c||ue===o||ue===L||ue===U||ue===ee||typeof ue=="object"&&ue!==null&&(ue.$$typeof===H||ue.$$typeof===V||ue.$$typeof===b||ue.$$typeof===S||ue.$$typeof===P||ue.$$typeof===ie||ue.getModuleId!==void 0)},sa.typeOf=le,sa}var Pz;function jJ(){return Pz||(Pz=1,dE.exports=FJ()),dE.exports}var UJ=jJ(),pE,Rz;function lV(){if(Rz)return pE;Rz=1;var e=Qd(),t=ep(),a="[object Number]";function o(c){return typeof c=="number"||t(c)&&e(c)==a}return pE=o,pE}var mE,kz;function VJ(){if(kz)return mE;kz=1;var e=lV();function t(a){return e(a)&&a!=+a}return mE=t,mE}var qJ=VJ();const Ex=fa(qJ);var GJ=lV();const $J=fa(GJ);var Rh=function(t){return t===0?0:t>0?1:-1},dg=function(t){return Tx(t)&&t.indexOf("%")===t.length-1},er=function(t){return $J(t)&&!Ex(t)},os=function(t){return er(t)||Tx(t)},HJ=0,Ax=function(t){var a=++HJ;return"".concat(t||"").concat(a)},Sg=function(t,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!er(t)&&!Tx(t))return o;var b;if(dg(t)){var S=t.indexOf("%");b=a*parseFloat(t.slice(0,S))/100}else b=+t;return Ex(b)&&(b=o),c&&b>a&&(b=a),b},Qp=function(t){if(!t)return null;var a=Object.keys(t);return a&&a.length?t[a[0]]:null},XJ=function(t){if(!Array.isArray(t))return!1;for(var a=t.length,o={},c=0;c<a;c++)if(!o[t[c]])o[t[c]]=!0;else return!0;return!1},Cf=function(t,a){return er(t)&&er(a)?function(o){return t+o*(a-t)}:function(){return a}};function Lb(e,t,a){return!e||!e.length?null:e.find(function(o){return o&&(typeof t=="function"?t(o):$c(o,t))===a})}var YJ=function(t){if(!t||!t.length)return null;for(var a=t.length,o=0,c=0,b=0,S=0,i=1/0,P=-1/0,L=0,U=0,V=0;V<a;V++)L=t[V].cx||0,U=t[V].cy||0,o+=L,c+=U,b+=L*U,S+=L*L,i=Math.min(i,L),P=Math.max(P,L);var H=a*S!==o*o?(a*b-o*c)/(a*S-o*o):0;return{xmin:i,xmax:P,a:H,b:(c-H*o)/a}};function Ky(e,t){for(var a in e)if({}.hasOwnProperty.call(e,a)&&(!{}.hasOwnProperty.call(t,a)||e[a]!==t[a]))return!1;for(var o in t)if({}.hasOwnProperty.call(t,o)&&!{}.hasOwnProperty.call(e,o))return!1;return!0}function YO(e){"@babel/helpers - typeof";return YO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},YO(e)}var ZJ=["viewBox","children"],WJ=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],Dz=["points","pathLength"],gE={svg:ZJ,polygon:Dz,polyline:Dz},vP=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],zb=function(t,a){if(!t||typeof t=="function"||typeof t=="boolean")return null;var o=t;if(Jt.isValidElement(t)&&(o=t.props),!z_(o))return null;var c={};return Object.keys(o).forEach(function(b){vP.includes(b)&&(c[b]=a||function(S){return o[b](o,S)})}),c},KJ=function(t,a,o){return function(c){return t(a,o,c),null}},k0=function(t,a,o){if(!z_(t)||YO(t)!=="object")return null;var c=null;return Object.keys(t).forEach(function(b){var S=t[b];vP.includes(b)&&typeof S=="function"&&(c||(c={}),c[b]=KJ(S,a,o))}),c},JJ=["children"],QJ=["children"];function Lz(e,t){if(e==null)return{};var a=eQ(e,t),o,c;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(c=0;c<b.length;c++)o=b[c],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function eQ(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}var zz={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Vd=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},Nz=null,yE=null,xP=function e(t){if(t===Nz&&Array.isArray(yE))return yE;var a=[];return Jt.Children.forEach(t,function(o){vi(o)||(UJ.isFragment(o)?a=a.concat(e(o.props.children)):a.push(o))}),yE=a,Nz=t,a};function Ju(e,t){var a=[],o=[];return Array.isArray(t)?o=t.map(function(c){return Vd(c)}):o=[Vd(t)],xP(e).forEach(function(c){var b=$c(c,"type.displayName")||$c(c,"type.name");o.indexOf(b)!==-1&&a.push(c)}),a}function Wu(e,t){var a=Ju(e,t);return a&&a[0]}var Bz=function(t){if(!t||!t.props)return!1;var a=t.props,o=a.width,c=a.height;return!(!er(o)||o<=0||!er(c)||c<=0)},tQ=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],nQ=function(t){return t&&t.type&&Tx(t.type)&&tQ.indexOf(t.type)>=0},rQ=function(t,a,o,c){var b,S=(b=gE==null?void 0:gE[c])!==null&&b!==void 0?b:[];return!_i(t)&&(c&&S.includes(a)||WJ.includes(a))||o&&vP.includes(a)},ji=function(t,a,o){if(!t||typeof t=="function"||typeof t=="boolean")return null;var c=t;if(Jt.isValidElement(t)&&(c=t.props),!z_(c))return null;var b={};return Object.keys(c).forEach(function(S){var i;rQ((i=c)===null||i===void 0?void 0:i[S],S,a,o)&&(b[S]=c[S])}),b},ZO=function e(t,a){if(t===a)return!0;var o=Jt.Children.count(t);if(o!==Jt.Children.count(a))return!1;if(o===0)return!0;if(o===1)return Fz(Array.isArray(t)?t[0]:t,Array.isArray(a)?a[0]:a);for(var c=0;c<o;c++){var b=t[c],S=a[c];if(Array.isArray(b)||Array.isArray(S)){if(!e(b,S))return!1}else if(!Fz(b,S))return!1}return!0},Fz=function(t,a){if(vi(t)&&vi(a))return!0;if(!vi(t)&&!vi(a)){var o=t.props||{},c=o.children,b=Lz(o,JJ),S=a.props||{},i=S.children,P=Lz(S,QJ);return c&&i?Ky(b,P)&&ZO(c,i):!c&&!i?Ky(b,P):!1}return!1},jz=function(t,a){var o=[],c={};return xP(t).forEach(function(b,S){if(nQ(b))o.push(b);else if(b){var i=Vd(b.type),P=a[i]||{},L=P.handler,U=P.once;if(L&&(!U||!c[i])){var V=L(b,i,S);o.push(V),c[i]=!0}}}),o},iQ=function(t){var a=t&&t.type;return a&&zz[a]?zz[a]:null},aQ=function(t,a){return xP(a).indexOf(t)},oQ=["children","width","height","viewBox","className","style","title","desc"];function WO(){return WO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},WO.apply(this,arguments)}function sQ(e,t){if(e==null)return{};var a=lQ(e,t),o,c;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(c=0;c<b.length;c++)o=b[c],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function lQ(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function KO(e){var t=e.children,a=e.width,o=e.height,c=e.viewBox,b=e.className,S=e.style,i=e.title,P=e.desc,L=sQ(e,oQ),U=c||{width:a,height:o,x:0,y:0},V=ia("recharts-surface",b);return kt.createElement("svg",WO({},ji(L,!0,"svg"),{className:V,width:a,height:o,style:S,viewBox:"".concat(U.x," ").concat(U.y," ").concat(U.width," ").concat(U.height)}),kt.createElement("title",null,i),kt.createElement("desc",null,P),t)}var uQ=["children","className"];function JO(){return JO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},JO.apply(this,arguments)}function cQ(e,t){if(e==null)return{};var a=hQ(e,t),o,c;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(c=0;c<b.length;c++)o=b[c],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function hQ(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}var mo=kt.forwardRef(function(e,t){var a=e.children,o=e.className,c=cQ(e,uQ),b=ia("recharts-layer",o);return kt.createElement("g",JO({className:b},ji(c,!0),{ref:t}),a)}),qd=function(t,a){for(var o=arguments.length,c=new Array(o>2?o-2:0),b=2;b<o;b++)c[b-2]=arguments[b]},_E,Uz;function fQ(){if(Uz)return _E;Uz=1;function e(t,a,o){var c=-1,b=t.length;a<0&&(a=-a>b?0:b+a),o=o>b?b:o,o<0&&(o+=b),b=a>o?0:o-a>>>0,a>>>=0;for(var S=Array(b);++c<b;)S[c]=t[c+a];return S}return _E=e,_E}var vE,Vz;function dQ(){if(Vz)return vE;Vz=1;var e=fQ();function t(a,o,c){var b=a.length;return c=c===void 0?b:c,!o&&c>=b?a:e(a,o,c)}return vE=t,vE}var xE,qz;function uV(){if(qz)return xE;qz=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",a="\\ufe20-\\ufe2f",o="\\u20d0-\\u20ff",c=t+a+o,b="\\ufe0e\\ufe0f",S="\\u200d",i=RegExp("["+S+e+c+b+"]");function P(L){return i.test(L)}return xE=P,xE}var bE,Gz;function pQ(){if(Gz)return bE;Gz=1;function e(t){return t.split("")}return bE=e,bE}var wE,$z;function mQ(){if($z)return wE;$z=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",a="\\ufe20-\\ufe2f",o="\\u20d0-\\u20ff",c=t+a+o,b="\\ufe0e\\ufe0f",S="["+e+"]",i="["+c+"]",P="\\ud83c[\\udffb-\\udfff]",L="(?:"+i+"|"+P+")",U="[^"+e+"]",V="(?:\\ud83c[\\udde6-\\uddff]){2}",H="[\\ud800-\\udbff][\\udc00-\\udfff]",ee="\\u200d",ie=L+"?",le="["+b+"]?",ue="(?:"+ee+"(?:"+[U,V,H].join("|")+")"+le+ie+")*",ge=le+ie+ue,Se="(?:"+[U+i+"?",i,V,H,S].join("|")+")",ve=RegExp(P+"(?="+P+")|"+Se+ge,"g");function Ee(me){return me.match(ve)||[]}return wE=Ee,wE}var SE,Hz;function gQ(){if(Hz)return SE;Hz=1;var e=pQ(),t=uV(),a=mQ();function o(c){return t(c)?a(c):e(c)}return SE=o,SE}var TE,Xz;function yQ(){if(Xz)return TE;Xz=1;var e=dQ(),t=uV(),a=gQ(),o=aV();function c(b){return function(S){S=o(S);var i=t(S)?a(S):void 0,P=i?i[0]:S.charAt(0),L=i?e(i,1).join(""):S.slice(1);return P[b]()+L}}return TE=c,TE}var EE,Yz;function _Q(){if(Yz)return EE;Yz=1;var e=yQ(),t=e("toUpperCase");return EE=t,EE}var vQ=_Q();const e2=fa(vQ);function Da(e){return function(){return e}}const cV=Math.cos,Nb=Math.sin,Dh=Math.sqrt,Bb=Math.PI,t2=2*Bb,QO=Math.PI,eI=2*QO,lg=1e-6,xQ=eI-lg;function hV(e){this._+=e[0];for(let t=1,a=e.length;t<a;++t)this._+=arguments[t]+e[t]}function bQ(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return hV;const a=10**t;return function(o){this._+=o[0];for(let c=1,b=o.length;c<b;++c)this._+=Math.round(arguments[c]*a)/a+o[c]}}class wQ{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?hV:bQ(t)}moveTo(t,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+a}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,a){this._append`L${this._x1=+t},${this._y1=+a}`}quadraticCurveTo(t,a,o,c){this._append`Q${+t},${+a},${this._x1=+o},${this._y1=+c}`}bezierCurveTo(t,a,o,c,b,S){this._append`C${+t},${+a},${+o},${+c},${this._x1=+b},${this._y1=+S}`}arcTo(t,a,o,c,b){if(t=+t,a=+a,o=+o,c=+c,b=+b,b<0)throw new Error(`negative radius: ${b}`);let S=this._x1,i=this._y1,P=o-t,L=c-a,U=S-t,V=i-a,H=U*U+V*V;if(this._x1===null)this._append`M${this._x1=t},${this._y1=a}`;else if(H>lg)if(!(Math.abs(V*P-L*U)>lg)||!b)this._append`L${this._x1=t},${this._y1=a}`;else{let ee=o-S,ie=c-i,le=P*P+L*L,ue=ee*ee+ie*ie,ge=Math.sqrt(le),Se=Math.sqrt(H),ve=b*Math.tan((QO-Math.acos((le+H-ue)/(2*ge*Se)))/2),Ee=ve/Se,me=ve/ge;Math.abs(Ee-1)>lg&&this._append`L${t+Ee*U},${a+Ee*V}`,this._append`A${b},${b},0,0,${+(V*ee>U*ie)},${this._x1=t+me*P},${this._y1=a+me*L}`}}arc(t,a,o,c,b,S){if(t=+t,a=+a,o=+o,S=!!S,o<0)throw new Error(`negative radius: ${o}`);let i=o*Math.cos(c),P=o*Math.sin(c),L=t+i,U=a+P,V=1^S,H=S?c-b:b-c;this._x1===null?this._append`M${L},${U}`:(Math.abs(this._x1-L)>lg||Math.abs(this._y1-U)>lg)&&this._append`L${L},${U}`,o&&(H<0&&(H=H%eI+eI),H>xQ?this._append`A${o},${o},0,1,${V},${t-i},${a-P}A${o},${o},0,1,${V},${this._x1=L},${this._y1=U}`:H>lg&&this._append`A${o},${o},0,${+(H>=QO)},${V},${this._x1=t+o*Math.cos(b)},${this._y1=a+o*Math.sin(b)}`)}rect(t,a,o,c){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+a}h${o=+o}v${+c}h${-o}Z`}toString(){return this._}}function bP(e){let t=3;return e.digits=function(a){if(!arguments.length)return t;if(a==null)t=null;else{const o=Math.floor(a);if(!(o>=0))throw new RangeError(`invalid digits: ${a}`);t=o}return e},()=>new wQ(t)}function wP(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function fV(e){this._context=e}fV.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function n2(e){return new fV(e)}function dV(e){return e[0]}function pV(e){return e[1]}function mV(e,t){var a=Da(!0),o=null,c=n2,b=null,S=bP(i);e=typeof e=="function"?e:e===void 0?dV:Da(e),t=typeof t=="function"?t:t===void 0?pV:Da(t);function i(P){var L,U=(P=wP(P)).length,V,H=!1,ee;for(o==null&&(b=c(ee=S())),L=0;L<=U;++L)!(L<U&&a(V=P[L],L,P))===H&&((H=!H)?b.lineStart():b.lineEnd()),H&&b.point(+e(V,L,P),+t(V,L,P));if(ee)return b=null,ee+""||null}return i.x=function(P){return arguments.length?(e=typeof P=="function"?P:Da(+P),i):e},i.y=function(P){return arguments.length?(t=typeof P=="function"?P:Da(+P),i):t},i.defined=function(P){return arguments.length?(a=typeof P=="function"?P:Da(!!P),i):a},i.curve=function(P){return arguments.length?(c=P,o!=null&&(b=c(o)),i):c},i.context=function(P){return arguments.length?(P==null?o=b=null:b=c(o=P),i):o},i}function H1(e,t,a){var o=null,c=Da(!0),b=null,S=n2,i=null,P=bP(L);e=typeof e=="function"?e:e===void 0?dV:Da(+e),t=typeof t=="function"?t:Da(t===void 0?0:+t),a=typeof a=="function"?a:a===void 0?pV:Da(+a);function L(V){var H,ee,ie,le=(V=wP(V)).length,ue,ge=!1,Se,ve=new Array(le),Ee=new Array(le);for(b==null&&(i=S(Se=P())),H=0;H<=le;++H){if(!(H<le&&c(ue=V[H],H,V))===ge)if(ge=!ge)ee=H,i.areaStart(),i.lineStart();else{for(i.lineEnd(),i.lineStart(),ie=H-1;ie>=ee;--ie)i.point(ve[ie],Ee[ie]);i.lineEnd(),i.areaEnd()}ge&&(ve[H]=+e(ue,H,V),Ee[H]=+t(ue,H,V),i.point(o?+o(ue,H,V):ve[H],a?+a(ue,H,V):Ee[H]))}if(Se)return i=null,Se+""||null}function U(){return mV().defined(c).curve(S).context(b)}return L.x=function(V){return arguments.length?(e=typeof V=="function"?V:Da(+V),o=null,L):e},L.x0=function(V){return arguments.length?(e=typeof V=="function"?V:Da(+V),L):e},L.x1=function(V){return arguments.length?(o=V==null?null:typeof V=="function"?V:Da(+V),L):o},L.y=function(V){return arguments.length?(t=typeof V=="function"?V:Da(+V),a=null,L):t},L.y0=function(V){return arguments.length?(t=typeof V=="function"?V:Da(+V),L):t},L.y1=function(V){return arguments.length?(a=V==null?null:typeof V=="function"?V:Da(+V),L):a},L.lineX0=L.lineY0=function(){return U().x(e).y(t)},L.lineY1=function(){return U().x(e).y(a)},L.lineX1=function(){return U().x(o).y(t)},L.defined=function(V){return arguments.length?(c=typeof V=="function"?V:Da(!!V),L):c},L.curve=function(V){return arguments.length?(S=V,b!=null&&(i=S(b)),L):S},L.context=function(V){return arguments.length?(V==null?b=i=null:i=S(b=V),L):b},L}class gV{constructor(t,a){this._context=t,this._x=a}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,a){switch(t=+t,a=+a,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,a):this._context.moveTo(t,a);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,a,t,a):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+a)/2,t,this._y0,t,a);break}}this._x0=t,this._y0=a}}function SQ(e){return new gV(e,!0)}function TQ(e){return new gV(e,!1)}const SP={draw(e,t){const a=Dh(t/Bb);e.moveTo(a,0),e.arc(0,0,a,0,t2)}},EQ={draw(e,t){const a=Dh(t/5)/2;e.moveTo(-3*a,-a),e.lineTo(-a,-a),e.lineTo(-a,-3*a),e.lineTo(a,-3*a),e.lineTo(a,-a),e.lineTo(3*a,-a),e.lineTo(3*a,a),e.lineTo(a,a),e.lineTo(a,3*a),e.lineTo(-a,3*a),e.lineTo(-a,a),e.lineTo(-3*a,a),e.closePath()}},yV=Dh(1/3),AQ=yV*2,MQ={draw(e,t){const a=Dh(t/AQ),o=a*yV;e.moveTo(0,-a),e.lineTo(o,0),e.lineTo(0,a),e.lineTo(-o,0),e.closePath()}},OQ={draw(e,t){const a=Dh(t),o=-a/2;e.rect(o,o,a,a)}},IQ=.8908130915292852,_V=Nb(Bb/10)/Nb(7*Bb/10),CQ=Nb(t2/10)*_V,PQ=-cV(t2/10)*_V,RQ={draw(e,t){const a=Dh(t*IQ),o=CQ*a,c=PQ*a;e.moveTo(0,-a),e.lineTo(o,c);for(let b=1;b<5;++b){const S=t2*b/5,i=cV(S),P=Nb(S);e.lineTo(P*a,-i*a),e.lineTo(i*o-P*c,P*o+i*c)}e.closePath()}},AE=Dh(3),kQ={draw(e,t){const a=-Dh(t/(AE*3));e.moveTo(0,a*2),e.lineTo(-AE*a,-a),e.lineTo(AE*a,-a),e.closePath()}},Fc=-.5,jc=Dh(3)/2,tI=1/Dh(12),DQ=(tI/2+1)*3,LQ={draw(e,t){const a=Dh(t/DQ),o=a/2,c=a*tI,b=o,S=a*tI+a,i=-b,P=S;e.moveTo(o,c),e.lineTo(b,S),e.lineTo(i,P),e.lineTo(Fc*o-jc*c,jc*o+Fc*c),e.lineTo(Fc*b-jc*S,jc*b+Fc*S),e.lineTo(Fc*i-jc*P,jc*i+Fc*P),e.lineTo(Fc*o+jc*c,Fc*c-jc*o),e.lineTo(Fc*b+jc*S,Fc*S-jc*b),e.lineTo(Fc*i+jc*P,Fc*P-jc*i),e.closePath()}};function zQ(e,t){let a=null,o=bP(c);e=typeof e=="function"?e:Da(e||SP),t=typeof t=="function"?t:Da(t===void 0?64:+t);function c(){let b;if(a||(a=b=o()),e.apply(this,arguments).draw(a,+t.apply(this,arguments)),b)return a=null,b+""||null}return c.type=function(b){return arguments.length?(e=typeof b=="function"?b:Da(b),c):e},c.size=function(b){return arguments.length?(t=typeof b=="function"?b:Da(+b),c):t},c.context=function(b){return arguments.length?(a=b??null,c):a},c}function Fb(){}function jb(e,t,a){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+a)/6)}function vV(e){this._context=e}vV.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:jb(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:jb(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function NQ(e){return new vV(e)}function xV(e){this._context=e}xV.prototype={areaStart:Fb,areaEnd:Fb,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:jb(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function BQ(e){return new xV(e)}function bV(e){this._context=e}bV.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var a=(this._x0+4*this._x1+e)/6,o=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(a,o):this._context.moveTo(a,o);break;case 3:this._point=4;default:jb(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function FQ(e){return new bV(e)}function wV(e){this._context=e}wV.prototype={areaStart:Fb,areaEnd:Fb,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function jQ(e){return new wV(e)}function Zz(e){return e<0?-1:1}function Wz(e,t,a){var o=e._x1-e._x0,c=t-e._x1,b=(e._y1-e._y0)/(o||c<0&&-0),S=(a-e._y1)/(c||o<0&&-0),i=(b*c+S*o)/(o+c);return(Zz(b)+Zz(S))*Math.min(Math.abs(b),Math.abs(S),.5*Math.abs(i))||0}function Kz(e,t){var a=e._x1-e._x0;return a?(3*(e._y1-e._y0)/a-t)/2:t}function ME(e,t,a){var o=e._x0,c=e._y0,b=e._x1,S=e._y1,i=(b-o)/3;e._context.bezierCurveTo(o+i,c+i*t,b-i,S-i*a,b,S)}function Ub(e){this._context=e}Ub.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:ME(this,this._t0,Kz(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var a=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,ME(this,Kz(this,a=Wz(this,e,t)),a);break;default:ME(this,this._t0,a=Wz(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=a}}};function SV(e){this._context=new TV(e)}(SV.prototype=Object.create(Ub.prototype)).point=function(e,t){Ub.prototype.point.call(this,t,e)};function TV(e){this._context=e}TV.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,a,o,c,b){this._context.bezierCurveTo(t,e,o,a,b,c)}};function UQ(e){return new Ub(e)}function VQ(e){return new SV(e)}function EV(e){this._context=e}EV.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,a=e.length;if(a)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),a===2)this._context.lineTo(e[1],t[1]);else for(var o=Jz(e),c=Jz(t),b=0,S=1;S<a;++b,++S)this._context.bezierCurveTo(o[0][b],c[0][b],o[1][b],c[1][b],e[S],t[S]);(this._line||this._line!==0&&a===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Jz(e){var t,a=e.length-1,o,c=new Array(a),b=new Array(a),S=new Array(a);for(c[0]=0,b[0]=2,S[0]=e[0]+2*e[1],t=1;t<a-1;++t)c[t]=1,b[t]=4,S[t]=4*e[t]+2*e[t+1];for(c[a-1]=2,b[a-1]=7,S[a-1]=8*e[a-1]+e[a],t=1;t<a;++t)o=c[t]/b[t-1],b[t]-=o,S[t]-=o*S[t-1];for(c[a-1]=S[a-1]/b[a-1],t=a-2;t>=0;--t)c[t]=(S[t]-c[t+1])/b[t];for(b[a-1]=(e[a]+c[a-1])/2,t=0;t<a-1;++t)b[t]=2*e[t+1]-c[t+1];return[c,b]}function qQ(e){return new EV(e)}function r2(e,t){this._context=e,this._t=t}r2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var a=this._x*(1-this._t)+e*this._t;this._context.lineTo(a,this._y),this._context.lineTo(a,t)}break}}this._x=e,this._y=t}};function GQ(e){return new r2(e,.5)}function $Q(e){return new r2(e,0)}function HQ(e){return new r2(e,1)}function a_(e,t){if((S=e.length)>1)for(var a=1,o,c,b=e[t[0]],S,i=b.length;a<S;++a)for(c=b,b=e[t[a]],o=0;o<i;++o)b[o][1]+=b[o][0]=isNaN(c[o][1])?c[o][0]:c[o][1]}function nI(e){for(var t=e.length,a=new Array(t);--t>=0;)a[t]=t;return a}function XQ(e,t){return e[t]}function YQ(e){const t=[];return t.key=e,t}function ZQ(){var e=Da([]),t=nI,a=a_,o=XQ;function c(b){var S=Array.from(e.apply(this,arguments),YQ),i,P=S.length,L=-1,U;for(const V of b)for(i=0,++L;i<P;++i)(S[i][L]=[0,+o(V,S[i].key,L,b)]).data=V;for(i=0,U=wP(t(S));i<P;++i)S[U[i]].index=i;return a(S,U),S}return c.keys=function(b){return arguments.length?(e=typeof b=="function"?b:Da(Array.from(b)),c):e},c.value=function(b){return arguments.length?(o=typeof b=="function"?b:Da(+b),c):o},c.order=function(b){return arguments.length?(t=b==null?nI:typeof b=="function"?b:Da(Array.from(b)),c):t},c.offset=function(b){return arguments.length?(a=b??a_,c):a},c}function WQ(e,t){if((o=e.length)>0){for(var a,o,c=0,b=e[0].length,S;c<b;++c){for(S=a=0;a<o;++a)S+=e[a][c][1]||0;if(S)for(a=0;a<o;++a)e[a][c][1]/=S}a_(e,t)}}function KQ(e,t){if((c=e.length)>0){for(var a=0,o=e[t[0]],c,b=o.length;a<b;++a){for(var S=0,i=0;S<c;++S)i+=e[S][a][1]||0;o[a][1]+=o[a][0]=-i/2}a_(e,t)}}function JQ(e,t){if(!(!((S=e.length)>0)||!((b=(c=e[t[0]]).length)>0))){for(var a=0,o=1,c,b,S;o<b;++o){for(var i=0,P=0,L=0;i<S;++i){for(var U=e[t[i]],V=U[o][1]||0,H=U[o-1][1]||0,ee=(V-H)/2,ie=0;ie<i;++ie){var le=e[t[ie]],ue=le[o][1]||0,ge=le[o-1][1]||0;ee+=ue-ge}P+=V,L+=ee*V}c[o-1][1]+=c[o-1][0]=a,P&&(a-=L/P)}c[o-1][1]+=c[o-1][0]=a,a_(e,t)}}function D0(e){"@babel/helpers - typeof";return D0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D0(e)}var QQ=["type","size","sizeType"];function rI(){return rI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},rI.apply(this,arguments)}function Qz(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function eN(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?Qz(Object(a),!0).forEach(function(o){eee(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Qz(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function eee(e,t,a){return t=tee(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function tee(e){var t=nee(e,"string");return D0(t)=="symbol"?t:t+""}function nee(e,t){if(D0(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(D0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ree(e,t){if(e==null)return{};var a=iee(e,t),o,c;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(c=0;c<b.length;c++)o=b[c],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function iee(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}var AV={symbolCircle:SP,symbolCross:EQ,symbolDiamond:MQ,symbolSquare:OQ,symbolStar:RQ,symbolTriangle:kQ,symbolWye:LQ},aee=Math.PI/180,oee=function(t){var a="symbol".concat(e2(t));return AV[a]||SP},see=function(t,a,o){if(a==="area")return t;switch(o){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var c=18*aee;return 1.25*t*t*(Math.tan(c)-Math.tan(c*2)*Math.pow(Math.tan(c),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},lee=function(t,a){AV["symbol".concat(e2(t))]=a},i2=function(t){var a=t.type,o=a===void 0?"circle":a,c=t.size,b=c===void 0?64:c,S=t.sizeType,i=S===void 0?"area":S,P=ree(t,QQ),L=eN(eN({},P),{},{type:o,size:b,sizeType:i}),U=function(){var ue=oee(o),ge=zQ().type(ue).size(see(b,i,o));return ge()},V=L.className,H=L.cx,ee=L.cy,ie=ji(L,!0);return H===+H&&ee===+ee&&b===+b?kt.createElement("path",rI({},ie,{className:ia("recharts-symbols",V),transform:"translate(".concat(H,", ").concat(ee,")"),d:U()})):null};i2.registerSymbol=lee;function o_(e){"@babel/helpers - typeof";return o_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o_(e)}function iI(){return iI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},iI.apply(this,arguments)}function tN(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function uee(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?tN(Object(a),!0).forEach(function(o){L0(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):tN(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function cee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hee(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,OV(o.key),o)}}function fee(e,t,a){return t&&hee(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function dee(e,t,a){return t=Vb(t),pee(e,MV()?Reflect.construct(t,a||[],Vb(e).constructor):t.apply(e,a))}function pee(e,t){if(t&&(o_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mee(e)}function mee(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(MV=function(){return!!e})()}function Vb(e){return Vb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Vb(e)}function gee(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aI(e,t)}function aI(e,t){return aI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,c){return o.__proto__=c,o},aI(e,t)}function L0(e,t,a){return t=OV(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function OV(e){var t=yee(e,"string");return o_(t)=="symbol"?t:t+""}function yee(e,t){if(o_(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(o_(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Ah=32,TP=function(e){function t(){return cee(this,t),dee(this,t,arguments)}return gee(t,e),fee(t,[{key:"renderIcon",value:function(o){var c=this.props.inactiveColor,b=Ah/2,S=Ah/6,i=Ah/3,P=o.inactive?c:o.color;if(o.type==="plainline")return kt.createElement("line",{strokeWidth:4,fill:"none",stroke:P,strokeDasharray:o.payload.strokeDasharray,x1:0,y1:b,x2:Ah,y2:b,className:"recharts-legend-icon"});if(o.type==="line")return kt.createElement("path",{strokeWidth:4,fill:"none",stroke:P,d:"M0,".concat(b,"h").concat(i,`
            A`).concat(S,",").concat(S,",0,1,1,").concat(2*i,",").concat(b,`
            H`).concat(Ah,"M").concat(2*i,",").concat(b,`
            A`).concat(S,",").concat(S,",0,1,1,").concat(i,",").concat(b),className:"recharts-legend-icon"});if(o.type==="rect")return kt.createElement("path",{stroke:"none",fill:P,d:"M0,".concat(Ah/8,"h").concat(Ah,"v").concat(Ah*3/4,"h").concat(-32,"z"),className:"recharts-legend-icon"});if(kt.isValidElement(o.legendIcon)){var L=uee({},o);return delete L.legendIcon,kt.cloneElement(o.legendIcon,L)}return kt.createElement(i2,{fill:P,cx:b,cy:b,size:Ah,sizeType:"diameter",type:o.type})}},{key:"renderItems",value:function(){var o=this,c=this.props,b=c.payload,S=c.iconSize,i=c.layout,P=c.formatter,L=c.inactiveColor,U={x:0,y:0,width:Ah,height:Ah},V={display:i==="horizontal"?"inline-block":"block",marginRight:10},H={display:"inline-block",verticalAlign:"middle",marginRight:4};return b.map(function(ee,ie){var le=ee.formatter||P,ue=ia(L0(L0({"recharts-legend-item":!0},"legend-item-".concat(ie),!0),"inactive",ee.inactive));if(ee.type==="none")return null;var ge=_i(ee.value)?null:ee.value;qd(!_i(ee.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var Se=ee.inactive?L:ee.color;return kt.createElement("li",iI({className:ue,style:V,key:"legend-item-".concat(ie)},k0(o.props,ee,ie)),kt.createElement(KO,{width:S,height:S,viewBox:U,style:H},o.renderIcon(ee)),kt.createElement("span",{className:"recharts-legend-item-text",style:{color:Se}},le?le(ge,ee,ie):ge))})}},{key:"render",value:function(){var o=this.props,c=o.payload,b=o.layout,S=o.align;if(!c||!c.length)return null;var i={padding:0,margin:0,textAlign:b==="horizontal"?S:"left"};return kt.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}])}(Jt.PureComponent);L0(TP,"displayName","Legend");L0(TP,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var OE,nN;function _ee(){if(nN)return OE;nN=1;var e=Kw();function t(){this.__data__=new e,this.size=0}return OE=t,OE}var IE,rN;function vee(){if(rN)return IE;rN=1;function e(t){var a=this.__data__,o=a.delete(t);return this.size=a.size,o}return IE=e,IE}var CE,iN;function xee(){if(iN)return CE;iN=1;function e(t){return this.__data__.get(t)}return CE=e,CE}var PE,aN;function bee(){if(aN)return PE;aN=1;function e(t){return this.__data__.has(t)}return PE=e,PE}var RE,oN;function wee(){if(oN)return RE;oN=1;var e=Kw(),t=mP(),a=gP(),o=200;function c(b,S){var i=this.__data__;if(i instanceof e){var P=i.__data__;if(!t||P.length<o-1)return P.push([b,S]),this.size=++i.size,this;i=this.__data__=new a(P)}return i.set(b,S),this.size=i.size,this}return RE=c,RE}var kE,sN;function IV(){if(sN)return kE;sN=1;var e=Kw(),t=_ee(),a=vee(),o=xee(),c=bee(),b=wee();function S(i){var P=this.__data__=new e(i);this.size=P.size}return S.prototype.clear=t,S.prototype.delete=a,S.prototype.get=o,S.prototype.has=c,S.prototype.set=b,kE=S,kE}var DE,lN;function See(){if(lN)return DE;lN=1;var e="__lodash_hash_undefined__";function t(a){return this.__data__.set(a,e),this}return DE=t,DE}var LE,uN;function Tee(){if(uN)return LE;uN=1;function e(t){return this.__data__.has(t)}return LE=e,LE}var zE,cN;function CV(){if(cN)return zE;cN=1;var e=gP(),t=See(),a=Tee();function o(c){var b=-1,S=c==null?0:c.length;for(this.__data__=new e;++b<S;)this.add(c[b])}return o.prototype.add=o.prototype.push=t,o.prototype.has=a,zE=o,zE}var NE,hN;function PV(){if(hN)return NE;hN=1;function e(t,a){for(var o=-1,c=t==null?0:t.length;++o<c;)if(a(t[o],o,t))return!0;return!1}return NE=e,NE}var BE,fN;function RV(){if(fN)return BE;fN=1;function e(t,a){return t.has(a)}return BE=e,BE}var FE,dN;function kV(){if(dN)return FE;dN=1;var e=CV(),t=PV(),a=RV(),o=1,c=2;function b(S,i,P,L,U,V){var H=P&o,ee=S.length,ie=i.length;if(ee!=ie&&!(H&&ie>ee))return!1;var le=V.get(S),ue=V.get(i);if(le&&ue)return le==i&&ue==S;var ge=-1,Se=!0,ve=P&c?new e:void 0;for(V.set(S,i),V.set(i,S);++ge<ee;){var Ee=S[ge],me=i[ge];if(L)var Ae=H?L(me,Ee,ge,i,S,V):L(Ee,me,ge,S,i,V);if(Ae!==void 0){if(Ae)continue;Se=!1;break}if(ve){if(!t(i,function(Oe,Ye){if(!a(ve,Ye)&&(Ee===Oe||U(Ee,Oe,P,L,V)))return ve.push(Ye)})){Se=!1;break}}else if(!(Ee===me||U(Ee,me,P,L,V))){Se=!1;break}}return V.delete(S),V.delete(i),Se}return FE=b,FE}var jE,pN;function Eee(){if(pN)return jE;pN=1;var e=qf(),t=e.Uint8Array;return jE=t,jE}var UE,mN;function Aee(){if(mN)return UE;mN=1;function e(t){var a=-1,o=Array(t.size);return t.forEach(function(c,b){o[++a]=[b,c]}),o}return UE=e,UE}var VE,gN;function EP(){if(gN)return VE;gN=1;function e(t){var a=-1,o=Array(t.size);return t.forEach(function(c){o[++a]=c}),o}return VE=e,VE}var qE,yN;function Mee(){if(yN)return qE;yN=1;var e=Sx(),t=Eee(),a=pP(),o=kV(),c=Aee(),b=EP(),S=1,i=2,P="[object Boolean]",L="[object Date]",U="[object Error]",V="[object Map]",H="[object Number]",ee="[object RegExp]",ie="[object Set]",le="[object String]",ue="[object Symbol]",ge="[object ArrayBuffer]",Se="[object DataView]",ve=e?e.prototype:void 0,Ee=ve?ve.valueOf:void 0;function me(Ae,Oe,Ye,He,st,Ke,Ot){switch(Ye){case Se:if(Ae.byteLength!=Oe.byteLength||Ae.byteOffset!=Oe.byteOffset)return!1;Ae=Ae.buffer,Oe=Oe.buffer;case ge:return!(Ae.byteLength!=Oe.byteLength||!Ke(new t(Ae),new t(Oe)));case P:case L:case H:return a(+Ae,+Oe);case U:return Ae.name==Oe.name&&Ae.message==Oe.message;case ee:case le:return Ae==Oe+"";case V:var Bt=c;case ie:var Tt=He&S;if(Bt||(Bt=b),Ae.size!=Oe.size&&!Tt)return!1;var mt=Ot.get(Ae);if(mt)return mt==Oe;He|=i,Ot.set(Ae,Oe);var bt=o(Bt(Ae),Bt(Oe),He,st,Ke,Ot);return Ot.delete(Ae),bt;case ue:if(Ee)return Ee.call(Ae)==Ee.call(Oe)}return!1}return qE=me,qE}var GE,_N;function DV(){if(_N)return GE;_N=1;function e(t,a){for(var o=-1,c=a.length,b=t.length;++o<c;)t[b+o]=a[o];return t}return GE=e,GE}var $E,vN;function Oee(){if(vN)return $E;vN=1;var e=DV(),t=Su();function a(o,c,b){var S=c(o);return t(o)?S:e(S,b(o))}return $E=a,$E}var HE,xN;function Iee(){if(xN)return HE;xN=1;function e(t,a){for(var o=-1,c=t==null?0:t.length,b=0,S=[];++o<c;){var i=t[o];a(i,o,t)&&(S[b++]=i)}return S}return HE=e,HE}var XE,bN;function Cee(){if(bN)return XE;bN=1;function e(){return[]}return XE=e,XE}var YE,wN;function Pee(){if(wN)return YE;wN=1;var e=Iee(),t=Cee(),a=Object.prototype,o=a.propertyIsEnumerable,c=Object.getOwnPropertySymbols,b=c?function(S){return S==null?[]:(S=Object(S),e(c(S),function(i){return o.call(S,i)}))}:t;return YE=b,YE}var ZE,SN;function Ree(){if(SN)return ZE;SN=1;function e(t,a){for(var o=-1,c=Array(t);++o<t;)c[o]=a(o);return c}return ZE=e,ZE}var WE,TN;function kee(){if(TN)return WE;TN=1;var e=Qd(),t=ep(),a="[object Arguments]";function o(c){return t(c)&&e(c)==a}return WE=o,WE}var KE,EN;function AP(){if(EN)return KE;EN=1;var e=kee(),t=ep(),a=Object.prototype,o=a.hasOwnProperty,c=a.propertyIsEnumerable,b=e(function(){return arguments}())?e:function(S){return t(S)&&o.call(S,"callee")&&!c.call(S,"callee")};return KE=b,KE}var s0={exports:{}},JE,AN;function Dee(){if(AN)return JE;AN=1;function e(){return!1}return JE=e,JE}s0.exports;var MN;function LV(){return MN||(MN=1,function(e,t){var a=qf(),o=Dee(),c=t&&!t.nodeType&&t,b=c&&!0&&e&&!e.nodeType&&e,S=b&&b.exports===c,i=S?a.Buffer:void 0,P=i?i.isBuffer:void 0,L=P||o;e.exports=L}(s0,s0.exports)),s0.exports}var QE,ON;function MP(){if(ON)return QE;ON=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function a(o,c){var b=typeof o;return c=c??e,!!c&&(b=="number"||b!="symbol"&&t.test(o))&&o>-1&&o%1==0&&o<c}return QE=a,QE}var eA,IN;function OP(){if(IN)return eA;IN=1;var e=9007199254740991;function t(a){return typeof a=="number"&&a>-1&&a%1==0&&a<=e}return eA=t,eA}var tA,CN;function Lee(){if(CN)return tA;CN=1;var e=Qd(),t=OP(),a=ep(),o="[object Arguments]",c="[object Array]",b="[object Boolean]",S="[object Date]",i="[object Error]",P="[object Function]",L="[object Map]",U="[object Number]",V="[object Object]",H="[object RegExp]",ee="[object Set]",ie="[object String]",le="[object WeakMap]",ue="[object ArrayBuffer]",ge="[object DataView]",Se="[object Float32Array]",ve="[object Float64Array]",Ee="[object Int8Array]",me="[object Int16Array]",Ae="[object Int32Array]",Oe="[object Uint8Array]",Ye="[object Uint8ClampedArray]",He="[object Uint16Array]",st="[object Uint32Array]",Ke={};Ke[Se]=Ke[ve]=Ke[Ee]=Ke[me]=Ke[Ae]=Ke[Oe]=Ke[Ye]=Ke[He]=Ke[st]=!0,Ke[o]=Ke[c]=Ke[ue]=Ke[b]=Ke[ge]=Ke[S]=Ke[i]=Ke[P]=Ke[L]=Ke[U]=Ke[V]=Ke[H]=Ke[ee]=Ke[ie]=Ke[le]=!1;function Ot(Bt){return a(Bt)&&t(Bt.length)&&!!Ke[e(Bt)]}return tA=Ot,tA}var nA,PN;function zV(){if(PN)return nA;PN=1;function e(t){return function(a){return t(a)}}return nA=e,nA}var l0={exports:{}};l0.exports;var RN;function zee(){return RN||(RN=1,function(e,t){var a=nV(),o=t&&!t.nodeType&&t,c=o&&!0&&e&&!e.nodeType&&e,b=c&&c.exports===o,S=b&&a.process,i=function(){try{var P=c&&c.require&&c.require("util").types;return P||S&&S.binding&&S.binding("util")}catch{}}();e.exports=i}(l0,l0.exports)),l0.exports}var rA,kN;function NV(){if(kN)return rA;kN=1;var e=Lee(),t=zV(),a=zee(),o=a&&a.isTypedArray,c=o?t(o):e;return rA=c,rA}var iA,DN;function Nee(){if(DN)return iA;DN=1;var e=Ree(),t=AP(),a=Su(),o=LV(),c=MP(),b=NV(),S=Object.prototype,i=S.hasOwnProperty;function P(L,U){var V=a(L),H=!V&&t(L),ee=!V&&!H&&o(L),ie=!V&&!H&&!ee&&b(L),le=V||H||ee||ie,ue=le?e(L.length,String):[],ge=ue.length;for(var Se in L)(U||i.call(L,Se))&&!(le&&(Se=="length"||ee&&(Se=="offset"||Se=="parent")||ie&&(Se=="buffer"||Se=="byteLength"||Se=="byteOffset")||c(Se,ge)))&&ue.push(Se);return ue}return iA=P,iA}var aA,LN;function Bee(){if(LN)return aA;LN=1;var e=Object.prototype;function t(a){var o=a&&a.constructor,c=typeof o=="function"&&o.prototype||e;return a===c}return aA=t,aA}var oA,zN;function BV(){if(zN)return oA;zN=1;function e(t,a){return function(o){return t(a(o))}}return oA=e,oA}var sA,NN;function Fee(){if(NN)return sA;NN=1;var e=BV(),t=e(Object.keys,Object);return sA=t,sA}var lA,BN;function jee(){if(BN)return lA;BN=1;var e=Bee(),t=Fee(),a=Object.prototype,o=a.hasOwnProperty;function c(b){if(!e(b))return t(b);var S=[];for(var i in Object(b))o.call(b,i)&&i!="constructor"&&S.push(i);return S}return lA=c,lA}var uA,FN;function Mx(){if(FN)return uA;FN=1;var e=dP(),t=OP();function a(o){return o!=null&&t(o.length)&&!e(o)}return uA=a,uA}var cA,jN;function a2(){if(jN)return cA;jN=1;var e=Nee(),t=jee(),a=Mx();function o(c){return a(c)?e(c):t(c)}return cA=o,cA}var hA,UN;function Uee(){if(UN)return hA;UN=1;var e=Oee(),t=Pee(),a=a2();function o(c){return e(c,a,t)}return hA=o,hA}var fA,VN;function Vee(){if(VN)return fA;VN=1;var e=Uee(),t=1,a=Object.prototype,o=a.hasOwnProperty;function c(b,S,i,P,L,U){var V=i&t,H=e(b),ee=H.length,ie=e(S),le=ie.length;if(ee!=le&&!V)return!1;for(var ue=ee;ue--;){var ge=H[ue];if(!(V?ge in S:o.call(S,ge)))return!1}var Se=U.get(b),ve=U.get(S);if(Se&&ve)return Se==S&&ve==b;var Ee=!0;U.set(b,S),U.set(S,b);for(var me=V;++ue<ee;){ge=H[ue];var Ae=b[ge],Oe=S[ge];if(P)var Ye=V?P(Oe,Ae,ge,S,b,U):P(Ae,Oe,ge,b,S,U);if(!(Ye===void 0?Ae===Oe||L(Ae,Oe,i,P,U):Ye)){Ee=!1;break}me||(me=ge=="constructor")}if(Ee&&!me){var He=b.constructor,st=S.constructor;He!=st&&"constructor"in b&&"constructor"in S&&!(typeof He=="function"&&He instanceof He&&typeof st=="function"&&st instanceof st)&&(Ee=!1)}return U.delete(b),U.delete(S),Ee}return fA=c,fA}var dA,qN;function qee(){if(qN)return dA;qN=1;var e=Ig(),t=qf(),a=e(t,"DataView");return dA=a,dA}var pA,GN;function Gee(){if(GN)return pA;GN=1;var e=Ig(),t=qf(),a=e(t,"Promise");return pA=a,pA}var mA,$N;function FV(){if($N)return mA;$N=1;var e=Ig(),t=qf(),a=e(t,"Set");return mA=a,mA}var gA,HN;function $ee(){if(HN)return gA;HN=1;var e=Ig(),t=qf(),a=e(t,"WeakMap");return gA=a,gA}var yA,XN;function Hee(){if(XN)return yA;XN=1;var e=qee(),t=mP(),a=Gee(),o=FV(),c=$ee(),b=Qd(),S=rV(),i="[object Map]",P="[object Object]",L="[object Promise]",U="[object Set]",V="[object WeakMap]",H="[object DataView]",ee=S(e),ie=S(t),le=S(a),ue=S(o),ge=S(c),Se=b;return(e&&Se(new e(new ArrayBuffer(1)))!=H||t&&Se(new t)!=i||a&&Se(a.resolve())!=L||o&&Se(new o)!=U||c&&Se(new c)!=V)&&(Se=function(ve){var Ee=b(ve),me=Ee==P?ve.constructor:void 0,Ae=me?S(me):"";if(Ae)switch(Ae){case ee:return H;case ie:return i;case le:return L;case ue:return U;case ge:return V}return Ee}),yA=Se,yA}var _A,YN;function Xee(){if(YN)return _A;YN=1;var e=IV(),t=kV(),a=Mee(),o=Vee(),c=Hee(),b=Su(),S=LV(),i=NV(),P=1,L="[object Arguments]",U="[object Array]",V="[object Object]",H=Object.prototype,ee=H.hasOwnProperty;function ie(le,ue,ge,Se,ve,Ee){var me=b(le),Ae=b(ue),Oe=me?U:c(le),Ye=Ae?U:c(ue);Oe=Oe==L?V:Oe,Ye=Ye==L?V:Ye;var He=Oe==V,st=Ye==V,Ke=Oe==Ye;if(Ke&&S(le)){if(!S(ue))return!1;me=!0,He=!1}if(Ke&&!He)return Ee||(Ee=new e),me||i(le)?t(le,ue,ge,Se,ve,Ee):a(le,ue,Oe,ge,Se,ve,Ee);if(!(ge&P)){var Ot=He&&ee.call(le,"__wrapped__"),Bt=st&&ee.call(ue,"__wrapped__");if(Ot||Bt){var Tt=Ot?le.value():le,mt=Bt?ue.value():ue;return Ee||(Ee=new e),ve(Tt,mt,ge,Se,Ee)}}return Ke?(Ee||(Ee=new e),o(le,ue,ge,Se,ve,Ee)):!1}return _A=ie,_A}var vA,ZN;function IP(){if(ZN)return vA;ZN=1;var e=Xee(),t=ep();function a(o,c,b,S,i){return o===c?!0:o==null||c==null||!t(o)&&!t(c)?o!==o&&c!==c:e(o,c,b,S,a,i)}return vA=a,vA}var xA,WN;function Yee(){if(WN)return xA;WN=1;var e=IV(),t=IP(),a=1,o=2;function c(b,S,i,P){var L=i.length,U=L,V=!P;if(b==null)return!U;for(b=Object(b);L--;){var H=i[L];if(V&&H[2]?H[1]!==b[H[0]]:!(H[0]in b))return!1}for(;++L<U;){H=i[L];var ee=H[0],ie=b[ee],le=H[1];if(V&&H[2]){if(ie===void 0&&!(ee in b))return!1}else{var ue=new e;if(P)var ge=P(ie,le,ee,b,S,ue);if(!(ge===void 0?t(le,ie,a|o,P,ue):ge))return!1}}return!0}return xA=c,xA}var bA,KN;function jV(){if(KN)return bA;KN=1;var e=cm();function t(a){return a===a&&!e(a)}return bA=t,bA}var wA,JN;function Zee(){if(JN)return wA;JN=1;var e=jV(),t=a2();function a(o){for(var c=t(o),b=c.length;b--;){var S=c[b],i=o[S];c[b]=[S,i,e(i)]}return c}return wA=a,wA}var SA,QN;function UV(){if(QN)return SA;QN=1;function e(t,a){return function(o){return o==null?!1:o[t]===a&&(a!==void 0||t in Object(o))}}return SA=e,SA}var TA,e4;function Wee(){if(e4)return TA;e4=1;var e=Yee(),t=Zee(),a=UV();function o(c){var b=t(c);return b.length==1&&b[0][2]?a(b[0][0],b[0][1]):function(S){return S===c||e(S,c,b)}}return TA=o,TA}var EA,t4;function Kee(){if(t4)return EA;t4=1;function e(t,a){return t!=null&&a in Object(t)}return EA=e,EA}var AA,n4;function Jee(){if(n4)return AA;n4=1;var e=oV(),t=AP(),a=Su(),o=MP(),c=OP(),b=Qw();function S(i,P,L){P=e(P,i);for(var U=-1,V=P.length,H=!1;++U<V;){var ee=b(P[U]);if(!(H=i!=null&&L(i,ee)))break;i=i[ee]}return H||++U!=V?H:(V=i==null?0:i.length,!!V&&c(V)&&o(ee,V)&&(a(i)||t(i)))}return AA=S,AA}var MA,r4;function Qee(){if(r4)return MA;r4=1;var e=Kee(),t=Jee();function a(o,c){return o!=null&&t(o,c,e)}return MA=a,MA}var OA,i4;function ete(){if(i4)return OA;i4=1;var e=IP(),t=sV(),a=Qee(),o=fP(),c=jV(),b=UV(),S=Qw(),i=1,P=2;function L(U,V){return o(U)&&c(V)?b(S(U),V):function(H){var ee=t(H,U);return ee===void 0&&ee===V?a(H,U):e(V,ee,i|P)}}return OA=L,OA}var IA,a4;function N_(){if(a4)return IA;a4=1;function e(t){return t}return IA=e,IA}var CA,o4;function tte(){if(o4)return CA;o4=1;function e(t){return function(a){return a==null?void 0:a[t]}}return CA=e,CA}var PA,s4;function nte(){if(s4)return PA;s4=1;var e=_P();function t(a){return function(o){return e(o,a)}}return PA=t,PA}var RA,l4;function rte(){if(l4)return RA;l4=1;var e=tte(),t=nte(),a=fP(),o=Qw();function c(b){return a(b)?e(o(b)):t(b)}return RA=c,RA}var kA,u4;function hm(){if(u4)return kA;u4=1;var e=Wee(),t=ete(),a=N_(),o=Su(),c=rte();function b(S){return typeof S=="function"?S:S==null?a:typeof S=="object"?o(S)?t(S[0],S[1]):e(S):c(S)}return kA=b,kA}var DA,c4;function VV(){if(c4)return DA;c4=1;function e(t,a,o,c){for(var b=t.length,S=o+(c?1:-1);c?S--:++S<b;)if(a(t[S],S,t))return S;return-1}return DA=e,DA}var LA,h4;function ite(){if(h4)return LA;h4=1;function e(t){return t!==t}return LA=e,LA}var zA,f4;function ate(){if(f4)return zA;f4=1;function e(t,a,o){for(var c=o-1,b=t.length;++c<b;)if(t[c]===a)return c;return-1}return zA=e,zA}var NA,d4;function ote(){if(d4)return NA;d4=1;var e=VV(),t=ite(),a=ate();function o(c,b,S){return b===b?a(c,b,S):e(c,t,S)}return NA=o,NA}var BA,p4;function ste(){if(p4)return BA;p4=1;var e=ote();function t(a,o){var c=a==null?0:a.length;return!!c&&e(a,o,0)>-1}return BA=t,BA}var FA,m4;function lte(){if(m4)return FA;m4=1;function e(t,a,o){for(var c=-1,b=t==null?0:t.length;++c<b;)if(o(a,t[c]))return!0;return!1}return FA=e,FA}var jA,g4;function ute(){if(g4)return jA;g4=1;function e(){}return jA=e,jA}var UA,y4;function cte(){if(y4)return UA;y4=1;var e=FV(),t=ute(),a=EP(),o=1/0,c=e&&1/a(new e([,-0]))[1]==o?function(b){return new e(b)}:t;return UA=c,UA}var VA,_4;function hte(){if(_4)return VA;_4=1;var e=CV(),t=ste(),a=lte(),o=RV(),c=cte(),b=EP(),S=200;function i(P,L,U){var V=-1,H=t,ee=P.length,ie=!0,le=[],ue=le;if(U)ie=!1,H=a;else if(ee>=S){var ge=L?null:c(P);if(ge)return b(ge);ie=!1,H=o,ue=new e}else ue=L?[]:le;e:for(;++V<ee;){var Se=P[V],ve=L?L(Se):Se;if(Se=U||Se!==0?Se:0,ie&&ve===ve){for(var Ee=ue.length;Ee--;)if(ue[Ee]===ve)continue e;L&&ue.push(ve),le.push(Se)}else H(ue,ve,U)||(ue!==le&&ue.push(ve),le.push(Se))}return le}return VA=i,VA}var qA,v4;function fte(){if(v4)return qA;v4=1;var e=hm(),t=hte();function a(o,c){return o&&o.length?t(o,e(c,2)):[]}return qA=a,qA}var dte=fte();const x4=fa(dte);function qV(e,t,a){return t===!0?x4(e,a):_i(t)?x4(e,t):e}function s_(e){"@babel/helpers - typeof";return s_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s_(e)}var pte=["ref"];function b4(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function zd(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?b4(Object(a),!0).forEach(function(o){o2(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b4(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function mte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w4(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,$V(o.key),o)}}function gte(e,t,a){return t&&w4(e.prototype,t),a&&w4(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function yte(e,t,a){return t=qb(t),_te(e,GV()?Reflect.construct(t,a||[],qb(e).constructor):t.apply(e,a))}function _te(e,t){if(t&&(s_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vte(e)}function vte(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(GV=function(){return!!e})()}function qb(e){return qb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},qb(e)}function xte(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oI(e,t)}function oI(e,t){return oI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,c){return o.__proto__=c,o},oI(e,t)}function o2(e,t,a){return t=$V(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function $V(e){var t=bte(e,"string");return s_(t)=="symbol"?t:t+""}function bte(e,t){if(s_(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(s_(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function wte(e,t){if(e==null)return{};var a=Ste(e,t),o,c;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(c=0;c<b.length;c++)o=b[c],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function Ste(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function Tte(e){return e.value}function Ete(e,t){if(kt.isValidElement(e))return kt.cloneElement(e,t);if(typeof e=="function")return kt.createElement(e,t);t.ref;var a=wte(t,pte);return kt.createElement(TP,a)}var S4=1,Jy=function(e){function t(){var a;mte(this,t);for(var o=arguments.length,c=new Array(o),b=0;b<o;b++)c[b]=arguments[b];return a=yte(this,t,[].concat(c)),o2(a,"lastBoundingBox",{width:-1,height:-1}),a}return xte(t,e),gte(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var o=this.wrapperNode.getBoundingClientRect();return o.height=this.wrapperNode.offsetHeight,o.width=this.wrapperNode.offsetWidth,o}return null}},{key:"updateBBox",value:function(){var o=this.props.onBBoxUpdate,c=this.getBBox();c?(Math.abs(c.width-this.lastBoundingBox.width)>S4||Math.abs(c.height-this.lastBoundingBox.height)>S4)&&(this.lastBoundingBox.width=c.width,this.lastBoundingBox.height=c.height,o&&o(c)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,o&&o(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?zd({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(o){var c=this.props,b=c.layout,S=c.align,i=c.verticalAlign,P=c.margin,L=c.chartWidth,U=c.chartHeight,V,H;if(!o||(o.left===void 0||o.left===null)&&(o.right===void 0||o.right===null))if(S==="center"&&b==="vertical"){var ee=this.getBBoxSnapshot();V={left:((L||0)-ee.width)/2}}else V=S==="right"?{right:P&&P.right||0}:{left:P&&P.left||0};if(!o||(o.top===void 0||o.top===null)&&(o.bottom===void 0||o.bottom===null))if(i==="middle"){var ie=this.getBBoxSnapshot();H={top:((U||0)-ie.height)/2}}else H=i==="bottom"?{bottom:P&&P.bottom||0}:{top:P&&P.top||0};return zd(zd({},V),H)}},{key:"render",value:function(){var o=this,c=this.props,b=c.content,S=c.width,i=c.height,P=c.wrapperStyle,L=c.payloadUniqBy,U=c.payload,V=zd(zd({position:"absolute",width:S||"auto",height:i||"auto"},this.getDefaultPosition(P)),P);return kt.createElement("div",{className:"recharts-legend-wrapper",style:V,ref:function(ee){o.wrapperNode=ee}},Ete(b,zd(zd({},this.props),{},{payload:qV(U,L,Tte)})))}}],[{key:"getWithHeight",value:function(o,c){var b=zd(zd({},this.defaultProps),o.props),S=b.layout;return S==="vertical"&&er(o.props.height)?{height:o.props.height}:S==="horizontal"?{width:o.props.width||c}:null}}])}(Jt.PureComponent);o2(Jy,"displayName","Legend");o2(Jy,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var GA,T4;function Ate(){if(T4)return GA;T4=1;var e=Sx(),t=AP(),a=Su(),o=e?e.isConcatSpreadable:void 0;function c(b){return a(b)||t(b)||!!(o&&b&&b[o])}return GA=c,GA}var $A,E4;function HV(){if(E4)return $A;E4=1;var e=DV(),t=Ate();function a(o,c,b,S,i){var P=-1,L=o.length;for(b||(b=t),i||(i=[]);++P<L;){var U=o[P];c>0&&b(U)?c>1?a(U,c-1,b,S,i):e(i,U):S||(i[i.length]=U)}return i}return $A=a,$A}var HA,A4;function Mte(){if(A4)return HA;A4=1;function e(t){return function(a,o,c){for(var b=-1,S=Object(a),i=c(a),P=i.length;P--;){var L=i[t?P:++b];if(o(S[L],L,S)===!1)break}return a}}return HA=e,HA}var XA,M4;function Ote(){if(M4)return XA;M4=1;var e=Mte(),t=e();return XA=t,XA}var YA,O4;function XV(){if(O4)return YA;O4=1;var e=Ote(),t=a2();function a(o,c){return o&&e(o,c,t)}return YA=a,YA}var ZA,I4;function Ite(){if(I4)return ZA;I4=1;var e=Mx();function t(a,o){return function(c,b){if(c==null)return c;if(!e(c))return a(c,b);for(var S=c.length,i=o?S:-1,P=Object(c);(o?i--:++i<S)&&b(P[i],i,P)!==!1;);return c}}return ZA=t,ZA}var WA,C4;function CP(){if(C4)return WA;C4=1;var e=XV(),t=Ite(),a=t(e);return WA=a,WA}var KA,P4;function YV(){if(P4)return KA;P4=1;var e=CP(),t=Mx();function a(o,c){var b=-1,S=t(o)?Array(o.length):[];return e(o,function(i,P,L){S[++b]=c(i,P,L)}),S}return KA=a,KA}var JA,R4;function Cte(){if(R4)return JA;R4=1;function e(t,a){var o=t.length;for(t.sort(a);o--;)t[o]=t[o].value;return t}return JA=e,JA}var QA,k4;function Pte(){if(k4)return QA;k4=1;var e=L_();function t(a,o){if(a!==o){var c=a!==void 0,b=a===null,S=a===a,i=e(a),P=o!==void 0,L=o===null,U=o===o,V=e(o);if(!L&&!V&&!i&&a>o||i&&P&&U&&!L&&!V||b&&P&&U||!c&&U||!S)return 1;if(!b&&!i&&!V&&a<o||V&&c&&S&&!b&&!i||L&&c&&S||!P&&S||!U)return-1}return 0}return QA=t,QA}var eM,D4;function Rte(){if(D4)return eM;D4=1;var e=Pte();function t(a,o,c){for(var b=-1,S=a.criteria,i=o.criteria,P=S.length,L=c.length;++b<P;){var U=e(S[b],i[b]);if(U){if(b>=L)return U;var V=c[b];return U*(V=="desc"?-1:1)}}return a.index-o.index}return eM=t,eM}var tM,L4;function kte(){if(L4)return tM;L4=1;var e=yP(),t=_P(),a=hm(),o=YV(),c=Cte(),b=zV(),S=Rte(),i=N_(),P=Su();function L(U,V,H){V.length?V=e(V,function(le){return P(le)?function(ue){return t(ue,le.length===1?le[0]:le)}:le}):V=[i];var ee=-1;V=e(V,b(a));var ie=o(U,function(le,ue,ge){var Se=e(V,function(ve){return ve(le)});return{criteria:Se,index:++ee,value:le}});return c(ie,function(le,ue){return S(le,ue,H)})}return tM=L,tM}var nM,z4;function Dte(){if(z4)return nM;z4=1;function e(t,a,o){switch(o.length){case 0:return t.call(a);case 1:return t.call(a,o[0]);case 2:return t.call(a,o[0],o[1]);case 3:return t.call(a,o[0],o[1],o[2])}return t.apply(a,o)}return nM=e,nM}var rM,N4;function Lte(){if(N4)return rM;N4=1;var e=Dte(),t=Math.max;function a(o,c,b){return c=t(c===void 0?o.length-1:c,0),function(){for(var S=arguments,i=-1,P=t(S.length-c,0),L=Array(P);++i<P;)L[i]=S[c+i];i=-1;for(var U=Array(c+1);++i<c;)U[i]=S[i];return U[c]=b(L),e(o,this,U)}}return rM=a,rM}var iM,B4;function zte(){if(B4)return iM;B4=1;function e(t){return function(){return t}}return iM=e,iM}var aM,F4;function ZV(){if(F4)return aM;F4=1;var e=Ig(),t=function(){try{var a=e(Object,"defineProperty");return a({},"",{}),a}catch{}}();return aM=t,aM}var oM,j4;function Nte(){if(j4)return oM;j4=1;var e=zte(),t=ZV(),a=N_(),o=t?function(c,b){return t(c,"toString",{configurable:!0,enumerable:!1,value:e(b),writable:!0})}:a;return oM=o,oM}var sM,U4;function Bte(){if(U4)return sM;U4=1;var e=800,t=16,a=Date.now;function o(c){var b=0,S=0;return function(){var i=a(),P=t-(i-S);if(S=i,P>0){if(++b>=e)return arguments[0]}else b=0;return c.apply(void 0,arguments)}}return sM=o,sM}var lM,V4;function Fte(){if(V4)return lM;V4=1;var e=Nte(),t=Bte(),a=t(e);return lM=a,lM}var uM,q4;function jte(){if(q4)return uM;q4=1;var e=N_(),t=Lte(),a=Fte();function o(c,b){return a(t(c,b,e),c+"")}return uM=o,uM}var cM,G4;function s2(){if(G4)return cM;G4=1;var e=pP(),t=Mx(),a=MP(),o=cm();function c(b,S,i){if(!o(i))return!1;var P=typeof S;return(P=="number"?t(i)&&a(S,i.length):P=="string"&&S in i)?e(i[S],b):!1}return cM=c,cM}var hM,$4;function Ute(){if($4)return hM;$4=1;var e=HV(),t=kte(),a=jte(),o=s2(),c=a(function(b,S){if(b==null)return[];var i=S.length;return i>1&&o(b,S[0],S[1])?S=[]:i>2&&o(S[0],S[1],S[2])&&(S=[S[0]]),t(b,e(S,1),[])});return hM=c,hM}var Vte=Ute();const PP=fa(Vte);function z0(e){"@babel/helpers - typeof";return z0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z0(e)}function sI(){return sI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},sI.apply(this,arguments)}function qte(e,t){return Xte(e)||Hte(e,t)||$te(e,t)||Gte()}function Gte(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $te(e,t){if(e){if(typeof e=="string")return H4(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return H4(e,t)}}function H4(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function Hte(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,c,b,S,i=[],P=!0,L=!1;try{if(b=(a=a.call(e)).next,t!==0)for(;!(P=(o=b.call(a)).done)&&(i.push(o.value),i.length!==t);P=!0);}catch(U){L=!0,c=U}finally{try{if(!P&&a.return!=null&&(S=a.return(),Object(S)!==S))return}finally{if(L)throw c}}return i}}function Xte(e){if(Array.isArray(e))return e}function X4(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function fM(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?X4(Object(a),!0).forEach(function(o){Yte(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):X4(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Yte(e,t,a){return t=Zte(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Zte(e){var t=Wte(e,"string");return z0(t)=="symbol"?t:t+""}function Wte(e,t){if(z0(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(z0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kte(e){return Array.isArray(e)&&os(e[0])&&os(e[1])?e.join(" ~ "):e}var Jte=function(t){var a=t.separator,o=a===void 0?" : ":a,c=t.contentStyle,b=c===void 0?{}:c,S=t.itemStyle,i=S===void 0?{}:S,P=t.labelStyle,L=P===void 0?{}:P,U=t.payload,V=t.formatter,H=t.itemSorter,ee=t.wrapperClassName,ie=t.labelClassName,le=t.label,ue=t.labelFormatter,ge=t.accessibilityLayer,Se=ge===void 0?!1:ge,ve=function(){if(U&&U.length){var Ot={padding:0,margin:0},Bt=(H?PP(U,H):U).map(function(Tt,mt){if(Tt.type==="none")return null;var bt=fM({display:"block",paddingTop:4,paddingBottom:4,color:Tt.color||"#000"},i),Ft=Tt.formatter||V||Kte,Zt=Tt.value,Vt=Tt.name,Ze=Zt,Xt=Vt;if(Ft&&Ze!=null&&Xt!=null){var an=Ft(Zt,Vt,Tt,mt,U);if(Array.isArray(an)){var qt=qte(an,2);Ze=qt[0],Xt=qt[1]}else Ze=an}return kt.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(mt),style:bt},os(Xt)?kt.createElement("span",{className:"recharts-tooltip-item-name"},Xt):null,os(Xt)?kt.createElement("span",{className:"recharts-tooltip-item-separator"},o):null,kt.createElement("span",{className:"recharts-tooltip-item-value"},Ze),kt.createElement("span",{className:"recharts-tooltip-item-unit"},Tt.unit||""))});return kt.createElement("ul",{className:"recharts-tooltip-item-list",style:Ot},Bt)}return null},Ee=fM({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},b),me=fM({margin:0},L),Ae=!vi(le),Oe=Ae?le:"",Ye=ia("recharts-default-tooltip",ee),He=ia("recharts-tooltip-label",ie);Ae&&ue&&U!==void 0&&U!==null&&(Oe=ue(le,U));var st=Se?{role:"status","aria-live":"assertive"}:{};return kt.createElement("div",sI({className:Ye,style:Ee},st),kt.createElement("p",{className:He,style:me},kt.isValidElement(Oe)?Oe:"".concat(Oe)),ve())};function N0(e){"@babel/helpers - typeof";return N0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N0(e)}function X1(e,t,a){return t=Qte(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Qte(e){var t=ene(e,"string");return N0(t)=="symbol"?t:t+""}function ene(e,t){if(N0(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(N0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zv="recharts-tooltip-wrapper",tne={visibility:"hidden"};function nne(e){var t=e.coordinate,a=e.translateX,o=e.translateY;return ia(Zv,X1(X1(X1(X1({},"".concat(Zv,"-right"),er(a)&&t&&er(t.x)&&a>=t.x),"".concat(Zv,"-left"),er(a)&&t&&er(t.x)&&a<t.x),"".concat(Zv,"-bottom"),er(o)&&t&&er(t.y)&&o>=t.y),"".concat(Zv,"-top"),er(o)&&t&&er(t.y)&&o<t.y))}function Y4(e){var t=e.allowEscapeViewBox,a=e.coordinate,o=e.key,c=e.offsetTopLeft,b=e.position,S=e.reverseDirection,i=e.tooltipDimension,P=e.viewBox,L=e.viewBoxDimension;if(b&&er(b[o]))return b[o];var U=a[o]-i-c,V=a[o]+c;if(t[o])return S[o]?U:V;if(S[o]){var H=U,ee=P[o];return H<ee?Math.max(V,P[o]):Math.max(U,P[o])}var ie=V+i,le=P[o]+L;return ie>le?Math.max(U,P[o]):Math.max(V,P[o])}function rne(e){var t=e.translateX,a=e.translateY,o=e.useTranslate3d;return{transform:o?"translate3d(".concat(t,"px, ").concat(a,"px, 0)"):"translate(".concat(t,"px, ").concat(a,"px)")}}function ine(e){var t=e.allowEscapeViewBox,a=e.coordinate,o=e.offsetTopLeft,c=e.position,b=e.reverseDirection,S=e.tooltipBox,i=e.useTranslate3d,P=e.viewBox,L,U,V;return S.height>0&&S.width>0&&a?(U=Y4({allowEscapeViewBox:t,coordinate:a,key:"x",offsetTopLeft:o,position:c,reverseDirection:b,tooltipDimension:S.width,viewBox:P,viewBoxDimension:P.width}),V=Y4({allowEscapeViewBox:t,coordinate:a,key:"y",offsetTopLeft:o,position:c,reverseDirection:b,tooltipDimension:S.height,viewBox:P,viewBoxDimension:P.height}),L=rne({translateX:U,translateY:V,useTranslate3d:i})):L=tne,{cssProperties:L,cssClasses:nne({translateX:U,translateY:V,coordinate:a})}}function l_(e){"@babel/helpers - typeof";return l_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l_(e)}function Z4(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function W4(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?Z4(Object(a),!0).forEach(function(o){uI(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Z4(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function ane(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function one(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,KV(o.key),o)}}function sne(e,t,a){return t&&one(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function lne(e,t,a){return t=Gb(t),une(e,WV()?Reflect.construct(t,a||[],Gb(e).constructor):t.apply(e,a))}function une(e,t){if(t&&(l_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cne(e)}function cne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(WV=function(){return!!e})()}function Gb(e){return Gb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Gb(e)}function hne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lI(e,t)}function lI(e,t){return lI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,c){return o.__proto__=c,o},lI(e,t)}function uI(e,t,a){return t=KV(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function KV(e){var t=fne(e,"string");return l_(t)=="symbol"?t:t+""}function fne(e,t){if(l_(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(l_(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var K4=1,dne=function(e){function t(){var a;ane(this,t);for(var o=arguments.length,c=new Array(o),b=0;b<o;b++)c[b]=arguments[b];return a=lne(this,t,[].concat(c)),uI(a,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),uI(a,"handleKeyDown",function(S){if(S.key==="Escape"){var i,P,L,U;a.setState({dismissed:!0,dismissedAtCoordinate:{x:(i=(P=a.props.coordinate)===null||P===void 0?void 0:P.x)!==null&&i!==void 0?i:0,y:(L=(U=a.props.coordinate)===null||U===void 0?void 0:U.y)!==null&&L!==void 0?L:0}})}}),a}return hne(t,e),sne(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var o=this.wrapperNode.getBoundingClientRect();(Math.abs(o.width-this.state.lastBoundingBox.width)>K4||Math.abs(o.height-this.state.lastBoundingBox.height)>K4)&&this.setState({lastBoundingBox:{width:o.width,height:o.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var o,c;this.props.active&&this.updateBBox(),this.state.dismissed&&(((o=this.props.coordinate)===null||o===void 0?void 0:o.x)!==this.state.dismissedAtCoordinate.x||((c=this.props.coordinate)===null||c===void 0?void 0:c.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var o=this,c=this.props,b=c.active,S=c.allowEscapeViewBox,i=c.animationDuration,P=c.animationEasing,L=c.children,U=c.coordinate,V=c.hasPayload,H=c.isAnimationActive,ee=c.offset,ie=c.position,le=c.reverseDirection,ue=c.useTranslate3d,ge=c.viewBox,Se=c.wrapperStyle,ve=ine({allowEscapeViewBox:S,coordinate:U,offsetTopLeft:ee,position:ie,reverseDirection:le,tooltipBox:this.state.lastBoundingBox,useTranslate3d:ue,viewBox:ge}),Ee=ve.cssClasses,me=ve.cssProperties,Ae=W4(W4({transition:H&&b?"transform ".concat(i,"ms ").concat(P):void 0},me),{},{pointerEvents:"none",visibility:!this.state.dismissed&&b&&V?"visible":"hidden",position:"absolute",top:0,left:0},Se);return kt.createElement("div",{tabIndex:-1,className:Ee,style:Ae,ref:function(Ye){o.wrapperNode=Ye}},L)}}])}(Jt.PureComponent),pne=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},B_={isSsr:pne()};function u_(e){"@babel/helpers - typeof";return u_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u_(e)}function J4(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function Q4(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?J4(Object(a),!0).forEach(function(o){RP(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):J4(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function mne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gne(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,QV(o.key),o)}}function yne(e,t,a){return t&&gne(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _ne(e,t,a){return t=$b(t),vne(e,JV()?Reflect.construct(t,a||[],$b(e).constructor):t.apply(e,a))}function vne(e,t){if(t&&(u_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xne(e)}function xne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(JV=function(){return!!e})()}function $b(e){return $b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},$b(e)}function bne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cI(e,t)}function cI(e,t){return cI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,c){return o.__proto__=c,o},cI(e,t)}function RP(e,t,a){return t=QV(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function QV(e){var t=wne(e,"string");return u_(t)=="symbol"?t:t+""}function wne(e,t){if(u_(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(u_(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Sne(e){return e.dataKey}function Tne(e,t){return kt.isValidElement(e)?kt.cloneElement(e,t):typeof e=="function"?kt.createElement(e,t):kt.createElement(Jte,t)}var Ih=function(e){function t(){return mne(this,t),_ne(this,t,arguments)}return bne(t,e),yne(t,[{key:"render",value:function(){var o=this,c=this.props,b=c.active,S=c.allowEscapeViewBox,i=c.animationDuration,P=c.animationEasing,L=c.content,U=c.coordinate,V=c.filterNull,H=c.isAnimationActive,ee=c.offset,ie=c.payload,le=c.payloadUniqBy,ue=c.position,ge=c.reverseDirection,Se=c.useTranslate3d,ve=c.viewBox,Ee=c.wrapperStyle,me=ie??[];V&&me.length&&(me=qV(ie.filter(function(Oe){return Oe.value!=null&&(Oe.hide!==!0||o.props.includeHidden)}),le,Sne));var Ae=me.length>0;return kt.createElement(dne,{allowEscapeViewBox:S,animationDuration:i,animationEasing:P,isAnimationActive:H,active:b,coordinate:U,hasPayload:Ae,offset:ee,position:ue,reverseDirection:ge,useTranslate3d:Se,viewBox:ve,wrapperStyle:Ee},Tne(L,Q4(Q4({},this.props),{},{payload:me})))}}])}(Jt.PureComponent);RP(Ih,"displayName","Tooltip");RP(Ih,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!B_.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var dM,e5;function Ene(){if(e5)return dM;e5=1;var e=qf(),t=function(){return e.Date.now()};return dM=t,dM}var pM,t5;function Ane(){if(t5)return pM;t5=1;var e=/\s/;function t(a){for(var o=a.length;o--&&e.test(a.charAt(o)););return o}return pM=t,pM}var mM,n5;function Mne(){if(n5)return mM;n5=1;var e=Ane(),t=/^\s+/;function a(o){return o&&o.slice(0,e(o)+1).replace(t,"")}return mM=a,mM}var gM,r5;function e8(){if(r5)return gM;r5=1;var e=Mne(),t=cm(),a=L_(),o=NaN,c=/^[-+]0x[0-9a-f]+$/i,b=/^0b[01]+$/i,S=/^0o[0-7]+$/i,i=parseInt;function P(L){if(typeof L=="number")return L;if(a(L))return o;if(t(L)){var U=typeof L.valueOf=="function"?L.valueOf():L;L=t(U)?U+"":U}if(typeof L!="string")return L===0?L:+L;L=e(L);var V=b.test(L);return V||S.test(L)?i(L.slice(2),V?2:8):c.test(L)?o:+L}return gM=P,gM}var yM,i5;function One(){if(i5)return yM;i5=1;var e=cm(),t=Ene(),a=e8(),o="Expected a function",c=Math.max,b=Math.min;function S(i,P,L){var U,V,H,ee,ie,le,ue=0,ge=!1,Se=!1,ve=!0;if(typeof i!="function")throw new TypeError(o);P=a(P)||0,e(L)&&(ge=!!L.leading,Se="maxWait"in L,H=Se?c(a(L.maxWait)||0,P):H,ve="trailing"in L?!!L.trailing:ve);function Ee(Bt){var Tt=U,mt=V;return U=V=void 0,ue=Bt,ee=i.apply(mt,Tt),ee}function me(Bt){return ue=Bt,ie=setTimeout(Ye,P),ge?Ee(Bt):ee}function Ae(Bt){var Tt=Bt-le,mt=Bt-ue,bt=P-Tt;return Se?b(bt,H-mt):bt}function Oe(Bt){var Tt=Bt-le,mt=Bt-ue;return le===void 0||Tt>=P||Tt<0||Se&&mt>=H}function Ye(){var Bt=t();if(Oe(Bt))return He(Bt);ie=setTimeout(Ye,Ae(Bt))}function He(Bt){return ie=void 0,ve&&U?Ee(Bt):(U=V=void 0,ee)}function st(){ie!==void 0&&clearTimeout(ie),ue=0,U=le=V=ie=void 0}function Ke(){return ie===void 0?ee:He(t())}function Ot(){var Bt=t(),Tt=Oe(Bt);if(U=arguments,V=this,le=Bt,Tt){if(ie===void 0)return me(le);if(Se)return clearTimeout(ie),ie=setTimeout(Ye,P),Ee(le)}return ie===void 0&&(ie=setTimeout(Ye,P)),ee}return Ot.cancel=st,Ot.flush=Ke,Ot}return yM=S,yM}var _M,a5;function Ine(){if(a5)return _M;a5=1;var e=One(),t=cm(),a="Expected a function";function o(c,b,S){var i=!0,P=!0;if(typeof c!="function")throw new TypeError(a);return t(S)&&(i="leading"in S?!!S.leading:i,P="trailing"in S?!!S.trailing:P),e(c,b,{leading:i,maxWait:b,trailing:P})}return _M=o,_M}var Cne=Ine();const t8=fa(Cne);function B0(e){"@babel/helpers - typeof";return B0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B0(e)}function o5(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function Y1(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?o5(Object(a),!0).forEach(function(o){Pne(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o5(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Pne(e,t,a){return t=Rne(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Rne(e){var t=kne(e,"string");return B0(t)=="symbol"?t:t+""}function kne(e,t){if(B0(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(B0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dne(e,t){return Bne(e)||Nne(e,t)||zne(e,t)||Lne()}function Lne(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zne(e,t){if(e){if(typeof e=="string")return s5(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return s5(e,t)}}function s5(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function Nne(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,c,b,S,i=[],P=!0,L=!1;try{if(b=(a=a.call(e)).next,t!==0)for(;!(P=(o=b.call(a)).done)&&(i.push(o.value),i.length!==t);P=!0);}catch(U){L=!0,c=U}finally{try{if(!P&&a.return!=null&&(S=a.return(),Object(S)!==S))return}finally{if(L)throw c}}return i}}function Bne(e){if(Array.isArray(e))return e}var n8=Jt.forwardRef(function(e,t){var a=e.aspect,o=e.initialDimension,c=o===void 0?{width:-1,height:-1}:o,b=e.width,S=b===void 0?"100%":b,i=e.height,P=i===void 0?"100%":i,L=e.minWidth,U=L===void 0?0:L,V=e.minHeight,H=e.maxHeight,ee=e.children,ie=e.debounce,le=ie===void 0?0:ie,ue=e.id,ge=e.className,Se=e.onResize,ve=e.style,Ee=ve===void 0?{}:ve,me=Jt.useRef(null),Ae=Jt.useRef();Ae.current=Se,Jt.useImperativeHandle(t,function(){return Object.defineProperty(me.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),me.current},configurable:!0})});var Oe=Jt.useState({containerWidth:c.width,containerHeight:c.height}),Ye=Dne(Oe,2),He=Ye[0],st=Ye[1],Ke=Jt.useCallback(function(Bt,Tt){st(function(mt){var bt=Math.round(Bt),Ft=Math.round(Tt);return mt.containerWidth===bt&&mt.containerHeight===Ft?mt:{containerWidth:bt,containerHeight:Ft}})},[]);Jt.useEffect(function(){var Bt=function(Vt){var Ze,Xt=Vt[0].contentRect,an=Xt.width,qt=Xt.height;Ke(an,qt),(Ze=Ae.current)===null||Ze===void 0||Ze.call(Ae,an,qt)};le>0&&(Bt=t8(Bt,le,{trailing:!0,leading:!1}));var Tt=new ResizeObserver(Bt),mt=me.current.getBoundingClientRect(),bt=mt.width,Ft=mt.height;return Ke(bt,Ft),Tt.observe(me.current),function(){Tt.disconnect()}},[Ke,le]);var Ot=Jt.useMemo(function(){var Bt=He.containerWidth,Tt=He.containerHeight;if(Bt<0||Tt<0)return null;qd(dg(S)||dg(P),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,S,P),qd(!a||a>0,"The aspect(%s) must be greater than zero.",a);var mt=dg(S)?Bt:S,bt=dg(P)?Tt:P;a&&a>0&&(mt?bt=mt/a:bt&&(mt=bt*a),H&&bt>H&&(bt=H)),qd(mt>0||bt>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,mt,bt,S,P,U,V,a);var Ft=!Array.isArray(ee)&&Vd(ee.type).endsWith("Chart");return kt.Children.map(ee,function(Zt){return kt.isValidElement(Zt)?Jt.cloneElement(Zt,Y1({width:mt,height:bt},Ft?{style:Y1({height:"100%",width:"100%",maxHeight:bt,maxWidth:mt},Zt.props.style)}:{})):Zt})},[a,ee,P,H,V,U,He,S]);return kt.createElement("div",{id:ue?"".concat(ue):void 0,className:ia("recharts-responsive-container",ge),style:Y1(Y1({},Ee),{},{width:S,height:P,minWidth:U,minHeight:V,maxHeight:H}),ref:me},Ot)}),kP=function(t){return null};kP.displayName="Cell";function F0(e){"@babel/helpers - typeof";return F0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F0(e)}function l5(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function hI(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?l5(Object(a),!0).forEach(function(o){Fne(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l5(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Fne(e,t,a){return t=jne(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function jne(e){var t=Une(e,"string");return F0(t)=="symbol"?t:t+""}function Une(e,t){if(F0(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(F0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dy={widthCache:{},cacheCount:0},Vne=2e3,qne={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},u5="recharts_measurement_span";function Gne(e){var t=hI({},e);return Object.keys(t).forEach(function(a){t[a]||delete t[a]}),t}var v0=function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||B_.isSsr)return{width:0,height:0};var o=Gne(a),c=JSON.stringify({text:t,copyStyle:o});if(Dy.widthCache[c])return Dy.widthCache[c];try{var b=document.getElementById(u5);b||(b=document.createElement("span"),b.setAttribute("id",u5),b.setAttribute("aria-hidden","true"),document.body.appendChild(b));var S=hI(hI({},qne),o);Object.assign(b.style,S),b.textContent="".concat(t);var i=b.getBoundingClientRect(),P={width:i.width,height:i.height};return Dy.widthCache[c]=P,++Dy.cacheCount>Vne&&(Dy.cacheCount=0,Dy.widthCache={}),P}catch{return{width:0,height:0}}},$ne=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function j0(e){"@babel/helpers - typeof";return j0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j0(e)}function Hb(e,t){return Zne(e)||Yne(e,t)||Xne(e,t)||Hne()}function Hne(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xne(e,t){if(e){if(typeof e=="string")return c5(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return c5(e,t)}}function c5(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function Yne(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,c,b,S,i=[],P=!0,L=!1;try{if(b=(a=a.call(e)).next,t===0){if(Object(a)!==a)return;P=!1}else for(;!(P=(o=b.call(a)).done)&&(i.push(o.value),i.length!==t);P=!0);}catch(U){L=!0,c=U}finally{try{if(!P&&a.return!=null&&(S=a.return(),Object(S)!==S))return}finally{if(L)throw c}}return i}}function Zne(e){if(Array.isArray(e))return e}function Wne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h5(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Jne(o.key),o)}}function Kne(e,t,a){return t&&h5(e.prototype,t),a&&h5(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jne(e){var t=Qne(e,"string");return j0(t)=="symbol"?t:t+""}function Qne(e,t){if(j0(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(j0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var f5=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,d5=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,ere=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,tre=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,r8={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},nre=Object.keys(r8),Hy="NaN";function rre(e,t){return e*r8[t]}var Z1=function(){function e(t,a){Wne(this,e),this.num=t,this.unit=a,this.num=t,this.unit=a,Number.isNaN(t)&&(this.unit=""),a!==""&&!ere.test(a)&&(this.num=NaN,this.unit=""),nre.includes(a)&&(this.num=rre(t,a),this.unit="px")}return Kne(e,[{key:"add",value:function(a){return this.unit!==a.unit?new e(NaN,""):new e(this.num+a.num,this.unit)}},{key:"subtract",value:function(a){return this.unit!==a.unit?new e(NaN,""):new e(this.num-a.num,this.unit)}},{key:"multiply",value:function(a){return this.unit!==""&&a.unit!==""&&this.unit!==a.unit?new e(NaN,""):new e(this.num*a.num,this.unit||a.unit)}},{key:"divide",value:function(a){return this.unit!==""&&a.unit!==""&&this.unit!==a.unit?new e(NaN,""):new e(this.num/a.num,this.unit||a.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(a){var o,c=(o=tre.exec(a))!==null&&o!==void 0?o:[],b=Hb(c,3),S=b[1],i=b[2];return new e(parseFloat(S),i??"")}}])}();function i8(e){if(e.includes(Hy))return Hy;for(var t=e;t.includes("*")||t.includes("/");){var a,o=(a=f5.exec(t))!==null&&a!==void 0?a:[],c=Hb(o,4),b=c[1],S=c[2],i=c[3],P=Z1.parse(b??""),L=Z1.parse(i??""),U=S==="*"?P.multiply(L):P.divide(L);if(U.isNaN())return Hy;t=t.replace(f5,U.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var V,H=(V=d5.exec(t))!==null&&V!==void 0?V:[],ee=Hb(H,4),ie=ee[1],le=ee[2],ue=ee[3],ge=Z1.parse(ie??""),Se=Z1.parse(ue??""),ve=le==="+"?ge.add(Se):ge.subtract(Se);if(ve.isNaN())return Hy;t=t.replace(d5,ve.toString())}return t}var p5=/\(([^()]*)\)/;function ire(e){for(var t=e;t.includes("(");){var a=p5.exec(t),o=Hb(a,2),c=o[1];t=t.replace(p5,i8(c))}return t}function are(e){var t=e.replace(/\s+/g,"");return t=ire(t),t=i8(t),t}function ore(e){try{return are(e)}catch{return Hy}}function vM(e){var t=ore(e.slice(5,-1));return t===Hy?"":t}var sre=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],lre=["dx","dy","angle","className","breakAll"];function fI(){return fI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},fI.apply(this,arguments)}function m5(e,t){if(e==null)return{};var a=ure(e,t),o,c;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(c=0;c<b.length;c++)o=b[c],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function ure(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function g5(e,t){return dre(e)||fre(e,t)||hre(e,t)||cre()}function cre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hre(e,t){if(e){if(typeof e=="string")return y5(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return y5(e,t)}}function y5(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function fre(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,c,b,S,i=[],P=!0,L=!1;try{if(b=(a=a.call(e)).next,t===0){if(Object(a)!==a)return;P=!1}else for(;!(P=(o=b.call(a)).done)&&(i.push(o.value),i.length!==t);P=!0);}catch(U){L=!0,c=U}finally{try{if(!P&&a.return!=null&&(S=a.return(),Object(S)!==S))return}finally{if(L)throw c}}return i}}function dre(e){if(Array.isArray(e))return e}var a8=/[ \f\n\r\t\v\u2028\u2029]+/,o8=function(t){var a=t.children,o=t.breakAll,c=t.style;try{var b=[];vi(a)||(o?b=a.toString().split(""):b=a.toString().split(a8));var S=b.map(function(P){return{word:P,width:v0(P,c).width}}),i=o?0:v0("",c).width;return{wordsWithComputedWidth:S,spaceWidth:i}}catch{return null}},pre=function(t,a,o,c,b){var S=t.maxLines,i=t.children,P=t.style,L=t.breakAll,U=er(S),V=i,H=function(){var mt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return mt.reduce(function(bt,Ft){var Zt=Ft.word,Vt=Ft.width,Ze=bt[bt.length-1];if(Ze&&(c==null||b||Ze.width+Vt+o<Number(c)))Ze.words.push(Zt),Ze.width+=Vt+o;else{var Xt={words:[Zt],width:Vt};bt.push(Xt)}return bt},[])},ee=H(a),ie=function(mt){return mt.reduce(function(bt,Ft){return bt.width>Ft.width?bt:Ft})};if(!U)return ee;for(var le="",ue=function(mt){var bt=V.slice(0,mt),Ft=o8({breakAll:L,style:P,children:bt+le}).wordsWithComputedWidth,Zt=H(Ft),Vt=Zt.length>S||ie(Zt).width>Number(c);return[Vt,Zt]},ge=0,Se=V.length-1,ve=0,Ee;ge<=Se&&ve<=V.length-1;){var me=Math.floor((ge+Se)/2),Ae=me-1,Oe=ue(Ae),Ye=g5(Oe,2),He=Ye[0],st=Ye[1],Ke=ue(me),Ot=g5(Ke,1),Bt=Ot[0];if(!He&&!Bt&&(ge=me+1),He&&Bt&&(Se=me-1),!He&&Bt){Ee=st;break}ve++}return Ee||ee},_5=function(t){var a=vi(t)?[]:t.toString().split(a8);return[{words:a}]},mre=function(t){var a=t.width,o=t.scaleToFit,c=t.children,b=t.style,S=t.breakAll,i=t.maxLines;if((a||o)&&!B_.isSsr){var P,L,U=o8({breakAll:S,children:c,style:b});if(U){var V=U.wordsWithComputedWidth,H=U.spaceWidth;P=V,L=H}else return _5(c);return pre({breakAll:S,children:c,maxLines:i,style:b},P,L,a,o)}return _5(c)},v5="#808080",Xb=function(t){var a=t.x,o=a===void 0?0:a,c=t.y,b=c===void 0?0:c,S=t.lineHeight,i=S===void 0?"1em":S,P=t.capHeight,L=P===void 0?"0.71em":P,U=t.scaleToFit,V=U===void 0?!1:U,H=t.textAnchor,ee=H===void 0?"start":H,ie=t.verticalAnchor,le=ie===void 0?"end":ie,ue=t.fill,ge=ue===void 0?v5:ue,Se=m5(t,sre),ve=Jt.useMemo(function(){return mre({breakAll:Se.breakAll,children:Se.children,maxLines:Se.maxLines,scaleToFit:V,style:Se.style,width:Se.width})},[Se.breakAll,Se.children,Se.maxLines,V,Se.style,Se.width]),Ee=Se.dx,me=Se.dy,Ae=Se.angle,Oe=Se.className,Ye=Se.breakAll,He=m5(Se,lre);if(!os(o)||!os(b))return null;var st=o+(er(Ee)?Ee:0),Ke=b+(er(me)?me:0),Ot;switch(le){case"start":Ot=vM("calc(".concat(L,")"));break;case"middle":Ot=vM("calc(".concat((ve.length-1)/2," * -").concat(i," + (").concat(L," / 2))"));break;default:Ot=vM("calc(".concat(ve.length-1," * -").concat(i,")"));break}var Bt=[];if(V){var Tt=ve[0].width,mt=Se.width;Bt.push("scale(".concat((er(mt)?mt/Tt:1)/Tt,")"))}return Ae&&Bt.push("rotate(".concat(Ae,", ").concat(st,", ").concat(Ke,")")),Bt.length&&(He.transform=Bt.join(" ")),kt.createElement("text",fI({},ji(He,!0),{x:st,y:Ke,className:ia("recharts-text",Oe),textAnchor:ee,fill:ge.includes("url")?v5:ge}),ve.map(function(bt,Ft){var Zt=bt.words.join(Ye?"":" ");return kt.createElement("tspan",{x:st,dy:Ft===0?Ot:i,key:"".concat(Zt,"-").concat(Ft)},Zt)}))};function nm(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function gre(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function DP(e){let t,a,o;e.length!==2?(t=nm,a=(i,P)=>nm(e(i),P),o=(i,P)=>e(i)-P):(t=e===nm||e===gre?e:yre,a=e,o=e);function c(i,P,L=0,U=i.length){if(L<U){if(t(P,P)!==0)return U;do{const V=L+U>>>1;a(i[V],P)<0?L=V+1:U=V}while(L<U)}return L}function b(i,P,L=0,U=i.length){if(L<U){if(t(P,P)!==0)return U;do{const V=L+U>>>1;a(i[V],P)<=0?L=V+1:U=V}while(L<U)}return L}function S(i,P,L=0,U=i.length){const V=c(i,P,L,U-1);return V>L&&o(i[V-1],P)>-o(i[V],P)?V-1:V}return{left:c,center:S,right:b}}function yre(){return 0}function s8(e){return e===null?NaN:+e}function*_re(e,t){for(let a of e)a!=null&&(a=+a)>=a&&(yield a)}const vre=DP(nm),Ox=vre.right;DP(s8).center;class x5 extends Map{constructor(t,a=wre){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:a}}),t!=null)for(const[o,c]of t)this.set(o,c)}get(t){return super.get(b5(this,t))}has(t){return super.has(b5(this,t))}set(t,a){return super.set(xre(this,t),a)}delete(t){return super.delete(bre(this,t))}}function b5({_intern:e,_key:t},a){const o=t(a);return e.has(o)?e.get(o):a}function xre({_intern:e,_key:t},a){const o=t(a);return e.has(o)?e.get(o):(e.set(o,a),a)}function bre({_intern:e,_key:t},a){const o=t(a);return e.has(o)&&(a=e.get(o),e.delete(o)),a}function wre(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Sre(e=nm){if(e===nm)return l8;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,a)=>{const o=e(t,a);return o||o===0?o:(e(a,a)===0)-(e(t,t)===0)}}function l8(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const Tre=Math.sqrt(50),Ere=Math.sqrt(10),Are=Math.sqrt(2);function Yb(e,t,a){const o=(t-e)/Math.max(0,a),c=Math.floor(Math.log10(o)),b=o/Math.pow(10,c),S=b>=Tre?10:b>=Ere?5:b>=Are?2:1;let i,P,L;return c<0?(L=Math.pow(10,-c)/S,i=Math.round(e*L),P=Math.round(t*L),i/L<e&&++i,P/L>t&&--P,L=-L):(L=Math.pow(10,c)*S,i=Math.round(e/L),P=Math.round(t/L),i*L<e&&++i,P*L>t&&--P),P<i&&.5<=a&&a<2?Yb(e,t,a*2):[i,P,L]}function dI(e,t,a){if(t=+t,e=+e,a=+a,!(a>0))return[];if(e===t)return[e];const o=t<e,[c,b,S]=o?Yb(t,e,a):Yb(e,t,a);if(!(b>=c))return[];const i=b-c+1,P=new Array(i);if(o)if(S<0)for(let L=0;L<i;++L)P[L]=(b-L)/-S;else for(let L=0;L<i;++L)P[L]=(b-L)*S;else if(S<0)for(let L=0;L<i;++L)P[L]=(c+L)/-S;else for(let L=0;L<i;++L)P[L]=(c+L)*S;return P}function pI(e,t,a){return t=+t,e=+e,a=+a,Yb(e,t,a)[2]}function mI(e,t,a){t=+t,e=+e,a=+a;const o=t<e,c=o?pI(t,e,a):pI(e,t,a);return(o?-1:1)*(c<0?1/-c:c)}function w5(e,t){let a;for(const o of e)o!=null&&(a<o||a===void 0&&o>=o)&&(a=o);return a}function S5(e,t){let a;for(const o of e)o!=null&&(a>o||a===void 0&&o>=o)&&(a=o);return a}function u8(e,t,a=0,o=1/0,c){if(t=Math.floor(t),a=Math.floor(Math.max(0,a)),o=Math.floor(Math.min(e.length-1,o)),!(a<=t&&t<=o))return e;for(c=c===void 0?l8:Sre(c);o>a;){if(o-a>600){const P=o-a+1,L=t-a+1,U=Math.log(P),V=.5*Math.exp(2*U/3),H=.5*Math.sqrt(U*V*(P-V)/P)*(L-P/2<0?-1:1),ee=Math.max(a,Math.floor(t-L*V/P+H)),ie=Math.min(o,Math.floor(t+(P-L)*V/P+H));u8(e,t,ee,ie,c)}const b=e[t];let S=a,i=o;for(Wv(e,a,t),c(e[o],b)>0&&Wv(e,a,o);S<i;){for(Wv(e,S,i),++S,--i;c(e[S],b)<0;)++S;for(;c(e[i],b)>0;)--i}c(e[a],b)===0?Wv(e,a,i):(++i,Wv(e,i,o)),i<=t&&(a=i+1),t<=i&&(o=i-1)}return e}function Wv(e,t,a){const o=e[t];e[t]=e[a],e[a]=o}function Mre(e,t,a){if(e=Float64Array.from(_re(e)),!(!(o=e.length)||isNaN(t=+t))){if(t<=0||o<2)return S5(e);if(t>=1)return w5(e);var o,c=(o-1)*t,b=Math.floor(c),S=w5(u8(e,b).subarray(0,b+1)),i=S5(e.subarray(b+1));return S+(i-S)*(c-b)}}function Ore(e,t,a=s8){if(!(!(o=e.length)||isNaN(t=+t))){if(t<=0||o<2)return+a(e[0],0,e);if(t>=1)return+a(e[o-1],o-1,e);var o,c=(o-1)*t,b=Math.floor(c),S=+a(e[b],b,e),i=+a(e[b+1],b+1,e);return S+(i-S)*(c-b)}}function Ire(e,t,a){e=+e,t=+t,a=(c=arguments.length)<2?(t=e,e=0,1):c<3?1:+a;for(var o=-1,c=Math.max(0,Math.ceil((t-e)/a))|0,b=new Array(c);++o<c;)b[o]=e+o*a;return b}function Xc(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function tp(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const gI=Symbol("implicit");function LP(){var e=new x5,t=[],a=[],o=gI;function c(b){let S=e.get(b);if(S===void 0){if(o!==gI)return o;e.set(b,S=t.push(b)-1)}return a[S%a.length]}return c.domain=function(b){if(!arguments.length)return t.slice();t=[],e=new x5;for(const S of b)e.has(S)||e.set(S,t.push(S)-1);return c},c.range=function(b){return arguments.length?(a=Array.from(b),c):a.slice()},c.unknown=function(b){return arguments.length?(o=b,c):o},c.copy=function(){return LP(t,a).unknown(o)},Xc.apply(c,arguments),c}function U0(){var e=LP().unknown(void 0),t=e.domain,a=e.range,o=0,c=1,b,S,i=!1,P=0,L=0,U=.5;delete e.unknown;function V(){var H=t().length,ee=c<o,ie=ee?c:o,le=ee?o:c;b=(le-ie)/Math.max(1,H-P+L*2),i&&(b=Math.floor(b)),ie+=(le-ie-b*(H-P))*U,S=b*(1-P),i&&(ie=Math.round(ie),S=Math.round(S));var ue=Ire(H).map(function(ge){return ie+b*ge});return a(ee?ue.reverse():ue)}return e.domain=function(H){return arguments.length?(t(H),V()):t()},e.range=function(H){return arguments.length?([o,c]=H,o=+o,c=+c,V()):[o,c]},e.rangeRound=function(H){return[o,c]=H,o=+o,c=+c,i=!0,V()},e.bandwidth=function(){return S},e.step=function(){return b},e.round=function(H){return arguments.length?(i=!!H,V()):i},e.padding=function(H){return arguments.length?(P=Math.min(1,L=+H),V()):P},e.paddingInner=function(H){return arguments.length?(P=Math.min(1,H),V()):P},e.paddingOuter=function(H){return arguments.length?(L=+H,V()):L},e.align=function(H){return arguments.length?(U=Math.max(0,Math.min(1,H)),V()):U},e.copy=function(){return U0(t(),[o,c]).round(i).paddingInner(P).paddingOuter(L).align(U)},Xc.apply(V(),arguments)}function c8(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return c8(t())},e}function x0(){return c8(U0.apply(null,arguments).paddingInner(1))}function zP(e,t,a){e.prototype=t.prototype=a,a.constructor=e}function h8(e,t){var a=Object.create(e.prototype);for(var o in t)a[o]=t[o];return a}function Ix(){}var V0=.7,Zb=1/V0,Qy="\\s*([+-]?\\d+)\\s*",q0="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Bf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Cre=/^#([0-9a-f]{3,8})$/,Pre=new RegExp(`^rgb\\(${Qy},${Qy},${Qy}\\)$`),Rre=new RegExp(`^rgb\\(${Bf},${Bf},${Bf}\\)$`),kre=new RegExp(`^rgba\\(${Qy},${Qy},${Qy},${q0}\\)$`),Dre=new RegExp(`^rgba\\(${Bf},${Bf},${Bf},${q0}\\)$`),Lre=new RegExp(`^hsl\\(${q0},${Bf},${Bf}\\)$`),zre=new RegExp(`^hsla\\(${q0},${Bf},${Bf},${q0}\\)$`),T5={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};zP(Ix,G0,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:E5,formatHex:E5,formatHex8:Nre,formatHsl:Bre,formatRgb:A5,toString:A5});function E5(){return this.rgb().formatHex()}function Nre(){return this.rgb().formatHex8()}function Bre(){return f8(this).formatHsl()}function A5(){return this.rgb().formatRgb()}function G0(e){var t,a;return e=(e+"").trim().toLowerCase(),(t=Cre.exec(e))?(a=t[1].length,t=parseInt(t[1],16),a===6?M5(t):a===3?new wu(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):a===8?W1(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):a===4?W1(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Pre.exec(e))?new wu(t[1],t[2],t[3],1):(t=Rre.exec(e))?new wu(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=kre.exec(e))?W1(t[1],t[2],t[3],t[4]):(t=Dre.exec(e))?W1(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Lre.exec(e))?C5(t[1],t[2]/100,t[3]/100,1):(t=zre.exec(e))?C5(t[1],t[2]/100,t[3]/100,t[4]):T5.hasOwnProperty(e)?M5(T5[e]):e==="transparent"?new wu(NaN,NaN,NaN,0):null}function M5(e){return new wu(e>>16&255,e>>8&255,e&255,1)}function W1(e,t,a,o){return o<=0&&(e=t=a=NaN),new wu(e,t,a,o)}function Fre(e){return e instanceof Ix||(e=G0(e)),e?(e=e.rgb(),new wu(e.r,e.g,e.b,e.opacity)):new wu}function yI(e,t,a,o){return arguments.length===1?Fre(e):new wu(e,t,a,o??1)}function wu(e,t,a,o){this.r=+e,this.g=+t,this.b=+a,this.opacity=+o}zP(wu,yI,h8(Ix,{brighter(e){return e=e==null?Zb:Math.pow(Zb,e),new wu(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?V0:Math.pow(V0,e),new wu(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new wu(_g(this.r),_g(this.g),_g(this.b),Wb(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:O5,formatHex:O5,formatHex8:jre,formatRgb:I5,toString:I5}));function O5(){return`#${pg(this.r)}${pg(this.g)}${pg(this.b)}`}function jre(){return`#${pg(this.r)}${pg(this.g)}${pg(this.b)}${pg((isNaN(this.opacity)?1:this.opacity)*255)}`}function I5(){const e=Wb(this.opacity);return`${e===1?"rgb(":"rgba("}${_g(this.r)}, ${_g(this.g)}, ${_g(this.b)}${e===1?")":`, ${e})`}`}function Wb(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function _g(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function pg(e){return e=_g(e),(e<16?"0":"")+e.toString(16)}function C5(e,t,a,o){return o<=0?e=t=a=NaN:a<=0||a>=1?e=t=NaN:t<=0&&(e=NaN),new Ph(e,t,a,o)}function f8(e){if(e instanceof Ph)return new Ph(e.h,e.s,e.l,e.opacity);if(e instanceof Ix||(e=G0(e)),!e)return new Ph;if(e instanceof Ph)return e;e=e.rgb();var t=e.r/255,a=e.g/255,o=e.b/255,c=Math.min(t,a,o),b=Math.max(t,a,o),S=NaN,i=b-c,P=(b+c)/2;return i?(t===b?S=(a-o)/i+(a<o)*6:a===b?S=(o-t)/i+2:S=(t-a)/i+4,i/=P<.5?b+c:2-b-c,S*=60):i=P>0&&P<1?0:S,new Ph(S,i,P,e.opacity)}function Ure(e,t,a,o){return arguments.length===1?f8(e):new Ph(e,t,a,o??1)}function Ph(e,t,a,o){this.h=+e,this.s=+t,this.l=+a,this.opacity=+o}zP(Ph,Ure,h8(Ix,{brighter(e){return e=e==null?Zb:Math.pow(Zb,e),new Ph(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?V0:Math.pow(V0,e),new Ph(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,a=this.l,o=a+(a<.5?a:1-a)*t,c=2*a-o;return new wu(xM(e>=240?e-240:e+120,c,o),xM(e,c,o),xM(e<120?e+240:e-120,c,o),this.opacity)},clamp(){return new Ph(P5(this.h),K1(this.s),K1(this.l),Wb(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Wb(this.opacity);return`${e===1?"hsl(":"hsla("}${P5(this.h)}, ${K1(this.s)*100}%, ${K1(this.l)*100}%${e===1?")":`, ${e})`}`}}));function P5(e){return e=(e||0)%360,e<0?e+360:e}function K1(e){return Math.max(0,Math.min(1,e||0))}function xM(e,t,a){return(e<60?t+(a-t)*e/60:e<180?a:e<240?t+(a-t)*(240-e)/60:t)*255}const NP=e=>()=>e;function Vre(e,t){return function(a){return e+a*t}}function qre(e,t,a){return e=Math.pow(e,a),t=Math.pow(t,a)-e,a=1/a,function(o){return Math.pow(e+o*t,a)}}function Gre(e){return(e=+e)==1?d8:function(t,a){return a-t?qre(t,a,e):NP(isNaN(t)?a:t)}}function d8(e,t){var a=t-e;return a?Vre(e,a):NP(isNaN(e)?t:e)}const R5=function e(t){var a=Gre(t);function o(c,b){var S=a((c=yI(c)).r,(b=yI(b)).r),i=a(c.g,b.g),P=a(c.b,b.b),L=d8(c.opacity,b.opacity);return function(U){return c.r=S(U),c.g=i(U),c.b=P(U),c.opacity=L(U),c+""}}return o.gamma=e,o}(1);function $re(e,t){t||(t=[]);var a=e?Math.min(t.length,e.length):0,o=t.slice(),c;return function(b){for(c=0;c<a;++c)o[c]=e[c]*(1-b)+t[c]*b;return o}}function Hre(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Xre(e,t){var a=t?t.length:0,o=e?Math.min(a,e.length):0,c=new Array(o),b=new Array(a),S;for(S=0;S<o;++S)c[S]=F_(e[S],t[S]);for(;S<a;++S)b[S]=t[S];return function(i){for(S=0;S<o;++S)b[S]=c[S](i);return b}}function Yre(e,t){var a=new Date;return e=+e,t=+t,function(o){return a.setTime(e*(1-o)+t*o),a}}function Kb(e,t){return e=+e,t=+t,function(a){return e*(1-a)+t*a}}function Zre(e,t){var a={},o={},c;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(c in t)c in e?a[c]=F_(e[c],t[c]):o[c]=t[c];return function(b){for(c in a)o[c]=a[c](b);return o}}var _I=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,bM=new RegExp(_I.source,"g");function Wre(e){return function(){return e}}function Kre(e){return function(t){return e(t)+""}}function Jre(e,t){var a=_I.lastIndex=bM.lastIndex=0,o,c,b,S=-1,i=[],P=[];for(e=e+"",t=t+"";(o=_I.exec(e))&&(c=bM.exec(t));)(b=c.index)>a&&(b=t.slice(a,b),i[S]?i[S]+=b:i[++S]=b),(o=o[0])===(c=c[0])?i[S]?i[S]+=c:i[++S]=c:(i[++S]=null,P.push({i:S,x:Kb(o,c)})),a=bM.lastIndex;return a<t.length&&(b=t.slice(a),i[S]?i[S]+=b:i[++S]=b),i.length<2?P[0]?Kre(P[0].x):Wre(t):(t=P.length,function(L){for(var U=0,V;U<t;++U)i[(V=P[U]).i]=V.x(L);return i.join("")})}function F_(e,t){var a=typeof t,o;return t==null||a==="boolean"?NP(t):(a==="number"?Kb:a==="string"?(o=G0(t))?(t=o,R5):Jre:t instanceof G0?R5:t instanceof Date?Yre:Hre(t)?$re:Array.isArray(t)?Xre:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Zre:Kb)(e,t)}function BP(e,t){return e=+e,t=+t,function(a){return Math.round(e*(1-a)+t*a)}}function Qre(e,t){t===void 0&&(t=e,e=F_);for(var a=0,o=t.length-1,c=t[0],b=new Array(o<0?0:o);a<o;)b[a]=e(c,c=t[++a]);return function(S){var i=Math.max(0,Math.min(o-1,Math.floor(S*=o)));return b[i](S-i)}}function eie(e){return function(){return e}}function Jb(e){return+e}var k5=[0,1];function Zl(e){return e}function vI(e,t){return(t-=e=+e)?function(a){return(a-e)/t}:eie(isNaN(t)?NaN:.5)}function tie(e,t){var a;return e>t&&(a=e,e=t,t=a),function(o){return Math.max(e,Math.min(t,o))}}function nie(e,t,a){var o=e[0],c=e[1],b=t[0],S=t[1];return c<o?(o=vI(c,o),b=a(S,b)):(o=vI(o,c),b=a(b,S)),function(i){return b(o(i))}}function rie(e,t,a){var o=Math.min(e.length,t.length)-1,c=new Array(o),b=new Array(o),S=-1;for(e[o]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++S<o;)c[S]=vI(e[S],e[S+1]),b[S]=a(t[S],t[S+1]);return function(i){var P=Ox(e,i,1,o)-1;return b[P](c[P](i))}}function Cx(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function l2(){var e=k5,t=k5,a=F_,o,c,b,S=Zl,i,P,L;function U(){var H=Math.min(e.length,t.length);return S!==Zl&&(S=tie(e[0],e[H-1])),i=H>2?rie:nie,P=L=null,V}function V(H){return H==null||isNaN(H=+H)?b:(P||(P=i(e.map(o),t,a)))(o(S(H)))}return V.invert=function(H){return S(c((L||(L=i(t,e.map(o),Kb)))(H)))},V.domain=function(H){return arguments.length?(e=Array.from(H,Jb),U()):e.slice()},V.range=function(H){return arguments.length?(t=Array.from(H),U()):t.slice()},V.rangeRound=function(H){return t=Array.from(H),a=BP,U()},V.clamp=function(H){return arguments.length?(S=H?!0:Zl,U()):S!==Zl},V.interpolate=function(H){return arguments.length?(a=H,U()):a},V.unknown=function(H){return arguments.length?(b=H,V):b},function(H,ee){return o=H,c=ee,U()}}function FP(){return l2()(Zl,Zl)}function iie(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Qb(e,t){if((a=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var a,o=e.slice(0,a);return[o.length>1?o[0]+o.slice(2):o,+e.slice(a+1)]}function c_(e){return e=Qb(Math.abs(e)),e?e[1]:NaN}function aie(e,t){return function(a,o){for(var c=a.length,b=[],S=0,i=e[0],P=0;c>0&&i>0&&(P+i+1>o&&(i=Math.max(1,o-P)),b.push(a.substring(c-=i,c+i)),!((P+=i+1)>o));)i=e[S=(S+1)%e.length];return b.reverse().join(t)}}function oie(e){return function(t){return t.replace(/[0-9]/g,function(a){return e[+a]})}}var sie=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function $0(e){if(!(t=sie.exec(e)))throw new Error("invalid format: "+e);var t;return new jP({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}$0.prototype=jP.prototype;function jP(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}jP.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function lie(e){e:for(var t=e.length,a=1,o=-1,c;a<t;++a)switch(e[a]){case".":o=c=a;break;case"0":o===0&&(o=a),c=a;break;default:if(!+e[a])break e;o>0&&(o=0);break}return o>0?e.slice(0,o)+e.slice(c+1):e}var p8;function uie(e,t){var a=Qb(e,t);if(!a)return e+"";var o=a[0],c=a[1],b=c-(p8=Math.max(-8,Math.min(8,Math.floor(c/3)))*3)+1,S=o.length;return b===S?o:b>S?o+new Array(b-S+1).join("0"):b>0?o.slice(0,b)+"."+o.slice(b):"0."+new Array(1-b).join("0")+Qb(e,Math.max(0,t+b-1))[0]}function D5(e,t){var a=Qb(e,t);if(!a)return e+"";var o=a[0],c=a[1];return c<0?"0."+new Array(-c).join("0")+o:o.length>c+1?o.slice(0,c+1)+"."+o.slice(c+1):o+new Array(c-o.length+2).join("0")}const L5={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:iie,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>D5(e*100,t),r:D5,s:uie,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function z5(e){return e}var N5=Array.prototype.map,B5=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function cie(e){var t=e.grouping===void 0||e.thousands===void 0?z5:aie(N5.call(e.grouping,Number),e.thousands+""),a=e.currency===void 0?"":e.currency[0]+"",o=e.currency===void 0?"":e.currency[1]+"",c=e.decimal===void 0?".":e.decimal+"",b=e.numerals===void 0?z5:oie(N5.call(e.numerals,String)),S=e.percent===void 0?"%":e.percent+"",i=e.minus===void 0?"":e.minus+"",P=e.nan===void 0?"NaN":e.nan+"";function L(V){V=$0(V);var H=V.fill,ee=V.align,ie=V.sign,le=V.symbol,ue=V.zero,ge=V.width,Se=V.comma,ve=V.precision,Ee=V.trim,me=V.type;me==="n"?(Se=!0,me="g"):L5[me]||(ve===void 0&&(ve=12),Ee=!0,me="g"),(ue||H==="0"&&ee==="=")&&(ue=!0,H="0",ee="=");var Ae=le==="$"?a:le==="#"&&/[boxX]/.test(me)?"0"+me.toLowerCase():"",Oe=le==="$"?o:/[%p]/.test(me)?S:"",Ye=L5[me],He=/[defgprs%]/.test(me);ve=ve===void 0?6:/[gprs]/.test(me)?Math.max(1,Math.min(21,ve)):Math.max(0,Math.min(20,ve));function st(Ke){var Ot=Ae,Bt=Oe,Tt,mt,bt;if(me==="c")Bt=Ye(Ke)+Bt,Ke="";else{Ke=+Ke;var Ft=Ke<0||1/Ke<0;if(Ke=isNaN(Ke)?P:Ye(Math.abs(Ke),ve),Ee&&(Ke=lie(Ke)),Ft&&+Ke==0&&ie!=="+"&&(Ft=!1),Ot=(Ft?ie==="("?ie:i:ie==="-"||ie==="("?"":ie)+Ot,Bt=(me==="s"?B5[8+p8/3]:"")+Bt+(Ft&&ie==="("?")":""),He){for(Tt=-1,mt=Ke.length;++Tt<mt;)if(bt=Ke.charCodeAt(Tt),48>bt||bt>57){Bt=(bt===46?c+Ke.slice(Tt+1):Ke.slice(Tt))+Bt,Ke=Ke.slice(0,Tt);break}}}Se&&!ue&&(Ke=t(Ke,1/0));var Zt=Ot.length+Ke.length+Bt.length,Vt=Zt<ge?new Array(ge-Zt+1).join(H):"";switch(Se&&ue&&(Ke=t(Vt+Ke,Vt.length?ge-Bt.length:1/0),Vt=""),ee){case"<":Ke=Ot+Ke+Bt+Vt;break;case"=":Ke=Ot+Vt+Ke+Bt;break;case"^":Ke=Vt.slice(0,Zt=Vt.length>>1)+Ot+Ke+Bt+Vt.slice(Zt);break;default:Ke=Vt+Ot+Ke+Bt;break}return b(Ke)}return st.toString=function(){return V+""},st}function U(V,H){var ee=L((V=$0(V),V.type="f",V)),ie=Math.max(-8,Math.min(8,Math.floor(c_(H)/3)))*3,le=Math.pow(10,-ie),ue=B5[8+ie/3];return function(ge){return ee(le*ge)+ue}}return{format:L,formatPrefix:U}}var J1,UP,m8;hie({thousands:",",grouping:[3],currency:["$",""]});function hie(e){return J1=cie(e),UP=J1.format,m8=J1.formatPrefix,J1}function fie(e){return Math.max(0,-c_(Math.abs(e)))}function die(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(c_(t)/3)))*3-c_(Math.abs(e)))}function pie(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,c_(t)-c_(e))+1}function g8(e,t,a,o){var c=mI(e,t,a),b;switch(o=$0(o??",f"),o.type){case"s":{var S=Math.max(Math.abs(e),Math.abs(t));return o.precision==null&&!isNaN(b=die(c,S))&&(o.precision=b),m8(o,S)}case"":case"e":case"g":case"p":case"r":{o.precision==null&&!isNaN(b=pie(c,Math.max(Math.abs(e),Math.abs(t))))&&(o.precision=b-(o.type==="e"));break}case"f":case"%":{o.precision==null&&!isNaN(b=fie(c))&&(o.precision=b-(o.type==="%")*2);break}}return UP(o)}function fm(e){var t=e.domain;return e.ticks=function(a){var o=t();return dI(o[0],o[o.length-1],a??10)},e.tickFormat=function(a,o){var c=t();return g8(c[0],c[c.length-1],a??10,o)},e.nice=function(a){a==null&&(a=10);var o=t(),c=0,b=o.length-1,S=o[c],i=o[b],P,L,U=10;for(i<S&&(L=S,S=i,i=L,L=c,c=b,b=L);U-- >0;){if(L=pI(S,i,a),L===P)return o[c]=S,o[b]=i,t(o);if(L>0)S=Math.floor(S/L)*L,i=Math.ceil(i/L)*L;else if(L<0)S=Math.ceil(S*L)/L,i=Math.floor(i*L)/L;else break;P=L}return e},e}function ew(){var e=FP();return e.copy=function(){return Cx(e,ew())},Xc.apply(e,arguments),fm(e)}function y8(e){var t;function a(o){return o==null||isNaN(o=+o)?t:o}return a.invert=a,a.domain=a.range=function(o){return arguments.length?(e=Array.from(o,Jb),a):e.slice()},a.unknown=function(o){return arguments.length?(t=o,a):t},a.copy=function(){return y8(e).unknown(t)},e=arguments.length?Array.from(e,Jb):[0,1],fm(a)}function _8(e,t){e=e.slice();var a=0,o=e.length-1,c=e[a],b=e[o],S;return b<c&&(S=a,a=o,o=S,S=c,c=b,b=S),e[a]=t.floor(c),e[o]=t.ceil(b),e}function F5(e){return Math.log(e)}function j5(e){return Math.exp(e)}function mie(e){return-Math.log(-e)}function gie(e){return-Math.exp(-e)}function yie(e){return isFinite(e)?+("1e"+e):e<0?0:e}function _ie(e){return e===10?yie:e===Math.E?Math.exp:t=>Math.pow(e,t)}function vie(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function U5(e){return(t,a)=>-e(-t,a)}function VP(e){const t=e(F5,j5),a=t.domain;let o=10,c,b;function S(){return c=vie(o),b=_ie(o),a()[0]<0?(c=U5(c),b=U5(b),e(mie,gie)):e(F5,j5),t}return t.base=function(i){return arguments.length?(o=+i,S()):o},t.domain=function(i){return arguments.length?(a(i),S()):a()},t.ticks=i=>{const P=a();let L=P[0],U=P[P.length-1];const V=U<L;V&&([L,U]=[U,L]);let H=c(L),ee=c(U),ie,le;const ue=i==null?10:+i;let ge=[];if(!(o%1)&&ee-H<ue){if(H=Math.floor(H),ee=Math.ceil(ee),L>0){for(;H<=ee;++H)for(ie=1;ie<o;++ie)if(le=H<0?ie/b(-H):ie*b(H),!(le<L)){if(le>U)break;ge.push(le)}}else for(;H<=ee;++H)for(ie=o-1;ie>=1;--ie)if(le=H>0?ie/b(-H):ie*b(H),!(le<L)){if(le>U)break;ge.push(le)}ge.length*2<ue&&(ge=dI(L,U,ue))}else ge=dI(H,ee,Math.min(ee-H,ue)).map(b);return V?ge.reverse():ge},t.tickFormat=(i,P)=>{if(i==null&&(i=10),P==null&&(P=o===10?"s":","),typeof P!="function"&&(!(o%1)&&(P=$0(P)).precision==null&&(P.trim=!0),P=UP(P)),i===1/0)return P;const L=Math.max(1,o*i/t.ticks().length);return U=>{let V=U/b(Math.round(c(U)));return V*o<o-.5&&(V*=o),V<=L?P(U):""}},t.nice=()=>a(_8(a(),{floor:i=>b(Math.floor(c(i))),ceil:i=>b(Math.ceil(c(i)))})),t}function v8(){const e=VP(l2()).domain([1,10]);return e.copy=()=>Cx(e,v8()).base(e.base()),Xc.apply(e,arguments),e}function V5(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function q5(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function qP(e){var t=1,a=e(V5(t),q5(t));return a.constant=function(o){return arguments.length?e(V5(t=+o),q5(t)):t},fm(a)}function x8(){var e=qP(l2());return e.copy=function(){return Cx(e,x8()).constant(e.constant())},Xc.apply(e,arguments)}function G5(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function xie(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function bie(e){return e<0?-e*e:e*e}function GP(e){var t=e(Zl,Zl),a=1;function o(){return a===1?e(Zl,Zl):a===.5?e(xie,bie):e(G5(a),G5(1/a))}return t.exponent=function(c){return arguments.length?(a=+c,o()):a},fm(t)}function $P(){var e=GP(l2());return e.copy=function(){return Cx(e,$P()).exponent(e.exponent())},Xc.apply(e,arguments),e}function wie(){return $P.apply(null,arguments).exponent(.5)}function $5(e){return Math.sign(e)*e*e}function Sie(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function b8(){var e=FP(),t=[0,1],a=!1,o;function c(b){var S=Sie(e(b));return isNaN(S)?o:a?Math.round(S):S}return c.invert=function(b){return e.invert($5(b))},c.domain=function(b){return arguments.length?(e.domain(b),c):e.domain()},c.range=function(b){return arguments.length?(e.range((t=Array.from(b,Jb)).map($5)),c):t.slice()},c.rangeRound=function(b){return c.range(b).round(!0)},c.round=function(b){return arguments.length?(a=!!b,c):a},c.clamp=function(b){return arguments.length?(e.clamp(b),c):e.clamp()},c.unknown=function(b){return arguments.length?(o=b,c):o},c.copy=function(){return b8(e.domain(),t).round(a).clamp(e.clamp()).unknown(o)},Xc.apply(c,arguments),fm(c)}function w8(){var e=[],t=[],a=[],o;function c(){var S=0,i=Math.max(1,t.length);for(a=new Array(i-1);++S<i;)a[S-1]=Ore(e,S/i);return b}function b(S){return S==null||isNaN(S=+S)?o:t[Ox(a,S)]}return b.invertExtent=function(S){var i=t.indexOf(S);return i<0?[NaN,NaN]:[i>0?a[i-1]:e[0],i<a.length?a[i]:e[e.length-1]]},b.domain=function(S){if(!arguments.length)return e.slice();e=[];for(let i of S)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(nm),c()},b.range=function(S){return arguments.length?(t=Array.from(S),c()):t.slice()},b.unknown=function(S){return arguments.length?(o=S,b):o},b.quantiles=function(){return a.slice()},b.copy=function(){return w8().domain(e).range(t).unknown(o)},Xc.apply(b,arguments)}function S8(){var e=0,t=1,a=1,o=[.5],c=[0,1],b;function S(P){return P!=null&&P<=P?c[Ox(o,P,0,a)]:b}function i(){var P=-1;for(o=new Array(a);++P<a;)o[P]=((P+1)*t-(P-a)*e)/(a+1);return S}return S.domain=function(P){return arguments.length?([e,t]=P,e=+e,t=+t,i()):[e,t]},S.range=function(P){return arguments.length?(a=(c=Array.from(P)).length-1,i()):c.slice()},S.invertExtent=function(P){var L=c.indexOf(P);return L<0?[NaN,NaN]:L<1?[e,o[0]]:L>=a?[o[a-1],t]:[o[L-1],o[L]]},S.unknown=function(P){return arguments.length&&(b=P),S},S.thresholds=function(){return o.slice()},S.copy=function(){return S8().domain([e,t]).range(c).unknown(b)},Xc.apply(fm(S),arguments)}function T8(){var e=[.5],t=[0,1],a,o=1;function c(b){return b!=null&&b<=b?t[Ox(e,b,0,o)]:a}return c.domain=function(b){return arguments.length?(e=Array.from(b),o=Math.min(e.length,t.length-1),c):e.slice()},c.range=function(b){return arguments.length?(t=Array.from(b),o=Math.min(e.length,t.length-1),c):t.slice()},c.invertExtent=function(b){var S=t.indexOf(b);return[e[S-1],e[S]]},c.unknown=function(b){return arguments.length?(a=b,c):a},c.copy=function(){return T8().domain(e).range(t).unknown(a)},Xc.apply(c,arguments)}const wM=new Date,SM=new Date;function ss(e,t,a,o){function c(b){return e(b=arguments.length===0?new Date:new Date(+b)),b}return c.floor=b=>(e(b=new Date(+b)),b),c.ceil=b=>(e(b=new Date(b-1)),t(b,1),e(b),b),c.round=b=>{const S=c(b),i=c.ceil(b);return b-S<i-b?S:i},c.offset=(b,S)=>(t(b=new Date(+b),S==null?1:Math.floor(S)),b),c.range=(b,S,i)=>{const P=[];if(b=c.ceil(b),i=i==null?1:Math.floor(i),!(b<S)||!(i>0))return P;let L;do P.push(L=new Date(+b)),t(b,i),e(b);while(L<b&&b<S);return P},c.filter=b=>ss(S=>{if(S>=S)for(;e(S),!b(S);)S.setTime(S-1)},(S,i)=>{if(S>=S)if(i<0)for(;++i<=0;)for(;t(S,-1),!b(S););else for(;--i>=0;)for(;t(S,1),!b(S););}),a&&(c.count=(b,S)=>(wM.setTime(+b),SM.setTime(+S),e(wM),e(SM),Math.floor(a(wM,SM))),c.every=b=>(b=Math.floor(b),!isFinite(b)||!(b>0)?null:b>1?c.filter(o?S=>o(S)%b===0:S=>c.count(0,S)%b===0):c)),c}const tw=ss(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);tw.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ss(t=>{t.setTime(Math.floor(t/e)*e)},(t,a)=>{t.setTime(+t+a*e)},(t,a)=>(a-t)/e):tw);tw.range;const Nd=1e3,Gc=Nd*60,Bd=Gc*60,Yd=Bd*24,HP=Yd*7,H5=Yd*30,TM=Yd*365,mg=ss(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Nd)},(e,t)=>(t-e)/Nd,e=>e.getUTCSeconds());mg.range;const XP=ss(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Nd)},(e,t)=>{e.setTime(+e+t*Gc)},(e,t)=>(t-e)/Gc,e=>e.getMinutes());XP.range;const YP=ss(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Gc)},(e,t)=>(t-e)/Gc,e=>e.getUTCMinutes());YP.range;const ZP=ss(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Nd-e.getMinutes()*Gc)},(e,t)=>{e.setTime(+e+t*Bd)},(e,t)=>(t-e)/Bd,e=>e.getHours());ZP.range;const WP=ss(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Bd)},(e,t)=>(t-e)/Bd,e=>e.getUTCHours());WP.range;const Px=ss(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Gc)/Yd,e=>e.getDate()-1);Px.range;const u2=ss(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Yd,e=>e.getUTCDate()-1);u2.range;const E8=ss(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Yd,e=>Math.floor(e/Yd));E8.range;function Cg(e){return ss(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,a)=>{t.setDate(t.getDate()+a*7)},(t,a)=>(a-t-(a.getTimezoneOffset()-t.getTimezoneOffset())*Gc)/HP)}const c2=Cg(0),nw=Cg(1),Tie=Cg(2),Eie=Cg(3),h_=Cg(4),Aie=Cg(5),Mie=Cg(6);c2.range;nw.range;Tie.range;Eie.range;h_.range;Aie.range;Mie.range;function Pg(e){return ss(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,a)=>{t.setUTCDate(t.getUTCDate()+a*7)},(t,a)=>(a-t)/HP)}const h2=Pg(0),rw=Pg(1),Oie=Pg(2),Iie=Pg(3),f_=Pg(4),Cie=Pg(5),Pie=Pg(6);h2.range;rw.range;Oie.range;Iie.range;f_.range;Cie.range;Pie.range;const KP=ss(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());KP.range;const JP=ss(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());JP.range;const Zd=ss(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Zd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ss(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,a)=>{t.setFullYear(t.getFullYear()+a*e)});Zd.range;const Wd=ss(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Wd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ss(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,a)=>{t.setUTCFullYear(t.getUTCFullYear()+a*e)});Wd.range;function A8(e,t,a,o,c,b){const S=[[mg,1,Nd],[mg,5,5*Nd],[mg,15,15*Nd],[mg,30,30*Nd],[b,1,Gc],[b,5,5*Gc],[b,15,15*Gc],[b,30,30*Gc],[c,1,Bd],[c,3,3*Bd],[c,6,6*Bd],[c,12,12*Bd],[o,1,Yd],[o,2,2*Yd],[a,1,HP],[t,1,H5],[t,3,3*H5],[e,1,TM]];function i(L,U,V){const H=U<L;H&&([L,U]=[U,L]);const ee=V&&typeof V.range=="function"?V:P(L,U,V),ie=ee?ee.range(L,+U+1):[];return H?ie.reverse():ie}function P(L,U,V){const H=Math.abs(U-L)/V,ee=DP(([,,ue])=>ue).right(S,H);if(ee===S.length)return e.every(mI(L/TM,U/TM,V));if(ee===0)return tw.every(Math.max(mI(L,U,V),1));const[ie,le]=S[H/S[ee-1][2]<S[ee][2]/H?ee-1:ee];return ie.every(le)}return[i,P]}const[Rie,kie]=A8(Wd,JP,h2,E8,WP,YP),[Die,Lie]=A8(Zd,KP,c2,Px,ZP,XP);function EM(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function AM(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Kv(e,t,a){return{y:e,m:t,d:a,H:0,M:0,S:0,L:0}}function zie(e){var t=e.dateTime,a=e.date,o=e.time,c=e.periods,b=e.days,S=e.shortDays,i=e.months,P=e.shortMonths,L=Jv(c),U=Qv(c),V=Jv(b),H=Qv(b),ee=Jv(S),ie=Qv(S),le=Jv(i),ue=Qv(i),ge=Jv(P),Se=Qv(P),ve={a:Ft,A:Zt,b:Vt,B:Ze,c:null,d:J5,e:J5,f:aae,g:mae,G:yae,H:nae,I:rae,j:iae,L:M8,m:oae,M:sae,p:Xt,q:an,Q:tB,s:nB,S:lae,u:uae,U:cae,V:hae,w:fae,W:dae,x:null,X:null,y:pae,Y:gae,Z:_ae,"%":eB},Ee={a:qt,A:cn,b:rr,B:mr,c:null,d:Q5,e:Q5,f:wae,g:Rae,G:Dae,H:vae,I:xae,j:bae,L:I8,m:Sae,M:Tae,p:Ci,q:Et,Q:tB,s:nB,S:Eae,u:Aae,U:Mae,V:Oae,w:Iae,W:Cae,x:null,X:null,y:Pae,Y:kae,Z:Lae,"%":eB},me={a:st,A:Ke,b:Ot,B:Bt,c:Tt,d:W5,e:W5,f:Jie,g:Z5,G:Y5,H:K5,I:K5,j:Yie,L:Kie,m:Xie,M:Zie,p:He,q:Hie,Q:eae,s:tae,S:Wie,u:Uie,U:Vie,V:qie,w:jie,W:Gie,x:mt,X:bt,y:Z5,Y:Y5,Z:$ie,"%":Qie};ve.x=Ae(a,ve),ve.X=Ae(o,ve),ve.c=Ae(t,ve),Ee.x=Ae(a,Ee),Ee.X=Ae(o,Ee),Ee.c=Ae(t,Ee);function Ae(Ln,Ne){return function(An){var qe=[],jr=-1,$t=0,Ur=Ln.length,Wr,Qi,hr;for(An instanceof Date||(An=new Date(+An));++jr<Ur;)Ln.charCodeAt(jr)===37&&(qe.push(Ln.slice($t,jr)),(Qi=X5[Wr=Ln.charAt(++jr)])!=null?Wr=Ln.charAt(++jr):Qi=Wr==="e"?" ":"0",(hr=Ne[Wr])&&(Wr=hr(An,Qi)),qe.push(Wr),$t=jr+1);return qe.push(Ln.slice($t,jr)),qe.join("")}}function Oe(Ln,Ne){return function(An){var qe=Kv(1900,void 0,1),jr=Ye(qe,Ln,An+="",0),$t,Ur;if(jr!=An.length)return null;if("Q"in qe)return new Date(qe.Q);if("s"in qe)return new Date(qe.s*1e3+("L"in qe?qe.L:0));if(Ne&&!("Z"in qe)&&(qe.Z=0),"p"in qe&&(qe.H=qe.H%12+qe.p*12),qe.m===void 0&&(qe.m="q"in qe?qe.q:0),"V"in qe){if(qe.V<1||qe.V>53)return null;"w"in qe||(qe.w=1),"Z"in qe?($t=AM(Kv(qe.y,0,1)),Ur=$t.getUTCDay(),$t=Ur>4||Ur===0?rw.ceil($t):rw($t),$t=u2.offset($t,(qe.V-1)*7),qe.y=$t.getUTCFullYear(),qe.m=$t.getUTCMonth(),qe.d=$t.getUTCDate()+(qe.w+6)%7):($t=EM(Kv(qe.y,0,1)),Ur=$t.getDay(),$t=Ur>4||Ur===0?nw.ceil($t):nw($t),$t=Px.offset($t,(qe.V-1)*7),qe.y=$t.getFullYear(),qe.m=$t.getMonth(),qe.d=$t.getDate()+(qe.w+6)%7)}else("W"in qe||"U"in qe)&&("w"in qe||(qe.w="u"in qe?qe.u%7:"W"in qe?1:0),Ur="Z"in qe?AM(Kv(qe.y,0,1)).getUTCDay():EM(Kv(qe.y,0,1)).getDay(),qe.m=0,qe.d="W"in qe?(qe.w+6)%7+qe.W*7-(Ur+5)%7:qe.w+qe.U*7-(Ur+6)%7);return"Z"in qe?(qe.H+=qe.Z/100|0,qe.M+=qe.Z%100,AM(qe)):EM(qe)}}function Ye(Ln,Ne,An,qe){for(var jr=0,$t=Ne.length,Ur=An.length,Wr,Qi;jr<$t;){if(qe>=Ur)return-1;if(Wr=Ne.charCodeAt(jr++),Wr===37){if(Wr=Ne.charAt(jr++),Qi=me[Wr in X5?Ne.charAt(jr++):Wr],!Qi||(qe=Qi(Ln,An,qe))<0)return-1}else if(Wr!=An.charCodeAt(qe++))return-1}return qe}function He(Ln,Ne,An){var qe=L.exec(Ne.slice(An));return qe?(Ln.p=U.get(qe[0].toLowerCase()),An+qe[0].length):-1}function st(Ln,Ne,An){var qe=ee.exec(Ne.slice(An));return qe?(Ln.w=ie.get(qe[0].toLowerCase()),An+qe[0].length):-1}function Ke(Ln,Ne,An){var qe=V.exec(Ne.slice(An));return qe?(Ln.w=H.get(qe[0].toLowerCase()),An+qe[0].length):-1}function Ot(Ln,Ne,An){var qe=ge.exec(Ne.slice(An));return qe?(Ln.m=Se.get(qe[0].toLowerCase()),An+qe[0].length):-1}function Bt(Ln,Ne,An){var qe=le.exec(Ne.slice(An));return qe?(Ln.m=ue.get(qe[0].toLowerCase()),An+qe[0].length):-1}function Tt(Ln,Ne,An){return Ye(Ln,t,Ne,An)}function mt(Ln,Ne,An){return Ye(Ln,a,Ne,An)}function bt(Ln,Ne,An){return Ye(Ln,o,Ne,An)}function Ft(Ln){return S[Ln.getDay()]}function Zt(Ln){return b[Ln.getDay()]}function Vt(Ln){return P[Ln.getMonth()]}function Ze(Ln){return i[Ln.getMonth()]}function Xt(Ln){return c[+(Ln.getHours()>=12)]}function an(Ln){return 1+~~(Ln.getMonth()/3)}function qt(Ln){return S[Ln.getUTCDay()]}function cn(Ln){return b[Ln.getUTCDay()]}function rr(Ln){return P[Ln.getUTCMonth()]}function mr(Ln){return i[Ln.getUTCMonth()]}function Ci(Ln){return c[+(Ln.getUTCHours()>=12)]}function Et(Ln){return 1+~~(Ln.getUTCMonth()/3)}return{format:function(Ln){var Ne=Ae(Ln+="",ve);return Ne.toString=function(){return Ln},Ne},parse:function(Ln){var Ne=Oe(Ln+="",!1);return Ne.toString=function(){return Ln},Ne},utcFormat:function(Ln){var Ne=Ae(Ln+="",Ee);return Ne.toString=function(){return Ln},Ne},utcParse:function(Ln){var Ne=Oe(Ln+="",!0);return Ne.toString=function(){return Ln},Ne}}}var X5={"-":"",_:" ",0:"0"},Rs=/^\s*\d+/,Nie=/^%/,Bie=/[\\^$*+?|[\]().{}]/g;function Ji(e,t,a){var o=e<0?"-":"",c=(o?-e:e)+"",b=c.length;return o+(b<a?new Array(a-b+1).join(t)+c:c)}function Fie(e){return e.replace(Bie,"\\$&")}function Jv(e){return new RegExp("^(?:"+e.map(Fie).join("|")+")","i")}function Qv(e){return new Map(e.map((t,a)=>[t.toLowerCase(),a]))}function jie(e,t,a){var o=Rs.exec(t.slice(a,a+1));return o?(e.w=+o[0],a+o[0].length):-1}function Uie(e,t,a){var o=Rs.exec(t.slice(a,a+1));return o?(e.u=+o[0],a+o[0].length):-1}function Vie(e,t,a){var o=Rs.exec(t.slice(a,a+2));return o?(e.U=+o[0],a+o[0].length):-1}function qie(e,t,a){var o=Rs.exec(t.slice(a,a+2));return o?(e.V=+o[0],a+o[0].length):-1}function Gie(e,t,a){var o=Rs.exec(t.slice(a,a+2));return o?(e.W=+o[0],a+o[0].length):-1}function Y5(e,t,a){var o=Rs.exec(t.slice(a,a+4));return o?(e.y=+o[0],a+o[0].length):-1}function Z5(e,t,a){var o=Rs.exec(t.slice(a,a+2));return o?(e.y=+o[0]+(+o[0]>68?1900:2e3),a+o[0].length):-1}function $ie(e,t,a){var o=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(a,a+6));return o?(e.Z=o[1]?0:-(o[2]+(o[3]||"00")),a+o[0].length):-1}function Hie(e,t,a){var o=Rs.exec(t.slice(a,a+1));return o?(e.q=o[0]*3-3,a+o[0].length):-1}function Xie(e,t,a){var o=Rs.exec(t.slice(a,a+2));return o?(e.m=o[0]-1,a+o[0].length):-1}function W5(e,t,a){var o=Rs.exec(t.slice(a,a+2));return o?(e.d=+o[0],a+o[0].length):-1}function Yie(e,t,a){var o=Rs.exec(t.slice(a,a+3));return o?(e.m=0,e.d=+o[0],a+o[0].length):-1}function K5(e,t,a){var o=Rs.exec(t.slice(a,a+2));return o?(e.H=+o[0],a+o[0].length):-1}function Zie(e,t,a){var o=Rs.exec(t.slice(a,a+2));return o?(e.M=+o[0],a+o[0].length):-1}function Wie(e,t,a){var o=Rs.exec(t.slice(a,a+2));return o?(e.S=+o[0],a+o[0].length):-1}function Kie(e,t,a){var o=Rs.exec(t.slice(a,a+3));return o?(e.L=+o[0],a+o[0].length):-1}function Jie(e,t,a){var o=Rs.exec(t.slice(a,a+6));return o?(e.L=Math.floor(o[0]/1e3),a+o[0].length):-1}function Qie(e,t,a){var o=Nie.exec(t.slice(a,a+1));return o?a+o[0].length:-1}function eae(e,t,a){var o=Rs.exec(t.slice(a));return o?(e.Q=+o[0],a+o[0].length):-1}function tae(e,t,a){var o=Rs.exec(t.slice(a));return o?(e.s=+o[0],a+o[0].length):-1}function J5(e,t){return Ji(e.getDate(),t,2)}function nae(e,t){return Ji(e.getHours(),t,2)}function rae(e,t){return Ji(e.getHours()%12||12,t,2)}function iae(e,t){return Ji(1+Px.count(Zd(e),e),t,3)}function M8(e,t){return Ji(e.getMilliseconds(),t,3)}function aae(e,t){return M8(e,t)+"000"}function oae(e,t){return Ji(e.getMonth()+1,t,2)}function sae(e,t){return Ji(e.getMinutes(),t,2)}function lae(e,t){return Ji(e.getSeconds(),t,2)}function uae(e){var t=e.getDay();return t===0?7:t}function cae(e,t){return Ji(c2.count(Zd(e)-1,e),t,2)}function O8(e){var t=e.getDay();return t>=4||t===0?h_(e):h_.ceil(e)}function hae(e,t){return e=O8(e),Ji(h_.count(Zd(e),e)+(Zd(e).getDay()===4),t,2)}function fae(e){return e.getDay()}function dae(e,t){return Ji(nw.count(Zd(e)-1,e),t,2)}function pae(e,t){return Ji(e.getFullYear()%100,t,2)}function mae(e,t){return e=O8(e),Ji(e.getFullYear()%100,t,2)}function gae(e,t){return Ji(e.getFullYear()%1e4,t,4)}function yae(e,t){var a=e.getDay();return e=a>=4||a===0?h_(e):h_.ceil(e),Ji(e.getFullYear()%1e4,t,4)}function _ae(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ji(t/60|0,"0",2)+Ji(t%60,"0",2)}function Q5(e,t){return Ji(e.getUTCDate(),t,2)}function vae(e,t){return Ji(e.getUTCHours(),t,2)}function xae(e,t){return Ji(e.getUTCHours()%12||12,t,2)}function bae(e,t){return Ji(1+u2.count(Wd(e),e),t,3)}function I8(e,t){return Ji(e.getUTCMilliseconds(),t,3)}function wae(e,t){return I8(e,t)+"000"}function Sae(e,t){return Ji(e.getUTCMonth()+1,t,2)}function Tae(e,t){return Ji(e.getUTCMinutes(),t,2)}function Eae(e,t){return Ji(e.getUTCSeconds(),t,2)}function Aae(e){var t=e.getUTCDay();return t===0?7:t}function Mae(e,t){return Ji(h2.count(Wd(e)-1,e),t,2)}function C8(e){var t=e.getUTCDay();return t>=4||t===0?f_(e):f_.ceil(e)}function Oae(e,t){return e=C8(e),Ji(f_.count(Wd(e),e)+(Wd(e).getUTCDay()===4),t,2)}function Iae(e){return e.getUTCDay()}function Cae(e,t){return Ji(rw.count(Wd(e)-1,e),t,2)}function Pae(e,t){return Ji(e.getUTCFullYear()%100,t,2)}function Rae(e,t){return e=C8(e),Ji(e.getUTCFullYear()%100,t,2)}function kae(e,t){return Ji(e.getUTCFullYear()%1e4,t,4)}function Dae(e,t){var a=e.getUTCDay();return e=a>=4||a===0?f_(e):f_.ceil(e),Ji(e.getUTCFullYear()%1e4,t,4)}function Lae(){return"+0000"}function eB(){return"%"}function tB(e){return+e}function nB(e){return Math.floor(+e/1e3)}var Ly,P8,R8;zae({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function zae(e){return Ly=zie(e),P8=Ly.format,Ly.parse,R8=Ly.utcFormat,Ly.utcParse,Ly}function Nae(e){return new Date(e)}function Bae(e){return e instanceof Date?+e:+new Date(+e)}function QP(e,t,a,o,c,b,S,i,P,L){var U=FP(),V=U.invert,H=U.domain,ee=L(".%L"),ie=L(":%S"),le=L("%I:%M"),ue=L("%I %p"),ge=L("%a %d"),Se=L("%b %d"),ve=L("%B"),Ee=L("%Y");function me(Ae){return(P(Ae)<Ae?ee:i(Ae)<Ae?ie:S(Ae)<Ae?le:b(Ae)<Ae?ue:o(Ae)<Ae?c(Ae)<Ae?ge:Se:a(Ae)<Ae?ve:Ee)(Ae)}return U.invert=function(Ae){return new Date(V(Ae))},U.domain=function(Ae){return arguments.length?H(Array.from(Ae,Bae)):H().map(Nae)},U.ticks=function(Ae){var Oe=H();return e(Oe[0],Oe[Oe.length-1],Ae??10)},U.tickFormat=function(Ae,Oe){return Oe==null?me:L(Oe)},U.nice=function(Ae){var Oe=H();return(!Ae||typeof Ae.range!="function")&&(Ae=t(Oe[0],Oe[Oe.length-1],Ae??10)),Ae?H(_8(Oe,Ae)):U},U.copy=function(){return Cx(U,QP(e,t,a,o,c,b,S,i,P,L))},U}function Fae(){return Xc.apply(QP(Die,Lie,Zd,KP,c2,Px,ZP,XP,mg,P8).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function jae(){return Xc.apply(QP(Rie,kie,Wd,JP,h2,u2,WP,YP,mg,R8).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function f2(){var e=0,t=1,a,o,c,b,S=Zl,i=!1,P;function L(V){return V==null||isNaN(V=+V)?P:S(c===0?.5:(V=(b(V)-a)*c,i?Math.max(0,Math.min(1,V)):V))}L.domain=function(V){return arguments.length?([e,t]=V,a=b(e=+e),o=b(t=+t),c=a===o?0:1/(o-a),L):[e,t]},L.clamp=function(V){return arguments.length?(i=!!V,L):i},L.interpolator=function(V){return arguments.length?(S=V,L):S};function U(V){return function(H){var ee,ie;return arguments.length?([ee,ie]=H,S=V(ee,ie),L):[S(0),S(1)]}}return L.range=U(F_),L.rangeRound=U(BP),L.unknown=function(V){return arguments.length?(P=V,L):P},function(V){return b=V,a=V(e),o=V(t),c=a===o?0:1/(o-a),L}}function dm(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function k8(){var e=fm(f2()(Zl));return e.copy=function(){return dm(e,k8())},tp.apply(e,arguments)}function D8(){var e=VP(f2()).domain([1,10]);return e.copy=function(){return dm(e,D8()).base(e.base())},tp.apply(e,arguments)}function L8(){var e=qP(f2());return e.copy=function(){return dm(e,L8()).constant(e.constant())},tp.apply(e,arguments)}function eR(){var e=GP(f2());return e.copy=function(){return dm(e,eR()).exponent(e.exponent())},tp.apply(e,arguments)}function Uae(){return eR.apply(null,arguments).exponent(.5)}function z8(){var e=[],t=Zl;function a(o){if(o!=null&&!isNaN(o=+o))return t((Ox(e,o,1)-1)/(e.length-1))}return a.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let c of o)c!=null&&!isNaN(c=+c)&&e.push(c);return e.sort(nm),a},a.interpolator=function(o){return arguments.length?(t=o,a):t},a.range=function(){return e.map((o,c)=>t(c/(e.length-1)))},a.quantiles=function(o){return Array.from({length:o+1},(c,b)=>Mre(e,b/o))},a.copy=function(){return z8(t).domain(e)},tp.apply(a,arguments)}function d2(){var e=0,t=.5,a=1,o=1,c,b,S,i,P,L=Zl,U,V=!1,H;function ee(le){return isNaN(le=+le)?H:(le=.5+((le=+U(le))-b)*(o*le<o*b?i:P),L(V?Math.max(0,Math.min(1,le)):le))}ee.domain=function(le){return arguments.length?([e,t,a]=le,c=U(e=+e),b=U(t=+t),S=U(a=+a),i=c===b?0:.5/(b-c),P=b===S?0:.5/(S-b),o=b<c?-1:1,ee):[e,t,a]},ee.clamp=function(le){return arguments.length?(V=!!le,ee):V},ee.interpolator=function(le){return arguments.length?(L=le,ee):L};function ie(le){return function(ue){var ge,Se,ve;return arguments.length?([ge,Se,ve]=ue,L=Qre(le,[ge,Se,ve]),ee):[L(0),L(.5),L(1)]}}return ee.range=ie(F_),ee.rangeRound=ie(BP),ee.unknown=function(le){return arguments.length?(H=le,ee):H},function(le){return U=le,c=le(e),b=le(t),S=le(a),i=c===b?0:.5/(b-c),P=b===S?0:.5/(S-b),o=b<c?-1:1,ee}}function N8(){var e=fm(d2()(Zl));return e.copy=function(){return dm(e,N8())},tp.apply(e,arguments)}function B8(){var e=VP(d2()).domain([.1,1,10]);return e.copy=function(){return dm(e,B8()).base(e.base())},tp.apply(e,arguments)}function F8(){var e=qP(d2());return e.copy=function(){return dm(e,F8()).constant(e.constant())},tp.apply(e,arguments)}function tR(){var e=GP(d2());return e.copy=function(){return dm(e,tR()).exponent(e.exponent())},tp.apply(e,arguments)}function Vae(){return tR.apply(null,arguments).exponent(.5)}const rB=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:U0,scaleDiverging:N8,scaleDivergingLog:B8,scaleDivergingPow:tR,scaleDivergingSqrt:Vae,scaleDivergingSymlog:F8,scaleIdentity:y8,scaleImplicit:gI,scaleLinear:ew,scaleLog:v8,scaleOrdinal:LP,scalePoint:x0,scalePow:$P,scaleQuantile:w8,scaleQuantize:S8,scaleRadial:b8,scaleSequential:k8,scaleSequentialLog:D8,scaleSequentialPow:eR,scaleSequentialQuantile:z8,scaleSequentialSqrt:Uae,scaleSequentialSymlog:L8,scaleSqrt:wie,scaleSymlog:x8,scaleThreshold:T8,scaleTime:Fae,scaleUtc:jae,tickFormat:g8},Symbol.toStringTag,{value:"Module"}));var MM,iB;function j8(){if(iB)return MM;iB=1;var e=L_();function t(a,o,c){for(var b=-1,S=a.length;++b<S;){var i=a[b],P=o(i);if(P!=null&&(L===void 0?P===P&&!e(P):c(P,L)))var L=P,U=i}return U}return MM=t,MM}var OM,aB;function qae(){if(aB)return OM;aB=1;function e(t,a){return t>a}return OM=e,OM}var IM,oB;function Gae(){if(oB)return IM;oB=1;var e=j8(),t=qae(),a=N_();function o(c){return c&&c.length?e(c,a,t):void 0}return IM=o,IM}var $ae=Gae();const p2=fa($ae);var CM,sB;function Hae(){if(sB)return CM;sB=1;function e(t,a){return t<a}return CM=e,CM}var PM,lB;function Xae(){if(lB)return PM;lB=1;var e=j8(),t=Hae(),a=N_();function o(c){return c&&c.length?e(c,a,t):void 0}return PM=o,PM}var Yae=Xae();const m2=fa(Yae);var RM,uB;function Zae(){if(uB)return RM;uB=1;var e=yP(),t=hm(),a=YV(),o=Su();function c(b,S){var i=o(b)?e:a;return i(b,t(S,3))}return RM=c,RM}var kM,cB;function Wae(){if(cB)return kM;cB=1;var e=HV(),t=Zae();function a(o,c){return e(t(o,c),1)}return kM=a,kM}var Kae=Wae();const Jae=fa(Kae);var DM,hB;function Qae(){if(hB)return DM;hB=1;var e=IP();function t(a,o){return e(a,o)}return DM=t,DM}var eoe=Qae();const g2=fa(eoe);var j_=1e9,toe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},rR,to=!0,Hc="[DecimalError] ",vg=Hc+"Invalid argument: ",nR=Hc+"Exponent out of range: ",U_=Math.floor,ug=Math.pow,noe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ku,Is=1e7,qa=7,U8=9007199254740991,iw=U_(U8/qa),pr={};pr.absoluteValue=pr.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};pr.comparedTo=pr.cmp=function(e){var t,a,o,c,b=this;if(e=new b.constructor(e),b.s!==e.s)return b.s||-e.s;if(b.e!==e.e)return b.e>e.e^b.s<0?1:-1;for(o=b.d.length,c=e.d.length,t=0,a=o<c?o:c;t<a;++t)if(b.d[t]!==e.d[t])return b.d[t]>e.d[t]^b.s<0?1:-1;return o===c?0:o>c^b.s<0?1:-1};pr.decimalPlaces=pr.dp=function(){var e=this,t=e.d.length-1,a=(t-e.e)*qa;if(t=e.d[t],t)for(;t%10==0;t/=10)a--;return a<0?0:a};pr.dividedBy=pr.div=function(e){return Gd(this,new this.constructor(e))};pr.dividedToIntegerBy=pr.idiv=function(e){var t=this,a=t.constructor;return ba(Gd(t,new a(e),0,1),a.precision)};pr.equals=pr.eq=function(e){return!this.cmp(e)};pr.exponent=function(){return Yo(this)};pr.greaterThan=pr.gt=function(e){return this.cmp(e)>0};pr.greaterThanOrEqualTo=pr.gte=function(e){return this.cmp(e)>=0};pr.isInteger=pr.isint=function(){return this.e>this.d.length-2};pr.isNegative=pr.isneg=function(){return this.s<0};pr.isPositive=pr.ispos=function(){return this.s>0};pr.isZero=function(){return this.s===0};pr.lessThan=pr.lt=function(e){return this.cmp(e)<0};pr.lessThanOrEqualTo=pr.lte=function(e){return this.cmp(e)<1};pr.logarithm=pr.log=function(e){var t,a=this,o=a.constructor,c=o.precision,b=c+5;if(e===void 0)e=new o(10);else if(e=new o(e),e.s<1||e.eq(Ku))throw Error(Hc+"NaN");if(a.s<1)throw Error(Hc+(a.s?"NaN":"-Infinity"));return a.eq(Ku)?new o(0):(to=!1,t=Gd(H0(a,b),H0(e,b),b),to=!0,ba(t,c))};pr.minus=pr.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?G8(t,e):V8(t,(e.s=-e.s,e))};pr.modulo=pr.mod=function(e){var t,a=this,o=a.constructor,c=o.precision;if(e=new o(e),!e.s)throw Error(Hc+"NaN");return a.s?(to=!1,t=Gd(a,e,0,1).times(e),to=!0,a.minus(t)):ba(new o(a),c)};pr.naturalExponential=pr.exp=function(){return q8(this)};pr.naturalLogarithm=pr.ln=function(){return H0(this)};pr.negated=pr.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};pr.plus=pr.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?V8(t,e):G8(t,(e.s=-e.s,e))};pr.precision=pr.sd=function(e){var t,a,o,c=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(vg+e);if(t=Yo(c)+1,o=c.d.length-1,a=o*qa+1,o=c.d[o],o){for(;o%10==0;o/=10)a--;for(o=c.d[0];o>=10;o/=10)a++}return e&&t>a?t:a};pr.squareRoot=pr.sqrt=function(){var e,t,a,o,c,b,S,i=this,P=i.constructor;if(i.s<1){if(!i.s)return new P(0);throw Error(Hc+"NaN")}for(e=Yo(i),to=!1,c=Math.sqrt(+i),c==0||c==1/0?(t=Df(i.d),(t.length+e)%2==0&&(t+="0"),c=Math.sqrt(t),e=U_((e+1)/2)-(e<0||e%2),c==1/0?t="5e"+e:(t=c.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),o=new P(t)):o=new P(c.toString()),a=P.precision,c=S=a+3;;)if(b=o,o=b.plus(Gd(i,b,S+2)).times(.5),Df(b.d).slice(0,S)===(t=Df(o.d)).slice(0,S)){if(t=t.slice(S-3,S+1),c==S&&t=="4999"){if(ba(b,a+1,0),b.times(b).eq(i)){o=b;break}}else if(t!="9999")break;S+=4}return to=!0,ba(o,a)};pr.times=pr.mul=function(e){var t,a,o,c,b,S,i,P,L,U=this,V=U.constructor,H=U.d,ee=(e=new V(e)).d;if(!U.s||!e.s)return new V(0);for(e.s*=U.s,a=U.e+e.e,P=H.length,L=ee.length,P<L&&(b=H,H=ee,ee=b,S=P,P=L,L=S),b=[],S=P+L,o=S;o--;)b.push(0);for(o=L;--o>=0;){for(t=0,c=P+o;c>o;)i=b[c]+ee[o]*H[c-o-1]+t,b[c--]=i%Is|0,t=i/Is|0;b[c]=(b[c]+t)%Is|0}for(;!b[--S];)b.pop();return t?++a:b.shift(),e.d=b,e.e=a,to?ba(e,V.precision):e};pr.toDecimalPlaces=pr.todp=function(e,t){var a=this,o=a.constructor;return a=new o(a),e===void 0?a:(Uf(e,0,j_),t===void 0?t=o.rounding:Uf(t,0,8),ba(a,e+Yo(a)+1,t))};pr.toExponential=function(e,t){var a,o=this,c=o.constructor;return e===void 0?a=Tg(o,!0):(Uf(e,0,j_),t===void 0?t=c.rounding:Uf(t,0,8),o=ba(new c(o),e+1,t),a=Tg(o,!0,e+1)),a};pr.toFixed=function(e,t){var a,o,c=this,b=c.constructor;return e===void 0?Tg(c):(Uf(e,0,j_),t===void 0?t=b.rounding:Uf(t,0,8),o=ba(new b(c),e+Yo(c)+1,t),a=Tg(o.abs(),!1,e+Yo(o)+1),c.isneg()&&!c.isZero()?"-"+a:a)};pr.toInteger=pr.toint=function(){var e=this,t=e.constructor;return ba(new t(e),Yo(e)+1,t.rounding)};pr.toNumber=function(){return+this};pr.toPower=pr.pow=function(e){var t,a,o,c,b,S,i=this,P=i.constructor,L=12,U=+(e=new P(e));if(!e.s)return new P(Ku);if(i=new P(i),!i.s){if(e.s<1)throw Error(Hc+"Infinity");return i}if(i.eq(Ku))return i;if(o=P.precision,e.eq(Ku))return ba(i,o);if(t=e.e,a=e.d.length-1,S=t>=a,b=i.s,S){if((a=U<0?-U:U)<=U8){for(c=new P(Ku),t=Math.ceil(o/qa+4),to=!1;a%2&&(c=c.times(i),dB(c.d,t)),a=U_(a/2),a!==0;)i=i.times(i),dB(i.d,t);return to=!0,e.s<0?new P(Ku).div(c):ba(c,o)}}else if(b<0)throw Error(Hc+"NaN");return b=b<0&&e.d[Math.max(t,a)]&1?-1:1,i.s=1,to=!1,c=e.times(H0(i,o+L)),to=!0,c=q8(c),c.s=b,c};pr.toPrecision=function(e,t){var a,o,c=this,b=c.constructor;return e===void 0?(a=Yo(c),o=Tg(c,a<=b.toExpNeg||a>=b.toExpPos)):(Uf(e,1,j_),t===void 0?t=b.rounding:Uf(t,0,8),c=ba(new b(c),e,t),a=Yo(c),o=Tg(c,e<=a||a<=b.toExpNeg,e)),o};pr.toSignificantDigits=pr.tosd=function(e,t){var a=this,o=a.constructor;return e===void 0?(e=o.precision,t=o.rounding):(Uf(e,1,j_),t===void 0?t=o.rounding:Uf(t,0,8)),ba(new o(a),e,t)};pr.toString=pr.valueOf=pr.val=pr.toJSON=pr[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Yo(e),a=e.constructor;return Tg(e,t<=a.toExpNeg||t>=a.toExpPos)};function V8(e,t){var a,o,c,b,S,i,P,L,U=e.constructor,V=U.precision;if(!e.s||!t.s)return t.s||(t=new U(e)),to?ba(t,V):t;if(P=e.d,L=t.d,S=e.e,c=t.e,P=P.slice(),b=S-c,b){for(b<0?(o=P,b=-b,i=L.length):(o=L,c=S,i=P.length),S=Math.ceil(V/qa),i=S>i?S+1:i+1,b>i&&(b=i,o.length=1),o.reverse();b--;)o.push(0);o.reverse()}for(i=P.length,b=L.length,i-b<0&&(b=i,o=L,L=P,P=o),a=0;b;)a=(P[--b]=P[b]+L[b]+a)/Is|0,P[b]%=Is;for(a&&(P.unshift(a),++c),i=P.length;P[--i]==0;)P.pop();return t.d=P,t.e=c,to?ba(t,V):t}function Uf(e,t,a){if(e!==~~e||e<t||e>a)throw Error(vg+e)}function Df(e){var t,a,o,c=e.length-1,b="",S=e[0];if(c>0){for(b+=S,t=1;t<c;t++)o=e[t]+"",a=qa-o.length,a&&(b+=Jp(a)),b+=o;S=e[t],o=S+"",a=qa-o.length,a&&(b+=Jp(a))}else if(S===0)return"0";for(;S%10===0;)S/=10;return b+S}var Gd=function(){function e(o,c){var b,S=0,i=o.length;for(o=o.slice();i--;)b=o[i]*c+S,o[i]=b%Is|0,S=b/Is|0;return S&&o.unshift(S),o}function t(o,c,b,S){var i,P;if(b!=S)P=b>S?1:-1;else for(i=P=0;i<b;i++)if(o[i]!=c[i]){P=o[i]>c[i]?1:-1;break}return P}function a(o,c,b){for(var S=0;b--;)o[b]-=S,S=o[b]<c[b]?1:0,o[b]=S*Is+o[b]-c[b];for(;!o[0]&&o.length>1;)o.shift()}return function(o,c,b,S){var i,P,L,U,V,H,ee,ie,le,ue,ge,Se,ve,Ee,me,Ae,Oe,Ye,He=o.constructor,st=o.s==c.s?1:-1,Ke=o.d,Ot=c.d;if(!o.s)return new He(o);if(!c.s)throw Error(Hc+"Division by zero");for(P=o.e-c.e,Oe=Ot.length,me=Ke.length,ee=new He(st),ie=ee.d=[],L=0;Ot[L]==(Ke[L]||0);)++L;if(Ot[L]>(Ke[L]||0)&&--P,b==null?Se=b=He.precision:S?Se=b+(Yo(o)-Yo(c))+1:Se=b,Se<0)return new He(0);if(Se=Se/qa+2|0,L=0,Oe==1)for(U=0,Ot=Ot[0],Se++;(L<me||U)&&Se--;L++)ve=U*Is+(Ke[L]||0),ie[L]=ve/Ot|0,U=ve%Ot|0;else{for(U=Is/(Ot[0]+1)|0,U>1&&(Ot=e(Ot,U),Ke=e(Ke,U),Oe=Ot.length,me=Ke.length),Ee=Oe,le=Ke.slice(0,Oe),ue=le.length;ue<Oe;)le[ue++]=0;Ye=Ot.slice(),Ye.unshift(0),Ae=Ot[0],Ot[1]>=Is/2&&++Ae;do U=0,i=t(Ot,le,Oe,ue),i<0?(ge=le[0],Oe!=ue&&(ge=ge*Is+(le[1]||0)),U=ge/Ae|0,U>1?(U>=Is&&(U=Is-1),V=e(Ot,U),H=V.length,ue=le.length,i=t(V,le,H,ue),i==1&&(U--,a(V,Oe<H?Ye:Ot,H))):(U==0&&(i=U=1),V=Ot.slice()),H=V.length,H<ue&&V.unshift(0),a(le,V,ue),i==-1&&(ue=le.length,i=t(Ot,le,Oe,ue),i<1&&(U++,a(le,Oe<ue?Ye:Ot,ue))),ue=le.length):i===0&&(U++,le=[0]),ie[L++]=U,i&&le[0]?le[ue++]=Ke[Ee]||0:(le=[Ke[Ee]],ue=1);while((Ee++<me||le[0]!==void 0)&&Se--)}return ie[0]||ie.shift(),ee.e=P,ba(ee,S?b+Yo(ee)+1:b)}}();function q8(e,t){var a,o,c,b,S,i,P=0,L=0,U=e.constructor,V=U.precision;if(Yo(e)>16)throw Error(nR+Yo(e));if(!e.s)return new U(Ku);for(to=!1,i=V,S=new U(.03125);e.abs().gte(.1);)e=e.times(S),L+=5;for(o=Math.log(ug(2,L))/Math.LN10*2+5|0,i+=o,a=c=b=new U(Ku),U.precision=i;;){if(c=ba(c.times(e),i),a=a.times(++P),S=b.plus(Gd(c,a,i)),Df(S.d).slice(0,i)===Df(b.d).slice(0,i)){for(;L--;)b=ba(b.times(b),i);return U.precision=V,t==null?(to=!0,ba(b,V)):b}b=S}}function Yo(e){for(var t=e.e*qa,a=e.d[0];a>=10;a/=10)t++;return t}function LM(e,t,a){if(t>e.LN10.sd())throw to=!0,a&&(e.precision=a),Error(Hc+"LN10 precision limit exceeded");return ba(new e(e.LN10),t)}function Jp(e){for(var t="";e--;)t+="0";return t}function H0(e,t){var a,o,c,b,S,i,P,L,U,V=1,H=10,ee=e,ie=ee.d,le=ee.constructor,ue=le.precision;if(ee.s<1)throw Error(Hc+(ee.s?"NaN":"-Infinity"));if(ee.eq(Ku))return new le(0);if(t==null?(to=!1,L=ue):L=t,ee.eq(10))return t==null&&(to=!0),LM(le,L);if(L+=H,le.precision=L,a=Df(ie),o=a.charAt(0),b=Yo(ee),Math.abs(b)<15e14){for(;o<7&&o!=1||o==1&&a.charAt(1)>3;)ee=ee.times(e),a=Df(ee.d),o=a.charAt(0),V++;b=Yo(ee),o>1?(ee=new le("0."+a),b++):ee=new le(o+"."+a.slice(1))}else return P=LM(le,L+2,ue).times(b+""),ee=H0(new le(o+"."+a.slice(1)),L-H).plus(P),le.precision=ue,t==null?(to=!0,ba(ee,ue)):ee;for(i=S=ee=Gd(ee.minus(Ku),ee.plus(Ku),L),U=ba(ee.times(ee),L),c=3;;){if(S=ba(S.times(U),L),P=i.plus(Gd(S,new le(c),L)),Df(P.d).slice(0,L)===Df(i.d).slice(0,L))return i=i.times(2),b!==0&&(i=i.plus(LM(le,L+2,ue).times(b+""))),i=Gd(i,new le(V),L),le.precision=ue,t==null?(to=!0,ba(i,ue)):i;i=P,c+=2}}function fB(e,t){var a,o,c;for((a=t.indexOf("."))>-1&&(t=t.replace(".","")),(o=t.search(/e/i))>0?(a<0&&(a=o),a+=+t.slice(o+1),t=t.substring(0,o)):a<0&&(a=t.length),o=0;t.charCodeAt(o)===48;)++o;for(c=t.length;t.charCodeAt(c-1)===48;)--c;if(t=t.slice(o,c),t){if(c-=o,a=a-o-1,e.e=U_(a/qa),e.d=[],o=(a+1)%qa,a<0&&(o+=qa),o<c){for(o&&e.d.push(+t.slice(0,o)),c-=qa;o<c;)e.d.push(+t.slice(o,o+=qa));t=t.slice(o),o=qa-t.length}else o-=c;for(;o--;)t+="0";if(e.d.push(+t),to&&(e.e>iw||e.e<-iw))throw Error(nR+a)}else e.s=0,e.e=0,e.d=[0];return e}function ba(e,t,a){var o,c,b,S,i,P,L,U,V=e.d;for(S=1,b=V[0];b>=10;b/=10)S++;if(o=t-S,o<0)o+=qa,c=t,L=V[U=0];else{if(U=Math.ceil((o+1)/qa),b=V.length,U>=b)return e;for(L=b=V[U],S=1;b>=10;b/=10)S++;o%=qa,c=o-qa+S}if(a!==void 0&&(b=ug(10,S-c-1),i=L/b%10|0,P=t<0||V[U+1]!==void 0||L%b,P=a<4?(i||P)&&(a==0||a==(e.s<0?3:2)):i>5||i==5&&(a==4||P||a==6&&(o>0?c>0?L/ug(10,S-c):0:V[U-1])%10&1||a==(e.s<0?8:7))),t<1||!V[0])return P?(b=Yo(e),V.length=1,t=t-b-1,V[0]=ug(10,(qa-t%qa)%qa),e.e=U_(-t/qa)||0):(V.length=1,V[0]=e.e=e.s=0),e;if(o==0?(V.length=U,b=1,U--):(V.length=U+1,b=ug(10,qa-o),V[U]=c>0?(L/ug(10,S-c)%ug(10,c)|0)*b:0),P)for(;;)if(U==0){(V[0]+=b)==Is&&(V[0]=1,++e.e);break}else{if(V[U]+=b,V[U]!=Is)break;V[U--]=0,b=1}for(o=V.length;V[--o]===0;)V.pop();if(to&&(e.e>iw||e.e<-iw))throw Error(nR+Yo(e));return e}function G8(e,t){var a,o,c,b,S,i,P,L,U,V,H=e.constructor,ee=H.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new H(e),to?ba(t,ee):t;if(P=e.d,V=t.d,o=t.e,L=e.e,P=P.slice(),S=L-o,S){for(U=S<0,U?(a=P,S=-S,i=V.length):(a=V,o=L,i=P.length),c=Math.max(Math.ceil(ee/qa),i)+2,S>c&&(S=c,a.length=1),a.reverse(),c=S;c--;)a.push(0);a.reverse()}else{for(c=P.length,i=V.length,U=c<i,U&&(i=c),c=0;c<i;c++)if(P[c]!=V[c]){U=P[c]<V[c];break}S=0}for(U&&(a=P,P=V,V=a,t.s=-t.s),i=P.length,c=V.length-i;c>0;--c)P[i++]=0;for(c=V.length;c>S;){if(P[--c]<V[c]){for(b=c;b&&P[--b]===0;)P[b]=Is-1;--P[b],P[c]+=Is}P[c]-=V[c]}for(;P[--i]===0;)P.pop();for(;P[0]===0;P.shift())--o;return P[0]?(t.d=P,t.e=o,to?ba(t,ee):t):new H(0)}function Tg(e,t,a){var o,c=Yo(e),b=Df(e.d),S=b.length;return t?(a&&(o=a-S)>0?b=b.charAt(0)+"."+b.slice(1)+Jp(o):S>1&&(b=b.charAt(0)+"."+b.slice(1)),b=b+(c<0?"e":"e+")+c):c<0?(b="0."+Jp(-c-1)+b,a&&(o=a-S)>0&&(b+=Jp(o))):c>=S?(b+=Jp(c+1-S),a&&(o=a-c-1)>0&&(b=b+"."+Jp(o))):((o=c+1)<S&&(b=b.slice(0,o)+"."+b.slice(o)),a&&(o=a-S)>0&&(c+1===S&&(b+="."),b+=Jp(o))),e.s<0?"-"+b:b}function dB(e,t){if(e.length>t)return e.length=t,!0}function $8(e){var t,a,o;function c(b){var S=this;if(!(S instanceof c))return new c(b);if(S.constructor=c,b instanceof c){S.s=b.s,S.e=b.e,S.d=(b=b.d)?b.slice():b;return}if(typeof b=="number"){if(b*0!==0)throw Error(vg+b);if(b>0)S.s=1;else if(b<0)b=-b,S.s=-1;else{S.s=0,S.e=0,S.d=[0];return}if(b===~~b&&b<1e7){S.e=0,S.d=[b];return}return fB(S,b.toString())}else if(typeof b!="string")throw Error(vg+b);if(b.charCodeAt(0)===45?(b=b.slice(1),S.s=-1):S.s=1,noe.test(b))fB(S,b);else throw Error(vg+b)}if(c.prototype=pr,c.ROUND_UP=0,c.ROUND_DOWN=1,c.ROUND_CEIL=2,c.ROUND_FLOOR=3,c.ROUND_HALF_UP=4,c.ROUND_HALF_DOWN=5,c.ROUND_HALF_EVEN=6,c.ROUND_HALF_CEIL=7,c.ROUND_HALF_FLOOR=8,c.clone=$8,c.config=c.set=roe,e===void 0&&(e={}),e)for(o=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<o.length;)e.hasOwnProperty(a=o[t++])||(e[a]=this[a]);return c.config(e),c}function roe(e){if(!e||typeof e!="object")throw Error(Hc+"Object expected");var t,a,o,c=["precision",1,j_,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<c.length;t+=3)if((o=e[a=c[t]])!==void 0)if(U_(o)===o&&o>=c[t+1]&&o<=c[t+2])this[a]=o;else throw Error(vg+a+": "+o);if((o=e[a="LN10"])!==void 0)if(o==Math.LN10)this[a]=new this(o);else throw Error(vg+a+": "+o);return this}var rR=$8(toe);Ku=new rR(1);const ga=rR;function ioe(e){return loe(e)||soe(e)||ooe(e)||aoe()}function aoe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ooe(e,t){if(e){if(typeof e=="string")return xI(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return xI(e,t)}}function soe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function loe(e){if(Array.isArray(e))return xI(e)}function xI(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}var uoe=function(t){return t},H8={},X8=function(t){return t===H8},pB=function(t){return function a(){return arguments.length===0||arguments.length===1&&X8(arguments.length<=0?void 0:arguments[0])?a:t.apply(void 0,arguments)}},coe=function e(t,a){return t===1?a:pB(function(){for(var o=arguments.length,c=new Array(o),b=0;b<o;b++)c[b]=arguments[b];var S=c.filter(function(i){return i!==H8}).length;return S>=t?a.apply(void 0,c):e(t-S,pB(function(){for(var i=arguments.length,P=new Array(i),L=0;L<i;L++)P[L]=arguments[L];var U=c.map(function(V){return X8(V)?P.shift():V});return a.apply(void 0,ioe(U).concat(P))}))})},y2=function(t){return coe(t.length,t)},bI=function(t,a){for(var o=[],c=t;c<a;++c)o[c-t]=c;return o},hoe=y2(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(a){return t[a]}).map(e)}),foe=function(){for(var t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];if(!a.length)return uoe;var c=a.reverse(),b=c[0],S=c.slice(1);return function(){return S.reduce(function(i,P){return P(i)},b.apply(void 0,arguments))}},wI=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},Y8=function(t){var a=null,o=null;return function(){for(var c=arguments.length,b=new Array(c),S=0;S<c;S++)b[S]=arguments[S];return a&&b.every(function(i,P){return i===a[P]})||(a=b,o=t.apply(void 0,b)),o}};function doe(e){var t;return e===0?t=1:t=Math.floor(new ga(e).abs().log(10).toNumber())+1,t}function poe(e,t,a){for(var o=new ga(e),c=0,b=[];o.lt(t)&&c<1e5;)b.push(o.toNumber()),o=o.add(a),c++;return b}var moe=y2(function(e,t,a){var o=+e,c=+t;return o+a*(c-o)}),goe=y2(function(e,t,a){var o=t-+e;return o=o||1/0,(a-e)/o}),yoe=y2(function(e,t,a){var o=t-+e;return o=o||1/0,Math.max(0,Math.min(1,(a-e)/o))});const _2={rangeStep:poe,getDigitCount:doe,interpolateNumber:moe,uninterpolateNumber:goe,uninterpolateTruncation:yoe};function SI(e){return xoe(e)||voe(e)||Z8(e)||_oe()}function _oe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function voe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function xoe(e){if(Array.isArray(e))return TI(e)}function X0(e,t){return Soe(e)||woe(e,t)||Z8(e,t)||boe()}function boe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Z8(e,t){if(e){if(typeof e=="string")return TI(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return TI(e,t)}}function TI(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function woe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var a=[],o=!0,c=!1,b=void 0;try{for(var S=e[Symbol.iterator](),i;!(o=(i=S.next()).done)&&(a.push(i.value),!(t&&a.length===t));o=!0);}catch(P){c=!0,b=P}finally{try{!o&&S.return!=null&&S.return()}finally{if(c)throw b}}return a}}function Soe(e){if(Array.isArray(e))return e}function W8(e){var t=X0(e,2),a=t[0],o=t[1],c=a,b=o;return a>o&&(c=o,b=a),[c,b]}function K8(e,t,a){if(e.lte(0))return new ga(0);var o=_2.getDigitCount(e.toNumber()),c=new ga(10).pow(o),b=e.div(c),S=o!==1?.05:.1,i=new ga(Math.ceil(b.div(S).toNumber())).add(a).mul(S),P=i.mul(c);return t?P:new ga(Math.ceil(P))}function Toe(e,t,a){var o=1,c=new ga(e);if(!c.isint()&&a){var b=Math.abs(e);b<1?(o=new ga(10).pow(_2.getDigitCount(e)-1),c=new ga(Math.floor(c.div(o).toNumber())).mul(o)):b>1&&(c=new ga(Math.floor(e)))}else e===0?c=new ga(Math.floor((t-1)/2)):a||(c=new ga(Math.floor(e)));var S=Math.floor((t-1)/2),i=foe(hoe(function(P){return c.add(new ga(P-S).mul(o)).toNumber()}),bI);return i(0,t)}function J8(e,t,a,o){var c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(a-1)))return{step:new ga(0),tickMin:new ga(0),tickMax:new ga(0)};var b=K8(new ga(t).sub(e).div(a-1),o,c),S;e<=0&&t>=0?S=new ga(0):(S=new ga(e).add(t).div(2),S=S.sub(new ga(S).mod(b)));var i=Math.ceil(S.sub(e).div(b).toNumber()),P=Math.ceil(new ga(t).sub(S).div(b).toNumber()),L=i+P+1;return L>a?J8(e,t,a,o,c+1):(L<a&&(P=t>0?P+(a-L):P,i=t>0?i:i+(a-L)),{step:b,tickMin:S.sub(new ga(i).mul(b)),tickMax:S.add(new ga(P).mul(b))})}function Eoe(e){var t=X0(e,2),a=t[0],o=t[1],c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,S=Math.max(c,2),i=W8([a,o]),P=X0(i,2),L=P[0],U=P[1];if(L===-1/0||U===1/0){var V=U===1/0?[L].concat(SI(bI(0,c-1).map(function(){return 1/0}))):[].concat(SI(bI(0,c-1).map(function(){return-1/0})),[U]);return a>o?wI(V):V}if(L===U)return Toe(L,c,b);var H=J8(L,U,S,b),ee=H.step,ie=H.tickMin,le=H.tickMax,ue=_2.rangeStep(ie,le.add(new ga(.1).mul(ee)),ee);return a>o?wI(ue):ue}function Aoe(e,t){var a=X0(e,2),o=a[0],c=a[1],b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,S=W8([o,c]),i=X0(S,2),P=i[0],L=i[1];if(P===-1/0||L===1/0)return[o,c];if(P===L)return[P];var U=Math.max(t,2),V=K8(new ga(L).sub(P).div(U-1),b,0),H=[].concat(SI(_2.rangeStep(new ga(P),new ga(L).sub(new ga(.99).mul(V)),V)),[L]);return o>c?wI(H):H}var Moe=Y8(Eoe),Ooe=Y8(Aoe),Ioe="Invariant failed";function Eg(e,t){throw new Error(Ioe)}var Coe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function d_(e){"@babel/helpers - typeof";return d_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d_(e)}function aw(){return aw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},aw.apply(this,arguments)}function Poe(e,t){return Loe(e)||Doe(e,t)||koe(e,t)||Roe()}function Roe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function koe(e,t){if(e){if(typeof e=="string")return mB(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return mB(e,t)}}function mB(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function Doe(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,c,b,S,i=[],P=!0,L=!1;try{if(b=(a=a.call(e)).next,t!==0)for(;!(P=(o=b.call(a)).done)&&(i.push(o.value),i.length!==t);P=!0);}catch(U){L=!0,c=U}finally{try{if(!P&&a.return!=null&&(S=a.return(),Object(S)!==S))return}finally{if(L)throw c}}return i}}function Loe(e){if(Array.isArray(e))return e}function zoe(e,t){if(e==null)return{};var a=Noe(e,t),o,c;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(c=0;c<b.length;c++)o=b[c],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function Noe(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function Boe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Foe(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,tq(o.key),o)}}function joe(e,t,a){return t&&Foe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uoe(e,t,a){return t=ow(t),Voe(e,Q8()?Reflect.construct(t,a||[],ow(e).constructor):t.apply(e,a))}function Voe(e,t){if(t&&(d_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qoe(e)}function qoe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Q8(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Q8=function(){return!!e})()}function ow(e){return ow=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},ow(e)}function Goe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&EI(e,t)}function EI(e,t){return EI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,c){return o.__proto__=c,o},EI(e,t)}function eq(e,t,a){return t=tq(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function tq(e){var t=$oe(e,"string");return d_(t)=="symbol"?t:t+""}function $oe(e,t){if(d_(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(d_(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Rx=function(e){function t(){return Boe(this,t),Uoe(this,t,arguments)}return Goe(t,e),joe(t,[{key:"render",value:function(){var o=this.props,c=o.offset,b=o.layout,S=o.width,i=o.dataKey,P=o.data,L=o.dataPointFormatter,U=o.xAxis,V=o.yAxis,H=zoe(o,Coe),ee=ji(H,!1);this.props.direction==="x"&&U.type!=="number"&&Eg();var ie=P.map(function(le){var ue=L(le,i),ge=ue.x,Se=ue.y,ve=ue.value,Ee=ue.errorVal;if(!Ee)return null;var me=[],Ae,Oe;if(Array.isArray(Ee)){var Ye=Poe(Ee,2);Ae=Ye[0],Oe=Ye[1]}else Ae=Oe=Ee;if(b==="vertical"){var He=U.scale,st=Se+c,Ke=st+S,Ot=st-S,Bt=He(ve-Ae),Tt=He(ve+Oe);me.push({x1:Tt,y1:Ke,x2:Tt,y2:Ot}),me.push({x1:Bt,y1:st,x2:Tt,y2:st}),me.push({x1:Bt,y1:Ke,x2:Bt,y2:Ot})}else if(b==="horizontal"){var mt=V.scale,bt=ge+c,Ft=bt-S,Zt=bt+S,Vt=mt(ve-Ae),Ze=mt(ve+Oe);me.push({x1:Ft,y1:Ze,x2:Zt,y2:Ze}),me.push({x1:bt,y1:Vt,x2:bt,y2:Ze}),me.push({x1:Ft,y1:Vt,x2:Zt,y2:Vt})}return kt.createElement(mo,aw({className:"recharts-errorBar",key:"bar-".concat(me.map(function(Xt){return"".concat(Xt.x1,"-").concat(Xt.x2,"-").concat(Xt.y1,"-").concat(Xt.y2)}))},ee),me.map(function(Xt){return kt.createElement("line",aw({},Xt,{key:"line-".concat(Xt.x1,"-").concat(Xt.x2,"-").concat(Xt.y1,"-").concat(Xt.y2)}))}))});return kt.createElement(mo,{className:"recharts-errorBars"},ie)}}])}(kt.Component);eq(Rx,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});eq(Rx,"displayName","ErrorBar");function Y0(e){"@babel/helpers - typeof";return Y0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y0(e)}function gB(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function og(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?gB(Object(a),!0).forEach(function(o){Hoe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):gB(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Hoe(e,t,a){return t=Xoe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Xoe(e){var t=Yoe(e,"string");return Y0(t)=="symbol"?t:t+""}function Yoe(e,t){if(Y0(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(Y0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nq=function(t){var a=t.children,o=t.formattedGraphicalItems,c=t.legendWidth,b=t.legendContent,S=Wu(a,Jy);if(!S)return null;var i=Jy.defaultProps,P=i!==void 0?og(og({},i),S.props):{},L;return S.props&&S.props.payload?L=S.props&&S.props.payload:b==="children"?L=(o||[]).reduce(function(U,V){var H=V.item,ee=V.props,ie=ee.sectors||ee.data||[];return U.concat(ie.map(function(le){return{type:S.props.iconType||H.props.legendType,value:le.name,color:le.fill,payload:le}}))},[]):L=(o||[]).map(function(U){var V=U.item,H=V.type.defaultProps,ee=H!==void 0?og(og({},H),V.props):{},ie=ee.dataKey,le=ee.name,ue=ee.legendType,ge=ee.hide;return{inactive:ge,dataKey:ie,type:P.iconType||ue||"square",color:iR(V),value:le||ie,payload:ee}}),og(og(og({},P),Jy.getWithHeight(S,c)),{},{payload:L,item:S})};function Z0(e){"@babel/helpers - typeof";return Z0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z0(e)}function yB(e){return Joe(e)||Koe(e)||Woe(e)||Zoe()}function Zoe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Woe(e,t){if(e){if(typeof e=="string")return AI(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return AI(e,t)}}function Koe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Joe(e){if(Array.isArray(e))return AI(e)}function AI(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function _B(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function So(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?_B(Object(a),!0).forEach(function(o){e_(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_B(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function e_(e,t,a){return t=Qoe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Qoe(e){var t=ese(e,"string");return Z0(t)=="symbol"?t:t+""}function ese(e,t){if(Z0(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(Z0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wl(e,t,a){return vi(e)||vi(t)?a:os(t)?$c(e,t,a):_i(t)?t(e):a}function b0(e,t,a,o){var c=Jae(e,function(i){return Wl(i,t)});if(a==="number"){var b=c.filter(function(i){return er(i)||parseFloat(i)});return b.length?[m2(b),p2(b)]:[1/0,-1/0]}var S=o?c.filter(function(i){return!vi(i)}):c;return S.map(function(i){return os(i)||i instanceof Date?i:""})}var tse=function(t){var a,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],c=arguments.length>2?arguments[2]:void 0,b=arguments.length>3?arguments[3]:void 0,S=-1,i=(a=o==null?void 0:o.length)!==null&&a!==void 0?a:0;if(i<=1)return 0;if(b&&b.axisType==="angleAxis"&&Math.abs(Math.abs(b.range[1]-b.range[0])-360)<=1e-6)for(var P=b.range,L=0;L<i;L++){var U=L>0?c[L-1].coordinate:c[i-1].coordinate,V=c[L].coordinate,H=L>=i-1?c[0].coordinate:c[L+1].coordinate,ee=void 0;if(Rh(V-U)!==Rh(H-V)){var ie=[];if(Rh(H-V)===Rh(P[1]-P[0])){ee=H;var le=V+P[1]-P[0];ie[0]=Math.min(le,(le+U)/2),ie[1]=Math.max(le,(le+U)/2)}else{ee=U;var ue=H+P[1]-P[0];ie[0]=Math.min(V,(ue+V)/2),ie[1]=Math.max(V,(ue+V)/2)}var ge=[Math.min(V,(ee+V)/2),Math.max(V,(ee+V)/2)];if(t>ge[0]&&t<=ge[1]||t>=ie[0]&&t<=ie[1]){S=c[L].index;break}}else{var Se=Math.min(U,H),ve=Math.max(U,H);if(t>(Se+V)/2&&t<=(ve+V)/2){S=c[L].index;break}}}else for(var Ee=0;Ee<i;Ee++)if(Ee===0&&t<=(o[Ee].coordinate+o[Ee+1].coordinate)/2||Ee>0&&Ee<i-1&&t>(o[Ee].coordinate+o[Ee-1].coordinate)/2&&t<=(o[Ee].coordinate+o[Ee+1].coordinate)/2||Ee===i-1&&t>(o[Ee].coordinate+o[Ee-1].coordinate)/2){S=o[Ee].index;break}return S},iR=function(t){var a,o=t,c=o.type.displayName,b=(a=t.type)!==null&&a!==void 0&&a.defaultProps?So(So({},t.type.defaultProps),t.props):t.props,S=b.stroke,i=b.fill,P;switch(c){case"Line":P=S;break;case"Area":case"Radar":P=S&&S!=="none"?S:i;break;default:P=i;break}return P},nse=function(t){var a=t.barSize,o=t.totalSize,c=t.stackGroups,b=c===void 0?{}:c;if(!b)return{};for(var S={},i=Object.keys(b),P=0,L=i.length;P<L;P++)for(var U=b[i[P]].stackGroups,V=Object.keys(U),H=0,ee=V.length;H<ee;H++){var ie=U[V[H]],le=ie.items,ue=ie.cateAxisId,ge=le.filter(function(Oe){return Vd(Oe.type).indexOf("Bar")>=0});if(ge&&ge.length){var Se=ge[0].type.defaultProps,ve=Se!==void 0?So(So({},Se),ge[0].props):ge[0].props,Ee=ve.barSize,me=ve[ue];S[me]||(S[me]=[]);var Ae=vi(Ee)?a:Ee;S[me].push({item:ge[0],stackList:ge.slice(1),barSize:vi(Ae)?void 0:Sg(Ae,o,0)})}}return S},rse=function(t){var a=t.barGap,o=t.barCategoryGap,c=t.bandSize,b=t.sizeList,S=b===void 0?[]:b,i=t.maxBarSize,P=S.length;if(P<1)return null;var L=Sg(a,c,0,!0),U,V=[];if(S[0].barSize===+S[0].barSize){var H=!1,ee=c/P,ie=S.reduce(function(Ee,me){return Ee+me.barSize||0},0);ie+=(P-1)*L,ie>=c&&(ie-=(P-1)*L,L=0),ie>=c&&ee>0&&(H=!0,ee*=.9,ie=P*ee);var le=(c-ie)/2>>0,ue={offset:le-L,size:0};U=S.reduce(function(Ee,me){var Ae={item:me.item,position:{offset:ue.offset+ue.size+L,size:H?ee:me.barSize}},Oe=[].concat(yB(Ee),[Ae]);return ue=Oe[Oe.length-1].position,me.stackList&&me.stackList.length&&me.stackList.forEach(function(Ye){Oe.push({item:Ye,position:ue})}),Oe},V)}else{var ge=Sg(o,c,0,!0);c-2*ge-(P-1)*L<=0&&(L=0);var Se=(c-2*ge-(P-1)*L)/P;Se>1&&(Se>>=0);var ve=i===+i?Math.min(Se,i):Se;U=S.reduce(function(Ee,me,Ae){var Oe=[].concat(yB(Ee),[{item:me.item,position:{offset:ge+(Se+L)*Ae+(Se-ve)/2,size:ve}}]);return me.stackList&&me.stackList.length&&me.stackList.forEach(function(Ye){Oe.push({item:Ye,position:Oe[Oe.length-1].position})}),Oe},V)}return U},ise=function(t,a,o,c){var b=o.children,S=o.width,i=o.margin,P=S-(i.left||0)-(i.right||0),L=nq({children:b,legendWidth:P});if(L){var U=c||{},V=U.width,H=U.height,ee=L.align,ie=L.verticalAlign,le=L.layout;if((le==="vertical"||le==="horizontal"&&ie==="middle")&&ee!=="center"&&er(t[ee]))return So(So({},t),{},e_({},ee,t[ee]+(V||0)));if((le==="horizontal"||le==="vertical"&&ee==="center")&&ie!=="middle"&&er(t[ie]))return So(So({},t),{},e_({},ie,t[ie]+(H||0)))}return t},ase=function(t,a,o){return vi(a)?!0:t==="horizontal"?a==="yAxis":t==="vertical"||o==="x"?a==="xAxis":o==="y"?a==="yAxis":!0},rq=function(t,a,o,c,b){var S=a.props.children,i=Ju(S,Rx).filter(function(L){return ase(c,b,L.props.direction)});if(i&&i.length){var P=i.map(function(L){return L.props.dataKey});return t.reduce(function(L,U){var V=Wl(U,o);if(vi(V))return L;var H=Array.isArray(V)?[m2(V),p2(V)]:[V,V],ee=P.reduce(function(ie,le){var ue=Wl(U,le,0),ge=H[0]-Math.abs(Array.isArray(ue)?ue[0]:ue),Se=H[1]+Math.abs(Array.isArray(ue)?ue[1]:ue);return[Math.min(ge,ie[0]),Math.max(Se,ie[1])]},[1/0,-1/0]);return[Math.min(ee[0],L[0]),Math.max(ee[1],L[1])]},[1/0,-1/0])}return null},ose=function(t,a,o,c,b){var S=a.map(function(i){return rq(t,i,o,b,c)}).filter(function(i){return!vi(i)});return S&&S.length?S.reduce(function(i,P){return[Math.min(i[0],P[0]),Math.max(i[1],P[1])]},[1/0,-1/0]):null},iq=function(t,a,o,c,b){var S=a.map(function(P){var L=P.props.dataKey;return o==="number"&&L&&rq(t,P,L,c)||b0(t,L,o,b)});if(o==="number")return S.reduce(function(P,L){return[Math.min(P[0],L[0]),Math.max(P[1],L[1])]},[1/0,-1/0]);var i={};return S.reduce(function(P,L){for(var U=0,V=L.length;U<V;U++)i[L[U]]||(i[L[U]]=!0,P.push(L[U]));return P},[])},aq=function(t,a){return t==="horizontal"&&a==="xAxis"||t==="vertical"&&a==="yAxis"||t==="centric"&&a==="angleAxis"||t==="radial"&&a==="radiusAxis"},oq=function(t,a,o,c){if(c)return t.map(function(P){return P.coordinate});var b,S,i=t.map(function(P){return P.coordinate===a&&(b=!0),P.coordinate===o&&(S=!0),P.coordinate});return b||i.push(a),S||i.push(o),i},Fd=function(t,a,o){if(!t)return null;var c=t.scale,b=t.duplicateDomain,S=t.type,i=t.range,P=t.realScaleType==="scaleBand"?c.bandwidth()/2:2,L=(a||o)&&S==="category"&&c.bandwidth?c.bandwidth()/P:0;if(L=t.axisType==="angleAxis"&&(i==null?void 0:i.length)>=2?Rh(i[0]-i[1])*2*L:L,a&&(t.ticks||t.niceTicks)){var U=(t.ticks||t.niceTicks).map(function(V){var H=b?b.indexOf(V):V;return{coordinate:c(H)+L,value:V,offset:L}});return U.filter(function(V){return!Ex(V.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(V,H){return{coordinate:c(V)+L,value:V,index:H,offset:L}}):c.ticks&&!o?c.ticks(t.tickCount).map(function(V){return{coordinate:c(V)+L,value:V,offset:L}}):c.domain().map(function(V,H){return{coordinate:c(V)+L,value:b?b[V]:V,index:H,offset:L}})},zM=new WeakMap,Q1=function(t,a){if(typeof a!="function")return t;zM.has(t)||zM.set(t,new WeakMap);var o=zM.get(t);if(o.has(a))return o.get(a);var c=function(){t.apply(void 0,arguments),a.apply(void 0,arguments)};return o.set(a,c),c},sse=function(t,a,o){var c=t.scale,b=t.type,S=t.layout,i=t.axisType;if(c==="auto")return S==="radial"&&i==="radiusAxis"?{scale:U0(),realScaleType:"band"}:S==="radial"&&i==="angleAxis"?{scale:ew(),realScaleType:"linear"}:b==="category"&&a&&(a.indexOf("LineChart")>=0||a.indexOf("AreaChart")>=0||a.indexOf("ComposedChart")>=0&&!o)?{scale:x0(),realScaleType:"point"}:b==="category"?{scale:U0(),realScaleType:"band"}:{scale:ew(),realScaleType:"linear"};if(Tx(c)){var P="scale".concat(e2(c));return{scale:(rB[P]||x0)(),realScaleType:rB[P]?P:"point"}}return _i(c)?{scale:c}:{scale:x0(),realScaleType:"point"}},vB=1e-4,lse=function(t){var a=t.domain();if(!(!a||a.length<=2)){var o=a.length,c=t.range(),b=Math.min(c[0],c[1])-vB,S=Math.max(c[0],c[1])+vB,i=t(a[0]),P=t(a[o-1]);(i<b||i>S||P<b||P>S)&&t.domain([a[0],a[o-1]])}},use=function(t,a){if(!t)return null;for(var o=0,c=t.length;o<c;o++)if(t[o].item===a)return t[o].position;return null},cse=function(t,a){if(!a||a.length!==2||!er(a[0])||!er(a[1]))return t;var o=Math.min(a[0],a[1]),c=Math.max(a[0],a[1]),b=[t[0],t[1]];return(!er(t[0])||t[0]<o)&&(b[0]=o),(!er(t[1])||t[1]>c)&&(b[1]=c),b[0]>c&&(b[0]=c),b[1]<o&&(b[1]=o),b},hse=function(t){var a=t.length;if(!(a<=0))for(var o=0,c=t[0].length;o<c;++o)for(var b=0,S=0,i=0;i<a;++i){var P=Ex(t[i][o][1])?t[i][o][0]:t[i][o][1];P>=0?(t[i][o][0]=b,t[i][o][1]=b+P,b=t[i][o][1]):(t[i][o][0]=S,t[i][o][1]=S+P,S=t[i][o][1])}},fse=function(t){var a=t.length;if(!(a<=0))for(var o=0,c=t[0].length;o<c;++o)for(var b=0,S=0;S<a;++S){var i=Ex(t[S][o][1])?t[S][o][0]:t[S][o][1];i>=0?(t[S][o][0]=b,t[S][o][1]=b+i,b=t[S][o][1]):(t[S][o][0]=0,t[S][o][1]=0)}},dse={sign:hse,expand:WQ,none:a_,silhouette:KQ,wiggle:JQ,positive:fse},pse=function(t,a,o){var c=a.map(function(i){return i.props.dataKey}),b=dse[o],S=ZQ().keys(c).value(function(i,P){return+Wl(i,P,0)}).order(nI).offset(b);return S(t)},mse=function(t,a,o,c,b,S){if(!t)return null;var i=S?a.reverse():a,P={},L=i.reduce(function(V,H){var ee,ie=(ee=H.type)!==null&&ee!==void 0&&ee.defaultProps?So(So({},H.type.defaultProps),H.props):H.props,le=ie.stackId,ue=ie.hide;if(ue)return V;var ge=ie[o],Se=V[ge]||{hasStack:!1,stackGroups:{}};if(os(le)){var ve=Se.stackGroups[le]||{numericAxisId:o,cateAxisId:c,items:[]};ve.items.push(H),Se.hasStack=!0,Se.stackGroups[le]=ve}else Se.stackGroups[Ax("_stackId_")]={numericAxisId:o,cateAxisId:c,items:[H]};return So(So({},V),{},e_({},ge,Se))},P),U={};return Object.keys(L).reduce(function(V,H){var ee=L[H];if(ee.hasStack){var ie={};ee.stackGroups=Object.keys(ee.stackGroups).reduce(function(le,ue){var ge=ee.stackGroups[ue];return So(So({},le),{},e_({},ue,{numericAxisId:o,cateAxisId:c,items:ge.items,stackedData:pse(t,ge.items,b)}))},ie)}return So(So({},V),{},e_({},H,ee))},U)},gse=function(t,a){var o=a.realScaleType,c=a.type,b=a.tickCount,S=a.originalDomain,i=a.allowDecimals,P=o||a.scale;if(P!=="auto"&&P!=="linear")return null;if(b&&c==="number"&&S&&(S[0]==="auto"||S[1]==="auto")){var L=t.domain();if(!L.length)return null;var U=Moe(L,b,i);return t.domain([m2(U),p2(U)]),{niceTicks:U}}if(b&&c==="number"){var V=t.domain(),H=Ooe(V,b,i);return{niceTicks:H}}return null};function xB(e){var t=e.axis,a=e.ticks,o=e.bandSize,c=e.entry,b=e.index,S=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!vi(c[t.dataKey])){var i=Lb(a,"value",c[t.dataKey]);if(i)return i.coordinate+o/2}return a[b]?a[b].coordinate+o/2:null}var P=Wl(c,vi(S)?t.dataKey:S);return vi(P)?null:t.scale(P)}var bB=function(t){var a=t.axis,o=t.ticks,c=t.offset,b=t.bandSize,S=t.entry,i=t.index;if(a.type==="category")return o[i]?o[i].coordinate+c:null;var P=Wl(S,a.dataKey,a.domain[i]);return vi(P)?null:a.scale(P)-b/2+c},yse=function(t){var a=t.numericAxis,o=a.scale.domain();if(a.type==="number"){var c=Math.min(o[0],o[1]),b=Math.max(o[0],o[1]);return c<=0&&b>=0?0:b<0?b:c}return o[0]},_se=function(t,a){var o,c=(o=t.type)!==null&&o!==void 0&&o.defaultProps?So(So({},t.type.defaultProps),t.props):t.props,b=c.stackId;if(os(b)){var S=a[b];if(S){var i=S.items.indexOf(t);return i>=0?S.stackedData[i]:null}}return null},vse=function(t){return t.reduce(function(a,o){return[m2(o.concat([a[0]]).filter(er)),p2(o.concat([a[1]]).filter(er))]},[1/0,-1/0])},sq=function(t,a,o){return Object.keys(t).reduce(function(c,b){var S=t[b],i=S.stackedData,P=i.reduce(function(L,U){var V=vse(U.slice(a,o+1));return[Math.min(L[0],V[0]),Math.max(L[1],V[1])]},[1/0,-1/0]);return[Math.min(P[0],c[0]),Math.max(P[1],c[1])]},[1/0,-1/0]).map(function(c){return c===1/0||c===-1/0?0:c})},wB=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,SB=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,MI=function(t,a,o){if(_i(t))return t(a,o);if(!Array.isArray(t))return a;var c=[];if(er(t[0]))c[0]=o?t[0]:Math.min(t[0],a[0]);else if(wB.test(t[0])){var b=+wB.exec(t[0])[1];c[0]=a[0]-b}else _i(t[0])?c[0]=t[0](a[0]):c[0]=a[0];if(er(t[1]))c[1]=o?t[1]:Math.max(t[1],a[1]);else if(SB.test(t[1])){var S=+SB.exec(t[1])[1];c[1]=a[1]+S}else _i(t[1])?c[1]=t[1](a[1]):c[1]=a[1];return c},sw=function(t,a,o){if(t&&t.scale&&t.scale.bandwidth){var c=t.scale.bandwidth();if(!o||c>0)return c}if(t&&a&&a.length>=2){for(var b=PP(a,function(V){return V.coordinate}),S=1/0,i=1,P=b.length;i<P;i++){var L=b[i],U=b[i-1];S=Math.min((L.coordinate||0)-(U.coordinate||0),S)}return S===1/0?0:S}return o?void 0:0},TB=function(t,a,o){return!t||!t.length||g2(t,$c(o,"type.defaultProps.domain"))?a:t},lq=function(t,a){var o=t.type.defaultProps?So(So({},t.type.defaultProps),t.props):t.props,c=o.dataKey,b=o.name,S=o.unit,i=o.formatter,P=o.tooltipType,L=o.chartType,U=o.hide;return So(So({},ji(t,!1)),{},{dataKey:c,unit:S,formatter:i,name:b||c,color:iR(t),value:Wl(a,c),type:P,payload:a,chartType:L,hide:U})};function W0(e){"@babel/helpers - typeof";return W0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W0(e)}function EB(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function AB(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?EB(Object(a),!0).forEach(function(o){xse(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):EB(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function xse(e,t,a){return t=bse(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function bse(e){var t=wse(e,"string");return W0(t)=="symbol"?t:t+""}function wse(e,t){if(W0(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(W0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lw=Math.PI/180,Sse=function(t){return t*180/Math.PI},tl=function(t,a,o,c){return{x:t+Math.cos(-lw*c)*o,y:a+Math.sin(-lw*c)*o}},Tse=function(t,a){var o=t.x,c=t.y,b=a.x,S=a.y;return Math.sqrt(Math.pow(o-b,2)+Math.pow(c-S,2))},Ese=function(t,a){var o=t.x,c=t.y,b=a.cx,S=a.cy,i=Tse({x:o,y:c},{x:b,y:S});if(i<=0)return{radius:i};var P=(o-b)/i,L=Math.acos(P);return c>S&&(L=2*Math.PI-L),{radius:i,angle:Sse(L),angleInRadian:L}},Ase=function(t){var a=t.startAngle,o=t.endAngle,c=Math.floor(a/360),b=Math.floor(o/360),S=Math.min(c,b);return{startAngle:a-S*360,endAngle:o-S*360}},Mse=function(t,a){var o=a.startAngle,c=a.endAngle,b=Math.floor(o/360),S=Math.floor(c/360),i=Math.min(b,S);return t+i*360},MB=function(t,a){var o=t.x,c=t.y,b=Ese({x:o,y:c},a),S=b.radius,i=b.angle,P=a.innerRadius,L=a.outerRadius;if(S<P||S>L)return!1;if(S===0)return!0;var U=Ase(a),V=U.startAngle,H=U.endAngle,ee=i,ie;if(V<=H){for(;ee>H;)ee-=360;for(;ee<V;)ee+=360;ie=ee>=V&&ee<=H}else{for(;ee>V;)ee-=360;for(;ee<H;)ee+=360;ie=ee>=H&&ee<=V}return ie?AB(AB({},a),{},{radius:S,angle:Mse(ee,a)}):null};function K0(e){"@babel/helpers - typeof";return K0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K0(e)}var Ose=["offset"];function Ise(e){return kse(e)||Rse(e)||Pse(e)||Cse()}function Cse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pse(e,t){if(e){if(typeof e=="string")return OI(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return OI(e,t)}}function Rse(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function kse(e){if(Array.isArray(e))return OI(e)}function OI(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function Dse(e,t){if(e==null)return{};var a=Lse(e,t),o,c;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(c=0;c<b.length;c++)o=b[c],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function Lse(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function OB(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function as(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?OB(Object(a),!0).forEach(function(o){zse(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):OB(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function zse(e,t,a){return t=Nse(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Nse(e){var t=Bse(e,"string");return K0(t)=="symbol"?t:t+""}function Bse(e,t){if(K0(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(K0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function J0(){return J0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},J0.apply(this,arguments)}var Fse=function(t){var a=t.value,o=t.formatter,c=vi(t.children)?a:t.children;return _i(o)?o(c):c},jse=function(t,a){var o=Rh(a-t),c=Math.min(Math.abs(a-t),360);return o*c},Use=function(t,a,o){var c=t.position,b=t.viewBox,S=t.offset,i=t.className,P=b,L=P.cx,U=P.cy,V=P.innerRadius,H=P.outerRadius,ee=P.startAngle,ie=P.endAngle,le=P.clockWise,ue=(V+H)/2,ge=jse(ee,ie),Se=ge>=0?1:-1,ve,Ee;c==="insideStart"?(ve=ee+Se*S,Ee=le):c==="insideEnd"?(ve=ie-Se*S,Ee=!le):c==="end"&&(ve=ie+Se*S,Ee=le),Ee=ge<=0?Ee:!Ee;var me=tl(L,U,ue,ve),Ae=tl(L,U,ue,ve+(Ee?1:-1)*359),Oe="M".concat(me.x,",").concat(me.y,`
    A`).concat(ue,",").concat(ue,",0,1,").concat(Ee?0:1,`,
    `).concat(Ae.x,",").concat(Ae.y),Ye=vi(t.id)?Ax("recharts-radial-line-"):t.id;return kt.createElement("text",J0({},o,{dominantBaseline:"central",className:ia("recharts-radial-bar-label",i)}),kt.createElement("defs",null,kt.createElement("path",{id:Ye,d:Oe})),kt.createElement("textPath",{xlinkHref:"#".concat(Ye)},a))},Vse=function(t){var a=t.viewBox,o=t.offset,c=t.position,b=a,S=b.cx,i=b.cy,P=b.innerRadius,L=b.outerRadius,U=b.startAngle,V=b.endAngle,H=(U+V)/2;if(c==="outside"){var ee=tl(S,i,L+o,H),ie=ee.x,le=ee.y;return{x:ie,y:le,textAnchor:ie>=S?"start":"end",verticalAnchor:"middle"}}if(c==="center")return{x:S,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(c==="centerTop")return{x:S,y:i,textAnchor:"middle",verticalAnchor:"start"};if(c==="centerBottom")return{x:S,y:i,textAnchor:"middle",verticalAnchor:"end"};var ue=(P+L)/2,ge=tl(S,i,ue,H),Se=ge.x,ve=ge.y;return{x:Se,y:ve,textAnchor:"middle",verticalAnchor:"middle"}},qse=function(t){var a=t.viewBox,o=t.parentViewBox,c=t.offset,b=t.position,S=a,i=S.x,P=S.y,L=S.width,U=S.height,V=U>=0?1:-1,H=V*c,ee=V>0?"end":"start",ie=V>0?"start":"end",le=L>=0?1:-1,ue=le*c,ge=le>0?"end":"start",Se=le>0?"start":"end";if(b==="top"){var ve={x:i+L/2,y:P-V*c,textAnchor:"middle",verticalAnchor:ee};return as(as({},ve),o?{height:Math.max(P-o.y,0),width:L}:{})}if(b==="bottom"){var Ee={x:i+L/2,y:P+U+H,textAnchor:"middle",verticalAnchor:ie};return as(as({},Ee),o?{height:Math.max(o.y+o.height-(P+U),0),width:L}:{})}if(b==="left"){var me={x:i-ue,y:P+U/2,textAnchor:ge,verticalAnchor:"middle"};return as(as({},me),o?{width:Math.max(me.x-o.x,0),height:U}:{})}if(b==="right"){var Ae={x:i+L+ue,y:P+U/2,textAnchor:Se,verticalAnchor:"middle"};return as(as({},Ae),o?{width:Math.max(o.x+o.width-Ae.x,0),height:U}:{})}var Oe=o?{width:L,height:U}:{};return b==="insideLeft"?as({x:i+ue,y:P+U/2,textAnchor:Se,verticalAnchor:"middle"},Oe):b==="insideRight"?as({x:i+L-ue,y:P+U/2,textAnchor:ge,verticalAnchor:"middle"},Oe):b==="insideTop"?as({x:i+L/2,y:P+H,textAnchor:"middle",verticalAnchor:ie},Oe):b==="insideBottom"?as({x:i+L/2,y:P+U-H,textAnchor:"middle",verticalAnchor:ee},Oe):b==="insideTopLeft"?as({x:i+ue,y:P+H,textAnchor:Se,verticalAnchor:ie},Oe):b==="insideTopRight"?as({x:i+L-ue,y:P+H,textAnchor:ge,verticalAnchor:ie},Oe):b==="insideBottomLeft"?as({x:i+ue,y:P+U-H,textAnchor:Se,verticalAnchor:ee},Oe):b==="insideBottomRight"?as({x:i+L-ue,y:P+U-H,textAnchor:ge,verticalAnchor:ee},Oe):z_(b)&&(er(b.x)||dg(b.x))&&(er(b.y)||dg(b.y))?as({x:i+Sg(b.x,L),y:P+Sg(b.y,U),textAnchor:"end",verticalAnchor:"end"},Oe):as({x:i+L/2,y:P+U/2,textAnchor:"middle",verticalAnchor:"middle"},Oe)},Gse=function(t){return"cx"in t&&er(t.cx)};function wl(e){var t=e.offset,a=t===void 0?5:t,o=Dse(e,Ose),c=as({offset:a},o),b=c.viewBox,S=c.position,i=c.value,P=c.children,L=c.content,U=c.className,V=U===void 0?"":U,H=c.textBreakAll;if(!b||vi(i)&&vi(P)&&!Jt.isValidElement(L)&&!_i(L))return null;if(Jt.isValidElement(L))return Jt.cloneElement(L,c);var ee;if(_i(L)){if(ee=Jt.createElement(L,c),Jt.isValidElement(ee))return ee}else ee=Fse(c);var ie=Gse(b),le=ji(c,!0);if(ie&&(S==="insideStart"||S==="insideEnd"||S==="end"))return Use(c,ee,le);var ue=ie?Vse(c):qse(c);return kt.createElement(Xb,J0({className:ia("recharts-label",V)},le,ue,{breakAll:H}),ee)}wl.displayName="Label";var uq=function(t){var a=t.cx,o=t.cy,c=t.angle,b=t.startAngle,S=t.endAngle,i=t.r,P=t.radius,L=t.innerRadius,U=t.outerRadius,V=t.x,H=t.y,ee=t.top,ie=t.left,le=t.width,ue=t.height,ge=t.clockWise,Se=t.labelViewBox;if(Se)return Se;if(er(le)&&er(ue)){if(er(V)&&er(H))return{x:V,y:H,width:le,height:ue};if(er(ee)&&er(ie))return{x:ee,y:ie,width:le,height:ue}}return er(V)&&er(H)?{x:V,y:H,width:0,height:0}:er(a)&&er(o)?{cx:a,cy:o,startAngle:b||c||0,endAngle:S||c||0,innerRadius:L||0,outerRadius:U||P||i||0,clockWise:ge}:t.viewBox?t.viewBox:{}},$se=function(t,a){return t?t===!0?kt.createElement(wl,{key:"label-implicit",viewBox:a}):os(t)?kt.createElement(wl,{key:"label-implicit",viewBox:a,value:t}):Jt.isValidElement(t)?t.type===wl?Jt.cloneElement(t,{key:"label-implicit",viewBox:a}):kt.createElement(wl,{key:"label-implicit",content:t,viewBox:a}):_i(t)?kt.createElement(wl,{key:"label-implicit",content:t,viewBox:a}):z_(t)?kt.createElement(wl,J0({viewBox:a},t,{key:"label-implicit"})):null:null},Hse=function(t,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&o&&!t.label)return null;var c=t.children,b=uq(t),S=Ju(c,wl).map(function(P,L){return Jt.cloneElement(P,{viewBox:a||b,key:"label-".concat(L)})});if(!o)return S;var i=$se(t.label,a||b);return[i].concat(Ise(S))};wl.parseViewBox=uq;wl.renderCallByParent=Hse;var NM,IB;function Xse(){if(IB)return NM;IB=1;function e(t){var a=t==null?0:t.length;return a?t[a-1]:void 0}return NM=e,NM}var Yse=Xse();const Zse=fa(Yse);function Q0(e){"@babel/helpers - typeof";return Q0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q0(e)}var Wse=["valueAccessor"],Kse=["data","dataKey","clockWise","id","textBreakAll"];function Jse(e){return nle(e)||tle(e)||ele(e)||Qse()}function Qse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ele(e,t){if(e){if(typeof e=="string")return II(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return II(e,t)}}function tle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function nle(e){if(Array.isArray(e))return II(e)}function II(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function uw(){return uw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},uw.apply(this,arguments)}function CB(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function PB(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?CB(Object(a),!0).forEach(function(o){rle(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):CB(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function rle(e,t,a){return t=ile(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ile(e){var t=ale(e,"string");return Q0(t)=="symbol"?t:t+""}function ale(e,t){if(Q0(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(Q0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RB(e,t){if(e==null)return{};var a=ole(e,t),o,c;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(c=0;c<b.length;c++)o=b[c],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function ole(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}var sle=function(t){return Array.isArray(t.value)?Zse(t.value):t.value};function rm(e){var t=e.valueAccessor,a=t===void 0?sle:t,o=RB(e,Wse),c=o.data,b=o.dataKey,S=o.clockWise,i=o.id,P=o.textBreakAll,L=RB(o,Kse);return!c||!c.length?null:kt.createElement(mo,{className:"recharts-label-list"},c.map(function(U,V){var H=vi(b)?a(U,V):Wl(U&&U.payload,b),ee=vi(i)?{}:{id:"".concat(i,"-").concat(V)};return kt.createElement(wl,uw({},ji(U,!0),L,ee,{parentViewBox:U.parentViewBox,value:H,textBreakAll:P,viewBox:wl.parseViewBox(vi(S)?U:PB(PB({},U),{},{clockWise:S})),key:"label-".concat(V),index:V}))}))}rm.displayName="LabelList";function lle(e,t){return e?e===!0?kt.createElement(rm,{key:"labelList-implicit",data:t}):kt.isValidElement(e)||_i(e)?kt.createElement(rm,{key:"labelList-implicit",data:t,content:e}):z_(e)?kt.createElement(rm,uw({data:t},e,{key:"labelList-implicit"})):null:null}function ule(e,t){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&a&&!e.label)return null;var o=e.children,c=Ju(o,rm).map(function(S,i){return Jt.cloneElement(S,{data:t,key:"labelList-".concat(i)})});if(!a)return c;var b=lle(e.label,t);return[b].concat(Jse(c))}rm.renderCallByParent=ule;function ex(e){"@babel/helpers - typeof";return ex=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ex(e)}function CI(){return CI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},CI.apply(this,arguments)}function kB(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function DB(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?kB(Object(a),!0).forEach(function(o){cle(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):kB(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function cle(e,t,a){return t=hle(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function hle(e){var t=fle(e,"string");return ex(t)=="symbol"?t:t+""}function fle(e,t){if(ex(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(ex(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dle=function(t,a){var o=Rh(a-t),c=Math.min(Math.abs(a-t),359.999);return o*c},eb=function(t){var a=t.cx,o=t.cy,c=t.radius,b=t.angle,S=t.sign,i=t.isExternal,P=t.cornerRadius,L=t.cornerIsExternal,U=P*(i?1:-1)+c,V=Math.asin(P/U)/lw,H=L?b:b+S*V,ee=tl(a,o,U,H),ie=tl(a,o,c,H),le=L?b-S*V:b,ue=tl(a,o,U*Math.cos(V*lw),le);return{center:ee,circleTangency:ie,lineTangency:ue,theta:V}},cq=function(t){var a=t.cx,o=t.cy,c=t.innerRadius,b=t.outerRadius,S=t.startAngle,i=t.endAngle,P=dle(S,i),L=S+P,U=tl(a,o,b,S),V=tl(a,o,b,L),H="M ".concat(U.x,",").concat(U.y,`
    A `).concat(b,",").concat(b,`,0,
    `).concat(+(Math.abs(P)>180),",").concat(+(S>L),`,
    `).concat(V.x,",").concat(V.y,`
  `);if(c>0){var ee=tl(a,o,c,S),ie=tl(a,o,c,L);H+="L ".concat(ie.x,",").concat(ie.y,`
            A `).concat(c,",").concat(c,`,0,
            `).concat(+(Math.abs(P)>180),",").concat(+(S<=L),`,
            `).concat(ee.x,",").concat(ee.y," Z")}else H+="L ".concat(a,",").concat(o," Z");return H},ple=function(t){var a=t.cx,o=t.cy,c=t.innerRadius,b=t.outerRadius,S=t.cornerRadius,i=t.forceCornerRadius,P=t.cornerIsExternal,L=t.startAngle,U=t.endAngle,V=Rh(U-L),H=eb({cx:a,cy:o,radius:b,angle:L,sign:V,cornerRadius:S,cornerIsExternal:P}),ee=H.circleTangency,ie=H.lineTangency,le=H.theta,ue=eb({cx:a,cy:o,radius:b,angle:U,sign:-V,cornerRadius:S,cornerIsExternal:P}),ge=ue.circleTangency,Se=ue.lineTangency,ve=ue.theta,Ee=P?Math.abs(L-U):Math.abs(L-U)-le-ve;if(Ee<0)return i?"M ".concat(ie.x,",").concat(ie.y,`
        a`).concat(S,",").concat(S,",0,0,1,").concat(S*2,`,0
        a`).concat(S,",").concat(S,",0,0,1,").concat(-S*2,`,0
      `):cq({cx:a,cy:o,innerRadius:c,outerRadius:b,startAngle:L,endAngle:U});var me="M ".concat(ie.x,",").concat(ie.y,`
    A`).concat(S,",").concat(S,",0,0,").concat(+(V<0),",").concat(ee.x,",").concat(ee.y,`
    A`).concat(b,",").concat(b,",0,").concat(+(Ee>180),",").concat(+(V<0),",").concat(ge.x,",").concat(ge.y,`
    A`).concat(S,",").concat(S,",0,0,").concat(+(V<0),",").concat(Se.x,",").concat(Se.y,`
  `);if(c>0){var Ae=eb({cx:a,cy:o,radius:c,angle:L,sign:V,isExternal:!0,cornerRadius:S,cornerIsExternal:P}),Oe=Ae.circleTangency,Ye=Ae.lineTangency,He=Ae.theta,st=eb({cx:a,cy:o,radius:c,angle:U,sign:-V,isExternal:!0,cornerRadius:S,cornerIsExternal:P}),Ke=st.circleTangency,Ot=st.lineTangency,Bt=st.theta,Tt=P?Math.abs(L-U):Math.abs(L-U)-He-Bt;if(Tt<0&&S===0)return"".concat(me,"L").concat(a,",").concat(o,"Z");me+="L".concat(Ot.x,",").concat(Ot.y,`
      A`).concat(S,",").concat(S,",0,0,").concat(+(V<0),",").concat(Ke.x,",").concat(Ke.y,`
      A`).concat(c,",").concat(c,",0,").concat(+(Tt>180),",").concat(+(V>0),",").concat(Oe.x,",").concat(Oe.y,`
      A`).concat(S,",").concat(S,",0,0,").concat(+(V<0),",").concat(Ye.x,",").concat(Ye.y,"Z")}else me+="L".concat(a,",").concat(o,"Z");return me},mle={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},hq=function(t){var a=DB(DB({},mle),t),o=a.cx,c=a.cy,b=a.innerRadius,S=a.outerRadius,i=a.cornerRadius,P=a.forceCornerRadius,L=a.cornerIsExternal,U=a.startAngle,V=a.endAngle,H=a.className;if(S<b||U===V)return null;var ee=ia("recharts-sector",H),ie=S-b,le=Sg(i,ie,0,!0),ue;return le>0&&Math.abs(U-V)<360?ue=ple({cx:o,cy:c,innerRadius:b,outerRadius:S,cornerRadius:Math.min(le,ie/2),forceCornerRadius:P,cornerIsExternal:L,startAngle:U,endAngle:V}):ue=cq({cx:o,cy:c,innerRadius:b,outerRadius:S,startAngle:U,endAngle:V}),kt.createElement("path",CI({},ji(a,!0),{className:ee,d:ue,role:"img"}))};function tx(e){"@babel/helpers - typeof";return tx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tx(e)}function PI(){return PI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},PI.apply(this,arguments)}function LB(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function zB(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?LB(Object(a),!0).forEach(function(o){gle(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):LB(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function gle(e,t,a){return t=yle(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function yle(e){var t=_le(e,"string");return tx(t)=="symbol"?t:t+""}function _le(e,t){if(tx(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(tx(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NB={curveBasisClosed:BQ,curveBasisOpen:FQ,curveBasis:NQ,curveBumpX:SQ,curveBumpY:TQ,curveLinearClosed:jQ,curveLinear:n2,curveMonotoneX:UQ,curveMonotoneY:VQ,curveNatural:qQ,curveStep:GQ,curveStepAfter:HQ,curveStepBefore:$Q},tb=function(t){return t.x===+t.x&&t.y===+t.y},e0=function(t){return t.x},t0=function(t){return t.y},vle=function(t,a){if(_i(t))return t;var o="curve".concat(e2(t));return(o==="curveMonotone"||o==="curveBump")&&a?NB["".concat(o).concat(a==="vertical"?"Y":"X")]:NB[o]||n2},xle=function(t){var a=t.type,o=a===void 0?"linear":a,c=t.points,b=c===void 0?[]:c,S=t.baseLine,i=t.layout,P=t.connectNulls,L=P===void 0?!1:P,U=vle(o,i),V=L?b.filter(function(le){return tb(le)}):b,H;if(Array.isArray(S)){var ee=L?S.filter(function(le){return tb(le)}):S,ie=V.map(function(le,ue){return zB(zB({},le),{},{base:ee[ue]})});return i==="vertical"?H=H1().y(t0).x1(e0).x0(function(le){return le.base.x}):H=H1().x(e0).y1(t0).y0(function(le){return le.base.y}),H.defined(tb).curve(U),H(ie)}return i==="vertical"&&er(S)?H=H1().y(t0).x1(e0).x0(S):er(S)?H=H1().x(e0).y1(t0).y0(S):H=mV().x(e0).y(t0),H.defined(tb).curve(U),H(V)},RI=function(t){var a=t.className,o=t.points,c=t.path,b=t.pathRef;if((!o||!o.length)&&!c)return null;var S=o&&o.length?xle(t):c;return kt.createElement("path",PI({},ji(t,!1),zb(t),{className:ia("recharts-curve",a),d:S,ref:b}))},ble=Object.getOwnPropertyNames,wle=Object.getOwnPropertySymbols,Sle=Object.prototype.hasOwnProperty;function BB(e,t){return function(o,c,b){return e(o,c,b)&&t(o,c,b)}}function nb(e){return function(a,o,c){if(!a||!o||typeof a!="object"||typeof o!="object")return e(a,o,c);var b=c.cache,S=b.get(a),i=b.get(o);if(S&&i)return S===o&&i===a;b.set(a,o),b.set(o,a);var P=e(a,o,c);return b.delete(a),b.delete(o),P}}function FB(e){return ble(e).concat(wle(e))}var Tle=Object.hasOwn||function(e,t){return Sle.call(e,t)};function Rg(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var Ele="__v",Ale="__o",Mle="_owner",jB=Object.getOwnPropertyDescriptor,UB=Object.keys;function Ole(e,t,a){var o=e.length;if(t.length!==o)return!1;for(;o-- >0;)if(!a.equals(e[o],t[o],o,o,e,t,a))return!1;return!0}function Ile(e,t){return Rg(e.getTime(),t.getTime())}function Cle(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function Ple(e,t){return e===t}function VB(e,t,a){var o=e.size;if(o!==t.size)return!1;if(!o)return!0;for(var c=new Array(o),b=e.entries(),S,i,P=0;(S=b.next())&&!S.done;){for(var L=t.entries(),U=!1,V=0;(i=L.next())&&!i.done;){if(c[V]){V++;continue}var H=S.value,ee=i.value;if(a.equals(H[0],ee[0],P,V,e,t,a)&&a.equals(H[1],ee[1],H[0],ee[0],e,t,a)){U=c[V]=!0;break}V++}if(!U)return!1;P++}return!0}var Rle=Rg;function kle(e,t,a){var o=UB(e),c=o.length;if(UB(t).length!==c)return!1;for(;c-- >0;)if(!fq(e,t,a,o[c]))return!1;return!0}function n0(e,t,a){var o=FB(e),c=o.length;if(FB(t).length!==c)return!1;for(var b,S,i;c-- >0;)if(b=o[c],!fq(e,t,a,b)||(S=jB(e,b),i=jB(t,b),(S||i)&&(!S||!i||S.configurable!==i.configurable||S.enumerable!==i.enumerable||S.writable!==i.writable)))return!1;return!0}function Dle(e,t){return Rg(e.valueOf(),t.valueOf())}function Lle(e,t){return e.source===t.source&&e.flags===t.flags}function qB(e,t,a){var o=e.size;if(o!==t.size)return!1;if(!o)return!0;for(var c=new Array(o),b=e.values(),S,i;(S=b.next())&&!S.done;){for(var P=t.values(),L=!1,U=0;(i=P.next())&&!i.done;){if(!c[U]&&a.equals(S.value,i.value,S.value,i.value,e,t,a)){L=c[U]=!0;break}U++}if(!L)return!1}return!0}function zle(e,t){var a=e.length;if(t.length!==a)return!1;for(;a-- >0;)if(e[a]!==t[a])return!1;return!0}function Nle(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function fq(e,t,a,o){return(o===Mle||o===Ale||o===Ele)&&(e.$$typeof||t.$$typeof)?!0:Tle(t,o)&&a.equals(e[o],t[o],o,o,e,t,a)}var Ble="[object Arguments]",Fle="[object Boolean]",jle="[object Date]",Ule="[object Error]",Vle="[object Map]",qle="[object Number]",Gle="[object Object]",$le="[object RegExp]",Hle="[object Set]",Xle="[object String]",Yle="[object URL]",Zle=Array.isArray,GB=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,$B=Object.assign,Wle=Object.prototype.toString.call.bind(Object.prototype.toString);function Kle(e){var t=e.areArraysEqual,a=e.areDatesEqual,o=e.areErrorsEqual,c=e.areFunctionsEqual,b=e.areMapsEqual,S=e.areNumbersEqual,i=e.areObjectsEqual,P=e.arePrimitiveWrappersEqual,L=e.areRegExpsEqual,U=e.areSetsEqual,V=e.areTypedArraysEqual,H=e.areUrlsEqual;return function(ie,le,ue){if(ie===le)return!0;if(ie==null||le==null)return!1;var ge=typeof ie;if(ge!==typeof le)return!1;if(ge!=="object")return ge==="number"?S(ie,le,ue):ge==="function"?c(ie,le,ue):!1;var Se=ie.constructor;if(Se!==le.constructor)return!1;if(Se===Object)return i(ie,le,ue);if(Zle(ie))return t(ie,le,ue);if(GB!=null&&GB(ie))return V(ie,le,ue);if(Se===Date)return a(ie,le,ue);if(Se===RegExp)return L(ie,le,ue);if(Se===Map)return b(ie,le,ue);if(Se===Set)return U(ie,le,ue);var ve=Wle(ie);return ve===jle?a(ie,le,ue):ve===$le?L(ie,le,ue):ve===Vle?b(ie,le,ue):ve===Hle?U(ie,le,ue):ve===Gle?typeof ie.then!="function"&&typeof le.then!="function"&&i(ie,le,ue):ve===Yle?H(ie,le,ue):ve===Ule?o(ie,le,ue):ve===Ble?i(ie,le,ue):ve===Fle||ve===qle||ve===Xle?P(ie,le,ue):!1}}function Jle(e){var t=e.circular,a=e.createCustomConfig,o=e.strict,c={areArraysEqual:o?n0:Ole,areDatesEqual:Ile,areErrorsEqual:Cle,areFunctionsEqual:Ple,areMapsEqual:o?BB(VB,n0):VB,areNumbersEqual:Rle,areObjectsEqual:o?n0:kle,arePrimitiveWrappersEqual:Dle,areRegExpsEqual:Lle,areSetsEqual:o?BB(qB,n0):qB,areTypedArraysEqual:o?n0:zle,areUrlsEqual:Nle};if(a&&(c=$B({},c,a(c))),t){var b=nb(c.areArraysEqual),S=nb(c.areMapsEqual),i=nb(c.areObjectsEqual),P=nb(c.areSetsEqual);c=$B({},c,{areArraysEqual:b,areMapsEqual:S,areObjectsEqual:i,areSetsEqual:P})}return c}function Qle(e){return function(t,a,o,c,b,S,i){return e(t,a,i)}}function eue(e){var t=e.circular,a=e.comparator,o=e.createState,c=e.equals,b=e.strict;if(o)return function(P,L){var U=o(),V=U.cache,H=V===void 0?t?new WeakMap:void 0:V,ee=U.meta;return a(P,L,{cache:H,equals:c,meta:ee,strict:b})};if(t)return function(P,L){return a(P,L,{cache:new WeakMap,equals:c,meta:void 0,strict:b})};var S={cache:void 0,equals:c,meta:void 0,strict:b};return function(P,L){return a(P,L,S)}}var tue=pm();pm({strict:!0});pm({circular:!0});pm({circular:!0,strict:!0});pm({createInternalComparator:function(){return Rg}});pm({strict:!0,createInternalComparator:function(){return Rg}});pm({circular:!0,createInternalComparator:function(){return Rg}});pm({circular:!0,createInternalComparator:function(){return Rg},strict:!0});function pm(e){e===void 0&&(e={});var t=e.circular,a=t===void 0?!1:t,o=e.createInternalComparator,c=e.createState,b=e.strict,S=b===void 0?!1:b,i=Jle(e),P=Kle(i),L=o?o(P):Qle(P);return eue({circular:a,comparator:P,createState:c,equals:L,strict:S})}function nue(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function HB(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=-1,o=function c(b){a<0&&(a=b),b-a>t?(e(b),a=-1):nue(c)};requestAnimationFrame(o)}function kI(e){"@babel/helpers - typeof";return kI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kI(e)}function rue(e){return sue(e)||oue(e)||aue(e)||iue()}function iue(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aue(e,t){if(e){if(typeof e=="string")return XB(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return XB(e,t)}}function XB(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function oue(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function sue(e){if(Array.isArray(e))return e}function lue(){var e={},t=function(){return null},a=!1,o=function c(b){if(!a){if(Array.isArray(b)){if(!b.length)return;var S=b,i=rue(S),P=i[0],L=i.slice(1);if(typeof P=="number"){HB(c.bind(null,L),P);return}c(P),HB(c.bind(null,L));return}kI(b)==="object"&&(e=b,t(e)),typeof b=="function"&&b()}};return{stop:function(){a=!0},start:function(b){a=!1,o(b)},subscribe:function(b){return t=b,function(){t=function(){return null}}}}}function nx(e){"@babel/helpers - typeof";return nx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nx(e)}function YB(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function ZB(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?YB(Object(a),!0).forEach(function(o){dq(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):YB(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function dq(e,t,a){return t=uue(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function uue(e){var t=cue(e,"string");return nx(t)==="symbol"?t:String(t)}function cue(e,t){if(nx(e)!=="object"||e===null)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(nx(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hue=function(t,a){return[Object.keys(t),Object.keys(a)].reduce(function(o,c){return o.filter(function(b){return c.includes(b)})})},fue=function(t){return t},due=function(t){return t.replace(/([A-Z])/g,function(a){return"-".concat(a.toLowerCase())})},w0=function(t,a){return Object.keys(a).reduce(function(o,c){return ZB(ZB({},o),{},dq({},c,t(c,a[c])))},{})},WB=function(t,a,o){return t.map(function(c){return"".concat(due(c)," ").concat(a,"ms ").concat(o)}).join(",")};function pue(e,t){return yue(e)||gue(e,t)||pq(e,t)||mue()}function mue(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gue(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,c,b,S,i=[],P=!0,L=!1;try{if(b=(a=a.call(e)).next,t!==0)for(;!(P=(o=b.call(a)).done)&&(i.push(o.value),i.length!==t);P=!0);}catch(U){L=!0,c=U}finally{try{if(!P&&a.return!=null&&(S=a.return(),Object(S)!==S))return}finally{if(L)throw c}}return i}}function yue(e){if(Array.isArray(e))return e}function _ue(e){return bue(e)||xue(e)||pq(e)||vue()}function vue(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pq(e,t){if(e){if(typeof e=="string")return DI(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return DI(e,t)}}function xue(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bue(e){if(Array.isArray(e))return DI(e)}function DI(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}var cw=1e-4,mq=function(t,a){return[0,3*t,3*a-6*t,3*t-3*a+1]},gq=function(t,a){return t.map(function(o,c){return o*Math.pow(a,c)}).reduce(function(o,c){return o+c})},KB=function(t,a){return function(o){var c=mq(t,a);return gq(c,o)}},wue=function(t,a){return function(o){var c=mq(t,a),b=[].concat(_ue(c.map(function(S,i){return S*i}).slice(1)),[0]);return gq(b,o)}},JB=function(){for(var t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];var c=a[0],b=a[1],S=a[2],i=a[3];if(a.length===1)switch(a[0]){case"linear":c=0,b=0,S=1,i=1;break;case"ease":c=.25,b=.1,S=.25,i=1;break;case"ease-in":c=.42,b=0,S=1,i=1;break;case"ease-out":c=.42,b=0,S=.58,i=1;break;case"ease-in-out":c=0,b=0,S=.58,i=1;break;default:{var P=a[0].split("(");if(P[0]==="cubic-bezier"&&P[1].split(")")[0].split(",").length===4){var L=P[1].split(")")[0].split(",").map(function(ue){return parseFloat(ue)}),U=pue(L,4);c=U[0],b=U[1],S=U[2],i=U[3]}}}var V=KB(c,S),H=KB(b,i),ee=wue(c,S),ie=function(ge){return ge>1?1:ge<0?0:ge},le=function(ge){for(var Se=ge>1?1:ge,ve=Se,Ee=0;Ee<8;++Ee){var me=V(ve)-Se,Ae=ee(ve);if(Math.abs(me-Se)<cw||Ae<cw)return H(ve);ve=ie(ve-me/Ae)}return H(ve)};return le.isStepper=!1,le},Sue=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=t.stiff,o=a===void 0?100:a,c=t.damping,b=c===void 0?8:c,S=t.dt,i=S===void 0?17:S,P=function(U,V,H){var ee=-(U-V)*o,ie=H*b,le=H+(ee-ie)*i/1e3,ue=H*i/1e3+U;return Math.abs(ue-V)<cw&&Math.abs(le)<cw?[V,0]:[ue,le]};return P.isStepper=!0,P.dt=i,P},Tue=function(){for(var t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];var c=a[0];if(typeof c=="string")switch(c){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return JB(c);case"spring":return Sue();default:if(c.split("(")[0]==="cubic-bezier")return JB(c)}return typeof c=="function"?c:null};function rx(e){"@babel/helpers - typeof";return rx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rx(e)}function QB(e){return Mue(e)||Aue(e)||yq(e)||Eue()}function Eue(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Aue(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Mue(e){if(Array.isArray(e))return zI(e)}function eF(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function el(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?eF(Object(a),!0).forEach(function(o){LI(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):eF(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function LI(e,t,a){return t=Oue(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Oue(e){var t=Iue(e,"string");return rx(t)==="symbol"?t:String(t)}function Iue(e,t){if(rx(e)!=="object"||e===null)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(rx(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cue(e,t){return kue(e)||Rue(e,t)||yq(e,t)||Pue()}function Pue(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yq(e,t){if(e){if(typeof e=="string")return zI(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return zI(e,t)}}function zI(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function Rue(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,c,b,S,i=[],P=!0,L=!1;try{if(b=(a=a.call(e)).next,t!==0)for(;!(P=(o=b.call(a)).done)&&(i.push(o.value),i.length!==t);P=!0);}catch(U){L=!0,c=U}finally{try{if(!P&&a.return!=null&&(S=a.return(),Object(S)!==S))return}finally{if(L)throw c}}return i}}function kue(e){if(Array.isArray(e))return e}var hw=function(t,a,o){return t+(a-t)*o},NI=function(t){var a=t.from,o=t.to;return a!==o},Due=function e(t,a,o){var c=w0(function(b,S){if(NI(S)){var i=t(S.from,S.to,S.velocity),P=Cue(i,2),L=P[0],U=P[1];return el(el({},S),{},{from:L,velocity:U})}return S},a);return o<1?w0(function(b,S){return NI(S)?el(el({},S),{},{velocity:hw(S.velocity,c[b].velocity,o),from:hw(S.from,c[b].from,o)}):S},a):e(t,c,o-1)};const Lue=function(e,t,a,o,c){var b=hue(e,t),S=b.reduce(function(ue,ge){return el(el({},ue),{},LI({},ge,[e[ge],t[ge]]))},{}),i=b.reduce(function(ue,ge){return el(el({},ue),{},LI({},ge,{from:e[ge],velocity:0,to:t[ge]}))},{}),P=-1,L,U,V=function(){return null},H=function(){return w0(function(ge,Se){return Se.from},i)},ee=function(){return!Object.values(i).filter(NI).length},ie=function(ge){L||(L=ge);var Se=ge-L,ve=Se/a.dt;i=Due(a,i,ve),c(el(el(el({},e),t),H())),L=ge,ee()||(P=requestAnimationFrame(V))},le=function(ge){U||(U=ge);var Se=(ge-U)/o,ve=w0(function(me,Ae){return hw.apply(void 0,QB(Ae).concat([a(Se)]))},S);if(c(el(el(el({},e),t),ve)),Se<1)P=requestAnimationFrame(V);else{var Ee=w0(function(me,Ae){return hw.apply(void 0,QB(Ae).concat([a(1)]))},S);c(el(el(el({},e),t),Ee))}};return V=a.isStepper?ie:le,function(){return requestAnimationFrame(V),function(){cancelAnimationFrame(P)}}};function p_(e){"@babel/helpers - typeof";return p_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p_(e)}var zue=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function Nue(e,t){if(e==null)return{};var a=Bue(e,t),o,c;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(c=0;c<b.length;c++)o=b[c],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function Bue(e,t){if(e==null)return{};var a={},o=Object.keys(e),c,b;for(b=0;b<o.length;b++)c=o[b],!(t.indexOf(c)>=0)&&(a[c]=e[c]);return a}function BM(e){return Vue(e)||Uue(e)||jue(e)||Fue()}function Fue(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jue(e,t){if(e){if(typeof e=="string")return BI(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return BI(e,t)}}function Uue(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Vue(e){if(Array.isArray(e))return BI(e)}function BI(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function tF(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function Mh(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?tF(Object(a),!0).forEach(function(o){u0(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):tF(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function u0(e,t,a){return t=_q(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function que(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gue(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_q(o.key),o)}}function $ue(e,t,a){return t&&Gue(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _q(e){var t=Hue(e,"string");return p_(t)==="symbol"?t:String(t)}function Hue(e,t){if(p_(e)!=="object"||e===null)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(p_(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FI(e,t)}function FI(e,t){return FI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,c){return o.__proto__=c,o},FI(e,t)}function Yue(e){var t=Zue();return function(){var o=fw(e),c;if(t){var b=fw(this).constructor;c=Reflect.construct(o,arguments,b)}else c=o.apply(this,arguments);return jI(this,c)}}function jI(e,t){if(t&&(p_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UI(e)}function UI(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fw(e){return fw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},fw(e)}var Kd=function(e){Xue(a,e);var t=Yue(a);function a(o,c){var b;que(this,a),b=t.call(this,o,c);var S=b.props,i=S.isActive,P=S.attributeName,L=S.from,U=S.to,V=S.steps,H=S.children,ee=S.duration;if(b.handleStyleChange=b.handleStyleChange.bind(UI(b)),b.changeStyle=b.changeStyle.bind(UI(b)),!i||ee<=0)return b.state={style:{}},typeof H=="function"&&(b.state={style:U}),jI(b);if(V&&V.length)b.state={style:V[0].style};else if(L){if(typeof H=="function")return b.state={style:L},jI(b);b.state={style:P?u0({},P,L):L}}else b.state={style:{}};return b}return $ue(a,[{key:"componentDidMount",value:function(){var c=this.props,b=c.isActive,S=c.canBegin;this.mounted=!0,!(!b||!S)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(c){var b=this.props,S=b.isActive,i=b.canBegin,P=b.attributeName,L=b.shouldReAnimate,U=b.to,V=b.from,H=this.state.style;if(i){if(!S){var ee={style:P?u0({},P,U):U};this.state&&H&&(P&&H[P]!==U||!P&&H!==U)&&this.setState(ee);return}if(!(tue(c.to,U)&&c.canBegin&&c.isActive)){var ie=!c.canBegin||!c.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var le=ie||L?V:c.to;if(this.state&&H){var ue={style:P?u0({},P,le):le};(P&&H[P]!==le||!P&&H!==le)&&this.setState(ue)}this.runAnimation(Mh(Mh({},this.props),{},{from:le,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var c=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),c&&c()}},{key:"handleStyleChange",value:function(c){this.changeStyle(c)}},{key:"changeStyle",value:function(c){this.mounted&&this.setState({style:c})}},{key:"runJSAnimation",value:function(c){var b=this,S=c.from,i=c.to,P=c.duration,L=c.easing,U=c.begin,V=c.onAnimationEnd,H=c.onAnimationStart,ee=Lue(S,i,Tue(L),P,this.changeStyle),ie=function(){b.stopJSAnimation=ee()};this.manager.start([H,U,ie,P,V])}},{key:"runStepAnimation",value:function(c){var b=this,S=c.steps,i=c.begin,P=c.onAnimationStart,L=S[0],U=L.style,V=L.duration,H=V===void 0?0:V,ee=function(le,ue,ge){if(ge===0)return le;var Se=ue.duration,ve=ue.easing,Ee=ve===void 0?"ease":ve,me=ue.style,Ae=ue.properties,Oe=ue.onAnimationEnd,Ye=ge>0?S[ge-1]:ue,He=Ae||Object.keys(me);if(typeof Ee=="function"||Ee==="spring")return[].concat(BM(le),[b.runJSAnimation.bind(b,{from:Ye.style,to:me,duration:Se,easing:Ee}),Se]);var st=WB(He,Se,Ee),Ke=Mh(Mh(Mh({},Ye.style),me),{},{transition:st});return[].concat(BM(le),[Ke,Se,Oe]).filter(fue)};return this.manager.start([P].concat(BM(S.reduce(ee,[U,Math.max(H,i)])),[c.onAnimationEnd]))}},{key:"runAnimation",value:function(c){this.manager||(this.manager=lue());var b=c.begin,S=c.duration,i=c.attributeName,P=c.to,L=c.easing,U=c.onAnimationStart,V=c.onAnimationEnd,H=c.steps,ee=c.children,ie=this.manager;if(this.unSubscribe=ie.subscribe(this.handleStyleChange),typeof L=="function"||typeof ee=="function"||L==="spring"){this.runJSAnimation(c);return}if(H.length>1){this.runStepAnimation(c);return}var le=i?u0({},i,P):P,ue=WB(Object.keys(le),S,L);ie.start([U,b,Mh(Mh({},le),{},{transition:ue}),S,V])}},{key:"render",value:function(){var c=this.props,b=c.children;c.begin;var S=c.duration;c.attributeName,c.easing;var i=c.isActive;c.steps,c.from,c.to,c.canBegin,c.onAnimationEnd,c.shouldReAnimate,c.onAnimationReStart;var P=Nue(c,zue),L=Jt.Children.count(b),U=this.state.style;if(typeof b=="function")return b(U);if(!i||L===0||S<=0)return b;var V=function(ee){var ie=ee.props,le=ie.style,ue=le===void 0?{}:le,ge=ie.className,Se=Jt.cloneElement(ee,Mh(Mh({},P),{},{style:Mh(Mh({},ue),U),className:ge}));return Se};return L===1?V(Jt.Children.only(b)):kt.createElement("div",null,Jt.Children.map(b,function(H){return V(H)}))}}]),a}(Jt.PureComponent);Kd.displayName="Animate";Kd.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Kd.propTypes={from:dr.oneOfType([dr.object,dr.string]),to:dr.oneOfType([dr.object,dr.string]),attributeName:dr.string,duration:dr.number,begin:dr.number,easing:dr.oneOfType([dr.string,dr.func]),steps:dr.arrayOf(dr.shape({duration:dr.number.isRequired,style:dr.object.isRequired,easing:dr.oneOfType([dr.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),dr.func]),properties:dr.arrayOf("string"),onAnimationEnd:dr.func})),children:dr.oneOfType([dr.node,dr.func]),isActive:dr.bool,canBegin:dr.bool,onAnimationEnd:dr.func,shouldReAnimate:dr.bool,onAnimationStart:dr.func,onAnimationReStart:dr.func};function ix(e){"@babel/helpers - typeof";return ix=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ix(e)}function dw(){return dw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},dw.apply(this,arguments)}function Wue(e,t){return ece(e)||Que(e,t)||Jue(e,t)||Kue()}function Kue(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jue(e,t){if(e){if(typeof e=="string")return nF(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return nF(e,t)}}function nF(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function Que(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,c,b,S,i=[],P=!0,L=!1;try{if(b=(a=a.call(e)).next,t!==0)for(;!(P=(o=b.call(a)).done)&&(i.push(o.value),i.length!==t);P=!0);}catch(U){L=!0,c=U}finally{try{if(!P&&a.return!=null&&(S=a.return(),Object(S)!==S))return}finally{if(L)throw c}}return i}}function ece(e){if(Array.isArray(e))return e}function rF(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function iF(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?rF(Object(a),!0).forEach(function(o){tce(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):rF(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function tce(e,t,a){return t=nce(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function nce(e){var t=rce(e,"string");return ix(t)=="symbol"?t:t+""}function rce(e,t){if(ix(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(ix(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aF=function(t,a,o,c,b){var S=Math.min(Math.abs(o)/2,Math.abs(c)/2),i=c>=0?1:-1,P=o>=0?1:-1,L=c>=0&&o>=0||c<0&&o<0?1:0,U;if(S>0&&b instanceof Array){for(var V=[0,0,0,0],H=0,ee=4;H<ee;H++)V[H]=b[H]>S?S:b[H];U="M".concat(t,",").concat(a+i*V[0]),V[0]>0&&(U+="A ".concat(V[0],",").concat(V[0],",0,0,").concat(L,",").concat(t+P*V[0],",").concat(a)),U+="L ".concat(t+o-P*V[1],",").concat(a),V[1]>0&&(U+="A ".concat(V[1],",").concat(V[1],",0,0,").concat(L,`,
        `).concat(t+o,",").concat(a+i*V[1])),U+="L ".concat(t+o,",").concat(a+c-i*V[2]),V[2]>0&&(U+="A ".concat(V[2],",").concat(V[2],",0,0,").concat(L,`,
        `).concat(t+o-P*V[2],",").concat(a+c)),U+="L ".concat(t+P*V[3],",").concat(a+c),V[3]>0&&(U+="A ".concat(V[3],",").concat(V[3],",0,0,").concat(L,`,
        `).concat(t,",").concat(a+c-i*V[3])),U+="Z"}else if(S>0&&b===+b&&b>0){var ie=Math.min(S,b);U="M ".concat(t,",").concat(a+i*ie,`
            A `).concat(ie,",").concat(ie,",0,0,").concat(L,",").concat(t+P*ie,",").concat(a,`
            L `).concat(t+o-P*ie,",").concat(a,`
            A `).concat(ie,",").concat(ie,",0,0,").concat(L,",").concat(t+o,",").concat(a+i*ie,`
            L `).concat(t+o,",").concat(a+c-i*ie,`
            A `).concat(ie,",").concat(ie,",0,0,").concat(L,",").concat(t+o-P*ie,",").concat(a+c,`
            L `).concat(t+P*ie,",").concat(a+c,`
            A `).concat(ie,",").concat(ie,",0,0,").concat(L,",").concat(t,",").concat(a+c-i*ie," Z")}else U="M ".concat(t,",").concat(a," h ").concat(o," v ").concat(c," h ").concat(-o," Z");return U},ice=function(t,a){if(!t||!a)return!1;var o=t.x,c=t.y,b=a.x,S=a.y,i=a.width,P=a.height;if(Math.abs(i)>0&&Math.abs(P)>0){var L=Math.min(b,b+i),U=Math.max(b,b+i),V=Math.min(S,S+P),H=Math.max(S,S+P);return o>=L&&o<=U&&c>=V&&c<=H}return!1},ace={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},aR=function(t){var a=iF(iF({},ace),t),o=Jt.useRef(),c=Jt.useState(-1),b=Wue(c,2),S=b[0],i=b[1];Jt.useEffect(function(){if(o.current&&o.current.getTotalLength)try{var Ee=o.current.getTotalLength();Ee&&i(Ee)}catch{}},[]);var P=a.x,L=a.y,U=a.width,V=a.height,H=a.radius,ee=a.className,ie=a.animationEasing,le=a.animationDuration,ue=a.animationBegin,ge=a.isAnimationActive,Se=a.isUpdateAnimationActive;if(P!==+P||L!==+L||U!==+U||V!==+V||U===0||V===0)return null;var ve=ia("recharts-rectangle",ee);return Se?kt.createElement(Kd,{canBegin:S>0,from:{width:U,height:V,x:P,y:L},to:{width:U,height:V,x:P,y:L},duration:le,animationEasing:ie,isActive:Se},function(Ee){var me=Ee.width,Ae=Ee.height,Oe=Ee.x,Ye=Ee.y;return kt.createElement(Kd,{canBegin:S>0,from:"0px ".concat(S===-1?1:S,"px"),to:"".concat(S,"px 0px"),attributeName:"strokeDasharray",begin:ue,duration:le,isActive:ge,easing:ie},kt.createElement("path",dw({},ji(a,!0),{className:ve,d:aF(Oe,Ye,me,Ae,H),ref:o})))}):kt.createElement("path",dw({},ji(a,!0),{className:ve,d:aF(P,L,U,V,H)}))};function VI(){return VI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},VI.apply(this,arguments)}var vq=function(t){var a=t.cx,o=t.cy,c=t.r,b=t.className,S=ia("recharts-dot",b);return a===+a&&o===+o&&c===+c?kt.createElement("circle",VI({},ji(t,!1),zb(t),{className:S,cx:a,cy:o,r:c})):null};function ax(e){"@babel/helpers - typeof";return ax=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ax(e)}var oce=["x","y","top","left","width","height","className"];function qI(){return qI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},qI.apply(this,arguments)}function oF(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function sce(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?oF(Object(a),!0).forEach(function(o){lce(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):oF(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function lce(e,t,a){return t=uce(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function uce(e){var t=cce(e,"string");return ax(t)=="symbol"?t:t+""}function cce(e,t){if(ax(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(ax(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hce(e,t){if(e==null)return{};var a=fce(e,t),o,c;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(c=0;c<b.length;c++)o=b[c],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function fce(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}var dce=function(t,a,o,c,b,S){return"M".concat(t,",").concat(b,"v").concat(c,"M").concat(S,",").concat(a,"h").concat(o)},pce=function(t){var a=t.x,o=a===void 0?0:a,c=t.y,b=c===void 0?0:c,S=t.top,i=S===void 0?0:S,P=t.left,L=P===void 0?0:P,U=t.width,V=U===void 0?0:U,H=t.height,ee=H===void 0?0:H,ie=t.className,le=hce(t,oce),ue=sce({x:o,y:b,top:i,left:L,width:V,height:ee},le);return!er(o)||!er(b)||!er(V)||!er(ee)||!er(i)||!er(L)?null:kt.createElement("path",qI({},ji(ue,!0),{className:ia("recharts-cross",ie),d:dce(o,b,V,ee,i,L)}))},FM,sF;function mce(){if(sF)return FM;sF=1;var e=BV(),t=e(Object.getPrototypeOf,Object);return FM=t,FM}var jM,lF;function gce(){if(lF)return jM;lF=1;var e=Qd(),t=mce(),a=ep(),o="[object Object]",c=Function.prototype,b=Object.prototype,S=c.toString,i=b.hasOwnProperty,P=S.call(Object);function L(U){if(!a(U)||e(U)!=o)return!1;var V=t(U);if(V===null)return!0;var H=i.call(V,"constructor")&&V.constructor;return typeof H=="function"&&H instanceof H&&S.call(H)==P}return jM=L,jM}var yce=gce();const _ce=fa(yce);var UM,uF;function vce(){if(uF)return UM;uF=1;var e=Qd(),t=ep(),a="[object Boolean]";function o(c){return c===!0||c===!1||t(c)&&e(c)==a}return UM=o,UM}var xce=vce();const bce=fa(xce);function ox(e){"@babel/helpers - typeof";return ox=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ox(e)}function pw(){return pw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},pw.apply(this,arguments)}function wce(e,t){return Ace(e)||Ece(e,t)||Tce(e,t)||Sce()}function Sce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tce(e,t){if(e){if(typeof e=="string")return cF(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return cF(e,t)}}function cF(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function Ece(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,c,b,S,i=[],P=!0,L=!1;try{if(b=(a=a.call(e)).next,t!==0)for(;!(P=(o=b.call(a)).done)&&(i.push(o.value),i.length!==t);P=!0);}catch(U){L=!0,c=U}finally{try{if(!P&&a.return!=null&&(S=a.return(),Object(S)!==S))return}finally{if(L)throw c}}return i}}function Ace(e){if(Array.isArray(e))return e}function hF(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function fF(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?hF(Object(a),!0).forEach(function(o){Mce(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):hF(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Mce(e,t,a){return t=Oce(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Oce(e){var t=Ice(e,"string");return ox(t)=="symbol"?t:t+""}function Ice(e,t){if(ox(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(ox(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dF=function(t,a,o,c,b){var S=o-c,i;return i="M ".concat(t,",").concat(a),i+="L ".concat(t+o,",").concat(a),i+="L ".concat(t+o-S/2,",").concat(a+b),i+="L ".concat(t+o-S/2-c,",").concat(a+b),i+="L ".concat(t,",").concat(a," Z"),i},Cce={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Pce=function(t){var a=fF(fF({},Cce),t),o=Jt.useRef(),c=Jt.useState(-1),b=wce(c,2),S=b[0],i=b[1];Jt.useEffect(function(){if(o.current&&o.current.getTotalLength)try{var ve=o.current.getTotalLength();ve&&i(ve)}catch{}},[]);var P=a.x,L=a.y,U=a.upperWidth,V=a.lowerWidth,H=a.height,ee=a.className,ie=a.animationEasing,le=a.animationDuration,ue=a.animationBegin,ge=a.isUpdateAnimationActive;if(P!==+P||L!==+L||U!==+U||V!==+V||H!==+H||U===0&&V===0||H===0)return null;var Se=ia("recharts-trapezoid",ee);return ge?kt.createElement(Kd,{canBegin:S>0,from:{upperWidth:0,lowerWidth:0,height:H,x:P,y:L},to:{upperWidth:U,lowerWidth:V,height:H,x:P,y:L},duration:le,animationEasing:ie,isActive:ge},function(ve){var Ee=ve.upperWidth,me=ve.lowerWidth,Ae=ve.height,Oe=ve.x,Ye=ve.y;return kt.createElement(Kd,{canBegin:S>0,from:"0px ".concat(S===-1?1:S,"px"),to:"".concat(S,"px 0px"),attributeName:"strokeDasharray",begin:ue,duration:le,easing:ie},kt.createElement("path",pw({},ji(a,!0),{className:Se,d:dF(Oe,Ye,Ee,me,Ae),ref:o})))}):kt.createElement("g",null,kt.createElement("path",pw({},ji(a,!0),{className:Se,d:dF(P,L,U,V,H)})))},Rce=["option","shapeType","propTransformer","activeClassName","isActive"];function sx(e){"@babel/helpers - typeof";return sx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sx(e)}function kce(e,t){if(e==null)return{};var a=Dce(e,t),o,c;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(c=0;c<b.length;c++)o=b[c],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function Dce(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function pF(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function mw(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?pF(Object(a),!0).forEach(function(o){Lce(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):pF(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Lce(e,t,a){return t=zce(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function zce(e){var t=Nce(e,"string");return sx(t)=="symbol"?t:t+""}function Nce(e,t){if(sx(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(sx(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bce(e,t){return mw(mw({},t),e)}function Fce(e,t){return e==="symbols"}function mF(e){var t=e.shapeType,a=e.elementProps;switch(t){case"rectangle":return kt.createElement(aR,a);case"trapezoid":return kt.createElement(Pce,a);case"sector":return kt.createElement(hq,a);case"symbols":if(Fce(t))return kt.createElement(i2,a);break;default:return null}}function jce(e){return Jt.isValidElement(e)?e.props:e}function GI(e){var t=e.option,a=e.shapeType,o=e.propTransformer,c=o===void 0?Bce:o,b=e.activeClassName,S=b===void 0?"recharts-active-shape":b,i=e.isActive,P=kce(e,Rce),L;if(Jt.isValidElement(t))L=Jt.cloneElement(t,mw(mw({},P),jce(t)));else if(_i(t))L=t(P);else if(_ce(t)&&!bce(t)){var U=c(t,P);L=kt.createElement(mF,{shapeType:a,elementProps:U})}else{var V=P;L=kt.createElement(mF,{shapeType:a,elementProps:V})}return i?kt.createElement(mo,{className:S},L):L}function v2(e,t){return t!=null&&"trapezoids"in e.props}function x2(e,t){return t!=null&&"sectors"in e.props}function lx(e,t){return t!=null&&"points"in e.props}function Uce(e,t){var a,o,c=e.x===(t==null||(a=t.labelViewBox)===null||a===void 0?void 0:a.x)||e.x===t.x,b=e.y===(t==null||(o=t.labelViewBox)===null||o===void 0?void 0:o.y)||e.y===t.y;return c&&b}function Vce(e,t){var a=e.endAngle===t.endAngle,o=e.startAngle===t.startAngle;return a&&o}function qce(e,t){var a=e.x===t.x,o=e.y===t.y,c=e.z===t.z;return a&&o&&c}function Gce(e,t){var a;return v2(e,t)?a=Uce:x2(e,t)?a=Vce:lx(e,t)&&(a=qce),a}function $ce(e,t){var a;return v2(e,t)?a="trapezoids":x2(e,t)?a="sectors":lx(e,t)&&(a="points"),a}function Hce(e,t){if(v2(e,t)){var a;return(a=t.tooltipPayload)===null||a===void 0||(a=a[0])===null||a===void 0||(a=a.payload)===null||a===void 0?void 0:a.payload}if(x2(e,t)){var o;return(o=t.tooltipPayload)===null||o===void 0||(o=o[0])===null||o===void 0||(o=o.payload)===null||o===void 0?void 0:o.payload}return lx(e,t)?t.payload:{}}function Xce(e){var t=e.activeTooltipItem,a=e.graphicalItem,o=e.itemData,c=$ce(a,t),b=Hce(a,t),S=o.filter(function(P,L){var U=g2(b,P),V=a.props[c].filter(function(ie){var le=Gce(a,t);return le(ie,t)}),H=a.props[c].indexOf(V[V.length-1]),ee=L===H;return U&&ee}),i=o.indexOf(S[S.length-1]);return i}var VM,gF;function Yce(){if(gF)return VM;gF=1;var e=Math.ceil,t=Math.max;function a(o,c,b,S){for(var i=-1,P=t(e((c-o)/(b||1)),0),L=Array(P);P--;)L[S?P:++i]=o,o+=b;return L}return VM=a,VM}var qM,yF;function xq(){if(yF)return qM;yF=1;var e=e8(),t=1/0,a=17976931348623157e292;function o(c){if(!c)return c===0?c:0;if(c=e(c),c===t||c===-1/0){var b=c<0?-1:1;return b*a}return c===c?c:0}return qM=o,qM}var GM,_F;function Zce(){if(_F)return GM;_F=1;var e=Yce(),t=s2(),a=xq();function o(c){return function(b,S,i){return i&&typeof i!="number"&&t(b,S,i)&&(S=i=void 0),b=a(b),S===void 0?(S=b,b=0):S=a(S),i=i===void 0?b<S?1:-1:a(i),e(b,S,i,c)}}return GM=o,GM}var $M,vF;function Wce(){if(vF)return $M;vF=1;var e=Zce(),t=e();return $M=t,$M}var Kce=Wce();const gw=fa(Kce);function ux(e){"@babel/helpers - typeof";return ux=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ux(e)}function xF(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function bF(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?xF(Object(a),!0).forEach(function(o){bq(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):xF(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function bq(e,t,a){return t=Jce(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Jce(e){var t=Qce(e,"string");return ux(t)=="symbol"?t:t+""}function Qce(e,t){if(ux(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(ux(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ehe=["Webkit","Moz","O","ms"],the=function(t,a){var o=t.replace(/(\w)/,function(b){return b.toUpperCase()}),c=ehe.reduce(function(b,S){return bF(bF({},b),{},bq({},S+o,a))},{});return c[t]=a,c};function m_(e){"@babel/helpers - typeof";return m_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m_(e)}function yw(){return yw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},yw.apply(this,arguments)}function wF(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function HM(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?wF(Object(a),!0).forEach(function(o){Zu(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):wF(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function nhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SF(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Sq(o.key),o)}}function rhe(e,t,a){return t&&SF(e.prototype,t),a&&SF(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function ihe(e,t,a){return t=_w(t),ahe(e,wq()?Reflect.construct(t,a||[],_w(e).constructor):t.apply(e,a))}function ahe(e,t){if(t&&(m_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ohe(e)}function ohe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wq=function(){return!!e})()}function _w(e){return _w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},_w(e)}function she(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$I(e,t)}function $I(e,t){return $I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,c){return o.__proto__=c,o},$I(e,t)}function Zu(e,t,a){return t=Sq(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Sq(e){var t=lhe(e,"string");return m_(t)=="symbol"?t:t+""}function lhe(e,t){if(m_(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(m_(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var uhe=function(t){var a=t.data,o=t.startIndex,c=t.endIndex,b=t.x,S=t.width,i=t.travellerWidth;if(!a||!a.length)return{};var P=a.length,L=x0().domain(gw(0,P)).range([b,b+S-i]),U=L.domain().map(function(V){return L(V)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:L(o),endX:L(c),scale:L,scaleValues:U}},TF=function(t){return t.changedTouches&&!!t.changedTouches.length},g_=function(e){function t(a){var o;return nhe(this,t),o=ihe(this,t,[a]),Zu(o,"handleDrag",function(c){o.leaveTimer&&(clearTimeout(o.leaveTimer),o.leaveTimer=null),o.state.isTravellerMoving?o.handleTravellerMove(c):o.state.isSlideMoving&&o.handleSlideDrag(c)}),Zu(o,"handleTouchMove",function(c){c.changedTouches!=null&&c.changedTouches.length>0&&o.handleDrag(c.changedTouches[0])}),Zu(o,"handleDragEnd",function(){o.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var c=o.props,b=c.endIndex,S=c.onDragEnd,i=c.startIndex;S==null||S({endIndex:b,startIndex:i})}),o.detachDragEndListener()}),Zu(o,"handleLeaveWrapper",function(){(o.state.isTravellerMoving||o.state.isSlideMoving)&&(o.leaveTimer=window.setTimeout(o.handleDragEnd,o.props.leaveTimeOut))}),Zu(o,"handleEnterSlideOrTraveller",function(){o.setState({isTextActive:!0})}),Zu(o,"handleLeaveSlideOrTraveller",function(){o.setState({isTextActive:!1})}),Zu(o,"handleSlideDragStart",function(c){var b=TF(c)?c.changedTouches[0]:c;o.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:b.pageX}),o.attachDragEndListener()}),o.travellerDragStartHandlers={startX:o.handleTravellerDragStart.bind(o,"startX"),endX:o.handleTravellerDragStart.bind(o,"endX")},o.state={},o}return she(t,e),rhe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(o){var c=o.startX,b=o.endX,S=this.state.scaleValues,i=this.props,P=i.gap,L=i.data,U=L.length-1,V=Math.min(c,b),H=Math.max(c,b),ee=t.getIndexInRange(S,V),ie=t.getIndexInRange(S,H);return{startIndex:ee-ee%P,endIndex:ie===U?U:ie-ie%P}}},{key:"getTextOfTick",value:function(o){var c=this.props,b=c.data,S=c.tickFormatter,i=c.dataKey,P=Wl(b[o],i,o);return _i(S)?S(P,o):P}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(o){var c=this.state,b=c.slideMoveStartX,S=c.startX,i=c.endX,P=this.props,L=P.x,U=P.width,V=P.travellerWidth,H=P.startIndex,ee=P.endIndex,ie=P.onChange,le=o.pageX-b;le>0?le=Math.min(le,L+U-V-i,L+U-V-S):le<0&&(le=Math.max(le,L-S,L-i));var ue=this.getIndex({startX:S+le,endX:i+le});(ue.startIndex!==H||ue.endIndex!==ee)&&ie&&ie(ue),this.setState({startX:S+le,endX:i+le,slideMoveStartX:o.pageX})}},{key:"handleTravellerDragStart",value:function(o,c){var b=TF(c)?c.changedTouches[0]:c;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:o,brushMoveStartX:b.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(o){var c=this.state,b=c.brushMoveStartX,S=c.movingTravellerId,i=c.endX,P=c.startX,L=this.state[S],U=this.props,V=U.x,H=U.width,ee=U.travellerWidth,ie=U.onChange,le=U.gap,ue=U.data,ge={startX:this.state.startX,endX:this.state.endX},Se=o.pageX-b;Se>0?Se=Math.min(Se,V+H-ee-L):Se<0&&(Se=Math.max(Se,V-L)),ge[S]=L+Se;var ve=this.getIndex(ge),Ee=ve.startIndex,me=ve.endIndex,Ae=function(){var Ye=ue.length-1;return S==="startX"&&(i>P?Ee%le===0:me%le===0)||i<P&&me===Ye||S==="endX"&&(i>P?me%le===0:Ee%le===0)||i>P&&me===Ye};this.setState(Zu(Zu({},S,L+Se),"brushMoveStartX",o.pageX),function(){ie&&Ae()&&ie(ve)})}},{key:"handleTravellerMoveKeyboard",value:function(o,c){var b=this,S=this.state,i=S.scaleValues,P=S.startX,L=S.endX,U=this.state[c],V=i.indexOf(U);if(V!==-1){var H=V+o;if(!(H===-1||H>=i.length)){var ee=i[H];c==="startX"&&ee>=L||c==="endX"&&ee<=P||this.setState(Zu({},c,ee),function(){b.props.onChange(b.getIndex({startX:b.state.startX,endX:b.state.endX}))})}}}},{key:"renderBackground",value:function(){var o=this.props,c=o.x,b=o.y,S=o.width,i=o.height,P=o.fill,L=o.stroke;return kt.createElement("rect",{stroke:L,fill:P,x:c,y:b,width:S,height:i})}},{key:"renderPanorama",value:function(){var o=this.props,c=o.x,b=o.y,S=o.width,i=o.height,P=o.data,L=o.children,U=o.padding,V=Jt.Children.only(L);return V?kt.cloneElement(V,{x:c,y:b,width:S,height:i,margin:U,compact:!0,data:P}):null}},{key:"renderTravellerLayer",value:function(o,c){var b,S,i=this,P=this.props,L=P.y,U=P.travellerWidth,V=P.height,H=P.traveller,ee=P.ariaLabel,ie=P.data,le=P.startIndex,ue=P.endIndex,ge=Math.max(o,this.props.x),Se=HM(HM({},ji(this.props,!1)),{},{x:ge,y:L,width:U,height:V}),ve=ee||"Min value: ".concat((b=ie[le])===null||b===void 0?void 0:b.name,", Max value: ").concat((S=ie[ue])===null||S===void 0?void 0:S.name);return kt.createElement(mo,{tabIndex:0,role:"slider","aria-label":ve,"aria-valuenow":o,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[c],onTouchStart:this.travellerDragStartHandlers[c],onKeyDown:function(me){["ArrowLeft","ArrowRight"].includes(me.key)&&(me.preventDefault(),me.stopPropagation(),i.handleTravellerMoveKeyboard(me.key==="ArrowRight"?1:-1,c))},onFocus:function(){i.setState({isTravellerFocused:!0})},onBlur:function(){i.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(H,Se))}},{key:"renderSlide",value:function(o,c){var b=this.props,S=b.y,i=b.height,P=b.stroke,L=b.travellerWidth,U=Math.min(o,c)+L,V=Math.max(Math.abs(c-o)-L,0);return kt.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:P,fillOpacity:.2,x:U,y:S,width:V,height:i})}},{key:"renderText",value:function(){var o=this.props,c=o.startIndex,b=o.endIndex,S=o.y,i=o.height,P=o.travellerWidth,L=o.stroke,U=this.state,V=U.startX,H=U.endX,ee=5,ie={pointerEvents:"none",fill:L};return kt.createElement(mo,{className:"recharts-brush-texts"},kt.createElement(Xb,yw({textAnchor:"end",verticalAnchor:"middle",x:Math.min(V,H)-ee,y:S+i/2},ie),this.getTextOfTick(c)),kt.createElement(Xb,yw({textAnchor:"start",verticalAnchor:"middle",x:Math.max(V,H)+P+ee,y:S+i/2},ie),this.getTextOfTick(b)))}},{key:"render",value:function(){var o=this.props,c=o.data,b=o.className,S=o.children,i=o.x,P=o.y,L=o.width,U=o.height,V=o.alwaysShowText,H=this.state,ee=H.startX,ie=H.endX,le=H.isTextActive,ue=H.isSlideMoving,ge=H.isTravellerMoving,Se=H.isTravellerFocused;if(!c||!c.length||!er(i)||!er(P)||!er(L)||!er(U)||L<=0||U<=0)return null;var ve=ia("recharts-brush",b),Ee=kt.Children.count(S)===1,me=the("userSelect","none");return kt.createElement(mo,{className:ve,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:me},this.renderBackground(),Ee&&this.renderPanorama(),this.renderSlide(ee,ie),this.renderTravellerLayer(ee,"startX"),this.renderTravellerLayer(ie,"endX"),(le||ue||ge||Se||V)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(o){var c=o.x,b=o.y,S=o.width,i=o.height,P=o.stroke,L=Math.floor(b+i/2)-1;return kt.createElement(kt.Fragment,null,kt.createElement("rect",{x:c,y:b,width:S,height:i,fill:P,stroke:"none"}),kt.createElement("line",{x1:c+1,y1:L,x2:c+S-1,y2:L,fill:"none",stroke:"#fff"}),kt.createElement("line",{x1:c+1,y1:L+2,x2:c+S-1,y2:L+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(o,c){var b;return kt.isValidElement(o)?b=kt.cloneElement(o,c):_i(o)?b=o(c):b=t.renderDefaultTraveller(c),b}},{key:"getDerivedStateFromProps",value:function(o,c){var b=o.data,S=o.width,i=o.x,P=o.travellerWidth,L=o.updateId,U=o.startIndex,V=o.endIndex;if(b!==c.prevData||L!==c.prevUpdateId)return HM({prevData:b,prevTravellerWidth:P,prevUpdateId:L,prevX:i,prevWidth:S},b&&b.length?uhe({data:b,width:S,x:i,travellerWidth:P,startIndex:U,endIndex:V}):{scale:null,scaleValues:null});if(c.scale&&(S!==c.prevWidth||i!==c.prevX||P!==c.prevTravellerWidth)){c.scale.range([i,i+S-P]);var H=c.scale.domain().map(function(ee){return c.scale(ee)});return{prevData:b,prevTravellerWidth:P,prevUpdateId:L,prevX:i,prevWidth:S,startX:c.scale(o.startIndex),endX:c.scale(o.endIndex),scaleValues:H}}return null}},{key:"getIndexInRange",value:function(o,c){for(var b=o.length,S=0,i=b-1;i-S>1;){var P=Math.floor((S+i)/2);o[P]>c?i=P:S=P}return c>=o[i]?i:S}}])}(Jt.PureComponent);Zu(g_,"displayName","Brush");Zu(g_,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var XM,EF;function che(){if(EF)return XM;EF=1;var e=CP();function t(a,o){var c;return e(a,function(b,S,i){return c=o(b,S,i),!c}),!!c}return XM=t,XM}var YM,AF;function hhe(){if(AF)return YM;AF=1;var e=PV(),t=hm(),a=che(),o=Su(),c=s2();function b(S,i,P){var L=o(S)?e:a;return P&&c(S,i,P)&&(i=void 0),L(S,t(i,3))}return YM=b,YM}var fhe=hhe();const dhe=fa(fhe);var Ff=function(t,a){var o=t.alwaysShow,c=t.ifOverflow;return o&&(c="extendDomain"),c===a},ZM,MF;function phe(){if(MF)return ZM;MF=1;var e=ZV();function t(a,o,c){o=="__proto__"&&e?e(a,o,{configurable:!0,enumerable:!0,value:c,writable:!0}):a[o]=c}return ZM=t,ZM}var WM,OF;function mhe(){if(OF)return WM;OF=1;var e=phe(),t=XV(),a=hm();function o(c,b){var S={};return b=a(b,3),t(c,function(i,P,L){e(S,P,b(i,P,L))}),S}return WM=o,WM}var ghe=mhe();const yhe=fa(ghe);var KM,IF;function _he(){if(IF)return KM;IF=1;function e(t,a){for(var o=-1,c=t==null?0:t.length;++o<c;)if(!a(t[o],o,t))return!1;return!0}return KM=e,KM}var JM,CF;function vhe(){if(CF)return JM;CF=1;var e=CP();function t(a,o){var c=!0;return e(a,function(b,S,i){return c=!!o(b,S,i),c}),c}return JM=t,JM}var QM,PF;function xhe(){if(PF)return QM;PF=1;var e=_he(),t=vhe(),a=hm(),o=Su(),c=s2();function b(S,i,P){var L=o(S)?e:t;return P&&c(S,i,P)&&(i=void 0),L(S,a(i,3))}return QM=b,QM}var bhe=xhe();const Tq=fa(bhe);var whe=["x","y"];function cx(e){"@babel/helpers - typeof";return cx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cx(e)}function HI(){return HI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},HI.apply(this,arguments)}function RF(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function r0(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?RF(Object(a),!0).forEach(function(o){She(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):RF(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function She(e,t,a){return t=The(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function The(e){var t=Ehe(e,"string");return cx(t)=="symbol"?t:t+""}function Ehe(e,t){if(cx(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(cx(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ahe(e,t){if(e==null)return{};var a=Mhe(e,t),o,c;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(c=0;c<b.length;c++)o=b[c],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function Mhe(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function Ohe(e,t){var a=e.x,o=e.y,c=Ahe(e,whe),b="".concat(a),S=parseInt(b,10),i="".concat(o),P=parseInt(i,10),L="".concat(t.height||c.height),U=parseInt(L,10),V="".concat(t.width||c.width),H=parseInt(V,10);return r0(r0(r0(r0(r0({},t),c),S?{x:S}:{}),P?{y:P}:{}),{},{height:U,width:H,name:t.name,radius:t.radius})}function kF(e){return kt.createElement(GI,HI({shapeType:"rectangle",propTransformer:Ohe,activeClassName:"recharts-active-bar"},e))}var Ihe=function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(o,c){if(typeof t=="number")return t;var b=typeof o=="number";return b?t(o,c):(b||Eg(),a)}},Che=["value","background"],Eq;function y_(e){"@babel/helpers - typeof";return y_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y_(e)}function Phe(e,t){if(e==null)return{};var a=Rhe(e,t),o,c;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(c=0;c<b.length;c++)o=b[c],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function Rhe(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function vw(){return vw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},vw.apply(this,arguments)}function DF(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function Xo(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?DF(Object(a),!0).forEach(function(o){em(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):DF(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function khe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LF(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Mq(o.key),o)}}function Dhe(e,t,a){return t&&LF(e.prototype,t),a&&LF(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lhe(e,t,a){return t=xw(t),zhe(e,Aq()?Reflect.construct(t,a||[],xw(e).constructor):t.apply(e,a))}function zhe(e,t){if(t&&(y_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nhe(e)}function Nhe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Aq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Aq=function(){return!!e})()}function xw(e){return xw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},xw(e)}function Bhe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XI(e,t)}function XI(e,t){return XI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,c){return o.__proto__=c,o},XI(e,t)}function em(e,t,a){return t=Mq(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Mq(e){var t=Fhe(e,"string");return y_(t)=="symbol"?t:t+""}function Fhe(e,t){if(y_(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(y_(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var kg=function(e){function t(){var a;khe(this,t);for(var o=arguments.length,c=new Array(o),b=0;b<o;b++)c[b]=arguments[b];return a=Lhe(this,t,[].concat(c)),em(a,"state",{isAnimationFinished:!1}),em(a,"id",Ax("recharts-bar-")),em(a,"handleAnimationEnd",function(){var S=a.props.onAnimationEnd;a.setState({isAnimationFinished:!0}),S&&S()}),em(a,"handleAnimationStart",function(){var S=a.props.onAnimationStart;a.setState({isAnimationFinished:!1}),S&&S()}),a}return Bhe(t,e),Dhe(t,[{key:"renderRectanglesStatically",value:function(o){var c=this,b=this.props,S=b.shape,i=b.dataKey,P=b.activeIndex,L=b.activeBar,U=ji(this.props,!1);return o&&o.map(function(V,H){var ee=H===P,ie=ee?L:S,le=Xo(Xo(Xo({},U),V),{},{isActive:ee,option:ie,index:H,dataKey:i,onAnimationStart:c.handleAnimationStart,onAnimationEnd:c.handleAnimationEnd});return kt.createElement(mo,vw({className:"recharts-bar-rectangle"},k0(c.props,V,H),{key:"rectangle-".concat(V==null?void 0:V.x,"-").concat(V==null?void 0:V.y,"-").concat(V==null?void 0:V.value)}),kt.createElement(kF,le))})}},{key:"renderRectanglesWithAnimation",value:function(){var o=this,c=this.props,b=c.data,S=c.layout,i=c.isAnimationActive,P=c.animationBegin,L=c.animationDuration,U=c.animationEasing,V=c.animationId,H=this.state.prevData;return kt.createElement(Kd,{begin:P,duration:L,isActive:i,easing:U,from:{t:0},to:{t:1},key:"bar-".concat(V),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(ee){var ie=ee.t,le=b.map(function(ue,ge){var Se=H&&H[ge];if(Se){var ve=Cf(Se.x,ue.x),Ee=Cf(Se.y,ue.y),me=Cf(Se.width,ue.width),Ae=Cf(Se.height,ue.height);return Xo(Xo({},ue),{},{x:ve(ie),y:Ee(ie),width:me(ie),height:Ae(ie)})}if(S==="horizontal"){var Oe=Cf(0,ue.height),Ye=Oe(ie);return Xo(Xo({},ue),{},{y:ue.y+ue.height-Ye,height:Ye})}var He=Cf(0,ue.width),st=He(ie);return Xo(Xo({},ue),{},{width:st})});return kt.createElement(mo,null,o.renderRectanglesStatically(le))})}},{key:"renderRectangles",value:function(){var o=this.props,c=o.data,b=o.isAnimationActive,S=this.state.prevData;return b&&c&&c.length&&(!S||!g2(S,c))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(c)}},{key:"renderBackground",value:function(){var o=this,c=this.props,b=c.data,S=c.dataKey,i=c.activeIndex,P=ji(this.props.background,!1);return b.map(function(L,U){L.value;var V=L.background,H=Phe(L,Che);if(!V)return null;var ee=Xo(Xo(Xo(Xo(Xo({},H),{},{fill:"#eee"},V),P),k0(o.props,L,U)),{},{onAnimationStart:o.handleAnimationStart,onAnimationEnd:o.handleAnimationEnd,dataKey:S,index:U,className:"recharts-bar-background-rectangle"});return kt.createElement(kF,vw({key:"background-bar-".concat(U),option:o.props.background,isActive:U===i},ee))})}},{key:"renderErrorBar",value:function(o,c){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var b=this.props,S=b.data,i=b.xAxis,P=b.yAxis,L=b.layout,U=b.children,V=Ju(U,Rx);if(!V)return null;var H=L==="vertical"?S[0].height/2:S[0].width/2,ee=function(ue,ge){var Se=Array.isArray(ue.value)?ue.value[1]:ue.value;return{x:ue.x,y:ue.y,value:Se,errorVal:Wl(ue,ge)}},ie={clipPath:o?"url(#clipPath-".concat(c,")"):null};return kt.createElement(mo,ie,V.map(function(le){return kt.cloneElement(le,{key:"error-bar-".concat(c,"-").concat(le.props.dataKey),data:S,xAxis:i,yAxis:P,layout:L,offset:H,dataPointFormatter:ee})}))}},{key:"render",value:function(){var o=this.props,c=o.hide,b=o.data,S=o.className,i=o.xAxis,P=o.yAxis,L=o.left,U=o.top,V=o.width,H=o.height,ee=o.isAnimationActive,ie=o.background,le=o.id;if(c||!b||!b.length)return null;var ue=this.state.isAnimationFinished,ge=ia("recharts-bar",S),Se=i&&i.allowDataOverflow,ve=P&&P.allowDataOverflow,Ee=Se||ve,me=vi(le)?this.id:le;return kt.createElement(mo,{className:ge},Se||ve?kt.createElement("defs",null,kt.createElement("clipPath",{id:"clipPath-".concat(me)},kt.createElement("rect",{x:Se?L:L-V/2,y:ve?U:U-H/2,width:Se?V:V*2,height:ve?H:H*2}))):null,kt.createElement(mo,{className:"recharts-bar-rectangles",clipPath:Ee?"url(#clipPath-".concat(me,")"):null},ie?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(Ee,me),(!ee||ue)&&rm.renderCallByParent(this.props,b))}}],[{key:"getDerivedStateFromProps",value:function(o,c){return o.animationId!==c.prevAnimationId?{prevAnimationId:o.animationId,curData:o.data,prevData:c.curData}:o.data!==c.curData?{curData:o.data}:null}}])}(Jt.PureComponent);Eq=kg;em(kg,"displayName","Bar");em(kg,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!B_.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});em(kg,"getComposedData",function(e){var t=e.props,a=e.item,o=e.barPosition,c=e.bandSize,b=e.xAxis,S=e.yAxis,i=e.xAxisTicks,P=e.yAxisTicks,L=e.stackedData,U=e.dataStartIndex,V=e.displayedData,H=e.offset,ee=use(o,a);if(!ee)return null;var ie=t.layout,le=a.type.defaultProps,ue=le!==void 0?Xo(Xo({},le),a.props):a.props,ge=ue.dataKey,Se=ue.children,ve=ue.minPointSize,Ee=ie==="horizontal"?S:b,me=L?Ee.scale.domain():null,Ae=yse({numericAxis:Ee}),Oe=Ju(Se,kP),Ye=V.map(function(He,st){var Ke,Ot,Bt,Tt,mt,bt;L?Ke=cse(L[U+st],me):(Ke=Wl(He,ge),Array.isArray(Ke)||(Ke=[Ae,Ke]));var Ft=Ihe(ve,Eq.defaultProps.minPointSize)(Ke[1],st);if(ie==="horizontal"){var Zt,Vt=[S.scale(Ke[0]),S.scale(Ke[1])],Ze=Vt[0],Xt=Vt[1];Ot=bB({axis:b,ticks:i,bandSize:c,offset:ee.offset,entry:He,index:st}),Bt=(Zt=Xt??Ze)!==null&&Zt!==void 0?Zt:void 0,Tt=ee.size;var an=Ze-Xt;if(mt=Number.isNaN(an)?0:an,bt={x:Ot,y:S.y,width:Tt,height:S.height},Math.abs(Ft)>0&&Math.abs(mt)<Math.abs(Ft)){var qt=Rh(mt||Ft)*(Math.abs(Ft)-Math.abs(mt));Bt-=qt,mt+=qt}}else{var cn=[b.scale(Ke[0]),b.scale(Ke[1])],rr=cn[0],mr=cn[1];if(Ot=rr,Bt=bB({axis:S,ticks:P,bandSize:c,offset:ee.offset,entry:He,index:st}),Tt=mr-rr,mt=ee.size,bt={x:b.x,y:Bt,width:b.width,height:mt},Math.abs(Ft)>0&&Math.abs(Tt)<Math.abs(Ft)){var Ci=Rh(Tt||Ft)*(Math.abs(Ft)-Math.abs(Tt));Tt+=Ci}}return Xo(Xo(Xo({},He),{},{x:Ot,y:Bt,width:Tt,height:mt,value:L?Ke:Ke[1],payload:He,background:bt},Oe&&Oe[st]&&Oe[st].props),{},{tooltipPayload:[lq(a,He)],tooltipPosition:{x:Ot+Tt/2,y:Bt+mt/2}})});return Xo({data:Ye,layout:ie},H)});function hx(e){"@babel/helpers - typeof";return hx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hx(e)}function jhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zF(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Oq(o.key),o)}}function Uhe(e,t,a){return t&&zF(e.prototype,t),a&&zF(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function NF(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function Ch(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?NF(Object(a),!0).forEach(function(o){b2(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):NF(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function b2(e,t,a){return t=Oq(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Oq(e){var t=Vhe(e,"string");return hx(t)=="symbol"?t:t+""}function Vhe(e,t){if(hx(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(hx(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Iq=function(t,a,o,c,b){var S=t.width,i=t.height,P=t.layout,L=t.children,U=Object.keys(a),V={left:o.left,leftMirror:o.left,right:S-o.right,rightMirror:S-o.right,top:o.top,topMirror:o.top,bottom:i-o.bottom,bottomMirror:i-o.bottom},H=!!Wu(L,kg);return U.reduce(function(ee,ie){var le=a[ie],ue=le.orientation,ge=le.domain,Se=le.padding,ve=Se===void 0?{}:Se,Ee=le.mirror,me=le.reversed,Ae="".concat(ue).concat(Ee?"Mirror":""),Oe,Ye,He,st,Ke;if(le.type==="number"&&(le.padding==="gap"||le.padding==="no-gap")){var Ot=ge[1]-ge[0],Bt=1/0,Tt=le.categoricalDomain.sort();if(Tt.forEach(function(cn,rr){rr>0&&(Bt=Math.min((cn||0)-(Tt[rr-1]||0),Bt))}),Number.isFinite(Bt)){var mt=Bt/Ot,bt=le.layout==="vertical"?o.height:o.width;if(le.padding==="gap"&&(Oe=mt*bt/2),le.padding==="no-gap"){var Ft=Sg(t.barCategoryGap,mt*bt),Zt=mt*bt/2;Oe=Zt-Ft-(Zt-Ft)/bt*Ft}}}c==="xAxis"?Ye=[o.left+(ve.left||0)+(Oe||0),o.left+o.width-(ve.right||0)-(Oe||0)]:c==="yAxis"?Ye=P==="horizontal"?[o.top+o.height-(ve.bottom||0),o.top+(ve.top||0)]:[o.top+(ve.top||0)+(Oe||0),o.top+o.height-(ve.bottom||0)-(Oe||0)]:Ye=le.range,me&&(Ye=[Ye[1],Ye[0]]);var Vt=sse(le,b,H),Ze=Vt.scale,Xt=Vt.realScaleType;Ze.domain(ge).range(Ye),lse(Ze);var an=gse(Ze,Ch(Ch({},le),{},{realScaleType:Xt}));c==="xAxis"?(Ke=ue==="top"&&!Ee||ue==="bottom"&&Ee,He=o.left,st=V[Ae]-Ke*le.height):c==="yAxis"&&(Ke=ue==="left"&&!Ee||ue==="right"&&Ee,He=V[Ae]-Ke*le.width,st=o.top);var qt=Ch(Ch(Ch({},le),an),{},{realScaleType:Xt,x:He,y:st,scale:Ze,width:c==="xAxis"?o.width:le.width,height:c==="yAxis"?o.height:le.height});return qt.bandSize=sw(qt,an),!le.hide&&c==="xAxis"?V[Ae]+=(Ke?-1:1)*qt.height:le.hide||(V[Ae]+=(Ke?-1:1)*qt.width),Ch(Ch({},ee),{},b2({},ie,qt))},{})},Cq=function(t,a){var o=t.x,c=t.y,b=a.x,S=a.y;return{x:Math.min(o,b),y:Math.min(c,S),width:Math.abs(b-o),height:Math.abs(S-c)}},qhe=function(t){var a=t.x1,o=t.y1,c=t.x2,b=t.y2;return Cq({x:a,y:o},{x:c,y:b})},Pq=function(){function e(t){jhe(this,e),this.scale=t}return Uhe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=o.bandAware,b=o.position;if(a!==void 0){if(b)switch(b){case"start":return this.scale(a);case"middle":{var S=this.bandwidth?this.bandwidth()/2:0;return this.scale(a)+S}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(a)+i}default:return this.scale(a)}if(c){var P=this.bandwidth?this.bandwidth()/2:0;return this.scale(a)+P}return this.scale(a)}}},{key:"isInRange",value:function(a){var o=this.range(),c=o[0],b=o[o.length-1];return c<=b?a>=c&&a<=b:a>=b&&a<=c}}],[{key:"create",value:function(a){return new e(a)}}])}();b2(Pq,"EPS",1e-4);var oR=function(t){var a=Object.keys(t).reduce(function(o,c){return Ch(Ch({},o),{},b2({},c,Pq.create(t[c])))},{});return Ch(Ch({},a),{},{apply:function(c){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},S=b.bandAware,i=b.position;return yhe(c,function(P,L){return a[L].apply(P,{bandAware:S,position:i})})},isInRange:function(c){return Tq(c,function(b,S){return a[S].isInRange(b)})}})};function Ghe(e){return(e%180+180)%180}var $he=function(t){var a=t.width,o=t.height,c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=Ghe(c),S=b*Math.PI/180,i=Math.atan(o/a),P=S>i&&S<Math.PI-i?o/Math.sin(S):a/Math.cos(S);return Math.abs(P)},eO,BF;function Hhe(){if(BF)return eO;BF=1;var e=hm(),t=Mx(),a=a2();function o(c){return function(b,S,i){var P=Object(b);if(!t(b)){var L=e(S,3);b=a(b),S=function(V){return L(P[V],V,P)}}var U=c(b,S,i);return U>-1?P[L?b[U]:U]:void 0}}return eO=o,eO}var tO,FF;function Xhe(){if(FF)return tO;FF=1;var e=xq();function t(a){var o=e(a),c=o%1;return o===o?c?o-c:o:0}return tO=t,tO}var nO,jF;function Yhe(){if(jF)return nO;jF=1;var e=VV(),t=hm(),a=Xhe(),o=Math.max;function c(b,S,i){var P=b==null?0:b.length;if(!P)return-1;var L=i==null?0:a(i);return L<0&&(L=o(P+L,0)),e(b,t(S,3),L)}return nO=c,nO}var rO,UF;function Zhe(){if(UF)return rO;UF=1;var e=Hhe(),t=Yhe(),a=e(t);return rO=a,rO}var Whe=Zhe();const Khe=fa(Whe);var Jhe=iV();const Qhe=fa(Jhe);var efe=Qhe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),sR=Jt.createContext(void 0),lR=Jt.createContext(void 0),Rq=Jt.createContext(void 0),kq=Jt.createContext({}),Dq=Jt.createContext(void 0),Lq=Jt.createContext(0),zq=Jt.createContext(0),VF=function(t){var a=t.state,o=a.xAxisMap,c=a.yAxisMap,b=a.offset,S=t.clipPathId,i=t.children,P=t.width,L=t.height,U=efe(b);return kt.createElement(sR.Provider,{value:o},kt.createElement(lR.Provider,{value:c},kt.createElement(kq.Provider,{value:b},kt.createElement(Rq.Provider,{value:U},kt.createElement(Dq.Provider,{value:S},kt.createElement(Lq.Provider,{value:L},kt.createElement(zq.Provider,{value:P},i)))))))},tfe=function(){return Jt.useContext(Dq)},Nq=function(t){var a=Jt.useContext(sR);a==null&&Eg();var o=a[t];return o==null&&Eg(),o},nfe=function(){var t=Jt.useContext(sR);return Qp(t)},rfe=function(){var t=Jt.useContext(lR),a=Khe(t,function(o){return Tq(o.domain,Number.isFinite)});return a||Qp(t)},Bq=function(t){var a=Jt.useContext(lR);a==null&&Eg();var o=a[t];return o==null&&Eg(),o},ife=function(){var t=Jt.useContext(Rq);return t},afe=function(){return Jt.useContext(kq)},uR=function(){return Jt.useContext(zq)},cR=function(){return Jt.useContext(Lq)};function __(e){"@babel/helpers - typeof";return __=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},__(e)}function ofe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sfe(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,jq(o.key),o)}}function lfe(e,t,a){return t&&sfe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ufe(e,t,a){return t=bw(t),cfe(e,Fq()?Reflect.construct(t,a||[],bw(e).constructor):t.apply(e,a))}function cfe(e,t){if(t&&(__(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hfe(e)}function hfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Fq=function(){return!!e})()}function bw(e){return bw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},bw(e)}function ffe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YI(e,t)}function YI(e,t){return YI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,c){return o.__proto__=c,o},YI(e,t)}function qF(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function GF(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?qF(Object(a),!0).forEach(function(o){hR(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):qF(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function hR(e,t,a){return t=jq(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function jq(e){var t=dfe(e,"string");return __(t)=="symbol"?t:t+""}function dfe(e,t){if(__(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(__(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function pfe(e,t){return _fe(e)||yfe(e,t)||gfe(e,t)||mfe()}function mfe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gfe(e,t){if(e){if(typeof e=="string")return $F(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return $F(e,t)}}function $F(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function yfe(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,c,b,S,i=[],P=!0,L=!1;try{if(b=(a=a.call(e)).next,t!==0)for(;!(P=(o=b.call(a)).done)&&(i.push(o.value),i.length!==t);P=!0);}catch(U){L=!0,c=U}finally{try{if(!P&&a.return!=null&&(S=a.return(),Object(S)!==S))return}finally{if(L)throw c}}return i}}function _fe(e){if(Array.isArray(e))return e}function ZI(){return ZI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},ZI.apply(this,arguments)}var vfe=function(t,a){var o;return kt.isValidElement(t)?o=kt.cloneElement(t,a):_i(t)?o=t(a):o=kt.createElement("line",ZI({},a,{className:"recharts-reference-line-line"})),o},xfe=function(t,a,o,c,b,S,i,P,L){var U=b.x,V=b.y,H=b.width,ee=b.height;if(o){var ie=L.y,le=t.y.apply(ie,{position:S});if(Ff(L,"discard")&&!t.y.isInRange(le))return null;var ue=[{x:U+H,y:le},{x:U,y:le}];return P==="left"?ue.reverse():ue}if(a){var ge=L.x,Se=t.x.apply(ge,{position:S});if(Ff(L,"discard")&&!t.x.isInRange(Se))return null;var ve=[{x:Se,y:V+ee},{x:Se,y:V}];return i==="top"?ve.reverse():ve}if(c){var Ee=L.segment,me=Ee.map(function(Ae){return t.apply(Ae,{position:S})});return Ff(L,"discard")&&dhe(me,function(Ae){return!t.isInRange(Ae)})?null:me}return null};function bfe(e){var t=e.x,a=e.y,o=e.segment,c=e.xAxisId,b=e.yAxisId,S=e.shape,i=e.className,P=e.alwaysShow,L=tfe(),U=Nq(c),V=Bq(b),H=ife();if(!L||!H)return null;qd(P===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var ee=oR({x:U.scale,y:V.scale}),ie=os(t),le=os(a),ue=o&&o.length===2,ge=xfe(ee,ie,le,ue,H,e.position,U.orientation,V.orientation,e);if(!ge)return null;var Se=pfe(ge,2),ve=Se[0],Ee=ve.x,me=ve.y,Ae=Se[1],Oe=Ae.x,Ye=Ae.y,He=Ff(e,"hidden")?"url(#".concat(L,")"):void 0,st=GF(GF({clipPath:He},ji(e,!0)),{},{x1:Ee,y1:me,x2:Oe,y2:Ye});return kt.createElement(mo,{className:ia("recharts-reference-line",i)},vfe(S,st),wl.renderCallByParent(e,qhe({x1:Ee,y1:me,x2:Oe,y2:Ye})))}var fR=function(e){function t(){return ofe(this,t),ufe(this,t,arguments)}return ffe(t,e),lfe(t,[{key:"render",value:function(){return kt.createElement(bfe,this.props)}}])}(kt.Component);hR(fR,"displayName","ReferenceLine");hR(fR,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function WI(){return WI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},WI.apply(this,arguments)}function v_(e){"@babel/helpers - typeof";return v_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v_(e)}function HF(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function XF(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?HF(Object(a),!0).forEach(function(o){w2(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):HF(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function wfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sfe(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Vq(o.key),o)}}function Tfe(e,t,a){return t&&Sfe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Efe(e,t,a){return t=ww(t),Afe(e,Uq()?Reflect.construct(t,a||[],ww(e).constructor):t.apply(e,a))}function Afe(e,t){if(t&&(v_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mfe(e)}function Mfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Uq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Uq=function(){return!!e})()}function ww(e){return ww=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},ww(e)}function Ofe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KI(e,t)}function KI(e,t){return KI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,c){return o.__proto__=c,o},KI(e,t)}function w2(e,t,a){return t=Vq(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Vq(e){var t=Ife(e,"string");return v_(t)=="symbol"?t:t+""}function Ife(e,t){if(v_(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(v_(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Cfe=function(t){var a=t.x,o=t.y,c=t.xAxis,b=t.yAxis,S=oR({x:c.scale,y:b.scale}),i=S.apply({x:a,y:o},{bandAware:!0});return Ff(t,"discard")&&!S.isInRange(i)?null:i},S2=function(e){function t(){return wfe(this,t),Efe(this,t,arguments)}return Ofe(t,e),Tfe(t,[{key:"render",value:function(){var o=this.props,c=o.x,b=o.y,S=o.r,i=o.alwaysShow,P=o.clipPathId,L=os(c),U=os(b);if(qd(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!L||!U)return null;var V=Cfe(this.props);if(!V)return null;var H=V.x,ee=V.y,ie=this.props,le=ie.shape,ue=ie.className,ge=Ff(this.props,"hidden")?"url(#".concat(P,")"):void 0,Se=XF(XF({clipPath:ge},ji(this.props,!0)),{},{cx:H,cy:ee});return kt.createElement(mo,{className:ia("recharts-reference-dot",ue)},t.renderDot(le,Se),wl.renderCallByParent(this.props,{x:H-S,y:ee-S,width:2*S,height:2*S}))}}])}(kt.Component);w2(S2,"displayName","ReferenceDot");w2(S2,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});w2(S2,"renderDot",function(e,t){var a;return kt.isValidElement(e)?a=kt.cloneElement(e,t):_i(e)?a=e(t):a=kt.createElement(vq,WI({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),a});function JI(){return JI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},JI.apply(this,arguments)}function x_(e){"@babel/helpers - typeof";return x_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x_(e)}function YF(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function ZF(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?YF(Object(a),!0).forEach(function(o){T2(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):YF(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Pfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rfe(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Gq(o.key),o)}}function kfe(e,t,a){return t&&Rfe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dfe(e,t,a){return t=Sw(t),Lfe(e,qq()?Reflect.construct(t,a||[],Sw(e).constructor):t.apply(e,a))}function Lfe(e,t){if(t&&(x_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zfe(e)}function zfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qq=function(){return!!e})()}function Sw(e){return Sw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Sw(e)}function Nfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QI(e,t)}function QI(e,t){return QI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,c){return o.__proto__=c,o},QI(e,t)}function T2(e,t,a){return t=Gq(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Gq(e){var t=Bfe(e,"string");return x_(t)=="symbol"?t:t+""}function Bfe(e,t){if(x_(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(x_(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Ffe=function(t,a,o,c,b){var S=b.x1,i=b.x2,P=b.y1,L=b.y2,U=b.xAxis,V=b.yAxis;if(!U||!V)return null;var H=oR({x:U.scale,y:V.scale}),ee={x:t?H.x.apply(S,{position:"start"}):H.x.rangeMin,y:o?H.y.apply(P,{position:"start"}):H.y.rangeMin},ie={x:a?H.x.apply(i,{position:"end"}):H.x.rangeMax,y:c?H.y.apply(L,{position:"end"}):H.y.rangeMax};return Ff(b,"discard")&&(!H.isInRange(ee)||!H.isInRange(ie))?null:Cq(ee,ie)},E2=function(e){function t(){return Pfe(this,t),Dfe(this,t,arguments)}return Nfe(t,e),kfe(t,[{key:"render",value:function(){var o=this.props,c=o.x1,b=o.x2,S=o.y1,i=o.y2,P=o.className,L=o.alwaysShow,U=o.clipPathId;qd(L===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var V=os(c),H=os(b),ee=os(S),ie=os(i),le=this.props.shape;if(!V&&!H&&!ee&&!ie&&!le)return null;var ue=Ffe(V,H,ee,ie,this.props);if(!ue&&!le)return null;var ge=Ff(this.props,"hidden")?"url(#".concat(U,")"):void 0;return kt.createElement(mo,{className:ia("recharts-reference-area",P)},t.renderRect(le,ZF(ZF({clipPath:ge},ji(this.props,!0)),ue)),wl.renderCallByParent(this.props,ue))}}])}(kt.Component);T2(E2,"displayName","ReferenceArea");T2(E2,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});T2(E2,"renderRect",function(e,t){var a;return kt.isValidElement(e)?a=kt.cloneElement(e,t):_i(e)?a=e(t):a=kt.createElement(aR,JI({},t,{className:"recharts-reference-area-rect"})),a});function $q(e,t,a){if(t<1)return[];if(t===1&&a===void 0)return e;for(var o=[],c=0;c<e.length;c+=t)o.push(e[c]);return o}function jfe(e,t,a){var o={width:e.width+t.width,height:e.height+t.height};return $he(o,a)}function Ufe(e,t,a){var o=a==="width",c=e.x,b=e.y,S=e.width,i=e.height;return t===1?{start:o?c:b,end:o?c+S:b+i}:{start:o?c+S:b+i,end:o?c:b}}function Tw(e,t,a,o,c){if(e*t<e*o||e*t>e*c)return!1;var b=a();return e*(t-e*b/2-o)>=0&&e*(t+e*b/2-c)<=0}function Vfe(e,t){return $q(e,t+1)}function qfe(e,t,a,o,c){for(var b=(o||[]).slice(),S=t.start,i=t.end,P=0,L=1,U=S,V=function(){var ie=o==null?void 0:o[P];if(ie===void 0)return{v:$q(o,L)};var le=P,ue,ge=function(){return ue===void 0&&(ue=a(ie,le)),ue},Se=ie.coordinate,ve=P===0||Tw(e,Se,ge,U,i);ve||(P=0,U=S,L+=1),ve&&(U=Se+e*(ge()/2+c),P+=L)},H;L<=b.length;)if(H=V(),H)return H.v;return[]}function fx(e){"@babel/helpers - typeof";return fx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fx(e)}function WF(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function bl(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?WF(Object(a),!0).forEach(function(o){Gfe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):WF(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Gfe(e,t,a){return t=$fe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function $fe(e){var t=Hfe(e,"string");return fx(t)=="symbol"?t:t+""}function Hfe(e,t){if(fx(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(fx(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xfe(e,t,a,o,c){for(var b=(o||[]).slice(),S=b.length,i=t.start,P=t.end,L=function(H){var ee=b[H],ie,le=function(){return ie===void 0&&(ie=a(ee,H)),ie};if(H===S-1){var ue=e*(ee.coordinate+e*le()/2-P);b[H]=ee=bl(bl({},ee),{},{tickCoord:ue>0?ee.coordinate-ue*e:ee.coordinate})}else b[H]=ee=bl(bl({},ee),{},{tickCoord:ee.coordinate});var ge=Tw(e,ee.tickCoord,le,i,P);ge&&(P=ee.tickCoord-e*(le()/2+c),b[H]=bl(bl({},ee),{},{isShow:!0}))},U=S-1;U>=0;U--)L(U);return b}function Yfe(e,t,a,o,c,b){var S=(o||[]).slice(),i=S.length,P=t.start,L=t.end;if(b){var U=o[i-1],V=a(U,i-1),H=e*(U.coordinate+e*V/2-L);S[i-1]=U=bl(bl({},U),{},{tickCoord:H>0?U.coordinate-H*e:U.coordinate});var ee=Tw(e,U.tickCoord,function(){return V},P,L);ee&&(L=U.tickCoord-e*(V/2+c),S[i-1]=bl(bl({},U),{},{isShow:!0}))}for(var ie=b?i-1:i,le=function(Se){var ve=S[Se],Ee,me=function(){return Ee===void 0&&(Ee=a(ve,Se)),Ee};if(Se===0){var Ae=e*(ve.coordinate-e*me()/2-P);S[Se]=ve=bl(bl({},ve),{},{tickCoord:Ae<0?ve.coordinate-Ae*e:ve.coordinate})}else S[Se]=ve=bl(bl({},ve),{},{tickCoord:ve.coordinate});var Oe=Tw(e,ve.tickCoord,me,P,L);Oe&&(P=ve.tickCoord+e*(me()/2+c),S[Se]=bl(bl({},ve),{},{isShow:!0}))},ue=0;ue<ie;ue++)le(ue);return S}function dR(e,t,a){var o=e.tick,c=e.ticks,b=e.viewBox,S=e.minTickGap,i=e.orientation,P=e.interval,L=e.tickFormatter,U=e.unit,V=e.angle;if(!c||!c.length||!o)return[];if(er(P)||B_.isSsr)return Vfe(c,typeof P=="number"&&er(P)?P:0);var H=[],ee=i==="top"||i==="bottom"?"width":"height",ie=U&&ee==="width"?v0(U,{fontSize:t,letterSpacing:a}):{width:0,height:0},le=function(ve,Ee){var me=_i(L)?L(ve.value,Ee):ve.value;return ee==="width"?jfe(v0(me,{fontSize:t,letterSpacing:a}),ie,V):v0(me,{fontSize:t,letterSpacing:a})[ee]},ue=c.length>=2?Rh(c[1].coordinate-c[0].coordinate):1,ge=Ufe(b,ue,ee);return P==="equidistantPreserveStart"?qfe(ue,ge,le,c,S):(P==="preserveStart"||P==="preserveStartEnd"?H=Yfe(ue,ge,le,c,S,P==="preserveStartEnd"):H=Xfe(ue,ge,le,c,S),H.filter(function(Se){return Se.isShow}))}var Zfe=["viewBox"],Wfe=["viewBox"],Kfe=["ticks"];function b_(e){"@babel/helpers - typeof";return b_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b_(e)}function Xy(){return Xy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},Xy.apply(this,arguments)}function KF(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function Hl(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?KF(Object(a),!0).forEach(function(o){pR(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):KF(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function iO(e,t){if(e==null)return{};var a=Jfe(e,t),o,c;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(c=0;c<b.length;c++)o=b[c],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function Jfe(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function Qfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JF(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Xq(o.key),o)}}function ede(e,t,a){return t&&JF(e.prototype,t),a&&JF(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function tde(e,t,a){return t=Ew(t),nde(e,Hq()?Reflect.construct(t,a||[],Ew(e).constructor):t.apply(e,a))}function nde(e,t){if(t&&(b_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rde(e)}function rde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Hq=function(){return!!e})()}function Ew(e){return Ew=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Ew(e)}function ide(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eC(e,t)}function eC(e,t){return eC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,c){return o.__proto__=c,o},eC(e,t)}function pR(e,t,a){return t=Xq(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Xq(e){var t=ade(e,"string");return b_(t)=="symbol"?t:t+""}function ade(e,t){if(b_(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(b_(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var V_=function(e){function t(a){var o;return Qfe(this,t),o=tde(this,t,[a]),o.state={fontSize:"",letterSpacing:""},o}return ide(t,e),ede(t,[{key:"shouldComponentUpdate",value:function(o,c){var b=o.viewBox,S=iO(o,Zfe),i=this.props,P=i.viewBox,L=iO(i,Wfe);return!Ky(b,P)||!Ky(S,L)||!Ky(c,this.state)}},{key:"componentDidMount",value:function(){var o=this.layerReference;if(o){var c=o.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];c&&this.setState({fontSize:window.getComputedStyle(c).fontSize,letterSpacing:window.getComputedStyle(c).letterSpacing})}}},{key:"getTickLineCoord",value:function(o){var c=this.props,b=c.x,S=c.y,i=c.width,P=c.height,L=c.orientation,U=c.tickSize,V=c.mirror,H=c.tickMargin,ee,ie,le,ue,ge,Se,ve=V?-1:1,Ee=o.tickSize||U,me=er(o.tickCoord)?o.tickCoord:o.coordinate;switch(L){case"top":ee=ie=o.coordinate,ue=S+ +!V*P,le=ue-ve*Ee,Se=le-ve*H,ge=me;break;case"left":le=ue=o.coordinate,ie=b+ +!V*i,ee=ie-ve*Ee,ge=ee-ve*H,Se=me;break;case"right":le=ue=o.coordinate,ie=b+ +V*i,ee=ie+ve*Ee,ge=ee+ve*H,Se=me;break;default:ee=ie=o.coordinate,ue=S+ +V*P,le=ue+ve*Ee,Se=le+ve*H,ge=me;break}return{line:{x1:ee,y1:le,x2:ie,y2:ue},tick:{x:ge,y:Se}}}},{key:"getTickTextAnchor",value:function(){var o=this.props,c=o.orientation,b=o.mirror,S;switch(c){case"left":S=b?"start":"end";break;case"right":S=b?"end":"start";break;default:S="middle";break}return S}},{key:"getTickVerticalAnchor",value:function(){var o=this.props,c=o.orientation,b=o.mirror,S="end";switch(c){case"left":case"right":S="middle";break;case"top":S=b?"start":"end";break;default:S=b?"end":"start";break}return S}},{key:"renderAxisLine",value:function(){var o=this.props,c=o.x,b=o.y,S=o.width,i=o.height,P=o.orientation,L=o.mirror,U=o.axisLine,V=Hl(Hl(Hl({},ji(this.props,!1)),ji(U,!1)),{},{fill:"none"});if(P==="top"||P==="bottom"){var H=+(P==="top"&&!L||P==="bottom"&&L);V=Hl(Hl({},V),{},{x1:c,y1:b+H*i,x2:c+S,y2:b+H*i})}else{var ee=+(P==="left"&&!L||P==="right"&&L);V=Hl(Hl({},V),{},{x1:c+ee*S,y1:b,x2:c+ee*S,y2:b+i})}return kt.createElement("line",Xy({},V,{className:ia("recharts-cartesian-axis-line",$c(U,"className"))}))}},{key:"renderTicks",value:function(o,c,b){var S=this,i=this.props,P=i.tickLine,L=i.stroke,U=i.tick,V=i.tickFormatter,H=i.unit,ee=dR(Hl(Hl({},this.props),{},{ticks:o}),c,b),ie=this.getTickTextAnchor(),le=this.getTickVerticalAnchor(),ue=ji(this.props,!1),ge=ji(U,!1),Se=Hl(Hl({},ue),{},{fill:"none"},ji(P,!1)),ve=ee.map(function(Ee,me){var Ae=S.getTickLineCoord(Ee),Oe=Ae.line,Ye=Ae.tick,He=Hl(Hl(Hl(Hl({textAnchor:ie,verticalAnchor:le},ue),{},{stroke:"none",fill:L},ge),Ye),{},{index:me,payload:Ee,visibleTicksCount:ee.length,tickFormatter:V});return kt.createElement(mo,Xy({className:"recharts-cartesian-axis-tick",key:"tick-".concat(Ee.value,"-").concat(Ee.coordinate,"-").concat(Ee.tickCoord)},k0(S.props,Ee,me)),P&&kt.createElement("line",Xy({},Se,Oe,{className:ia("recharts-cartesian-axis-tick-line",$c(P,"className"))})),U&&t.renderTickItem(U,He,"".concat(_i(V)?V(Ee.value,me):Ee.value).concat(H||"")))});return kt.createElement("g",{className:"recharts-cartesian-axis-ticks"},ve)}},{key:"render",value:function(){var o=this,c=this.props,b=c.axisLine,S=c.width,i=c.height,P=c.ticksGenerator,L=c.className,U=c.hide;if(U)return null;var V=this.props,H=V.ticks,ee=iO(V,Kfe),ie=H;return _i(P)&&(ie=H&&H.length>0?P(this.props):P(ee)),S<=0||i<=0||!ie||!ie.length?null:kt.createElement(mo,{className:ia("recharts-cartesian-axis",L),ref:function(ue){o.layerReference=ue}},b&&this.renderAxisLine(),this.renderTicks(ie,this.state.fontSize,this.state.letterSpacing),wl.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(o,c,b){var S;return kt.isValidElement(o)?S=kt.cloneElement(o,c):_i(o)?S=o(c):S=kt.createElement(Xb,Xy({},c,{className:"recharts-cartesian-axis-tick-value"}),b),S}}])}(Jt.Component);pR(V_,"displayName","CartesianAxis");pR(V_,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var ode=["x1","y1","x2","y2","key"],sde=["offset"];function Ag(e){"@babel/helpers - typeof";return Ag=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ag(e)}function QF(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function Sl(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?QF(Object(a),!0).forEach(function(o){lde(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):QF(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function lde(e,t,a){return t=ude(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ude(e){var t=cde(e,"string");return Ag(t)=="symbol"?t:t+""}function cde(e,t){if(Ag(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(Ag(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gg(){return gg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},gg.apply(this,arguments)}function ej(e,t){if(e==null)return{};var a=hde(e,t),o,c;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(c=0;c<b.length;c++)o=b[c],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function hde(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}var fde=function(t){var a=t.fill;if(!a||a==="none")return null;var o=t.fillOpacity,c=t.x,b=t.y,S=t.width,i=t.height,P=t.ry;return kt.createElement("rect",{x:c,y:b,ry:P,width:S,height:i,stroke:"none",fill:a,fillOpacity:o,className:"recharts-cartesian-grid-bg"})};function Yq(e,t){var a;if(kt.isValidElement(e))a=kt.cloneElement(e,t);else if(_i(e))a=e(t);else{var o=t.x1,c=t.y1,b=t.x2,S=t.y2,i=t.key,P=ej(t,ode),L=ji(P,!1);L.offset;var U=ej(L,sde);a=kt.createElement("line",gg({},U,{x1:o,y1:c,x2:b,y2:S,fill:"none",key:i}))}return a}function dde(e){var t=e.x,a=e.width,o=e.horizontal,c=o===void 0?!0:o,b=e.horizontalPoints;if(!c||!b||!b.length)return null;var S=b.map(function(i,P){var L=Sl(Sl({},e),{},{x1:t,y1:i,x2:t+a,y2:i,key:"line-".concat(P),index:P});return Yq(c,L)});return kt.createElement("g",{className:"recharts-cartesian-grid-horizontal"},S)}function pde(e){var t=e.y,a=e.height,o=e.vertical,c=o===void 0?!0:o,b=e.verticalPoints;if(!c||!b||!b.length)return null;var S=b.map(function(i,P){var L=Sl(Sl({},e),{},{x1:i,y1:t,x2:i,y2:t+a,key:"line-".concat(P),index:P});return Yq(c,L)});return kt.createElement("g",{className:"recharts-cartesian-grid-vertical"},S)}function mde(e){var t=e.horizontalFill,a=e.fillOpacity,o=e.x,c=e.y,b=e.width,S=e.height,i=e.horizontalPoints,P=e.horizontal,L=P===void 0?!0:P;if(!L||!t||!t.length)return null;var U=i.map(function(H){return Math.round(H+c-c)}).sort(function(H,ee){return H-ee});c!==U[0]&&U.unshift(0);var V=U.map(function(H,ee){var ie=!U[ee+1],le=ie?c+S-H:U[ee+1]-H;if(le<=0)return null;var ue=ee%t.length;return kt.createElement("rect",{key:"react-".concat(ee),y:H,x:o,height:le,width:b,stroke:"none",fill:t[ue],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return kt.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},V)}function gde(e){var t=e.vertical,a=t===void 0?!0:t,o=e.verticalFill,c=e.fillOpacity,b=e.x,S=e.y,i=e.width,P=e.height,L=e.verticalPoints;if(!a||!o||!o.length)return null;var U=L.map(function(H){return Math.round(H+b-b)}).sort(function(H,ee){return H-ee});b!==U[0]&&U.unshift(0);var V=U.map(function(H,ee){var ie=!U[ee+1],le=ie?b+i-H:U[ee+1]-H;if(le<=0)return null;var ue=ee%o.length;return kt.createElement("rect",{key:"react-".concat(ee),x:H,y:S,width:le,height:P,stroke:"none",fill:o[ue],fillOpacity:c,className:"recharts-cartesian-grid-bg"})});return kt.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},V)}var yde=function(t,a){var o=t.xAxis,c=t.width,b=t.height,S=t.offset;return oq(dR(Sl(Sl(Sl({},V_.defaultProps),o),{},{ticks:Fd(o,!0),viewBox:{x:0,y:0,width:c,height:b}})),S.left,S.left+S.width,a)},_de=function(t,a){var o=t.yAxis,c=t.width,b=t.height,S=t.offset;return oq(dR(Sl(Sl(Sl({},V_.defaultProps),o),{},{ticks:Fd(o,!0),viewBox:{x:0,y:0,width:c,height:b}})),S.top,S.top+S.height,a)},zy={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function Zq(e){var t,a,o,c,b,S,i=uR(),P=cR(),L=afe(),U=Sl(Sl({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:zy.stroke,fill:(a=e.fill)!==null&&a!==void 0?a:zy.fill,horizontal:(o=e.horizontal)!==null&&o!==void 0?o:zy.horizontal,horizontalFill:(c=e.horizontalFill)!==null&&c!==void 0?c:zy.horizontalFill,vertical:(b=e.vertical)!==null&&b!==void 0?b:zy.vertical,verticalFill:(S=e.verticalFill)!==null&&S!==void 0?S:zy.verticalFill,x:er(e.x)?e.x:L.left,y:er(e.y)?e.y:L.top,width:er(e.width)?e.width:L.width,height:er(e.height)?e.height:L.height}),V=U.x,H=U.y,ee=U.width,ie=U.height,le=U.syncWithTicks,ue=U.horizontalValues,ge=U.verticalValues,Se=nfe(),ve=rfe();if(!er(ee)||ee<=0||!er(ie)||ie<=0||!er(V)||V!==+V||!er(H)||H!==+H)return null;var Ee=U.verticalCoordinatesGenerator||yde,me=U.horizontalCoordinatesGenerator||_de,Ae=U.horizontalPoints,Oe=U.verticalPoints;if((!Ae||!Ae.length)&&_i(me)){var Ye=ue&&ue.length,He=me({yAxis:ve?Sl(Sl({},ve),{},{ticks:Ye?ue:ve.ticks}):void 0,width:i,height:P,offset:L},Ye?!0:le);qd(Array.isArray(He),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Ag(He),"]")),Array.isArray(He)&&(Ae=He)}if((!Oe||!Oe.length)&&_i(Ee)){var st=ge&&ge.length,Ke=Ee({xAxis:Se?Sl(Sl({},Se),{},{ticks:st?ge:Se.ticks}):void 0,width:i,height:P,offset:L},st?!0:le);qd(Array.isArray(Ke),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Ag(Ke),"]")),Array.isArray(Ke)&&(Oe=Ke)}return kt.createElement("g",{className:"recharts-cartesian-grid"},kt.createElement(fde,{fill:U.fill,fillOpacity:U.fillOpacity,x:U.x,y:U.y,width:U.width,height:U.height,ry:U.ry}),kt.createElement(dde,gg({},U,{offset:L,horizontalPoints:Ae,xAxis:Se,yAxis:ve})),kt.createElement(pde,gg({},U,{offset:L,verticalPoints:Oe,xAxis:Se,yAxis:ve})),kt.createElement(mde,gg({},U,{horizontalPoints:Ae})),kt.createElement(gde,gg({},U,{verticalPoints:Oe})))}Zq.displayName="CartesianGrid";function w_(e){"@babel/helpers - typeof";return w_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w_(e)}function vde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xde(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Jq(o.key),o)}}function bde(e,t,a){return t&&xde(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function wde(e,t,a){return t=Aw(t),Sde(e,Wq()?Reflect.construct(t,a||[],Aw(e).constructor):t.apply(e,a))}function Sde(e,t){if(t&&(w_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tde(e)}function Tde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Wq=function(){return!!e})()}function Aw(e){return Aw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Aw(e)}function Ede(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tC(e,t)}function tC(e,t){return tC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,c){return o.__proto__=c,o},tC(e,t)}function Kq(e,t,a){return t=Jq(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Jq(e){var t=Ade(e,"string");return w_(t)=="symbol"?t:t+""}function Ade(e,t){if(w_(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(w_(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var kx=function(e){function t(){return vde(this,t),wde(this,t,arguments)}return Ede(t,e),bde(t,[{key:"render",value:function(){return null}}])}(kt.Component);Kq(kx,"displayName","ZAxis");Kq(kx,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var Mde=["option","isActive"];function S0(){return S0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},S0.apply(this,arguments)}function Ode(e,t){if(e==null)return{};var a=Ide(e,t),o,c;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(c=0;c<b.length;c++)o=b[c],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function Ide(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function Cde(e){var t=e.option,a=e.isActive,o=Ode(e,Mde);return typeof t=="string"?kt.createElement(GI,S0({option:kt.createElement(i2,S0({type:t},o)),isActive:a,shapeType:"symbols"},o)):kt.createElement(GI,S0({option:t,isActive:a,shapeType:"symbols"},o))}function S_(e){"@babel/helpers - typeof";return S_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S_(e)}function T0(){return T0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},T0.apply(this,arguments)}function tj(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function Vc(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?tj(Object(a),!0).forEach(function(o){tm(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):tj(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Pde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nj(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,e7(o.key),o)}}function Rde(e,t,a){return t&&nj(e.prototype,t),a&&nj(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function kde(e,t,a){return t=Mw(t),Dde(e,Qq()?Reflect.construct(t,a||[],Mw(e).constructor):t.apply(e,a))}function Dde(e,t){if(t&&(S_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lde(e)}function Lde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Qq=function(){return!!e})()}function Mw(e){return Mw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Mw(e)}function zde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nC(e,t)}function nC(e,t){return nC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,c){return o.__proto__=c,o},nC(e,t)}function tm(e,t,a){return t=e7(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function e7(e){var t=Nde(e,"string");return S_(t)=="symbol"?t:t+""}function Nde(e,t){if(S_(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(S_(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Dx=function(e){function t(){var a;Pde(this,t);for(var o=arguments.length,c=new Array(o),b=0;b<o;b++)c[b]=arguments[b];return a=kde(this,t,[].concat(c)),tm(a,"state",{isAnimationFinished:!1}),tm(a,"handleAnimationEnd",function(){a.setState({isAnimationFinished:!0})}),tm(a,"handleAnimationStart",function(){a.setState({isAnimationFinished:!1})}),tm(a,"id",Ax("recharts-scatter-")),a}return zde(t,e),Rde(t,[{key:"renderSymbolsStatically",value:function(o){var c=this,b=this.props,S=b.shape,i=b.activeShape,P=b.activeIndex,L=ji(this.props,!1);return o.map(function(U,V){var H=P===V,ee=H?i:S,ie=Vc(Vc({},L),U);return kt.createElement(mo,T0({className:"recharts-scatter-symbol",key:"symbol-".concat(U==null?void 0:U.cx,"-").concat(U==null?void 0:U.cy,"-").concat(U==null?void 0:U.size,"-").concat(V)},k0(c.props,U,V),{role:"img"}),kt.createElement(Cde,T0({option:ee,isActive:H,key:"symbol-".concat(V)},ie)))})}},{key:"renderSymbolsWithAnimation",value:function(){var o=this,c=this.props,b=c.points,S=c.isAnimationActive,i=c.animationBegin,P=c.animationDuration,L=c.animationEasing,U=c.animationId,V=this.state.prevPoints;return kt.createElement(Kd,{begin:i,duration:P,isActive:S,easing:L,from:{t:0},to:{t:1},key:"pie-".concat(U),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(H){var ee=H.t,ie=b.map(function(le,ue){var ge=V&&V[ue];if(ge){var Se=Cf(ge.cx,le.cx),ve=Cf(ge.cy,le.cy),Ee=Cf(ge.size,le.size);return Vc(Vc({},le),{},{cx:Se(ee),cy:ve(ee),size:Ee(ee)})}var me=Cf(0,le.size);return Vc(Vc({},le),{},{size:me(ee)})});return kt.createElement(mo,null,o.renderSymbolsStatically(ie))})}},{key:"renderSymbols",value:function(){var o=this.props,c=o.points,b=o.isAnimationActive,S=this.state.prevPoints;return b&&c&&c.length&&(!S||!g2(S,c))?this.renderSymbolsWithAnimation():this.renderSymbolsStatically(c)}},{key:"renderErrorBar",value:function(){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var c=this.props,b=c.points,S=c.xAxis,i=c.yAxis,P=c.children,L=Ju(P,Rx);return L?L.map(function(U,V){var H=U.props,ee=H.direction,ie=H.dataKey;return kt.cloneElement(U,{key:"".concat(ee,"-").concat(ie,"-").concat(b[V]),data:b,xAxis:S,yAxis:i,layout:ee==="x"?"vertical":"horizontal",dataPointFormatter:function(ue,ge){return{x:ue.cx,y:ue.cy,value:ee==="x"?+ue.node.x:+ue.node.y,errorVal:Wl(ue,ge)}}})}):null}},{key:"renderLine",value:function(){var o=this.props,c=o.points,b=o.line,S=o.lineType,i=o.lineJointType,P=ji(this.props,!1),L=ji(b,!1),U,V;if(S==="joint")U=c.map(function(ve){return{x:ve.cx,y:ve.cy}});else if(S==="fitting"){var H=YJ(c),ee=H.xmin,ie=H.xmax,le=H.a,ue=H.b,ge=function(Ee){return le*Ee+ue};U=[{x:ee,y:ge(ee)},{x:ie,y:ge(ie)}]}var Se=Vc(Vc(Vc({},P),{},{fill:"none",stroke:P&&P.fill},L),{},{points:U});return kt.isValidElement(b)?V=kt.cloneElement(b,Se):_i(b)?V=b(Se):V=kt.createElement(RI,T0({},Se,{type:i})),kt.createElement(mo,{className:"recharts-scatter-line",key:"recharts-scatter-line"},V)}},{key:"render",value:function(){var o=this.props,c=o.hide,b=o.points,S=o.line,i=o.className,P=o.xAxis,L=o.yAxis,U=o.left,V=o.top,H=o.width,ee=o.height,ie=o.id,le=o.isAnimationActive;if(c||!b||!b.length)return null;var ue=this.state.isAnimationFinished,ge=ia("recharts-scatter",i),Se=P&&P.allowDataOverflow,ve=L&&L.allowDataOverflow,Ee=Se||ve,me=vi(ie)?this.id:ie;return kt.createElement(mo,{className:ge,clipPath:Ee?"url(#clipPath-".concat(me,")"):null},Se||ve?kt.createElement("defs",null,kt.createElement("clipPath",{id:"clipPath-".concat(me)},kt.createElement("rect",{x:Se?U:U-H/2,y:ve?V:V-ee/2,width:Se?H:H*2,height:ve?ee:ee*2}))):null,S&&this.renderLine(),this.renderErrorBar(),kt.createElement(mo,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!le||ue)&&rm.renderCallByParent(this.props,b))}}],[{key:"getDerivedStateFromProps",value:function(o,c){return o.animationId!==c.prevAnimationId?{prevAnimationId:o.animationId,curPoints:o.points,prevPoints:c.curPoints}:o.points!==c.curPoints?{curPoints:o.points}:null}}])}(Jt.PureComponent);tm(Dx,"displayName","Scatter");tm(Dx,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!B_.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"});tm(Dx,"getComposedData",function(e){var t=e.xAxis,a=e.yAxis,o=e.zAxis,c=e.item,b=e.displayedData,S=e.xAxisTicks,i=e.yAxisTicks,P=e.offset,L=c.props.tooltipType,U=Ju(c.props.children,kP),V=vi(t.dataKey)?c.props.dataKey:t.dataKey,H=vi(a.dataKey)?c.props.dataKey:a.dataKey,ee=o&&o.dataKey,ie=o?o.range:kx.defaultProps.range,le=ie&&ie[0],ue=t.scale.bandwidth?t.scale.bandwidth():0,ge=a.scale.bandwidth?a.scale.bandwidth():0,Se=b.map(function(ve,Ee){var me=Wl(ve,V),Ae=Wl(ve,H),Oe=!vi(ee)&&Wl(ve,ee)||"-",Ye=[{name:vi(t.dataKey)?c.props.name:t.name||t.dataKey,unit:t.unit||"",value:me,payload:ve,dataKey:V,type:L},{name:vi(a.dataKey)?c.props.name:a.name||a.dataKey,unit:a.unit||"",value:Ae,payload:ve,dataKey:H,type:L}];Oe!=="-"&&Ye.push({name:o.name||o.dataKey,unit:o.unit||"",value:Oe,payload:ve,dataKey:ee,type:L});var He=xB({axis:t,ticks:S,bandSize:ue,entry:ve,index:Ee,dataKey:V}),st=xB({axis:a,ticks:i,bandSize:ge,entry:ve,index:Ee,dataKey:H}),Ke=Oe!=="-"?o.scale(Oe):le,Ot=Math.sqrt(Math.max(Ke,0)/Math.PI);return Vc(Vc({},ve),{},{cx:He,cy:st,x:He-Ot,y:st-Ot,xAxis:t,yAxis:a,zAxis:o,width:2*Ot,height:2*Ot,size:Ke,node:{x:me,y:Ae,z:Oe},tooltipPayload:Ye,tooltipPosition:{x:He,y:st},payload:ve},U&&U[Ee]&&U[Ee].props)});return Vc({points:Se},P)});function T_(e){"@babel/helpers - typeof";return T_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T_(e)}function Bde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fde(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,r7(o.key),o)}}function jde(e,t,a){return t&&Fde(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ude(e,t,a){return t=Ow(t),Vde(e,t7()?Reflect.construct(t,a||[],Ow(e).constructor):t.apply(e,a))}function Vde(e,t){if(t&&(T_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qde(e)}function qde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function t7(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(t7=function(){return!!e})()}function Ow(e){return Ow=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Ow(e)}function Gde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rC(e,t)}function rC(e,t){return rC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,c){return o.__proto__=c,o},rC(e,t)}function n7(e,t,a){return t=r7(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r7(e){var t=$de(e,"string");return T_(t)=="symbol"?t:t+""}function $de(e,t){if(T_(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(T_(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function iC(){return iC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},iC.apply(this,arguments)}function Hde(e){var t=e.xAxisId,a=uR(),o=cR(),c=Nq(t);return c==null?null:kt.createElement(V_,iC({},c,{className:ia("recharts-".concat(c.axisType," ").concat(c.axisType),c.className),viewBox:{x:0,y:0,width:a,height:o},ticksGenerator:function(S){return Fd(S,!0)}}))}var q_=function(e){function t(){return Bde(this,t),Ude(this,t,arguments)}return Gde(t,e),jde(t,[{key:"render",value:function(){return kt.createElement(Hde,this.props)}}])}(kt.Component);n7(q_,"displayName","XAxis");n7(q_,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function E_(e){"@babel/helpers - typeof";return E_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E_(e)}function Xde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yde(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o7(o.key),o)}}function Zde(e,t,a){return t&&Yde(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wde(e,t,a){return t=Iw(t),Kde(e,i7()?Reflect.construct(t,a||[],Iw(e).constructor):t.apply(e,a))}function Kde(e,t){if(t&&(E_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jde(e)}function Jde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function i7(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(i7=function(){return!!e})()}function Iw(e){return Iw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Iw(e)}function Qde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aC(e,t)}function aC(e,t){return aC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,c){return o.__proto__=c,o},aC(e,t)}function a7(e,t,a){return t=o7(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o7(e){var t=epe(e,"string");return E_(t)=="symbol"?t:t+""}function epe(e,t){if(E_(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(E_(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function oC(){return oC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},oC.apply(this,arguments)}var tpe=function(t){var a=t.yAxisId,o=uR(),c=cR(),b=Bq(a);return b==null?null:kt.createElement(V_,oC({},b,{className:ia("recharts-".concat(b.axisType," ").concat(b.axisType),b.className),viewBox:{x:0,y:0,width:o,height:c},ticksGenerator:function(i){return Fd(i,!0)}}))},G_=function(e){function t(){return Xde(this,t),Wde(this,t,arguments)}return Qde(t,e),Zde(t,[{key:"render",value:function(){return kt.createElement(tpe,this.props)}}])}(kt.Component);a7(G_,"displayName","YAxis");a7(G_,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function rj(e){return ape(e)||ipe(e)||rpe(e)||npe()}function npe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rpe(e,t){if(e){if(typeof e=="string")return sC(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return sC(e,t)}}function ipe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ape(e){if(Array.isArray(e))return sC(e)}function sC(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}var lC=function(t,a,o,c,b){var S=Ju(t,fR),i=Ju(t,S2),P=[].concat(rj(S),rj(i)),L=Ju(t,E2),U="".concat(c,"Id"),V=c[0],H=a;if(P.length&&(H=P.reduce(function(le,ue){if(ue.props[U]===o&&Ff(ue.props,"extendDomain")&&er(ue.props[V])){var ge=ue.props[V];return[Math.min(le[0],ge),Math.max(le[1],ge)]}return le},H)),L.length){var ee="".concat(V,"1"),ie="".concat(V,"2");H=L.reduce(function(le,ue){if(ue.props[U]===o&&Ff(ue.props,"extendDomain")&&er(ue.props[ee])&&er(ue.props[ie])){var ge=ue.props[ee],Se=ue.props[ie];return[Math.min(le[0],ge,Se),Math.max(le[1],ge,Se)]}return le},H)}return b&&b.length&&(H=b.reduce(function(le,ue){return er(ue)?[Math.min(le[0],ue),Math.max(le[1],ue)]:le},H)),H},aO={exports:{}},ij;function ope(){return ij||(ij=1,function(e){var t=Object.prototype.hasOwnProperty,a="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(a=!1));function c(P,L,U){this.fn=P,this.context=L,this.once=U||!1}function b(P,L,U,V,H){if(typeof U!="function")throw new TypeError("The listener must be a function");var ee=new c(U,V||P,H),ie=a?a+L:L;return P._events[ie]?P._events[ie].fn?P._events[ie]=[P._events[ie],ee]:P._events[ie].push(ee):(P._events[ie]=ee,P._eventsCount++),P}function S(P,L){--P._eventsCount===0?P._events=new o:delete P._events[L]}function i(){this._events=new o,this._eventsCount=0}i.prototype.eventNames=function(){var L=[],U,V;if(this._eventsCount===0)return L;for(V in U=this._events)t.call(U,V)&&L.push(a?V.slice(1):V);return Object.getOwnPropertySymbols?L.concat(Object.getOwnPropertySymbols(U)):L},i.prototype.listeners=function(L){var U=a?a+L:L,V=this._events[U];if(!V)return[];if(V.fn)return[V.fn];for(var H=0,ee=V.length,ie=new Array(ee);H<ee;H++)ie[H]=V[H].fn;return ie},i.prototype.listenerCount=function(L){var U=a?a+L:L,V=this._events[U];return V?V.fn?1:V.length:0},i.prototype.emit=function(L,U,V,H,ee,ie){var le=a?a+L:L;if(!this._events[le])return!1;var ue=this._events[le],ge=arguments.length,Se,ve;if(ue.fn){switch(ue.once&&this.removeListener(L,ue.fn,void 0,!0),ge){case 1:return ue.fn.call(ue.context),!0;case 2:return ue.fn.call(ue.context,U),!0;case 3:return ue.fn.call(ue.context,U,V),!0;case 4:return ue.fn.call(ue.context,U,V,H),!0;case 5:return ue.fn.call(ue.context,U,V,H,ee),!0;case 6:return ue.fn.call(ue.context,U,V,H,ee,ie),!0}for(ve=1,Se=new Array(ge-1);ve<ge;ve++)Se[ve-1]=arguments[ve];ue.fn.apply(ue.context,Se)}else{var Ee=ue.length,me;for(ve=0;ve<Ee;ve++)switch(ue[ve].once&&this.removeListener(L,ue[ve].fn,void 0,!0),ge){case 1:ue[ve].fn.call(ue[ve].context);break;case 2:ue[ve].fn.call(ue[ve].context,U);break;case 3:ue[ve].fn.call(ue[ve].context,U,V);break;case 4:ue[ve].fn.call(ue[ve].context,U,V,H);break;default:if(!Se)for(me=1,Se=new Array(ge-1);me<ge;me++)Se[me-1]=arguments[me];ue[ve].fn.apply(ue[ve].context,Se)}}return!0},i.prototype.on=function(L,U,V){return b(this,L,U,V,!1)},i.prototype.once=function(L,U,V){return b(this,L,U,V,!0)},i.prototype.removeListener=function(L,U,V,H){var ee=a?a+L:L;if(!this._events[ee])return this;if(!U)return S(this,ee),this;var ie=this._events[ee];if(ie.fn)ie.fn===U&&(!H||ie.once)&&(!V||ie.context===V)&&S(this,ee);else{for(var le=0,ue=[],ge=ie.length;le<ge;le++)(ie[le].fn!==U||H&&!ie[le].once||V&&ie[le].context!==V)&&ue.push(ie[le]);ue.length?this._events[ee]=ue.length===1?ue[0]:ue:S(this,ee)}return this},i.prototype.removeAllListeners=function(L){var U;return L?(U=a?a+L:L,this._events[U]&&S(this,U)):(this._events=new o,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prefixed=a,i.EventEmitter=i,e.exports=i}(aO)),aO.exports}var spe=ope();const lpe=fa(spe);var oO=new lpe,sO="recharts.syncMouseEvents";function dx(e){"@babel/helpers - typeof";return dx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dx(e)}function upe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cpe(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,s7(o.key),o)}}function hpe(e,t,a){return t&&cpe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function lO(e,t,a){return t=s7(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s7(e){var t=fpe(e,"string");return dx(t)=="symbol"?t:t+""}function fpe(e,t){if(dx(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(dx(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var dpe=function(){function e(){upe(this,e),lO(this,"activeIndex",0),lO(this,"coordinateList",[]),lO(this,"layout","horizontal")}return hpe(e,[{key:"setDetails",value:function(a){var o,c=a.coordinateList,b=c===void 0?null:c,S=a.container,i=S===void 0?null:S,P=a.layout,L=P===void 0?null:P,U=a.offset,V=U===void 0?null:U,H=a.mouseHandlerCallback,ee=H===void 0?null:H;this.coordinateList=(o=b??this.coordinateList)!==null&&o!==void 0?o:[],this.container=i??this.container,this.layout=L??this.layout,this.offset=V??this.offset,this.mouseHandlerCallback=ee??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(a){if(this.coordinateList.length!==0)switch(a.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(a){this.activeIndex=a}},{key:"spoofMouse",value:function(){var a,o;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var c=this.container.getBoundingClientRect(),b=c.x,S=c.y,i=c.height,P=this.coordinateList[this.activeIndex].coordinate,L=((a=window)===null||a===void 0?void 0:a.scrollX)||0,U=((o=window)===null||o===void 0?void 0:o.scrollY)||0,V=b+P+L,H=S+this.offset.top+i/2+U;this.mouseHandlerCallback({pageX:V,pageY:H})}}}])}();function ppe(e,t,a){if(a==="number"&&t===!0&&Array.isArray(e)){var o=e==null?void 0:e[0],c=e==null?void 0:e[1];if(o&&c&&er(o)&&er(c))return!0}return!1}function mpe(e,t,a,o){var c=o/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-c:a.left+.5,y:e==="horizontal"?a.top+.5:t.y-c,width:e==="horizontal"?o:a.width-1,height:e==="horizontal"?a.height-1:o}}function l7(e){var t=e.cx,a=e.cy,o=e.radius,c=e.startAngle,b=e.endAngle,S=tl(t,a,o,c),i=tl(t,a,o,b);return{points:[S,i],cx:t,cy:a,radius:o,startAngle:c,endAngle:b}}function gpe(e,t,a){var o,c,b,S;if(e==="horizontal")o=t.x,b=o,c=a.top,S=a.top+a.height;else if(e==="vertical")c=t.y,S=c,o=a.left,b=a.left+a.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var i=t.cx,P=t.cy,L=t.innerRadius,U=t.outerRadius,V=t.angle,H=tl(i,P,L,V),ee=tl(i,P,U,V);o=H.x,c=H.y,b=ee.x,S=ee.y}else return l7(t);return[{x:o,y:c},{x:b,y:S}]}function px(e){"@babel/helpers - typeof";return px=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},px(e)}function aj(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function rb(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?aj(Object(a),!0).forEach(function(o){ype(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):aj(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function ype(e,t,a){return t=_pe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _pe(e){var t=vpe(e,"string");return px(t)=="symbol"?t:t+""}function vpe(e,t){if(px(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(px(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xpe(e){var t,a,o=e.element,c=e.tooltipEventType,b=e.isActive,S=e.activeCoordinate,i=e.activePayload,P=e.offset,L=e.activeTooltipIndex,U=e.tooltipAxisBandSize,V=e.layout,H=e.chartName,ee=(t=o.props.cursor)!==null&&t!==void 0?t:(a=o.type.defaultProps)===null||a===void 0?void 0:a.cursor;if(!o||!ee||!b||!S||H!=="ScatterChart"&&c!=="axis")return null;var ie,le=RI;if(H==="ScatterChart")ie=S,le=pce;else if(H==="BarChart")ie=mpe(V,S,P,U),le=aR;else if(V==="radial"){var ue=l7(S),ge=ue.cx,Se=ue.cy,ve=ue.radius,Ee=ue.startAngle,me=ue.endAngle;ie={cx:ge,cy:Se,startAngle:Ee,endAngle:me,innerRadius:ve,outerRadius:ve},le=hq}else ie={points:gpe(V,S,P)},le=RI;var Ae=rb(rb(rb(rb({stroke:"#ccc",pointerEvents:"none"},P),ie),ji(ee,!1)),{},{payload:i,payloadIndex:L,className:ia("recharts-tooltip-cursor",ee.className)});return Jt.isValidElement(ee)?Jt.cloneElement(ee,Ae):Jt.createElement(le,Ae)}var bpe=["item"],wpe=["children","className","width","height","style","compact","title","desc"];function A_(e){"@babel/helpers - typeof";return A_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A_(e)}function Yy(){return Yy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},Yy.apply(this,arguments)}function oj(e,t){return Epe(e)||Tpe(e,t)||c7(e,t)||Spe()}function Spe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tpe(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,c,b,S,i=[],P=!0,L=!1;try{if(b=(a=a.call(e)).next,t!==0)for(;!(P=(o=b.call(a)).done)&&(i.push(o.value),i.length!==t);P=!0);}catch(U){L=!0,c=U}finally{try{if(!P&&a.return!=null&&(S=a.return(),Object(S)!==S))return}finally{if(L)throw c}}return i}}function Epe(e){if(Array.isArray(e))return e}function sj(e,t){if(e==null)return{};var a=Ape(e,t),o,c;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(c=0;c<b.length;c++)o=b[c],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function Ape(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function Mpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ope(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,h7(o.key),o)}}function Ipe(e,t,a){return t&&Ope(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cpe(e,t,a){return t=Cw(t),Ppe(e,u7()?Reflect.construct(t,a||[],Cw(e).constructor):t.apply(e,a))}function Ppe(e,t){if(t&&(A_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rpe(e)}function Rpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u7(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(u7=function(){return!!e})()}function Cw(e){return Cw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Cw(e)}function kpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uC(e,t)}function uC(e,t){return uC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,c){return o.__proto__=c,o},uC(e,t)}function M_(e){return zpe(e)||Lpe(e)||c7(e)||Dpe()}function Dpe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c7(e,t){if(e){if(typeof e=="string")return cC(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return cC(e,t)}}function Lpe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zpe(e){if(Array.isArray(e))return cC(e)}function cC(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function lj(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,o)}return a}function _n(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?lj(Object(a),!0).forEach(function(o){Hr(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):lj(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Hr(e,t,a){return t=h7(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function h7(e){var t=Npe(e,"string");return A_(t)=="symbol"?t:t+""}function Npe(e,t){if(A_(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(A_(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bpe={xAxis:["bottom","top"],yAxis:["left","right"]},Fpe={width:"100%",height:"100%"},f7={x:0,y:0};function ib(e){return e}var jpe=function(t,a){return a==="horizontal"?t.x:a==="vertical"?t.y:a==="centric"?t.angle:t.radius},Upe=function(t,a,o,c){var b=a.find(function(U){return U&&U.index===o});if(b){if(t==="horizontal")return{x:b.coordinate,y:c.y};if(t==="vertical")return{x:c.x,y:b.coordinate};if(t==="centric"){var S=b.coordinate,i=c.radius;return _n(_n(_n({},c),tl(c.cx,c.cy,i,S)),{},{angle:S,radius:i})}var P=b.coordinate,L=c.angle;return _n(_n(_n({},c),tl(c.cx,c.cy,P,L)),{},{angle:L,radius:P})}return f7},A2=function(t,a){var o=a.graphicalItems,c=a.dataStartIndex,b=a.dataEndIndex,S=(o??[]).reduce(function(i,P){var L=P.props.data;return L&&L.length?[].concat(M_(i),M_(L)):i},[]);return S.length>0?S:t&&t.length&&er(c)&&er(b)?t.slice(c,b+1):[]};function d7(e){return e==="number"?[0,"auto"]:void 0}var hC=function(t,a,o,c){var b=t.graphicalItems,S=t.tooltipAxis,i=A2(a,t);return o<0||!b||!b.length||o>=i.length?null:b.reduce(function(P,L){var U,V=(U=L.props.data)!==null&&U!==void 0?U:a;V&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=o&&(V=V.slice(t.dataStartIndex,t.dataEndIndex+1));var H;if(S.dataKey&&!S.allowDuplicatedCategory){var ee=V===void 0?i:V;H=Lb(ee,S.dataKey,c)}else H=V&&V[o]||i[o];return H?[].concat(M_(P),[lq(L,H)]):P},[])},uj=function(t,a,o,c){var b=c||{x:t.chartX,y:t.chartY},S=jpe(b,o),i=t.orderedTooltipTicks,P=t.tooltipAxis,L=t.tooltipTicks,U=tse(S,i,L,P);if(U>=0&&L){var V=L[U]&&L[U].value,H=hC(t,a,U,V),ee=Upe(o,i,U,b);return{activeTooltipIndex:U,activeLabel:V,activePayload:H,activeCoordinate:ee}}return null},Vpe=function(t,a){var o=a.axes,c=a.graphicalItems,b=a.axisType,S=a.axisIdKey,i=a.stackGroups,P=a.dataStartIndex,L=a.dataEndIndex,U=t.layout,V=t.children,H=t.stackOffset,ee=aq(U,b);return o.reduce(function(ie,le){var ue,ge=le.type.defaultProps!==void 0?_n(_n({},le.type.defaultProps),le.props):le.props,Se=ge.type,ve=ge.dataKey,Ee=ge.allowDataOverflow,me=ge.allowDuplicatedCategory,Ae=ge.scale,Oe=ge.ticks,Ye=ge.includeHidden,He=ge[S];if(ie[He])return ie;var st=A2(t.data,{graphicalItems:c.filter(function(an){var qt,cn=S in an.props?an.props[S]:(qt=an.type.defaultProps)===null||qt===void 0?void 0:qt[S];return cn===He}),dataStartIndex:P,dataEndIndex:L}),Ke=st.length,Ot,Bt,Tt;ppe(ge.domain,Ee,Se)&&(Ot=MI(ge.domain,null,Ee),ee&&(Se==="number"||Ae!=="auto")&&(Tt=b0(st,ve,"category")));var mt=d7(Se);if(!Ot||Ot.length===0){var bt,Ft=(bt=ge.domain)!==null&&bt!==void 0?bt:mt;if(ve){if(Ot=b0(st,ve,Se),Se==="category"&&ee){var Zt=XJ(Ot);me&&Zt?(Bt=Ot,Ot=gw(0,Ke)):me||(Ot=TB(Ft,Ot,le).reduce(function(an,qt){return an.indexOf(qt)>=0?an:[].concat(M_(an),[qt])},[]))}else if(Se==="category")me?Ot=Ot.filter(function(an){return an!==""&&!vi(an)}):Ot=TB(Ft,Ot,le).reduce(function(an,qt){return an.indexOf(qt)>=0||qt===""||vi(qt)?an:[].concat(M_(an),[qt])},[]);else if(Se==="number"){var Vt=ose(st,c.filter(function(an){var qt,cn,rr=S in an.props?an.props[S]:(qt=an.type.defaultProps)===null||qt===void 0?void 0:qt[S],mr="hide"in an.props?an.props.hide:(cn=an.type.defaultProps)===null||cn===void 0?void 0:cn.hide;return rr===He&&(Ye||!mr)}),ve,b,U);Vt&&(Ot=Vt)}ee&&(Se==="number"||Ae!=="auto")&&(Tt=b0(st,ve,"category"))}else ee?Ot=gw(0,Ke):i&&i[He]&&i[He].hasStack&&Se==="number"?Ot=H==="expand"?[0,1]:sq(i[He].stackGroups,P,L):Ot=iq(st,c.filter(function(an){var qt=S in an.props?an.props[S]:an.type.defaultProps[S],cn="hide"in an.props?an.props.hide:an.type.defaultProps.hide;return qt===He&&(Ye||!cn)}),Se,U,!0);if(Se==="number")Ot=lC(V,Ot,He,b,Oe),Ft&&(Ot=MI(Ft,Ot,Ee));else if(Se==="category"&&Ft){var Ze=Ft,Xt=Ot.every(function(an){return Ze.indexOf(an)>=0});Xt&&(Ot=Ze)}}return _n(_n({},ie),{},Hr({},He,_n(_n({},ge),{},{axisType:b,domain:Ot,categoricalDomain:Tt,duplicateDomain:Bt,originalDomain:(ue=ge.domain)!==null&&ue!==void 0?ue:mt,isCategorical:ee,layout:U})))},{})},qpe=function(t,a){var o=a.graphicalItems,c=a.Axis,b=a.axisType,S=a.axisIdKey,i=a.stackGroups,P=a.dataStartIndex,L=a.dataEndIndex,U=t.layout,V=t.children,H=A2(t.data,{graphicalItems:o,dataStartIndex:P,dataEndIndex:L}),ee=H.length,ie=aq(U,b),le=-1;return o.reduce(function(ue,ge){var Se=ge.type.defaultProps!==void 0?_n(_n({},ge.type.defaultProps),ge.props):ge.props,ve=Se[S],Ee=d7("number");if(!ue[ve]){le++;var me;return ie?me=gw(0,ee):i&&i[ve]&&i[ve].hasStack?(me=sq(i[ve].stackGroups,P,L),me=lC(V,me,ve,b)):(me=MI(Ee,iq(H,o.filter(function(Ae){var Oe,Ye,He=S in Ae.props?Ae.props[S]:(Oe=Ae.type.defaultProps)===null||Oe===void 0?void 0:Oe[S],st="hide"in Ae.props?Ae.props.hide:(Ye=Ae.type.defaultProps)===null||Ye===void 0?void 0:Ye.hide;return He===ve&&!st}),"number",U),c.defaultProps.allowDataOverflow),me=lC(V,me,ve,b)),_n(_n({},ue),{},Hr({},ve,_n(_n({axisType:b},c.defaultProps),{},{hide:!0,orientation:$c(Bpe,"".concat(b,".").concat(le%2),null),domain:me,originalDomain:Ee,isCategorical:ie,layout:U})))}return ue},{})},Gpe=function(t,a){var o=a.axisType,c=o===void 0?"xAxis":o,b=a.AxisComp,S=a.graphicalItems,i=a.stackGroups,P=a.dataStartIndex,L=a.dataEndIndex,U=t.children,V="".concat(c,"Id"),H=Ju(U,b),ee={};return H&&H.length?ee=Vpe(t,{axes:H,graphicalItems:S,axisType:c,axisIdKey:V,stackGroups:i,dataStartIndex:P,dataEndIndex:L}):S&&S.length&&(ee=qpe(t,{Axis:b,graphicalItems:S,axisType:c,axisIdKey:V,stackGroups:i,dataStartIndex:P,dataEndIndex:L})),ee},$pe=function(t){var a=Qp(t),o=Fd(a,!1,!0);return{tooltipTicks:o,orderedTooltipTicks:PP(o,function(c){return c.coordinate}),tooltipAxis:a,tooltipAxisBandSize:sw(a,o)}},cj=function(t){var a=t.children,o=t.defaultShowTooltip,c=Wu(a,g_),b=0,S=0;return t.data&&t.data.length!==0&&(S=t.data.length-1),c&&c.props&&(c.props.startIndex>=0&&(b=c.props.startIndex),c.props.endIndex>=0&&(S=c.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:b,dataEndIndex:S,activeTooltipIndex:-1,isTooltipActive:!!o}},Hpe=function(t){return!t||!t.length?!1:t.some(function(a){var o=Vd(a&&a.type);return o&&o.indexOf("Bar")>=0})},hj=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},Xpe=function(t,a){var o=t.props,c=t.graphicalItems,b=t.xAxisMap,S=b===void 0?{}:b,i=t.yAxisMap,P=i===void 0?{}:i,L=o.width,U=o.height,V=o.children,H=o.margin||{},ee=Wu(V,g_),ie=Wu(V,Jy),le=Object.keys(P).reduce(function(me,Ae){var Oe=P[Ae],Ye=Oe.orientation;return!Oe.mirror&&!Oe.hide?_n(_n({},me),{},Hr({},Ye,me[Ye]+Oe.width)):me},{left:H.left||0,right:H.right||0}),ue=Object.keys(S).reduce(function(me,Ae){var Oe=S[Ae],Ye=Oe.orientation;return!Oe.mirror&&!Oe.hide?_n(_n({},me),{},Hr({},Ye,$c(me,"".concat(Ye))+Oe.height)):me},{top:H.top||0,bottom:H.bottom||0}),ge=_n(_n({},ue),le),Se=ge.bottom;ee&&(ge.bottom+=ee.props.height||g_.defaultProps.height),ie&&a&&(ge=ise(ge,c,o,a));var ve=L-ge.left-ge.right,Ee=U-ge.top-ge.bottom;return _n(_n({brushBottom:Se},ge),{},{width:Math.max(ve,0),height:Math.max(Ee,0)})},Ype=function(t,a){if(a==="xAxis")return t[a].width;if(a==="yAxis")return t[a].height},p7=function(t){var a=t.chartName,o=t.GraphicalChild,c=t.defaultTooltipEventType,b=c===void 0?"axis":c,S=t.validateTooltipEventTypes,i=S===void 0?["axis"]:S,P=t.axisComponents,L=t.legendContent,U=t.formatAxisMap,V=t.defaultProps,H=function(ge,Se){var ve=Se.graphicalItems,Ee=Se.stackGroups,me=Se.offset,Ae=Se.updateId,Oe=Se.dataStartIndex,Ye=Se.dataEndIndex,He=ge.barSize,st=ge.layout,Ke=ge.barGap,Ot=ge.barCategoryGap,Bt=ge.maxBarSize,Tt=hj(st),mt=Tt.numericAxisName,bt=Tt.cateAxisName,Ft=Hpe(ve),Zt=[];return ve.forEach(function(Vt,Ze){var Xt=A2(ge.data,{graphicalItems:[Vt],dataStartIndex:Oe,dataEndIndex:Ye}),an=Vt.type.defaultProps!==void 0?_n(_n({},Vt.type.defaultProps),Vt.props):Vt.props,qt=an.dataKey,cn=an.maxBarSize,rr=an["".concat(mt,"Id")],mr=an["".concat(bt,"Id")],Ci={},Et=P.reduce(function(La,ya){var ks=Se["".concat(ya.axisType,"Map")],Mn=an["".concat(ya.axisType,"Id")];ks&&ks[Mn]||ya.axisType==="zAxis"||Eg();var no=ks[Mn];return _n(_n({},La),{},Hr(Hr({},ya.axisType,no),"".concat(ya.axisType,"Ticks"),Fd(no)))},Ci),Ln=Et[bt],Ne=Et["".concat(bt,"Ticks")],An=Ee&&Ee[rr]&&Ee[rr].hasStack&&_se(Vt,Ee[rr].stackGroups),qe=Vd(Vt.type).indexOf("Bar")>=0,jr=sw(Ln,Ne),$t=[],Ur=Ft&&nse({barSize:He,stackGroups:Ee,totalSize:Ype(Et,bt)});if(qe){var Wr,Qi,hr=vi(cn)?Bt:cn,vn=(Wr=(Qi=sw(Ln,Ne,!0))!==null&&Qi!==void 0?Qi:hr)!==null&&Wr!==void 0?Wr:0;$t=rse({barGap:Ke,barCategoryGap:Ot,bandSize:vn!==jr?vn:jr,sizeList:Ur[mr],maxBarSize:hr}),vn!==jr&&($t=$t.map(function(La){return _n(_n({},La),{},{position:_n(_n({},La.position),{},{offset:La.position.offset-vn/2})})}))}var wa=Vt&&Vt.type&&Vt.type.getComposedData;wa&&Zt.push({props:_n(_n({},wa(_n(_n({},Et),{},{displayedData:Xt,props:ge,dataKey:qt,item:Vt,bandSize:jr,barPosition:$t,offset:me,stackedData:An,layout:st,dataStartIndex:Oe,dataEndIndex:Ye}))),{},Hr(Hr(Hr({key:Vt.key||"item-".concat(Ze)},mt,Et[mt]),bt,Et[bt]),"animationId",Ae)),childIndex:aQ(Vt,ge.children),item:Vt})}),Zt},ee=function(ge,Se){var ve=ge.props,Ee=ge.dataStartIndex,me=ge.dataEndIndex,Ae=ge.updateId;if(!Bz({props:ve}))return null;var Oe=ve.children,Ye=ve.layout,He=ve.stackOffset,st=ve.data,Ke=ve.reverseStackOrder,Ot=hj(Ye),Bt=Ot.numericAxisName,Tt=Ot.cateAxisName,mt=Ju(Oe,o),bt=mse(st,mt,"".concat(Bt,"Id"),"".concat(Tt,"Id"),He,Ke),Ft=P.reduce(function(an,qt){var cn="".concat(qt.axisType,"Map");return _n(_n({},an),{},Hr({},cn,Gpe(ve,_n(_n({},qt),{},{graphicalItems:mt,stackGroups:qt.axisType===Bt&&bt,dataStartIndex:Ee,dataEndIndex:me}))))},{}),Zt=Xpe(_n(_n({},Ft),{},{props:ve,graphicalItems:mt}),Se==null?void 0:Se.legendBBox);Object.keys(Ft).forEach(function(an){Ft[an]=U(ve,Ft[an],Zt,an.replace("Map",""),a)});var Vt=Ft["".concat(Tt,"Map")],Ze=$pe(Vt),Xt=H(ve,_n(_n({},Ft),{},{dataStartIndex:Ee,dataEndIndex:me,updateId:Ae,graphicalItems:mt,stackGroups:bt,offset:Zt}));return _n(_n({formattedGraphicalItems:Xt,graphicalItems:mt,offset:Zt,stackGroups:bt},Ze),Ft)},ie=function(ue){function ge(Se){var ve,Ee,me;return Mpe(this,ge),me=Cpe(this,ge,[Se]),Hr(me,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Hr(me,"accessibilityManager",new dpe),Hr(me,"handleLegendBBoxUpdate",function(Ae){if(Ae){var Oe=me.state,Ye=Oe.dataStartIndex,He=Oe.dataEndIndex,st=Oe.updateId;me.setState(_n({legendBBox:Ae},ee({props:me.props,dataStartIndex:Ye,dataEndIndex:He,updateId:st},_n(_n({},me.state),{},{legendBBox:Ae}))))}}),Hr(me,"handleReceiveSyncEvent",function(Ae,Oe,Ye){if(me.props.syncId===Ae){if(Ye===me.eventEmitterSymbol&&typeof me.props.syncMethod!="function")return;me.applySyncEvent(Oe)}}),Hr(me,"handleBrushChange",function(Ae){var Oe=Ae.startIndex,Ye=Ae.endIndex;if(Oe!==me.state.dataStartIndex||Ye!==me.state.dataEndIndex){var He=me.state.updateId;me.setState(function(){return _n({dataStartIndex:Oe,dataEndIndex:Ye},ee({props:me.props,dataStartIndex:Oe,dataEndIndex:Ye,updateId:He},me.state))}),me.triggerSyncEvent({dataStartIndex:Oe,dataEndIndex:Ye})}}),Hr(me,"handleMouseEnter",function(Ae){var Oe=me.getMouseInfo(Ae);if(Oe){var Ye=_n(_n({},Oe),{},{isTooltipActive:!0});me.setState(Ye),me.triggerSyncEvent(Ye);var He=me.props.onMouseEnter;_i(He)&&He(Ye,Ae)}}),Hr(me,"triggeredAfterMouseMove",function(Ae){var Oe=me.getMouseInfo(Ae),Ye=Oe?_n(_n({},Oe),{},{isTooltipActive:!0}):{isTooltipActive:!1};me.setState(Ye),me.triggerSyncEvent(Ye);var He=me.props.onMouseMove;_i(He)&&He(Ye,Ae)}),Hr(me,"handleItemMouseEnter",function(Ae){me.setState(function(){return{isTooltipActive:!0,activeItem:Ae,activePayload:Ae.tooltipPayload,activeCoordinate:Ae.tooltipPosition||{x:Ae.cx,y:Ae.cy}}})}),Hr(me,"handleItemMouseLeave",function(){me.setState(function(){return{isTooltipActive:!1}})}),Hr(me,"handleMouseMove",function(Ae){Ae.persist(),me.throttleTriggeredAfterMouseMove(Ae)}),Hr(me,"handleMouseLeave",function(Ae){me.throttleTriggeredAfterMouseMove.cancel();var Oe={isTooltipActive:!1};me.setState(Oe),me.triggerSyncEvent(Oe);var Ye=me.props.onMouseLeave;_i(Ye)&&Ye(Oe,Ae)}),Hr(me,"handleOuterEvent",function(Ae){var Oe=iQ(Ae),Ye=$c(me.props,"".concat(Oe));if(Oe&&_i(Ye)){var He,st;/.*touch.*/i.test(Oe)?st=me.getMouseInfo(Ae.changedTouches[0]):st=me.getMouseInfo(Ae),Ye((He=st)!==null&&He!==void 0?He:{},Ae)}}),Hr(me,"handleClick",function(Ae){var Oe=me.getMouseInfo(Ae);if(Oe){var Ye=_n(_n({},Oe),{},{isTooltipActive:!0});me.setState(Ye),me.triggerSyncEvent(Ye);var He=me.props.onClick;_i(He)&&He(Ye,Ae)}}),Hr(me,"handleMouseDown",function(Ae){var Oe=me.props.onMouseDown;if(_i(Oe)){var Ye=me.getMouseInfo(Ae);Oe(Ye,Ae)}}),Hr(me,"handleMouseUp",function(Ae){var Oe=me.props.onMouseUp;if(_i(Oe)){var Ye=me.getMouseInfo(Ae);Oe(Ye,Ae)}}),Hr(me,"handleTouchMove",function(Ae){Ae.changedTouches!=null&&Ae.changedTouches.length>0&&me.throttleTriggeredAfterMouseMove(Ae.changedTouches[0])}),Hr(me,"handleTouchStart",function(Ae){Ae.changedTouches!=null&&Ae.changedTouches.length>0&&me.handleMouseDown(Ae.changedTouches[0])}),Hr(me,"handleTouchEnd",function(Ae){Ae.changedTouches!=null&&Ae.changedTouches.length>0&&me.handleMouseUp(Ae.changedTouches[0])}),Hr(me,"handleDoubleClick",function(Ae){var Oe=me.props.onDoubleClick;if(_i(Oe)){var Ye=me.getMouseInfo(Ae);Oe(Ye,Ae)}}),Hr(me,"handleContextMenu",function(Ae){var Oe=me.props.onContextMenu;if(_i(Oe)){var Ye=me.getMouseInfo(Ae);Oe(Ye,Ae)}}),Hr(me,"triggerSyncEvent",function(Ae){me.props.syncId!==void 0&&oO.emit(sO,me.props.syncId,Ae,me.eventEmitterSymbol)}),Hr(me,"applySyncEvent",function(Ae){var Oe=me.props,Ye=Oe.layout,He=Oe.syncMethod,st=me.state.updateId,Ke=Ae.dataStartIndex,Ot=Ae.dataEndIndex;if(Ae.dataStartIndex!==void 0||Ae.dataEndIndex!==void 0)me.setState(_n({dataStartIndex:Ke,dataEndIndex:Ot},ee({props:me.props,dataStartIndex:Ke,dataEndIndex:Ot,updateId:st},me.state)));else if(Ae.activeTooltipIndex!==void 0){var Bt=Ae.chartX,Tt=Ae.chartY,mt=Ae.activeTooltipIndex,bt=me.state,Ft=bt.offset,Zt=bt.tooltipTicks;if(!Ft)return;if(typeof He=="function")mt=He(Zt,Ae);else if(He==="value"){mt=-1;for(var Vt=0;Vt<Zt.length;Vt++)if(Zt[Vt].value===Ae.activeLabel){mt=Vt;break}}var Ze=_n(_n({},Ft),{},{x:Ft.left,y:Ft.top}),Xt=Math.min(Bt,Ze.x+Ze.width),an=Math.min(Tt,Ze.y+Ze.height),qt=Zt[mt]&&Zt[mt].value,cn=hC(me.state,me.props.data,mt),rr=Zt[mt]?{x:Ye==="horizontal"?Zt[mt].coordinate:Xt,y:Ye==="horizontal"?an:Zt[mt].coordinate}:f7;me.setState(_n(_n({},Ae),{},{activeLabel:qt,activeCoordinate:rr,activePayload:cn,activeTooltipIndex:mt}))}else me.setState(Ae)}),Hr(me,"renderCursor",function(Ae){var Oe,Ye=me.state,He=Ye.isTooltipActive,st=Ye.activeCoordinate,Ke=Ye.activePayload,Ot=Ye.offset,Bt=Ye.activeTooltipIndex,Tt=Ye.tooltipAxisBandSize,mt=me.getTooltipEventType(),bt=(Oe=Ae.props.active)!==null&&Oe!==void 0?Oe:He,Ft=me.props.layout,Zt=Ae.key||"_recharts-cursor";return kt.createElement(xpe,{key:Zt,activeCoordinate:st,activePayload:Ke,activeTooltipIndex:Bt,chartName:a,element:Ae,isActive:bt,layout:Ft,offset:Ot,tooltipAxisBandSize:Tt,tooltipEventType:mt})}),Hr(me,"renderPolarAxis",function(Ae,Oe,Ye){var He=$c(Ae,"type.axisType"),st=$c(me.state,"".concat(He,"Map")),Ke=Ae.type.defaultProps,Ot=Ke!==void 0?_n(_n({},Ke),Ae.props):Ae.props,Bt=st&&st[Ot["".concat(He,"Id")]];return Jt.cloneElement(Ae,_n(_n({},Bt),{},{className:ia(He,Bt.className),key:Ae.key||"".concat(Oe,"-").concat(Ye),ticks:Fd(Bt,!0)}))}),Hr(me,"renderPolarGrid",function(Ae){var Oe=Ae.props,Ye=Oe.radialLines,He=Oe.polarAngles,st=Oe.polarRadius,Ke=me.state,Ot=Ke.radiusAxisMap,Bt=Ke.angleAxisMap,Tt=Qp(Ot),mt=Qp(Bt),bt=mt.cx,Ft=mt.cy,Zt=mt.innerRadius,Vt=mt.outerRadius;return Jt.cloneElement(Ae,{polarAngles:Array.isArray(He)?He:Fd(mt,!0).map(function(Ze){return Ze.coordinate}),polarRadius:Array.isArray(st)?st:Fd(Tt,!0).map(function(Ze){return Ze.coordinate}),cx:bt,cy:Ft,innerRadius:Zt,outerRadius:Vt,key:Ae.key||"polar-grid",radialLines:Ye})}),Hr(me,"renderLegend",function(){var Ae=me.state.formattedGraphicalItems,Oe=me.props,Ye=Oe.children,He=Oe.width,st=Oe.height,Ke=me.props.margin||{},Ot=He-(Ke.left||0)-(Ke.right||0),Bt=nq({children:Ye,formattedGraphicalItems:Ae,legendWidth:Ot,legendContent:L});if(!Bt)return null;var Tt=Bt.item,mt=sj(Bt,bpe);return Jt.cloneElement(Tt,_n(_n({},mt),{},{chartWidth:He,chartHeight:st,margin:Ke,onBBoxUpdate:me.handleLegendBBoxUpdate}))}),Hr(me,"renderTooltip",function(){var Ae,Oe=me.props,Ye=Oe.children,He=Oe.accessibilityLayer,st=Wu(Ye,Ih);if(!st)return null;var Ke=me.state,Ot=Ke.isTooltipActive,Bt=Ke.activeCoordinate,Tt=Ke.activePayload,mt=Ke.activeLabel,bt=Ke.offset,Ft=(Ae=st.props.active)!==null&&Ae!==void 0?Ae:Ot;return Jt.cloneElement(st,{viewBox:_n(_n({},bt),{},{x:bt.left,y:bt.top}),active:Ft,label:mt,payload:Ft?Tt:[],coordinate:Bt,accessibilityLayer:He})}),Hr(me,"renderBrush",function(Ae){var Oe=me.props,Ye=Oe.margin,He=Oe.data,st=me.state,Ke=st.offset,Ot=st.dataStartIndex,Bt=st.dataEndIndex,Tt=st.updateId;return Jt.cloneElement(Ae,{key:Ae.key||"_recharts-brush",onChange:Q1(me.handleBrushChange,Ae.props.onChange),data:He,x:er(Ae.props.x)?Ae.props.x:Ke.left,y:er(Ae.props.y)?Ae.props.y:Ke.top+Ke.height+Ke.brushBottom-(Ye.bottom||0),width:er(Ae.props.width)?Ae.props.width:Ke.width,startIndex:Ot,endIndex:Bt,updateId:"brush-".concat(Tt)})}),Hr(me,"renderReferenceElement",function(Ae,Oe,Ye){if(!Ae)return null;var He=me,st=He.clipPathId,Ke=me.state,Ot=Ke.xAxisMap,Bt=Ke.yAxisMap,Tt=Ke.offset,mt=Ae.type.defaultProps||{},bt=Ae.props,Ft=bt.xAxisId,Zt=Ft===void 0?mt.xAxisId:Ft,Vt=bt.yAxisId,Ze=Vt===void 0?mt.yAxisId:Vt;return Jt.cloneElement(Ae,{key:Ae.key||"".concat(Oe,"-").concat(Ye),xAxis:Ot[Zt],yAxis:Bt[Ze],viewBox:{x:Tt.left,y:Tt.top,width:Tt.width,height:Tt.height},clipPathId:st})}),Hr(me,"renderActivePoints",function(Ae){var Oe=Ae.item,Ye=Ae.activePoint,He=Ae.basePoint,st=Ae.childIndex,Ke=Ae.isRange,Ot=[],Bt=Oe.props.key,Tt=Oe.item.type.defaultProps!==void 0?_n(_n({},Oe.item.type.defaultProps),Oe.item.props):Oe.item.props,mt=Tt.activeDot,bt=Tt.dataKey,Ft=_n(_n({index:st,dataKey:bt,cx:Ye.x,cy:Ye.y,r:4,fill:iR(Oe.item),strokeWidth:2,stroke:"#fff",payload:Ye.payload,value:Ye.value},ji(mt,!1)),zb(mt));return Ot.push(ge.renderActiveDot(mt,Ft,"".concat(Bt,"-activePoint-").concat(st))),He?Ot.push(ge.renderActiveDot(mt,_n(_n({},Ft),{},{cx:He.x,cy:He.y}),"".concat(Bt,"-basePoint-").concat(st))):Ke&&Ot.push(null),Ot}),Hr(me,"renderGraphicChild",function(Ae,Oe,Ye){var He=me.filterFormatItem(Ae,Oe,Ye);if(!He)return null;var st=me.getTooltipEventType(),Ke=me.state,Ot=Ke.isTooltipActive,Bt=Ke.tooltipAxis,Tt=Ke.activeTooltipIndex,mt=Ke.activeLabel,bt=me.props.children,Ft=Wu(bt,Ih),Zt=He.props,Vt=Zt.points,Ze=Zt.isRange,Xt=Zt.baseLine,an=He.item.type.defaultProps!==void 0?_n(_n({},He.item.type.defaultProps),He.item.props):He.item.props,qt=an.activeDot,cn=an.hide,rr=an.activeBar,mr=an.activeShape,Ci=!!(!cn&&Ot&&Ft&&(qt||rr||mr)),Et={};st!=="axis"&&Ft&&Ft.props.trigger==="click"?Et={onClick:Q1(me.handleItemMouseEnter,Ae.props.onClick)}:st!=="axis"&&(Et={onMouseLeave:Q1(me.handleItemMouseLeave,Ae.props.onMouseLeave),onMouseEnter:Q1(me.handleItemMouseEnter,Ae.props.onMouseEnter)});var Ln=Jt.cloneElement(Ae,_n(_n({},He.props),Et));function Ne(ya){return typeof Bt.dataKey=="function"?Bt.dataKey(ya.payload):null}if(Ci)if(Tt>=0){var An,qe;if(Bt.dataKey&&!Bt.allowDuplicatedCategory){var jr=typeof Bt.dataKey=="function"?Ne:"payload.".concat(Bt.dataKey.toString());An=Lb(Vt,jr,mt),qe=Ze&&Xt&&Lb(Xt,jr,mt)}else An=Vt==null?void 0:Vt[Tt],qe=Ze&&Xt&&Xt[Tt];if(mr||rr){var $t=Ae.props.activeIndex!==void 0?Ae.props.activeIndex:Tt;return[Jt.cloneElement(Ae,_n(_n(_n({},He.props),Et),{},{activeIndex:$t})),null,null]}if(!vi(An))return[Ln].concat(M_(me.renderActivePoints({item:He,activePoint:An,basePoint:qe,childIndex:Tt,isRange:Ze})))}else{var Ur,Wr=(Ur=me.getItemByXY(me.state.activeCoordinate))!==null&&Ur!==void 0?Ur:{graphicalItem:Ln},Qi=Wr.graphicalItem,hr=Qi.item,vn=hr===void 0?Ae:hr,wa=Qi.childIndex,La=_n(_n(_n({},He.props),Et),{},{activeIndex:wa});return[Jt.cloneElement(vn,La),null,null]}return Ze?[Ln,null,null]:[Ln,null]}),Hr(me,"renderCustomized",function(Ae,Oe,Ye){return Jt.cloneElement(Ae,_n(_n({key:"recharts-customized-".concat(Ye)},me.props),me.state))}),Hr(me,"renderMap",{CartesianGrid:{handler:ib,once:!0},ReferenceArea:{handler:me.renderReferenceElement},ReferenceLine:{handler:ib},ReferenceDot:{handler:me.renderReferenceElement},XAxis:{handler:ib},YAxis:{handler:ib},Brush:{handler:me.renderBrush,once:!0},Bar:{handler:me.renderGraphicChild},Line:{handler:me.renderGraphicChild},Area:{handler:me.renderGraphicChild},Radar:{handler:me.renderGraphicChild},RadialBar:{handler:me.renderGraphicChild},Scatter:{handler:me.renderGraphicChild},Pie:{handler:me.renderGraphicChild},Funnel:{handler:me.renderGraphicChild},Tooltip:{handler:me.renderCursor,once:!0},PolarGrid:{handler:me.renderPolarGrid,once:!0},PolarAngleAxis:{handler:me.renderPolarAxis},PolarRadiusAxis:{handler:me.renderPolarAxis},Customized:{handler:me.renderCustomized}}),me.clipPathId="".concat((ve=Se.id)!==null&&ve!==void 0?ve:Ax("recharts"),"-clip"),me.throttleTriggeredAfterMouseMove=t8(me.triggeredAfterMouseMove,(Ee=Se.throttleDelay)!==null&&Ee!==void 0?Ee:1e3/60),me.state={},me}return kpe(ge,ue),Ipe(ge,[{key:"componentDidMount",value:function(){var ve,Ee;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(ve=this.props.margin.left)!==null&&ve!==void 0?ve:0,top:(Ee=this.props.margin.top)!==null&&Ee!==void 0?Ee:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var ve=this.props,Ee=ve.children,me=ve.data,Ae=ve.height,Oe=ve.layout,Ye=Wu(Ee,Ih);if(Ye){var He=Ye.props.defaultIndex;if(!(typeof He!="number"||He<0||He>this.state.tooltipTicks.length-1)){var st=this.state.tooltipTicks[He]&&this.state.tooltipTicks[He].value,Ke=hC(this.state,me,He,st),Ot=this.state.tooltipTicks[He].coordinate,Bt=(this.state.offset.top+Ae)/2,Tt=Oe==="horizontal",mt=Tt?{x:Ot,y:Bt}:{y:Ot,x:Bt},bt=this.state.formattedGraphicalItems.find(function(Zt){var Vt=Zt.item;return Vt.type.name==="Scatter"});bt&&(mt=_n(_n({},mt),bt.props.points[He].tooltipPosition),Ke=bt.props.points[He].tooltipPayload);var Ft={activeTooltipIndex:He,isTooltipActive:!0,activeLabel:st,activePayload:Ke,activeCoordinate:mt};this.setState(Ft),this.renderCursor(Ye),this.accessibilityManager.setIndex(He)}}}},{key:"getSnapshotBeforeUpdate",value:function(ve,Ee){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==Ee.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==ve.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==ve.margin){var me,Ae;this.accessibilityManager.setDetails({offset:{left:(me=this.props.margin.left)!==null&&me!==void 0?me:0,top:(Ae=this.props.margin.top)!==null&&Ae!==void 0?Ae:0}})}return null}},{key:"componentDidUpdate",value:function(ve){ZO([Wu(ve.children,Ih)],[Wu(this.props.children,Ih)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var ve=Wu(this.props.children,Ih);if(ve&&typeof ve.props.shared=="boolean"){var Ee=ve.props.shared?"axis":"item";return i.indexOf(Ee)>=0?Ee:b}return b}},{key:"getMouseInfo",value:function(ve){if(!this.container)return null;var Ee=this.container,me=Ee.getBoundingClientRect(),Ae=$ne(me),Oe={chartX:Math.round(ve.pageX-Ae.left),chartY:Math.round(ve.pageY-Ae.top)},Ye=me.width/Ee.offsetWidth||1,He=this.inRange(Oe.chartX,Oe.chartY,Ye);if(!He)return null;var st=this.state,Ke=st.xAxisMap,Ot=st.yAxisMap,Bt=this.getTooltipEventType();if(Bt!=="axis"&&Ke&&Ot){var Tt=Qp(Ke).scale,mt=Qp(Ot).scale,bt=Tt&&Tt.invert?Tt.invert(Oe.chartX):null,Ft=mt&&mt.invert?mt.invert(Oe.chartY):null;return _n(_n({},Oe),{},{xValue:bt,yValue:Ft})}var Zt=uj(this.state,this.props.data,this.props.layout,He);return Zt?_n(_n({},Oe),Zt):null}},{key:"inRange",value:function(ve,Ee){var me=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,Ae=this.props.layout,Oe=ve/me,Ye=Ee/me;if(Ae==="horizontal"||Ae==="vertical"){var He=this.state.offset,st=Oe>=He.left&&Oe<=He.left+He.width&&Ye>=He.top&&Ye<=He.top+He.height;return st?{x:Oe,y:Ye}:null}var Ke=this.state,Ot=Ke.angleAxisMap,Bt=Ke.radiusAxisMap;if(Ot&&Bt){var Tt=Qp(Ot);return MB({x:Oe,y:Ye},Tt)}return null}},{key:"parseEventsOfWrapper",value:function(){var ve=this.props.children,Ee=this.getTooltipEventType(),me=Wu(ve,Ih),Ae={};me&&Ee==="axis"&&(me.props.trigger==="click"?Ae={onClick:this.handleClick}:Ae={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var Oe=zb(this.props,this.handleOuterEvent);return _n(_n({},Oe),Ae)}},{key:"addListener",value:function(){oO.on(sO,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){oO.removeListener(sO,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(ve,Ee,me){for(var Ae=this.state.formattedGraphicalItems,Oe=0,Ye=Ae.length;Oe<Ye;Oe++){var He=Ae[Oe];if(He.item===ve||He.props.key===ve.key||Ee===Vd(He.item.type)&&me===He.childIndex)return He}return null}},{key:"renderClipPath",value:function(){var ve=this.clipPathId,Ee=this.state.offset,me=Ee.left,Ae=Ee.top,Oe=Ee.height,Ye=Ee.width;return kt.createElement("defs",null,kt.createElement("clipPath",{id:ve},kt.createElement("rect",{x:me,y:Ae,height:Oe,width:Ye})))}},{key:"getXScales",value:function(){var ve=this.state.xAxisMap;return ve?Object.entries(ve).reduce(function(Ee,me){var Ae=oj(me,2),Oe=Ae[0],Ye=Ae[1];return _n(_n({},Ee),{},Hr({},Oe,Ye.scale))},{}):null}},{key:"getYScales",value:function(){var ve=this.state.yAxisMap;return ve?Object.entries(ve).reduce(function(Ee,me){var Ae=oj(me,2),Oe=Ae[0],Ye=Ae[1];return _n(_n({},Ee),{},Hr({},Oe,Ye.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(ve){var Ee;return(Ee=this.state.xAxisMap)===null||Ee===void 0||(Ee=Ee[ve])===null||Ee===void 0?void 0:Ee.scale}},{key:"getYScaleByAxisId",value:function(ve){var Ee;return(Ee=this.state.yAxisMap)===null||Ee===void 0||(Ee=Ee[ve])===null||Ee===void 0?void 0:Ee.scale}},{key:"getItemByXY",value:function(ve){var Ee=this.state,me=Ee.formattedGraphicalItems,Ae=Ee.activeItem;if(me&&me.length)for(var Oe=0,Ye=me.length;Oe<Ye;Oe++){var He=me[Oe],st=He.props,Ke=He.item,Ot=Ke.type.defaultProps!==void 0?_n(_n({},Ke.type.defaultProps),Ke.props):Ke.props,Bt=Vd(Ke.type);if(Bt==="Bar"){var Tt=(st.data||[]).find(function(Zt){return ice(ve,Zt)});if(Tt)return{graphicalItem:He,payload:Tt}}else if(Bt==="RadialBar"){var mt=(st.data||[]).find(function(Zt){return MB(ve,Zt)});if(mt)return{graphicalItem:He,payload:mt}}else if(v2(He,Ae)||x2(He,Ae)||lx(He,Ae)){var bt=Xce({graphicalItem:He,activeTooltipItem:Ae,itemData:Ot.data}),Ft=Ot.activeIndex===void 0?bt:Ot.activeIndex;return{graphicalItem:_n(_n({},He),{},{childIndex:Ft}),payload:lx(He,Ae)?Ot.data[bt]:He.props.data[bt]}}}return null}},{key:"render",value:function(){var ve=this;if(!Bz(this))return null;var Ee=this.props,me=Ee.children,Ae=Ee.className,Oe=Ee.width,Ye=Ee.height,He=Ee.style,st=Ee.compact,Ke=Ee.title,Ot=Ee.desc,Bt=sj(Ee,wpe),Tt=ji(Bt,!1);if(st)return kt.createElement(VF,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},kt.createElement(KO,Yy({},Tt,{width:Oe,height:Ye,title:Ke,desc:Ot}),this.renderClipPath(),jz(me,this.renderMap)));if(this.props.accessibilityLayer){var mt,bt;Tt.tabIndex=(mt=this.props.tabIndex)!==null&&mt!==void 0?mt:0,Tt.role=(bt=this.props.role)!==null&&bt!==void 0?bt:"application",Tt.onKeyDown=function(Zt){ve.accessibilityManager.keyboardEvent(Zt)},Tt.onFocus=function(){ve.accessibilityManager.focus()}}var Ft=this.parseEventsOfWrapper();return kt.createElement(VF,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},kt.createElement("div",Yy({className:ia("recharts-wrapper",Ae),style:_n({position:"relative",cursor:"default",width:Oe,height:Ye},He)},Ft,{ref:function(Vt){ve.container=Vt}}),kt.createElement(KO,Yy({},Tt,{width:Oe,height:Ye,title:Ke,desc:Ot,style:Fpe}),this.renderClipPath(),jz(me,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(Jt.Component);Hr(ie,"displayName",a),Hr(ie,"defaultProps",_n({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},V)),Hr(ie,"getDerivedStateFromProps",function(ue,ge){var Se=ue.dataKey,ve=ue.data,Ee=ue.children,me=ue.width,Ae=ue.height,Oe=ue.layout,Ye=ue.stackOffset,He=ue.margin,st=ge.dataStartIndex,Ke=ge.dataEndIndex;if(ge.updateId===void 0){var Ot=cj(ue);return _n(_n(_n({},Ot),{},{updateId:0},ee(_n(_n({props:ue},Ot),{},{updateId:0}),ge)),{},{prevDataKey:Se,prevData:ve,prevWidth:me,prevHeight:Ae,prevLayout:Oe,prevStackOffset:Ye,prevMargin:He,prevChildren:Ee})}if(Se!==ge.prevDataKey||ve!==ge.prevData||me!==ge.prevWidth||Ae!==ge.prevHeight||Oe!==ge.prevLayout||Ye!==ge.prevStackOffset||!Ky(He,ge.prevMargin)){var Bt=cj(ue),Tt={chartX:ge.chartX,chartY:ge.chartY,isTooltipActive:ge.isTooltipActive},mt=_n(_n({},uj(ge,ve,Oe)),{},{updateId:ge.updateId+1}),bt=_n(_n(_n({},Bt),Tt),mt);return _n(_n(_n({},bt),ee(_n({props:ue},bt),ge)),{},{prevDataKey:Se,prevData:ve,prevWidth:me,prevHeight:Ae,prevLayout:Oe,prevStackOffset:Ye,prevMargin:He,prevChildren:Ee})}if(!ZO(Ee,ge.prevChildren)){var Ft,Zt,Vt,Ze,Xt=Wu(Ee,g_),an=Xt&&(Ft=(Zt=Xt.props)===null||Zt===void 0?void 0:Zt.startIndex)!==null&&Ft!==void 0?Ft:st,qt=Xt&&(Vt=(Ze=Xt.props)===null||Ze===void 0?void 0:Ze.endIndex)!==null&&Vt!==void 0?Vt:Ke,cn=an!==st||qt!==Ke,rr=!vi(ve),mr=rr&&!cn?ge.updateId:ge.updateId+1;return _n(_n({updateId:mr},ee(_n(_n({props:ue},ge),{},{updateId:mr,dataStartIndex:an,dataEndIndex:qt}),ge)),{},{prevChildren:Ee,dataStartIndex:an,dataEndIndex:qt})}return null}),Hr(ie,"renderActiveDot",function(ue,ge,Se){var ve;return Jt.isValidElement(ue)?ve=Jt.cloneElement(ue,ge):_i(ue)?ve=ue(ge):ve=kt.createElement(vq,ge),kt.createElement(mo,{className:"recharts-active-dot",key:Se},ve)});var le=Jt.forwardRef(function(ge,Se){return kt.createElement(ie,Yy({},ge,{ref:Se}))});return le.displayName=ie.displayName,le},Zpe=p7({chartName:"BarChart",GraphicalChild:kg,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:q_},{axisType:"yAxis",AxisComp:G_}],formatAxisMap:Iq}),Wpe=p7({chartName:"ScatterChart",GraphicalChild:Dx,defaultTooltipEventType:"item",validateTooltipEventTypes:["item"],axisComponents:[{axisType:"xAxis",AxisComp:q_},{axisType:"yAxis",AxisComp:G_},{axisType:"zAxis",AxisComp:kx}],formatAxisMap:Iq});const Lx=Jt.createContext(),Kpe=({children:e})=>{const[t,a]=Jt.useState({latLng:null,bufferArea:null,chartDataOvrly:null});return nn.jsx(Lx.Provider,{value:{state:t,setState:a},children:e})},Jpe=e=>e>=7?"#800026":e>=6.5?"#BD0026":e>=6?"#E31A1C":e>=5.5?"#FC4E2A":e>=5?"#FEB24C":e>=4.5?"#FFEDA0":"#8884d8",Qpe=({active:e,payload:t})=>{if(e&&(t!=null&&t.length)){const{name:a,magnitude:o,depth:c,year:b}=t[0].payload;return nn.jsxs("div",{style:{backgroundColor:"#fff",padding:"10px",border:"1px solid #ccc",color:"#000"},children:[nn.jsx("p",{children:`Location: ${a||"N/A"}`}),nn.jsx("p",{children:`Magnitude: ${o||"N/A"} Mw`}),nn.jsx("p",{children:`Depth: ${c||"N/A"} km`}),nn.jsx("p",{children:`Year: ${b||"N/A"}`})]})}return null},eme=()=>{const{setState:e}=Jt.useContext(Lx),t=Jt.useMemo(()=>_0.features.map(o=>({name:o.properties.location,magnitude:o.properties.magnitude,depth:o.properties.depth_km,year:o.properties.year,lat:o.geometry.coordinates[1],lng:o.geometry.coordinates[0],fill:Jpe(o.properties.magnitude)})),[_0]),a=o=>{(o==null?void 0:o.lat)!==void 0&&(o==null?void 0:o.lng)!==void 0&&e(c=>({...c,latLng:{lat:o.lat,lng:o.lng}}))};return nn.jsx(n8,{width:"80%",height:600,children:nn.jsxs(Wpe,{margin:{top:20,right:20,bottom:20,left:20},children:[nn.jsx(Zq,{strokeDasharray:"3 3"}),nn.jsx(q_,{type:"number",dataKey:"magnitude",name:"Magnitude",unit:" Mw",domain:[4,7]}),nn.jsx(G_,{type:"number",dataKey:"depth",name:"Depth",unit:" km",domain:[0,60]}),nn.jsx(kx,{type:"number",dataKey:"year",range:[50,500],name:"Year"}),nn.jsx(Ih,{content:nn.jsx(Qpe,{}),cursor:{strokeDasharray:"3 3"}}),nn.jsx(Dx,{name:"Earthquakes",data:t,fill:o=>o.fill,shape:"circle",onClick:a})]})})};function tme(){const{state:e}=Jt.useContext(Lx),t=Jt.useRef(),a=Jt.useRef(),o="Click to Explore, Building Dynamic Visualizations".split(" "),c={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},b={hidden:{opacity:0,y:10},visible:{opacity:1,y:0}};Jt.useEffect(()=>(Wy.accessToken="pk.eyJ1IjoiYW5kaXN1cnlhMTAiLCJhIjoiY2w4amt5bnFqMDJzajN3b2d6aTdjZXpkeiJ9.N3coQCudOQJRf5c5r8BVQA",t.current=new Wy.Map({container:a.current,style:"mapbox://styles/mapbox/satellite-v9",center:[111,-7.1],zoom:4,pitch:60,bearing:0,antialias:!0}),t.current.on("load",()=>{t.current.addSource("mapbox-dem",{type:"raster-dem",url:"mapbox://mapbox.mapbox-terrain-dem-v1",tileSize:512,maxzoom:14}),t.current.setTerrain({source:"mapbox-dem",exaggeration:1.5}),t.current.addLayer({id:"hillshading",source:"mapbox-dem",type:"hillshade"}),t.current.addSource("points",{type:"geojson",data:_0}),t.current.addLayer({id:"points",type:"circle",source:"points",paint:{"circle-radius":["interpolate",["linear"],["get","magnitude"],4.5,5,6,10,6.5,15,7,20],"circle-color":["interpolate",["linear"],["get","magnitude"],4.5,"#FFEDA0",5,"#FEB24C",5.5,"#FC4E2A",6,"#E31A1C",6.5,"#BD0026",7,"#800026"],"circle-opacity":.8,"circle-stroke-width":2,"circle-stroke-color":"#000"}}),t.current.addLayer({id:"buffer-zone",type:"circle",source:{type:"geojson",data:_0},paint:{"circle-radius":0,"circle-color":"rgba(255, 0, 0, 0.2)","circle-stroke-width":2,"circle-stroke-color":"#FF0000"}});let i=0;const P=9e4,L=()=>{i+=500,i>P&&(i=0),t.current.setPaintProperty("buffer-zone","circle-radius",{stops:[[0,0],[20,i]],base:2}),requestAnimationFrame(L)};L();const U=new Wy.LngLatBounds;_0.features.forEach(V=>{U.extend(V.geometry.coordinates)}),t.current.fitBounds(U,{padding:50,duration:5e3})}),()=>{t.current.remove()}),[]),Jt.useEffect(()=>{t.current&&e.latLng&&t.current.flyTo({center:e.latLng,zoom:10,speed:1.2,pitch:60,bearing:0,curve:1.42,essential:!0})},[e.latLng]);function S(){return nn.jsxs(Cr.div,{initial:{opacity:0,x:0,scale:.2},animate:{opacity:1,x:0,scale:1},transition:{duration:3},className:"absolute top-10 right-10 bg-black/30 text-black p-4 rounded-lg shadow-lg",children:[nn.jsx("h4",{className:"font-semibold mb-2",children:"Earthquake Magnitude"}),nn.jsxs("div",{className:"flex flex-col space-y-2",children:[nn.jsxs("div",{className:"flex items-center",children:[nn.jsx("div",{className:"w-4 h-4 rounded-full mr-2",style:{backgroundColor:"#FFEDA0"}}),nn.jsx("span",{children:"4.5 - 5.0"})]}),nn.jsxs("div",{className:"flex items-center",children:[nn.jsx("div",{className:"w-6 h-6 rounded-full mr-2",style:{backgroundColor:"#FEB24C"}}),nn.jsx("span",{children:"5.0 - 5.5"})]}),nn.jsxs("div",{className:"flex items-center",children:[nn.jsx("div",{className:"w-8 h-8 rounded-full mr-2",style:{backgroundColor:"#FC4E2A"}}),nn.jsx("span",{children:"5.5 - 6.0"})]}),nn.jsxs("div",{className:"flex items-center",children:[nn.jsx("div",{className:"w-10 h-10 rounded-full mr-2",style:{backgroundColor:"#E31A1C"}}),nn.jsx("span",{children:"6.0 - 6.5"})]}),nn.jsxs("div",{className:"flex items-center",children:[nn.jsx("div",{className:"w-12 h-12 rounded-full mr-2",style:{backgroundColor:"#BD0026"}}),nn.jsx("span",{children:"6.5 - 7.0"})]}),nn.jsxs("div",{className:"flex items-center",children:[nn.jsx("div",{className:"w-14 h-14 rounded-full mr-2",style:{backgroundColor:"#800026"}}),nn.jsx("span",{children:"7.0+"})]})]})]})}return nn.jsxs(Cr.div,{className:"h-1/2 w-[90vw] flex flex-col md:flex-row p-0 bg-white text-black text-lg shadow-2xl rounded-lg overflow-hidden",initial:{opacity:0,y:20,borderWidth:0},animate:{opacity:1,y:0,borderWidth:"2px"},transition:{type:"spring",stiffness:100,damping:10,duration:.5},children:[nn.jsxs(Cr.div,{className:"w-full md:w-1/2 p-6 flex flex-col justify-center items-center",variants:c,initial:"hidden",animate:"visible",children:[nn.jsx(Cr.div,{className:"flex flex-wrap justify-center mt-4",children:o.map((i,P)=>nn.jsx(Cr.span,{variants:b,className:"text-2xl text-blue-800 font-bold tracking-wide inline-block mr-2 mb-20",children:i},P))}),nn.jsx(eme,{})]}),nn.jsxs(Cr.div,{className:"w-full md:w-1/2 flex flex-col items-center justify-center p-8 border-r border-gray-600 relative",initial:{opacity:0,y:-50},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:100,damping:10},children:[nn.jsx(Cr.div,{id:"map-container",ref:a,className:"w-full h-[50vh] md:h-[60vh] rounded-lg overflow-hidden"}),nn.jsx(S,{})]})]})}var bu=63710088e-1,m7={centimeters:bu*100,centimetres:bu*100,degrees:360/(2*Math.PI),feet:bu*3.28084,inches:bu*39.37,kilometers:bu/1e3,kilometres:bu/1e3,meters:bu,metres:bu,miles:bu/1609.344,millimeters:bu*1e3,millimetres:bu*1e3,nauticalmiles:bu/1852,radians:1,yards:bu*1.0936};function lm(e,t,a={}){const o={type:"Feature"};return(a.id===0||a.id)&&(o.id=a.id),a.bbox&&(o.bbox=a.bbox),o.properties=t||{},o.geometry=e,o}function g7(e,t,a={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!fj(e[0])||!fj(e[1]))throw new Error("coordinates must contain numbers");return lm({type:"Point",coordinates:e},t,a)}function nme(e,t,a={}){if(e.length<2)throw new Error("coordinates must be an array of two or more positions");return lm({type:"LineString",coordinates:e},t,a)}function O_(e,t={}){const a={type:"FeatureCollection"};return t.id&&(a.id=t.id),t.bbox&&(a.bbox=t.bbox),a.features=e,a}function rme(e,t,a={}){return lm({type:"MultiLineString",coordinates:e},t,a)}function ime(e,t="kilometers"){const a=m7[t];if(!a)throw new Error(t+" units is invalid");return e*a}function ame(e,t="kilometers"){const a=m7[t];if(!a)throw new Error(t+" units is invalid");return e/a}function fj(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function ome(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function M2(e){return e.type==="Feature"?e.geometry:e}function y7(e,t,a){if(e!==null)for(var o,c,b,S,i,P,L,U=0,V=0,H,ee=e.type,ie=ee==="FeatureCollection",le=ee==="Feature",ue=ie?e.features.length:1,ge=0;ge<ue;ge++){L=ie?e.features[ge].geometry:le?e.geometry:e,H=L?L.type==="GeometryCollection":!1,i=H?L.geometries.length:1;for(var Se=0;Se<i;Se++){var ve=0,Ee=0;if(S=H?L.geometries[Se]:L,S!==null){P=S.coordinates;var me=S.type;switch(U=0,me){case null:break;case"Point":if(t(P,V,ge,ve,Ee)===!1)return!1;V++,ve++;break;case"LineString":case"MultiPoint":for(o=0;o<P.length;o++){if(t(P[o],V,ge,ve,Ee)===!1)return!1;V++,me==="MultiPoint"&&ve++}me==="LineString"&&ve++;break;case"Polygon":case"MultiLineString":for(o=0;o<P.length;o++){for(c=0;c<P[o].length-U;c++){if(t(P[o][c],V,ge,ve,Ee)===!1)return!1;V++}me==="MultiLineString"&&ve++,me==="Polygon"&&Ee++}me==="Polygon"&&ve++;break;case"MultiPolygon":for(o=0;o<P.length;o++){for(Ee=0,c=0;c<P[o].length;c++){for(b=0;b<P[o][c].length-U;b++){if(t(P[o][c][b],V,ge,ve,Ee)===!1)return!1;V++}Ee++}ve++}break;case"GeometryCollection":for(o=0;o<S.geometries.length;o++)if(y7(S.geometries[o],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function fC(e,t){if(e.type==="Feature")t(e,0);else if(e.type==="FeatureCollection")for(var a=0;a<e.features.length&&t(e.features[a],a)!==!1;a++);}function mR(e,t){var a,o,c,b,S,i,P,L,U,V,H=0,ee=e.type==="FeatureCollection",ie=e.type==="Feature",le=ee?e.features.length:1;for(a=0;a<le;a++){for(i=ee?e.features[a].geometry:ie?e.geometry:e,L=ee?e.features[a].properties:ie?e.properties:{},U=ee?e.features[a].bbox:ie?e.bbox:void 0,V=ee?e.features[a].id:ie?e.id:void 0,P=i?i.type==="GeometryCollection":!1,S=P?i.geometries.length:1,c=0;c<S;c++){if(b=P?i.geometries[c]:i,b===null){if(t(null,H,L,U,V)===!1)return!1;continue}switch(b.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(b,H,L,U,V)===!1)return!1;break}case"GeometryCollection":{for(o=0;o<b.geometries.length;o++)if(t(b.geometries[o],H,L,U,V)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}H++}}function Pw(e,t){mR(e,function(a,o,c,b,S){var i=a===null?null:a.type;switch(i){case null:case"Point":case"LineString":case"Polygon":return t(lm(a,c,{bbox:b,id:S}),o,0)===!1?!1:void 0}var P;switch(i){case"MultiPoint":P="Point";break;case"MultiLineString":P="LineString";break;case"MultiPolygon":P="Polygon";break}for(var L=0;L<a.coordinates.length;L++){var U=a.coordinates[L],V={type:P,coordinates:U};if(t(lm(V,c),o,L)===!1)return!1}})}function sme(e,t={}){if(e.bbox!=null&&t.recompute!==!0)return e.bbox;const a=[1/0,1/0,-1/0,-1/0];return y7(e,o=>{a[0]>o[0]&&(a[0]=o[0]),a[1]>o[1]&&(a[1]=o[1]),a[2]<o[0]&&(a[2]=o[0]),a[3]<o[1]&&(a[3]=o[1])}),a}const $d=11102230246251565e-32,vl=134217729,lme=(3+8*$d)*$d;function uO(e,t,a,o,c){let b,S,i,P,L=t[0],U=o[0],V=0,H=0;U>L==U>-L?(b=L,L=t[++V]):(b=U,U=o[++H]);let ee=0;if(V<e&&H<a)for(U>L==U>-L?(S=L+b,i=b-(S-L),L=t[++V]):(S=U+b,i=b-(S-U),U=o[++H]),b=S,i!==0&&(c[ee++]=i);V<e&&H<a;)U>L==U>-L?(S=b+L,P=S-b,i=b-(S-P)+(L-P),L=t[++V]):(S=b+U,P=S-b,i=b-(S-P)+(U-P),U=o[++H]),b=S,i!==0&&(c[ee++]=i);for(;V<e;)S=b+L,P=S-b,i=b-(S-P)+(L-P),L=t[++V],b=S,i!==0&&(c[ee++]=i);for(;H<a;)S=b+U,P=S-b,i=b-(S-P)+(U-P),U=o[++H],b=S,i!==0&&(c[ee++]=i);return(b!==0||ee===0)&&(c[ee++]=b),ee}function ume(e,t){let a=t[0];for(let o=1;o<e;o++)a+=t[o];return a}function zx(e){return new Float64Array(e)}const cme=(3+16*$d)*$d,hme=(2+12*$d)*$d,fme=(9+64*$d)*$d*$d,Ny=zx(4),dj=zx(8),pj=zx(12),mj=zx(16),Xl=zx(4);function dme(e,t,a,o,c,b,S){let i,P,L,U,V,H,ee,ie,le,ue,ge,Se,ve,Ee,me,Ae,Oe,Ye;const He=e-c,st=a-c,Ke=t-b,Ot=o-b;Ee=He*Ot,H=vl*He,ee=H-(H-He),ie=He-ee,H=vl*Ot,le=H-(H-Ot),ue=Ot-le,me=ie*ue-(Ee-ee*le-ie*le-ee*ue),Ae=Ke*st,H=vl*Ke,ee=H-(H-Ke),ie=Ke-ee,H=vl*st,le=H-(H-st),ue=st-le,Oe=ie*ue-(Ae-ee*le-ie*le-ee*ue),ge=me-Oe,V=me-ge,Ny[0]=me-(ge+V)+(V-Oe),Se=Ee+ge,V=Se-Ee,ve=Ee-(Se-V)+(ge-V),ge=ve-Ae,V=ve-ge,Ny[1]=ve-(ge+V)+(V-Ae),Ye=Se+ge,V=Ye-Se,Ny[2]=Se-(Ye-V)+(ge-V),Ny[3]=Ye;let Bt=ume(4,Ny),Tt=hme*S;if(Bt>=Tt||-Bt>=Tt||(V=e-He,i=e-(He+V)+(V-c),V=a-st,L=a-(st+V)+(V-c),V=t-Ke,P=t-(Ke+V)+(V-b),V=o-Ot,U=o-(Ot+V)+(V-b),i===0&&P===0&&L===0&&U===0)||(Tt=fme*S+lme*Math.abs(Bt),Bt+=He*U+Ot*i-(Ke*L+st*P),Bt>=Tt||-Bt>=Tt))return Bt;Ee=i*Ot,H=vl*i,ee=H-(H-i),ie=i-ee,H=vl*Ot,le=H-(H-Ot),ue=Ot-le,me=ie*ue-(Ee-ee*le-ie*le-ee*ue),Ae=P*st,H=vl*P,ee=H-(H-P),ie=P-ee,H=vl*st,le=H-(H-st),ue=st-le,Oe=ie*ue-(Ae-ee*le-ie*le-ee*ue),ge=me-Oe,V=me-ge,Xl[0]=me-(ge+V)+(V-Oe),Se=Ee+ge,V=Se-Ee,ve=Ee-(Se-V)+(ge-V),ge=ve-Ae,V=ve-ge,Xl[1]=ve-(ge+V)+(V-Ae),Ye=Se+ge,V=Ye-Se,Xl[2]=Se-(Ye-V)+(ge-V),Xl[3]=Ye;const mt=uO(4,Ny,4,Xl,dj);Ee=He*U,H=vl*He,ee=H-(H-He),ie=He-ee,H=vl*U,le=H-(H-U),ue=U-le,me=ie*ue-(Ee-ee*le-ie*le-ee*ue),Ae=Ke*L,H=vl*Ke,ee=H-(H-Ke),ie=Ke-ee,H=vl*L,le=H-(H-L),ue=L-le,Oe=ie*ue-(Ae-ee*le-ie*le-ee*ue),ge=me-Oe,V=me-ge,Xl[0]=me-(ge+V)+(V-Oe),Se=Ee+ge,V=Se-Ee,ve=Ee-(Se-V)+(ge-V),ge=ve-Ae,V=ve-ge,Xl[1]=ve-(ge+V)+(V-Ae),Ye=Se+ge,V=Ye-Se,Xl[2]=Se-(Ye-V)+(ge-V),Xl[3]=Ye;const bt=uO(mt,dj,4,Xl,pj);Ee=i*U,H=vl*i,ee=H-(H-i),ie=i-ee,H=vl*U,le=H-(H-U),ue=U-le,me=ie*ue-(Ee-ee*le-ie*le-ee*ue),Ae=P*L,H=vl*P,ee=H-(H-P),ie=P-ee,H=vl*L,le=H-(H-L),ue=L-le,Oe=ie*ue-(Ae-ee*le-ie*le-ee*ue),ge=me-Oe,V=me-ge,Xl[0]=me-(ge+V)+(V-Oe),Se=Ee+ge,V=Se-Ee,ve=Ee-(Se-V)+(ge-V),ge=ve-Ae,V=ve-ge,Xl[1]=ve-(ge+V)+(V-Ae),Ye=Se+ge,V=Ye-Se,Xl[2]=Se-(Ye-V)+(ge-V),Xl[3]=Ye;const Ft=uO(bt,pj,4,Xl,mj);return mj[Ft-1]}function pme(e,t,a,o,c,b){const S=(t-b)*(a-c),i=(e-c)*(o-b),P=S-i,L=Math.abs(S+i);return Math.abs(P)>=cme*L?P:-dme(e,t,a,o,c,b,L)}function mme(e,t){var a,o,c=0,b,S,i,P,L,U,V,H=e[0],ee=e[1],ie=t.length;for(a=0;a<ie;a++){o=0;var le=t[a],ue=le.length-1;if(U=le[0],U[0]!==le[ue][0]&&U[1]!==le[ue][1])throw new Error("First and last coordinates in a ring must be the same");for(S=U[0]-H,i=U[1]-ee,o;o<ue;o++){if(V=le[o+1],P=V[0]-H,L=V[1]-ee,i===0&&L===0){if(P<=0&&S>=0||S<=0&&P>=0)return 0}else if(L>=0&&i<=0||L<=0&&i>=0){if(b=pme(S,P,i,L,0,0),b===0)return 0;(b>0&&L>0&&i<=0||b<0&&L<=0&&i>0)&&c++}U=V,i=L,S=P}}return c%2!==0}function mx(e,t,a={}){if(!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");const o=ome(e),c=M2(t),b=c.type,S=t.bbox;let i=c.coordinates;if(S&&gme(o,S)===!1)return!1;b==="Polygon"&&(i=[i]);let P=!1;for(var L=0;L<i.length;++L){const U=mme(o,i[L]);if(U===0)return!a.ignoreBoundary;U&&(P=!0)}return P}function gme(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]}class _7{constructor(t=[],a=yme){if(this.data=t,this.length=this.data.length,this.compare=a,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:a,compare:o}=this,c=a[t];for(;t>0;){const b=t-1>>1,S=a[b];if(o(c,S)>=0)break;a[t]=S,t=b}a[t]=c}_down(t){const{data:a,compare:o}=this,c=this.length>>1,b=a[t];for(;t<c;){let S=(t<<1)+1,i=a[S];const P=S+1;if(P<this.length&&o(a[P],i)<0&&(S=P,i=a[P]),o(i,b)>=0)break;a[t]=i,t=S}a[t]=b}}function yme(e,t){return e<t?-1:e>t?1:0}function v7(e,t){return e.p.x>t.p.x?1:e.p.x<t.p.x?-1:e.p.y!==t.p.y?e.p.y>t.p.y?1:-1:1}function _me(e,t){return e.rightSweepEvent.p.x>t.rightSweepEvent.p.x?1:e.rightSweepEvent.p.x<t.rightSweepEvent.p.x?-1:e.rightSweepEvent.p.y!==t.rightSweepEvent.p.y?e.rightSweepEvent.p.y<t.rightSweepEvent.p.y?1:-1:1}class gj{constructor(t,a,o,c){this.p={x:t[0],y:t[1]},this.featureId=a,this.ringId=o,this.eventId=c,this.otherEvent=null,this.isLeftEndpoint=null}isSamePoint(t){return this.p.x===t.p.x&&this.p.y===t.p.y}}function vme(e,t){if(e.type==="FeatureCollection"){const a=e.features;for(let o=0;o<a.length;o++)yj(a[o],t)}else yj(e,t)}let ab=0,ob=0,sb=0;function yj(e,t){const a=e.type==="Feature"?e.geometry:e;let o=a.coordinates;(a.type==="Polygon"||a.type==="MultiLineString")&&(o=[o]),a.type==="LineString"&&(o=[[o]]);for(let c=0;c<o.length;c++)for(let b=0;b<o[c].length;b++){let S=o[c][b][0],i=null;ob=ob+1;for(let P=0;P<o[c][b].length-1;P++){i=o[c][b][P+1];const L=new gj(S,ab,ob,sb),U=new gj(i,ab,ob,sb+1);L.otherEvent=U,U.otherEvent=L,v7(L,U)>0?(U.isLeftEndpoint=!0,L.isLeftEndpoint=!1):(L.isLeftEndpoint=!0,U.isLeftEndpoint=!1),t.push(L),t.push(U),S=i,sb=sb+1}}ab=ab+1}class xme{constructor(t){this.leftSweepEvent=t,this.rightSweepEvent=t.otherEvent}}function bme(e,t){if(e===null||t===null||e.leftSweepEvent.ringId===t.leftSweepEvent.ringId&&(e.rightSweepEvent.isSamePoint(t.leftSweepEvent)||e.rightSweepEvent.isSamePoint(t.leftSweepEvent)||e.rightSweepEvent.isSamePoint(t.rightSweepEvent)||e.leftSweepEvent.isSamePoint(t.leftSweepEvent)||e.leftSweepEvent.isSamePoint(t.rightSweepEvent)))return!1;const a=e.leftSweepEvent.p.x,o=e.leftSweepEvent.p.y,c=e.rightSweepEvent.p.x,b=e.rightSweepEvent.p.y,S=t.leftSweepEvent.p.x,i=t.leftSweepEvent.p.y,P=t.rightSweepEvent.p.x,L=t.rightSweepEvent.p.y,U=(L-i)*(c-a)-(P-S)*(b-o),V=(P-S)*(o-i)-(L-i)*(a-S),H=(c-a)*(o-i)-(b-o)*(a-S);if(U===0)return!1;const ee=V/U,ie=H/U;if(ee>=0&&ee<=1&&ie>=0&&ie<=1){const le=a+ee*(c-a),ue=o+ee*(b-o);return[le,ue]}return!1}function wme(e,t){t=t||!1;const a=[],o=new _7([],_me);for(;e.length;){const c=e.pop();if(c.isLeftEndpoint){const b=new xme(c);for(let S=0;S<o.data.length;S++){const i=o.data[S];if(t&&i.leftSweepEvent.featureId===c.featureId)continue;const P=bme(b,i);P!==!1&&a.push(P)}o.push(b)}else c.isLeftEndpoint===!1&&o.pop()}return a}function Sme(e,t){const a=new _7([],v7);return vme(e,a),wme(a,t)}var Tme=Sme;function gR(e,t,a={}){const{removeDuplicates:o=!0,ignoreSelfIntersections:c=!0}=a;let b=[];e.type==="FeatureCollection"?b=b.concat(e.features):e.type==="Feature"?b.push(e):(e.type==="LineString"||e.type==="Polygon"||e.type==="MultiLineString"||e.type==="MultiPolygon")&&b.push(lm(e)),t.type==="FeatureCollection"?b=b.concat(t.features):t.type==="Feature"?b.push(t):(t.type==="LineString"||t.type==="Polygon"||t.type==="MultiLineString"||t.type==="MultiPolygon")&&b.push(lm(t));const S=Tme(O_(b),c);let i=[];if(o){const P={};S.forEach(L=>{const U=L.join(",");P[U]||(P[U]=!0,i.push(L))})}else i=S;return O_(i.map(P=>g7(P)))}function dC(e,t={}){const a=M2(e);switch(!t.properties&&e.type==="Feature"&&(t.properties=e.properties),a.type){case"Polygon":return Eme(a,t);case"MultiPolygon":return Ame(a,t);default:throw new Error("invalid poly")}}function Eme(e,t={}){const o=M2(e).coordinates,c=t.properties?t.properties:e.type==="Feature"?e.properties:{};return x7(o,c)}function Ame(e,t={}){const o=M2(e).coordinates,c=t.properties?t.properties:e.type==="Feature"?e.properties:{},b=[];return o.forEach(S=>{b.push(x7(S,c))}),O_(b)}function x7(e,t){return e.length>1?rme(e,t):nme(e[0],t)}function Mme(e,t,{ignoreSelfIntersections:a=!0}={ignoreSelfIntersections:!0}){let o=!0;return Pw(e,c=>{Pw(t,b=>{if(o===!1)return!1;o=Ome(c.geometry,b.geometry,a)})}),o}function Ome(e,t,a){switch(e.type){case"Point":switch(t.type){case"Point":return!Rme(e.coordinates,t.coordinates);case"LineString":return!_j(t,e);case"Polygon":return!mx(e,t)}break;case"LineString":switch(t.type){case"Point":return!_j(e,t);case"LineString":return!Ime(e,t,a);case"Polygon":return!vj(t,e,a)}break;case"Polygon":switch(t.type){case"Point":return!mx(t,e);case"LineString":return!vj(e,t,a);case"Polygon":return!Cme(t,e,a)}}return!1}function _j(e,t){for(let a=0;a<e.coordinates.length-1;a++)if(Pme(e.coordinates[a],e.coordinates[a+1],t.coordinates))return!0;return!1}function Ime(e,t,a){return gR(e,t,{ignoreSelfIntersections:a}).features.length>0}function vj(e,t,a){for(const c of t.coordinates)if(mx(c,e))return!0;return gR(t,dC(e),{ignoreSelfIntersections:a}).features.length>0}function Cme(e,t,a){for(const c of e.coordinates[0])if(mx(c,t))return!0;for(const c of t.coordinates[0])if(mx(c,e))return!0;return gR(dC(e),dC(t),{ignoreSelfIntersections:a}).features.length>0}function Pme(e,t,a){const o=a[0]-e[0],c=a[1]-e[1],b=t[0]-e[0],S=t[1]-e[1];return o*S-c*b!==0?!1:Math.abs(b)>=Math.abs(S)?b>0?e[0]<=a[0]&&a[0]<=t[0]:t[0]<=a[0]&&a[0]<=e[0]:S>0?e[1]<=a[1]&&a[1]<=t[1]:t[1]<=a[1]&&a[1]<=e[1]}function Rme(e,t){return e[0]===t[0]&&e[1]===t[1]}function kme(e,t,{ignoreSelfIntersections:a=!0}={}){let o=!1;return Pw(e,c=>{Pw(t,b=>{if(o===!0)return!0;o=!Mme(c.geometry,b.geometry,{ignoreSelfIntersections:a})})}),o}function Dme(e,t={}){const a=sme(e),o=(a[0]+a[2])/2,c=(a[1]+a[3])/2;return g7([o,c],t.properties,t)}var wb={exports:{}},Lme=wb.exports,xj;function zme(){return xj||(xj=1,function(e,t){(function(a,o){e.exports=o()})(Lme,function(){function a(C,g){(g==null||g>C.length)&&(g=C.length);for(var x=0,O=Array(g);x<g;x++)O[x]=C[x];return O}function o(C,g,x){return g=U(g),function(O,$){if($&&(typeof $=="object"||typeof $=="function"))return $;if($!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(te){if(te===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return te}(O)}(C,H()?Reflect.construct(g,x||[],U(C).constructor):g.apply(C,x))}function c(C,g){if(!(C instanceof g))throw new TypeError("Cannot call a class as a function")}function b(C,g,x){if(H())return Reflect.construct.apply(null,arguments);var O=[null];O.push.apply(O,g);var $=new(C.bind.apply(C,O));return x&&ee($,x.prototype),$}function S(C,g){for(var x=0;x<g.length;x++){var O=g[x];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(C,ue(O.key),O)}}function i(C,g,x){return g&&S(C.prototype,g),x&&S(C,x),Object.defineProperty(C,"prototype",{writable:!1}),C}function P(C,g){var x=typeof Symbol<"u"&&C[Symbol.iterator]||C["@@iterator"];if(!x){if(Array.isArray(C)||(x=ge(C))||g){x&&(C=x);var O=0,$=function(){};return{s:$,n:function(){return O>=C.length?{done:!0}:{done:!1,value:C[O++]}},e:function(Be){throw Be},f:$}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var te,he=!0,Te=!1;return{s:function(){x=x.call(C)},n:function(){var Be=x.next();return he=Be.done,Be},e:function(Be){Te=!0,te=Be},f:function(){try{he||x.return==null||x.return()}finally{if(Te)throw te}}}}function L(){return L=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(C,g,x){var O=function(te,he){for(;!{}.hasOwnProperty.call(te,he)&&(te=U(te))!==null;);return te}(C,g);if(O){var $=Object.getOwnPropertyDescriptor(O,g);return $.get?$.get.call(arguments.length<3?C:x):$.value}},L.apply(null,arguments)}function U(C){return U=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(g){return g.__proto__||Object.getPrototypeOf(g)},U(C)}function V(C,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function");C.prototype=Object.create(g&&g.prototype,{constructor:{value:C,writable:!0,configurable:!0}}),Object.defineProperty(C,"prototype",{writable:!1}),g&&ee(C,g)}function H(){try{var C=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(H=function(){return!!C})()}function ee(C,g){return ee=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(x,O){return x.__proto__=O,x},ee(C,g)}function ie(C,g,x,O){var $=L(U(1&O?C.prototype:C),g,x);return 2&O&&typeof $=="function"?function(te){return $.apply(x,te)}:$}function le(C){return function(g){if(Array.isArray(g))return a(g)}(C)||function(g){if(typeof Symbol<"u"&&g[Symbol.iterator]!=null||g["@@iterator"]!=null)return Array.from(g)}(C)||ge(C)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ue(C){var g=function(x,O){if(typeof x!="object"||!x)return x;var $=x[Symbol.toPrimitive];if($!==void 0){var te=$.call(x,O);if(typeof te!="object")return te;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(x)}(C,"string");return typeof g=="symbol"?g:g+""}function ge(C,g){if(C){if(typeof C=="string")return a(C,g);var x={}.toString.call(C).slice(8,-1);return x==="Object"&&C.constructor&&(x=C.constructor.name),x==="Map"||x==="Set"?Array.from(C):x==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(x)?a(C,g):void 0}}function Se(C){var g=typeof Map=="function"?new Map:void 0;return Se=function(x){if(x===null||!function($){try{return Function.toString.call($).indexOf("[native code]")!==-1}catch{return typeof $=="function"}}(x))return x;if(typeof x!="function")throw new TypeError("Super expression must either be null or a function");if(g!==void 0){if(g.has(x))return g.get(x);g.set(x,O)}function O(){return b(x,arguments,U(this).constructor)}return O.prototype=Object.create(x.prototype,{constructor:{value:O,enumerable:!1,writable:!0,configurable:!0}}),ee(O,x)},Se(C)}var ve=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"getEndCapStyle",value:function(){return this._endCapStyle}},{key:"isSingleSided",value:function(){return this._isSingleSided}},{key:"setQuadrantSegments",value:function(g){this._quadrantSegments=g,this._quadrantSegments===0&&(this._joinStyle=C.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=C.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),g<=0&&(this._quadrantSegments=1),this._joinStyle!==C.JOIN_ROUND&&(this._quadrantSegments=C.DEFAULT_QUADRANT_SEGMENTS)}},{key:"getJoinStyle",value:function(){return this._joinStyle}},{key:"setJoinStyle",value:function(g){this._joinStyle=g}},{key:"setSimplifyFactor",value:function(g){this._simplifyFactor=g<0?0:g}},{key:"getSimplifyFactor",value:function(){return this._simplifyFactor}},{key:"getQuadrantSegments",value:function(){return this._quadrantSegments}},{key:"setEndCapStyle",value:function(g){this._endCapStyle=g}},{key:"getMitreLimit",value:function(){return this._mitreLimit}},{key:"setMitreLimit",value:function(g){this._mitreLimit=g}},{key:"setSingleSided",value:function(g){this._isSingleSided=g}}],[{key:"constructor_",value:function(){if(this._quadrantSegments=C.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=C.CAP_ROUND,this._joinStyle=C.JOIN_ROUND,this._mitreLimit=C.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=C.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var g=arguments[0];this.setQuadrantSegments(g)}else if(arguments.length===2){var x=arguments[0],O=arguments[1];this.setQuadrantSegments(x),this.setEndCapStyle(O)}else if(arguments.length===4){var $=arguments[0],te=arguments[1],he=arguments[2],Te=arguments[3];this.setQuadrantSegments($),this.setEndCapStyle(te),this.setJoinStyle(he),this.setMitreLimit(Te)}}}},{key:"bufferDistanceError",value:function(g){var x=Math.PI/2/g;return 1-Math.cos(x/2)}}])}();ve.CAP_ROUND=1,ve.CAP_FLAT=2,ve.CAP_SQUARE=3,ve.JOIN_ROUND=1,ve.JOIN_MITRE=2,ve.JOIN_BEVEL=3,ve.DEFAULT_QUADRANT_SEGMENTS=8,ve.DEFAULT_MITRE_LIMIT=5,ve.DEFAULT_SIMPLIFY_FACTOR=.01;var Ee=function(C){function g(x){var O;return c(this,g),(O=o(this,g,[x])).name=Object.keys({Exception:g})[0],O}return V(g,C),i(g,[{key:"toString",value:function(){return this.message}}])}(Se(Error)),me=function(C){function g(x){var O;return c(this,g),(O=o(this,g,[x])).name=Object.keys({IllegalArgumentException:g})[0],O}return V(g,C),i(g)}(Ee),Ae=function(){return i(function C(){c(this,C)},[{key:"filter",value:function(C){}}])}();function Oe(){}function Ye(){}function He(){}var st,Ke,Ot,Bt,Tt,mt,bt,Ft,Zt=function(){return i(function C(){c(this,C)},null,[{key:"equalsWithTolerance",value:function(C,g,x){return Math.abs(C-g)<=x}}])}(),Vt=function(){return i(function C(g,x){c(this,C),this.low=x||0,this.high=g||0},null,[{key:"toBinaryString",value:function(C){var g,x="";for(g=2147483648;g>0;g>>>=1)x+=(C.high&g)===g?"1":"0";for(g=2147483648;g>0;g>>>=1)x+=(C.low&g)===g?"1":"0";return x}}])}();function Ze(){}function Xt(){}Ze.NaN=NaN,Ze.isNaN=function(C){return Number.isNaN(C)},Ze.isInfinite=function(C){return!Number.isFinite(C)},Ze.MAX_VALUE=Number.MAX_VALUE,Ze.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,Ze.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,typeof Float64Array=="function"&&typeof Int32Array=="function"?(mt=2146435072,bt=new Float64Array(1),Ft=new Int32Array(bt.buffer),Ze.doubleToLongBits=function(C){bt[0]=C;var g=0|Ft[0],x=0|Ft[1];return(x&mt)===mt&&1048575&x&&g!==0&&(g=0,x=2146959360),new Vt(x,g)},Ze.longBitsToDouble=function(C){return Ft[0]=C.low,Ft[1]=C.high,bt[0]}):(st=1023,Ke=Math.log2,Ot=Math.floor,Bt=Math.pow,Tt=function(){for(var C=53;C>0;C--){var g=Bt(2,C)-1;if(Ot(Ke(g))+1===C)return g}return 0}(),Ze.doubleToLongBits=function(C){var g,x,O,$,te,he,Te,Be,et;if(C<0||1/C===Number.NEGATIVE_INFINITY?(he=1<<31,C=-C):he=0,C===0)return new Vt(Be=he,et=0);if(C===1/0)return new Vt(Be=2146435072|he,et=0);if(C!=C)return new Vt(Be=2146959360,et=0);if($=0,et=0,(g=Ot(C))>1)if(g<=Tt)($=Ot(Ke(g)))<=20?(et=0,Be=g<<20-$&1048575):(et=g%(x=Bt(2,O=$-20))<<32-O,Be=g/x&1048575);else for(O=g,et=0;(O=Ot(x=O/2))!==0;)$++,et>>>=1,et|=(1&Be)<<31,Be>>>=1,x!==O&&(Be|=524288);if(Te=$+st,te=g===0,g=C-g,$<52&&g!==0)for(O=0;;){if((x=2*g)>=1?(g=x-1,te?(Te--,te=!1):(O<<=1,O|=1,$++)):(g=x,te?--Te==0&&($++,te=!1):(O<<=1,$++)),$===20)Be|=O,O=0;else if($===52){et|=O;break}if(x===1){$<20?Be|=O<<20-$:$<52&&(et|=O<<52-$);break}}return Be|=Te<<20,new Vt(Be|=he,et)},Ze.longBitsToDouble=function(C){var g,x,O,$,te=C.high,he=C.low,Te=te&1<<31?-1:1;for(O=((2146435072&te)>>20)-st,$=0,x=1<<19,g=1;g<=20;g++)te&x&&($+=Bt(2,-g)),x>>>=1;for(x=1<<31,g=21;g<=52;g++)he&x&&($+=Bt(2,-g)),x>>>=1;if(O===-1023){if($===0)return 0*Te;O=-1022}else{if(O===1024)return $===0?Te/0:NaN;$+=1}return Te*$*Bt(2,O)});var an=function(C){function g(x){var O;return c(this,g),(O=o(this,g,[x])).name=Object.keys({RuntimeException:g})[0],O}return V(g,C),i(g)}(Ee),qt=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,null,[{key:"constructor_",value:function(){if(arguments.length===0)an.constructor_.call(this);else if(arguments.length===1){var x=arguments[0];an.constructor_.call(this,x)}}}])}(an),cn=function(){function C(){c(this,C)}return i(C,null,[{key:"shouldNeverReachHere",value:function(){if(arguments.length===0)C.shouldNeverReachHere(null);else if(arguments.length===1){var g=arguments[0];throw new qt("Should never reach here"+(g!==null?": "+g:""))}}},{key:"isTrue",value:function(){if(arguments.length===1){var g=arguments[0];C.isTrue(g,null)}else if(arguments.length===2){var x=arguments[1];if(!arguments[0])throw x===null?new qt:new qt(x)}}},{key:"equals",value:function(){if(arguments.length===2){var g=arguments[0],x=arguments[1];C.equals(g,x,null)}else if(arguments.length===3){var O=arguments[0],$=arguments[1],te=arguments[2];if(!$.equals(O))throw new qt("Expected "+O+" but encountered "+$+(te!==null?": "+te:""))}}}])}(),rr=new ArrayBuffer(8),mr=new Float64Array(rr),Ci=new Int32Array(rr),Et=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"getM",value:function(){return Ze.NaN}},{key:"setOrdinate",value:function(g,x){switch(g){case C.X:this.x=x;break;case C.Y:this.y=x;break;case C.Z:this.setZ(x);break;default:throw new me("Invalid ordinate index: "+g)}}},{key:"equals2D",value:function(){if(arguments.length===1){var g=arguments[0];return this.x===g.x&&this.y===g.y}if(arguments.length===2){var x=arguments[0],O=arguments[1];return!!Zt.equalsWithTolerance(this.x,x.x,O)&&!!Zt.equalsWithTolerance(this.y,x.y,O)}}},{key:"setM",value:function(g){throw new me("Invalid ordinate index: "+C.M)}},{key:"getZ",value:function(){return this.z}},{key:"getOrdinate",value:function(g){switch(g){case C.X:return this.x;case C.Y:return this.y;case C.Z:return this.getZ()}throw new me("Invalid ordinate index: "+g)}},{key:"equals3D",value:function(g){return this.x===g.x&&this.y===g.y&&(this.getZ()===g.getZ()||Ze.isNaN(this.getZ())&&Ze.isNaN(g.getZ()))}},{key:"equals",value:function(g){return g instanceof C&&this.equals2D(g)}},{key:"equalInZ",value:function(g,x){return Zt.equalsWithTolerance(this.getZ(),g.getZ(),x)}},{key:"setX",value:function(g){this.x=g}},{key:"compareTo",value:function(g){var x=g;return this.x<x.x?-1:this.x>x.x?1:this.y<x.y?-1:this.y>x.y?1:0}},{key:"getX",value:function(){return this.x}},{key:"setZ",value:function(g){this.z=g}},{key:"clone",value:function(){try{return null}catch(g){if(g instanceof CloneNotSupportedException)return cn.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw g}}},{key:"copy",value:function(){return new C(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}},{key:"distance3D",value:function(g){var x=this.x-g.x,O=this.y-g.y,$=this.getZ()-g.getZ();return Math.sqrt(x*x+O*O+$*$)}},{key:"getY",value:function(){return this.y}},{key:"setY",value:function(g){this.y=g}},{key:"distance",value:function(g){var x=this.x-g.x,O=this.y-g.y;return Math.sqrt(x*x+O*O)}},{key:"hashCode",value:function(){var g=17;return g=37*(g=37*g+C.hashCode(this.x))+C.hashCode(this.y)}},{key:"setCoordinate",value:function(g){this.x=g.x,this.y=g.y,this.z=g.getZ()}},{key:"interfaces_",get:function(){return[Oe,Ye,He]}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)C.constructor_.call(this,0,0);else if(arguments.length===1){var g=arguments[0];C.constructor_.call(this,g.x,g.y,g.getZ())}else if(arguments.length===2){var x=arguments[0],O=arguments[1];C.constructor_.call(this,x,O,C.NULL_ORDINATE)}else if(arguments.length===3){var $=arguments[0],te=arguments[1],he=arguments[2];this.x=$,this.y=te,this.z=he}}},{key:"hashCode",value:function(g){return mr[0]=g,Ci[0]^Ci[1]}}])}(),Ln=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"compare",value:function(g,x){var O=C.compare(g.x,x.x);if(O!==0)return O;var $=C.compare(g.y,x.y);return $!==0?$:this._dimensionsToTest<=2?0:C.compare(g.getZ(),x.getZ())}},{key:"interfaces_",get:function(){return[Xt]}}],[{key:"constructor_",value:function(){if(this._dimensionsToTest=2,arguments.length===0)C.constructor_.call(this,2);else if(arguments.length===1){var g=arguments[0];if(g!==2&&g!==3)throw new me("only 2 or 3 dimensions may be specified");this._dimensionsToTest=g}}},{key:"compare",value:function(g,x){return g<x?-1:g>x?1:Ze.isNaN(g)?Ze.isNaN(x)?0:-1:Ze.isNaN(x)?1:0}}])}();Et.DimensionalComparator=Ln,Et.NULL_ORDINATE=Ze.NaN,Et.X=0,Et.Y=1,Et.Z=2,Et.M=3;var Ne=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"getArea",value:function(){return this.getWidth()*this.getHeight()}},{key:"equals",value:function(g){if(!(g instanceof C))return!1;var x=g;return this.isNull()?x.isNull():this._maxx===x.getMaxX()&&this._maxy===x.getMaxY()&&this._minx===x.getMinX()&&this._miny===x.getMinY()}},{key:"intersection",value:function(g){if(this.isNull()||g.isNull()||!this.intersects(g))return new C;var x=this._minx>g._minx?this._minx:g._minx,O=this._miny>g._miny?this._miny:g._miny;return new C(x,this._maxx<g._maxx?this._maxx:g._maxx,O,this._maxy<g._maxy?this._maxy:g._maxy)}},{key:"isNull",value:function(){return this._maxx<this._minx}},{key:"getMaxX",value:function(){return this._maxx}},{key:"covers",value:function(){if(arguments.length===1){if(arguments[0]instanceof Et){var g=arguments[0];return this.covers(g.x,g.y)}if(arguments[0]instanceof C){var x=arguments[0];return!this.isNull()&&!x.isNull()&&x.getMinX()>=this._minx&&x.getMaxX()<=this._maxx&&x.getMinY()>=this._miny&&x.getMaxY()<=this._maxy}}else if(arguments.length===2){var O=arguments[0],$=arguments[1];return!this.isNull()&&O>=this._minx&&O<=this._maxx&&$>=this._miny&&$<=this._maxy}}},{key:"intersects",value:function(){if(arguments.length===1){if(arguments[0]instanceof C){var g=arguments[0];return!this.isNull()&&!g.isNull()&&!(g._minx>this._maxx||g._maxx<this._minx||g._miny>this._maxy||g._maxy<this._miny)}if(arguments[0]instanceof Et){var x=arguments[0];return this.intersects(x.x,x.y)}}else if(arguments.length===2){if(arguments[0]instanceof Et&&arguments[1]instanceof Et){var O=arguments[0],$=arguments[1];return!this.isNull()&&!((O.x<$.x?O.x:$.x)>this._maxx)&&!((O.x>$.x?O.x:$.x)<this._minx)&&!((O.y<$.y?O.y:$.y)>this._maxy)&&!((O.y>$.y?O.y:$.y)<this._miny)}if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var te=arguments[0],he=arguments[1];return!this.isNull()&&!(te>this._maxx||te<this._minx||he>this._maxy||he<this._miny)}}}},{key:"getMinY",value:function(){return this._miny}},{key:"getDiameter",value:function(){if(this.isNull())return 0;var g=this.getWidth(),x=this.getHeight();return Math.sqrt(g*g+x*x)}},{key:"getMinX",value:function(){return this._minx}},{key:"expandToInclude",value:function(){if(arguments.length===1){if(arguments[0]instanceof Et){var g=arguments[0];this.expandToInclude(g.x,g.y)}else if(arguments[0]instanceof C){var x=arguments[0];if(x.isNull())return null;this.isNull()?(this._minx=x.getMinX(),this._maxx=x.getMaxX(),this._miny=x.getMinY(),this._maxy=x.getMaxY()):(x._minx<this._minx&&(this._minx=x._minx),x._maxx>this._maxx&&(this._maxx=x._maxx),x._miny<this._miny&&(this._miny=x._miny),x._maxy>this._maxy&&(this._maxy=x._maxy))}}else if(arguments.length===2){var O=arguments[0],$=arguments[1];this.isNull()?(this._minx=O,this._maxx=O,this._miny=$,this._maxy=$):(O<this._minx&&(this._minx=O),O>this._maxx&&(this._maxx=O),$<this._miny&&(this._miny=$),$>this._maxy&&(this._maxy=$))}}},{key:"minExtent",value:function(){if(this.isNull())return 0;var g=this.getWidth(),x=this.getHeight();return g<x?g:x}},{key:"getWidth",value:function(){return this.isNull()?0:this._maxx-this._minx}},{key:"compareTo",value:function(g){var x=g;return this.isNull()?x.isNull()?0:-1:x.isNull()?1:this._minx<x._minx?-1:this._minx>x._minx?1:this._miny<x._miny?-1:this._miny>x._miny?1:this._maxx<x._maxx?-1:this._maxx>x._maxx?1:this._maxy<x._maxy?-1:this._maxy>x._maxy?1:0}},{key:"translate",value:function(g,x){if(this.isNull())return null;this.init(this.getMinX()+g,this.getMaxX()+g,this.getMinY()+x,this.getMaxY()+x)}},{key:"copy",value:function(){return new C(this)}},{key:"toString",value:function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}},{key:"setToNull",value:function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}},{key:"disjoint",value:function(g){return!(!this.isNull()&&!g.isNull())||g._minx>this._maxx||g._maxx<this._minx||g._miny>this._maxy||g._maxy<this._miny}},{key:"getHeight",value:function(){return this.isNull()?0:this._maxy-this._miny}},{key:"maxExtent",value:function(){if(this.isNull())return 0;var g=this.getWidth(),x=this.getHeight();return g>x?g:x}},{key:"expandBy",value:function(){if(arguments.length===1){var g=arguments[0];this.expandBy(g,g)}else if(arguments.length===2){var x=arguments[0],O=arguments[1];if(this.isNull())return null;this._minx-=x,this._maxx+=x,this._miny-=O,this._maxy+=O,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}},{key:"contains",value:function(){if(arguments.length===1){if(arguments[0]instanceof C){var g=arguments[0];return this.covers(g)}if(arguments[0]instanceof Et){var x=arguments[0];return this.covers(x)}}else if(arguments.length===2){var O=arguments[0],$=arguments[1];return this.covers(O,$)}}},{key:"centre",value:function(){return this.isNull()?null:new Et((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}},{key:"init",value:function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof Et){var g=arguments[0];this.init(g.x,g.x,g.y,g.y)}else if(arguments[0]instanceof C){var x=arguments[0];this._minx=x._minx,this._maxx=x._maxx,this._miny=x._miny,this._maxy=x._maxy}}else if(arguments.length===2){var O=arguments[0],$=arguments[1];this.init(O.x,$.x,O.y,$.y)}else if(arguments.length===4){var te=arguments[0],he=arguments[1],Te=arguments[2],Be=arguments[3];te<he?(this._minx=te,this._maxx=he):(this._minx=he,this._maxx=te),Te<Be?(this._miny=Te,this._maxy=Be):(this._miny=Be,this._maxy=Te)}}},{key:"getMaxY",value:function(){return this._maxy}},{key:"distance",value:function(g){if(this.intersects(g))return 0;var x=0;this._maxx<g._minx?x=g._minx-this._maxx:this._minx>g._maxx&&(x=this._minx-g._maxx);var O=0;return this._maxy<g._miny?O=g._miny-this._maxy:this._miny>g._maxy&&(O=this._miny-g._maxy),x===0?O:O===0?x:Math.sqrt(x*x+O*O)}},{key:"hashCode",value:function(){var g=17;return g=37*(g=37*(g=37*(g=37*g+Et.hashCode(this._minx))+Et.hashCode(this._maxx))+Et.hashCode(this._miny))+Et.hashCode(this._maxy)}},{key:"interfaces_",get:function(){return[Oe,He]}}],[{key:"constructor_",value:function(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof Et){var g=arguments[0];this.init(g.x,g.x,g.y,g.y)}else if(arguments[0]instanceof C){var x=arguments[0];this.init(x)}}else if(arguments.length===2){var O=arguments[0],$=arguments[1];this.init(O.x,$.x,O.y,$.y)}else if(arguments.length===4){var te=arguments[0],he=arguments[1],Te=arguments[2],Be=arguments[3];this.init(te,he,Te,Be)}}},{key:"intersects",value:function(){if(arguments.length===3){var g=arguments[0],x=arguments[1],O=arguments[2];return O.x>=(g.x<x.x?g.x:x.x)&&O.x<=(g.x>x.x?g.x:x.x)&&O.y>=(g.y<x.y?g.y:x.y)&&O.y<=(g.y>x.y?g.y:x.y)}if(arguments.length===4){var $=arguments[0],te=arguments[1],he=arguments[2],Te=arguments[3],Be=Math.min(he.x,Te.x),et=Math.max(he.x,Te.x),Dt=Math.min($.x,te.x),Ht=Math.max($.x,te.x);return!(Dt>et)&&!(Ht<Be)&&(Be=Math.min(he.y,Te.y),et=Math.max(he.y,Te.y),Dt=Math.min($.y,te.y),Ht=Math.max($.y,te.y),!(Dt>et)&&!(Ht<Be))}}}])}(),An=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"isGeometryCollection",value:function(){return this.getTypeCode()===C.TYPECODE_GEOMETRYCOLLECTION}},{key:"getFactory",value:function(){return this._factory}},{key:"getGeometryN",value:function(g){return this}},{key:"getArea",value:function(){return 0}},{key:"isRectangle",value:function(){return!1}},{key:"equalsExact",value:function(g){return this===g||this.equalsExact(g,0)}},{key:"geometryChanged",value:function(){this.apply(C.geometryChangedFilter)}},{key:"geometryChangedAction",value:function(){this._envelope=null}},{key:"equalsNorm",value:function(g){return g!==null&&this.norm().equalsExact(g.norm())}},{key:"getLength",value:function(){return 0}},{key:"getNumGeometries",value:function(){return 1}},{key:"compareTo",value:function(){var g;if(arguments.length===1){var x=arguments[0];return g=x,this.getTypeCode()!==g.getTypeCode()?this.getTypeCode()-g.getTypeCode():this.isEmpty()&&g.isEmpty()?0:this.isEmpty()?-1:g.isEmpty()?1:this.compareToSameClass(x)}if(arguments.length===2){var O=arguments[0],$=arguments[1];return g=O,this.getTypeCode()!==g.getTypeCode()?this.getTypeCode()-g.getTypeCode():this.isEmpty()&&g.isEmpty()?0:this.isEmpty()?-1:g.isEmpty()?1:this.compareToSameClass(O,$)}}},{key:"getUserData",value:function(){return this._userData}},{key:"getSRID",value:function(){return this._SRID}},{key:"getEnvelope",value:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}},{key:"checkNotGeometryCollection",value:function(g){if(g.getTypeCode()===C.TYPECODE_GEOMETRYCOLLECTION)throw new me("This method does not support GeometryCollection arguments")}},{key:"equal",value:function(g,x,O){return O===0?g.equals(x):g.distance(x)<=O}},{key:"norm",value:function(){var g=this.copy();return g.normalize(),g}},{key:"reverse",value:function(){var g=this.reverseInternal();return this.envelope!=null&&(g.envelope=this.envelope.copy()),g.setSRID(this.getSRID()),g}},{key:"copy",value:function(){var g=this.copyInternal();return g.envelope=this._envelope==null?null:this._envelope.copy(),g._SRID=this._SRID,g._userData=this._userData,g}},{key:"getPrecisionModel",value:function(){return this._factory.getPrecisionModel()}},{key:"getEnvelopeInternal",value:function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new Ne(this._envelope)}},{key:"setSRID",value:function(g){this._SRID=g}},{key:"setUserData",value:function(g){this._userData=g}},{key:"compare",value:function(g,x){for(var O=g.iterator(),$=x.iterator();O.hasNext()&&$.hasNext();){var te=O.next(),he=$.next(),Te=te.compareTo(he);if(Te!==0)return Te}return O.hasNext()?1:$.hasNext()?-1:0}},{key:"hashCode",value:function(){return this.getEnvelopeInternal().hashCode()}},{key:"isEquivalentClass",value:function(g){return this.getClass()===g.getClass()}},{key:"isGeometryCollectionOrDerived",value:function(){return this.getTypeCode()===C.TYPECODE_GEOMETRYCOLLECTION||this.getTypeCode()===C.TYPECODE_MULTIPOINT||this.getTypeCode()===C.TYPECODE_MULTILINESTRING||this.getTypeCode()===C.TYPECODE_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[Ye,Oe,He]}},{key:"getClass",value:function(){return C}}],[{key:"hasNonEmptyElements",value:function(g){for(var x=0;x<g.length;x++)if(!g[x].isEmpty())return!0;return!1}},{key:"hasNullElements",value:function(g){for(var x=0;x<g.length;x++)if(g[x]===null)return!0;return!1}}])}();An.constructor_=function(C){C&&(this._envelope=null,this._userData=null,this._factory=C,this._SRID=C.getSRID())},An.TYPECODE_POINT=0,An.TYPECODE_MULTIPOINT=1,An.TYPECODE_LINESTRING=2,An.TYPECODE_LINEARRING=3,An.TYPECODE_MULTILINESTRING=4,An.TYPECODE_POLYGON=5,An.TYPECODE_MULTIPOLYGON=6,An.TYPECODE_GEOMETRYCOLLECTION=7,An.TYPENAME_POINT="Point",An.TYPENAME_MULTIPOINT="MultiPoint",An.TYPENAME_LINESTRING="LineString",An.TYPENAME_LINEARRING="LinearRing",An.TYPENAME_MULTILINESTRING="MultiLineString",An.TYPENAME_POLYGON="Polygon",An.TYPENAME_MULTIPOLYGON="MultiPolygon",An.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",An.geometryChangedFilter={get interfaces_(){return[Ae]},filter:function(C){C.geometryChangedAction()}};var qe=function(){function C(){c(this,C)}return i(C,null,[{key:"toLocationSymbol",value:function(g){switch(g){case C.EXTERIOR:return"e";case C.BOUNDARY:return"b";case C.INTERIOR:return"i";case C.NONE:return"-"}throw new me("Unknown location value: "+g)}}])}();qe.INTERIOR=0,qe.BOUNDARY=1,qe.EXTERIOR=2,qe.NONE=-1;var jr=function(){return i(function C(){c(this,C)},[{key:"add",value:function(){}},{key:"addAll",value:function(){}},{key:"isEmpty",value:function(){}},{key:"iterator",value:function(){}},{key:"size",value:function(){}},{key:"toArray",value:function(){}},{key:"remove",value:function(){}}])}(),$t=function(C){function g(x){var O;return c(this,g),(O=o(this,g,[x])).name=Object.keys({NoSuchElementException:g})[0],O}return V(g,C),i(g)}(Ee),Ur=function(C){function g(x){var O;return c(this,g),(O=o(this,g,[x])).name=Object.keys({UnsupportedOperationException:g})[0],O}return V(g,C),i(g)}(Ee),Wr=function(C){function g(){return c(this,g),o(this,g,arguments)}return V(g,C),i(g,[{key:"contains",value:function(){}}])}(jr),Qi=function(C){function g(x){var O;return c(this,g),(O=o(this,g)).map=new Map,x instanceof jr&&O.addAll(x),O}return V(g,C),i(g,[{key:"contains",value:function(x){var O=x.hashCode?x.hashCode():x;return!!this.map.has(O)}},{key:"add",value:function(x){var O=x.hashCode?x.hashCode():x;return!this.map.has(O)&&!!this.map.set(O,x)}},{key:"addAll",value:function(x){var O,$=P(x);try{for($.s();!(O=$.n()).done;){var te=O.value;this.add(te)}}catch(he){$.e(he)}finally{$.f()}return!0}},{key:"remove",value:function(){throw new Ur}},{key:"size",value:function(){return this.map.size}},{key:"isEmpty",value:function(){return this.map.size===0}},{key:"toArray",value:function(){return Array.from(this.map.values())}},{key:"iterator",value:function(){return new hr(this.map)}},{key:Symbol.iterator,value:function(){return this.map}}])}(Wr),hr=function(){return i(function C(g){c(this,C),this.iterator=g.values();var x=this.iterator.next(),O=x.done,$=x.value;this.done=O,this.value=$},[{key:"next",value:function(){if(this.done)throw new $t;var C=this.value,g=this.iterator.next(),x=g.done,O=g.value;return this.done=x,this.value=O,C}},{key:"hasNext",value:function(){return!this.done}},{key:"remove",value:function(){throw new Ur}}])}(),vn=function(){function C(){c(this,C)}return i(C,null,[{key:"opposite",value:function(g){return g===C.LEFT?C.RIGHT:g===C.RIGHT?C.LEFT:g}}])}();vn.ON=0,vn.LEFT=1,vn.RIGHT=2;var wa=function(C){function g(x){var O;return c(this,g),(O=o(this,g,[x])).name=Object.keys({EmptyStackException:g})[0],O}return V(g,C),i(g)}(Ee),La=function(C){function g(x){var O;return c(this,g),(O=o(this,g,[x])).name=Object.keys({IndexOutOfBoundsException:g})[0],O}return V(g,C),i(g)}(Ee),ya=function(C){function g(){return c(this,g),o(this,g,arguments)}return V(g,C),i(g,[{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"isEmpty",value:function(){}}])}(jr),ks=function(C){function g(){var x;return c(this,g),(x=o(this,g)).array=[],x}return V(g,C),i(g,[{key:"add",value:function(x){return this.array.push(x),!0}},{key:"get",value:function(x){if(x<0||x>=this.size())throw new La;return this.array[x]}},{key:"push",value:function(x){return this.array.push(x),x}},{key:"pop",value:function(){if(this.array.length===0)throw new wa;return this.array.pop()}},{key:"peek",value:function(){if(this.array.length===0)throw new wa;return this.array[this.array.length-1]}},{key:"empty",value:function(){return this.array.length===0}},{key:"isEmpty",value:function(){return this.empty()}},{key:"search",value:function(x){return this.array.indexOf(x)}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}}])}(ya);function Mn(C,g){return C.interfaces_&&C.interfaces_.indexOf(g)>-1}var no=function(){return i(function C(g){c(this,C),this.str=g},[{key:"append",value:function(C){this.str+=C}},{key:"setCharAt",value:function(C,g){this.str=this.str.substr(0,C)+g+this.str.substr(C+1)}},{key:"toString",value:function(){return this.str}}])}(),To=function(){function C(g){c(this,C),this.value=g}return i(C,[{key:"intValue",value:function(){return this.value}},{key:"compareTo",value:function(g){return this.value<g?-1:this.value>g?1:0}}],[{key:"compare",value:function(g,x){return g<x?-1:g>x?1:0}},{key:"isNan",value:function(g){return Number.isNaN(g)}},{key:"valueOf",value:function(g){return new C(g)}}])}(),Ds=function(){return i(function C(){c(this,C)},null,[{key:"isWhitespace",value:function(C){return C<=32&&C>=0||C===127}},{key:"toUpperCase",value:function(C){return C.toUpperCase()}}])}(),ar=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"le",value:function(g){return this._hi<g._hi||this._hi===g._hi&&this._lo<=g._lo}},{key:"extractSignificantDigits",value:function(g,x){var O=this.abs(),$=C.magnitude(O._hi),te=C.TEN.pow($);(O=O.divide(te)).gt(C.TEN)?(O=O.divide(C.TEN),$+=1):O.lt(C.ONE)&&(O=O.multiply(C.TEN),$-=1);for(var he=$+1,Te=new no,Be=C.MAX_PRINT_DIGITS-1,et=0;et<=Be;et++){g&&et===he&&Te.append(".");var Dt=Math.trunc(O._hi);if(Dt<0)break;var Ht=!1,bn=0;Dt>9?(Ht=!0,bn="9"):bn="0"+Dt,Te.append(bn),O=O.subtract(C.valueOf(Dt)).multiply(C.TEN),Ht&&O.selfAdd(C.TEN);var Hn=!0,sr=C.magnitude(O._hi);if(sr<0&&Math.abs(sr)>=Be-et&&(Hn=!1),!Hn)break}return x[0]=$,Te.toString()}},{key:"sqr",value:function(){return this.multiply(this)}},{key:"doubleValue",value:function(){return this._hi+this._lo}},{key:"subtract",value:function(){if(arguments[0]instanceof C){var g=arguments[0];return this.add(g.negate())}if(typeof arguments[0]=="number"){var x=arguments[0];return this.add(-x)}}},{key:"equals",value:function(){if(arguments.length===1&&arguments[0]instanceof C){var g=arguments[0];return this._hi===g._hi&&this._lo===g._lo}}},{key:"isZero",value:function(){return this._hi===0&&this._lo===0}},{key:"selfSubtract",value:function(){if(arguments[0]instanceof C){var g=arguments[0];return this.isNaN()?this:this.selfAdd(-g._hi,-g._lo)}if(typeof arguments[0]=="number"){var x=arguments[0];return this.isNaN()?this:this.selfAdd(-x,0)}}},{key:"getSpecialNumberString",value:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}},{key:"min",value:function(g){return this.le(g)?this:g}},{key:"selfDivide",value:function(){if(arguments.length===1){if(arguments[0]instanceof C){var g=arguments[0];return this.selfDivide(g._hi,g._lo)}if(typeof arguments[0]=="number"){var x=arguments[0];return this.selfDivide(x,0)}}else if(arguments.length===2){var O,$,te,he,Te=arguments[0],Be=arguments[1],et=null,Dt=null,Ht=null,bn=null;return te=this._hi/Te,bn=(et=(Ht=C.SPLIT*te)-(et=Ht-te))*(Dt=(bn=C.SPLIT*Te)-(Dt=bn-Te))-(he=te*Te)+et*($=Te-Dt)+(O=te-et)*Dt+O*$,bn=te+(Ht=(this._hi-he-bn+this._lo-te*Be)/Te),this._hi=bn,this._lo=te-bn+Ht,this}}},{key:"dump",value:function(){return"DD<"+this._hi+", "+this._lo+">"}},{key:"divide",value:function(){if(arguments[0]instanceof C){var g,x,O,$,te=arguments[0],he=null,Te=null,Be=null,et=null;return g=(O=this._hi/te._hi)-(he=(Be=C.SPLIT*O)-(he=Be-O)),et=he*(Te=(et=C.SPLIT*te._hi)-(Te=et-te._hi))-($=O*te._hi)+he*(x=te._hi-Te)+g*Te+g*x,new C(et=O+(Be=(this._hi-$-et+this._lo-O*te._lo)/te._hi),O-et+Be)}if(typeof arguments[0]=="number"){var Dt=arguments[0];return Ze.isNaN(Dt)?C.createNaN():C.copy(this).selfDivide(Dt,0)}}},{key:"ge",value:function(g){return this._hi>g._hi||this._hi===g._hi&&this._lo>=g._lo}},{key:"pow",value:function(g){if(g===0)return C.valueOf(1);var x=new C(this),O=C.valueOf(1),$=Math.abs(g);if($>1)for(;$>0;)$%2==1&&O.selfMultiply(x),($/=2)>0&&(x=x.sqr());else O=x;return g<0?O.reciprocal():O}},{key:"ceil",value:function(){if(this.isNaN())return C.NaN;var g=Math.ceil(this._hi),x=0;return g===this._hi&&(x=Math.ceil(this._lo)),new C(g,x)}},{key:"compareTo",value:function(g){var x=g;return this._hi<x._hi?-1:this._hi>x._hi?1:this._lo<x._lo?-1:this._lo>x._lo?1:0}},{key:"rint",value:function(){return this.isNaN()?this:this.add(.5).floor()}},{key:"setValue",value:function(){if(arguments[0]instanceof C){var g=arguments[0];return this.init(g),this}if(typeof arguments[0]=="number"){var x=arguments[0];return this.init(x),this}}},{key:"max",value:function(g){return this.ge(g)?this:g}},{key:"sqrt",value:function(){if(this.isZero())return C.valueOf(0);if(this.isNegative())return C.NaN;var g=1/Math.sqrt(this._hi),x=this._hi*g,O=C.valueOf(x),$=this.subtract(O.sqr())._hi*(.5*g);return O.add($)}},{key:"selfAdd",value:function(){if(arguments.length===1){if(arguments[0]instanceof C){var g=arguments[0];return this.selfAdd(g._hi,g._lo)}if(typeof arguments[0]=="number"){var x,O,$,te,he,Te=arguments[0],Be=null;return Be=($=this._hi+Te)-(te=$-this._hi),O=(he=(Be=Te-te+(this._hi-Be))+this._lo)+($-(x=$+he)),this._hi=x+O,this._lo=O+(x-this._hi),this}}else if(arguments.length===2){var et,Dt,Ht,bn,Hn=arguments[0],sr=arguments[1],xr=null,Jr=null,Qr=null;Ht=this._hi+Hn,Dt=this._lo+sr,Jr=Ht-(Qr=Ht-this._hi),xr=Dt-(bn=Dt-this._lo);var xi=(et=Ht+(Qr=(Jr=Hn-Qr+(this._hi-Jr))+Dt))+(Qr=(xr=sr-bn+(this._lo-xr))+(Qr+(Ht-et))),Si=Qr+(et-xi);return this._hi=xi,this._lo=Si,this}}},{key:"selfMultiply",value:function(){if(arguments.length===1){if(arguments[0]instanceof C){var g=arguments[0];return this.selfMultiply(g._hi,g._lo)}if(typeof arguments[0]=="number"){var x=arguments[0];return this.selfMultiply(x,0)}}else if(arguments.length===2){var O,$,te=arguments[0],he=arguments[1],Te=null,Be=null,et=null,Dt=null;Te=(et=C.SPLIT*this._hi)-this._hi,Dt=C.SPLIT*te,Te=et-Te,O=this._hi-Te,Be=Dt-te;var Ht=(et=this._hi*te)+(Dt=Te*(Be=Dt-Be)-et+Te*($=te-Be)+O*Be+O*$+(this._hi*he+this._lo*te)),bn=Dt+(Te=et-Ht);return this._hi=Ht,this._lo=bn,this}}},{key:"selfSqr",value:function(){return this.selfMultiply(this)}},{key:"floor",value:function(){if(this.isNaN())return C.NaN;var g=Math.floor(this._hi),x=0;return g===this._hi&&(x=Math.floor(this._lo)),new C(g,x)}},{key:"negate",value:function(){return this.isNaN()?this:new C(-this._hi,-this._lo)}},{key:"clone",value:function(){try{return null}catch(g){if(g instanceof CloneNotSupportedException)return null;throw g}}},{key:"multiply",value:function(){if(arguments[0]instanceof C){var g=arguments[0];return g.isNaN()?C.createNaN():C.copy(this).selfMultiply(g)}if(typeof arguments[0]=="number"){var x=arguments[0];return Ze.isNaN(x)?C.createNaN():C.copy(this).selfMultiply(x,0)}}},{key:"isNaN",value:function(){return Ze.isNaN(this._hi)}},{key:"intValue",value:function(){return Math.trunc(this._hi)}},{key:"toString",value:function(){var g=C.magnitude(this._hi);return g>=-3&&g<=20?this.toStandardNotation():this.toSciNotation()}},{key:"toStandardNotation",value:function(){var g=this.getSpecialNumberString();if(g!==null)return g;var x=new Array(1).fill(null),O=this.extractSignificantDigits(!0,x),$=x[0]+1,te=O;if(O.charAt(0)===".")te="0"+O;else if($<0)te="0."+C.stringOfChar("0",-$)+O;else if(O.indexOf(".")===-1){var he=$-O.length;te=O+C.stringOfChar("0",he)+".0"}return this.isNegative()?"-"+te:te}},{key:"reciprocal",value:function(){var g,x,O,$,te=null,he=null,Te=null,Be=null;g=(O=1/this._hi)-(te=(Te=C.SPLIT*O)-(te=Te-O)),he=(Be=C.SPLIT*this._hi)-this._hi;var et=O+(Te=(1-($=O*this._hi)-(Be=te*(he=Be-he)-$+te*(x=this._hi-he)+g*he+g*x)-O*this._lo)/this._hi);return new C(et,O-et+Te)}},{key:"toSciNotation",value:function(){if(this.isZero())return C.SCI_NOT_ZERO;var g=this.getSpecialNumberString();if(g!==null)return g;var x=new Array(1).fill(null),O=this.extractSignificantDigits(!1,x),$=C.SCI_NOT_EXPONENT_CHAR+x[0];if(O.charAt(0)==="0")throw new IllegalStateException("Found leading zero: "+O);var te="";O.length>1&&(te=O.substring(1));var he=O.charAt(0)+"."+te;return this.isNegative()?"-"+he+$:he+$}},{key:"abs",value:function(){return this.isNaN()?C.NaN:this.isNegative()?this.negate():new C(this)}},{key:"isPositive",value:function(){return this._hi>0||this._hi===0&&this._lo>0}},{key:"lt",value:function(g){return this._hi<g._hi||this._hi===g._hi&&this._lo<g._lo}},{key:"add",value:function(){if(arguments[0]instanceof C){var g=arguments[0];return C.copy(this).selfAdd(g)}if(typeof arguments[0]=="number"){var x=arguments[0];return C.copy(this).selfAdd(x)}}},{key:"init",value:function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var g=arguments[0];this._hi=g,this._lo=0}else if(arguments[0]instanceof C){var x=arguments[0];this._hi=x._hi,this._lo=x._lo}}else if(arguments.length===2){var O=arguments[0],$=arguments[1];this._hi=O,this._lo=$}}},{key:"gt",value:function(g){return this._hi>g._hi||this._hi===g._hi&&this._lo>g._lo}},{key:"isNegative",value:function(){return this._hi<0||this._hi===0&&this._lo<0}},{key:"trunc",value:function(){return this.isNaN()?C.NaN:this.isPositive()?this.floor():this.ceil()}},{key:"signum",value:function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}},{key:"interfaces_",get:function(){return[He,Oe,Ye]}}],[{key:"constructor_",value:function(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var g=arguments[0];this.init(g)}else if(arguments[0]instanceof C){var x=arguments[0];this.init(x)}else if(typeof arguments[0]=="string"){var O=arguments[0];C.constructor_.call(this,C.parse(O))}}else if(arguments.length===2){var $=arguments[0],te=arguments[1];this.init($,te)}}},{key:"determinant",value:function(){if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var g=arguments[0],x=arguments[1],O=arguments[2],$=arguments[3];return C.determinant(C.valueOf(g),C.valueOf(x),C.valueOf(O),C.valueOf($))}if(arguments[3]instanceof C&&arguments[2]instanceof C&&arguments[0]instanceof C&&arguments[1]instanceof C){var te=arguments[1],he=arguments[2],Te=arguments[3];return arguments[0].multiply(Te).selfSubtract(te.multiply(he))}}},{key:"sqr",value:function(g){return C.valueOf(g).selfMultiply(g)}},{key:"valueOf",value:function(){if(typeof arguments[0]=="string"){var g=arguments[0];return C.parse(g)}if(typeof arguments[0]=="number")return new C(arguments[0])}},{key:"sqrt",value:function(g){return C.valueOf(g).sqrt()}},{key:"parse",value:function(g){for(var x=0,O=g.length;Ds.isWhitespace(g.charAt(x));)x++;var $=!1;if(x<O){var te=g.charAt(x);te!=="-"&&te!=="+"||(x++,te==="-"&&($=!0))}for(var he=new C,Te=0,Be=0,et=0,Dt=!1;!(x>=O);){var Ht=g.charAt(x);if(x++,Ds.isDigit(Ht)){var bn=Ht-"0";he.selfMultiply(C.TEN),he.selfAdd(bn),Te++}else{if(Ht!=="."){if(Ht==="e"||Ht==="E"){var Hn=g.substring(x);try{et=To.parseInt(Hn)}catch(xi){throw xi instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+Hn+" in string "+g):xi}break}throw new NumberFormatException("Unexpected character '"+Ht+"' at position "+x+" in string "+g)}Be=Te,Dt=!0}}var sr=he;Dt||(Be=Te);var xr=Te-Be-et;if(xr===0)sr=he;else if(xr>0){var Jr=C.TEN.pow(xr);sr=he.divide(Jr)}else if(xr<0){var Qr=C.TEN.pow(-xr);sr=he.multiply(Qr)}return $?sr.negate():sr}},{key:"createNaN",value:function(){return new C(Ze.NaN,Ze.NaN)}},{key:"copy",value:function(g){return new C(g)}},{key:"magnitude",value:function(g){var x=Math.abs(g),O=Math.log(x)/Math.log(10),$=Math.trunc(Math.floor(O));return 10*Math.pow(10,$)<=x&&($+=1),$}},{key:"stringOfChar",value:function(g,x){for(var O=new no,$=0;$<x;$++)O.append(g);return O.toString()}}])}();ar.PI=new ar(3.141592653589793,12246467991473532e-32),ar.TWO_PI=new ar(6.283185307179586,24492935982947064e-32),ar.PI_2=new ar(1.5707963267948966,6123233995736766e-32),ar.E=new ar(2.718281828459045,14456468917292502e-32),ar.NaN=new ar(Ze.NaN,Ze.NaN),ar.EPS=123259516440783e-46,ar.SPLIT=134217729,ar.MAX_PRINT_DIGITS=32,ar.TEN=ar.valueOf(10),ar.ONE=ar.valueOf(1),ar.SCI_NOT_EXPONENT_CHAR="E",ar.SCI_NOT_ZERO="0.0E0";var Ls=function(){function C(){c(this,C)}return i(C,null,[{key:"orientationIndex",value:function(g,x,O){var $=C.orientationIndexFilter(g,x,O);if($<=1)return $;var te=ar.valueOf(x.x).selfAdd(-g.x),he=ar.valueOf(x.y).selfAdd(-g.y),Te=ar.valueOf(O.x).selfAdd(-x.x),Be=ar.valueOf(O.y).selfAdd(-x.y);return te.selfMultiply(Be).selfSubtract(he.selfMultiply(Te)).signum()}},{key:"signOfDet2x2",value:function(){if(arguments[3]instanceof ar&&arguments[2]instanceof ar&&arguments[0]instanceof ar&&arguments[1]instanceof ar){var g=arguments[1],x=arguments[2],O=arguments[3];return arguments[0].multiply(O).selfSubtract(g.multiply(x)).signum()}if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var $=arguments[0],te=arguments[1],he=arguments[2],Te=arguments[3],Be=ar.valueOf($),et=ar.valueOf(te),Dt=ar.valueOf(he),Ht=ar.valueOf(Te);return Be.multiply(Ht).selfSubtract(et.multiply(Dt)).signum()}}},{key:"intersection",value:function(g,x,O,$){var te=new ar(g.y).selfSubtract(x.y),he=new ar(x.x).selfSubtract(g.x),Te=new ar(g.x).selfMultiply(x.y).selfSubtract(new ar(x.x).selfMultiply(g.y)),Be=new ar(O.y).selfSubtract($.y),et=new ar($.x).selfSubtract(O.x),Dt=new ar(O.x).selfMultiply($.y).selfSubtract(new ar($.x).selfMultiply(O.y)),Ht=he.multiply(Dt).selfSubtract(et.multiply(Te)),bn=Be.multiply(Te).selfSubtract(te.multiply(Dt)),Hn=te.multiply(et).selfSubtract(Be.multiply(he)),sr=Ht.selfDivide(Hn).doubleValue(),xr=bn.selfDivide(Hn).doubleValue();return Ze.isNaN(sr)||Ze.isInfinite(sr)||Ze.isNaN(xr)||Ze.isInfinite(xr)?null:new Et(sr,xr)}},{key:"orientationIndexFilter",value:function(g,x,O){var $=null,te=(g.x-O.x)*(x.y-O.y),he=(g.y-O.y)*(x.x-O.x),Te=te-he;if(te>0){if(he<=0)return C.signum(Te);$=te+he}else{if(!(te<0)||he>=0)return C.signum(Te);$=-te-he}var Be=C.DP_SAFE_EPSILON*$;return Te>=Be||-Te>=Be?C.signum(Te):2}},{key:"signum",value:function(g){return g>0?1:g<0?-1:0}}])}();Ls.DP_SAFE_EPSILON=1e-15;var Kr=function(){return i(function C(){c(this,C)},[{key:"getM",value:function(C){if(this.hasM()){var g=this.getDimension()-this.getMeasures();return this.getOrdinate(C,g)}return Ze.NaN}},{key:"setOrdinate",value:function(C,g,x){}},{key:"getZ",value:function(C){return this.hasZ()?this.getOrdinate(C,2):Ze.NaN}},{key:"size",value:function(){}},{key:"getOrdinate",value:function(C,g){}},{key:"getCoordinate",value:function(){}},{key:"getCoordinateCopy",value:function(C){}},{key:"createCoordinate",value:function(){}},{key:"getDimension",value:function(){}},{key:"hasM",value:function(){return this.getMeasures()>0}},{key:"getX",value:function(C){}},{key:"hasZ",value:function(){return this.getDimension()-this.getMeasures()>2}},{key:"getMeasures",value:function(){return 0}},{key:"expandEnvelope",value:function(C){}},{key:"copy",value:function(){}},{key:"getY",value:function(C){}},{key:"toCoordinateArray",value:function(){}},{key:"interfaces_",get:function(){return[Ye]}}])}();Kr.X=0,Kr.Y=1,Kr.Z=2,Kr.M=3;var Rr=function(){function C(){c(this,C)}return i(C,null,[{key:"index",value:function(g,x,O){return Ls.orientationIndex(g,x,O)}},{key:"isCCW",value:function(){if(arguments[0]instanceof Array){var g=arguments[0],x=g.length-1;if(x<3)throw new me("Ring has fewer than 4 points, so orientation cannot be determined");for(var O=g[0],$=0,te=1;te<=x;te++){var he=g[te];he.y>O.y&&(O=he,$=te)}var Te=$;do(Te-=1)<0&&(Te=x);while(g[Te].equals2D(O)&&Te!==$);var Be=$;do Be=(Be+1)%x;while(g[Be].equals2D(O)&&Be!==$);var et=g[Te],Dt=g[Be];if(et.equals2D(O)||Dt.equals2D(O)||et.equals2D(Dt))return!1;var Ht=C.index(et,O,Dt);return Ht===0?et.x>Dt.x:Ht>0}if(Mn(arguments[0],Kr)){var bn=arguments[0],Hn=bn.size()-1;if(Hn<3)throw new me("Ring has fewer than 4 points, so orientation cannot be determined");for(var sr=bn.getCoordinate(0),xr=0,Jr=1;Jr<=Hn;Jr++){var Qr=bn.getCoordinate(Jr);Qr.y>sr.y&&(sr=Qr,xr=Jr)}var xi=null,Si=xr;do(Si-=1)<0&&(Si=Hn),xi=bn.getCoordinate(Si);while(xi.equals2D(sr)&&Si!==xr);var mi=null,Wa=xr;do Wa=(Wa+1)%Hn,mi=bn.getCoordinate(Wa);while(mi.equals2D(sr)&&Wa!==xr);if(xi.equals2D(sr)||mi.equals2D(sr)||xi.equals2D(mi))return!1;var _s=C.index(xi,sr,mi);return _s===0?xi.x>mi.x:_s>0}}}])}();Rr.CLOCKWISE=-1,Rr.RIGHT=Rr.CLOCKWISE,Rr.COUNTERCLOCKWISE=1,Rr.LEFT=Rr.COUNTERCLOCKWISE,Rr.COLLINEAR=0,Rr.STRAIGHT=Rr.COLLINEAR;var ec=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"getCoordinate",value:function(){return this._minCoord}},{key:"getRightmostSide",value:function(C,g){var x=this.getRightmostSideOfSegment(C,g);return x<0&&(x=this.getRightmostSideOfSegment(C,g-1)),x<0&&(this._minCoord=null,this.checkForRightmostCoordinate(C)),x}},{key:"findRightmostEdgeAtVertex",value:function(){var C=this._minDe.getEdge().getCoordinates();cn.isTrue(this._minIndex>0&&this._minIndex<C.length,"rightmost point expected to be interior vertex of edge");var g=C[this._minIndex-1],x=C[this._minIndex+1],O=Rr.index(this._minCoord,x,g),$=!1;(g.y<this._minCoord.y&&x.y<this._minCoord.y&&O===Rr.COUNTERCLOCKWISE||g.y>this._minCoord.y&&x.y>this._minCoord.y&&O===Rr.CLOCKWISE)&&($=!0),$&&(this._minIndex=this._minIndex-1)}},{key:"getRightmostSideOfSegment",value:function(C,g){var x=C.getEdge().getCoordinates();if(g<0||g+1>=x.length||x[g].y===x[g+1].y)return-1;var O=vn.LEFT;return x[g].y<x[g+1].y&&(O=vn.RIGHT),O}},{key:"getEdge",value:function(){return this._orientedDe}},{key:"checkForRightmostCoordinate",value:function(C){for(var g=C.getEdge().getCoordinates(),x=0;x<g.length-1;x++)(this._minCoord===null||g[x].x>this._minCoord.x)&&(this._minDe=C,this._minIndex=x,this._minCoord=g[x])}},{key:"findRightmostEdgeAtNode",value:function(){var C=this._minDe.getNode().getEdges();this._minDe=C.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}},{key:"findEdge",value:function(C){for(var g=C.iterator();g.hasNext();){var x=g.next();x.isForward()&&this.checkForRightmostCoordinate(x)}cn.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===vn.LEFT&&(this._orientedDe=this._minDe.getSym())}}],[{key:"constructor_",value:function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}}])}(),Ui=function(C){function g(x,O){var $;return c(this,g),($=o(this,g,[O?x+" [ "+O+" ]":x])).pt=O?new Et(O):void 0,$.name=Object.keys({TopologyException:g})[0],$}return V(g,C),i(g,[{key:"getCoordinate",value:function(){return this.pt}}])}(an),$a=function(){return i(function C(){c(this,C),this.array=[]},[{key:"addLast",value:function(C){this.array.push(C)}},{key:"removeFirst",value:function(){return this.array.shift()}},{key:"isEmpty",value:function(){return this.array.length===0}}])}(),Er=function(C){function g(x){var O;return c(this,g),(O=o(this,g)).array=[],x instanceof jr&&O.addAll(x),O}return V(g,C),i(g,[{key:"interfaces_",get:function(){return[ya,jr]}},{key:"ensureCapacity",value:function(){}},{key:"add",value:function(x){return arguments.length===1?this.array.push(x):this.array.splice(arguments[0],0,arguments[1]),!0}},{key:"clear",value:function(){this.array=[]}},{key:"addAll",value:function(x){var O,$=P(x);try{for($.s();!(O=$.n()).done;){var te=O.value;this.array.push(te)}}catch(he){$.e(he)}finally{$.f()}}},{key:"set",value:function(x,O){var $=this.array[x];return this.array[x]=O,$}},{key:"iterator",value:function(){return new Sa(this)}},{key:"get",value:function(x){if(x<0||x>=this.size())throw new La;return this.array[x]}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"sort",value:function(x){x?this.array.sort(function(O,$){return x.compare(O,$)}):this.array.sort()}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}},{key:"remove",value:function(x){for(var O=0,$=this.array.length;O<$;O++)if(this.array[O]===x)return!!this.array.splice(O,1);return!1}},{key:Symbol.iterator,value:function(){return this.array.values()}}])}(ya),Sa=function(){return i(function C(g){c(this,C),this.arrayList=g,this.position=0},[{key:"next",value:function(){if(this.position===this.arrayList.size())throw new $t;return this.arrayList.get(this.position++)}},{key:"hasNext",value:function(){return this.position<this.arrayList.size()}},{key:"set",value:function(C){return this.arrayList.set(this.position-1,C)}},{key:"remove",value:function(){this.arrayList.remove(this.arrayList.get(this.position))}}])}(),za=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"clearVisitedEdges",value:function(){for(var C=this._dirEdgeList.iterator();C.hasNext();)C.next().setVisited(!1)}},{key:"getRightmostCoordinate",value:function(){return this._rightMostCoord}},{key:"computeNodeDepth",value:function(C){for(var g=null,x=C.getEdges().iterator();x.hasNext();){var O=x.next();if(O.isVisited()||O.getSym().isVisited()){g=O;break}}if(g===null)throw new Ui("unable to find edge to compute depths at "+C.getCoordinate());C.getEdges().computeDepths(g);for(var $=C.getEdges().iterator();$.hasNext();){var te=$.next();te.setVisited(!0),this.copySymDepths(te)}}},{key:"computeDepth",value:function(C){this.clearVisitedEdges();var g=this._finder.getEdge();g.getNode(),g.getLabel(),g.setEdgeDepths(vn.RIGHT,C),this.copySymDepths(g),this.computeDepths(g)}},{key:"create",value:function(C){this.addReachable(C),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}},{key:"findResultEdges",value:function(){for(var C=this._dirEdgeList.iterator();C.hasNext();){var g=C.next();g.getDepth(vn.RIGHT)>=1&&g.getDepth(vn.LEFT)<=0&&!g.isInteriorAreaEdge()&&g.setInResult(!0)}}},{key:"computeDepths",value:function(C){var g=new Qi,x=new $a,O=C.getNode();for(x.addLast(O),g.add(O),C.setVisited(!0);!x.isEmpty();){var $=x.removeFirst();g.add($),this.computeNodeDepth($);for(var te=$.getEdges().iterator();te.hasNext();){var he=te.next().getSym();if(!he.isVisited()){var Te=he.getNode();g.contains(Te)||(x.addLast(Te),g.add(Te))}}}}},{key:"compareTo",value:function(C){var g=C;return this._rightMostCoord.x<g._rightMostCoord.x?-1:this._rightMostCoord.x>g._rightMostCoord.x?1:0}},{key:"getEnvelope",value:function(){if(this._env===null){for(var C=new Ne,g=this._dirEdgeList.iterator();g.hasNext();)for(var x=g.next().getEdge().getCoordinates(),O=0;O<x.length-1;O++)C.expandToInclude(x[O]);this._env=C}return this._env}},{key:"addReachable",value:function(C){var g=new ks;for(g.add(C);!g.empty();){var x=g.pop();this.add(x,g)}}},{key:"copySymDepths",value:function(C){var g=C.getSym();g.setDepth(vn.LEFT,C.getDepth(vn.RIGHT)),g.setDepth(vn.RIGHT,C.getDepth(vn.LEFT))}},{key:"add",value:function(C,g){C.setVisited(!0),this._nodes.add(C);for(var x=C.getEdges().iterator();x.hasNext();){var O=x.next();this._dirEdgeList.add(O);var $=O.getSym().getNode();$.isVisited()||g.push($)}}},{key:"getNodes",value:function(){return this._nodes}},{key:"getDirectedEdges",value:function(){return this._dirEdgeList}},{key:"interfaces_",get:function(){return[Oe]}}],[{key:"constructor_",value:function(){this._finder=null,this._dirEdgeList=new Er,this._nodes=new Er,this._rightMostCoord=null,this._env=null,this._finder=new ec}}])}(),lr=function(){return i(function C(){c(this,C)},null,[{key:"intersection",value:function(C,g,x,O){var $=C.x<g.x?C.x:g.x,te=C.y<g.y?C.y:g.y,he=C.x>g.x?C.x:g.x,Te=C.y>g.y?C.y:g.y,Be=x.x<O.x?x.x:O.x,et=x.y<O.y?x.y:O.y,Dt=x.x>O.x?x.x:O.x,Ht=x.y>O.y?x.y:O.y,bn=(($>Be?$:Be)+(he<Dt?he:Dt))/2,Hn=((te>et?te:et)+(Te<Ht?Te:Ht))/2,sr=C.x-bn,xr=C.y-Hn,Jr=g.x-bn,Qr=g.y-Hn,xi=x.x-bn,Si=x.y-Hn,mi=O.x-bn,Wa=O.y-Hn,_s=xr-Qr,Pl=Jr-sr,au=sr*Qr-Jr*xr,ou=Si-Wa,jo=mi-xi,Rl=xi*Wa-mi*Si,Ar=_s*jo-ou*Pl,kl=(Pl*Rl-jo*au)/Ar,Dl=(ou*au-_s*Rl)/Ar;return Ze.isNaN(kl)||Ze.isInfinite(kl)||Ze.isNaN(Dl)||Ze.isInfinite(Dl)?null:new Et(kl+bn,Dl+Hn)}}])}(),_a=function(){return i(function C(){c(this,C)},null,[{key:"arraycopy",value:function(C,g,x,O,$){for(var te=0,he=g;he<g+$;he++)x[O+te]=C[he],te++}},{key:"getProperty",value:function(C){return{"line.separator":`
`}[C]}}])}(),Kl=function(){function C(){c(this,C)}return i(C,null,[{key:"log10",value:function(g){var x=Math.log(g);return Ze.isInfinite(x)||Ze.isNaN(x)?x:x/C.LOG_10}},{key:"min",value:function(g,x,O,$){var te=g;return x<te&&(te=x),O<te&&(te=O),$<te&&(te=$),te}},{key:"clamp",value:function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var g=arguments[0],x=arguments[1],O=arguments[2];return g<x?x:g>O?O:g}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var $=arguments[0],te=arguments[1],he=arguments[2];return $<te?te:$>he?he:$}}},{key:"wrap",value:function(g,x){return g<0?x- -g%x:g%x}},{key:"max",value:function(){if(arguments.length===3){var g=arguments[1],x=arguments[2],O=arguments[0];return g>O&&(O=g),x>O&&(O=x),O}if(arguments.length===4){var $=arguments[1],te=arguments[2],he=arguments[3],Te=arguments[0];return $>Te&&(Te=$),te>Te&&(Te=te),he>Te&&(Te=he),Te}}},{key:"average",value:function(g,x){return(g+x)/2}}])}();Kl.LOG_10=Math.log(10);var $i=function(){function C(){c(this,C)}return i(C,null,[{key:"segmentToSegment",value:function(g,x,O,$){if(g.equals(x))return C.pointToSegment(g,O,$);if(O.equals($))return C.pointToSegment($,g,x);var te=!1;if(Ne.intersects(g,x,O,$)){var he=(x.x-g.x)*($.y-O.y)-(x.y-g.y)*($.x-O.x);if(he===0)te=!0;else{var Te=(g.y-O.y)*($.x-O.x)-(g.x-O.x)*($.y-O.y),Be=((g.y-O.y)*(x.x-g.x)-(g.x-O.x)*(x.y-g.y))/he,et=Te/he;(et<0||et>1||Be<0||Be>1)&&(te=!0)}}else te=!0;return te?Kl.min(C.pointToSegment(g,O,$),C.pointToSegment(x,O,$),C.pointToSegment(O,g,x),C.pointToSegment($,g,x)):0}},{key:"pointToSegment",value:function(g,x,O){if(x.x===O.x&&x.y===O.y)return g.distance(x);var $=(O.x-x.x)*(O.x-x.x)+(O.y-x.y)*(O.y-x.y),te=((g.x-x.x)*(O.x-x.x)+(g.y-x.y)*(O.y-x.y))/$;if(te<=0)return g.distance(x);if(te>=1)return g.distance(O);var he=((x.y-g.y)*(O.x-x.x)-(x.x-g.x)*(O.y-x.y))/$;return Math.abs(he)*Math.sqrt($)}},{key:"pointToLinePerpendicular",value:function(g,x,O){var $=(O.x-x.x)*(O.x-x.x)+(O.y-x.y)*(O.y-x.y),te=((x.y-g.y)*(O.x-x.x)-(x.x-g.x)*(O.y-x.y))/$;return Math.abs(te)*Math.sqrt($)}},{key:"pointToSegmentString",value:function(g,x){if(x.length===0)throw new me("Line array must contain at least one vertex");for(var O=g.distance(x[0]),$=0;$<x.length-1;$++){var te=C.pointToSegment(g,x[$],x[$+1]);te<O&&(O=te)}return O}}])}(),Zo=function(){return i(function C(){c(this,C)},[{key:"create",value:function(){if(arguments.length===1)arguments[0]instanceof Array||Mn(arguments[0],Kr);else if(arguments.length!==2){if(arguments.length===3){var C=arguments[0],g=arguments[1];return this.create(C,g)}}}}])}(),Eo=function(){return i(function C(){c(this,C)},[{key:"filter",value:function(C){}}])}(),Al=function(){return i(function C(){c(this,C)},null,[{key:"ofLine",value:function(C){var g=C.size();if(g<=1)return 0;var x=0,O=new Et;C.getCoordinate(0,O);for(var $=O.x,te=O.y,he=1;he<g;he++){C.getCoordinate(he,O);var Te=O.x,Be=O.y,et=Te-$,Dt=Be-te;x+=Math.sqrt(et*et+Dt*Dt),$=Te,te=Be}return x}}])}(),zs=i(function C(){c(this,C)}),nl=function(){function C(){c(this,C)}return i(C,null,[{key:"copyCoord",value:function(g,x,O,$){for(var te=Math.min(g.getDimension(),O.getDimension()),he=0;he<te;he++)O.setOrdinate($,he,g.getOrdinate(x,he))}},{key:"isRing",value:function(g){var x=g.size();return x===0||!(x<=3)&&g.getOrdinate(0,Kr.X)===g.getOrdinate(x-1,Kr.X)&&g.getOrdinate(0,Kr.Y)===g.getOrdinate(x-1,Kr.Y)}},{key:"scroll",value:function(){if(arguments.length===2){if(Mn(arguments[0],Kr)&&Number.isInteger(arguments[1])){var g=arguments[0],x=arguments[1];C.scroll(g,x,C.isRing(g))}else if(Mn(arguments[0],Kr)&&arguments[1]instanceof Et){var O=arguments[0],$=arguments[1],te=C.indexOf($,O);if(te<=0)return null;C.scroll(O,te)}}else if(arguments.length===3){var he=arguments[0],Te=arguments[1],Be=arguments[2];if(Te<=0)return null;for(var et=he.copy(),Dt=Be?he.size()-1:he.size(),Ht=0;Ht<Dt;Ht++)for(var bn=0;bn<he.getDimension();bn++)he.setOrdinate(Ht,bn,et.getOrdinate((Te+Ht)%Dt,bn));if(Be)for(var Hn=0;Hn<he.getDimension();Hn++)he.setOrdinate(Dt,Hn,he.getOrdinate(0,Hn))}}},{key:"isEqual",value:function(g,x){var O=g.size();if(O!==x.size())return!1;for(var $=Math.min(g.getDimension(),x.getDimension()),te=0;te<O;te++)for(var he=0;he<$;he++){var Te=g.getOrdinate(te,he),Be=x.getOrdinate(te,he);if(g.getOrdinate(te,he)!==x.getOrdinate(te,he)&&(!Ze.isNaN(Te)||!Ze.isNaN(Be)))return!1}return!0}},{key:"minCoordinateIndex",value:function(){if(arguments.length===1){var g=arguments[0];return C.minCoordinateIndex(g,0,g.size()-1)}if(arguments.length===3){for(var x=arguments[0],O=arguments[2],$=-1,te=null,he=arguments[1];he<=O;he++){var Te=x.getCoordinate(he);(te===null||te.compareTo(Te)>0)&&(te=Te,$=he)}return $}}},{key:"extend",value:function(g,x,O){var $=g.create(O,x.getDimension()),te=x.size();if(C.copy(x,0,$,0,te),te>0)for(var he=te;he<O;he++)C.copy(x,te-1,$,he,1);return $}},{key:"reverse",value:function(g){for(var x=g.size()-1,O=Math.trunc(x/2),$=0;$<=O;$++)C.swap(g,$,x-$)}},{key:"swap",value:function(g,x,O){if(x===O)return null;for(var $=0;$<g.getDimension();$++){var te=g.getOrdinate(x,$);g.setOrdinate(x,$,g.getOrdinate(O,$)),g.setOrdinate(O,$,te)}}},{key:"copy",value:function(g,x,O,$,te){for(var he=0;he<te;he++)C.copyCoord(g,x+he,O,$+he)}},{key:"ensureValidRing",value:function(g,x){var O=x.size();return O===0?x:O<=3?C.createClosedRing(g,x,4):x.getOrdinate(0,Kr.X)===x.getOrdinate(O-1,Kr.X)&&x.getOrdinate(0,Kr.Y)===x.getOrdinate(O-1,Kr.Y)?x:C.createClosedRing(g,x,O+1)}},{key:"indexOf",value:function(g,x){for(var O=0;O<x.size();O++)if(g.x===x.getOrdinate(O,Kr.X)&&g.y===x.getOrdinate(O,Kr.Y))return O;return-1}},{key:"createClosedRing",value:function(g,x,O){var $=g.create(O,x.getDimension()),te=x.size();C.copy(x,0,$,0,te);for(var he=te;he<O;he++)C.copy(x,0,$,he,1);return $}},{key:"minCoordinate",value:function(g){for(var x=null,O=0;O<g.size();O++){var $=g.getCoordinate(O);(x===null||x.compareTo($)>0)&&(x=$)}return x}}])}(),Bn=function(){function C(){c(this,C)}return i(C,null,[{key:"toDimensionSymbol",value:function(g){switch(g){case C.FALSE:return C.SYM_FALSE;case C.TRUE:return C.SYM_TRUE;case C.DONTCARE:return C.SYM_DONTCARE;case C.P:return C.SYM_P;case C.L:return C.SYM_L;case C.A:return C.SYM_A}throw new me("Unknown dimension value: "+g)}},{key:"toDimensionValue",value:function(g){switch(Ds.toUpperCase(g)){case C.SYM_FALSE:return C.FALSE;case C.SYM_TRUE:return C.TRUE;case C.SYM_DONTCARE:return C.DONTCARE;case C.SYM_P:return C.P;case C.SYM_L:return C.L;case C.SYM_A:return C.A}throw new me("Unknown dimension symbol: "+g)}}])}();Bn.P=0,Bn.L=1,Bn.A=2,Bn.FALSE=-1,Bn.TRUE=-2,Bn.DONTCARE=-3,Bn.SYM_FALSE="F",Bn.SYM_TRUE="T",Bn.SYM_DONTCARE="*",Bn.SYM_P="0",Bn.SYM_L="1",Bn.SYM_A="2";var Jl=function(){return i(function C(){c(this,C)},[{key:"filter",value:function(C){}}])}(),Ml=function(){return i(function C(){c(this,C)},[{key:"filter",value:function(C,g){}},{key:"isDone",value:function(){}},{key:"isGeometryChanged",value:function(){}}])}(),Mi=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,[{key:"computeEnvelopeInternal",value:function(){return this.isEmpty()?new Ne:this._points.expandEnvelope(new Ne)}},{key:"isRing",value:function(){return this.isClosed()&&this.isSimple()}},{key:"getCoordinates",value:function(){return this._points.toCoordinateArray()}},{key:"copyInternal",value:function(){return new g(this._points.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof An){var x=arguments[0],O=arguments[1];if(!this.isEquivalentClass(x))return!1;var $=x;if(this._points.size()!==$._points.size())return!1;for(var te=0;te<this._points.size();te++)if(!this.equal(this._points.getCoordinate(te),$._points.getCoordinate(te),O))return!1;return!0}return ie(g,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){for(var x=0;x<Math.trunc(this._points.size()/2);x++){var O=this._points.size()-1-x;if(!this._points.getCoordinate(x).equals(this._points.getCoordinate(O))){if(this._points.getCoordinate(x).compareTo(this._points.getCoordinate(O))>0){var $=this._points.copy();nl.reverse($),this._points=$}return null}}}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._points.getCoordinate(0)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?Bn.FALSE:0}},{key:"isClosed",value:function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}},{key:"reverseInternal",value:function(){var x=this._points.copy();return nl.reverse(x),this.getFactory().createLineString(x)}},{key:"getEndPoint",value:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}},{key:"getTypeCode",value:function(){return An.TYPECODE_LINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getLength",value:function(){return Al.ofLine(this._points)}},{key:"getNumPoints",value:function(){return this._points.size()}},{key:"compareToSameClass",value:function(){if(arguments.length===1){for(var x=arguments[0],O=0,$=0;O<this._points.size()&&$<x._points.size();){var te=this._points.getCoordinate(O).compareTo(x._points.getCoordinate($));if(te!==0)return te;O++,$++}return O<this._points.size()?1:$<x._points.size()?-1:0}if(arguments.length===2){var he=arguments[0];return arguments[1].compare(this._points,he._points)}}},{key:"apply",value:function(){if(Mn(arguments[0],Eo))for(var x=arguments[0],O=0;O<this._points.size();O++)x.filter(this._points.getCoordinate(O));else if(Mn(arguments[0],Ml)){var $=arguments[0];if(this._points.size()===0)return null;for(var te=0;te<this._points.size()&&($.filter(this._points,te),!$.isDone());te++);$.isGeometryChanged()&&this.geometryChanged()}else Mn(arguments[0],Jl)?arguments[0].filter(this):Mn(arguments[0],Ae)&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){throw new Ur}},{key:"isEquivalentClass",value:function(x){return x instanceof g}},{key:"getCoordinateN",value:function(x){return this._points.getCoordinate(x)}},{key:"getGeometryType",value:function(){return An.TYPENAME_LINESTRING}},{key:"getCoordinateSequence",value:function(){return this._points}},{key:"isEmpty",value:function(){return this._points.size()===0}},{key:"init",value:function(x){if(x===null&&(x=this.getFactory().getCoordinateSequenceFactory().create([])),x.size()===1)throw new me("Invalid number of points in LineString (found "+x.size()+" - must be 0 or >= 2)");this._points=x}},{key:"isCoordinate",value:function(x){for(var O=0;O<this._points.size();O++)if(this._points.getCoordinate(O).equals(x))return!0;return!1}},{key:"getStartPoint",value:function(){return this.isEmpty()?null:this.getPointN(0)}},{key:"getPointN",value:function(x){return this.getFactory().createPoint(this._points.getCoordinate(x))}},{key:"interfaces_",get:function(){return[zs]}}],[{key:"constructor_",value:function(){if(this._points=null,arguments.length!==0){if(arguments.length===2){var x=arguments[0],O=arguments[1];An.constructor_.call(this,O),this.init(x)}}}}])}(An),tc=i(function C(){c(this,C)}),Tu=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,[{key:"computeEnvelopeInternal",value:function(){if(this.isEmpty())return new Ne;var x=new Ne;return x.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),x}},{key:"getCoordinates",value:function(){return this.isEmpty()?[]:[this.getCoordinate()]}},{key:"copyInternal",value:function(){return new g(this._coordinates.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof An){var x=arguments[0],O=arguments[1];return!!this.isEquivalentClass(x)&&(!(!this.isEmpty()||!x.isEmpty())||this.isEmpty()===x.isEmpty()&&this.equal(x.getCoordinate(),this.getCoordinate(),O))}return ie(g,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){}},{key:"getCoordinate",value:function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null}},{key:"getBoundaryDimension",value:function(){return Bn.FALSE}},{key:"reverseInternal",value:function(){return this.getFactory().createPoint(this._coordinates.copy())}},{key:"getTypeCode",value:function(){return An.TYPECODE_POINT}},{key:"getDimension",value:function(){return 0}},{key:"getNumPoints",value:function(){return this.isEmpty()?0:1}},{key:"getX",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var x=arguments[0];return this.getCoordinate().compareTo(x.getCoordinate())}if(arguments.length===2){var O=arguments[0];return arguments[1].compare(this._coordinates,O._coordinates)}}},{key:"apply",value:function(){if(Mn(arguments[0],Eo)){var x=arguments[0];if(this.isEmpty())return null;x.filter(this.getCoordinate())}else if(Mn(arguments[0],Ml)){var O=arguments[0];if(this.isEmpty())return null;O.filter(this._coordinates,0),O.isGeometryChanged()&&this.geometryChanged()}else Mn(arguments[0],Jl)?arguments[0].filter(this):Mn(arguments[0],Ae)&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return An.TYPENAME_POINT}},{key:"getCoordinateSequence",value:function(){return this._coordinates}},{key:"getY",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y}},{key:"isEmpty",value:function(){return this._coordinates.size()===0}},{key:"init",value:function(x){x===null&&(x=this.getFactory().getCoordinateSequenceFactory().create([])),cn.isTrue(x.size()<=1),this._coordinates=x}},{key:"isSimple",value:function(){return!0}},{key:"interfaces_",get:function(){return[tc]}}],[{key:"constructor_",value:function(){this._coordinates=null;var x=arguments[0],O=arguments[1];An.constructor_.call(this,O),this.init(x)}}])}(An),Eu=function(){function C(){c(this,C)}return i(C,null,[{key:"ofRing",value:function(){if(arguments[0]instanceof Array){var g=arguments[0];return Math.abs(C.ofRingSigned(g))}if(Mn(arguments[0],Kr)){var x=arguments[0];return Math.abs(C.ofRingSigned(x))}}},{key:"ofRingSigned",value:function(){if(arguments[0]instanceof Array){var g=arguments[0];if(g.length<3)return 0;for(var x=0,O=g[0].x,$=1;$<g.length-1;$++){var te=g[$].x-O,he=g[$+1].y;x+=te*(g[$-1].y-he)}return x/2}if(Mn(arguments[0],Kr)){var Te=arguments[0],Be=Te.size();if(Be<3)return 0;var et=new Et,Dt=new Et,Ht=new Et;Te.getCoordinate(0,Dt),Te.getCoordinate(1,Ht);var bn=Dt.x;Ht.x-=bn;for(var Hn=0,sr=1;sr<Be-1;sr++)et.y=Dt.y,Dt.x=Ht.x,Dt.y=Ht.y,Te.getCoordinate(sr+1,Ht),Ht.x-=bn,Hn+=Dt.x*(et.y-Ht.y);return Hn/2}}}])}(),ea=function(){return i(function C(){c(this,C)},null,[{key:"sort",value:function(){var C=arguments,g=arguments[0];if(arguments.length===1)g.sort(function(bn,Hn){return bn.compareTo(Hn)});else if(arguments.length===2)g.sort(function(bn,Hn){return C[1].compare(bn,Hn)});else if(arguments.length===3){var x=g.slice(arguments[1],arguments[2]);x.sort();var O=g.slice(0,arguments[1]).concat(x,g.slice(arguments[2],g.length));g.splice(0,g.length);var $,te=P(O);try{for(te.s();!($=te.n()).done;){var he=$.value;g.push(he)}}catch(bn){te.e(bn)}finally{te.f()}}else if(arguments.length===4){var Te=g.slice(arguments[1],arguments[2]);Te.sort(function(bn,Hn){return C[3].compare(bn,Hn)});var Be=g.slice(0,arguments[1]).concat(Te,g.slice(arguments[2],g.length));g.splice(0,g.length);var et,Dt=P(Be);try{for(Dt.s();!(et=Dt.n()).done;){var Ht=et.value;g.push(Ht)}}catch(bn){Dt.e(bn)}finally{Dt.f()}}}},{key:"asList",value:function(C){var g,x=new Er,O=P(C);try{for(O.s();!(g=O.n()).done;){var $=g.value;x.add($)}}catch(te){O.e(te)}finally{O.f()}return x}},{key:"copyOf",value:function(C,g){return C.slice(0,g)}}])}(),ls=i(function C(){c(this,C)}),wt=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,[{key:"computeEnvelopeInternal",value:function(){return this._shell.getEnvelopeInternal()}},{key:"getCoordinates",value:function(){if(this.isEmpty())return[];for(var x=new Array(this.getNumPoints()).fill(null),O=-1,$=this._shell.getCoordinates(),te=0;te<$.length;te++)x[++O]=$[te];for(var he=0;he<this._holes.length;he++)for(var Te=this._holes[he].getCoordinates(),Be=0;Be<Te.length;Be++)x[++O]=Te[Be];return x}},{key:"getArea",value:function(){var x=0;x+=Eu.ofRing(this._shell.getCoordinateSequence());for(var O=0;O<this._holes.length;O++)x-=Eu.ofRing(this._holes[O].getCoordinateSequence());return x}},{key:"copyInternal",value:function(){for(var x=this._shell.copy(),O=new Array(this._holes.length).fill(null),$=0;$<this._holes.length;$++)O[$]=this._holes[$].copy();return new g(x,O,this._factory)}},{key:"isRectangle",value:function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var x=this._shell.getCoordinateSequence(),O=this.getEnvelopeInternal(),$=0;$<5;$++){var te=x.getX($);if(te!==O.getMinX()&&te!==O.getMaxX())return!1;var he=x.getY($);if(he!==O.getMinY()&&he!==O.getMaxY())return!1}for(var Te=x.getX(0),Be=x.getY(0),et=1;et<=4;et++){var Dt=x.getX(et),Ht=x.getY(et);if(Dt!==Te==(Ht!==Be))return!1;Te=Dt,Be=Ht}return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof An){var x=arguments[0],O=arguments[1];if(!this.isEquivalentClass(x))return!1;var $=x,te=this._shell,he=$._shell;if(!te.equalsExact(he,O)||this._holes.length!==$._holes.length)return!1;for(var Te=0;Te<this._holes.length;Te++)if(!this._holes[Te].equalsExact($._holes[Te],O))return!1;return!0}return ie(g,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){if(arguments.length===0){this._shell=this.normalized(this._shell,!0);for(var x=0;x<this._holes.length;x++)this._holes[x]=this.normalized(this._holes[x],!1);ea.sort(this._holes)}else if(arguments.length===2){var O=arguments[0],$=arguments[1];if(O.isEmpty())return null;var te=O.getCoordinateSequence(),he=nl.minCoordinateIndex(te,0,te.size()-2);nl.scroll(te,he,!0),Rr.isCCW(te)===$&&nl.reverse(te)}}},{key:"getCoordinate",value:function(){return this._shell.getCoordinate()}},{key:"getNumInteriorRing",value:function(){return this._holes.length}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"reverseInternal",value:function(){for(var x=this.getExteriorRing().reverse(),O=new Array(this.getNumInteriorRing()).fill(null),$=0;$<O.length;$++)O[$]=this.getInteriorRingN($).reverse();return this.getFactory().createPolygon(x,O)}},{key:"getTypeCode",value:function(){return An.TYPECODE_POLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getLength",value:function(){var x=0;x+=this._shell.getLength();for(var O=0;O<this._holes.length;O++)x+=this._holes[O].getLength();return x}},{key:"getNumPoints",value:function(){for(var x=this._shell.getNumPoints(),O=0;O<this._holes.length;O++)x+=this._holes[O].getNumPoints();return x}},{key:"convexHull",value:function(){return this.getExteriorRing().convexHull()}},{key:"normalized",value:function(x,O){var $=x.copy();return this.normalize($,O),$}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var x=arguments[0],O=this._shell,$=x._shell;return O.compareToSameClass($)}if(arguments.length===2){var te=arguments[1],he=arguments[0],Te=this._shell,Be=he._shell,et=Te.compareToSameClass(Be,te);if(et!==0)return et;for(var Dt=this.getNumInteriorRing(),Ht=he.getNumInteriorRing(),bn=0;bn<Dt&&bn<Ht;){var Hn=this.getInteriorRingN(bn),sr=he.getInteriorRingN(bn),xr=Hn.compareToSameClass(sr,te);if(xr!==0)return xr;bn++}return bn<Dt?1:bn<Ht?-1:0}}},{key:"apply",value:function(){if(Mn(arguments[0],Eo)){var x=arguments[0];this._shell.apply(x);for(var O=0;O<this._holes.length;O++)this._holes[O].apply(x)}else if(Mn(arguments[0],Ml)){var $=arguments[0];if(this._shell.apply($),!$.isDone())for(var te=0;te<this._holes.length&&(this._holes[te].apply($),!$.isDone());te++);$.isGeometryChanged()&&this.geometryChanged()}else if(Mn(arguments[0],Jl))arguments[0].filter(this);else if(Mn(arguments[0],Ae)){var he=arguments[0];he.filter(this),this._shell.apply(he);for(var Te=0;Te<this._holes.length;Te++)this._holes[Te].apply(he)}}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var x=new Array(this._holes.length+1).fill(null);x[0]=this._shell;for(var O=0;O<this._holes.length;O++)x[O+1]=this._holes[O];return x.length<=1?this.getFactory().createLinearRing(x[0].getCoordinateSequence()):this.getFactory().createMultiLineString(x)}},{key:"getGeometryType",value:function(){return An.TYPENAME_POLYGON}},{key:"getExteriorRing",value:function(){return this._shell}},{key:"isEmpty",value:function(){return this._shell.isEmpty()}},{key:"getInteriorRingN",value:function(x){return this._holes[x]}},{key:"interfaces_",get:function(){return[ls]}}],[{key:"constructor_",value:function(){this._shell=null,this._holes=null;var x=arguments[0],O=arguments[1],$=arguments[2];if(An.constructor_.call(this,$),x===null&&(x=this.getFactory().createLinearRing()),O===null&&(O=[]),An.hasNullElements(O))throw new me("holes must not contain null elements");if(x.isEmpty()&&An.hasNonEmptyElements(O))throw new me("shell is empty but holes are not");this._shell=x,this._holes=O}}])}(An),de=function(C){function g(){return c(this,g),o(this,g,arguments)}return V(g,C),i(g)}(Wr),xe=function(C){function g(x){var O;return c(this,g),(O=o(this,g)).array=[],x instanceof jr&&O.addAll(x),O}return V(g,C),i(g,[{key:"contains",value:function(x){var O,$=P(this.array);try{for($.s();!(O=$.n()).done;)if(O.value.compareTo(x)===0)return!0}catch(te){$.e(te)}finally{$.f()}return!1}},{key:"add",value:function(x){if(this.contains(x))return!1;for(var O=0,$=this.array.length;O<$;O++)if(this.array[O].compareTo(x)===1)return!!this.array.splice(O,0,x);return this.array.push(x),!0}},{key:"addAll",value:function(x){var O,$=P(x);try{for($.s();!(O=$.n()).done;){var te=O.value;this.add(te)}}catch(he){$.e(he)}finally{$.f()}return!0}},{key:"remove",value:function(){throw new Ur}},{key:"size",value:function(){return this.array.length}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"toArray",value:function(){return this.array.slice()}},{key:"iterator",value:function(){return new Ie(this.array)}}])}(de),Ie=function(){return i(function C(g){c(this,C),this.array=g,this.position=0},[{key:"next",value:function(){if(this.position===this.array.length)throw new $t;return this.array[this.position++]}},{key:"hasNext",value:function(){return this.position<this.array.length}},{key:"remove",value:function(){throw new Ur}}])}(),Fe=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,[{key:"computeEnvelopeInternal",value:function(){for(var x=new Ne,O=0;O<this._geometries.length;O++)x.expandToInclude(this._geometries[O].getEnvelopeInternal());return x}},{key:"getGeometryN",value:function(x){return this._geometries[x]}},{key:"getCoordinates",value:function(){for(var x=new Array(this.getNumPoints()).fill(null),O=-1,$=0;$<this._geometries.length;$++)for(var te=this._geometries[$].getCoordinates(),he=0;he<te.length;he++)x[++O]=te[he];return x}},{key:"getArea",value:function(){for(var x=0,O=0;O<this._geometries.length;O++)x+=this._geometries[O].getArea();return x}},{key:"copyInternal",value:function(){for(var x=new Array(this._geometries.length).fill(null),O=0;O<x.length;O++)x[O]=this._geometries[O].copy();return new g(x,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof An){var x=arguments[0],O=arguments[1];if(!this.isEquivalentClass(x))return!1;var $=x;if(this._geometries.length!==$._geometries.length)return!1;for(var te=0;te<this._geometries.length;te++)if(!this._geometries[te].equalsExact($._geometries[te],O))return!1;return!0}return ie(g,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){for(var x=0;x<this._geometries.length;x++)this._geometries[x].normalize();ea.sort(this._geometries)}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}},{key:"getBoundaryDimension",value:function(){for(var x=Bn.FALSE,O=0;O<this._geometries.length;O++)x=Math.max(x,this._geometries[O].getBoundaryDimension());return x}},{key:"reverseInternal",value:function(){for(var x=this._geometries.length,O=new Er(x),$=0;$<x;$++)O.add(this._geometries[$].reverse());return this.getFactory().buildGeometry(O)}},{key:"getTypeCode",value:function(){return An.TYPECODE_GEOMETRYCOLLECTION}},{key:"getDimension",value:function(){for(var x=Bn.FALSE,O=0;O<this._geometries.length;O++)x=Math.max(x,this._geometries[O].getDimension());return x}},{key:"getLength",value:function(){for(var x=0,O=0;O<this._geometries.length;O++)x+=this._geometries[O].getLength();return x}},{key:"getNumPoints",value:function(){for(var x=0,O=0;O<this._geometries.length;O++)x+=this._geometries[O].getNumPoints();return x}},{key:"getNumGeometries",value:function(){return this._geometries.length}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var x=arguments[0],O=new xe(ea.asList(this._geometries)),$=new xe(ea.asList(x._geometries));return this.compare(O,$)}if(arguments.length===2){for(var te=arguments[1],he=arguments[0],Te=this.getNumGeometries(),Be=he.getNumGeometries(),et=0;et<Te&&et<Be;){var Dt=this.getGeometryN(et),Ht=he.getGeometryN(et),bn=Dt.compareToSameClass(Ht,te);if(bn!==0)return bn;et++}return et<Te?1:et<Be?-1:0}}},{key:"apply",value:function(){if(Mn(arguments[0],Eo))for(var x=arguments[0],O=0;O<this._geometries.length;O++)this._geometries[O].apply(x);else if(Mn(arguments[0],Ml)){var $=arguments[0];if(this._geometries.length===0)return null;for(var te=0;te<this._geometries.length&&(this._geometries[te].apply($),!$.isDone());te++);$.isGeometryChanged()&&this.geometryChanged()}else if(Mn(arguments[0],Jl)){var he=arguments[0];he.filter(this);for(var Te=0;Te<this._geometries.length;Te++)this._geometries[Te].apply(he)}else if(Mn(arguments[0],Ae)){var Be=arguments[0];Be.filter(this);for(var et=0;et<this._geometries.length;et++)this._geometries[et].apply(Be)}}},{key:"getBoundary",value:function(){return An.checkNotGeometryCollection(this),cn.shouldNeverReachHere(),null}},{key:"getGeometryType",value:function(){return An.TYPENAME_GEOMETRYCOLLECTION}},{key:"isEmpty",value:function(){for(var x=0;x<this._geometries.length;x++)if(!this._geometries[x].isEmpty())return!1;return!0}}],[{key:"constructor_",value:function(){if(this._geometries=null,arguments.length!==0){if(arguments.length===2){var x=arguments[0],O=arguments[1];if(An.constructor_.call(this,O),x===null&&(x=[]),An.hasNullElements(x))throw new me("geometries must not contain null elements");this._geometries=x}}}}])}(An),Xe=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,[{key:"copyInternal",value:function(){for(var x=new Array(this._geometries.length).fill(null),O=0;O<x.length;O++)x[O]=this._geometries[O].copy();return new g(x,this._factory)}},{key:"isValid",value:function(){return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof An){var x=arguments[0],O=arguments[1];return!!this.isEquivalentClass(x)&&ie(g,"equalsExact",this,1).call(this,x,O)}return ie(g,"equalsExact",this,1).apply(this,arguments)}},{key:"getCoordinate",value:function(){if(arguments.length===1&&Number.isInteger(arguments[0])){var x=arguments[0];return this._geometries[x].getCoordinate()}return ie(g,"getCoordinate",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return Bn.FALSE}},{key:"getTypeCode",value:function(){return An.TYPECODE_MULTIPOINT}},{key:"getDimension",value:function(){return 0}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return An.TYPENAME_MULTIPOINT}},{key:"interfaces_",get:function(){return[tc]}}],[{key:"constructor_",value:function(){var x=arguments[0],O=arguments[1];Fe.constructor_.call(this,x,O)}}])}(Fe),nt=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,[{key:"copyInternal",value:function(){return new g(this._points.copy(),this._factory)}},{key:"getBoundaryDimension",value:function(){return Bn.FALSE}},{key:"isClosed",value:function(){return!!this.isEmpty()||ie(g,"isClosed",this,1).call(this)}},{key:"reverseInternal",value:function(){var x=this._points.copy();return nl.reverse(x),this.getFactory().createLinearRing(x)}},{key:"getTypeCode",value:function(){return An.TYPECODE_LINEARRING}},{key:"validateConstruction",value:function(){if(!this.isEmpty()&&!ie(g,"isClosed",this,1).call(this))throw new me("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<g.MINIMUM_VALID_SIZE)throw new me("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}},{key:"getGeometryType",value:function(){return An.TYPENAME_LINEARRING}}],[{key:"constructor_",value:function(){var x=arguments[0],O=arguments[1];Mi.constructor_.call(this,x,O),this.validateConstruction()}}])}(Mi);nt.MINIMUM_VALID_SIZE=4;var ct=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,[{key:"setOrdinate",value:function(x,O){switch(x){case g.X:this.x=O;break;case g.Y:this.y=O;break;default:throw new me("Invalid ordinate index: "+x)}}},{key:"getZ",value:function(){return Et.NULL_ORDINATE}},{key:"getOrdinate",value:function(x){switch(x){case g.X:return this.x;case g.Y:return this.y}throw new me("Invalid ordinate index: "+x)}},{key:"setZ",value:function(x){throw new me("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new g(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}},{key:"setCoordinate",value:function(x){this.x=x.x,this.y=x.y,this.z=x.getZ()}}],[{key:"constructor_",value:function(){if(arguments.length===0)Et.constructor_.call(this);else if(arguments.length===1){if(arguments[0]instanceof g){var x=arguments[0];Et.constructor_.call(this,x.x,x.y)}else if(arguments[0]instanceof Et){var O=arguments[0];Et.constructor_.call(this,O.x,O.y)}}else if(arguments.length===2){var $=arguments[0],te=arguments[1];Et.constructor_.call(this,$,te,Et.NULL_ORDINATE)}}}])}(Et);ct.X=0,ct.Y=1,ct.Z=-1,ct.M=-1;var rt=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(x,O){switch(x){case g.X:this.x=O;break;case g.Y:this.y=O;break;case g.M:this._m=O;break;default:throw new me("Invalid ordinate index: "+x)}}},{key:"setM",value:function(x){this._m=x}},{key:"getZ",value:function(){return Et.NULL_ORDINATE}},{key:"getOrdinate",value:function(x){switch(x){case g.X:return this.x;case g.Y:return this.y;case g.M:return this._m}throw new me("Invalid ordinate index: "+x)}},{key:"setZ",value:function(x){throw new me("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new g(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(x){this.x=x.x,this.y=x.y,this.z=x.getZ(),this._m=x.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)Et.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof g){var x=arguments[0];Et.constructor_.call(this,x.x,x.y),this._m=x._m}else if(arguments[0]instanceof Et){var O=arguments[0];Et.constructor_.call(this,O.x,O.y),this._m=this.getM()}}else if(arguments.length===3){var $=arguments[0],te=arguments[1],he=arguments[2];Et.constructor_.call(this,$,te,Et.NULL_ORDINATE),this._m=he}}}])}(Et);rt.X=0,rt.Y=1,rt.Z=-1,rt.M=2;var vt=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(x,O){switch(x){case Et.X:this.x=O;break;case Et.Y:this.y=O;break;case Et.Z:this.z=O;break;case Et.M:this._m=O;break;default:throw new me("Invalid ordinate index: "+x)}}},{key:"setM",value:function(x){this._m=x}},{key:"getOrdinate",value:function(x){switch(x){case Et.X:return this.x;case Et.Y:return this.y;case Et.Z:return this.getZ();case Et.M:return this.getM()}throw new me("Invalid ordinate index: "+x)}},{key:"copy",value:function(){return new g(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(x){this.x=x.x,this.y=x.y,this.z=x.getZ(),this._m=x.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)Et.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof g){var x=arguments[0];Et.constructor_.call(this,x),this._m=x._m}else if(arguments[0]instanceof Et){var O=arguments[0];Et.constructor_.call(this,O),this._m=this.getM()}}else if(arguments.length===4){var $=arguments[0],te=arguments[1],he=arguments[2],Te=arguments[3];Et.constructor_.call(this,$,te,he),this._m=Te}}}])}(Et),gt=function(){function C(){c(this,C)}return i(C,null,[{key:"measures",value:function(g){return g instanceof ct?0:g instanceof rt||g instanceof vt?1:0}},{key:"dimension",value:function(g){return g instanceof ct?2:g instanceof rt?3:g instanceof vt?4:3}},{key:"create",value:function(){if(arguments.length===1){var g=arguments[0];return C.create(g,0)}if(arguments.length===2){var x=arguments[0],O=arguments[1];return x===2?new ct:x===3&&O===0?new Et:x===3&&O===1?new rt:x===4&&O===1?new vt:new Et}}}])}(),xt=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,[{key:"getCoordinate",value:function(x){return this.get(x)}},{key:"addAll",value:function(){if(arguments.length===2&&typeof arguments[1]=="boolean"&&Mn(arguments[0],jr)){for(var x=arguments[1],O=!1,$=arguments[0].iterator();$.hasNext();)this.add($.next(),x),O=!0;return O}return ie(g,"addAll",this,1).apply(this,arguments)}},{key:"clone",value:function(){for(var x=ie(g,"clone",this,1).call(this),O=0;O<this.size();O++)x.add(O,this.get(O).clone());return x}},{key:"toCoordinateArray",value:function(){if(arguments.length===0)return this.toArray(g.coordArrayType);if(arguments.length===1){if(arguments[0])return this.toArray(g.coordArrayType);for(var x=this.size(),O=new Array(x).fill(null),$=0;$<x;$++)O[$]=this.get(x-$-1);return O}}},{key:"add",value:function(){if(arguments.length===1){var x=arguments[0];return ie(g,"add",this,1).call(this,x)}if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var O=arguments[0],$=arguments[1];return this.add(O,$,!0),!0}if(arguments[0]instanceof Et&&typeof arguments[1]=="boolean"){var te=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(te))return null;ie(g,"add",this,1).call(this,te)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var he=arguments[0],Te=arguments[1];return this.add(he,Te),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var Be=arguments[0],et=arguments[1];if(arguments[2])for(var Dt=0;Dt<Be.length;Dt++)this.add(Be[Dt],et);else for(var Ht=Be.length-1;Ht>=0;Ht--)this.add(Be[Ht],et);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof Et){var bn=arguments[0],Hn=arguments[1];if(!arguments[2]){var sr=this.size();if(sr>0&&(bn>0&&this.get(bn-1).equals2D(Hn)||bn<sr&&this.get(bn).equals2D(Hn)))return null}ie(g,"add",this,1).call(this,bn,Hn)}}else if(arguments.length===4){var xr=arguments[0],Jr=arguments[1],Qr=arguments[2],xi=arguments[3],Si=1;Qr>xi&&(Si=-1);for(var mi=Qr;mi!==xi;mi+=Si)this.add(xr[mi],Jr);return!0}}},{key:"closeRing",value:function(){if(this.size()>0){var x=this.get(0).copy();this.add(x,!1)}}}],[{key:"constructor_",value:function(){if(arguments.length!==0){if(arguments.length===1){var x=arguments[0];this.ensureCapacity(x.length),this.add(x,!0)}else if(arguments.length===2){var O=arguments[0],$=arguments[1];this.ensureCapacity(O.length),this.add(O,$)}}}}])}(Er);xt.coordArrayType=new Array(0).fill(null);var Ct=function(){function C(){c(this,C)}return i(C,null,[{key:"isRing",value:function(g){return!(g.length<4)&&!!g[0].equals2D(g[g.length-1])}},{key:"ptNotInList",value:function(g,x){for(var O=0;O<g.length;O++){var $=g[O];if(C.indexOf($,x)<0)return $}return null}},{key:"scroll",value:function(g,x){var O=C.indexOf(x,g);if(O<0)return null;var $=new Array(g.length).fill(null);_a.arraycopy(g,O,$,0,g.length-O),_a.arraycopy(g,0,$,g.length-O,O),_a.arraycopy($,0,g,0,g.length)}},{key:"equals",value:function(){if(arguments.length===2){var g=arguments[0],x=arguments[1];if(g===x)return!0;if(g===null||x===null||g.length!==x.length)return!1;for(var O=0;O<g.length;O++)if(!g[O].equals(x[O]))return!1;return!0}if(arguments.length===3){var $=arguments[0],te=arguments[1],he=arguments[2];if($===te)return!0;if($===null||te===null||$.length!==te.length)return!1;for(var Te=0;Te<$.length;Te++)if(he.compare($[Te],te[Te])!==0)return!1;return!0}}},{key:"intersection",value:function(g,x){for(var O=new xt,$=0;$<g.length;$++)x.intersects(g[$])&&O.add(g[$],!0);return O.toCoordinateArray()}},{key:"measures",value:function(g){if(g===null||g.length===0)return 0;var x,O=0,$=P(g);try{for($.s();!(x=$.n()).done;){var te=x.value;O=Math.max(O,gt.measures(te))}}catch(he){$.e(he)}finally{$.f()}return O}},{key:"hasRepeatedPoints",value:function(g){for(var x=1;x<g.length;x++)if(g[x-1].equals(g[x]))return!0;return!1}},{key:"removeRepeatedPoints",value:function(g){return C.hasRepeatedPoints(g)?new xt(g,!1).toCoordinateArray():g}},{key:"reverse",value:function(g){for(var x=g.length-1,O=Math.trunc(x/2),$=0;$<=O;$++){var te=g[$];g[$]=g[x-$],g[x-$]=te}}},{key:"removeNull",value:function(g){for(var x=0,O=0;O<g.length;O++)g[O]!==null&&x++;var $=new Array(x).fill(null);if(x===0)return $;for(var te=0,he=0;he<g.length;he++)g[he]!==null&&($[te++]=g[he]);return $}},{key:"copyDeep",value:function(){if(arguments.length===1){for(var g=arguments[0],x=new Array(g.length).fill(null),O=0;O<g.length;O++)x[O]=g[O].copy();return x}if(arguments.length===5)for(var $=arguments[0],te=arguments[1],he=arguments[2],Te=arguments[3],Be=arguments[4],et=0;et<Be;et++)he[Te+et]=$[te+et].copy()}},{key:"isEqualReversed",value:function(g,x){for(var O=0;O<g.length;O++){var $=g[O],te=x[g.length-O-1];if($.compareTo(te)!==0)return!1}return!0}},{key:"envelope",value:function(g){for(var x=new Ne,O=0;O<g.length;O++)x.expandToInclude(g[O]);return x}},{key:"toCoordinateArray",value:function(g){return g.toArray(C.coordArrayType)}},{key:"dimension",value:function(g){if(g===null||g.length===0)return 3;var x,O=0,$=P(g);try{for($.s();!(x=$.n()).done;){var te=x.value;O=Math.max(O,gt.dimension(te))}}catch(he){$.e(he)}finally{$.f()}return O}},{key:"atLeastNCoordinatesOrNothing",value:function(g,x){return x.length>=g?x:[]}},{key:"indexOf",value:function(g,x){for(var O=0;O<x.length;O++)if(g.equals(x[O]))return O;return-1}},{key:"increasingDirection",value:function(g){for(var x=0;x<Math.trunc(g.length/2);x++){var O=g.length-1-x,$=g[x].compareTo(g[O]);if($!==0)return $}return 1}},{key:"compare",value:function(g,x){for(var O=0;O<g.length&&O<x.length;){var $=g[O].compareTo(x[O]);if($!==0)return $;O++}return O<x.length?-1:O<g.length?1:0}},{key:"minCoordinate",value:function(g){for(var x=null,O=0;O<g.length;O++)(x===null||x.compareTo(g[O])>0)&&(x=g[O]);return x}},{key:"extract",value:function(g,x,O){x=Kl.clamp(x,0,g.length);var $=(O=Kl.clamp(O,-1,g.length))-x+1;O<0&&($=0),x>=g.length&&($=0),O<x&&($=0);var te=new Array($).fill(null);if($===0)return te;for(var he=0,Te=x;Te<=O;Te++)te[he++]=g[Te];return te}}])}(),un=function(){return i(function C(){c(this,C)},[{key:"compare",value:function(C,g){var x=C,O=g;return Ct.compare(x,O)}},{key:"interfaces_",get:function(){return[Xt]}}])}(),hn=function(){return i(function C(){c(this,C)},[{key:"compare",value:function(C,g){var x=C,O=g;if(x.length<O.length)return-1;if(x.length>O.length)return 1;if(x.length===0)return 0;var $=Ct.compare(x,O);return Ct.isEqualReversed(x,O)?0:$}},{key:"OLDcompare",value:function(C,g){var x=C,O=g;if(x.length<O.length)return-1;if(x.length>O.length)return 1;if(x.length===0)return 0;for(var $=Ct.increasingDirection(x),te=Ct.increasingDirection(O),he=$>0?0:x.length-1,Te=te>0?0:x.length-1,Be=0;Be<x.length;Be++){var et=x[he].compareTo(O[Te]);if(et!==0)return et;he+=$,Te+=te}return 0}},{key:"interfaces_",get:function(){return[Xt]}}])}();Ct.ForwardComparator=un,Ct.BidirectionalComparator=hn,Ct.coordArrayType=new Array(0).fill(null);var Rn=function(){return i(function C(g){c(this,C),this.str=g},[{key:"append",value:function(C){this.str+=C}},{key:"setCharAt",value:function(C,g){this.str=this.str.substr(0,C)+g+this.str.substr(C+1)}},{key:"toString",value:function(){return this.str}}])}(),$n=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"getM",value:function(g){return this.hasM()?this._coordinates[g].getM():Ze.NaN}},{key:"setOrdinate",value:function(g,x,O){switch(x){case Kr.X:this._coordinates[g].x=O;break;case Kr.Y:this._coordinates[g].y=O;break;default:this._coordinates[g].setOrdinate(x,O)}}},{key:"getZ",value:function(g){return this.hasZ()?this._coordinates[g].getZ():Ze.NaN}},{key:"size",value:function(){return this._coordinates.length}},{key:"getOrdinate",value:function(g,x){switch(x){case Kr.X:return this._coordinates[g].x;case Kr.Y:return this._coordinates[g].y;default:return this._coordinates[g].getOrdinate(x)}}},{key:"getCoordinate",value:function(){if(arguments.length===1){var g=arguments[0];return this._coordinates[g]}if(arguments.length===2){var x=arguments[0];arguments[1].setCoordinate(this._coordinates[x])}}},{key:"getCoordinateCopy",value:function(g){var x=this.createCoordinate();return x.setCoordinate(this._coordinates[g]),x}},{key:"createCoordinate",value:function(){return gt.create(this.getDimension(),this.getMeasures())}},{key:"getDimension",value:function(){return this._dimension}},{key:"getX",value:function(g){return this._coordinates[g].x}},{key:"getMeasures",value:function(){return this._measures}},{key:"expandEnvelope",value:function(g){for(var x=0;x<this._coordinates.length;x++)g.expandToInclude(this._coordinates[x]);return g}},{key:"copy",value:function(){for(var g=new Array(this.size()).fill(null),x=0;x<this._coordinates.length;x++){var O=this.createCoordinate();O.setCoordinate(this._coordinates[x]),g[x]=O}return new C(g,this._dimension,this._measures)}},{key:"toString",value:function(){if(this._coordinates.length>0){var g=new Rn(17*this._coordinates.length);g.append("("),g.append(this._coordinates[0]);for(var x=1;x<this._coordinates.length;x++)g.append(", "),g.append(this._coordinates[x]);return g.append(")"),g.toString()}return"()"}},{key:"getY",value:function(g){return this._coordinates[g].y}},{key:"toCoordinateArray",value:function(){return this._coordinates}},{key:"interfaces_",get:function(){return[Kr,He]}}],[{key:"constructor_",value:function(){if(this._dimension=3,this._measures=0,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array){var g=arguments[0];C.constructor_.call(this,g,Ct.dimension(g),Ct.measures(g))}else if(Number.isInteger(arguments[0])){var x=arguments[0];this._coordinates=new Array(x).fill(null);for(var O=0;O<x;O++)this._coordinates[O]=new Et}else if(Mn(arguments[0],Kr)){var $=arguments[0];if($===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=$.getDimension(),this._measures=$.getMeasures(),this._coordinates=new Array($.size()).fill(null);for(var te=0;te<this._coordinates.length;te++)this._coordinates[te]=$.getCoordinateCopy(te)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var he=arguments[0],Te=arguments[1];C.constructor_.call(this,he,Te,Ct.measures(he))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var Be=arguments[0],et=arguments[1];this._coordinates=new Array(Be).fill(null),this._dimension=et;for(var Dt=0;Dt<Be;Dt++)this._coordinates[Dt]=gt.create(et)}}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var Ht=arguments[0],bn=arguments[1],Hn=arguments[2];this._dimension=bn,this._measures=Hn,this._coordinates=Ht===null?new Array(0).fill(null):Ht}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var sr=arguments[0],xr=arguments[1],Jr=arguments[2];this._coordinates=new Array(sr).fill(null),this._dimension=xr,this._measures=Jr;for(var Qr=0;Qr<sr;Qr++)this._coordinates[Qr]=this.createCoordinate()}}}}])}(),Xn=function(){function C(){c(this,C)}return i(C,[{key:"readResolve",value:function(){return C.instance()}},{key:"create",value:function(){if(arguments.length===1){if(arguments[0]instanceof Array)return new $n(arguments[0]);if(Mn(arguments[0],Kr))return new $n(arguments[0])}else{if(arguments.length===2){var g=arguments[1];return g>3&&(g=3),g<2&&(g=2),new $n(arguments[0],g)}if(arguments.length===3){var x=arguments[2],O=arguments[1]-x;return x>1&&(x=1),O>3&&(O=3),O<2&&(O=2),new $n(arguments[0],O+x,x)}}}},{key:"interfaces_",get:function(){return[Zo,He]}}],[{key:"instance",value:function(){return C.instanceObject}}])}();Xn.instanceObject=new Xn;var Fn=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,[{key:"copyInternal",value:function(){for(var x=new Array(this._geometries.length).fill(null),O=0;O<x.length;O++)x[O]=this._geometries[O].copy();return new g(x,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof An){var x=arguments[0],O=arguments[1];return!!this.isEquivalentClass(x)&&ie(g,"equalsExact",this,1).call(this,x,O)}return ie(g,"equalsExact",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"getTypeCode",value:function(){return An.TYPECODE_MULTIPOLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var x=new Er,O=0;O<this._geometries.length;O++)for(var $=this._geometries[O].getBoundary(),te=0;te<$.getNumGeometries();te++)x.add($.getGeometryN(te));var he=new Array(x.size()).fill(null);return this.getFactory().createMultiLineString(x.toArray(he))}},{key:"getGeometryType",value:function(){return An.TYPENAME_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[ls]}}],[{key:"constructor_",value:function(){var x=arguments[0],O=arguments[1];Fe.constructor_.call(this,x,O)}}])}(Fe),yr=function(){return i(function C(){c(this,C)},[{key:"get",value:function(){}},{key:"put",value:function(){}},{key:"size",value:function(){}},{key:"values",value:function(){}},{key:"entrySet",value:function(){}}])}(),Tr=function(C){function g(){var x;return c(this,g),(x=o(this,g)).map=new Map,x}return V(g,C),i(g,[{key:"get",value:function(x){return this.map.get(x)||null}},{key:"put",value:function(x,O){return this.map.set(x,O),O}},{key:"values",value:function(){for(var x=new Er,O=this.map.values(),$=O.next();!$.done;)x.add($.value),$=O.next();return x}},{key:"entrySet",value:function(){var x=new Qi;return this.map.entries().forEach(function(O){return x.add(O)}),x}},{key:"size",value:function(){return this.map.size()}}])}(yr),or=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"equals",value:function(g){if(!(g instanceof C))return!1;var x=g;return this._modelType===x._modelType&&this._scale===x._scale}},{key:"compareTo",value:function(g){var x=g,O=this.getMaximumSignificantDigits(),$=x.getMaximumSignificantDigits();return To.compare(O,$)}},{key:"getScale",value:function(){return this._scale}},{key:"isFloating",value:function(){return this._modelType===C.FLOATING||this._modelType===C.FLOATING_SINGLE}},{key:"getType",value:function(){return this._modelType}},{key:"toString",value:function(){var g="UNKNOWN";return this._modelType===C.FLOATING?g="Floating":this._modelType===C.FLOATING_SINGLE?g="Floating-Single":this._modelType===C.FIXED&&(g="Fixed (Scale="+this.getScale()+")"),g}},{key:"makePrecise",value:function(){if(typeof arguments[0]=="number"){var g=arguments[0];return Ze.isNaN(g)||this._modelType===C.FLOATING_SINGLE?g:this._modelType===C.FIXED?Math.round(g*this._scale)/this._scale:g}if(arguments[0]instanceof Et){var x=arguments[0];if(this._modelType===C.FLOATING)return null;x.x=this.makePrecise(x.x),x.y=this.makePrecise(x.y)}}},{key:"getMaximumSignificantDigits",value:function(){var g=16;return this._modelType===C.FLOATING?g=16:this._modelType===C.FLOATING_SINGLE?g=6:this._modelType===C.FIXED&&(g=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),g}},{key:"setScale",value:function(g){this._scale=Math.abs(g)}},{key:"interfaces_",get:function(){return[He,Oe]}}],[{key:"constructor_",value:function(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=C.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Or){var g=arguments[0];this._modelType=g,g===C.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var x=arguments[0];this._modelType=C.FIXED,this.setScale(x)}else if(arguments[0]instanceof C){var O=arguments[0];this._modelType=O._modelType,this._scale=O._scale}}}},{key:"mostPrecise",value:function(g,x){return g.compareTo(x)>=0?g:x}}])}(),Or=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"readResolve",value:function(){return C.nameToTypeMap.get(this._name)}},{key:"toString",value:function(){return this._name}},{key:"interfaces_",get:function(){return[He]}}],[{key:"constructor_",value:function(){this._name=null;var g=arguments[0];this._name=g,C.nameToTypeMap.put(g,this)}}])}();Or.nameToTypeMap=new Tr,or.Type=Or,or.FIXED=new Or("FIXED"),or.FLOATING=new Or("FLOATING"),or.FLOATING_SINGLE=new Or("FLOATING SINGLE"),or.maximumPreciseValue=9007199254740992;var Nr=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,[{key:"copyInternal",value:function(){for(var x=new Array(this._geometries.length).fill(null),O=0;O<x.length;O++)x[O]=this._geometries[O].copy();return new g(x,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof An){var x=arguments[0],O=arguments[1];return!!this.isEquivalentClass(x)&&ie(g,"equalsExact",this,1).call(this,x,O)}return ie(g,"equalsExact",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?Bn.FALSE:0}},{key:"isClosed",value:function(){if(this.isEmpty())return!1;for(var x=0;x<this._geometries.length;x++)if(!this._geometries[x].isClosed())return!1;return!0}},{key:"getTypeCode",value:function(){return An.TYPECODE_MULTILINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getBoundary",value:function(){throw new Ur}},{key:"getGeometryType",value:function(){return An.TYPENAME_MULTILINESTRING}},{key:"interfaces_",get:function(){return[zs]}}],[{key:"constructor_",value:function(){var x=arguments[0],O=arguments[1];Fe.constructor_.call(this,x,O)}}])}(Fe),Pi=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"createEmpty",value:function(g){switch(g){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new me("Invalid dimension: "+g)}}},{key:"toGeometry",value:function(g){return g.isNull()?this.createPoint():g.getMinX()===g.getMaxX()&&g.getMinY()===g.getMaxY()?this.createPoint(new Et(g.getMinX(),g.getMinY())):g.getMinX()===g.getMaxX()||g.getMinY()===g.getMaxY()?this.createLineString([new Et(g.getMinX(),g.getMinY()),new Et(g.getMaxX(),g.getMaxY())]):this.createPolygon(this.createLinearRing([new Et(g.getMinX(),g.getMinY()),new Et(g.getMinX(),g.getMaxY()),new Et(g.getMaxX(),g.getMaxY()),new Et(g.getMaxX(),g.getMinY()),new Et(g.getMinX(),g.getMinY())]),null)}},{key:"createLineString",value:function(){if(arguments.length===0)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var g=arguments[0];return this.createLineString(g!==null?this.getCoordinateSequenceFactory().create(g):null)}if(Mn(arguments[0],Kr))return new Mi(arguments[0],this)}}},{key:"createMultiLineString",value:function(){return arguments.length===0?new Nr(null,this):arguments.length===1?new Nr(arguments[0],this):void 0}},{key:"buildGeometry",value:function(g){for(var x=null,O=!1,$=!1,te=g.iterator();te.hasNext();){var he=te.next(),Te=he.getTypeCode();x===null&&(x=Te),Te!==x&&(O=!0),he instanceof Fe&&($=!0)}if(x===null)return this.createGeometryCollection();if(O||$)return this.createGeometryCollection(C.toGeometryArray(g));var Be=g.iterator().next();if(g.size()>1){if(Be instanceof wt)return this.createMultiPolygon(C.toPolygonArray(g));if(Be instanceof Mi)return this.createMultiLineString(C.toLineStringArray(g));if(Be instanceof Tu)return this.createMultiPoint(C.toPointArray(g));cn.shouldNeverReachHere("Unhandled geometry type: "+Be.getGeometryType())}return Be}},{key:"createMultiPointFromCoords",value:function(g){return this.createMultiPoint(g!==null?this.getCoordinateSequenceFactory().create(g):null)}},{key:"createPoint",value:function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Et){var g=arguments[0];return this.createPoint(g!==null?this.getCoordinateSequenceFactory().create([g]):null)}if(Mn(arguments[0],Kr))return new Tu(arguments[0],this)}}},{key:"getCoordinateSequenceFactory",value:function(){return this._coordinateSequenceFactory}},{key:"createPolygon",value:function(){if(arguments.length===0)return this.createPolygon(null,null);if(arguments.length===1){if(Mn(arguments[0],Kr)){var g=arguments[0];return this.createPolygon(this.createLinearRing(g))}if(arguments[0]instanceof Array){var x=arguments[0];return this.createPolygon(this.createLinearRing(x))}if(arguments[0]instanceof nt){var O=arguments[0];return this.createPolygon(O,null)}}else if(arguments.length===2)return new wt(arguments[0],arguments[1],this)}},{key:"getSRID",value:function(){return this._SRID}},{key:"createGeometryCollection",value:function(){return arguments.length===0?new Fe(null,this):arguments.length===1?new Fe(arguments[0],this):void 0}},{key:"getPrecisionModel",value:function(){return this._precisionModel}},{key:"createLinearRing",value:function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var g=arguments[0];return this.createLinearRing(g!==null?this.getCoordinateSequenceFactory().create(g):null)}if(Mn(arguments[0],Kr))return new nt(arguments[0],this)}}},{key:"createMultiPolygon",value:function(){return arguments.length===0?new Fn(null,this):arguments.length===1?new Fn(arguments[0],this):void 0}},{key:"createMultiPoint",value:function(){if(arguments.length===0)return new Xe(null,this);if(arguments.length===1){if(arguments[0]instanceof Array)return new Xe(arguments[0],this);if(Mn(arguments[0],Kr)){var g=arguments[0];if(g===null)return this.createMultiPoint(new Array(0).fill(null));for(var x=new Array(g.size()).fill(null),O=0;O<g.size();O++){var $=this.getCoordinateSequenceFactory().create(1,g.getDimension(),g.getMeasures());nl.copy(g,O,$,0,1),x[O]=this.createPoint($)}return this.createMultiPoint(x)}}}},{key:"interfaces_",get:function(){return[He]}}],[{key:"constructor_",value:function(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,arguments.length===0)C.constructor_.call(this,new or,0);else if(arguments.length===1){if(Mn(arguments[0],Zo)){var g=arguments[0];C.constructor_.call(this,new or,0,g)}else if(arguments[0]instanceof or){var x=arguments[0];C.constructor_.call(this,x,0,C.getDefaultCoordinateSequenceFactory())}}else if(arguments.length===2){var O=arguments[0],$=arguments[1];C.constructor_.call(this,O,$,C.getDefaultCoordinateSequenceFactory())}else if(arguments.length===3){var te=arguments[0],he=arguments[1],Te=arguments[2];this._precisionModel=te,this._coordinateSequenceFactory=Te,this._SRID=he}}},{key:"toMultiPolygonArray",value:function(g){var x=new Array(g.size()).fill(null);return g.toArray(x)}},{key:"toGeometryArray",value:function(g){if(g===null)return null;var x=new Array(g.size()).fill(null);return g.toArray(x)}},{key:"getDefaultCoordinateSequenceFactory",value:function(){return Xn.instance()}},{key:"toMultiLineStringArray",value:function(g){var x=new Array(g.size()).fill(null);return g.toArray(x)}},{key:"toLineStringArray",value:function(g){var x=new Array(g.size()).fill(null);return g.toArray(x)}},{key:"toMultiPointArray",value:function(g){var x=new Array(g.size()).fill(null);return g.toArray(x)}},{key:"toLinearRingArray",value:function(g){var x=new Array(g.size()).fill(null);return g.toArray(x)}},{key:"toPointArray",value:function(g){var x=new Array(g.size()).fill(null);return g.toArray(x)}},{key:"toPolygonArray",value:function(g){var x=new Array(g.size()).fill(null);return g.toArray(x)}},{key:"createPointFromInternalCoord",value:function(g,x){return x.getPrecisionModel().makePrecise(g),x.getFactory().createPoint(g)}}])}(),Ao="XY",ta="XYZ",Ri="XYM",Vi="XYZM",Au={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},rl="EMPTY",Ns=1,us=2,cs=3,Lh=4,Na=5,Ha=6;for(var hs in Au)Au[hs].toUpperCase();var Bs=function(){return i(function C(g){c(this,C),this.wkt=g,this.index_=-1},[{key:"isAlpha_",value:function(C){return C>="a"&&C<="z"||C>="A"&&C<="Z"}},{key:"isNumeric_",value:function(C,g){return C>="0"&&C<="9"||C=="."&&!(g!==void 0&&g)}},{key:"isWhiteSpace_",value:function(C){return C==" "||C=="	"||C=="\r"||C==`
`}},{key:"nextChar_",value:function(){return this.wkt.charAt(++this.index_)}},{key:"nextToken",value:function(){var C,g=this.nextChar_(),x=this.index_,O=g;if(g=="(")C=us;else if(g==",")C=Na;else if(g==")")C=cs;else if(this.isNumeric_(g)||g=="-")C=Lh,O=this.readNumber_();else if(this.isAlpha_(g))C=Ns,O=this.readText_();else{if(this.isWhiteSpace_(g))return this.nextToken();if(g!=="")throw new Error("Unexpected character: "+g);C=Ha}return{position:x,value:O,type:C}}},{key:"readNumber_",value:function(){var C,g=this.index_,x=!1,O=!1;do C=="."?x=!0:C!="e"&&C!="E"||(O=!0),C=this.nextChar_();while(this.isNumeric_(C,x)||!O&&(C=="e"||C=="E")||O&&(C=="-"||C=="+"));return parseFloat(this.wkt.substring(g,this.index_--))}},{key:"readText_",value:function(){var C,g=this.index_;do C=this.nextChar_();while(this.isAlpha_(C));return this.wkt.substring(g,this.index_--).toUpperCase()}}])}(),Mo=function(){return i(function C(g,x){c(this,C),this.lexer_=g,this.token_,this.layout_=Ao,this.factory=x},[{key:"consume_",value:function(){this.token_=this.lexer_.nextToken()}},{key:"isTokenType",value:function(C){return this.token_.type==C}},{key:"match",value:function(C){var g=this.isTokenType(C);return g&&this.consume_(),g}},{key:"parse",value:function(){return this.consume_(),this.parseGeometry_()}},{key:"parseGeometryLayout_",value:function(){var C=Ao,g=this.token_;if(this.isTokenType(Ns)){var x=g.value;x==="Z"?C=ta:x==="M"?C=Ri:x==="ZM"&&(C=Vi),C!==Ao&&this.consume_()}return C}},{key:"parseGeometryCollectionText_",value:function(){if(this.match(us)){var C=[];do C.push(this.parseGeometry_());while(this.match(Na));if(this.match(cs))return C}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePointText_",value:function(){if(this.match(us)){var C=this.parsePoint_();if(this.match(cs))return C}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())}},{key:"parseLineStringText_",value:function(){if(this.match(us)){var C=this.parsePointList_();if(this.match(cs))return C}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePolygonText_",value:function(){if(this.match(us)){var C=this.parseLineStringTextList_();if(this.match(cs))return C}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPointText_",value:function(){var C;if(this.match(us)){if(C=this.token_.type==us?this.parsePointTextList_():this.parsePointList_(),this.match(cs))return C}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiLineStringText_",value:function(){if(this.match(us)){var C=this.parseLineStringTextList_();if(this.match(cs))return C}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPolygonText_",value:function(){if(this.match(us)){var C=this.parsePolygonTextList_();if(this.match(cs))return C}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePoint_",value:function(){for(var C=[],g=this.layout_.length,x=0;x<g;++x){var O=this.token_;if(!this.match(Lh))break;C.push(O.value)}if(C.length==g)return C;throw new Error(this.formatErrorMessage_())}},{key:"parsePointList_",value:function(){for(var C=[this.parsePoint_()];this.match(Na);)C.push(this.parsePoint_());return C}},{key:"parsePointTextList_",value:function(){for(var C=[this.parsePointText_()];this.match(Na);)C.push(this.parsePointText_());return C}},{key:"parseLineStringTextList_",value:function(){for(var C=[this.parseLineStringText_()];this.match(Na);)C.push(this.parseLineStringText_());return C}},{key:"parsePolygonTextList_",value:function(){for(var C=[this.parsePolygonText_()];this.match(Na);)C.push(this.parsePolygonText_());return C}},{key:"isEmptyGeometry_",value:function(){var C=this.isTokenType(Ns)&&this.token_.value==rl;return C&&this.consume_(),C}},{key:"formatErrorMessage_",value:function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}},{key:"parseGeometry_",value:function(){var C=this.factory,g=function(xr){return b(Et,le(xr))},x=function(xr){var Jr=xr.map(function(Qr){return C.createLinearRing(Qr.map(g))});return Jr.length>1?C.createPolygon(Jr[0],Jr.slice(1)):C.createPolygon(Jr[0])},O=this.token_;if(this.match(Ns)){var $=O.value;if(this.layout_=this.parseGeometryLayout_(),$=="GEOMETRYCOLLECTION"){var te=this.parseGeometryCollectionText_();return C.createGeometryCollection(te)}switch($){case"POINT":var he=this.parsePointText_();return he?C.createPoint(b(Et,le(he))):C.createPoint();case"LINESTRING":var Te=this.parseLineStringText_().map(g);return C.createLineString(Te);case"LINEARRING":var Be=this.parseLineStringText_().map(g);return C.createLinearRing(Be);case"POLYGON":var et=this.parsePolygonText_();return et&&et.length!==0?x(et):C.createPolygon();case"MULTIPOINT":var Dt=this.parseMultiPointText_();if(!Dt||Dt.length===0)return C.createMultiPoint();var Ht=Dt.map(g).map(function(xr){return C.createPoint(xr)});return C.createMultiPoint(Ht);case"MULTILINESTRING":var bn=this.parseMultiLineStringText_().map(function(xr){return C.createLineString(xr.map(g))});return C.createMultiLineString(bn);case"MULTIPOLYGON":var Hn=this.parseMultiPolygonText_();if(!Hn||Hn.length===0)return C.createMultiPolygon();var sr=Hn.map(x);return C.createMultiPolygon(sr);default:throw new Error("Invalid geometry type: "+$)}}throw new Error(this.formatErrorMessage_())}}])}();function Wo(C){if(C.isEmpty())return"";var g=C.getCoordinate(),x=[g.x,g.y];return g.z===void 0||Number.isNaN(g.z)||x.push(g.z),g.m===void 0||Number.isNaN(g.m)||x.push(g.m),x.join(" ")}function Oo(C){for(var g=C.getCoordinates().map(function(te){var he=[te.x,te.y];return te.z===void 0||Number.isNaN(te.z)||he.push(te.z),te.m===void 0||Number.isNaN(te.m)||he.push(te.m),he}),x=[],O=0,$=g.length;O<$;++O)x.push(g[O].join(" "));return x.join(", ")}function il(C){var g=[];g.push("("+Oo(C.getExteriorRing())+")");for(var x=0,O=C.getNumInteriorRing();x<O;++x)g.push("("+Oo(C.getInteriorRingN(x))+")");return g.join(", ")}var Gf={Point:Wo,LineString:Oo,LinearRing:Oo,Polygon:il,MultiPoint:function(C){for(var g=[],x=0,O=C.getNumGeometries();x<O;++x)g.push("("+Wo(C.getGeometryN(x))+")");return g.join(", ")},MultiLineString:function(C){for(var g=[],x=0,O=C.getNumGeometries();x<O;++x)g.push("("+Oo(C.getGeometryN(x))+")");return g.join(", ")},MultiPolygon:function(C){for(var g=[],x=0,O=C.getNumGeometries();x<O;++x)g.push("("+il(C.getGeometryN(x))+")");return g.join(", ")},GeometryCollection:function(C){for(var g=[],x=0,O=C.getNumGeometries();x<O;++x)g.push(al(C.getGeometryN(x)));return g.join(", ")}};function al(C){var g=C.getGeometryType(),x=Gf[g];g=g.toUpperCase();var O=function($){var te="";if($.isEmpty())return te;var he=$.getCoordinate();return he.z===void 0||Number.isNaN(he.z)||(te+="Z"),he.m===void 0||Number.isNaN(he.m)||(te+="M"),te}(C);return O.length>0&&(g+=" "+O),C.isEmpty()?g+" "+rl:g+" ("+x(C)+")"}var Ol=function(){return i(function C(g){c(this,C),this.geometryFactory=g||new Pi,this.precisionModel=this.geometryFactory.getPrecisionModel()},[{key:"read",value:function(C){var g=new Bs(C);return new Mo(g,this.geometryFactory).parse()}},{key:"write",value:function(C){return al(C)}}])}(),nc=function(){return i(function C(g){c(this,C),this.parser=new Ol(g)},[{key:"write",value:function(C){return this.parser.write(C)}}],[{key:"toLineString",value:function(C,g){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+C.x+" "+C.y+", "+g.x+" "+g.y+" )"}}])}(),Hi=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"getIndexAlongSegment",value:function(g,x){return this.computeIntLineIndex(),this._intLineIndex[g][x]}},{key:"getTopologySummary",value:function(){var g=new Rn;return this.isEndPoint()&&g.append(" endpoint"),this._isProper&&g.append(" proper"),this.isCollinear()&&g.append(" collinear"),g.toString()}},{key:"computeIntersection",value:function(g,x,O,$){this._inputLines[0][0]=g,this._inputLines[0][1]=x,this._inputLines[1][0]=O,this._inputLines[1][1]=$,this._result=this.computeIntersect(g,x,O,$)}},{key:"getIntersectionNum",value:function(){return this._result}},{key:"computeIntLineIndex",value:function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var g=arguments[0];this.getEdgeDistance(g,0)>this.getEdgeDistance(g,1)?(this._intLineIndex[g][0]=0,this._intLineIndex[g][1]=1):(this._intLineIndex[g][0]=1,this._intLineIndex[g][1]=0)}}},{key:"isProper",value:function(){return this.hasIntersection()&&this._isProper}},{key:"setPrecisionModel",value:function(g){this._precisionModel=g}},{key:"isInteriorIntersection",value:function(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){for(var g=arguments[0],x=0;x<this._result;x++)if(!this._intPt[x].equals2D(this._inputLines[g][0])&&!this._intPt[x].equals2D(this._inputLines[g][1]))return!0;return!1}}},{key:"getIntersection",value:function(g){return this._intPt[g]}},{key:"isEndPoint",value:function(){return this.hasIntersection()&&!this._isProper}},{key:"hasIntersection",value:function(){return this._result!==C.NO_INTERSECTION}},{key:"getEdgeDistance",value:function(g,x){return C.computeEdgeDistance(this._intPt[x],this._inputLines[g][0],this._inputLines[g][1])}},{key:"isCollinear",value:function(){return this._result===C.COLLINEAR_INTERSECTION}},{key:"toString",value:function(){return nc.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+nc.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}},{key:"getEndpoint",value:function(g,x){return this._inputLines[g][x]}},{key:"isIntersection",value:function(g){for(var x=0;x<this._result;x++)if(this._intPt[x].equals2D(g))return!0;return!1}},{key:"getIntersectionAlongSegment",value:function(g,x){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[g][x]]}}],[{key:"constructor_",value:function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new Et,this._intPt[1]=new Et,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}},{key:"computeEdgeDistance",value:function(g,x,O){var $=Math.abs(O.x-x.x),te=Math.abs(O.y-x.y),he=-1;if(g.equals(x))he=0;else if(g.equals(O))he=$>te?$:te;else{var Te=Math.abs(g.x-x.x),Be=Math.abs(g.y-x.y);(he=$>te?Te:Be)!==0||g.equals(x)||(he=Math.max(Te,Be))}return cn.isTrue(!(he===0&&!g.equals(x)),"Bad distance calculation"),he}},{key:"nonRobustComputeEdgeDistance",value:function(g,x,O){var $=g.x-x.x,te=g.y-x.y,he=Math.sqrt($*$+te*te);return cn.isTrue(!(he===0&&!g.equals(x)),"Invalid distance calculation"),he}}])}();Hi.DONT_INTERSECT=0,Hi.DO_INTERSECT=1,Hi.COLLINEAR=2,Hi.NO_INTERSECTION=0,Hi.POINT_INTERSECTION=1,Hi.COLLINEAR_INTERSECTION=2;var Xa=function(C){function g(){return c(this,g),o(this,g)}return V(g,C),i(g,[{key:"isInSegmentEnvelopes",value:function(x){var O=new Ne(this._inputLines[0][0],this._inputLines[0][1]),$=new Ne(this._inputLines[1][0],this._inputLines[1][1]);return O.contains(x)&&$.contains(x)}},{key:"computeIntersection",value:function(){if(arguments.length!==3)return ie(g,"computeIntersection",this,1).apply(this,arguments);var x=arguments[0],O=arguments[1],$=arguments[2];if(this._isProper=!1,Ne.intersects(O,$,x)&&Rr.index(O,$,x)===0&&Rr.index($,O,x)===0)return this._isProper=!0,(x.equals(O)||x.equals($))&&(this._isProper=!1),this._result=Hi.POINT_INTERSECTION,null;this._result=Hi.NO_INTERSECTION}},{key:"intersection",value:function(x,O,$,te){var he=this.intersectionSafe(x,O,$,te);return this.isInSegmentEnvelopes(he)||(he=new Et(g.nearestEndpoint(x,O,$,te))),this._precisionModel!==null&&this._precisionModel.makePrecise(he),he}},{key:"checkDD",value:function(x,O,$,te,he){var Te=Ls.intersection(x,O,$,te),Be=this.isInSegmentEnvelopes(Te);_a.out.println("DD in env = "+Be+"  --------------------- "+Te),he.distance(Te)>1e-4&&_a.out.println("Distance = "+he.distance(Te))}},{key:"intersectionSafe",value:function(x,O,$,te){var he=lr.intersection(x,O,$,te);return he===null&&(he=g.nearestEndpoint(x,O,$,te)),he}},{key:"computeCollinearIntersection",value:function(x,O,$,te){var he=Ne.intersects(x,O,$),Te=Ne.intersects(x,O,te),Be=Ne.intersects($,te,x),et=Ne.intersects($,te,O);return he&&Te?(this._intPt[0]=$,this._intPt[1]=te,Hi.COLLINEAR_INTERSECTION):Be&&et?(this._intPt[0]=x,this._intPt[1]=O,Hi.COLLINEAR_INTERSECTION):he&&Be?(this._intPt[0]=$,this._intPt[1]=x,!$.equals(x)||Te||et?Hi.COLLINEAR_INTERSECTION:Hi.POINT_INTERSECTION):he&&et?(this._intPt[0]=$,this._intPt[1]=O,!$.equals(O)||Te||Be?Hi.COLLINEAR_INTERSECTION:Hi.POINT_INTERSECTION):Te&&Be?(this._intPt[0]=te,this._intPt[1]=x,!te.equals(x)||he||et?Hi.COLLINEAR_INTERSECTION:Hi.POINT_INTERSECTION):Te&&et?(this._intPt[0]=te,this._intPt[1]=O,!te.equals(O)||he||Be?Hi.COLLINEAR_INTERSECTION:Hi.POINT_INTERSECTION):Hi.NO_INTERSECTION}},{key:"computeIntersect",value:function(x,O,$,te){if(this._isProper=!1,!Ne.intersects(x,O,$,te))return Hi.NO_INTERSECTION;var he=Rr.index(x,O,$),Te=Rr.index(x,O,te);if(he>0&&Te>0||he<0&&Te<0)return Hi.NO_INTERSECTION;var Be=Rr.index($,te,x),et=Rr.index($,te,O);return Be>0&&et>0||Be<0&&et<0?Hi.NO_INTERSECTION:he===0&&Te===0&&Be===0&&et===0?this.computeCollinearIntersection(x,O,$,te):(he===0||Te===0||Be===0||et===0?(this._isProper=!1,x.equals2D($)||x.equals2D(te)?this._intPt[0]=x:O.equals2D($)||O.equals2D(te)?this._intPt[0]=O:he===0?this._intPt[0]=new Et($):Te===0?this._intPt[0]=new Et(te):Be===0?this._intPt[0]=new Et(x):et===0&&(this._intPt[0]=new Et(O))):(this._isProper=!0,this._intPt[0]=this.intersection(x,O,$,te)),Hi.POINT_INTERSECTION)}}],[{key:"nearestEndpoint",value:function(x,O,$,te){var he=x,Te=$i.pointToSegment(x,$,te),Be=$i.pointToSegment(O,$,te);return Be<Te&&(Te=Be,he=O),(Be=$i.pointToSegment($,x,O))<Te&&(Te=Be,he=$),(Be=$i.pointToSegment(te,x,O))<Te&&(Te=Be,he=te),he}}])}(Hi),Vr=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"countSegment",value:function(g,x){if(g.x<this._p.x&&x.x<this._p.x)return null;if(this._p.x===x.x&&this._p.y===x.y)return this._isPointOnSegment=!0,null;if(g.y===this._p.y&&x.y===this._p.y){var O=g.x,$=x.x;return O>$&&(O=x.x,$=g.x),this._p.x>=O&&this._p.x<=$&&(this._isPointOnSegment=!0),null}if(g.y>this._p.y&&x.y<=this._p.y||x.y>this._p.y&&g.y<=this._p.y){var te=Rr.index(g,x,this._p);if(te===Rr.COLLINEAR)return this._isPointOnSegment=!0,null;x.y<g.y&&(te=-te),te===Rr.LEFT&&this._crossingCount++}}},{key:"isPointInPolygon",value:function(){return this.getLocation()!==qe.EXTERIOR}},{key:"getLocation",value:function(){return this._isPointOnSegment?qe.BOUNDARY:this._crossingCount%2==1?qe.INTERIOR:qe.EXTERIOR}},{key:"isOnSegment",value:function(){return this._isPointOnSegment}}],[{key:"constructor_",value:function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var g=arguments[0];this._p=g}},{key:"locatePointInRing",value:function(){if(arguments[0]instanceof Et&&Mn(arguments[1],Kr)){for(var g=arguments[1],x=new C(arguments[0]),O=new Et,$=new Et,te=1;te<g.size();te++)if(g.getCoordinate(te,O),g.getCoordinate(te-1,$),x.countSegment(O,$),x.isOnSegment())return x.getLocation();return x.getLocation()}if(arguments[0]instanceof Et&&arguments[1]instanceof Array){for(var he=arguments[1],Te=new C(arguments[0]),Be=1;Be<he.length;Be++){var et=he[Be],Dt=he[Be-1];if(Te.countSegment(et,Dt),Te.isOnSegment())return Te.getLocation()}return Te.getLocation()}}}])}(),Mu=function(){function C(){c(this,C)}return i(C,null,[{key:"isOnLine",value:function(){if(arguments[0]instanceof Et&&Mn(arguments[1],Kr)){for(var g=arguments[0],x=arguments[1],O=new Xa,$=new Et,te=new Et,he=x.size(),Te=1;Te<he;Te++)if(x.getCoordinate(Te-1,$),x.getCoordinate(Te,te),O.computeIntersection(g,$,te),O.hasIntersection())return!0;return!1}if(arguments[0]instanceof Et&&arguments[1]instanceof Array){for(var Be=arguments[0],et=arguments[1],Dt=new Xa,Ht=1;Ht<et.length;Ht++){var bn=et[Ht-1],Hn=et[Ht];if(Dt.computeIntersection(Be,bn,Hn),Dt.hasIntersection())return!0}return!1}}},{key:"locateInRing",value:function(g,x){return Vr.locatePointInRing(g,x)}},{key:"isInRing",value:function(g,x){return C.locateInRing(g,x)!==qe.EXTERIOR}}])}(),Nn=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"setAllLocations",value:function(g){for(var x=0;x<this.location.length;x++)this.location[x]=g}},{key:"isNull",value:function(){for(var g=0;g<this.location.length;g++)if(this.location[g]!==qe.NONE)return!1;return!0}},{key:"setAllLocationsIfNull",value:function(g){for(var x=0;x<this.location.length;x++)this.location[x]===qe.NONE&&(this.location[x]=g)}},{key:"isLine",value:function(){return this.location.length===1}},{key:"merge",value:function(g){if(g.location.length>this.location.length){var x=new Array(3).fill(null);x[vn.ON]=this.location[vn.ON],x[vn.LEFT]=qe.NONE,x[vn.RIGHT]=qe.NONE,this.location=x}for(var O=0;O<this.location.length;O++)this.location[O]===qe.NONE&&O<g.location.length&&(this.location[O]=g.location[O])}},{key:"getLocations",value:function(){return this.location}},{key:"flip",value:function(){if(this.location.length<=1)return null;var g=this.location[vn.LEFT];this.location[vn.LEFT]=this.location[vn.RIGHT],this.location[vn.RIGHT]=g}},{key:"toString",value:function(){var g=new no;return this.location.length>1&&g.append(qe.toLocationSymbol(this.location[vn.LEFT])),g.append(qe.toLocationSymbol(this.location[vn.ON])),this.location.length>1&&g.append(qe.toLocationSymbol(this.location[vn.RIGHT])),g.toString()}},{key:"setLocations",value:function(g,x,O){this.location[vn.ON]=g,this.location[vn.LEFT]=x,this.location[vn.RIGHT]=O}},{key:"get",value:function(g){return g<this.location.length?this.location[g]:qe.NONE}},{key:"isArea",value:function(){return this.location.length>1}},{key:"isAnyNull",value:function(){for(var g=0;g<this.location.length;g++)if(this.location[g]===qe.NONE)return!0;return!1}},{key:"setLocation",value:function(){if(arguments.length===1){var g=arguments[0];this.setLocation(vn.ON,g)}else if(arguments.length===2){var x=arguments[0],O=arguments[1];this.location[x]=O}}},{key:"init",value:function(g){this.location=new Array(g).fill(null),this.setAllLocations(qe.NONE)}},{key:"isEqualOnSide",value:function(g,x){return this.location[x]===g.location[x]}},{key:"allPositionsEqual",value:function(g){for(var x=0;x<this.location.length;x++)if(this.location[x]!==g)return!1;return!0}}],[{key:"constructor_",value:function(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var g=arguments[0];this.init(g.length)}else if(Number.isInteger(arguments[0])){var x=arguments[0];this.init(1),this.location[vn.ON]=x}else if(arguments[0]instanceof C){var O=arguments[0];if(this.init(O.location.length),O!==null)for(var $=0;$<this.location.length;$++)this.location[$]=O.location[$]}}else if(arguments.length===3){var te=arguments[0],he=arguments[1],Te=arguments[2];this.init(3),this.location[vn.ON]=te,this.location[vn.LEFT]=he,this.location[vn.RIGHT]=Te}}}])}(),Ya=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"getGeometryCount",value:function(){var g=0;return this.elt[0].isNull()||g++,this.elt[1].isNull()||g++,g}},{key:"setAllLocations",value:function(g,x){this.elt[g].setAllLocations(x)}},{key:"isNull",value:function(g){return this.elt[g].isNull()}},{key:"setAllLocationsIfNull",value:function(){if(arguments.length===1){var g=arguments[0];this.setAllLocationsIfNull(0,g),this.setAllLocationsIfNull(1,g)}else if(arguments.length===2){var x=arguments[0],O=arguments[1];this.elt[x].setAllLocationsIfNull(O)}}},{key:"isLine",value:function(g){return this.elt[g].isLine()}},{key:"merge",value:function(g){for(var x=0;x<2;x++)this.elt[x]===null&&g.elt[x]!==null?this.elt[x]=new Nn(g.elt[x]):this.elt[x].merge(g.elt[x])}},{key:"flip",value:function(){this.elt[0].flip(),this.elt[1].flip()}},{key:"getLocation",value:function(){if(arguments.length===1){var g=arguments[0];return this.elt[g].get(vn.ON)}if(arguments.length===2){var x=arguments[0],O=arguments[1];return this.elt[x].get(O)}}},{key:"toString",value:function(){var g=new no;return this.elt[0]!==null&&(g.append("A:"),g.append(this.elt[0].toString())),this.elt[1]!==null&&(g.append(" B:"),g.append(this.elt[1].toString())),g.toString()}},{key:"isArea",value:function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var g=arguments[0];return this.elt[g].isArea()}}},{key:"isAnyNull",value:function(g){return this.elt[g].isAnyNull()}},{key:"setLocation",value:function(){if(arguments.length===2){var g=arguments[0],x=arguments[1];this.elt[g].setLocation(vn.ON,x)}else if(arguments.length===3){var O=arguments[0],$=arguments[1],te=arguments[2];this.elt[O].setLocation($,te)}}},{key:"isEqualOnSide",value:function(g,x){return this.elt[0].isEqualOnSide(g.elt[0],x)&&this.elt[1].isEqualOnSide(g.elt[1],x)}},{key:"allPositionsEqual",value:function(g,x){return this.elt[g].allPositionsEqual(x)}},{key:"toLine",value:function(g){this.elt[g].isArea()&&(this.elt[g]=new Nn(this.elt[g].location[0]))}}],[{key:"constructor_",value:function(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var g=arguments[0];this.elt[0]=new Nn(g),this.elt[1]=new Nn(g)}else if(arguments[0]instanceof C){var x=arguments[0];this.elt[0]=new Nn(x.elt[0]),this.elt[1]=new Nn(x.elt[1])}}else if(arguments.length===2){var O=arguments[0],$=arguments[1];this.elt[0]=new Nn(qe.NONE),this.elt[1]=new Nn(qe.NONE),this.elt[O].setLocation($)}else if(arguments.length===3){var te=arguments[0],he=arguments[1],Te=arguments[2];this.elt[0]=new Nn(te,he,Te),this.elt[1]=new Nn(te,he,Te)}else if(arguments.length===4){var Be=arguments[0],et=arguments[1],Dt=arguments[2],Ht=arguments[3];this.elt[0]=new Nn(qe.NONE,qe.NONE,qe.NONE),this.elt[1]=new Nn(qe.NONE,qe.NONE,qe.NONE),this.elt[Be].setLocations(et,Dt,Ht)}}},{key:"toLineLabel",value:function(g){for(var x=new C(qe.NONE),O=0;O<2;O++)x.setLocation(O,g.getLocation(O));return x}}])}(),fs=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"computeRing",value:function(){if(this._ring!==null)return null;for(var C=new Array(this._pts.size()).fill(null),g=0;g<this._pts.size();g++)C[g]=this._pts.get(g);this._ring=this._geometryFactory.createLinearRing(C),this._isHole=Rr.isCCW(this._ring.getCoordinates())}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"computePoints",value:function(C){this._startDe=C;var g=C,x=!0;do{if(g===null)throw new Ui("Found null DirectedEdge");if(g.getEdgeRing()===this)throw new Ui("Directed Edge visited twice during ring-building at "+g.getCoordinate());this._edges.add(g);var O=g.getLabel();cn.isTrue(O.isArea()),this.mergeLabel(O),this.addPoints(g.getEdge(),g.isForward(),x),x=!1,this.setEdgeRing(g,this),g=this.getNext(g)}while(g!==this._startDe)}},{key:"getLinearRing",value:function(){return this._ring}},{key:"getCoordinate",value:function(C){return this._pts.get(C)}},{key:"computeMaxNodeDegree",value:function(){this._maxNodeDegree=0;var C=this._startDe;do{var g=C.getNode().getEdges().getOutgoingDegree(this);g>this._maxNodeDegree&&(this._maxNodeDegree=g),C=this.getNext(C)}while(C!==this._startDe);this._maxNodeDegree*=2}},{key:"addPoints",value:function(C,g,x){var O=C.getCoordinates();if(g){var $=1;x&&($=0);for(var te=$;te<O.length;te++)this._pts.add(O[te])}else{var he=O.length-2;x&&(he=O.length-1);for(var Te=he;Te>=0;Te--)this._pts.add(O[Te])}}},{key:"isHole",value:function(){return this._isHole}},{key:"setInResult",value:function(){var C=this._startDe;do C.getEdge().setInResult(!0),C=C.getNext();while(C!==this._startDe)}},{key:"containsPoint",value:function(C){var g=this.getLinearRing();if(!g.getEnvelopeInternal().contains(C)||!Mu.isInRing(C,g.getCoordinates()))return!1;for(var x=this._holes.iterator();x.hasNext();)if(x.next().containsPoint(C))return!1;return!0}},{key:"addHole",value:function(C){this._holes.add(C)}},{key:"isShell",value:function(){return this._shell===null}},{key:"getLabel",value:function(){return this._label}},{key:"getEdges",value:function(){return this._edges}},{key:"getMaxNodeDegree",value:function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}},{key:"getShell",value:function(){return this._shell}},{key:"mergeLabel",value:function(){if(arguments.length===1){var C=arguments[0];this.mergeLabel(C,0),this.mergeLabel(C,1)}else if(arguments.length===2){var g=arguments[1],x=arguments[0].getLocation(g,vn.RIGHT);if(x===qe.NONE)return null;if(this._label.getLocation(g)===qe.NONE)return this._label.setLocation(g,x),null}}},{key:"setShell",value:function(C){this._shell=C,C!==null&&C.addHole(this)}},{key:"toPolygon",value:function(C){for(var g=new Array(this._holes.size()).fill(null),x=0;x<this._holes.size();x++)g[x]=this._holes.get(x).getLinearRing();return C.createPolygon(this.getLinearRing(),g)}}],[{key:"constructor_",value:function(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new Er,this._pts=new Er,this._label=new Ya(qe.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Er,this._geometryFactory=null,arguments.length!==0){if(arguments.length===2){var C=arguments[0],g=arguments[1];this._geometryFactory=g,this.computePoints(C),this.computeRing()}}}}])}(),Yc=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,[{key:"setEdgeRing",value:function(x,O){x.setMinEdgeRing(O)}},{key:"getNext",value:function(x){return x.getNextMin()}}],[{key:"constructor_",value:function(){var x=arguments[0],O=arguments[1];fs.constructor_.call(this,x,O)}}])}(fs),_r=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,[{key:"buildMinimalRings",value:function(){var x=new Er,O=this._startDe;do{if(O.getMinEdgeRing()===null){var $=new Yc(O,this._geometryFactory);x.add($)}O=O.getNext()}while(O!==this._startDe);return x}},{key:"setEdgeRing",value:function(x,O){x.setEdgeRing(O)}},{key:"linkDirectedEdgesForMinimalEdgeRings",value:function(){var x=this._startDe;do x.getNode().getEdges().linkMinimalDirectedEdges(this),x=x.getNext();while(x!==this._startDe)}},{key:"getNext",value:function(x){return x.getNext()}}],[{key:"constructor_",value:function(){var x=arguments[0],O=arguments[1];fs.constructor_.call(this,x,O)}}])}(fs),rc=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"setVisited",value:function(C){this._isVisited=C}},{key:"setInResult",value:function(C){this._isInResult=C}},{key:"isCovered",value:function(){return this._isCovered}},{key:"isCoveredSet",value:function(){return this._isCoveredSet}},{key:"setLabel",value:function(C){this._label=C}},{key:"getLabel",value:function(){return this._label}},{key:"setCovered",value:function(C){this._isCovered=C,this._isCoveredSet=!0}},{key:"updateIM",value:function(C){cn.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(C)}},{key:"isInResult",value:function(){return this._isInResult}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var C=arguments[0];this._label=C}}}}])}(),Lo=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,[{key:"isIncidentEdgeInResult",value:function(){for(var x=this.getEdges().getEdges().iterator();x.hasNext();)if(x.next().getEdge().isInResult())return!0;return!1}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"getCoordinate",value:function(){return this._coord}},{key:"print",value:function(x){x.println("node "+this._coord+" lbl: "+this._label)}},{key:"computeIM",value:function(x){}},{key:"computeMergedLocation",value:function(x,O){var $=qe.NONE;if($=this._label.getLocation(O),!x.isNull(O)){var te=x.getLocation(O);$!==qe.BOUNDARY&&($=te)}return $}},{key:"setLabel",value:function(){if(arguments.length!==2||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return ie(g,"setLabel",this,1).apply(this,arguments);var x=arguments[0],O=arguments[1];this._label===null?this._label=new Ya(x,O):this._label.setLocation(x,O)}},{key:"getEdges",value:function(){return this._edges}},{key:"mergeLabel",value:function(){if(arguments[0]instanceof g){var x=arguments[0];this.mergeLabel(x._label)}else if(arguments[0]instanceof Ya)for(var O=arguments[0],$=0;$<2;$++){var te=this.computeMergedLocation(O,$);this._label.getLocation($)===qe.NONE&&this._label.setLocation($,te)}}},{key:"add",value:function(x){this._edges.insert(x),x.setNode(this)}},{key:"setLabelBoundary",value:function(x){if(this._label===null)return null;var O=qe.NONE;this._label!==null&&(O=this._label.getLocation(x));var $=null;switch(O){case qe.BOUNDARY:$=qe.INTERIOR;break;case qe.INTERIOR:default:$=qe.BOUNDARY}this._label.setLocation(x,$)}}],[{key:"constructor_",value:function(){this._coord=null,this._edges=null;var x=arguments[0],O=arguments[1];this._coord=x,this._edges=O,this._label=new Ya(0,qe.NONE)}}])}(rc),kn=function(C){function g(){return c(this,g),o(this,g,arguments)}return V(g,C),i(g)}(yr);function qr(C){return C==null?0:C.color}function Vn(C){return C==null?null:C.parent}function zi(C,g){C!==null&&(C.color=g)}function zo(C){return C==null?null:C.left}function Br(C){return C==null?null:C.right}var ds=function(C){function g(){var x;return c(this,g),(x=o(this,g)).root_=null,x.size_=0,x}return V(g,C),i(g,[{key:"get",value:function(x){for(var O=this.root_;O!==null;){var $=x.compareTo(O.key);if($<0)O=O.left;else{if(!($>0))return O.value;O=O.right}}return null}},{key:"put",value:function(x,O){if(this.root_===null)return this.root_={key:x,value:O,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var $,te,he=this.root_;do if($=he,(te=x.compareTo(he.key))<0)he=he.left;else{if(!(te>0)){var Te=he.value;return he.value=O,Te}he=he.right}while(he!==null);var Be={key:x,left:null,right:null,value:O,parent:$,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return te<0?$.left=Be:$.right=Be,this.fixAfterInsertion(Be),this.size_++,null}},{key:"fixAfterInsertion",value:function(x){var O;for(x.color=1;x!=null&&x!==this.root_&&x.parent.color===1;)Vn(x)===zo(Vn(Vn(x)))?qr(O=Br(Vn(Vn(x))))===1?(zi(Vn(x),0),zi(O,0),zi(Vn(Vn(x)),1),x=Vn(Vn(x))):(x===Br(Vn(x))&&(x=Vn(x),this.rotateLeft(x)),zi(Vn(x),0),zi(Vn(Vn(x)),1),this.rotateRight(Vn(Vn(x)))):qr(O=zo(Vn(Vn(x))))===1?(zi(Vn(x),0),zi(O,0),zi(Vn(Vn(x)),1),x=Vn(Vn(x))):(x===zo(Vn(x))&&(x=Vn(x),this.rotateRight(x)),zi(Vn(x),0),zi(Vn(Vn(x)),1),this.rotateLeft(Vn(Vn(x))));this.root_.color=0}},{key:"values",value:function(){var x=new Er,O=this.getFirstEntry();if(O!==null)for(x.add(O.value);(O=g.successor(O))!==null;)x.add(O.value);return x}},{key:"entrySet",value:function(){var x=new Qi,O=this.getFirstEntry();if(O!==null)for(x.add(O);(O=g.successor(O))!==null;)x.add(O);return x}},{key:"rotateLeft",value:function(x){if(x!=null){var O=x.right;x.right=O.left,O.left!=null&&(O.left.parent=x),O.parent=x.parent,x.parent==null?this.root_=O:x.parent.left===x?x.parent.left=O:x.parent.right=O,O.left=x,x.parent=O}}},{key:"rotateRight",value:function(x){if(x!=null){var O=x.left;x.left=O.right,O.right!=null&&(O.right.parent=x),O.parent=x.parent,x.parent==null?this.root_=O:x.parent.right===x?x.parent.right=O:x.parent.left=O,O.right=x,x.parent=O}}},{key:"getFirstEntry",value:function(){var x=this.root_;if(x!=null)for(;x.left!=null;)x=x.left;return x}},{key:"size",value:function(){return this.size_}},{key:"containsKey",value:function(x){for(var O=this.root_;O!==null;){var $=x.compareTo(O.key);if($<0)O=O.left;else{if(!($>0))return!0;O=O.right}}return!1}}],[{key:"successor",value:function(x){var O;if(x===null)return null;if(x.right!==null){for(O=x.right;O.left!==null;)O=O.left;return O}O=x.parent;for(var $=x;O!==null&&$===O.right;)$=O,O=O.parent;return O}}])}(kn),No=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"find",value:function(C){return this.nodeMap.get(C)}},{key:"addNode",value:function(){if(arguments[0]instanceof Et){var C=arguments[0],g=this.nodeMap.get(C);return g===null&&(g=this.nodeFact.createNode(C),this.nodeMap.put(C,g)),g}if(arguments[0]instanceof Lo){var x=arguments[0],O=this.nodeMap.get(x.getCoordinate());return O===null?(this.nodeMap.put(x.getCoordinate(),x),x):(O.mergeLabel(x),O)}}},{key:"print",value:function(C){for(var g=this.iterator();g.hasNext();)g.next().print(C)}},{key:"iterator",value:function(){return this.nodeMap.values().iterator()}},{key:"values",value:function(){return this.nodeMap.values()}},{key:"getBoundaryNodes",value:function(C){for(var g=new Er,x=this.iterator();x.hasNext();){var O=x.next();O.getLabel().getLocation(C)===qe.BOUNDARY&&g.add(O)}return g}},{key:"add",value:function(C){var g=C.getCoordinate();this.addNode(g).add(C)}}],[{key:"constructor_",value:function(){this.nodeMap=new ds,this.nodeFact=null;var C=arguments[0];this.nodeFact=C}}])}(),Ta=function(){function C(){c(this,C)}return i(C,null,[{key:"isNorthern",value:function(g){return g===C.NE||g===C.NW}},{key:"isOpposite",value:function(g,x){return g!==x&&(g-x+4)%4===2}},{key:"commonHalfPlane",value:function(g,x){if(g===x)return g;if((g-x+4)%4===2)return-1;var O=g<x?g:x;return O===0&&(g>x?g:x)===3?3:O}},{key:"isInHalfPlane",value:function(g,x){return x===C.SE?g===C.SE||g===C.SW:g===x||g===x+1}},{key:"quadrant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var g=arguments[0],x=arguments[1];if(g===0&&x===0)throw new me("Cannot compute the quadrant for point ( "+g+", "+x+" )");return g>=0?x>=0?C.NE:C.SE:x>=0?C.NW:C.SW}if(arguments[0]instanceof Et&&arguments[1]instanceof Et){var O=arguments[0],$=arguments[1];if($.x===O.x&&$.y===O.y)throw new me("Cannot compute the quadrant for two identical points "+O);return $.x>=O.x?$.y>=O.y?C.NE:C.SE:$.y>=O.y?C.NW:C.SW}}}])}();Ta.NE=0,Ta.NW=1,Ta.SW=2,Ta.SE=3;var di=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"compareDirection",value:function(g){return this._dx===g._dx&&this._dy===g._dy?0:this._quadrant>g._quadrant?1:this._quadrant<g._quadrant?-1:Rr.index(g._p0,g._p1,this._p1)}},{key:"getDy",value:function(){return this._dy}},{key:"getCoordinate",value:function(){return this._p0}},{key:"setNode",value:function(g){this._node=g}},{key:"print",value:function(g){var x=Math.atan2(this._dy,this._dx),O=this.getClass().getName(),$=O.lastIndexOf("."),te=O.substring($+1);g.print("  "+te+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+x+"   "+this._label)}},{key:"compareTo",value:function(g){var x=g;return this.compareDirection(x)}},{key:"getDirectedCoordinate",value:function(){return this._p1}},{key:"getDx",value:function(){return this._dx}},{key:"getLabel",value:function(){return this._label}},{key:"getEdge",value:function(){return this._edge}},{key:"getQuadrant",value:function(){return this._quadrant}},{key:"getNode",value:function(){return this._node}},{key:"toString",value:function(){var g=Math.atan2(this._dy,this._dx),x=this.getClass().getName(),O=x.lastIndexOf(".");return"  "+x.substring(O+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+g+"   "+this._label}},{key:"computeLabel",value:function(g){}},{key:"init",value:function(g,x){this._p0=g,this._p1=x,this._dx=x.x-g.x,this._dy=x.y-g.y,this._quadrant=Ta.quadrant(this._dx,this._dy),cn.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")}},{key:"interfaces_",get:function(){return[Oe]}}],[{key:"constructor_",value:function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var g=arguments[0];this._edge=g}else if(arguments.length===3){var x=arguments[0],O=arguments[1],$=arguments[2];C.constructor_.call(this,x,O,$,null)}else if(arguments.length===4){var te=arguments[0],he=arguments[1],Te=arguments[2],Be=arguments[3];C.constructor_.call(this,te),this.init(he,Te),this._label=Be}}}])}(),ui=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,[{key:"getNextMin",value:function(){return this._nextMin}},{key:"getDepth",value:function(x){return this._depth[x]}},{key:"setVisited",value:function(x){this._isVisited=x}},{key:"computeDirectedLabel",value:function(){this._label=new Ya(this._edge.getLabel()),this._isForward||this._label.flip()}},{key:"getNext",value:function(){return this._next}},{key:"setDepth",value:function(x,O){if(this._depth[x]!==-999&&this._depth[x]!==O)throw new Ui("assigned depths do not match",this.getCoordinate());this._depth[x]=O}},{key:"isInteriorAreaEdge",value:function(){for(var x=!0,O=0;O<2;O++)this._label.isArea(O)&&this._label.getLocation(O,vn.LEFT)===qe.INTERIOR&&this._label.getLocation(O,vn.RIGHT)===qe.INTERIOR||(x=!1);return x}},{key:"setNextMin",value:function(x){this._nextMin=x}},{key:"print",value:function(x){ie(g,"print",this,1).call(this,x),x.print(" "+this._depth[vn.LEFT]+"/"+this._depth[vn.RIGHT]),x.print(" ("+this.getDepthDelta()+")"),this._isInResult&&x.print(" inResult")}},{key:"setMinEdgeRing",value:function(x){this._minEdgeRing=x}},{key:"isLineEdge",value:function(){var x=this._label.isLine(0)||this._label.isLine(1),O=!this._label.isArea(0)||this._label.allPositionsEqual(0,qe.EXTERIOR),$=!this._label.isArea(1)||this._label.allPositionsEqual(1,qe.EXTERIOR);return x&&O&&$}},{key:"setEdgeRing",value:function(x){this._edgeRing=x}},{key:"getMinEdgeRing",value:function(){return this._minEdgeRing}},{key:"getDepthDelta",value:function(){var x=this._edge.getDepthDelta();return this._isForward||(x=-x),x}},{key:"setInResult",value:function(x){this._isInResult=x}},{key:"getSym",value:function(){return this._sym}},{key:"isForward",value:function(){return this._isForward}},{key:"getEdge",value:function(){return this._edge}},{key:"printEdge",value:function(x){this.print(x),x.print(" "),this._isForward?this._edge.print(x):this._edge.printReverse(x)}},{key:"setSym",value:function(x){this._sym=x}},{key:"setVisitedEdge",value:function(x){this.setVisited(x),this._sym.setVisited(x)}},{key:"setEdgeDepths",value:function(x,O){var $=this.getEdge().getDepthDelta();this._isForward||($=-$);var te=1;x===vn.LEFT&&(te=-1);var he=vn.opposite(x),Te=O+$*te;this.setDepth(x,O),this.setDepth(he,Te)}},{key:"getEdgeRing",value:function(){return this._edgeRing}},{key:"isInResult",value:function(){return this._isInResult}},{key:"setNext",value:function(x){this._next=x}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];var x=arguments[0],O=arguments[1];if(di.constructor_.call(this,x),this._isForward=O,O)this.init(x.getCoordinate(0),x.getCoordinate(1));else{var $=x.getNumPoints()-1;this.init(x.getCoordinate($),x.getCoordinate($-1))}this.computeDirectedLabel()}},{key:"depthFactor",value:function(x,O){return x===qe.EXTERIOR&&O===qe.INTERIOR?1:x===qe.INTERIOR&&O===qe.EXTERIOR?-1:0}}])}(di),Ou=function(){return i(function C(){c(this,C)},[{key:"createNode",value:function(C){return new Lo(C,null)}}])}(),Ea=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"printEdges",value:function(C){C.println("Edges:");for(var g=0;g<this._edges.size();g++){C.println("edge "+g+":");var x=this._edges.get(g);x.print(C),x.eiList.print(C)}}},{key:"find",value:function(C){return this._nodes.find(C)}},{key:"addNode",value:function(){if(arguments[0]instanceof Lo){var C=arguments[0];return this._nodes.addNode(C)}if(arguments[0]instanceof Et){var g=arguments[0];return this._nodes.addNode(g)}}},{key:"getNodeIterator",value:function(){return this._nodes.iterator()}},{key:"linkResultDirectedEdges",value:function(){for(var C=this._nodes.iterator();C.hasNext();)C.next().getEdges().linkResultDirectedEdges()}},{key:"debugPrintln",value:function(C){_a.out.println(C)}},{key:"isBoundaryNode",value:function(C,g){var x=this._nodes.find(g);if(x===null)return!1;var O=x.getLabel();return O!==null&&O.getLocation(C)===qe.BOUNDARY}},{key:"linkAllDirectedEdges",value:function(){for(var C=this._nodes.iterator();C.hasNext();)C.next().getEdges().linkAllDirectedEdges()}},{key:"matchInSameDirection",value:function(C,g,x,O){return!!C.equals(x)&&Rr.index(C,g,O)===Rr.COLLINEAR&&Ta.quadrant(C,g)===Ta.quadrant(x,O)}},{key:"getEdgeEnds",value:function(){return this._edgeEndList}},{key:"debugPrint",value:function(C){_a.out.print(C)}},{key:"getEdgeIterator",value:function(){return this._edges.iterator()}},{key:"findEdgeInSameDirection",value:function(C,g){for(var x=0;x<this._edges.size();x++){var O=this._edges.get(x),$=O.getCoordinates();if(this.matchInSameDirection(C,g,$[0],$[1])||this.matchInSameDirection(C,g,$[$.length-1],$[$.length-2]))return O}return null}},{key:"insertEdge",value:function(C){this._edges.add(C)}},{key:"findEdgeEnd",value:function(C){for(var g=this.getEdgeEnds().iterator();g.hasNext();){var x=g.next();if(x.getEdge()===C)return x}return null}},{key:"addEdges",value:function(C){for(var g=C.iterator();g.hasNext();){var x=g.next();this._edges.add(x);var O=new ui(x,!0),$=new ui(x,!1);O.setSym($),$.setSym(O),this.add(O),this.add($)}}},{key:"add",value:function(C){this._nodes.add(C),this._edgeEndList.add(C)}},{key:"getNodes",value:function(){return this._nodes.values()}},{key:"findEdge",value:function(C,g){for(var x=0;x<this._edges.size();x++){var O=this._edges.get(x),$=O.getCoordinates();if(C.equals($[0])&&g.equals($[1]))return O}return null}}],[{key:"constructor_",value:function(){if(this._edges=new Er,this._nodes=null,this._edgeEndList=new Er,arguments.length===0)this._nodes=new No(new Ou);else if(arguments.length===1){var C=arguments[0];this._nodes=new No(C)}}},{key:"linkResultDirectedEdges",value:function(C){for(var g=C.iterator();g.hasNext();)g.next().getEdges().linkResultDirectedEdges()}}])}(),zh=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"sortShellsAndHoles",value:function(g,x,O){for(var $=g.iterator();$.hasNext();){var te=$.next();te.isHole()?O.add(te):x.add(te)}}},{key:"computePolygons",value:function(g){for(var x=new Er,O=g.iterator();O.hasNext();){var $=O.next().toPolygon(this._geometryFactory);x.add($)}return x}},{key:"placeFreeHoles",value:function(g,x){for(var O=x.iterator();O.hasNext();){var $=O.next();if($.getShell()===null){var te=C.findEdgeRingContaining($,g);if(te===null)throw new Ui("unable to assign hole to a shell",$.getCoordinate(0));$.setShell(te)}}}},{key:"buildMinimalEdgeRings",value:function(g,x,O){for(var $=new Er,te=g.iterator();te.hasNext();){var he=te.next();if(he.getMaxNodeDegree()>2){he.linkDirectedEdgesForMinimalEdgeRings();var Te=he.buildMinimalRings(),Be=this.findShell(Te);Be!==null?(this.placePolygonHoles(Be,Te),x.add(Be)):O.addAll(Te)}else $.add(he)}return $}},{key:"buildMaximalEdgeRings",value:function(g){for(var x=new Er,O=g.iterator();O.hasNext();){var $=O.next();if($.isInResult()&&$.getLabel().isArea()&&$.getEdgeRing()===null){var te=new _r($,this._geometryFactory);x.add(te),te.setInResult()}}return x}},{key:"placePolygonHoles",value:function(g,x){for(var O=x.iterator();O.hasNext();){var $=O.next();$.isHole()&&$.setShell(g)}}},{key:"getPolygons",value:function(){return this.computePolygons(this._shellList)}},{key:"findShell",value:function(g){for(var x=0,O=null,$=g.iterator();$.hasNext();){var te=$.next();te.isHole()||(O=te,x++)}return cn.isTrue(x<=1,"found two shells in MinimalEdgeRing list"),O}},{key:"add",value:function(){if(arguments.length===1){var g=arguments[0];this.add(g.getEdgeEnds(),g.getNodes())}else if(arguments.length===2){var x=arguments[0],O=arguments[1];Ea.linkResultDirectedEdges(O);var $=this.buildMaximalEdgeRings(x),te=new Er,he=this.buildMinimalEdgeRings($,this._shellList,te);this.sortShellsAndHoles(he,this._shellList,te),this.placeFreeHoles(this._shellList,te)}}}],[{key:"constructor_",value:function(){this._geometryFactory=null,this._shellList=new Er;var g=arguments[0];this._geometryFactory=g}},{key:"findEdgeRingContaining",value:function(g,x){for(var O=g.getLinearRing(),$=O.getEnvelopeInternal(),te=O.getCoordinateN(0),he=null,Te=null,Be=x.iterator();Be.hasNext();){var et=Be.next(),Dt=et.getLinearRing(),Ht=Dt.getEnvelopeInternal();if(!Ht.equals($)&&Ht.contains($)){te=Ct.ptNotInList(O.getCoordinates(),Dt.getCoordinates());var bn=!1;Mu.isInRing(te,Dt.getCoordinates())&&(bn=!0),bn&&(he===null||Te.contains(Ht))&&(Te=(he=et).getLinearRing().getEnvelopeInternal())}}return he}}])}(),Ql=function(){return i(function C(){c(this,C)},[{key:"getBounds",value:function(){}}])}(),Bo=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"getItem",value:function(){return this._item}},{key:"getBounds",value:function(){return this._bounds}},{key:"interfaces_",get:function(){return[Ql,He]}}],[{key:"constructor_",value:function(){this._bounds=null,this._item=null;var C=arguments[0],g=arguments[1];this._bounds=C,this._item=g}}])}(),ps=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"poll",value:function(){if(this.isEmpty())return null;var C=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),C}},{key:"size",value:function(){return this._size}},{key:"reorder",value:function(C){for(var g=null,x=this._items.get(C);2*C<=this._size&&((g=2*C)!==this._size&&this._items.get(g+1).compareTo(this._items.get(g))<0&&g++,this._items.get(g).compareTo(x)<0);C=g)this._items.set(C,this._items.get(g));this._items.set(C,x)}},{key:"clear",value:function(){this._size=0,this._items.clear()}},{key:"peek",value:function(){return this.isEmpty()?null:this._items.get(1)}},{key:"isEmpty",value:function(){return this._size===0}},{key:"add",value:function(C){this._items.add(null),this._size+=1;var g=this._size;for(this._items.set(0,C);C.compareTo(this._items.get(Math.trunc(g/2)))<0;g/=2)this._items.set(g,this._items.get(Math.trunc(g/2)));this._items.set(g,C)}}],[{key:"constructor_",value:function(){this._size=null,this._items=null,this._size=0,this._items=new Er,this._items.add(null)}}])}(),Aa=function(){return i(function C(){c(this,C)},[{key:"insert",value:function(C,g){}},{key:"remove",value:function(C,g){}},{key:"query",value:function(){}}])}(),da=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"getLevel",value:function(){return this._level}},{key:"size",value:function(){return this._childBoundables.size()}},{key:"getChildBoundables",value:function(){return this._childBoundables}},{key:"addChildBoundable",value:function(C){cn.isTrue(this._bounds===null),this._childBoundables.add(C)}},{key:"isEmpty",value:function(){return this._childBoundables.isEmpty()}},{key:"getBounds",value:function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds}},{key:"interfaces_",get:function(){return[Ql,He]}}],[{key:"constructor_",value:function(){if(this._childBoundables=new Er,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var C=arguments[0];this._level=C}}}}])}(),la={reverseOrder:function(){return{compare:function(C,g){return g.compareTo(C)}}},min:function(C){return la.sort(C),C.get(0)},sort:function(C,g){var x=C.toArray();g?ea.sort(x,g):ea.sort(x);for(var O=C.iterator(),$=0,te=x.length;$<te;$++)O.next(),O.set(x[$])},singletonList:function(C){var g=new Er;return g.add(C),g}},$f=function(){function C(){c(this,C)}return i(C,null,[{key:"maxDistance",value:function(g,x,O,$,te,he,Te,Be){var et=C.distance(g,x,te,he);return et=Math.max(et,C.distance(g,x,Te,Be)),et=Math.max(et,C.distance(O,$,te,he)),et=Math.max(et,C.distance(O,$,Te,Be))}},{key:"distance",value:function(g,x,O,$){var te=O-g,he=$-x;return Math.sqrt(te*te+he*he)}},{key:"maximumDistance",value:function(g,x){var O=Math.min(g.getMinX(),x.getMinX()),$=Math.min(g.getMinY(),x.getMinY()),te=Math.max(g.getMaxX(),x.getMaxX()),he=Math.max(g.getMaxY(),x.getMaxY());return C.distance(O,$,te,he)}},{key:"minMaxDistance",value:function(g,x){var O=g.getMinX(),$=g.getMinY(),te=g.getMaxX(),he=g.getMaxY(),Te=x.getMinX(),Be=x.getMinY(),et=x.getMaxX(),Dt=x.getMaxY(),Ht=C.maxDistance(O,$,O,he,Te,Be,Te,Dt);return Ht=Math.min(Ht,C.maxDistance(O,$,O,he,Te,Be,et,Be)),Ht=Math.min(Ht,C.maxDistance(O,$,O,he,et,Dt,Te,Dt)),Ht=Math.min(Ht,C.maxDistance(O,$,O,he,et,Dt,et,Be)),Ht=Math.min(Ht,C.maxDistance(O,$,te,$,Te,Be,Te,Dt)),Ht=Math.min(Ht,C.maxDistance(O,$,te,$,Te,Be,et,Be)),Ht=Math.min(Ht,C.maxDistance(O,$,te,$,et,Dt,Te,Dt)),Ht=Math.min(Ht,C.maxDistance(O,$,te,$,et,Dt,et,Be)),Ht=Math.min(Ht,C.maxDistance(te,he,O,he,Te,Be,Te,Dt)),Ht=Math.min(Ht,C.maxDistance(te,he,O,he,Te,Be,et,Be)),Ht=Math.min(Ht,C.maxDistance(te,he,O,he,et,Dt,Te,Dt)),Ht=Math.min(Ht,C.maxDistance(te,he,O,he,et,Dt,et,Be)),Ht=Math.min(Ht,C.maxDistance(te,he,te,$,Te,Be,Te,Dt)),Ht=Math.min(Ht,C.maxDistance(te,he,te,$,Te,Be,et,Be)),Ht=Math.min(Ht,C.maxDistance(te,he,te,$,et,Dt,Te,Dt)),Ht=Math.min(Ht,C.maxDistance(te,he,te,$,et,Dt,et,Be))}}])}(),Fo=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"maximumDistance",value:function(){return $f.maximumDistance(this._boundable1.getBounds(),this._boundable2.getBounds())}},{key:"expandToQueue",value:function(g,x){var O=C.isComposite(this._boundable1),$=C.isComposite(this._boundable2);if(O&&$)return C.area(this._boundable1)>C.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,!1,g,x),null):(this.expand(this._boundable2,this._boundable1,!0,g,x),null);if(O)return this.expand(this._boundable1,this._boundable2,!1,g,x),null;if($)return this.expand(this._boundable2,this._boundable1,!0,g,x),null;throw new me("neither boundable is composite")}},{key:"isLeaves",value:function(){return!(C.isComposite(this._boundable1)||C.isComposite(this._boundable2))}},{key:"compareTo",value:function(g){var x=g;return this._distance<x._distance?-1:this._distance>x._distance?1:0}},{key:"expand",value:function(g,x,O,$,te){for(var he=g.getChildBoundables().iterator();he.hasNext();){var Te=he.next(),Be=null;(Be=O?new C(x,Te,this._itemDistance):new C(Te,x,this._itemDistance)).getDistance()<te&&$.add(Be)}}},{key:"getBoundable",value:function(g){return g===0?this._boundable1:this._boundable2}},{key:"getDistance",value:function(){return this._distance}},{key:"distance",value:function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}},{key:"interfaces_",get:function(){return[Oe]}}],[{key:"constructor_",value:function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var g=arguments[0],x=arguments[1],O=arguments[2];this._boundable1=g,this._boundable2=x,this._itemDistance=O,this._distance=this.distance()}},{key:"area",value:function(g){return g.getBounds().getArea()}},{key:"isComposite",value:function(g){return g instanceof da}}])}(),Oi=function(){return i(function C(){c(this,C)},[{key:"visitItem",value:function(C){}}])}(),ro=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"queryInternal",value:function(){if(Mn(arguments[2],Oi)&&arguments[0]instanceof Object&&arguments[1]instanceof da)for(var g=arguments[0],x=arguments[2],O=arguments[1].getChildBoundables(),$=0;$<O.size();$++){var te=O.get($);this.getIntersectsOp().intersects(te.getBounds(),g)&&(te instanceof da?this.queryInternal(g,te,x):te instanceof Bo?x.visitItem(te.getItem()):cn.shouldNeverReachHere())}else if(Mn(arguments[2],ya)&&arguments[0]instanceof Object&&arguments[1]instanceof da)for(var he=arguments[0],Te=arguments[2],Be=arguments[1].getChildBoundables(),et=0;et<Be.size();et++){var Dt=Be.get(et);this.getIntersectsOp().intersects(Dt.getBounds(),he)&&(Dt instanceof da?this.queryInternal(he,Dt,Te):Dt instanceof Bo?Te.add(Dt.getItem()):cn.shouldNeverReachHere())}}},{key:"getNodeCapacity",value:function(){return this._nodeCapacity}},{key:"lastNode",value:function(g){return g.get(g.size()-1)}},{key:"size",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var g=0,x=arguments[0].getChildBoundables().iterator();x.hasNext();){var O=x.next();O instanceof da?g+=this.size(O):O instanceof Bo&&(g+=1)}return g}}},{key:"removeItem",value:function(g,x){for(var O=null,$=g.getChildBoundables().iterator();$.hasNext();){var te=$.next();te instanceof Bo&&te.getItem()===x&&(O=te)}return O!==null&&(g.getChildBoundables().remove(O),!0)}},{key:"itemsTree",value:function(){if(arguments.length===0){this.build();var g=this.itemsTree(this._root);return g===null?new Er:g}if(arguments.length===1){for(var x=arguments[0],O=new Er,$=x.getChildBoundables().iterator();$.hasNext();){var te=$.next();if(te instanceof da){var he=this.itemsTree(te);he!==null&&O.add(he)}else te instanceof Bo?O.add(te.getItem()):cn.shouldNeverReachHere()}return O.size()<=0?null:O}}},{key:"insert",value:function(g,x){cn.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Bo(g,x))}},{key:"boundablesAtLevel",value:function(){if(arguments.length===1){var g=arguments[0],x=new Er;return this.boundablesAtLevel(g,this._root,x),x}if(arguments.length===3){var O=arguments[0],$=arguments[1],te=arguments[2];if(cn.isTrue(O>-2),$.getLevel()===O)return te.add($),null;for(var he=$.getChildBoundables().iterator();he.hasNext();){var Te=he.next();Te instanceof da?this.boundablesAtLevel(O,Te,te):(cn.isTrue(Te instanceof Bo),O===-1&&te.add(Te))}return null}}},{key:"query",value:function(){if(arguments.length===1){var g=arguments[0];this.build();var x=new Er;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),g)&&this.queryInternal(g,this._root,x),x}if(arguments.length===2){var O=arguments[0],$=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),O)&&this.queryInternal(O,this._root,$)}}},{key:"build",value:function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}},{key:"getRoot",value:function(){return this.build(),this._root}},{key:"remove",value:function(){if(arguments.length===2){var g=arguments[0],x=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),g)&&this.remove(g,this._root,x)}if(arguments.length===3){var O=arguments[0],$=arguments[1],te=arguments[2],he=this.removeItem($,te);if(he)return!0;for(var Te=null,Be=$.getChildBoundables().iterator();Be.hasNext();){var et=Be.next();if(this.getIntersectsOp().intersects(et.getBounds(),O)&&et instanceof da&&(he=this.remove(O,et,te))){Te=et;break}}return Te!==null&&Te.getChildBoundables().isEmpty()&&$.getChildBoundables().remove(Te),he}}},{key:"createHigherLevels",value:function(g,x){cn.isTrue(!g.isEmpty());var O=this.createParentBoundables(g,x+1);return O.size()===1?O.get(0):this.createHigherLevels(O,x+1)}},{key:"depth",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var g=0,x=arguments[0].getChildBoundables().iterator();x.hasNext();){var O=x.next();if(O instanceof da){var $=this.depth(O);$>g&&(g=$)}}return g+1}}},{key:"createParentBoundables",value:function(g,x){cn.isTrue(!g.isEmpty());var O=new Er;O.add(this.createNode(x));var $=new Er(g);la.sort($,this.getComparator());for(var te=$.iterator();te.hasNext();){var he=te.next();this.lastNode(O).getChildBoundables().size()===this.getNodeCapacity()&&O.add(this.createNode(x)),this.lastNode(O).addChildBoundable(he)}return O}},{key:"isEmpty",value:function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}},{key:"interfaces_",get:function(){return[He]}}],[{key:"constructor_",value:function(){if(this._root=null,this._built=!1,this._itemBoundables=new Er,this._nodeCapacity=null,arguments.length===0)C.constructor_.call(this,C.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var g=arguments[0];cn.isTrue(g>1,"Node capacity must be greater than 1"),this._nodeCapacity=g}}},{key:"compareDoubles",value:function(g,x){return g>x?1:g<x?-1:0}}])}();ro.IntersectsOp=function(){},ro.DEFAULT_NODE_CAPACITY=10;var Ba=function(){return i(function C(){c(this,C)},[{key:"distance",value:function(C,g){}}])}(),pi=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,[{key:"createParentBoundablesFromVerticalSlices",value:function(x,O){cn.isTrue(x.length>0);for(var $=new Er,te=0;te<x.length;te++)$.addAll(this.createParentBoundablesFromVerticalSlice(x[te],O));return $}},{key:"nearestNeighbourK",value:function(){if(arguments.length===2){var x=arguments[0],O=arguments[1];return this.nearestNeighbourK(x,Ze.POSITIVE_INFINITY,O)}if(arguments.length===3){var $=arguments[0],te=arguments[2],he=arguments[1],Te=new ps;Te.add($);for(var Be=new ps;!Te.isEmpty()&&he>=0;){var et=Te.poll(),Dt=et.getDistance();if(Dt>=he)break;et.isLeaves()?Be.size()<te?Be.add(et):(Be.peek().getDistance()>Dt&&(Be.poll(),Be.add(et)),he=Be.peek().getDistance()):et.expandToQueue(Te,he)}return g.getItems(Be)}}},{key:"createNode",value:function(x){return new ic(x)}},{key:"size",value:function(){return arguments.length===0?ie(g,"size",this,1).call(this):ie(g,"size",this,1).apply(this,arguments)}},{key:"insert",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof Ne))return ie(g,"insert",this,1).apply(this,arguments);var x=arguments[0],O=arguments[1];if(x.isNull())return null;ie(g,"insert",this,1).call(this,x,O)}},{key:"getIntersectsOp",value:function(){return g.intersectsOp}},{key:"verticalSlices",value:function(x,O){for(var $=Math.trunc(Math.ceil(x.size()/O)),te=new Array(O).fill(null),he=x.iterator(),Te=0;Te<O;Te++){te[Te]=new Er;for(var Be=0;he.hasNext()&&Be<$;){var et=he.next();te[Te].add(et),Be++}}return te}},{key:"query",value:function(){if(arguments.length===1){var x=arguments[0];return ie(g,"query",this,1).call(this,x)}if(arguments.length===2){var O=arguments[0],$=arguments[1];ie(g,"query",this,1).call(this,O,$)}}},{key:"getComparator",value:function(){return g.yComparator}},{key:"createParentBoundablesFromVerticalSlice",value:function(x,O){return ie(g,"createParentBoundables",this,1).call(this,x,O)}},{key:"remove",value:function(){if(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof Ne){var x=arguments[0],O=arguments[1];return ie(g,"remove",this,1).call(this,x,O)}return ie(g,"remove",this,1).apply(this,arguments)}},{key:"depth",value:function(){return arguments.length===0?ie(g,"depth",this,1).call(this):ie(g,"depth",this,1).apply(this,arguments)}},{key:"createParentBoundables",value:function(x,O){cn.isTrue(!x.isEmpty());var $=Math.trunc(Math.ceil(x.size()/this.getNodeCapacity())),te=new Er(x);la.sort(te,g.xComparator);var he=this.verticalSlices(te,Math.trunc(Math.ceil(Math.sqrt($))));return this.createParentBoundablesFromVerticalSlices(he,O)}},{key:"nearestNeighbour",value:function(){if(arguments.length===1){if(Mn(arguments[0],Ba)){var x=arguments[0];if(this.isEmpty())return null;var O=new Fo(this.getRoot(),this.getRoot(),x);return this.nearestNeighbour(O)}if(arguments[0]instanceof Fo){var $=arguments[0],te=Ze.POSITIVE_INFINITY,he=null,Te=new ps;for(Te.add($);!Te.isEmpty()&&te>0;){var Be=Te.poll(),et=Be.getDistance();if(et>=te)break;Be.isLeaves()?(te=et,he=Be):Be.expandToQueue(Te,te)}return he===null?null:[he.getBoundable(0).getItem(),he.getBoundable(1).getItem()]}}else{if(arguments.length===2){var Dt=arguments[0],Ht=arguments[1];if(this.isEmpty()||Dt.isEmpty())return null;var bn=new Fo(this.getRoot(),Dt.getRoot(),Ht);return this.nearestNeighbour(bn)}if(arguments.length===3){var Hn=arguments[2],sr=new Bo(arguments[0],arguments[1]),xr=new Fo(this.getRoot(),sr,Hn);return this.nearestNeighbour(xr)[0]}if(arguments.length===4){var Jr=arguments[2],Qr=arguments[3],xi=new Bo(arguments[0],arguments[1]),Si=new Fo(this.getRoot(),xi,Jr);return this.nearestNeighbourK(Si,Qr)}}}},{key:"isWithinDistance",value:function(){if(arguments.length===2){var x=arguments[0],O=arguments[1],$=Ze.POSITIVE_INFINITY,te=new ps;for(te.add(x);!te.isEmpty();){var he=te.poll(),Te=he.getDistance();if(Te>O)return!1;if(he.maximumDistance()<=O)return!0;if(he.isLeaves()){if(($=Te)<=O)return!0}else he.expandToQueue(te,$)}return!1}if(arguments.length===3){var Be=arguments[0],et=arguments[1],Dt=arguments[2],Ht=new Fo(this.getRoot(),Be.getRoot(),et);return this.isWithinDistance(Ht,Dt)}}},{key:"interfaces_",get:function(){return[Aa,He]}}],[{key:"constructor_",value:function(){if(arguments.length===0)g.constructor_.call(this,g.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var x=arguments[0];ro.constructor_.call(this,x)}}},{key:"centreX",value:function(x){return g.avg(x.getMinX(),x.getMaxX())}},{key:"avg",value:function(x,O){return(x+O)/2}},{key:"getItems",value:function(x){for(var O=new Array(x.size()).fill(null),$=0;!x.isEmpty();){var te=x.poll();O[$]=te.getBoundable(0).getItem(),$++}return O}},{key:"centreY",value:function(x){return g.avg(x.getMinY(),x.getMaxY())}}])}(ro),ic=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,[{key:"computeBounds",value:function(){for(var x=null,O=this.getChildBoundables().iterator();O.hasNext();){var $=O.next();x===null?x=new Ne($.getBounds()):x.expandToInclude($.getBounds())}return x}}],[{key:"constructor_",value:function(){var x=arguments[0];da.constructor_.call(this,x)}}])}(da);pi.STRtreeNode=ic,pi.xComparator=new(function(){return i(function C(){c(this,C)},[{key:"interfaces_",get:function(){return[Xt]}},{key:"compare",value:function(C,g){return ro.compareDoubles(pi.centreX(C.getBounds()),pi.centreX(g.getBounds()))}}])}()),pi.yComparator=new(function(){return i(function C(){c(this,C)},[{key:"interfaces_",get:function(){return[Xt]}},{key:"compare",value:function(C,g){return ro.compareDoubles(pi.centreY(C.getBounds()),pi.centreY(g.getBounds()))}}])}()),pi.intersectsOp=new(function(){return i(function C(){c(this,C)},[{key:"interfaces_",get:function(){return[IntersectsOp]}},{key:"intersects",value:function(C,g){return C.intersects(g)}}])}()),pi.DEFAULT_NODE_CAPACITY=10;var Fs=function(){function C(){c(this,C)}return i(C,null,[{key:"relativeSign",value:function(g,x){return g<x?-1:g>x?1:0}},{key:"compare",value:function(g,x,O){if(x.equals2D(O))return 0;var $=C.relativeSign(x.x,O.x),te=C.relativeSign(x.y,O.y);switch(g){case 0:return C.compareValue($,te);case 1:return C.compareValue(te,$);case 2:return C.compareValue(te,-$);case 3:return C.compareValue(-$,te);case 4:return C.compareValue(-$,-te);case 5:return C.compareValue(-te,-$);case 6:return C.compareValue(-te,$);case 7:return C.compareValue($,-te)}return cn.shouldNeverReachHere("invalid octant value"),0}},{key:"compareValue",value:function(g,x){return g<0?-1:g>0?1:x<0?-1:x>0?1:0}}])}(),eu=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(C){C.print(this.coord),C.print(" seg # = "+this.segmentIndex)}},{key:"compareTo",value:function(C){var g=C;return this.segmentIndex<g.segmentIndex?-1:this.segmentIndex>g.segmentIndex?1:this.coord.equals2D(g.coord)?0:this._isInterior?g._isInterior?Fs.compare(this._segmentOctant,this.coord,g.coord):1:-1}},{key:"isEndPoint",value:function(C){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===C}},{key:"toString",value:function(){return this.segmentIndex+":"+this.coord.toString()}},{key:"isInterior",value:function(){return this._isInterior}},{key:"interfaces_",get:function(){return[Oe]}}],[{key:"constructor_",value:function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var C=arguments[0],g=arguments[1],x=arguments[2],O=arguments[3];this._segString=C,this.coord=new Et(g),this.segmentIndex=x,this._segmentOctant=O,this._isInterior=!g.equals2D(C.getCoordinate(x))}}])}(),Zc=function(){return i(function C(){c(this,C)},[{key:"hasNext",value:function(){}},{key:"next",value:function(){}},{key:"remove",value:function(){}}])}(),js=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"getSplitCoordinates",value:function(){var C=new xt;this.addEndpoints();for(var g=this.iterator(),x=g.next();g.hasNext();){var O=g.next();this.addEdgeCoordinates(x,O,C),x=O}return C.toCoordinateArray()}},{key:"addCollapsedNodes",value:function(){var C=new Er;this.findCollapsesFromInsertedNodes(C),this.findCollapsesFromExistingVertices(C);for(var g=C.iterator();g.hasNext();){var x=g.next().intValue();this.add(this._edge.getCoordinate(x),x)}}},{key:"createSplitEdgePts",value:function(C,g){var x=g.segmentIndex-C.segmentIndex+2;if(x===2)return[new Et(C.coord),new Et(g.coord)];var O=this._edge.getCoordinate(g.segmentIndex),$=g.isInterior()||!g.coord.equals2D(O);$||x--;var te=new Array(x).fill(null),he=0;te[he++]=new Et(C.coord);for(var Te=C.segmentIndex+1;Te<=g.segmentIndex;Te++)te[he++]=this._edge.getCoordinate(Te);return $&&(te[he]=new Et(g.coord)),te}},{key:"print",value:function(C){C.println("Intersections:");for(var g=this.iterator();g.hasNext();)g.next().print(C)}},{key:"findCollapsesFromExistingVertices",value:function(C){for(var g=0;g<this._edge.size()-2;g++){var x=this._edge.getCoordinate(g);this._edge.getCoordinate(g+1);var O=this._edge.getCoordinate(g+2);x.equals2D(O)&&C.add(To.valueOf(g+1))}}},{key:"addEdgeCoordinates",value:function(C,g,x){var O=this.createSplitEdgePts(C,g);x.add(O,!1)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(C){this.addEndpoints(),this.addCollapsedNodes();for(var g=this.iterator(),x=g.next();g.hasNext();){var O=g.next(),$=this.createSplitEdge(x,O);C.add($),x=O}}},{key:"findCollapseIndex",value:function(C,g,x){if(!C.coord.equals2D(g.coord))return!1;var O=g.segmentIndex-C.segmentIndex;return g.isInterior()||O--,O===1&&(x[0]=C.segmentIndex+1,!0)}},{key:"findCollapsesFromInsertedNodes",value:function(C){for(var g=new Array(1).fill(null),x=this.iterator(),O=x.next();x.hasNext();){var $=x.next();this.findCollapseIndex(O,$,g)&&C.add(To.valueOf(g[0])),O=$}}},{key:"getEdge",value:function(){return this._edge}},{key:"addEndpoints",value:function(){var C=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(C),C)}},{key:"createSplitEdge",value:function(C,g){var x=this.createSplitEdgePts(C,g);return new Cl(x,this._edge.getData())}},{key:"add",value:function(C,g){var x=new eu(this._edge,C,g,this._edge.getSegmentOctant(g)),O=this._nodeMap.get(x);return O!==null?(cn.isTrue(O.coord.equals2D(C),"Found equal nodes with different coordinates"),O):(this._nodeMap.put(x,x),x)}},{key:"checkSplitEdgesCorrectness",value:function(C){var g=this._edge.getCoordinates(),x=C.get(0).getCoordinate(0);if(!x.equals2D(g[0]))throw new an("bad split edge start point at "+x);var O=C.get(C.size()-1).getCoordinates(),$=O[O.length-1];if(!$.equals2D(g[g.length-1]))throw new an("bad split edge end point at "+$)}}],[{key:"constructor_",value:function(){this._nodeMap=new ds,this._edge=null;var C=arguments[0];this._edge=C}}])}(),Hf=function(){function C(){c(this,C)}return i(C,null,[{key:"octant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var g=arguments[0],x=arguments[1];if(g===0&&x===0)throw new me("Cannot compute the octant for point ( "+g+", "+x+" )");var O=Math.abs(g),$=Math.abs(x);return g>=0?x>=0?O>=$?0:1:O>=$?7:6:x>=0?O>=$?3:2:O>=$?4:5}if(arguments[0]instanceof Et&&arguments[1]instanceof Et){var te=arguments[0],he=arguments[1],Te=he.x-te.x,Be=he.y-te.y;if(Te===0&&Be===0)throw new me("Cannot compute the octant for two identical points "+te);return C.octant(Te,Be)}}}])}(),Il=function(){return i(function C(){c(this,C)},[{key:"getCoordinates",value:function(){}},{key:"size",value:function(){}},{key:"getCoordinate",value:function(C){}},{key:"isClosed",value:function(){}},{key:"setData",value:function(C){}},{key:"getData",value:function(){}}])}(),Xf=function(){return i(function C(){c(this,C)},[{key:"addIntersection",value:function(C,g){}},{key:"interfaces_",get:function(){return[Il]}}])}(),Cl=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"getCoordinates",value:function(){return this._pts}},{key:"size",value:function(){return this._pts.length}},{key:"getCoordinate",value:function(g){return this._pts[g]}},{key:"isClosed",value:function(){return this._pts[0].equals(this._pts[this._pts.length-1])}},{key:"getSegmentOctant",value:function(g){return g===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(g),this.getCoordinate(g+1))}},{key:"setData",value:function(g){this._data=g}},{key:"safeOctant",value:function(g,x){return g.equals2D(x)?0:Hf.octant(g,x)}},{key:"getData",value:function(){return this._data}},{key:"addIntersection",value:function(){if(arguments.length===2){var g=arguments[0],x=arguments[1];this.addIntersectionNode(g,x)}else if(arguments.length===4){var O=arguments[1],$=arguments[3],te=new Et(arguments[0].getIntersection($));this.addIntersection(te,O)}}},{key:"toString",value:function(){return nc.toLineString(new $n(this._pts))}},{key:"getNodeList",value:function(){return this._nodeList}},{key:"addIntersectionNode",value:function(g,x){var O=x,$=O+1;if($<this._pts.length){var te=this._pts[$];g.equals2D(te)&&(O=$)}return this._nodeList.add(g,O)}},{key:"addIntersections",value:function(g,x,O){for(var $=0;$<g.getIntersectionNum();$++)this.addIntersection(g,x,O,$)}},{key:"interfaces_",get:function(){return[Xf]}}],[{key:"constructor_",value:function(){this._nodeList=new js(this),this._pts=null,this._data=null;var g=arguments[0],x=arguments[1];this._pts=g,this._data=x}},{key:"getNodedSubstrings",value:function(){if(arguments.length===1){var g=arguments[0],x=new Er;return C.getNodedSubstrings(g,x),x}if(arguments.length===2)for(var O=arguments[1],$=arguments[0].iterator();$.hasNext();)$.next().getNodeList().addSplitEdges(O)}}])}(),qi=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"minX",value:function(){return Math.min(this.p0.x,this.p1.x)}},{key:"orientationIndex",value:function(){if(arguments[0]instanceof C){var g=arguments[0],x=Rr.index(this.p0,this.p1,g.p0),O=Rr.index(this.p0,this.p1,g.p1);return x>=0&&O>=0||x<=0&&O<=0?Math.max(x,O):0}if(arguments[0]instanceof Et){var $=arguments[0];return Rr.index(this.p0,this.p1,$)}}},{key:"toGeometry",value:function(g){return g.createLineString([this.p0,this.p1])}},{key:"isVertical",value:function(){return this.p0.x===this.p1.x}},{key:"equals",value:function(g){if(!(g instanceof C))return!1;var x=g;return this.p0.equals(x.p0)&&this.p1.equals(x.p1)}},{key:"intersection",value:function(g){var x=new Xa;return x.computeIntersection(this.p0,this.p1,g.p0,g.p1),x.hasIntersection()?x.getIntersection(0):null}},{key:"project",value:function(){if(arguments[0]instanceof Et){var g=arguments[0];if(g.equals(this.p0)||g.equals(this.p1))return new Et(g);var x=this.projectionFactor(g),O=new Et;return O.x=this.p0.x+x*(this.p1.x-this.p0.x),O.y=this.p0.y+x*(this.p1.y-this.p0.y),O}if(arguments[0]instanceof C){var $=arguments[0],te=this.projectionFactor($.p0),he=this.projectionFactor($.p1);if(te>=1&&he>=1||te<=0&&he<=0)return null;var Te=this.project($.p0);te<0&&(Te=this.p0),te>1&&(Te=this.p1);var Be=this.project($.p1);return he<0&&(Be=this.p0),he>1&&(Be=this.p1),new C(Te,Be)}}},{key:"normalize",value:function(){this.p1.compareTo(this.p0)<0&&this.reverse()}},{key:"angle",value:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}},{key:"getCoordinate",value:function(g){return g===0?this.p0:this.p1}},{key:"distancePerpendicular",value:function(g){return $i.pointToLinePerpendicular(g,this.p0,this.p1)}},{key:"minY",value:function(){return Math.min(this.p0.y,this.p1.y)}},{key:"midPoint",value:function(){return C.midPoint(this.p0,this.p1)}},{key:"projectionFactor",value:function(g){if(g.equals(this.p0))return 0;if(g.equals(this.p1))return 1;var x=this.p1.x-this.p0.x,O=this.p1.y-this.p0.y,$=x*x+O*O;return $<=0?Ze.NaN:((g.x-this.p0.x)*x+(g.y-this.p0.y)*O)/$}},{key:"closestPoints",value:function(g){var x=this.intersection(g);if(x!==null)return[x,x];var O=new Array(2).fill(null),$=Ze.MAX_VALUE,te=null,he=this.closestPoint(g.p0);$=he.distance(g.p0),O[0]=he,O[1]=g.p0;var Te=this.closestPoint(g.p1);(te=Te.distance(g.p1))<$&&($=te,O[0]=Te,O[1]=g.p1);var Be=g.closestPoint(this.p0);(te=Be.distance(this.p0))<$&&($=te,O[0]=this.p0,O[1]=Be);var et=g.closestPoint(this.p1);return(te=et.distance(this.p1))<$&&($=te,O[0]=this.p1,O[1]=et),O}},{key:"closestPoint",value:function(g){var x=this.projectionFactor(g);return x>0&&x<1?this.project(g):this.p0.distance(g)<this.p1.distance(g)?this.p0:this.p1}},{key:"maxX",value:function(){return Math.max(this.p0.x,this.p1.x)}},{key:"getLength",value:function(){return this.p0.distance(this.p1)}},{key:"compareTo",value:function(g){var x=g,O=this.p0.compareTo(x.p0);return O!==0?O:this.p1.compareTo(x.p1)}},{key:"reverse",value:function(){var g=this.p0;this.p0=this.p1,this.p1=g}},{key:"equalsTopo",value:function(g){return this.p0.equals(g.p0)&&this.p1.equals(g.p1)||this.p0.equals(g.p1)&&this.p1.equals(g.p0)}},{key:"lineIntersection",value:function(g){return lr.intersection(this.p0,this.p1,g.p0,g.p1)}},{key:"maxY",value:function(){return Math.max(this.p0.y,this.p1.y)}},{key:"pointAlongOffset",value:function(g,x){var O=this.p0.x+g*(this.p1.x-this.p0.x),$=this.p0.y+g*(this.p1.y-this.p0.y),te=this.p1.x-this.p0.x,he=this.p1.y-this.p0.y,Te=Math.sqrt(te*te+he*he),Be=0,et=0;if(x!==0){if(Te<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");Be=x*te/Te,et=x*he/Te}return new Et(O-et,$+Be)}},{key:"setCoordinates",value:function(){if(arguments.length===1){var g=arguments[0];this.setCoordinates(g.p0,g.p1)}else if(arguments.length===2){var x=arguments[0],O=arguments[1];this.p0.x=x.x,this.p0.y=x.y,this.p1.x=O.x,this.p1.y=O.y}}},{key:"segmentFraction",value:function(g){var x=this.projectionFactor(g);return x<0?x=0:(x>1||Ze.isNaN(x))&&(x=1),x}},{key:"toString",value:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}},{key:"isHorizontal",value:function(){return this.p0.y===this.p1.y}},{key:"reflect",value:function(g){var x=this.p1.getY()-this.p0.getY(),O=this.p0.getX()-this.p1.getX(),$=this.p0.getY()*(this.p1.getX()-this.p0.getX())-this.p0.getX()*(this.p1.getY()-this.p0.getY()),te=x*x+O*O,he=x*x-O*O,Te=g.getX(),Be=g.getY();return new Et((-he*Te-2*x*O*Be-2*x*$)/te,(he*Be-2*x*O*Te-2*O*$)/te)}},{key:"distance",value:function(){if(arguments[0]instanceof C){var g=arguments[0];return $i.segmentToSegment(this.p0,this.p1,g.p0,g.p1)}if(arguments[0]instanceof Et){var x=arguments[0];return $i.pointToSegment(x,this.p0,this.p1)}}},{key:"pointAlong",value:function(g){var x=new Et;return x.x=this.p0.x+g*(this.p1.x-this.p0.x),x.y=this.p0.y+g*(this.p1.y-this.p0.y),x}},{key:"hashCode",value:function(){var g=Ze.doubleToLongBits(this.p0.x);g^=31*Ze.doubleToLongBits(this.p0.y);var x=Math.trunc(g)^Math.trunc(g>>32),O=Ze.doubleToLongBits(this.p1.x);return O^=31*Ze.doubleToLongBits(this.p1.y),x^(Math.trunc(O)^Math.trunc(O>>32))}},{key:"interfaces_",get:function(){return[Oe,He]}}],[{key:"constructor_",value:function(){if(this.p0=null,this.p1=null,arguments.length===0)C.constructor_.call(this,new Et,new Et);else if(arguments.length===1){var g=arguments[0];C.constructor_.call(this,g.p0,g.p1)}else if(arguments.length===2){var x=arguments[0],O=arguments[1];this.p0=x,this.p1=O}else if(arguments.length===4){var $=arguments[0],te=arguments[1],he=arguments[2],Te=arguments[3];C.constructor_.call(this,new Et($,te),new Et(he,Te))}}},{key:"midPoint",value:function(g,x){return new Et((g.x+x.x)/2,(g.y+x.y)/2)}}])}(),Yf=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"overlap",value:function(){if(arguments.length!==2){if(arguments.length===4){var C=arguments[1],g=arguments[2],x=arguments[3];arguments[0].getLineSegment(C,this._overlapSeg1),g.getLineSegment(x,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}}}],[{key:"constructor_",value:function(){this._overlapSeg1=new qi,this._overlapSeg2=new qi}}])}(),ac=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"getLineSegment",value:function(C,g){g.p0=this._pts[C],g.p1=this._pts[C+1]}},{key:"computeSelect",value:function(C,g,x,O){var $=this._pts[g],te=this._pts[x];if(x-g==1)return O.select(this,g),null;if(!C.intersects($,te))return null;var he=Math.trunc((g+x)/2);g<he&&this.computeSelect(C,g,he,O),he<x&&this.computeSelect(C,he,x,O)}},{key:"getCoordinates",value:function(){for(var C=new Array(this._end-this._start+1).fill(null),g=0,x=this._start;x<=this._end;x++)C[g++]=this._pts[x];return C}},{key:"computeOverlaps",value:function(){if(arguments.length===2){var C=arguments[0],g=arguments[1];this.computeOverlaps(this._start,this._end,C,C._start,C._end,g)}else if(arguments.length===6){var x=arguments[0],O=arguments[1],$=arguments[2],te=arguments[3],he=arguments[4],Te=arguments[5];if(O-x==1&&he-te==1)return Te.overlap(this,x,$,te),null;if(!this.overlaps(x,O,$,te,he))return null;var Be=Math.trunc((x+O)/2),et=Math.trunc((te+he)/2);x<Be&&(te<et&&this.computeOverlaps(x,Be,$,te,et,Te),et<he&&this.computeOverlaps(x,Be,$,et,he,Te)),Be<O&&(te<et&&this.computeOverlaps(Be,O,$,te,et,Te),et<he&&this.computeOverlaps(Be,O,$,et,he,Te))}}},{key:"setId",value:function(C){this._id=C}},{key:"select",value:function(C,g){this.computeSelect(C,this._start,this._end,g)}},{key:"getEnvelope",value:function(){if(this._env===null){var C=this._pts[this._start],g=this._pts[this._end];this._env=new Ne(C,g)}return this._env}},{key:"overlaps",value:function(C,g,x,O,$){return Ne.intersects(this._pts[C],this._pts[g],x._pts[O],x._pts[$])}},{key:"getEndIndex",value:function(){return this._end}},{key:"getStartIndex",value:function(){return this._start}},{key:"getContext",value:function(){return this._context}},{key:"getId",value:function(){return this._id}}],[{key:"constructor_",value:function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var C=arguments[0],g=arguments[1],x=arguments[2],O=arguments[3];this._pts=C,this._start=g,this._end=x,this._context=O}}])}(),Wc=function(){function C(){c(this,C)}return i(C,null,[{key:"findChainEnd",value:function(g,x){for(var O=x;O<g.length-1&&g[O].equals2D(g[O+1]);)O++;if(O>=g.length-1)return g.length-1;for(var $=Ta.quadrant(g[O],g[O+1]),te=x+1;te<g.length&&!(!g[te-1].equals2D(g[te])&&Ta.quadrant(g[te-1],g[te])!==$);)te++;return te-1}},{key:"getChains",value:function(){if(arguments.length===1){var g=arguments[0];return C.getChains(g,null)}if(arguments.length===2){var x=arguments[0],O=arguments[1],$=new Er,te=0;do{var he=C.findChainEnd(x,te),Te=new ac(x,te,he,O);$.add(Te),te=he}while(te<x.length-1);return $}}}])}(),Iu=function(){return i(function C(){c(this,C)},[{key:"computeNodes",value:function(C){}},{key:"getNodedSubstrings",value:function(){}}])}(),np=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"setSegmentIntersector",value:function(C){this._segInt=C}},{key:"interfaces_",get:function(){return[Iu]}}],[{key:"constructor_",value:function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var C=arguments[0];this.setSegmentIntersector(C)}}}}])}(),Zf=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,[{key:"getMonotoneChains",value:function(){return this._monoChains}},{key:"getNodedSubstrings",value:function(){return Cl.getNodedSubstrings(this._nodedSegStrings)}},{key:"getIndex",value:function(){return this._index}},{key:"add",value:function(x){for(var O=Wc.getChains(x.getCoordinates(),x).iterator();O.hasNext();){var $=O.next();$.setId(this._idCounter++),this._index.insert($.getEnvelope(),$),this._monoChains.add($)}}},{key:"computeNodes",value:function(x){this._nodedSegStrings=x;for(var O=x.iterator();O.hasNext();)this.add(O.next());this.intersectChains()}},{key:"intersectChains",value:function(){for(var x=new oc(this._segInt),O=this._monoChains.iterator();O.hasNext();)for(var $=O.next(),te=this._index.query($.getEnvelope()).iterator();te.hasNext();){var he=te.next();if(he.getId()>$.getId()&&($.computeOverlaps(he,x),this._nOverlaps++),this._segInt.isDone())return null}}}],[{key:"constructor_",value:function(){if(this._monoChains=new Er,this._index=new pi,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,arguments.length!==0){if(arguments.length===1){var x=arguments[0];np.constructor_.call(this,x)}}}}])}(np),oc=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,[{key:"overlap",value:function(){if(arguments.length!==4)return ie(g,"overlap",this,1).apply(this,arguments);var x=arguments[1],O=arguments[2],$=arguments[3],te=arguments[0].getContext(),he=O.getContext();this._si.processIntersections(te,x,he,$)}}],[{key:"constructor_",value:function(){this._si=null;var x=arguments[0];this._si=x}}])}(Yf);Zf.SegmentOverlapAction=oc;var Io=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"isDeletable",value:function(g,x,O,$){var te=this._inputLine[g],he=this._inputLine[x],Te=this._inputLine[O];return!!this.isConcave(te,he,Te)&&!!this.isShallow(te,he,Te,$)&&this.isShallowSampled(te,he,g,O,$)}},{key:"deleteShallowConcavities",value:function(){for(var g=1,x=this.findNextNonDeletedIndex(g),O=this.findNextNonDeletedIndex(x),$=!1;O<this._inputLine.length;){var te=!1;this.isDeletable(g,x,O,this._distanceTol)&&(this._isDeleted[x]=C.DELETE,te=!0,$=!0),g=te?O:x,x=this.findNextNonDeletedIndex(g),O=this.findNextNonDeletedIndex(x)}return $}},{key:"isShallowConcavity",value:function(g,x,O,$){return Rr.index(g,x,O)===this._angleOrientation&&$i.pointToSegment(x,g,O)<$}},{key:"isShallowSampled",value:function(g,x,O,$,te){var he=Math.trunc(($-O)/C.NUM_PTS_TO_CHECK);he<=0&&(he=1);for(var Te=O;Te<$;Te+=he)if(!this.isShallow(g,x,this._inputLine[Te],te))return!1;return!0}},{key:"isConcave",value:function(g,x,O){var $=Rr.index(g,x,O)===this._angleOrientation;return $}},{key:"simplify",value:function(g){this._distanceTol=Math.abs(g),g<0&&(this._angleOrientation=Rr.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var x=!1;do x=this.deleteShallowConcavities();while(x);return this.collapseLine()}},{key:"findNextNonDeletedIndex",value:function(g){for(var x=g+1;x<this._inputLine.length&&this._isDeleted[x]===C.DELETE;)x++;return x}},{key:"isShallow",value:function(g,x,O,$){return $i.pointToSegment(x,g,O)<$}},{key:"collapseLine",value:function(){for(var g=new xt,x=0;x<this._inputLine.length;x++)this._isDeleted[x]!==C.DELETE&&g.add(this._inputLine[x]);return g.toCoordinateArray()}}],[{key:"constructor_",value:function(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Rr.COUNTERCLOCKWISE;var g=arguments[0];this._inputLine=g}},{key:"simplify",value:function(g,x){return new C(g).simplify(x)}}])}();Io.INIT=0,Io.DELETE=1,Io.KEEP=1,Io.NUM_PTS_TO_CHECK=10;var rp=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"getCoordinates",value:function(){return this._ptList.toArray(C.COORDINATE_ARRAY_TYPE)}},{key:"setPrecisionModel",value:function(g){this._precisionModel=g}},{key:"addPt",value:function(g){var x=new Et(g);if(this._precisionModel.makePrecise(x),this.isRedundant(x))return null;this._ptList.add(x)}},{key:"reverse",value:function(){}},{key:"addPts",value:function(g,x){if(x)for(var O=0;O<g.length;O++)this.addPt(g[O]);else for(var $=g.length-1;$>=0;$--)this.addPt(g[$])}},{key:"isRedundant",value:function(g){if(this._ptList.size()<1)return!1;var x=this._ptList.get(this._ptList.size()-1);return g.distance(x)<this._minimimVertexDistance}},{key:"toString",value:function(){return new Pi().createLineString(this.getCoordinates()).toString()}},{key:"closeRing",value:function(){if(this._ptList.size()<1)return null;var g=new Et(this._ptList.get(0)),x=this._ptList.get(this._ptList.size()-1);if(g.equals(x))return null;this._ptList.add(g)}},{key:"setMinimumVertexDistance",value:function(g){this._minimimVertexDistance=g}}],[{key:"constructor_",value:function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Er}}])}();rp.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);var Za=function(){function C(){c(this,C)}return i(C,null,[{key:"toDegrees",value:function(g){return 180*g/Math.PI}},{key:"normalize",value:function(g){for(;g>Math.PI;)g-=C.PI_TIMES_2;for(;g<=-Math.PI;)g+=C.PI_TIMES_2;return g}},{key:"angle",value:function(){if(arguments.length===1){var g=arguments[0];return Math.atan2(g.y,g.x)}if(arguments.length===2){var x=arguments[0],O=arguments[1],$=O.x-x.x,te=O.y-x.y;return Math.atan2(te,$)}}},{key:"isAcute",value:function(g,x,O){var $=g.x-x.x,te=g.y-x.y;return $*(O.x-x.x)+te*(O.y-x.y)>0}},{key:"isObtuse",value:function(g,x,O){var $=g.x-x.x,te=g.y-x.y;return $*(O.x-x.x)+te*(O.y-x.y)<0}},{key:"interiorAngle",value:function(g,x,O){var $=C.angle(x,g),te=C.angle(x,O);return Math.abs(te-$)}},{key:"normalizePositive",value:function(g){if(g<0){for(;g<0;)g+=C.PI_TIMES_2;g>=C.PI_TIMES_2&&(g=0)}else{for(;g>=C.PI_TIMES_2;)g-=C.PI_TIMES_2;g<0&&(g=0)}return g}},{key:"angleBetween",value:function(g,x,O){var $=C.angle(x,g),te=C.angle(x,O);return C.diff($,te)}},{key:"diff",value:function(g,x){var O=null;return(O=g<x?x-g:g-x)>Math.PI&&(O=2*Math.PI-O),O}},{key:"toRadians",value:function(g){return g*Math.PI/180}},{key:"getTurn",value:function(g,x){var O=Math.sin(x-g);return O>0?C.COUNTERCLOCKWISE:O<0?C.CLOCKWISE:C.NONE}},{key:"angleBetweenOriented",value:function(g,x,O){var $=C.angle(x,g),te=C.angle(x,O)-$;return te<=-Math.PI?te+C.PI_TIMES_2:te>Math.PI?te-C.PI_TIMES_2:te}}])}();Za.PI_TIMES_2=2*Math.PI,Za.PI_OVER_2=Math.PI/2,Za.PI_OVER_4=Math.PI/4,Za.COUNTERCLOCKWISE=Rr.COUNTERCLOCKWISE,Za.CLOCKWISE=Rr.CLOCKWISE,Za.NONE=Rr.COLLINEAR;var Cu=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"addNextSegment",value:function(g,x){if(this._s0=this._s1,this._s1=this._s2,this._s2=g,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var O=Rr.index(this._s0,this._s1,this._s2),$=O===Rr.CLOCKWISE&&this._side===vn.LEFT||O===Rr.COUNTERCLOCKWISE&&this._side===vn.RIGHT;O===0?this.addCollinear(x):$?this.addOutsideTurn(O,x):this.addInsideTurn(O,x)}},{key:"addLineEndCap",value:function(g,x){var O=new qi(g,x),$=new qi;this.computeOffsetSegment(O,vn.LEFT,this._distance,$);var te=new qi;this.computeOffsetSegment(O,vn.RIGHT,this._distance,te);var he=x.x-g.x,Te=x.y-g.y,Be=Math.atan2(Te,he);switch(this._bufParams.getEndCapStyle()){case ve.CAP_ROUND:this._segList.addPt($.p1),this.addDirectedFillet(x,Be+Math.PI/2,Be-Math.PI/2,Rr.CLOCKWISE,this._distance),this._segList.addPt(te.p1);break;case ve.CAP_FLAT:this._segList.addPt($.p1),this._segList.addPt(te.p1);break;case ve.CAP_SQUARE:var et=new Et;et.x=Math.abs(this._distance)*Math.cos(Be),et.y=Math.abs(this._distance)*Math.sin(Be);var Dt=new Et($.p1.x+et.x,$.p1.y+et.y),Ht=new Et(te.p1.x+et.x,te.p1.y+et.y);this._segList.addPt(Dt),this._segList.addPt(Ht)}}},{key:"getCoordinates",value:function(){return this._segList.getCoordinates()}},{key:"addMitreJoin",value:function(g,x,O,$){var te=lr.intersection(x.p0,x.p1,O.p0,O.p1);if(te!==null&&($<=0?1:te.distance(g)/Math.abs($))<=this._bufParams.getMitreLimit())return this._segList.addPt(te),null;this.addLimitedMitreJoin(x,O,$,this._bufParams.getMitreLimit())}},{key:"addOutsideTurn",value:function(g,x){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*C.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===ve.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===ve.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(x&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,g,this._distance),this._segList.addPt(this._offset1.p0))}},{key:"createSquare",value:function(g){this._segList.addPt(new Et(g.x+this._distance,g.y+this._distance)),this._segList.addPt(new Et(g.x+this._distance,g.y-this._distance)),this._segList.addPt(new Et(g.x-this._distance,g.y-this._distance)),this._segList.addPt(new Et(g.x-this._distance,g.y+this._distance)),this._segList.closeRing()}},{key:"addSegments",value:function(g,x){this._segList.addPts(g,x)}},{key:"addFirstSegment",value:function(){this._segList.addPt(this._offset1.p0)}},{key:"addCornerFillet",value:function(g,x,O,$,te){var he=x.x-g.x,Te=x.y-g.y,Be=Math.atan2(Te,he),et=O.x-g.x,Dt=O.y-g.y,Ht=Math.atan2(Dt,et);$===Rr.CLOCKWISE?Be<=Ht&&(Be+=2*Math.PI):Be>=Ht&&(Be-=2*Math.PI),this._segList.addPt(x),this.addDirectedFillet(g,Be,Ht,$,te),this._segList.addPt(O)}},{key:"addLastSegment",value:function(){this._segList.addPt(this._offset1.p1)}},{key:"initSideSegments",value:function(g,x,O){this._s1=g,this._s2=x,this._side=O,this._seg1.setCoordinates(g,x),this.computeOffsetSegment(this._seg1,O,this._distance,this._offset1)}},{key:"addLimitedMitreJoin",value:function(g,x,O,$){var te=this._seg0.p1,he=Za.angle(te,this._seg0.p0),Te=Za.angleBetweenOriented(this._seg0.p0,te,this._seg1.p1)/2,Be=Za.normalize(he+Te),et=Za.normalize(Be+Math.PI),Dt=$*O,Ht=O-Dt*Math.abs(Math.sin(Te)),bn=te.x+Dt*Math.cos(et),Hn=te.y+Dt*Math.sin(et),sr=new Et(bn,Hn),xr=new qi(te,sr),Jr=xr.pointAlongOffset(1,Ht),Qr=xr.pointAlongOffset(1,-Ht);this._side===vn.LEFT?(this._segList.addPt(Jr),this._segList.addPt(Qr)):(this._segList.addPt(Qr),this._segList.addPt(Jr))}},{key:"addDirectedFillet",value:function(g,x,O,$,te){var he=$===Rr.CLOCKWISE?-1:1,Te=Math.abs(x-O),Be=Math.trunc(Te/this._filletAngleQuantum+.5);if(Be<1)return null;for(var et=Te/Be,Dt=new Et,Ht=0;Ht<Be;Ht++){var bn=x+he*Ht*et;Dt.x=g.x+te*Math.cos(bn),Dt.y=g.y+te*Math.sin(bn),this._segList.addPt(Dt)}}},{key:"computeOffsetSegment",value:function(g,x,O,$){var te=x===vn.LEFT?1:-1,he=g.p1.x-g.p0.x,Te=g.p1.y-g.p0.y,Be=Math.sqrt(he*he+Te*Te),et=te*O*he/Be,Dt=te*O*Te/Be;$.p0.x=g.p0.x-Dt,$.p0.y=g.p0.y+et,$.p1.x=g.p1.x-Dt,$.p1.y=g.p1.y+et}},{key:"addInsideTurn",value:function(g,x){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*C.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var O=new Et((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(O);var $=new Et((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt($)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}},{key:"createCircle",value:function(g){var x=new Et(g.x+this._distance,g.y);this._segList.addPt(x),this.addDirectedFillet(g,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}},{key:"addBevelJoin",value:function(g,x){this._segList.addPt(g.p1),this._segList.addPt(x.p0)}},{key:"init",value:function(g){this._distance=g,this._maxCurveSegmentError=g*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new rp,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(g*C.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}},{key:"addCollinear",value:function(g){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===ve.JOIN_BEVEL||this._bufParams.getJoinStyle()===ve.JOIN_MITRE?(g&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,Rr.CLOCKWISE,this._distance))}},{key:"closeRing",value:function(){this._segList.closeRing()}},{key:"hasNarrowConcaveAngle",value:function(){return this._hasNarrowConcaveAngle}}],[{key:"constructor_",value:function(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new qi,this._seg1=new qi,this._offset0=new qi,this._offset1=new qi,this._side=0,this._hasNarrowConcaveAngle=!1;var g=arguments[0],x=arguments[1],O=arguments[2];this._precisionModel=g,this._bufParams=x,this._li=new Xa,this._filletAngleQuantum=Math.PI/2/x.getQuadrantSegments(),x.getQuadrantSegments()>=8&&x.getJoinStyle()===ve.JOIN_ROUND&&(this._closingSegLengthFactor=C.MAX_CLOSING_SEG_LEN_FACTOR),this.init(O)}}])}();Cu.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,Cu.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,Cu.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,Cu.MAX_CLOSING_SEG_LEN_FACTOR=80;var Us=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"getOffsetCurve",value:function(g,x){if(this._distance=x,x===0)return null;var O=x<0,$=Math.abs(x),te=this.getSegGen($);g.length<=1?this.computePointCurve(g[0],te):this.computeOffsetCurve(g,O,te);var he=te.getCoordinates();return O&&Ct.reverse(he),he}},{key:"computeSingleSidedBufferCurve",value:function(g,x,O){var $=this.simplifyTolerance(this._distance);if(x){O.addSegments(g,!0);var te=Io.simplify(g,-$),he=te.length-1;O.initSideSegments(te[he],te[he-1],vn.LEFT),O.addFirstSegment();for(var Te=he-2;Te>=0;Te--)O.addNextSegment(te[Te],!0)}else{O.addSegments(g,!1);var Be=Io.simplify(g,$),et=Be.length-1;O.initSideSegments(Be[0],Be[1],vn.LEFT),O.addFirstSegment();for(var Dt=2;Dt<=et;Dt++)O.addNextSegment(Be[Dt],!0)}O.addLastSegment(),O.closeRing()}},{key:"computeRingBufferCurve",value:function(g,x,O){var $=this.simplifyTolerance(this._distance);x===vn.RIGHT&&($=-$);var te=Io.simplify(g,$),he=te.length-1;O.initSideSegments(te[he-1],te[0],x);for(var Te=1;Te<=he;Te++){var Be=Te!==1;O.addNextSegment(te[Te],Be)}O.closeRing()}},{key:"computeLineBufferCurve",value:function(g,x){var O=this.simplifyTolerance(this._distance),$=Io.simplify(g,O),te=$.length-1;x.initSideSegments($[0],$[1],vn.LEFT);for(var he=2;he<=te;he++)x.addNextSegment($[he],!0);x.addLastSegment(),x.addLineEndCap($[te-1],$[te]);var Te=Io.simplify(g,-O),Be=Te.length-1;x.initSideSegments(Te[Be],Te[Be-1],vn.LEFT);for(var et=Be-2;et>=0;et--)x.addNextSegment(Te[et],!0);x.addLastSegment(),x.addLineEndCap(Te[1],Te[0]),x.closeRing()}},{key:"computePointCurve",value:function(g,x){switch(this._bufParams.getEndCapStyle()){case ve.CAP_ROUND:x.createCircle(g);break;case ve.CAP_SQUARE:x.createSquare(g)}}},{key:"getLineCurve",value:function(g,x){if(this._distance=x,this.isLineOffsetEmpty(x))return null;var O=Math.abs(x),$=this.getSegGen(O);if(g.length<=1)this.computePointCurve(g[0],$);else if(this._bufParams.isSingleSided()){var te=x<0;this.computeSingleSidedBufferCurve(g,te,$)}else this.computeLineBufferCurve(g,$);return $.getCoordinates()}},{key:"getBufferParameters",value:function(){return this._bufParams}},{key:"simplifyTolerance",value:function(g){return g*this._bufParams.getSimplifyFactor()}},{key:"getRingCurve",value:function(g,x,O){if(this._distance=O,g.length<=2)return this.getLineCurve(g,O);if(O===0)return C.copyCoordinates(g);var $=this.getSegGen(O);return this.computeRingBufferCurve(g,x,$),$.getCoordinates()}},{key:"computeOffsetCurve",value:function(g,x,O){var $=this.simplifyTolerance(this._distance);if(x){var te=Io.simplify(g,-$),he=te.length-1;O.initSideSegments(te[he],te[he-1],vn.LEFT),O.addFirstSegment();for(var Te=he-2;Te>=0;Te--)O.addNextSegment(te[Te],!0)}else{var Be=Io.simplify(g,$),et=Be.length-1;O.initSideSegments(Be[0],Be[1],vn.LEFT),O.addFirstSegment();for(var Dt=2;Dt<=et;Dt++)O.addNextSegment(Be[Dt],!0)}O.addLastSegment()}},{key:"isLineOffsetEmpty",value:function(g){return g===0||g<0&&!this._bufParams.isSingleSided()}},{key:"getSegGen",value:function(g){return new Cu(this._precisionModel,this._bufParams,g)}}],[{key:"constructor_",value:function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var g=arguments[0],x=arguments[1];this._precisionModel=g,this._bufParams=x}},{key:"copyCoordinates",value:function(g){for(var x=new Array(g.length).fill(null),O=0;O<x.length;O++)x[O]=new Et(g[O]);return x}}])}(),Ko=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"findStabbedSegments",value:function(){if(arguments.length===1){for(var C=arguments[0],g=new Er,x=this._subgraphs.iterator();x.hasNext();){var O=x.next(),$=O.getEnvelope();C.y<$.getMinY()||C.y>$.getMaxY()||this.findStabbedSegments(C,O.getDirectedEdges(),g)}return g}if(arguments.length===3){if(Mn(arguments[2],ya)&&arguments[0]instanceof Et&&arguments[1]instanceof ui){for(var te=arguments[0],he=arguments[1],Te=arguments[2],Be=he.getEdge().getCoordinates(),et=0;et<Be.length-1;et++)if(this._seg.p0=Be[et],this._seg.p1=Be[et+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<te.x||this._seg.isHorizontal()||te.y<this._seg.p0.y||te.y>this._seg.p1.y||Rr.index(this._seg.p0,this._seg.p1,te)===Rr.RIGHT)){var Dt=he.getDepth(vn.LEFT);this._seg.p0.equals(Be[et])||(Dt=he.getDepth(vn.RIGHT));var Ht=new ip(this._seg,Dt);Te.add(Ht)}}else if(Mn(arguments[2],ya)&&arguments[0]instanceof Et&&Mn(arguments[1],ya))for(var bn=arguments[0],Hn=arguments[2],sr=arguments[1].iterator();sr.hasNext();){var xr=sr.next();xr.isForward()&&this.findStabbedSegments(bn,xr,Hn)}}}},{key:"getDepth",value:function(C){var g=this.findStabbedSegments(C);return g.size()===0?0:la.min(g)._leftDepth}}],[{key:"constructor_",value:function(){this._subgraphs=null,this._seg=new qi;var C=arguments[0];this._subgraphs=C}}])}(),ip=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"compareTo",value:function(C){var g=C;if(this._upwardSeg.minX()>=g._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=g._upwardSeg.minX())return-1;var x=this._upwardSeg.orientationIndex(g._upwardSeg);return x!==0||(x=-1*g._upwardSeg.orientationIndex(this._upwardSeg))!==0?x:this._upwardSeg.compareTo(g._upwardSeg)}},{key:"compareX",value:function(C,g){var x=C.p0.compareTo(g.p0);return x!==0?x:C.p1.compareTo(g.p1)}},{key:"toString",value:function(){return this._upwardSeg.toString()}},{key:"interfaces_",get:function(){return[Oe]}}],[{key:"constructor_",value:function(){this._upwardSeg=null,this._leftDepth=null;var C=arguments[0],g=arguments[1];this._upwardSeg=new qi(C),this._leftDepth=g}}])}();Ko.DepthSegment=ip;var Kc=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,null,[{key:"constructor_",value:function(){Ee.constructor_.call(this,"Projective point not representable on the Cartesian plane.")}}])}(Ee),Nh=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"getY",value:function(){var g=this.y/this.w;if(Ze.isNaN(g)||Ze.isInfinite(g))throw new Kc;return g}},{key:"getX",value:function(){var g=this.x/this.w;if(Ze.isNaN(g)||Ze.isInfinite(g))throw new Kc;return g}},{key:"getCoordinate",value:function(){var g=new Et;return g.x=this.getX(),g.y=this.getY(),g}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var g=arguments[0];this.x=g.x,this.y=g.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var x=arguments[0],O=arguments[1];this.x=x,this.y=O,this.w=1}else if(arguments[0]instanceof C&&arguments[1]instanceof C){var $=arguments[0],te=arguments[1];this.x=$.y*te.w-te.y*$.w,this.y=te.x*$.w-$.x*te.w,this.w=$.x*te.y-te.x*$.y}else if(arguments[0]instanceof Et&&arguments[1]instanceof Et){var he=arguments[0],Te=arguments[1];this.x=he.y-Te.y,this.y=Te.x-he.x,this.w=he.x*Te.y-Te.x*he.y}}else if(arguments.length===3){var Be=arguments[0],et=arguments[1],Dt=arguments[2];this.x=Be,this.y=et,this.w=Dt}else if(arguments.length===4){var Ht=arguments[0],bn=arguments[1],Hn=arguments[2],sr=arguments[3],xr=Ht.y-bn.y,Jr=bn.x-Ht.x,Qr=Ht.x*bn.y-bn.x*Ht.y,xi=Hn.y-sr.y,Si=sr.x-Hn.x,mi=Hn.x*sr.y-sr.x*Hn.y;this.x=Jr*mi-Si*Qr,this.y=xi*Qr-xr*mi,this.w=xr*Si-xi*Jr}}}])}(),Wf=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"area",value:function(){return C.area(this.p0,this.p1,this.p2)}},{key:"signedArea",value:function(){return C.signedArea(this.p0,this.p1,this.p2)}},{key:"interpolateZ",value:function(g){if(g===null)throw new me("Supplied point is null.");return C.interpolateZ(g,this.p0,this.p1,this.p2)}},{key:"longestSideLength",value:function(){return C.longestSideLength(this.p0,this.p1,this.p2)}},{key:"isAcute",value:function(){return C.isAcute(this.p0,this.p1,this.p2)}},{key:"circumcentre",value:function(){return C.circumcentre(this.p0,this.p1,this.p2)}},{key:"area3D",value:function(){return C.area3D(this.p0,this.p1,this.p2)}},{key:"centroid",value:function(){return C.centroid(this.p0,this.p1,this.p2)}},{key:"inCentre",value:function(){return C.inCentre(this.p0,this.p1,this.p2)}}],[{key:"constructor_",value:function(){this.p0=null,this.p1=null,this.p2=null;var g=arguments[0],x=arguments[1],O=arguments[2];this.p0=g,this.p1=x,this.p2=O}},{key:"area",value:function(g,x,O){return Math.abs(((O.x-g.x)*(x.y-g.y)-(x.x-g.x)*(O.y-g.y))/2)}},{key:"signedArea",value:function(g,x,O){return((O.x-g.x)*(x.y-g.y)-(x.x-g.x)*(O.y-g.y))/2}},{key:"det",value:function(g,x,O,$){return g*$-x*O}},{key:"interpolateZ",value:function(g,x,O,$){var te=x.x,he=x.y,Te=O.x-te,Be=$.x-te,et=O.y-he,Dt=$.y-he,Ht=Te*Dt-Be*et,bn=g.x-te,Hn=g.y-he,sr=(Dt*bn-Be*Hn)/Ht,xr=(-et*bn+Te*Hn)/Ht;return x.getZ()+sr*(O.getZ()-x.getZ())+xr*($.getZ()-x.getZ())}},{key:"longestSideLength",value:function(g,x,O){var $=g.distance(x),te=x.distance(O),he=O.distance(g),Te=$;return te>Te&&(Te=te),he>Te&&(Te=he),Te}},{key:"circumcentreDD",value:function(g,x,O){var $=ar.valueOf(g.x).subtract(O.x),te=ar.valueOf(g.y).subtract(O.y),he=ar.valueOf(x.x).subtract(O.x),Te=ar.valueOf(x.y).subtract(O.y),Be=ar.determinant($,te,he,Te).multiply(2),et=$.sqr().add(te.sqr()),Dt=he.sqr().add(Te.sqr()),Ht=ar.determinant(te,et,Te,Dt),bn=ar.determinant($,et,he,Dt),Hn=ar.valueOf(O.x).subtract(Ht.divide(Be)).doubleValue(),sr=ar.valueOf(O.y).add(bn.divide(Be)).doubleValue();return new Et(Hn,sr)}},{key:"isAcute",value:function(g,x,O){return!!Za.isAcute(g,x,O)&&!!Za.isAcute(x,O,g)&&!!Za.isAcute(O,g,x)}},{key:"circumcentre",value:function(g,x,O){var $=O.x,te=O.y,he=g.x-$,Te=g.y-te,Be=x.x-$,et=x.y-te,Dt=2*C.det(he,Te,Be,et),Ht=C.det(Te,he*he+Te*Te,et,Be*Be+et*et),bn=C.det(he,he*he+Te*Te,Be,Be*Be+et*et);return new Et($-Ht/Dt,te+bn/Dt)}},{key:"perpendicularBisector",value:function(g,x){var O=x.x-g.x,$=x.y-g.y,te=new Nh(g.x+O/2,g.y+$/2,1),he=new Nh(g.x-$+O/2,g.y+O+$/2,1);return new Nh(te,he)}},{key:"angleBisector",value:function(g,x,O){var $=x.distance(g),te=$/($+x.distance(O)),he=O.x-g.x,Te=O.y-g.y;return new Et(g.x+te*he,g.y+te*Te)}},{key:"area3D",value:function(g,x,O){var $=x.x-g.x,te=x.y-g.y,he=x.getZ()-g.getZ(),Te=O.x-g.x,Be=O.y-g.y,et=O.getZ()-g.getZ(),Dt=te*et-he*Be,Ht=he*Te-$*et,bn=$*Be-te*Te,Hn=Dt*Dt+Ht*Ht+bn*bn,sr=Math.sqrt(Hn)/2;return sr}},{key:"centroid",value:function(g,x,O){var $=(g.x+x.x+O.x)/3,te=(g.y+x.y+O.y)/3;return new Et($,te)}},{key:"inCentre",value:function(g,x,O){var $=x.distance(O),te=g.distance(O),he=g.distance(x),Te=$+te+he,Be=($*g.x+te*x.x+he*O.x)/Te,et=($*g.y+te*x.y+he*O.y)/Te;return new Et(Be,et)}}])}(),ap=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"addRingSide",value:function(C,g,x,O,$){if(g===0&&C.length<nt.MINIMUM_VALID_SIZE)return null;var te=O,he=$;C.length>=nt.MINIMUM_VALID_SIZE&&Rr.isCCW(C)&&(te=$,he=O,x=vn.opposite(x));var Te=this._curveBuilder.getRingCurve(C,x,g);this.addCurve(Te,te,he)}},{key:"addRingBothSides",value:function(C,g){this.addRingSide(C,g,vn.LEFT,qe.EXTERIOR,qe.INTERIOR),this.addRingSide(C,g,vn.RIGHT,qe.INTERIOR,qe.EXTERIOR)}},{key:"addPoint",value:function(C){if(this._distance<=0)return null;var g=C.getCoordinates(),x=this._curveBuilder.getLineCurve(g,this._distance);this.addCurve(x,qe.EXTERIOR,qe.INTERIOR)}},{key:"addPolygon",value:function(C){var g=this._distance,x=vn.LEFT;this._distance<0&&(g=-this._distance,x=vn.RIGHT);var O=C.getExteriorRing(),$=Ct.removeRepeatedPoints(O.getCoordinates());if(this._distance<0&&this.isErodedCompletely(O,this._distance)||this._distance<=0&&$.length<3)return null;this.addRingSide($,g,x,qe.EXTERIOR,qe.INTERIOR);for(var te=0;te<C.getNumInteriorRing();te++){var he=C.getInteriorRingN(te),Te=Ct.removeRepeatedPoints(he.getCoordinates());this._distance>0&&this.isErodedCompletely(he,-this._distance)||this.addRingSide(Te,g,vn.opposite(x),qe.INTERIOR,qe.EXTERIOR)}}},{key:"isTriangleErodedCompletely",value:function(C,g){var x=new Wf(C[0],C[1],C[2]),O=x.inCentre();return $i.pointToSegment(O,x.p0,x.p1)<Math.abs(g)}},{key:"addLineString",value:function(C){if(this._curveBuilder.isLineOffsetEmpty(this._distance))return null;var g=Ct.removeRepeatedPoints(C.getCoordinates());if(Ct.isRing(g)&&!this._curveBuilder.getBufferParameters().isSingleSided())this.addRingBothSides(g,this._distance);else{var x=this._curveBuilder.getLineCurve(g,this._distance);this.addCurve(x,qe.EXTERIOR,qe.INTERIOR)}}},{key:"addCurve",value:function(C,g,x){if(C===null||C.length<2)return null;var O=new Cl(C,new Ya(0,qe.BOUNDARY,g,x));this._curveList.add(O)}},{key:"getCurves",value:function(){return this.add(this._inputGeom),this._curveList}},{key:"add",value:function(C){if(C.isEmpty())return null;if(C instanceof wt)this.addPolygon(C);else if(C instanceof Mi)this.addLineString(C);else if(C instanceof Tu)this.addPoint(C);else if(C instanceof Xe)this.addCollection(C);else if(C instanceof Nr)this.addCollection(C);else if(C instanceof Fn)this.addCollection(C);else{if(!(C instanceof Fe))throw new Ur(C.getGeometryType());this.addCollection(C)}}},{key:"isErodedCompletely",value:function(C,g){var x=C.getCoordinates();if(x.length<4)return g<0;if(x.length===4)return this.isTriangleErodedCompletely(x,g);var O=C.getEnvelopeInternal(),$=Math.min(O.getHeight(),O.getWidth());return g<0&&2*Math.abs(g)>$}},{key:"addCollection",value:function(C){for(var g=0;g<C.getNumGeometries();g++){var x=C.getGeometryN(g);this.add(x)}}}],[{key:"constructor_",value:function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Er;var C=arguments[0],g=arguments[1],x=arguments[2];this._inputGeom=C,this._distance=g,this._curveBuilder=x}}])}(),Bh=function(){return i(function C(){c(this,C)},[{key:"locate",value:function(C){}}])}(),ms=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"next",value:function(){if(this._atStart)return this._atStart=!1,C.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new $t;var g=this._parent.getGeometryN(this._index++);return g instanceof Fe?(this._subcollectionIterator=new C(g),this._subcollectionIterator.next()):g}},{key:"remove",value:function(){throw new Ur(this.getClass().getName())}},{key:"hasNext",value:function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}},{key:"interfaces_",get:function(){return[Zc]}}],[{key:"constructor_",value:function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var g=arguments[0];this._parent=g,this._atStart=!0,this._index=0,this._max=g.getNumGeometries()}},{key:"isAtomic",value:function(g){return!(g instanceof Fe)}}])}(),vr=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"locate",value:function(g){return C.locate(g,this._geom)}},{key:"interfaces_",get:function(){return[Bh]}}],[{key:"constructor_",value:function(){this._geom=null;var g=arguments[0];this._geom=g}},{key:"locatePointInPolygon",value:function(g,x){if(x.isEmpty())return qe.EXTERIOR;var O=x.getExteriorRing(),$=C.locatePointInRing(g,O);if($!==qe.INTERIOR)return $;for(var te=0;te<x.getNumInteriorRing();te++){var he=x.getInteriorRingN(te),Te=C.locatePointInRing(g,he);if(Te===qe.BOUNDARY)return qe.BOUNDARY;if(Te===qe.INTERIOR)return qe.EXTERIOR}return qe.INTERIOR}},{key:"locatePointInRing",value:function(g,x){return x.getEnvelopeInternal().intersects(g)?Mu.locateInRing(g,x.getCoordinates()):qe.EXTERIOR}},{key:"containsPointInPolygon",value:function(g,x){return qe.EXTERIOR!==C.locatePointInPolygon(g,x)}},{key:"locateInGeometry",value:function(g,x){if(x instanceof wt)return C.locatePointInPolygon(g,x);if(x instanceof Fe)for(var O=new ms(x);O.hasNext();){var $=O.next();if($!==x){var te=C.locateInGeometry(g,$);if(te!==qe.EXTERIOR)return te}}return qe.EXTERIOR}},{key:"isContained",value:function(g,x){return qe.EXTERIOR!==C.locate(g,x)}},{key:"locate",value:function(g,x){return x.isEmpty()?qe.EXTERIOR:x.getEnvelopeInternal().intersects(g)?C.locateInGeometry(g,x):qe.EXTERIOR}}])}(),qn=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"getNextCW",value:function(C){this.getEdges();var g=this._edgeList.indexOf(C),x=g-1;return g===0&&(x=this._edgeList.size()-1),this._edgeList.get(x)}},{key:"propagateSideLabels",value:function(C){for(var g=qe.NONE,x=this.iterator();x.hasNext();){var O=x.next().getLabel();O.isArea(C)&&O.getLocation(C,vn.LEFT)!==qe.NONE&&(g=O.getLocation(C,vn.LEFT))}if(g===qe.NONE)return null;for(var $=g,te=this.iterator();te.hasNext();){var he=te.next(),Te=he.getLabel();if(Te.getLocation(C,vn.ON)===qe.NONE&&Te.setLocation(C,vn.ON,$),Te.isArea(C)){var Be=Te.getLocation(C,vn.LEFT),et=Te.getLocation(C,vn.RIGHT);if(et!==qe.NONE){if(et!==$)throw new Ui("side location conflict",he.getCoordinate());Be===qe.NONE&&cn.shouldNeverReachHere("found single null side (at "+he.getCoordinate()+")"),$=Be}else cn.isTrue(Te.getLocation(C,vn.LEFT)===qe.NONE,"found single null side"),Te.setLocation(C,vn.RIGHT,$),Te.setLocation(C,vn.LEFT,$)}}}},{key:"getCoordinate",value:function(){var C=this.iterator();return C.hasNext()?C.next().getCoordinate():null}},{key:"print",value:function(C){_a.out.println("EdgeEndStar:   "+this.getCoordinate());for(var g=this.iterator();g.hasNext();)g.next().print(C)}},{key:"isAreaLabelsConsistent",value:function(C){return this.computeEdgeEndLabels(C.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}},{key:"checkAreaLabelsConsistent",value:function(C){var g=this.getEdges();if(g.size()<=0)return!0;var x=g.size()-1,O=g.get(x).getLabel().getLocation(C,vn.LEFT);cn.isTrue(O!==qe.NONE,"Found unlabelled area edge");for(var $=O,te=this.iterator();te.hasNext();){var he=te.next().getLabel();cn.isTrue(he.isArea(C),"Found non-area edge");var Te=he.getLocation(C,vn.LEFT),Be=he.getLocation(C,vn.RIGHT);if(Te===Be||Be!==$)return!1;$=Te}return!0}},{key:"findIndex",value:function(C){this.iterator();for(var g=0;g<this._edgeList.size();g++)if(this._edgeList.get(g)===C)return g;return-1}},{key:"iterator",value:function(){return this.getEdges().iterator()}},{key:"getEdges",value:function(){return this._edgeList===null&&(this._edgeList=new Er(this._edgeMap.values())),this._edgeList}},{key:"getLocation",value:function(C,g,x){return this._ptInAreaLocation[C]===qe.NONE&&(this._ptInAreaLocation[C]=vr.locate(g,x[C].getGeometry())),this._ptInAreaLocation[C]}},{key:"toString",value:function(){var C=new no;C.append("EdgeEndStar:   "+this.getCoordinate()),C.append(`
`);for(var g=this.iterator();g.hasNext();){var x=g.next();C.append(x),C.append(`
`)}return C.toString()}},{key:"computeEdgeEndLabels",value:function(C){for(var g=this.iterator();g.hasNext();)g.next().computeLabel(C)}},{key:"computeLabelling",value:function(C){this.computeEdgeEndLabels(C[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var g=[!1,!1],x=this.iterator();x.hasNext();)for(var O=x.next().getLabel(),$=0;$<2;$++)O.isLine($)&&O.getLocation($)===qe.BOUNDARY&&(g[$]=!0);for(var te=this.iterator();te.hasNext();)for(var he=te.next(),Te=he.getLabel(),Be=0;Be<2;Be++)if(Te.isAnyNull(Be)){var et=qe.NONE;if(g[Be])et=qe.EXTERIOR;else{var Dt=he.getCoordinate();et=this.getLocation(Be,Dt,C)}Te.setAllLocationsIfNull(Be,et)}}},{key:"getDegree",value:function(){return this._edgeMap.size()}},{key:"insertEdgeEnd",value:function(C,g){this._edgeMap.put(C,g),this._edgeList=null}}],[{key:"constructor_",value:function(){this._edgeMap=new ds,this._edgeList=null,this._ptInAreaLocation=[qe.NONE,qe.NONE]}}])}(),Fh=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,[{key:"linkResultDirectedEdges",value:function(){this.getResultAreaEdges();for(var x=null,O=null,$=this._SCANNING_FOR_INCOMING,te=0;te<this._resultAreaEdgeList.size();te++){var he=this._resultAreaEdgeList.get(te),Te=he.getSym();if(he.getLabel().isArea())switch(x===null&&he.isInResult()&&(x=he),$){case this._SCANNING_FOR_INCOMING:if(!Te.isInResult())continue;O=Te,$=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!he.isInResult())continue;O.setNext(he),$=this._SCANNING_FOR_INCOMING}}if($===this._LINKING_TO_OUTGOING){if(x===null)throw new Ui("no outgoing dirEdge found",this.getCoordinate());cn.isTrue(x.isInResult(),"unable to link last incoming dirEdge"),O.setNext(x)}}},{key:"insert",value:function(x){var O=x;this.insertEdgeEnd(O,O)}},{key:"getRightmostEdge",value:function(){var x=this.getEdges(),O=x.size();if(O<1)return null;var $=x.get(0);if(O===1)return $;var te=x.get(O-1),he=$.getQuadrant(),Te=te.getQuadrant();return Ta.isNorthern(he)&&Ta.isNorthern(Te)?$:Ta.isNorthern(he)||Ta.isNorthern(Te)?$.getDy()!==0?$:te.getDy()!==0?te:(cn.shouldNeverReachHere("found two horizontal edges incident on node"),null):te}},{key:"print",value:function(x){_a.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var O=this.iterator();O.hasNext();){var $=O.next();x.print("out "),$.print(x),x.println(),x.print("in "),$.getSym().print(x),x.println()}}},{key:"getResultAreaEdges",value:function(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Er;for(var x=this.iterator();x.hasNext();){var O=x.next();(O.isInResult()||O.getSym().isInResult())&&this._resultAreaEdgeList.add(O)}return this._resultAreaEdgeList}},{key:"updateLabelling",value:function(x){for(var O=this.iterator();O.hasNext();){var $=O.next().getLabel();$.setAllLocationsIfNull(0,x.getLocation(0)),$.setAllLocationsIfNull(1,x.getLocation(1))}}},{key:"linkAllDirectedEdges",value:function(){this.getEdges();for(var x=null,O=null,$=this._edgeList.size()-1;$>=0;$--){var te=this._edgeList.get($),he=te.getSym();O===null&&(O=he),x!==null&&he.setNext(x),x=te}O.setNext(x)}},{key:"computeDepths",value:function(){if(arguments.length===1){var x=arguments[0],O=this.findIndex(x),$=x.getDepth(vn.LEFT),te=x.getDepth(vn.RIGHT),he=this.computeDepths(O+1,this._edgeList.size(),$);if(this.computeDepths(0,O,he)!==te)throw new Ui("depth mismatch at "+x.getCoordinate())}else if(arguments.length===3){for(var Te=arguments[1],Be=arguments[2],et=arguments[0];et<Te;et++){var Dt=this._edgeList.get(et);Dt.setEdgeDepths(vn.RIGHT,Be),Be=Dt.getDepth(vn.LEFT)}return Be}}},{key:"mergeSymLabels",value:function(){for(var x=this.iterator();x.hasNext();){var O=x.next();O.getLabel().merge(O.getSym().getLabel())}}},{key:"linkMinimalDirectedEdges",value:function(x){for(var O=null,$=null,te=this._SCANNING_FOR_INCOMING,he=this._resultAreaEdgeList.size()-1;he>=0;he--){var Te=this._resultAreaEdgeList.get(he),Be=Te.getSym();switch(O===null&&Te.getEdgeRing()===x&&(O=Te),te){case this._SCANNING_FOR_INCOMING:if(Be.getEdgeRing()!==x)continue;$=Be,te=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(Te.getEdgeRing()!==x)continue;$.setNextMin(Te),te=this._SCANNING_FOR_INCOMING}}te===this._LINKING_TO_OUTGOING&&(cn.isTrue(O!==null,"found null for first outgoing dirEdge"),cn.isTrue(O.getEdgeRing()===x,"unable to link last incoming dirEdge"),$.setNextMin(O))}},{key:"getOutgoingDegree",value:function(){if(arguments.length===0){for(var x=0,O=this.iterator();O.hasNext();)O.next().isInResult()&&x++;return x}if(arguments.length===1){for(var $=arguments[0],te=0,he=this.iterator();he.hasNext();)he.next().getEdgeRing()===$&&te++;return te}}},{key:"getLabel",value:function(){return this._label}},{key:"findCoveredLineEdges",value:function(){for(var x=qe.NONE,O=this.iterator();O.hasNext();){var $=O.next(),te=$.getSym();if(!$.isLineEdge()){if($.isInResult()){x=qe.INTERIOR;break}if(te.isInResult()){x=qe.EXTERIOR;break}}}if(x===qe.NONE)return null;for(var he=x,Te=this.iterator();Te.hasNext();){var Be=Te.next(),et=Be.getSym();Be.isLineEdge()?Be.getEdge().setCovered(he===qe.INTERIOR):(Be.isInResult()&&(he=qe.EXTERIOR),et.isInResult()&&(he=qe.INTERIOR))}}},{key:"computeLabelling",value:function(x){ie(g,"computeLabelling",this,1).call(this,x),this._label=new Ya(qe.NONE);for(var O=this.iterator();O.hasNext();)for(var $=O.next().getEdge().getLabel(),te=0;te<2;te++){var he=$.getLocation(te);he!==qe.INTERIOR&&he!==qe.BOUNDARY||this._label.setLocation(te,qe.INTERIOR)}}}],[{key:"constructor_",value:function(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}}])}(qn),Qn=function(C){function g(){return c(this,g),o(this,g)}return V(g,C),i(g,[{key:"createNode",value:function(x){return new Lo(x,new Fh)}}])}(Ou),tu=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"compareTo",value:function(g){var x=g;return C.compareOriented(this._pts,this._orientation,x._pts,x._orientation)}},{key:"interfaces_",get:function(){return[Oe]}}],[{key:"constructor_",value:function(){this._pts=null,this._orientation=null;var g=arguments[0];this._pts=g,this._orientation=C.orientation(g)}},{key:"orientation",value:function(g){return Ct.increasingDirection(g)===1}},{key:"compareOriented",value:function(g,x,O,$){for(var te=x?1:-1,he=$?1:-1,Te=x?g.length:-1,Be=$?O.length:-1,et=x?0:g.length-1,Dt=$?0:O.length-1;;){var Ht=g[et].compareTo(O[Dt]);if(Ht!==0)return Ht;var bn=(et+=te)===Te,Hn=(Dt+=he)===Be;if(bn&&!Hn)return-1;if(!bn&&Hn)return 1;if(bn&&Hn)return 0}}}])}(),nu=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"print",value:function(C){C.print("MULTILINESTRING ( ");for(var g=0;g<this._edges.size();g++){var x=this._edges.get(g);g>0&&C.print(","),C.print("(");for(var O=x.getCoordinates(),$=0;$<O.length;$++)$>0&&C.print(","),C.print(O[$].x+" "+O[$].y);C.println(")")}C.print(")  ")}},{key:"addAll",value:function(C){for(var g=C.iterator();g.hasNext();)this.add(g.next())}},{key:"findEdgeIndex",value:function(C){for(var g=0;g<this._edges.size();g++)if(this._edges.get(g).equals(C))return g;return-1}},{key:"iterator",value:function(){return this._edges.iterator()}},{key:"getEdges",value:function(){return this._edges}},{key:"get",value:function(C){return this._edges.get(C)}},{key:"findEqualEdge",value:function(C){var g=new tu(C.getCoordinates());return this._ocaMap.get(g)}},{key:"add",value:function(C){this._edges.add(C);var g=new tu(C.getCoordinates());this._ocaMap.put(g,C)}}],[{key:"constructor_",value:function(){this._edges=new Er,this._ocaMap=new ds}}])}(),Wn=function(){return i(function C(){c(this,C)},[{key:"processIntersections",value:function(C,g,x,O){}},{key:"isDone",value:function(){}}])}(),sc=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"isTrivialIntersection",value:function(g,x,O,$){if(g===O&&this._li.getIntersectionNum()===1){if(C.isAdjacentSegments(x,$))return!0;if(g.isClosed()){var te=g.size()-1;if(x===0&&$===te||$===0&&x===te)return!0}}return!1}},{key:"getProperIntersectionPoint",value:function(){return this._properIntersectionPoint}},{key:"hasProperInteriorIntersection",value:function(){return this._hasProperInterior}},{key:"getLineIntersector",value:function(){return this._li}},{key:"hasProperIntersection",value:function(){return this._hasProper}},{key:"processIntersections",value:function(g,x,O,$){if(g===O&&x===$)return null;this.numTests++;var te=g.getCoordinates()[x],he=g.getCoordinates()[x+1],Te=O.getCoordinates()[$],Be=O.getCoordinates()[$+1];this._li.computeIntersection(te,he,Te,Be),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(g,x,O,$)||(this._hasIntersection=!0,g.addIntersections(this._li,x,0),O.addIntersections(this._li,$,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}},{key:"hasIntersection",value:function(){return this._hasIntersection}},{key:"isDone",value:function(){return!1}},{key:"hasInteriorIntersection",value:function(){return this._hasInterior}},{key:"interfaces_",get:function(){return[Wn]}}],[{key:"constructor_",value:function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var g=arguments[0];this._li=g}},{key:"isAdjacentSegments",value:function(g,x){return Math.abs(g-x)===1}}])}(),ol=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"getSegmentIndex",value:function(){return this.segmentIndex}},{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(C){C.print(this.coord),C.print(" seg # = "+this.segmentIndex),C.println(" dist = "+this.dist)}},{key:"compareTo",value:function(C){var g=C;return this.compare(g.segmentIndex,g.dist)}},{key:"isEndPoint",value:function(C){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===C}},{key:"toString",value:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}},{key:"getDistance",value:function(){return this.dist}},{key:"compare",value:function(C,g){return this.segmentIndex<C?-1:this.segmentIndex>C?1:this.dist<g?-1:this.dist>g?1:0}},{key:"interfaces_",get:function(){return[Oe]}}],[{key:"constructor_",value:function(){this.coord=null,this.segmentIndex=null,this.dist=null;var C=arguments[0],g=arguments[1],x=arguments[2];this.coord=new Et(C),this.segmentIndex=g,this.dist=x}}])}(),jh=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"print",value:function(C){C.println("Intersections:");for(var g=this.iterator();g.hasNext();)g.next().print(C)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(C){this.addEndpoints();for(var g=this.iterator(),x=g.next();g.hasNext();){var O=g.next(),$=this.createSplitEdge(x,O);C.add($),x=O}}},{key:"addEndpoints",value:function(){var C=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[C],C,0)}},{key:"createSplitEdge",value:function(C,g){var x=g.segmentIndex-C.segmentIndex+2,O=this.edge.pts[g.segmentIndex],$=g.dist>0||!g.coord.equals2D(O);$||x--;var te=new Array(x).fill(null),he=0;te[he++]=new Et(C.coord);for(var Te=C.segmentIndex+1;Te<=g.segmentIndex;Te++)te[he++]=this.edge.pts[Te];return $&&(te[he]=g.coord),new lc(te,new Ya(this.edge._label))}},{key:"add",value:function(C,g,x){var O=new ol(C,g,x),$=this._nodeMap.get(O);return $!==null?$:(this._nodeMap.put(O,O),O)}},{key:"isIntersection",value:function(C){for(var g=this.iterator();g.hasNext();)if(g.next().coord.equals(C))return!0;return!1}}],[{key:"constructor_",value:function(){this._nodeMap=new ds,this.edge=null;var C=arguments[0];this.edge=C}}])}(),Jc=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"isIntersects",value:function(){return!this.isDisjoint()}},{key:"isCovers",value:function(){return(C.isTrue(this._matrix[qe.INTERIOR][qe.INTERIOR])||C.isTrue(this._matrix[qe.INTERIOR][qe.BOUNDARY])||C.isTrue(this._matrix[qe.BOUNDARY][qe.INTERIOR])||C.isTrue(this._matrix[qe.BOUNDARY][qe.BOUNDARY]))&&this._matrix[qe.EXTERIOR][qe.INTERIOR]===Bn.FALSE&&this._matrix[qe.EXTERIOR][qe.BOUNDARY]===Bn.FALSE}},{key:"isCoveredBy",value:function(){return(C.isTrue(this._matrix[qe.INTERIOR][qe.INTERIOR])||C.isTrue(this._matrix[qe.INTERIOR][qe.BOUNDARY])||C.isTrue(this._matrix[qe.BOUNDARY][qe.INTERIOR])||C.isTrue(this._matrix[qe.BOUNDARY][qe.BOUNDARY]))&&this._matrix[qe.INTERIOR][qe.EXTERIOR]===Bn.FALSE&&this._matrix[qe.BOUNDARY][qe.EXTERIOR]===Bn.FALSE}},{key:"set",value:function(){if(arguments.length===1)for(var g=arguments[0],x=0;x<g.length;x++){var O=Math.trunc(x/3),$=x%3;this._matrix[O][$]=Bn.toDimensionValue(g.charAt(x))}else if(arguments.length===3){var te=arguments[0],he=arguments[1],Te=arguments[2];this._matrix[te][he]=Te}}},{key:"isContains",value:function(){return C.isTrue(this._matrix[qe.INTERIOR][qe.INTERIOR])&&this._matrix[qe.EXTERIOR][qe.INTERIOR]===Bn.FALSE&&this._matrix[qe.EXTERIOR][qe.BOUNDARY]===Bn.FALSE}},{key:"setAtLeast",value:function(){if(arguments.length===1)for(var g=arguments[0],x=0;x<g.length;x++){var O=Math.trunc(x/3),$=x%3;this.setAtLeast(O,$,Bn.toDimensionValue(g.charAt(x)))}else if(arguments.length===3){var te=arguments[0],he=arguments[1],Te=arguments[2];this._matrix[te][he]<Te&&(this._matrix[te][he]=Te)}}},{key:"setAtLeastIfValid",value:function(g,x,O){g>=0&&x>=0&&this.setAtLeast(g,x,O)}},{key:"isWithin",value:function(){return C.isTrue(this._matrix[qe.INTERIOR][qe.INTERIOR])&&this._matrix[qe.INTERIOR][qe.EXTERIOR]===Bn.FALSE&&this._matrix[qe.BOUNDARY][qe.EXTERIOR]===Bn.FALSE}},{key:"isTouches",value:function(g,x){return g>x?this.isTouches(x,g):(g===Bn.A&&x===Bn.A||g===Bn.L&&x===Bn.L||g===Bn.L&&x===Bn.A||g===Bn.P&&x===Bn.A||g===Bn.P&&x===Bn.L)&&this._matrix[qe.INTERIOR][qe.INTERIOR]===Bn.FALSE&&(C.isTrue(this._matrix[qe.INTERIOR][qe.BOUNDARY])||C.isTrue(this._matrix[qe.BOUNDARY][qe.INTERIOR])||C.isTrue(this._matrix[qe.BOUNDARY][qe.BOUNDARY]))}},{key:"isOverlaps",value:function(g,x){return g===Bn.P&&x===Bn.P||g===Bn.A&&x===Bn.A?C.isTrue(this._matrix[qe.INTERIOR][qe.INTERIOR])&&C.isTrue(this._matrix[qe.INTERIOR][qe.EXTERIOR])&&C.isTrue(this._matrix[qe.EXTERIOR][qe.INTERIOR]):g===Bn.L&&x===Bn.L&&this._matrix[qe.INTERIOR][qe.INTERIOR]===1&&C.isTrue(this._matrix[qe.INTERIOR][qe.EXTERIOR])&&C.isTrue(this._matrix[qe.EXTERIOR][qe.INTERIOR])}},{key:"isEquals",value:function(g,x){return g===x&&C.isTrue(this._matrix[qe.INTERIOR][qe.INTERIOR])&&this._matrix[qe.INTERIOR][qe.EXTERIOR]===Bn.FALSE&&this._matrix[qe.BOUNDARY][qe.EXTERIOR]===Bn.FALSE&&this._matrix[qe.EXTERIOR][qe.INTERIOR]===Bn.FALSE&&this._matrix[qe.EXTERIOR][qe.BOUNDARY]===Bn.FALSE}},{key:"toString",value:function(){for(var g=new Rn("123456789"),x=0;x<3;x++)for(var O=0;O<3;O++)g.setCharAt(3*x+O,Bn.toDimensionSymbol(this._matrix[x][O]));return g.toString()}},{key:"setAll",value:function(g){for(var x=0;x<3;x++)for(var O=0;O<3;O++)this._matrix[x][O]=g}},{key:"get",value:function(g,x){return this._matrix[g][x]}},{key:"transpose",value:function(){var g=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=g,g=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=g,g=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=g,this}},{key:"matches",value:function(g){if(g.length!==9)throw new me("Should be length 9: "+g);for(var x=0;x<3;x++)for(var O=0;O<3;O++)if(!C.matches(this._matrix[x][O],g.charAt(3*x+O)))return!1;return!0}},{key:"add",value:function(g){for(var x=0;x<3;x++)for(var O=0;O<3;O++)this.setAtLeast(x,O,g.get(x,O))}},{key:"isDisjoint",value:function(){return this._matrix[qe.INTERIOR][qe.INTERIOR]===Bn.FALSE&&this._matrix[qe.INTERIOR][qe.BOUNDARY]===Bn.FALSE&&this._matrix[qe.BOUNDARY][qe.INTERIOR]===Bn.FALSE&&this._matrix[qe.BOUNDARY][qe.BOUNDARY]===Bn.FALSE}},{key:"isCrosses",value:function(g,x){return g===Bn.P&&x===Bn.L||g===Bn.P&&x===Bn.A||g===Bn.L&&x===Bn.A?C.isTrue(this._matrix[qe.INTERIOR][qe.INTERIOR])&&C.isTrue(this._matrix[qe.INTERIOR][qe.EXTERIOR]):g===Bn.L&&x===Bn.P||g===Bn.A&&x===Bn.P||g===Bn.A&&x===Bn.L?C.isTrue(this._matrix[qe.INTERIOR][qe.INTERIOR])&&C.isTrue(this._matrix[qe.EXTERIOR][qe.INTERIOR]):g===Bn.L&&x===Bn.L&&this._matrix[qe.INTERIOR][qe.INTERIOR]===0}},{key:"interfaces_",get:function(){return[Ye]}}],[{key:"constructor_",value:function(){if(this._matrix=null,arguments.length===0)this._matrix=Array(3).fill().map(function(){return Array(3)}),this.setAll(Bn.FALSE);else if(arguments.length===1){if(typeof arguments[0]=="string"){var g=arguments[0];C.constructor_.call(this),this.set(g)}else if(arguments[0]instanceof C){var x=arguments[0];C.constructor_.call(this),this._matrix[qe.INTERIOR][qe.INTERIOR]=x._matrix[qe.INTERIOR][qe.INTERIOR],this._matrix[qe.INTERIOR][qe.BOUNDARY]=x._matrix[qe.INTERIOR][qe.BOUNDARY],this._matrix[qe.INTERIOR][qe.EXTERIOR]=x._matrix[qe.INTERIOR][qe.EXTERIOR],this._matrix[qe.BOUNDARY][qe.INTERIOR]=x._matrix[qe.BOUNDARY][qe.INTERIOR],this._matrix[qe.BOUNDARY][qe.BOUNDARY]=x._matrix[qe.BOUNDARY][qe.BOUNDARY],this._matrix[qe.BOUNDARY][qe.EXTERIOR]=x._matrix[qe.BOUNDARY][qe.EXTERIOR],this._matrix[qe.EXTERIOR][qe.INTERIOR]=x._matrix[qe.EXTERIOR][qe.INTERIOR],this._matrix[qe.EXTERIOR][qe.BOUNDARY]=x._matrix[qe.EXTERIOR][qe.BOUNDARY],this._matrix[qe.EXTERIOR][qe.EXTERIOR]=x._matrix[qe.EXTERIOR][qe.EXTERIOR]}}}},{key:"matches",value:function(){if(Number.isInteger(arguments[0])&&typeof arguments[1]=="string"){var g=arguments[0],x=arguments[1];return x===Bn.SYM_DONTCARE||x===Bn.SYM_TRUE&&(g>=0||g===Bn.TRUE)||x===Bn.SYM_FALSE&&g===Bn.FALSE||x===Bn.SYM_P&&g===Bn.P||x===Bn.SYM_L&&g===Bn.L||x===Bn.SYM_A&&g===Bn.A}if(typeof arguments[0]=="string"&&typeof arguments[1]=="string"){var O=arguments[1];return new C(arguments[0]).matches(O)}}},{key:"isTrue",value:function(g){return g>=0||g===Bn.TRUE}}])}(),io=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"size",value:function(){return this._size}},{key:"addAll",value:function(g){return g===null||g.length===0?null:(this.ensureCapacity(this._size+g.length),_a.arraycopy(g,0,this._data,this._size,g.length),void(this._size+=g.length))}},{key:"ensureCapacity",value:function(g){if(g<=this._data.length)return null;var x=Math.max(g,2*this._data.length);this._data=ea.copyOf(this._data,x)}},{key:"toArray",value:function(){var g=new Array(this._size).fill(null);return _a.arraycopy(this._data,0,g,0,this._size),g}},{key:"add",value:function(g){this.ensureCapacity(this._size+1),this._data[this._size]=g,++this._size}}],[{key:"constructor_",value:function(){if(this._data=null,this._size=0,arguments.length===0)C.constructor_.call(this,10);else if(arguments.length===1){var g=arguments[0];this._data=new Array(g).fill(null)}}}])}(),Ma=function(){function C(){c(this,C)}return i(C,[{key:"getChainStartIndices",value:function(g){var x=0,O=new io(Math.trunc(g.length/2));O.add(x);do{var $=this.findChainEnd(g,x);O.add($),x=$}while(x<g.length-1);return O.toArray()}},{key:"findChainEnd",value:function(g,x){for(var O=Ta.quadrant(g[x],g[x+1]),$=x+1;$<g.length&&Ta.quadrant(g[$-1],g[$])===O;)$++;return $-1}},{key:"OLDgetChainStartIndices",value:function(g){var x=0,O=new Er;O.add(x);do{var $=this.findChainEnd(g,x);O.add($),x=$}while(x<g.length-1);return C.toIntArray(O)}}],[{key:"toIntArray",value:function(g){for(var x=new Array(g.size()).fill(null),O=0;O<x.length;O++)x[O]=g.get(O).intValue();return x}}])}(),pn=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"getCoordinates",value:function(){return this.pts}},{key:"getMaxX",value:function(C){var g=this.pts[this.startIndex[C]].x,x=this.pts[this.startIndex[C+1]].x;return g>x?g:x}},{key:"getMinX",value:function(C){var g=this.pts[this.startIndex[C]].x,x=this.pts[this.startIndex[C+1]].x;return g<x?g:x}},{key:"computeIntersectsForChain",value:function(){if(arguments.length===4){var C=arguments[0],g=arguments[1],x=arguments[2],O=arguments[3];this.computeIntersectsForChain(this.startIndex[C],this.startIndex[C+1],g,g.startIndex[x],g.startIndex[x+1],O)}else if(arguments.length===6){var $=arguments[0],te=arguments[1],he=arguments[2],Te=arguments[3],Be=arguments[4],et=arguments[5];if(te-$==1&&Be-Te==1)return et.addIntersections(this.e,$,he.e,Te),null;if(!this.overlaps($,te,he,Te,Be))return null;var Dt=Math.trunc(($+te)/2),Ht=Math.trunc((Te+Be)/2);$<Dt&&(Te<Ht&&this.computeIntersectsForChain($,Dt,he,Te,Ht,et),Ht<Be&&this.computeIntersectsForChain($,Dt,he,Ht,Be,et)),Dt<te&&(Te<Ht&&this.computeIntersectsForChain(Dt,te,he,Te,Ht,et),Ht<Be&&this.computeIntersectsForChain(Dt,te,he,Ht,Be,et))}}},{key:"overlaps",value:function(C,g,x,O,$){return Ne.intersects(this.pts[C],this.pts[g],x.pts[O],x.pts[$])}},{key:"getStartIndexes",value:function(){return this.startIndex}},{key:"computeIntersects",value:function(C,g){for(var x=0;x<this.startIndex.length-1;x++)for(var O=0;O<C.startIndex.length-1;O++)this.computeIntersectsForChain(x,C,O,g)}}],[{key:"constructor_",value:function(){this.e=null,this.pts=null,this.startIndex=null;var C=arguments[0];this.e=C,this.pts=C.getCoordinates();var g=new Ma;this.startIndex=g.getChainStartIndices(this.pts)}}])}(),Qc=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"getDepth",value:function(g,x){return this._depth[g][x]}},{key:"setDepth",value:function(g,x,O){this._depth[g][x]=O}},{key:"isNull",value:function(){if(arguments.length===0){for(var g=0;g<2;g++)for(var x=0;x<3;x++)if(this._depth[g][x]!==C.NULL_VALUE)return!1;return!0}if(arguments.length===1){var O=arguments[0];return this._depth[O][1]===C.NULL_VALUE}if(arguments.length===2){var $=arguments[0],te=arguments[1];return this._depth[$][te]===C.NULL_VALUE}}},{key:"normalize",value:function(){for(var g=0;g<2;g++)if(!this.isNull(g)){var x=this._depth[g][1];this._depth[g][2]<x&&(x=this._depth[g][2]),x<0&&(x=0);for(var O=1;O<3;O++){var $=0;this._depth[g][O]>x&&($=1),this._depth[g][O]=$}}}},{key:"getDelta",value:function(g){return this._depth[g][vn.RIGHT]-this._depth[g][vn.LEFT]}},{key:"getLocation",value:function(g,x){return this._depth[g][x]<=0?qe.EXTERIOR:qe.INTERIOR}},{key:"toString",value:function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}},{key:"add",value:function(){if(arguments.length===1)for(var g=arguments[0],x=0;x<2;x++)for(var O=1;O<3;O++){var $=g.getLocation(x,O);$!==qe.EXTERIOR&&$!==qe.INTERIOR||(this.isNull(x,O)?this._depth[x][O]=C.depthAtLocation($):this._depth[x][O]+=C.depthAtLocation($))}else if(arguments.length===3){var te=arguments[0],he=arguments[1];arguments[2]===qe.INTERIOR&&this._depth[te][he]++}}}],[{key:"constructor_",value:function(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var g=0;g<2;g++)for(var x=0;x<3;x++)this._depth[g][x]=C.NULL_VALUE}},{key:"depthAtLocation",value:function(g){return g===qe.EXTERIOR?0:g===qe.INTERIOR?1:C.NULL_VALUE}}])}();Qc.NULL_VALUE=-1;var lc=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,[{key:"getDepth",value:function(){return this._depth}},{key:"getCollapsedEdge",value:function(){var x=new Array(2).fill(null);return x[0]=this.pts[0],x[1]=this.pts[1],new g(x,Ya.toLineLabel(this._label))}},{key:"isIsolated",value:function(){return this._isIsolated}},{key:"getCoordinates",value:function(){return this.pts}},{key:"setIsolated",value:function(x){this._isIsolated=x}},{key:"setName",value:function(x){this._name=x}},{key:"equals",value:function(x){if(!(x instanceof g))return!1;var O=x;if(this.pts.length!==O.pts.length)return!1;for(var $=!0,te=!0,he=this.pts.length,Te=0;Te<this.pts.length;Te++)if(this.pts[Te].equals2D(O.pts[Te])||($=!1),this.pts[Te].equals2D(O.pts[--he])||(te=!1),!$&&!te)return!1;return!0}},{key:"getCoordinate",value:function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var x=arguments[0];return this.pts[x]}}},{key:"print",value:function(x){x.print("edge "+this._name+": "),x.print("LINESTRING (");for(var O=0;O<this.pts.length;O++)O>0&&x.print(","),x.print(this.pts[O].x+" "+this.pts[O].y);x.print(")  "+this._label+" "+this._depthDelta)}},{key:"computeIM",value:function(x){g.updateIM(this._label,x)}},{key:"isCollapsed",value:function(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])}},{key:"isClosed",value:function(){return this.pts[0].equals(this.pts[this.pts.length-1])}},{key:"getMaximumSegmentIndex",value:function(){return this.pts.length-1}},{key:"getDepthDelta",value:function(){return this._depthDelta}},{key:"getNumPoints",value:function(){return this.pts.length}},{key:"printReverse",value:function(x){x.print("edge "+this._name+": ");for(var O=this.pts.length-1;O>=0;O--)x.print(this.pts[O]+" ");x.println("")}},{key:"getMonotoneChainEdge",value:function(){return this._mce===null&&(this._mce=new pn(this)),this._mce}},{key:"getEnvelope",value:function(){if(this._env===null){this._env=new Ne;for(var x=0;x<this.pts.length;x++)this._env.expandToInclude(this.pts[x])}return this._env}},{key:"addIntersection",value:function(x,O,$,te){var he=new Et(x.getIntersection(te)),Te=O,Be=x.getEdgeDistance($,te),et=Te+1;if(et<this.pts.length){var Dt=this.pts[et];he.equals2D(Dt)&&(Te=et,Be=0)}this.eiList.add(he,Te,Be)}},{key:"toString",value:function(){var x=new Rn;x.append("edge "+this._name+": "),x.append("LINESTRING (");for(var O=0;O<this.pts.length;O++)O>0&&x.append(","),x.append(this.pts[O].x+" "+this.pts[O].y);return x.append(")  "+this._label+" "+this._depthDelta),x.toString()}},{key:"isPointwiseEqual",value:function(x){if(this.pts.length!==x.pts.length)return!1;for(var O=0;O<this.pts.length;O++)if(!this.pts[O].equals2D(x.pts[O]))return!1;return!0}},{key:"setDepthDelta",value:function(x){this._depthDelta=x}},{key:"getEdgeIntersectionList",value:function(){return this.eiList}},{key:"addIntersections",value:function(x,O,$){for(var te=0;te<x.getIntersectionNum();te++)this.addIntersection(x,O,$,te)}}],[{key:"constructor_",value:function(){if(this.pts=null,this._env=null,this.eiList=new jh(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Qc,this._depthDelta=0,arguments.length===1){var x=arguments[0];g.constructor_.call(this,x,null)}else if(arguments.length===2){var O=arguments[0],$=arguments[1];this.pts=O,this._label=$}}},{key:"updateIM",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Jc&&arguments[0]instanceof Ya))return ie(g,"updateIM",this).apply(this,arguments);var x=arguments[0],O=arguments[1];O.setAtLeastIfValid(x.getLocation(0,vn.ON),x.getLocation(1,vn.ON),1),x.isArea()&&(O.setAtLeastIfValid(x.getLocation(0,vn.LEFT),x.getLocation(1,vn.LEFT),2),O.setAtLeastIfValid(x.getLocation(0,vn.RIGHT),x.getLocation(1,vn.RIGHT),2))}}])}(rc),uc=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"setWorkingPrecisionModel",value:function(g){this._workingPrecisionModel=g}},{key:"insertUniqueEdge",value:function(g){var x=this._edgeList.findEqualEdge(g);if(x!==null){var O=x.getLabel(),$=g.getLabel();x.isPointwiseEqual(g)||($=new Ya(g.getLabel())).flip(),O.merge($);var te=C.depthDelta($),he=x.getDepthDelta()+te;x.setDepthDelta(he)}else this._edgeList.add(g),g.setDepthDelta(C.depthDelta(g.getLabel()))}},{key:"buildSubgraphs",value:function(g,x){for(var O=new Er,$=g.iterator();$.hasNext();){var te=$.next(),he=te.getRightmostCoordinate(),Te=new Ko(O).getDepth(he);te.computeDepth(Te),te.findResultEdges(),O.add(te),x.add(te.getDirectedEdges(),te.getNodes())}}},{key:"createSubgraphs",value:function(g){for(var x=new Er,O=g.getNodes().iterator();O.hasNext();){var $=O.next();if(!$.isVisited()){var te=new za;te.create($),x.add(te)}}return la.sort(x,la.reverseOrder()),x}},{key:"createEmptyResultGeometry",value:function(){return this._geomFact.createPolygon()}},{key:"getNoder",value:function(g){if(this._workingNoder!==null)return this._workingNoder;var x=new Zf,O=new Xa;return O.setPrecisionModel(g),x.setSegmentIntersector(new sc(O)),x}},{key:"buffer",value:function(g,x){var O=this._workingPrecisionModel;O===null&&(O=g.getPrecisionModel()),this._geomFact=g.getFactory();var $=new Us(O,this._bufParams),te=new ap(g,x,$).getCurves();if(te.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(te,O),this._graph=new Ea(new Qn),this._graph.addEdges(this._edgeList.getEdges());var he=this.createSubgraphs(this._graph),Te=new zh(this._geomFact);this.buildSubgraphs(he,Te);var Be=Te.getPolygons();return Be.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(Be)}},{key:"computeNodedEdges",value:function(g,x){var O=this.getNoder(x);O.computeNodes(g);for(var $=O.getNodedSubstrings().iterator();$.hasNext();){var te=$.next(),he=te.getCoordinates();if(he.length!==2||!he[0].equals2D(he[1])){var Te=te.getData(),Be=new lc(te.getCoordinates(),new Ya(Te));this.insertUniqueEdge(Be)}}}},{key:"setNoder",value:function(g){this._workingNoder=g}}],[{key:"constructor_",value:function(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new nu;var g=arguments[0];this._bufParams=g}},{key:"depthDelta",value:function(g){var x=g.getLocation(0,vn.LEFT),O=g.getLocation(0,vn.RIGHT);return x===qe.INTERIOR&&O===qe.EXTERIOR?1:x===qe.EXTERIOR&&O===qe.INTERIOR?-1:0}},{key:"convertSegStrings",value:function(g){for(var x=new Pi,O=new Er;g.hasNext();){var $=g.next(),te=x.createLineString($.getCoordinates());O.add(te)}return x.buildGeometry(O)}}])}(),ru=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"rescale",value:function(){if(Mn(arguments[0],jr))for(var g=arguments[0].iterator();g.hasNext();){var x=g.next();this.rescale(x.getCoordinates())}else if(arguments[0]instanceof Array){for(var O=arguments[0],$=0;$<O.length;$++)O[$].x=O[$].x/this._scaleFactor+this._offsetX,O[$].y=O[$].y/this._scaleFactor+this._offsetY;O.length===2&&O[0].equals2D(O[1])&&_a.out.println(O)}}},{key:"scale",value:function(){if(Mn(arguments[0],jr)){for(var g=arguments[0],x=new Er(g.size()),O=g.iterator();O.hasNext();){var $=O.next();x.add(new Cl(this.scale($.getCoordinates()),$.getData()))}return x}if(arguments[0]instanceof Array){for(var te=arguments[0],he=new Array(te.length).fill(null),Te=0;Te<te.length;Te++)he[Te]=new Et(Math.round((te[Te].x-this._offsetX)*this._scaleFactor),Math.round((te[Te].y-this._offsetY)*this._scaleFactor),te[Te].getZ());return Ct.removeRepeatedPoints(he)}}},{key:"isIntegerPrecision",value:function(){return this._scaleFactor===1}},{key:"getNodedSubstrings",value:function(){var g=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(g),g}},{key:"computeNodes",value:function(g){var x=g;this._isScaled&&(x=this.scale(g)),this._noder.computeNodes(x)}},{key:"interfaces_",get:function(){return[Iu]}}],[{key:"constructor_",value:function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var g=arguments[0],x=arguments[1];C.constructor_.call(this,g,x,0,0)}else if(arguments.length===4){var O=arguments[0],$=arguments[1];this._noder=O,this._scaleFactor=$,this._isScaled=!this.isIntegerPrecision()}}}])}(),Oa=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"checkEndPtVertexIntersections",value:function(){if(arguments.length===0)for(var g=this._segStrings.iterator();g.hasNext();){var x=g.next().getCoordinates();this.checkEndPtVertexIntersections(x[0],this._segStrings),this.checkEndPtVertexIntersections(x[x.length-1],this._segStrings)}else if(arguments.length===2){for(var O=arguments[0],$=arguments[1].iterator();$.hasNext();)for(var te=$.next().getCoordinates(),he=1;he<te.length-1;he++)if(te[he].equals(O))throw new an("found endpt/interior pt intersection at index "+he+" :pt "+O)}}},{key:"checkInteriorIntersections",value:function(){if(arguments.length===0)for(var g=this._segStrings.iterator();g.hasNext();)for(var x=g.next(),O=this._segStrings.iterator();O.hasNext();){var $=O.next();this.checkInteriorIntersections(x,$)}else if(arguments.length===2)for(var te=arguments[0],he=arguments[1],Te=te.getCoordinates(),Be=he.getCoordinates(),et=0;et<Te.length-1;et++)for(var Dt=0;Dt<Be.length-1;Dt++)this.checkInteriorIntersections(te,et,he,Dt);else if(arguments.length===4){var Ht=arguments[0],bn=arguments[1],Hn=arguments[2],sr=arguments[3];if(Ht===Hn&&bn===sr)return null;var xr=Ht.getCoordinates()[bn],Jr=Ht.getCoordinates()[bn+1],Qr=Hn.getCoordinates()[sr],xi=Hn.getCoordinates()[sr+1];if(this._li.computeIntersection(xr,Jr,Qr,xi),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,xr,Jr)||this.hasInteriorIntersection(this._li,Qr,xi)))throw new an("found non-noded intersection at "+xr+"-"+Jr+" and "+Qr+"-"+xi)}}},{key:"checkValid",value:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}},{key:"checkCollapses",value:function(){if(arguments.length===0)for(var g=this._segStrings.iterator();g.hasNext();){var x=g.next();this.checkCollapses(x)}else if(arguments.length===1)for(var O=arguments[0].getCoordinates(),$=0;$<O.length-2;$++)this.checkCollapse(O[$],O[$+1],O[$+2])}},{key:"hasInteriorIntersection",value:function(g,x,O){for(var $=0;$<g.getIntersectionNum();$++){var te=g.getIntersection($);if(!te.equals(x)&&!te.equals(O))return!0}return!1}},{key:"checkCollapse",value:function(g,x,O){if(g.equals(O))throw new an("found non-noded collapse at "+C.fact.createLineString([g,x,O]))}}],[{key:"constructor_",value:function(){this._li=new Xa,this._segStrings=null;var g=arguments[0];this._segStrings=g}}])}();Oa.fact=new Pi;var Vs=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"intersectsScaled",value:function(g,x){var O=Math.min(g.x,x.x),$=Math.max(g.x,x.x),te=Math.min(g.y,x.y),he=Math.max(g.y,x.y),Te=this._maxx<O||this._minx>$||this._maxy<te||this._miny>he;if(Te)return!1;var Be=this.intersectsToleranceSquare(g,x);return cn.isTrue(!(Te&&Be),"Found bad envelope test"),Be}},{key:"initCorners",value:function(g){var x=.5;this._minx=g.x-x,this._maxx=g.x+x,this._miny=g.y-x,this._maxy=g.y+x,this._corner[0]=new Et(this._maxx,this._maxy),this._corner[1]=new Et(this._minx,this._maxy),this._corner[2]=new Et(this._minx,this._miny),this._corner[3]=new Et(this._maxx,this._miny)}},{key:"intersects",value:function(g,x){return this._scaleFactor===1?this.intersectsScaled(g,x):(this.copyScaled(g,this._p0Scaled),this.copyScaled(x,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}},{key:"scale",value:function(g){return Math.round(g*this._scaleFactor)}},{key:"getCoordinate",value:function(){return this._originalPt}},{key:"copyScaled",value:function(g,x){x.x=this.scale(g.x),x.y=this.scale(g.y)}},{key:"getSafeEnvelope",value:function(){if(this._safeEnv===null){var g=C.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Ne(this._originalPt.x-g,this._originalPt.x+g,this._originalPt.y-g,this._originalPt.y+g)}return this._safeEnv}},{key:"intersectsPixelClosure",value:function(g,x){return this._li.computeIntersection(g,x,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(g,x,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(g,x,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(g,x,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))}},{key:"intersectsToleranceSquare",value:function(g,x){var O=!1,$=!1;return this._li.computeIntersection(g,x,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(g,x,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(O=!0),this._li.computeIntersection(g,x,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&($=!0),this._li.computeIntersection(g,x,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!O||!$)||!!g.equals(this._pt)||!!x.equals(this._pt))))}},{key:"addSnappedNode",value:function(g,x){var O=g.getCoordinate(x),$=g.getCoordinate(x+1);return!!this.intersects(O,$)&&(g.addIntersection(this.getCoordinate(),x),!0)}}],[{key:"constructor_",value:function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var g=arguments[0],x=arguments[1],O=arguments[2];if(this._originalPt=g,this._pt=g,this._scaleFactor=x,this._li=O,x<=0)throw new me("Scale factor must be non-zero");x!==1&&(this._pt=new Et(this.scale(g.x),this.scale(g.y)),this._p0Scaled=new Et,this._p1Scaled=new Et),this.initCorners(this._pt)}}])}();Vs.SAFE_ENV_EXPANSION_FACTOR=.75;var Kf=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"select",value:function(){if(arguments.length!==1){if(arguments.length===2){var C=arguments[1];arguments[0].getLineSegment(C,this.selectedSegment),this.select(this.selectedSegment)}}}}],[{key:"constructor_",value:function(){this.selectedSegment=new qi}}])}(),Ia=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"snap",value:function(){if(arguments.length===1){var C=arguments[0];return this.snap(C,null,-1)}if(arguments.length===3){var g=arguments[0],x=arguments[1],O=arguments[2],$=g.getSafeEnvelope(),te=new gs(g,x,O);return this._index.query($,new(function(){return i(function he(){c(this,he)},[{key:"interfaces_",get:function(){return[Oi]}},{key:"visitItem",value:function(he){he.select($,te)}}])}())),te.isNodeAdded()}}}],[{key:"constructor_",value:function(){this._index=null;var C=arguments[0];this._index=C}}])}(),gs=function(C){function g(){var x;return c(this,g),x=o(this,g),g.constructor_.apply(x,arguments),x}return V(g,C),i(g,[{key:"isNodeAdded",value:function(){return this._isNodeAdded}},{key:"select",value:function(){if(!(arguments.length===2&&Number.isInteger(arguments[1])&&arguments[0]instanceof ac))return ie(g,"select",this,1).apply(this,arguments);var x=arguments[1],O=arguments[0].getContext();if(this._parentEdge===O&&(x===this._hotPixelVertexIndex||x+1===this._hotPixelVertexIndex))return null;this._isNodeAdded|=this._hotPixel.addSnappedNode(O,x)}}],[{key:"constructor_",value:function(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var x=arguments[0],O=arguments[1],$=arguments[2];this._hotPixel=x,this._parentEdge=O,this._hotPixelVertexIndex=$}}])}(Kf);Ia.HotPixelSnapAction=gs;var iu=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"processIntersections",value:function(C,g,x,O){if(C===x&&g===O)return null;var $=C.getCoordinates()[g],te=C.getCoordinates()[g+1],he=x.getCoordinates()[O],Te=x.getCoordinates()[O+1];if(this._li.computeIntersection($,te,he,Te),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var Be=0;Be<this._li.getIntersectionNum();Be++)this._interiorIntersections.add(this._li.getIntersection(Be));C.addIntersections(this._li,g,0),x.addIntersections(this._li,O,1)}}},{key:"isDone",value:function(){return!1}},{key:"getInteriorIntersections",value:function(){return this._interiorIntersections}},{key:"interfaces_",get:function(){return[Wn]}}],[{key:"constructor_",value:function(){this._li=null,this._interiorIntersections=null;var C=arguments[0];this._li=C,this._interiorIntersections=new Er}}])}(),Uh=function(){return i(function C(){c(this,C),C.constructor_.apply(this,arguments)},[{key:"checkCorrectness",value:function(C){var g=Cl.getNodedSubstrings(C),x=new Oa(g);try{x.checkValid()}catch(O){if(!(O instanceof Ee))throw O;O.printStackTrace()}}},{key:"getNodedSubstrings",value:function(){return Cl.getNodedSubstrings(this._nodedSegStrings)}},{key:"snapRound",value:function(C,g){var x=this.findInteriorIntersections(C,g);this.computeIntersectionSnaps(x),this.computeVertexSnaps(C)}},{key:"findInteriorIntersections",value:function(C,g){var x=new iu(g);return this._noder.setSegmentIntersector(x),this._noder.computeNodes(C),x.getInteriorIntersections()}},{key:"computeVertexSnaps",value:function(){if(Mn(arguments[0],jr))for(var C=arguments[0].iterator();C.hasNext();){var g=C.next();this.computeVertexSnaps(g)}else if(arguments[0]instanceof Cl)for(var x=arguments[0],O=x.getCoordinates(),$=0;$<O.length;$++){var te=new Vs(O[$],this._scaleFactor,this._li);this._pointSnapper.snap(te,x,$)&&x.addIntersection(O[$],$)}}},{key:"computeNodes",value:function(C){this._nodedSegStrings=C,this._noder=new Zf,this._pointSnapper=new Ia(this._noder.getIndex()),this.snapRound(C,this._li)}},{key:"computeIntersectionSnaps",value:function(C){for(var g=C.iterator();g.hasNext();){var x=g.next(),O=new Vs(x,this._scaleFactor,this._li);this._pointSnapper.snap(O)}}},{key:"interfaces_",get:function(){return[Iu]}}],[{key:"constructor_",value:function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var C=arguments[0];this._pm=C,this._li=new Xa,this._li.setPrecisionModel(C),this._scaleFactor=C.getScale()}}])}(),Pu=function(){function C(){c(this,C),C.constructor_.apply(this,arguments)}return i(C,[{key:"bufferFixedPrecision",value:function(g){var x=new ru(new Uh(new or(1)),g.getScale()),O=new uc(this._bufParams);O.setWorkingPrecisionModel(g),O.setNoder(x),this._resultGeometry=O.buffer(this._argGeom,this._distance)}},{key:"bufferReducedPrecision",value:function(){if(arguments.length===0){for(var g=C.MAX_PRECISION_DIGITS;g>=0;g--){try{this.bufferReducedPrecision(g)}catch(te){if(!(te instanceof Ui))throw te;this._saveException=te}if(this._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){var x=arguments[0],O=C.precisionScaleFactor(this._argGeom,this._distance,x),$=new or(O);this.bufferFixedPrecision($)}}},{key:"computeGeometry",value:function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var g=this._argGeom.getFactory().getPrecisionModel();g.getType()===or.FIXED?this.bufferFixedPrecision(g):this.bufferReducedPrecision()}},{key:"setQuadrantSegments",value:function(g){this._bufParams.setQuadrantSegments(g)}},{key:"bufferOriginalPrecision",value:function(){try{var g=new uc(this._bufParams);this._resultGeometry=g.buffer(this._argGeom,this._distance)}catch(x){if(!(x instanceof an))throw x;this._saveException=x}}},{key:"getResultGeometry",value:function(g){return this._distance=g,this.computeGeometry(),this._resultGeometry}},{key:"setEndCapStyle",value:function(g){this._bufParams.setEndCapStyle(g)}}],[{key:"constructor_",value:function(){if(this._argGeom=null,this._distance=null,this._bufParams=new ve,this._resultGeometry=null,this._saveException=null,arguments.length===1){var g=arguments[0];this._argGeom=g}else if(arguments.length===2){var x=arguments[0],O=arguments[1];this._argGeom=x,this._bufParams=O}}},{key:"bufferOp",value:function(){if(arguments.length===2){var g=arguments[1];return new C(arguments[0]).getResultGeometry(g)}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof An&&typeof arguments[1]=="number"){var x=arguments[1],O=arguments[2],$=new C(arguments[0]);return $.setQuadrantSegments(O),$.getResultGeometry(x)}if(arguments[2]instanceof ve&&arguments[0]instanceof An&&typeof arguments[1]=="number"){var te=arguments[1];return new C(arguments[0],arguments[2]).getResultGeometry(te)}}else if(arguments.length===4){var he=arguments[1],Te=arguments[2],Be=arguments[3],et=new C(arguments[0]);return et.setQuadrantSegments(Te),et.setEndCapStyle(Be),et.getResultGeometry(he)}}},{key:"precisionScaleFactor",value:function(g,x,O){var $=g.getEnvelopeInternal(),te=Kl.max(Math.abs($.getMaxX()),Math.abs($.getMaxY()),Math.abs($.getMinX()),Math.abs($.getMinY()))+2*(x>0?x:0),he=O-Math.trunc(Math.log(te)/Math.log(10)+1);return Math.pow(10,he)}}])}();Pu.CAP_ROUND=ve.CAP_ROUND,Pu.CAP_BUTT=ve.CAP_FLAT,Pu.CAP_FLAT=ve.CAP_FLAT,Pu.CAP_SQUARE=ve.CAP_SQUARE,Pu.MAX_PRECISION_DIGITS=12;var Vh=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],qh=function(){return i(function C(g){c(this,C),this.geometryFactory=g||new Pi},[{key:"read",value:function(C){var g,x=(g=typeof C=="string"?JSON.parse(C):C).type;if(!Jo[x])throw new Error("Unknown GeoJSON type: "+g.type);return Vh.indexOf(x)!==-1?Jo[x].call(this,g.coordinates):x==="GeometryCollection"?Jo[x].call(this,g.geometries):Jo[x].call(this,g)}},{key:"write",value:function(C){var g=C.getGeometryType();if(!ys[g])throw new Error("Geometry is not supported");return ys[g].call(this,C)}}])}(),Jo={Feature:function(C){var g={};for(var x in C)g[x]=C[x];if(C.geometry){var O=C.geometry.type;if(!Jo[O])throw new Error("Unknown GeoJSON type: "+C.type);g.geometry=this.read(C.geometry)}return C.bbox&&(g.bbox=Jo.bbox.call(this,C.bbox)),g},FeatureCollection:function(C){var g={};if(C.features){g.features=[];for(var x=0;x<C.features.length;++x)g.features.push(this.read(C.features[x]))}return C.bbox&&(g.bbox=this.parse.bbox.call(this,C.bbox)),g},coordinates:function(C){for(var g=[],x=0;x<C.length;++x){var O=C[x];g.push(b(Et,le(O)))}return g},bbox:function(C){return this.geometryFactory.createLinearRing([new Et(C[0],C[1]),new Et(C[2],C[1]),new Et(C[2],C[3]),new Et(C[0],C[3]),new Et(C[0],C[1])])},Point:function(C){var g=b(Et,le(C));return this.geometryFactory.createPoint(g)},MultiPoint:function(C){for(var g=[],x=0;x<C.length;++x)g.push(Jo.Point.call(this,C[x]));return this.geometryFactory.createMultiPoint(g)},LineString:function(C){var g=Jo.coordinates.call(this,C);return this.geometryFactory.createLineString(g)},MultiLineString:function(C){for(var g=[],x=0;x<C.length;++x)g.push(Jo.LineString.call(this,C[x]));return this.geometryFactory.createMultiLineString(g)},Polygon:function(C){for(var g=Jo.coordinates.call(this,C[0]),x=this.geometryFactory.createLinearRing(g),O=[],$=1;$<C.length;++$){var te=C[$],he=Jo.coordinates.call(this,te),Te=this.geometryFactory.createLinearRing(he);O.push(Te)}return this.geometryFactory.createPolygon(x,O)},MultiPolygon:function(C){for(var g=[],x=0;x<C.length;++x){var O=C[x];g.push(Jo.Polygon.call(this,O))}return this.geometryFactory.createMultiPolygon(g)},GeometryCollection:function(C){for(var g=[],x=0;x<C.length;++x){var O=C[x];g.push(this.read(O))}return this.geometryFactory.createGeometryCollection(g)}},ys={coordinate:function(C){var g=[C.x,C.y];return C.z&&g.push(C.z),C.m&&g.push(C.m),g},Point:function(C){return{type:"Point",coordinates:ys.coordinate.call(this,C.getCoordinate())}},MultiPoint:function(C){for(var g=[],x=0;x<C._geometries.length;++x){var O=C._geometries[x],$=ys.Point.call(this,O);g.push($.coordinates)}return{type:"MultiPoint",coordinates:g}},LineString:function(C){for(var g=[],x=C.getCoordinates(),O=0;O<x.length;++O){var $=x[O];g.push(ys.coordinate.call(this,$))}return{type:"LineString",coordinates:g}},MultiLineString:function(C){for(var g=[],x=0;x<C._geometries.length;++x){var O=C._geometries[x],$=ys.LineString.call(this,O);g.push($.coordinates)}return{type:"MultiLineString",coordinates:g}},Polygon:function(C){var g=[],x=ys.LineString.call(this,C._shell);g.push(x.coordinates);for(var O=0;O<C._holes.length;++O){var $=C._holes[O],te=ys.LineString.call(this,$);g.push(te.coordinates)}return{type:"Polygon",coordinates:g}},MultiPolygon:function(C){for(var g=[],x=0;x<C._geometries.length;++x){var O=C._geometries[x],$=ys.Polygon.call(this,O);g.push($.coordinates)}return{type:"MultiPolygon",coordinates:g}},GeometryCollection:function(C){for(var g=[],x=0;x<C._geometries.length;++x){var O=C._geometries[x],$=O.getGeometryType();g.push(ys[$].call(this,O))}return{type:"GeometryCollection",geometries:g}}};return{BufferOp:Pu,GeoJSONReader:function(){return i(function C(g){c(this,C),this.parser=new qh(g||new Pi)},[{key:"read",value:function(C){return this.parser.read(C)}}])}(),GeoJSONWriter:function(){return i(function C(){c(this,C),this.parser=new qh(this.geometryFactory)},[{key:"write",value:function(C){return this.parser.write(C)}}])}()}})}(wb)),wb.exports}var Nme=zme();const Bme=fa(Nme);function mm(){return new Rw}function Rw(){this.reset()}Rw.prototype={constructor:Rw,reset:function(){this.s=this.t=0},add:function(e){bj(lb,e,this.t),bj(this,lb.s,this.s),this.s?this.t+=lb.t:this.s=lb.t},valueOf:function(){return this.s}};var lb=new Rw;function bj(e,t,a){var o=e.s=t+a,c=o-t,b=o-c;e.t=t-b+(a-c)}var eo=1e-6,Ki=Math.PI,Lf=Ki/2,wj=Ki/4,Vf=Ki*2,Zp=180/Ki,qc=Ki/180,Ps=Math.abs,Fme=Math.atan,I_=Math.atan2,ho=Math.cos,fo=Math.sin,$_=Math.sqrt;function b7(e){return e>1?0:e<-1?Ki:Math.acos(e)}function Mg(e){return e>1?Lf:e<-1?-Lf:Math.asin(e)}function c0(){}function kw(e,t){e&&Tj.hasOwnProperty(e.type)&&Tj[e.type](e,t)}var Sj={Feature:function(e,t){kw(e.geometry,t)},FeatureCollection:function(e,t){for(var a=e.features,o=-1,c=a.length;++o<c;)kw(a[o].geometry,t)}},Tj={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var a=e.coordinates,o=-1,c=a.length;++o<c;)e=a[o],t.point(e[0],e[1],e[2])},LineString:function(e,t){pC(e.coordinates,t,0)},MultiLineString:function(e,t){for(var a=e.coordinates,o=-1,c=a.length;++o<c;)pC(a[o],t,0)},Polygon:function(e,t){Ej(e.coordinates,t)},MultiPolygon:function(e,t){for(var a=e.coordinates,o=-1,c=a.length;++o<c;)Ej(a[o],t)},GeometryCollection:function(e,t){for(var a=e.geometries,o=-1,c=a.length;++o<c;)kw(a[o],t)}};function pC(e,t,a){var o=-1,c=e.length-a,b;for(t.lineStart();++o<c;)b=e[o],t.point(b[0],b[1],b[2]);t.lineEnd()}function Ej(e,t){var a=-1,o=e.length;for(t.polygonStart();++a<o;)pC(e[a],t,1);t.polygonEnd()}function jme(e,t){e&&Sj.hasOwnProperty(e.type)?Sj[e.type](e,t):kw(e,t)}mm();mm();function mC(e){return[I_(e[1],e[0]),Mg(e[2])]}function C_(e){var t=e[0],a=e[1],o=ho(a);return[o*ho(t),o*fo(t),fo(a)]}function ub(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Dw(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function cO(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function cb(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function gC(e){var t=$_(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}mm();function w7(e,t){function a(o,c){return o=e(o,c),t(o[0],o[1])}return e.invert&&t.invert&&(a.invert=function(o,c){return o=t.invert(o,c),o&&e.invert(o[0],o[1])}),a}function yC(e,t){return[e>Ki?e-Vf:e<-Ki?e+Vf:e,t]}yC.invert=yC;function Ume(e,t,a){return(e%=Vf)?t||a?w7(Mj(e),Oj(t,a)):Mj(e):t||a?Oj(t,a):yC}function Aj(e){return function(t,a){return t+=e,[t>Ki?t-Vf:t<-Ki?t+Vf:t,a]}}function Mj(e){var t=Aj(e);return t.invert=Aj(-e),t}function Oj(e,t){var a=ho(e),o=fo(e),c=ho(t),b=fo(t);function S(i,P){var L=ho(P),U=ho(i)*L,V=fo(i)*L,H=fo(P),ee=H*a+U*o;return[I_(V*c-ee*b,U*a-H*o),Mg(ee*c+V*b)]}return S.invert=function(i,P){var L=ho(P),U=ho(i)*L,V=fo(i)*L,H=fo(P),ee=H*c-V*b;return[I_(V*c+H*b,U*a+ee*o),Mg(ee*a-U*o)]},S}function Vme(e,t,a,o,c,b){if(a){var S=ho(t),i=fo(t),P=o*a;c==null?(c=t+o*Vf,b=t-P/2):(c=Ij(S,c),b=Ij(S,b),(o>0?c<b:c>b)&&(c+=o*Vf));for(var L,U=c;o>0?U>b:U<b;U-=P)L=mC([S,-i*ho(U),-i*fo(U)]),e.point(L[0],L[1])}}function Ij(e,t){t=C_(t),t[0]-=e,gC(t);var a=b7(-t[1]);return((-t[2]<0?-a:a)+Vf-eo)%Vf}function S7(){var e=[],t;return{point:function(a,o){t.push([a,o])},lineStart:function(){e.push(t=[])},lineEnd:c0,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var a=e;return e=[],t=null,a}}}function qme(e,t,a,o,c,b){var S=e[0],i=e[1],P=t[0],L=t[1],U=0,V=1,H=P-S,ee=L-i,ie;if(ie=a-S,!(!H&&ie>0)){if(ie/=H,H<0){if(ie<U)return;ie<V&&(V=ie)}else if(H>0){if(ie>V)return;ie>U&&(U=ie)}if(ie=c-S,!(!H&&ie<0)){if(ie/=H,H<0){if(ie>V)return;ie>U&&(U=ie)}else if(H>0){if(ie<U)return;ie<V&&(V=ie)}if(ie=o-i,!(!ee&&ie>0)){if(ie/=ee,ee<0){if(ie<U)return;ie<V&&(V=ie)}else if(ee>0){if(ie>V)return;ie>U&&(U=ie)}if(ie=b-i,!(!ee&&ie<0)){if(ie/=ee,ee<0){if(ie>V)return;ie>U&&(U=ie)}else if(ee>0){if(ie<U)return;ie<V&&(V=ie)}return U>0&&(e[0]=S+U*H,e[1]=i+U*ee),V<1&&(t[0]=S+V*H,t[1]=i+V*ee),!0}}}}}function Sb(e,t){return Ps(e[0]-t[0])<eo&&Ps(e[1]-t[1])<eo}function hb(e,t,a,o){this.x=e,this.z=t,this.o=a,this.e=o,this.v=!1,this.n=this.p=null}function T7(e,t,a,o,c){var b=[],S=[],i,P;if(e.forEach(function(ie){if(!((le=ie.length-1)<=0)){var le,ue=ie[0],ge=ie[le],Se;if(Sb(ue,ge)){for(c.lineStart(),i=0;i<le;++i)c.point((ue=ie[i])[0],ue[1]);c.lineEnd();return}b.push(Se=new hb(ue,ie,null,!0)),S.push(Se.o=new hb(ue,null,Se,!1)),b.push(Se=new hb(ge,ie,null,!1)),S.push(Se.o=new hb(ge,null,Se,!0))}}),!!b.length){for(S.sort(t),Cj(b),Cj(S),i=0,P=S.length;i<P;++i)S[i].e=a=!a;for(var L=b[0],U,V;;){for(var H=L,ee=!0;H.v;)if((H=H.n)===L)return;U=H.z,c.lineStart();do{if(H.v=H.o.v=!0,H.e){if(ee)for(i=0,P=U.length;i<P;++i)c.point((V=U[i])[0],V[1]);else o(H.x,H.n.x,1,c);H=H.n}else{if(ee)for(U=H.p.z,i=U.length-1;i>=0;--i)c.point((V=U[i])[0],V[1]);else o(H.x,H.p.x,-1,c);H=H.p}H=H.o,U=H.z,ee=!ee}while(!H.v);c.lineEnd()}}}function Cj(e){if(t=e.length){for(var t,a=0,o=e[0],c;++a<t;)o.n=c=e[a],c.p=o,o=c;o.n=c=e[0],c.p=o}}function E7(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Gme(e){return e.length===1&&(e=$me(e)),{left:function(t,a,o,c){for(o==null&&(o=0),c==null&&(c=t.length);o<c;){var b=o+c>>>1;e(t[b],a)<0?o=b+1:c=b}return o},right:function(t,a,o,c){for(o==null&&(o=0),c==null&&(c=t.length);o<c;){var b=o+c>>>1;e(t[b],a)>0?c=b:o=b+1}return o}}}function $me(e){return function(t,a){return E7(e(t),a)}}Gme(E7);function A7(e){for(var t=e.length,a,o=-1,c=0,b,S;++o<t;)c+=e[o].length;for(b=new Array(c);--t>=0;)for(S=e[t],a=S.length;--a>=0;)b[--c]=S[a];return b}var fb=1e9,db=-1e9;function Hme(e,t,a,o){function c(L,U){return e<=L&&L<=a&&t<=U&&U<=o}function b(L,U,V,H){var ee=0,ie=0;if(L==null||(ee=S(L,V))!==(ie=S(U,V))||P(L,U)<0^V>0)do H.point(ee===0||ee===3?e:a,ee>1?o:t);while((ee=(ee+V+4)%4)!==ie);else H.point(U[0],U[1])}function S(L,U){return Ps(L[0]-e)<eo?U>0?0:3:Ps(L[0]-a)<eo?U>0?2:1:Ps(L[1]-t)<eo?U>0?1:0:U>0?3:2}function i(L,U){return P(L.x,U.x)}function P(L,U){var V=S(L,1),H=S(U,1);return V!==H?V-H:V===0?U[1]-L[1]:V===1?L[0]-U[0]:V===2?L[1]-U[1]:U[0]-L[0]}return function(L){var U=L,V=S7(),H,ee,ie,le,ue,ge,Se,ve,Ee,me,Ae,Oe={point:Ye,lineStart:Ot,lineEnd:Bt,polygonStart:st,polygonEnd:Ke};function Ye(mt,bt){c(mt,bt)&&U.point(mt,bt)}function He(){for(var mt=0,bt=0,Ft=ee.length;bt<Ft;++bt)for(var Zt=ee[bt],Vt=1,Ze=Zt.length,Xt=Zt[0],an,qt,cn=Xt[0],rr=Xt[1];Vt<Ze;++Vt)an=cn,qt=rr,Xt=Zt[Vt],cn=Xt[0],rr=Xt[1],qt<=o?rr>o&&(cn-an)*(o-qt)>(rr-qt)*(e-an)&&++mt:rr<=o&&(cn-an)*(o-qt)<(rr-qt)*(e-an)&&--mt;return mt}function st(){U=V,H=[],ee=[],Ae=!0}function Ke(){var mt=He(),bt=Ae&&mt,Ft=(H=A7(H)).length;(bt||Ft)&&(L.polygonStart(),bt&&(L.lineStart(),b(null,null,1,L),L.lineEnd()),Ft&&T7(H,i,mt,b,L),L.polygonEnd()),U=L,H=ee=ie=null}function Ot(){Oe.point=Tt,ee&&ee.push(ie=[]),me=!0,Ee=!1,Se=ve=NaN}function Bt(){H&&(Tt(le,ue),ge&&Ee&&V.rejoin(),H.push(V.result())),Oe.point=Ye,Ee&&U.lineEnd()}function Tt(mt,bt){var Ft=c(mt,bt);if(ee&&ie.push([mt,bt]),me)le=mt,ue=bt,ge=Ft,me=!1,Ft&&(U.lineStart(),U.point(mt,bt));else if(Ft&&Ee)U.point(mt,bt);else{var Zt=[Se=Math.max(db,Math.min(fb,Se)),ve=Math.max(db,Math.min(fb,ve))],Vt=[mt=Math.max(db,Math.min(fb,mt)),bt=Math.max(db,Math.min(fb,bt))];qme(Zt,Vt,e,t,a,o)?(Ee||(U.lineStart(),U.point(Zt[0],Zt[1])),U.point(Vt[0],Vt[1]),Ft||U.lineEnd(),Ae=!1):Ft&&(U.lineStart(),U.point(mt,bt),Ae=!1)}Se=mt,ve=bt,Ee=Ft}return Oe}}var hO=mm();function Xme(e,t){var a=t[0],o=t[1],c=[fo(a),-ho(a),0],b=0,S=0;hO.reset();for(var i=0,P=e.length;i<P;++i)if(U=(L=e[i]).length)for(var L,U,V=L[U-1],H=V[0],ee=V[1]/2+wj,ie=fo(ee),le=ho(ee),ue=0;ue<U;++ue,H=Se,ie=Ee,le=me,V=ge){var ge=L[ue],Se=ge[0],ve=ge[1]/2+wj,Ee=fo(ve),me=ho(ve),Ae=Se-H,Oe=Ae>=0?1:-1,Ye=Oe*Ae,He=Ye>Ki,st=ie*Ee;if(hO.add(I_(st*Oe*fo(Ye),le*me+st*ho(Ye))),b+=He?Ae+Oe*Vf:Ae,He^H>=a^Se>=a){var Ke=Dw(C_(V),C_(ge));gC(Ke);var Ot=Dw(c,Ke);gC(Ot);var Bt=(He^Ae>=0?-1:1)*Mg(Ot[2]);(o>Bt||o===Bt&&(Ke[0]||Ke[1]))&&(S+=He^Ae>=0?1:-1)}}return(b<-1e-6||b<eo&&hO<-1e-6)^S&1}mm();function Pj(e){return e}mm();mm();var P_=1/0,Lw=P_,gx=-P_,zw=gx,Rj={point:Yme,lineStart:c0,lineEnd:c0,polygonStart:c0,polygonEnd:c0,result:function(){var e=[[P_,Lw],[gx,zw]];return gx=zw=-(Lw=P_=1/0),e}};function Yme(e,t){e<P_&&(P_=e),e>gx&&(gx=e),t<Lw&&(Lw=t),t>zw&&(zw=t)}mm();function M7(e,t,a,o){return function(c,b){var S=t(b),i=c.invert(o[0],o[1]),P=S7(),L=t(P),U=!1,V,H,ee,ie={point:le,lineStart:ge,lineEnd:Se,polygonStart:function(){ie.point=ve,ie.lineStart=Ee,ie.lineEnd=me,H=[],V=[]},polygonEnd:function(){ie.point=le,ie.lineStart=ge,ie.lineEnd=Se,H=A7(H);var Ae=Xme(V,i);H.length?(U||(b.polygonStart(),U=!0),T7(H,Wme,Ae,a,b)):Ae&&(U||(b.polygonStart(),U=!0),b.lineStart(),a(null,null,1,b),b.lineEnd()),U&&(b.polygonEnd(),U=!1),H=V=null},sphere:function(){b.polygonStart(),b.lineStart(),a(null,null,1,b),b.lineEnd(),b.polygonEnd()}};function le(Ae,Oe){var Ye=c(Ae,Oe);e(Ae=Ye[0],Oe=Ye[1])&&b.point(Ae,Oe)}function ue(Ae,Oe){var Ye=c(Ae,Oe);S.point(Ye[0],Ye[1])}function ge(){ie.point=ue,S.lineStart()}function Se(){ie.point=le,S.lineEnd()}function ve(Ae,Oe){ee.push([Ae,Oe]);var Ye=c(Ae,Oe);L.point(Ye[0],Ye[1])}function Ee(){L.lineStart(),ee=[]}function me(){ve(ee[0][0],ee[0][1]),L.lineEnd();var Ae=L.clean(),Oe=P.result(),Ye,He=Oe.length,st,Ke,Ot;if(ee.pop(),V.push(ee),ee=null,!!He){if(Ae&1){if(Ke=Oe[0],(st=Ke.length-1)>0){for(U||(b.polygonStart(),U=!0),b.lineStart(),Ye=0;Ye<st;++Ye)b.point((Ot=Ke[Ye])[0],Ot[1]);b.lineEnd()}return}He>1&&Ae&2&&Oe.push(Oe.pop().concat(Oe.shift())),H.push(Oe.filter(Zme))}}return ie}}function Zme(e){return e.length>1}function Wme(e,t){return((e=e.x)[0]<0?e[1]-Lf-eo:Lf-e[1])-((t=t.x)[0]<0?t[1]-Lf-eo:Lf-t[1])}const kj=M7(function(){return!0},Kme,Qme,[-Ki,-Lf]);function Kme(e){var t=NaN,a=NaN,o=NaN,c;return{lineStart:function(){e.lineStart(),c=1},point:function(b,S){var i=b>0?Ki:-Ki,P=Ps(b-t);Ps(P-Ki)<eo?(e.point(t,a=(a+S)/2>0?Lf:-Lf),e.point(o,a),e.lineEnd(),e.lineStart(),e.point(i,a),e.point(b,a),c=0):o!==i&&P>=Ki&&(Ps(t-o)<eo&&(t-=o*eo),Ps(b-i)<eo&&(b-=i*eo),a=Jme(t,a,b,S),e.point(o,a),e.lineEnd(),e.lineStart(),e.point(i,a),c=0),e.point(t=b,a=S),o=i},lineEnd:function(){e.lineEnd(),t=a=NaN},clean:function(){return 2-c}}}function Jme(e,t,a,o){var c,b,S=fo(e-a);return Ps(S)>eo?Fme((fo(t)*(b=ho(o))*fo(a)-fo(o)*(c=ho(t))*fo(e))/(c*b*S)):(t+o)/2}function Qme(e,t,a,o){var c;if(e==null)c=a*Lf,o.point(-Ki,c),o.point(0,c),o.point(Ki,c),o.point(Ki,0),o.point(Ki,-c),o.point(0,-c),o.point(-Ki,-c),o.point(-Ki,0),o.point(-Ki,c);else if(Ps(e[0]-t[0])>eo){var b=e[0]<t[0]?Ki:-Ki;c=a*b/2,o.point(-b,c),o.point(0,c),o.point(b,c)}else o.point(t[0],t[1])}function ege(e,t){var a=ho(e),o=a>0,c=Ps(a)>eo;function b(U,V,H,ee){Vme(ee,e,t,H,U,V)}function S(U,V){return ho(U)*ho(V)>a}function i(U){var V,H,ee,ie,le;return{lineStart:function(){ie=ee=!1,le=1},point:function(ue,ge){var Se=[ue,ge],ve,Ee=S(ue,ge),me=o?Ee?0:L(ue,ge):Ee?L(ue+(ue<0?Ki:-Ki),ge):0;if(!V&&(ie=ee=Ee)&&U.lineStart(),Ee!==ee&&(ve=P(V,Se),(!ve||Sb(V,ve)||Sb(Se,ve))&&(Se[0]+=eo,Se[1]+=eo,Ee=S(Se[0],Se[1]))),Ee!==ee)le=0,Ee?(U.lineStart(),ve=P(Se,V),U.point(ve[0],ve[1])):(ve=P(V,Se),U.point(ve[0],ve[1]),U.lineEnd()),V=ve;else if(c&&V&&o^Ee){var Ae;!(me&H)&&(Ae=P(Se,V,!0))&&(le=0,o?(U.lineStart(),U.point(Ae[0][0],Ae[0][1]),U.point(Ae[1][0],Ae[1][1]),U.lineEnd()):(U.point(Ae[1][0],Ae[1][1]),U.lineEnd(),U.lineStart(),U.point(Ae[0][0],Ae[0][1])))}Ee&&(!V||!Sb(V,Se))&&U.point(Se[0],Se[1]),V=Se,ee=Ee,H=me},lineEnd:function(){ee&&U.lineEnd(),V=null},clean:function(){return le|(ie&&ee)<<1}}}function P(U,V,H){var ee=C_(U),ie=C_(V),le=[1,0,0],ue=Dw(ee,ie),ge=ub(ue,ue),Se=ue[0],ve=ge-Se*Se;if(!ve)return!H&&U;var Ee=a*ge/ve,me=-a*Se/ve,Ae=Dw(le,ue),Oe=cb(le,Ee),Ye=cb(ue,me);cO(Oe,Ye);var He=Ae,st=ub(Oe,He),Ke=ub(He,He),Ot=st*st-Ke*(ub(Oe,Oe)-1);if(!(Ot<0)){var Bt=$_(Ot),Tt=cb(He,(-st-Bt)/Ke);if(cO(Tt,Oe),Tt=mC(Tt),!H)return Tt;var mt=U[0],bt=V[0],Ft=U[1],Zt=V[1],Vt;bt<mt&&(Vt=mt,mt=bt,bt=Vt);var Ze=bt-mt,Xt=Ps(Ze-Ki)<eo,an=Xt||Ze<eo;if(!Xt&&Zt<Ft&&(Vt=Ft,Ft=Zt,Zt=Vt),an?Xt?Ft+Zt>0^Tt[1]<(Ps(Tt[0]-mt)<eo?Ft:Zt):Ft<=Tt[1]&&Tt[1]<=Zt:Ze>Ki^(mt<=Tt[0]&&Tt[0]<=bt)){var qt=cb(He,(-st+Bt)/Ke);return cO(qt,Oe),[Tt,mC(qt)]}}}function L(U,V){var H=o?e:Ki-e,ee=0;return U<-H?ee|=1:U>H&&(ee|=2),V<-H?ee|=4:V>H&&(ee|=8),ee}return M7(S,i,b,o?[0,-e]:[-Ki,e-Ki])}function O7(e){return function(t){var a=new _C;for(var o in e)a[o]=e[o];return a.stream=t,a}}function _C(){}_C.prototype={constructor:_C,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function I7(e,t,a){var o=t[1][0]-t[0][0],c=t[1][1]-t[0][1],b=e.clipExtent&&e.clipExtent();e.scale(150).translate([0,0]),b!=null&&e.clipExtent(null),jme(a,e.stream(Rj));var S=Rj.result(),i=Math.min(o/(S[1][0]-S[0][0]),c/(S[1][1]-S[0][1])),P=+t[0][0]+(o-i*(S[1][0]+S[0][0]))/2,L=+t[0][1]+(c-i*(S[1][1]+S[0][1]))/2;return b!=null&&e.clipExtent(b),e.scale(i*150).translate([P,L])}function tge(e,t,a){return I7(e,[[0,0],t],a)}var Dj=16,nge=ho(30*qc);function Lj(e,t){return+t?ige(e,t):rge(e)}function rge(e){return O7({point:function(t,a){t=e(t,a),this.stream.point(t[0],t[1])}})}function ige(e,t){function a(o,c,b,S,i,P,L,U,V,H,ee,ie,le,ue){var ge=L-o,Se=U-c,ve=ge*ge+Se*Se;if(ve>4*t&&le--){var Ee=S+H,me=i+ee,Ae=P+ie,Oe=$_(Ee*Ee+me*me+Ae*Ae),Ye=Mg(Ae/=Oe),He=Ps(Ps(Ae)-1)<eo||Ps(b-V)<eo?(b+V)/2:I_(me,Ee),st=e(He,Ye),Ke=st[0],Ot=st[1],Bt=Ke-o,Tt=Ot-c,mt=Se*Bt-ge*Tt;(mt*mt/ve>t||Ps((ge*Bt+Se*Tt)/ve-.5)>.3||S*H+i*ee+P*ie<nge)&&(a(o,c,b,S,i,P,Ke,Ot,He,Ee/=Oe,me/=Oe,Ae,le,ue),ue.point(Ke,Ot),a(Ke,Ot,He,Ee,me,Ae,L,U,V,H,ee,ie,le,ue))}}return function(o){var c,b,S,i,P,L,U,V,H,ee,ie,le,ue={point:ge,lineStart:Se,lineEnd:Ee,polygonStart:function(){o.polygonStart(),ue.lineStart=me},polygonEnd:function(){o.polygonEnd(),ue.lineStart=Se}};function ge(Ye,He){Ye=e(Ye,He),o.point(Ye[0],Ye[1])}function Se(){V=NaN,ue.point=ve,o.lineStart()}function ve(Ye,He){var st=C_([Ye,He]),Ke=e(Ye,He);a(V,H,U,ee,ie,le,V=Ke[0],H=Ke[1],U=Ye,ee=st[0],ie=st[1],le=st[2],Dj,o),o.point(V,H)}function Ee(){ue.point=ge,o.lineEnd()}function me(){Se(),ue.point=Ae,ue.lineEnd=Oe}function Ae(Ye,He){ve(c=Ye,He),b=V,S=H,i=ee,P=ie,L=le,ue.point=ve}function Oe(){a(V,H,U,ee,ie,le,b,S,c,i,P,L,Dj,o),ue.lineEnd=Ee,Ee()}return ue}}var age=O7({point:function(e,t){this.stream.point(e*qc,t*qc)}});function oge(e){return sge(function(){return e})()}function sge(e){var t,a=150,o=480,c=250,b,S,i=0,P=0,L=0,U=0,V=0,H,ee,ie=null,le=kj,ue=null,ge,Se,ve,Ee=Pj,me=.5,Ae=Lj(Ke,me),Oe,Ye;function He(Tt){return Tt=ee(Tt[0]*qc,Tt[1]*qc),[Tt[0]*a+b,S-Tt[1]*a]}function st(Tt){return Tt=ee.invert((Tt[0]-b)/a,(S-Tt[1])/a),Tt&&[Tt[0]*Zp,Tt[1]*Zp]}function Ke(Tt,mt){return Tt=t(Tt,mt),[Tt[0]*a+b,S-Tt[1]*a]}He.stream=function(Tt){return Oe&&Ye===Tt?Oe:Oe=age(le(H,Ae(Ee(Ye=Tt))))},He.clipAngle=function(Tt){return arguments.length?(le=+Tt?ege(ie=Tt*qc,6*qc):(ie=null,kj),Bt()):ie*Zp},He.clipExtent=function(Tt){return arguments.length?(Ee=Tt==null?(ue=ge=Se=ve=null,Pj):Hme(ue=+Tt[0][0],ge=+Tt[0][1],Se=+Tt[1][0],ve=+Tt[1][1]),Bt()):ue==null?null:[[ue,ge],[Se,ve]]},He.scale=function(Tt){return arguments.length?(a=+Tt,Ot()):a},He.translate=function(Tt){return arguments.length?(o=+Tt[0],c=+Tt[1],Ot()):[o,c]},He.center=function(Tt){return arguments.length?(i=Tt[0]%360*qc,P=Tt[1]%360*qc,Ot()):[i*Zp,P*Zp]},He.rotate=function(Tt){return arguments.length?(L=Tt[0]%360*qc,U=Tt[1]%360*qc,V=Tt.length>2?Tt[2]%360*qc:0,Ot()):[L*Zp,U*Zp,V*Zp]},He.precision=function(Tt){return arguments.length?(Ae=Lj(Ke,me=Tt*Tt),Bt()):$_(me)},He.fitExtent=function(Tt,mt){return I7(He,Tt,mt)},He.fitSize=function(Tt,mt){return tge(He,Tt,mt)};function Ot(){ee=w7(H=Ume(L,U,V),t);var Tt=t(i,P);return b=o-Tt[0]*a,S=c+Tt[1]*a,Bt()}function Bt(){return Oe=Ye=null,He}return function(){return t=e.apply(this,arguments),He.invert=t.invert&&st,Ot()}}function C7(e){return function(t,a){var o=ho(t),c=ho(a),b=e(o*c);return[b*c*fo(t),b*fo(a)]}}function P7(e){return function(t,a){var o=$_(t*t+a*a),c=e(o),b=fo(c),S=ho(c);return[I_(t*b,o*S),Mg(o&&a*b/o)]}}var lge=C7(function(e){return $_(2/(1+e))});lge.invert=P7(function(e){return 2*Mg(e/2)});var R7=C7(function(e){return(e=b7(e))&&e/fo(e)});R7.invert=P7(function(e){return e});function uge(){return oge(R7).scale(79.4188).clipAngle(180-.001)}function zj(e,t){return[e,t]}zj.invert=zj;var{BufferOp:cge,GeoJSONReader:hge,GeoJSONWriter:fge}=Bme;function dge(e,t,a){a=a||{};var o=a.units||"kilometers",c=a.steps||8;if(!e)throw new Error("geojson is required");if(typeof a!="object")throw new Error("options must be an object");if(typeof c!="number")throw new Error("steps must be an number");if(t===void 0)throw new Error("radius is required");if(c<=0)throw new Error("steps must be greater than 0");var b=[];switch(e.type){case"GeometryCollection":return mR(e,function(S){var i=Tb(S,t,o,c);i&&b.push(i)}),O_(b);case"FeatureCollection":return fC(e,function(S){var i=Tb(S,t,o,c);i&&fC(i,function(P){P&&b.push(P)})}),O_(b)}return Tb(e,t,o,c)}function Tb(e,t,a,o){var c=e.properties||{},b=e.type==="Feature"?e.geometry:e;if(b.type==="GeometryCollection"){var S=[];return mR(e,function(le){var ue=Tb(le,t,a,o);ue&&S.push(ue)}),O_(S)}var i=pge(b),P={type:b.type,coordinates:D7(b.coordinates,i)},L=new hge,U=L.read(P),V=ime(ame(t,a),"meters"),H=cge.bufferOp(U,V,o),ee=new fge;if(H=ee.write(H),!k7(H.coordinates)){var ie={type:H.type,coordinates:L7(H.coordinates,i)};return lm(ie,c)}}function k7(e){return Array.isArray(e[0])?k7(e[0]):isNaN(e[0])}function D7(e,t){return typeof e[0]!="object"?t(e):e.map(function(a){return D7(a,t)})}function L7(e,t){return typeof e[0]!="object"?t.invert(e):e.map(function(a){return L7(a,t)})}function pge(e){var t=Dme(e).geometry.coordinates,a=[-t[0],-t[1]];return uge().rotate(a).scale(bu)}function mge(){const{state:e}=Jt.useContext(Lx),[t,a]=Jt.useState([]),o={"GRASS LAND":"#E101FF",URBAN:"#FE9900",AGRICULTURE:"#4CAF50"};return Jt.useEffect(()=>{if(e.chartDataOvrly&&Object.keys(e.chartDataOvrly).length>0){const c=Object.keys(e.chartDataOvrly).map(b=>({name:b,value:e.chartDataOvrly[b],fill:o[b]||"#8884d8"}));a(c),console.log("Chart data updated:",c)}else a([]),console.log("Chart data is empty or null")},[e.chartDataOvrly]),nn.jsx("div",{style:{width:"100%",height:"400px"},children:t.length>0?nn.jsx(n8,{children:nn.jsxs(Zpe,{data:t,children:[nn.jsx(q_,{dataKey:"name"}),nn.jsx(G_,{}),nn.jsx(Ih,{}),nn.jsx(kg,{dataKey:"value",fill:"#8884d8",radius:[10,10,0,0]})]})}):nn.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:nn.jsx("p",{children:"Play with buffer and intersection"})})})}const gge={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},yge={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{type:"spring",stiffness:100,damping:10}}};function _ge(){const{state:e,setState:t}=Jt.useContext(Lx),a=Jt.useRef(),o=Jt.useRef(),c=Jt.useRef(null),b=Jt.useRef(e.bufferArea),S=Jt.useMemo(()=>({type:"FeatureCollection",features:[{type:"Feature",properties:{id:1},geometry:{type:"LineString",coordinates:[[112.32870294136669,-7.458199186124536],[112.32893208822865,-7.458065517121718],[112.32936173859486,-7.457605313840587],[112.32953550829852,-7.457420086793825],[112.32965771995823,-7.457351342735234],[112.32977993161795,-7.457334156720585]]}}]}),[]);Jt.useEffect(()=>(Wy.accessToken="pk.eyJ1IjoiYW5kaXN1cnlhMTAiLCJhIjoiY2w4amt5bnFqMDJzajN3b2d6aTdjZXpkeiJ9.N3coQCudOQJRf5c5r8BVQA",a.current=new Wy.Map({container:o.current,center:[111,-7.1],zoom:4}),a.current.on("load",()=>{a.current.addSource("lineSource",{type:"geojson",data:S}),a.current.addLayer({id:"lineLayer",type:"line",source:"lineSource",paint:{"line-color":"blue","line-width":6}});const V=new Wy.LngLatBounds;S.features[0].geometry.coordinates.forEach(H=>{V.extend(H)}),a.current.fitBounds(V,{zoom:17,speed:1,essential:!1})}),a.current.on("load",()=>{a.current.addSource("polygonSource",{type:"geojson",data:IL}),a.current.addLayer({id:"polygonLayer",type:"fill",source:"polygonSource",paint:{"fill-color":"#ADA1AE","fill-opacity":.3}}),a.current.addLayer({id:"polygonBorder",type:"line",source:"polygonSource",paint:{"line-color":"#000000","line-width":1}})}),()=>{a.current&&a.current.remove(),cancelAnimationFrame(c.current)}),[]);const i=V=>{cancelAnimationFrame(c.current);const H=()=>{b.current+=(V-b.current)*.1,Math.abs(V-b.current)<.5?b.current=V:c.current=requestAnimationFrame(H),P(b.current,S,IL,a)};H()},P=(V,H,ee,ie)=>{if(!H)return;const le=dge(H,V,{units:"meters"});ie.current.getLayer("bufferLayer")?ie.current.getSource("bufferSource").setData(le):(ie.current.addSource("bufferSource",{type:"geojson",data:le}),ie.current.addLayer({id:"bufferLayer",type:"fill",source:"bufferSource",paint:{"fill-color":"#87CEEB","fill-opacity":.4,"fill-outline-color":"black"}}));const ue=[],ge=[];fC(ee,Ee=>{kme(Ee,le)&&Ee.properties&&Ee.properties.category&&(ue.push(Ee.properties.category),ge.push(Ee.geometry))});const Se=ue.reduce((Ee,me)=>(Ee[me]?Ee[me]++:Ee[me]=1,Ee),{});t(Ee=>({...Ee,chartDataOvrly:Se}));const ve={type:"FeatureCollection",features:ge.map((Ee,me)=>({type:"Feature",geometry:Ee,properties:{category:ue[me]}}))};ie.current.getLayer("intersectedLayer")&&(ie.current.removeLayer("intersectedLayer"),ie.current.removeSource("intersectedSource")),ie.current.addSource("intersectedSource",{type:"geojson",data:ve}),ie.current.addLayer({id:"intersectedLayer",type:"fill",source:"intersectedSource",paint:{"fill-color":["match",["get","category"],"URBAN","#FE9900","GRASS LAND","#E101FF","AGRICULTURE","#00FF00","#CCCCCC"],"fill-opacity":.3}}),console.log(ve)},L=V=>{const H=Number(V.target.value);t(ee=>({...ee,bufferArea:H})),i(H)},U="New Irigation Risk Effect".split(" ");return nn.jsxs(Cr.div,{className:"h-1/2 w-[90vw] flex flex-col md:flex-row p-0 bg-white text-black text-lg shadow-2xl rounded-lg overflow-hidden",initial:{opacity:0,y:20,borderWidth:0},animate:{opacity:1,y:0,borderWidth:"2px"},transition:{type:"spring",stiffness:100,damping:10,duration:.5},children:[nn.jsxs(Cr.div,{className:"w-full md:w-1/2 p-6 flex flex-col justify-center items-center",variants:gge,initial:"hidden",animate:"visible",children:[nn.jsx(Cr.div,{className:"flex flex-wrap justify-center mt-4",children:U.map((V,H)=>nn.jsx(Cr.span,{variants:yge,className:"text-2xl text-blue-800 font-bold tracking-wide inline-block mr-2 mb-30",children:V},H))}),nn.jsxs(Cr.div,{className:"w-full h-[400px] flex justify-center mt-4",children:[" ",nn.jsx(mge,{})]})]}),nn.jsx(Cr.div,{className:"w-full md:w-1/2 flex flex-col items-center justify-center p-8 border-r border-gray-600 relative",initial:{opacity:0,y:-50},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:100,damping:10},children:nn.jsx(Cr.div,{id:"map-container",ref:o,className:"w-full h-[50vh] md:h-[60vh] rounded-lg overflow-hidden relative",children:nn.jsxs("div",{style:{position:"absolute",top:"10px",left:"10px",background:"rgba(255, 255, 255, 0.9)",padding:"12px 16px",borderRadius:"8px",boxShadow:"0px 4px 10px rgba(0, 0, 0, 0.2)",zIndex:1e3,textAlign:"center",fontFamily:"'Arial', sans-serif",width:"340px"},children:[nn.jsx("input",{type:"range",min:"1",max:"100",defaultValue:e.bufferArea,onChange:L,style:{width:"100%",cursor:"pointer",accentColor:"#007BFF"}}),nn.jsxs("p",{style:{marginTop:"8px",color:"#333",fontWeight:"600",fontSize:"14px",letterSpacing:"0.5px"},children:["Buffer: ",e.bufferArea," m"]})]})})})]})}const z7="/andisuryaalamportofolio/assets/gabung-CZP6BWIX.mp4",vge="/andisuryaalamportofolio/assets/trans-DpPO_jjN.mp4",xge="/andisuryaalamportofolio/assets/zone-BBz-ZHuT.mp4",bge="/andisuryaalamportofolio/assets/tematik_map-Cl2zvZxg.mp4",wge="/andisuryaalamportofolio/assets/add-4AxgRJ-M.mp4";function Sge(){const e=Jt.useRef([]),t=Jt.useRef(null),[a,o]=Jt.useState(0),c=["Laravel","React JS","Tailwind","PostGIS"],b={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},S={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{type:"spring",stiffness:100,damping:20}}},i=[xge,z7,vge,bge,wge],P=["Developed a spatial analysis tool using Turf.js to create user-defined buffer zones, retrieve intersecting feature IDs, and process data through a left join based on ST_Intersection. Visualized results dynamically on a map and integrated Recharts for in-depth data analysis, enhancing decision-making capabilities.","Leveraged PostGIS to perform advanced geospatial operations, including splitting geometries using ST_Split, merging datasets with ST_Union, and analyzing intersections with ST_Intersection, ensuring precise and efficient data processing","Utilized Turf.js to transform and analyze GeoJSON data, extracting intersecting feature IDs, dynamically rendering them on an interactive map, and saving updated datasets for seamless data management and visualization.","Implemented a data integration pipeline to perform left joins on external datasets from other DBMS in this case is PG with Oracle, enabling customized responses to user queries. Enhanced feature symbology and integrated chart analysis tools for improved data interpretation and visualization.","Integrated Google Street View into the platform to provide users with a real-world perspective, facilitating accurate assessments for tax policy evaluations and supporting data-driven decision-making processes."],L=["NJOP Zoning","Updating Spatial Data","Editing Spatial Data ","Thematic Map","Additional"],U=H=>{console.log(`Video ${H} ended`);const ee=t.current;ee&&(ee.scrollBy({left:ee.clientWidth,behavior:"smooth"}),o(ie=>(ie+1)%P.length),o(ie=>(ie+1)%L.length))},V=()=>{const H=t.current;if(H){const ee=H.scrollLeft,ie=H.clientWidth,le=Math.round(ee/ie);console.log("Scroll Position:",ee,"Section Index:",le),le!==a&&o(le)}};return Jt.useEffect(()=>{e.current.forEach((H,ee)=>{H&&(ee===a?(H.src=i[ee],H.load(),H.play()):ee===a+1?(H.src=i[ee],H.load()):(H.src="",H.load()))})},[a]),nn.jsxs(Cr.div,{className:"h-1/2 w-[90vw] flex flex-col md:flex-row p-0 bg-white text-black text-lg shadow-2xl rounded-lg overflow-hidden",initial:{opacity:0,y:20,borderWidth:0},animate:{opacity:1,y:0,borderWidth:"2px"},transition:{type:"spring",stiffness:100,damping:10,duration:.5},children:[nn.jsxs(Cr.div,{className:"w-full flex flex-col items-center justify-center p-3 border-b border-gray-300",initial:{opacity:0,y:-50},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:100,damping:10},children:[nn.jsx(Cr.div,{className:"mt-0 text-lg text-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:120,damping:12},children:nn.jsx("h2",{className:"font-semibold text-blue-600",children:"Accurate Land Tax Valuation Through Geospatial Technology"})}),nn.jsx(Cr.div,{className:"text-lg text-left mb-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:120,damping:12},children:nn.jsx("p",{className:"mt-2 text-black-700",children:L[a]})}),nn.jsx(Cr.div,{className:"text-lg text-left mb-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:120,damping:12},children:nn.jsx("p",{className:"mt-2 text-black-700",children:P[a]})}),nn.jsx(Cr.div,{className:"w-full text-center",initial:"hidden",animate:"visible",variants:b,children:nn.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:c.map((H,ee)=>nn.jsx(Cr.div,{className:"px-4 py-2 bg-white rounded-full text-sm font-medium",variants:S,whileHover:{scale:1.1,backgroundColor:"#00BFFF"},transition:{type:"spring",stiffness:300},children:H},ee))})})]}),nn.jsx(Cr.div,{className:"w-full h-[700px] flex flex-col items-center justify-center p-1 overflow-hidden",initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:100,damping:10},children:nn.jsx("div",{ref:t,className:"w-full h-full gap-2 p-1 flex overflow-x-scroll snap-x snap-mandatory pr-[12%]",onScroll:V,children:i.map((H,ee)=>nn.jsx(Cr.div,{className:"scrollItem w-full h-full flex-shrink-0 snap-start flex items-center rounded-sm justify-center relative",initial:{opacity:0,x:ee===0?0:100},animate:{opacity:1,x:0},transition:{type:"spring",stiffness:100,damping:20},children:nn.jsx(Cr.div,{className:"scrollItem w-full h-full flex-shrink-0 snap-start flex items-center rounded-sm justify-center relative",initial:{opacity:0,x:ee===0?0:100},animate:{opacity:1,x:0},transition:{type:"spring",stiffness:100,damping:20},children:nn.jsx("div",{className:"relative w-full h-full overflow-hidden border-2 rounded-lg aspect-video",children:nn.jsx("video",{ref:ie=>e.current[ee]=ie,autoPlay:ee===a,muted:!0,loop:!1,onEnded:()=>U(ee),className:"w-full h-full absolute inset-0 object-content"})})},ee)},ee))})})]})}function Tge(){const e=Jt.useRef([]),t=Jt.useRef(null),[a,o]=Jt.useState(0),c=["Go-Fiber","PostGIS","React Native (Expo, EAS)"],b={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},S={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{type:"spring",stiffness:100,damping:20}}},i=[z7],P=["Develop a React Native (Expo, EAS) application integrated with Go Fiber as the JSON and GeoJSON data provider (API), secured with JWT token authentication. Utilize Axios for real-time data synchronization, Mapbox for advanced mapping features, and geolocation for precise location tracking. This setup will enable efficient data collection and improved reporting capabilities."],L=V=>{const H=e.current[V];H&&(H.currentTime=0,H.play());const ee=t.current;ee&&(ee.scrollBy({left:ee.clientWidth,behavior:"smooth"}),o(ie=>(ie+1)%P.length))},U=()=>{const V=t.current;if(V){const H=V.scrollLeft,ee=V.clientWidth,ie=Math.round(H/ee);ie!==a&&o(ie)}};return Jt.useEffect(()=>{const V=e.current[a];V&&(V.currentTime=0,V.play())},[a]),nn.jsxs(Cr.div,{className:"h-1/2 w-[90vw] flex flex-col md:flex-row p-0 bg-white text-black text-lg shadow-2xl rounded-lg overflow-hidden",initial:{opacity:0,y:20,borderWidth:0},animate:{opacity:1,y:0,borderWidth:"2px"},transition:{type:"spring",stiffness:100,damping:10,duration:.5},children:[nn.jsxs(Cr.div,{className:"w-full flex flex-col items-center justify-center p-3 border-b border-gray-300",initial:{opacity:0,y:-50},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:100,damping:10},children:[nn.jsx(Cr.div,{className:"mt-0 text-lg text-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:120,damping:12},children:nn.jsx("h2",{className:"font-semibold text-blue-600",children:"React Native & Go Fiber Integration for Geospatial Data Processing"})}),nn.jsx(Cr.div,{className:"text-lg text-left mb-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:120,damping:12},children:nn.jsx("p",{className:"mt-2 text-black-700",children:P[a]})}),nn.jsx(Cr.div,{className:"w-full text-center",initial:"hidden",animate:"visible",variants:b,children:nn.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:c.map((V,H)=>nn.jsx(Cr.div,{className:"px-4 py-2 bg-white rounded-full text-sm font-medium",variants:S,whileHover:{scale:1.1,backgroundColor:"#00BFFF"},transition:{type:"spring",stiffness:300},children:V},H))})})]}),nn.jsx(Cr.div,{className:"w-full h-[700px] flex flex-col items-center justify-center p-1 overflow-hidden",initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:100,damping:10},children:nn.jsx("div",{ref:t,className:"w-full h-full gap-2 p-3 flex overflow-x-scroll snap-x snap-mandatory pr-[12%]",onScroll:U,children:i.map((V,H)=>nn.jsx(Cr.div,{className:"scrollItem w-full h-full flex-shrink-0 snap-start flex items-center border-2 rounded-sm justify-center relative",initial:{opacity:0,x:H===0?0:100},animate:{opacity:1,x:0},transition:{type:"spring",stiffness:100,damping:20},children:nn.jsxs("video",{ref:ee=>e.current[H]=ee,autoPlay:H===a,muted:!0,loop:H!==a,onEnded:()=>L(H),className:"w-full h-full object-cover absolute inset-0",children:[nn.jsx("source",{src:V,type:"video/mp4"}),"Your browser does not support the video tag."]})},H))})})]})}function Ege(e,t){return PZ(e,[0,1],[-100,t])}function Age(e,t){const o={1:YD,2:tme,3:_ge,4:Sge,5:Tge,6:tJ}[e]||YD;return e===t?nn.jsx(Cr.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:nn.jsx(o,{id:e})},e):null}function Mge({id:e,activeId:t}){const a=Jt.useRef(null),{scrollYProgress:o}=mU({target:a}),c=Ege(o,100);return nn.jsx("section",{className:"h-screen w-full snap-center flex justify-center items-center p-0 m-0",children:nn.jsx("div",{ref:a,className:"w-full flex justify-center items-center",children:nn.jsx(Cr.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:1},className:"w-full h-full flex justify-center items-center",style:{y:c,width:"100%"},children:Age(e,t)})})})}function Oge(){const[e,t]=Jt.useState(1),{scrollYProgress:a}=mU(),o=AZ(a,{stiffness:100,damping:30,restDelta:.001});return Jt.useEffect(()=>{const c=()=>{const b=window.scrollY,S=window.innerHeight,i=Math.round(b/S)+1;t(i),console.log("Active ID:",i)};return window.addEventListener("scroll",c),()=>window.removeEventListener("scroll",c)},[]),nn.jsxs("div",{id:"example",className:"relative w-full bg-white rounded-xl",children:[nn.jsx(nJ,{activeId:e})," ",[1,2,3,4,5,6].map(c=>nn.jsx(Mge,{id:c,activeId:e},c)),nn.jsx(Cr.div,{className:"progress",style:{scaleX:o}}),nn.jsx(Ige,{})]})}function Ige(){return nn.jsx("style",{children:`
        html {
            scroll-snap-type: y mandatory;
        }

        .progress {
            position: fixed;
            left: 0;
            right: 0;
            border-radius:10px;
            height: 20px;
            background:#00BFFF;
            bottom: 50px;
            transform: scaleX(0);
        }
    `})}CG.createRoot(document.getElementById("root")).render(nn.jsx(Jt.StrictMode,{children:nn.jsx(Kpe,{children:nn.jsx(Oge,{})})}));
